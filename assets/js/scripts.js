!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";var e,i;function c(){return e.apply(null,arguments)}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function u(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function l(e){return void 0===e}function d(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function f(e,t){var n,s=[];for(n=0;n<e.length;++n)s.push(t(e[n],n));return s}function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _(e,t){for(var n in t)m(t,n)&&(e[n]=t[n]);return m(t,"toString")&&(e.toString=t.toString),m(t,"valueOf")&&(e.valueOf=t.valueOf),e}function y(e,t,n,s){return Ot(e,t,n,s,!0).utc()}function g(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function p(e){if(null==e._isValid){var t=g(e),n=i.call(t.parsedDateParts,function(e){return null!=e}),s=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(s=s&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return s;e._isValid=s}return e._isValid}function v(e){var t=y(NaN);return null!=e?_(g(t),e):g(t).userInvalidated=!0,t}i=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,s=0;s<n;s++)if(s in t&&e.call(this,t[s],s,t))return!0;return!1};var r=c.momentProperties=[];function w(e,t){var n,s,i;if(l(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),l(t._i)||(e._i=t._i),l(t._f)||(e._f=t._f),l(t._l)||(e._l=t._l),l(t._strict)||(e._strict=t._strict),l(t._tzm)||(e._tzm=t._tzm),l(t._isUTC)||(e._isUTC=t._isUTC),l(t._offset)||(e._offset=t._offset),l(t._pf)||(e._pf=g(t)),l(t._locale)||(e._locale=t._locale),0<r.length)for(n=0;n<r.length;n++)l(i=t[s=r[n]])||(e[s]=i);return e}var t=!1;function M(e){w(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===t&&(t=!0,c.updateOffset(this),t=!1)}function S(e){return e instanceof M||null!=e&&null!=e._isAMomentObject}function D(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function k(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=D(t)),n}function a(e,t,n){var s,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(s=0;s<i;s++)(n&&e[s]!==t[s]||!n&&k(e[s])!==k(t[s]))&&a++;return a+r}function Y(e){!1===c.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function n(i,r){var a=!0;return _(function(){if(null!=c.deprecationHandler&&c.deprecationHandler(null,i),a){for(var e,t=[],n=0;n<arguments.length;n++){if(e="","object"==typeof arguments[n]){for(var s in e+="\n["+n+"] ",arguments[0])e+=s+": "+arguments[0][s]+", ";e=e.slice(0,-2)}else e=arguments[n];t.push(e)}Y(i+"\nArguments: "+Array.prototype.slice.call(t).join("")+"\n"+(new Error).stack),a=!1}return r.apply(this,arguments)},r)}var s,O={};function T(e,t){null!=c.deprecationHandler&&c.deprecationHandler(e,t),O[e]||(Y(t),O[e]=!0)}function x(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function b(e,t){var n,s=_({},e);for(n in t)m(t,n)&&(u(e[n])&&u(t[n])?(s[n]={},_(s[n],e[n]),_(s[n],t[n])):null!=t[n]?s[n]=t[n]:delete s[n]);for(n in e)m(e,n)&&!m(t,n)&&u(e[n])&&(s[n]=_({},s[n]));return s}function P(e){null!=e&&this.set(e)}c.suppressDeprecationWarnings=!1,c.deprecationHandler=null,s=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)m(e,t)&&n.push(t);return n};var W={};function H(e,t){var n=e.toLowerCase();W[n]=W[n+"s"]=W[t]=e}function R(e){return"string"==typeof e?W[e]||W[e.toLowerCase()]:void 0}function C(e){var t,n,s={};for(n in e)m(e,n)&&(t=R(n))&&(s[t]=e[n]);return s}var F={};function L(e,t){F[e]=t}function U(e,t,n){var s=""+Math.abs(e),i=t-s.length;return(0<=e?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+s}var N=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,G=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,V={},E={};function I(e,t,n,s){var i=s;"string"==typeof s&&(i=function(){return this[s]()}),e&&(E[e]=i),t&&(E[t[0]]=function(){return U(i.apply(this,arguments),t[1],t[2])}),n&&(E[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function A(e,t){return e.isValid()?(t=j(t,e.localeData()),V[t]=V[t]||function(s){var e,i,t,r=s.match(N);for(e=0,i=r.length;e<i;e++)E[r[e]]?r[e]=E[r[e]]:r[e]=(t=r[e]).match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"");return function(e){var t,n="";for(t=0;t<i;t++)n+=x(r[t])?r[t].call(e,s):r[t];return n}}(t),V[t](e)):e.localeData().invalidDate()}function j(e,t){var n=5;function s(e){return t.longDateFormat(e)||e}for(G.lastIndex=0;0<=n&&G.test(e);)e=e.replace(G,s),G.lastIndex=0,n-=1;return e}var Z=/\d/,z=/\d\d/,$=/\d{3}/,q=/\d{4}/,J=/[+-]?\d{6}/,B=/\d\d?/,Q=/\d\d\d\d?/,X=/\d\d\d\d\d\d?/,K=/\d{1,3}/,ee=/\d{1,4}/,te=/[+-]?\d{1,6}/,ne=/\d+/,se=/[+-]?\d+/,ie=/Z|[+-]\d\d:?\d\d/gi,re=/Z|[+-]\d\d(?::?\d\d)?/gi,ae=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,oe={};function ue(e,n,s){oe[e]=x(n)?n:function(e,t){return e&&s?s:n}}function le(e,t){return m(oe,e)?oe[e](t._strict,t._locale):new RegExp(de(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,s,i){return t||n||s||i})))}function de(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var he={};function ce(e,n){var t,s=n;for("string"==typeof e&&(e=[e]),d(n)&&(s=function(e,t){t[n]=k(e)}),t=0;t<e.length;t++)he[e[t]]=s}function fe(e,i){ce(e,function(e,t,n,s){n._w=n._w||{},i(e,n._w,n,s)})}var me=0,_e=1,ye=2,ge=3,pe=4,ve=5,we=6,Me=7,Se=8;function De(e){return ke(e)?366:365}function ke(e){return e%4==0&&e%100!=0||e%400==0}I("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),I(0,["YY",2],0,function(){return this.year()%100}),I(0,["YYYY",4],0,"year"),I(0,["YYYYY",5],0,"year"),I(0,["YYYYYY",6,!0],0,"year"),H("year","y"),L("year",1),ue("Y",se),ue("YY",B,z),ue("YYYY",ee,q),ue("YYYYY",te,J),ue("YYYYYY",te,J),ce(["YYYYY","YYYYYY"],me),ce("YYYY",function(e,t){t[me]=2===e.length?c.parseTwoDigitYear(e):k(e)}),ce("YY",function(e,t){t[me]=c.parseTwoDigitYear(e)}),ce("Y",function(e,t){t[me]=parseInt(e,10)}),c.parseTwoDigitYear=function(e){return k(e)+(68<k(e)?1900:2e3)};var Ye,Oe=Te("FullYear",!0);function Te(t,n){return function(e){return null!=e?(be(this,t,e),c.updateOffset(this,n),this):xe(this,t)}}function xe(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function be(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&ke(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Pe(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function Pe(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,s=(t%(n=12)+n)%n;return e+=(t-s)/12,1===s?ke(e)?29:28:31-s%7%2}Ye=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},I("M",["MM",2],"Mo",function(){return this.month()+1}),I("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),I("MMMM",0,0,function(e){return this.localeData().months(this,e)}),H("month","M"),L("month",8),ue("M",B),ue("MM",B,z),ue("MMM",function(e,t){return t.monthsShortRegex(e)}),ue("MMMM",function(e,t){return t.monthsRegex(e)}),ce(["M","MM"],function(e,t){t[_e]=k(e)-1}),ce(["MMM","MMMM"],function(e,t,n,s){var i=n._locale.monthsParse(e,s,n._strict);null!=i?t[_e]=i:g(n).invalidMonth=e});var We=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,He="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var Re="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Ce(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=k(t);else if(!d(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Pe(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Fe(e){return null!=e?(Ce(this,e),c.updateOffset(this,!0),this):xe(this,"Month")}var Le=ae;var Ue=ae;function Ne(){function e(e,t){return t.length-e.length}var t,n,s=[],i=[],r=[];for(t=0;t<12;t++)n=y([2e3,t]),s.push(this.monthsShort(n,"")),i.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(s.sort(e),i.sort(e),r.sort(e),t=0;t<12;t++)s[t]=de(s[t]),i[t]=de(i[t]);for(t=0;t<24;t++)r[t]=de(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Ge(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&0<=e&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Ve(e,t,n){var s=7+t-n;return-((7+Ge(e,0,s).getUTCDay()-t)%7)+s-1}function Ee(e,t,n,s,i){var r,a,o=1+7*(t-1)+(7+n-s)%7+Ve(e,s,i);return o<=0?a=De(r=e-1)+o:o>De(e)?(r=e+1,a=o-De(e)):(r=e,a=o),{year:r,dayOfYear:a}}function Ie(e,t,n){var s,i,r=Ve(e.year(),t,n),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return a<1?s=a+Ae(i=e.year()-1,t,n):a>Ae(e.year(),t,n)?(s=a-Ae(e.year(),t,n),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function Ae(e,t,n){var s=Ve(e,t,n),i=Ve(e+1,t,n);return(De(e)-s+i)/7}I("w",["ww",2],"wo","week"),I("W",["WW",2],"Wo","isoWeek"),H("week","w"),H("isoWeek","W"),L("week",5),L("isoWeek",5),ue("w",B),ue("ww",B,z),ue("W",B),ue("WW",B,z),fe(["w","ww","W","WW"],function(e,t,n,s){t[s.substr(0,1)]=k(e)});I("d",0,"do","day"),I("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),I("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),I("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),I("e",0,0,"weekday"),I("E",0,0,"isoWeekday"),H("day","d"),H("weekday","e"),H("isoWeekday","E"),L("day",11),L("weekday",11),L("isoWeekday",11),ue("d",B),ue("e",B),ue("E",B),ue("dd",function(e,t){return t.weekdaysMinRegex(e)}),ue("ddd",function(e,t){return t.weekdaysShortRegex(e)}),ue("dddd",function(e,t){return t.weekdaysRegex(e)}),fe(["dd","ddd","dddd"],function(e,t,n,s){var i=n._locale.weekdaysParse(e,s,n._strict);null!=i?t.d=i:g(n).invalidWeekday=e}),fe(["d","e","E"],function(e,t,n,s){t[s]=k(e)});var je="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var Ze="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var ze="Su_Mo_Tu_We_Th_Fr_Sa".split("_");var $e=ae;var qe=ae;var Je=ae;function Be(){function e(e,t){return t.length-e.length}var t,n,s,i,r,a=[],o=[],u=[],l=[];for(t=0;t<7;t++)n=y([2e3,1]).day(t),s=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),r=this.weekdays(n,""),a.push(s),o.push(i),u.push(r),l.push(s),l.push(i),l.push(r);for(a.sort(e),o.sort(e),u.sort(e),l.sort(e),t=0;t<7;t++)o[t]=de(o[t]),u[t]=de(u[t]),l[t]=de(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Qe(){return this.hours()%12||12}function Xe(e,t){I(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Ke(e,t){return t._meridiemParse}I("H",["HH",2],0,"hour"),I("h",["hh",2],0,Qe),I("k",["kk",2],0,function(){return this.hours()||24}),I("hmm",0,0,function(){return""+Qe.apply(this)+U(this.minutes(),2)}),I("hmmss",0,0,function(){return""+Qe.apply(this)+U(this.minutes(),2)+U(this.seconds(),2)}),I("Hmm",0,0,function(){return""+this.hours()+U(this.minutes(),2)}),I("Hmmss",0,0,function(){return""+this.hours()+U(this.minutes(),2)+U(this.seconds(),2)}),Xe("a",!0),Xe("A",!1),H("hour","h"),L("hour",13),ue("a",Ke),ue("A",Ke),ue("H",B),ue("h",B),ue("k",B),ue("HH",B,z),ue("hh",B,z),ue("kk",B,z),ue("hmm",Q),ue("hmmss",X),ue("Hmm",Q),ue("Hmmss",X),ce(["H","HH"],ge),ce(["k","kk"],function(e,t,n){var s=k(e);t[ge]=24===s?0:s}),ce(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),ce(["h","hh"],function(e,t,n){t[ge]=k(e),g(n).bigHour=!0}),ce("hmm",function(e,t,n){var s=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s)),g(n).bigHour=!0}),ce("hmmss",function(e,t,n){var s=e.length-4,i=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s,2)),t[ve]=k(e.substr(i)),g(n).bigHour=!0}),ce("Hmm",function(e,t,n){var s=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s))}),ce("Hmmss",function(e,t,n){var s=e.length-4,i=e.length-2;t[ge]=k(e.substr(0,s)),t[pe]=k(e.substr(s,2)),t[ve]=k(e.substr(i))});var et,tt=Te("Hours",!0),nt={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:He,monthsShort:Re,week:{dow:0,doy:6},weekdays:je,weekdaysMin:ze,weekdaysShort:Ze,meridiemParse:/[ap]\.?m?\.?/i},st={},it={};function rt(e){return e?e.toLowerCase().replace("_","-"):e}function at(e){var t=null;if(!st[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=et._abbr,require("./locale/"+e),ot(t)}catch(e){}return st[e]}function ot(e,t){var n;return e&&((n=l(t)?lt(e):ut(e,t))?et=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),et._abbr}function ut(e,t){if(null!==t){var n,s=nt;if(t.abbr=e,null!=st[e])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=st[e]._config;else if(null!=t.parentLocale)if(null!=st[t.parentLocale])s=st[t.parentLocale]._config;else{if(null==(n=at(t.parentLocale)))return it[t.parentLocale]||(it[t.parentLocale]=[]),it[t.parentLocale].push({name:e,config:t}),null;s=n._config}return st[e]=new P(b(s,t)),it[e]&&it[e].forEach(function(e){ut(e.name,e.config)}),ot(e),st[e]}return delete st[e],null}function lt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return et;if(!o(e)){if(t=at(e))return t;e=[e]}return function(e){for(var t,n,s,i,r=0;r<e.length;){for(t=(i=rt(e[r]).split("-")).length,n=(n=rt(e[r+1]))?n.split("-"):null;0<t;){if(s=at(i.slice(0,t).join("-")))return s;if(n&&n.length>=t&&a(i,n,!0)>=t-1)break;t--}r++}return et}(e)}function dt(e){var t,n=e._a;return n&&-2===g(e).overflow&&(t=n[_e]<0||11<n[_e]?_e:n[ye]<1||n[ye]>Pe(n[me],n[_e])?ye:n[ge]<0||24<n[ge]||24===n[ge]&&(0!==n[pe]||0!==n[ve]||0!==n[we])?ge:n[pe]<0||59<n[pe]?pe:n[ve]<0||59<n[ve]?ve:n[we]<0||999<n[we]?we:-1,g(e)._overflowDayOfYear&&(t<me||ye<t)&&(t=ye),g(e)._overflowWeeks&&-1===t&&(t=Me),g(e)._overflowWeekday&&-1===t&&(t=Se),g(e).overflow=t),e}function ht(e,t,n){return null!=e?e:null!=t?t:n}function ct(e){var t,n,s,i,r,a=[];if(!e._d){var o,u;for(o=e,u=new Date(c.now()),s=o._useUTC?[u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()]:[u.getFullYear(),u.getMonth(),u.getDate()],e._w&&null==e._a[ye]&&null==e._a[_e]&&function(e){var t,n,s,i,r,a,o,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)r=1,a=4,n=ht(t.GG,e._a[me],Ie(Tt(),1,4).year),s=ht(t.W,1),((i=ht(t.E,1))<1||7<i)&&(u=!0);else{r=e._locale._week.dow,a=e._locale._week.doy;var l=Ie(Tt(),r,a);n=ht(t.gg,e._a[me],l.year),s=ht(t.w,l.week),null!=t.d?((i=t.d)<0||6<i)&&(u=!0):null!=t.e?(i=t.e+r,(t.e<0||6<t.e)&&(u=!0)):i=r}s<1||s>Ae(n,r,a)?g(e)._overflowWeeks=!0:null!=u?g(e)._overflowWeekday=!0:(o=Ee(n,s,i,r,a),e._a[me]=o.year,e._dayOfYear=o.dayOfYear)}(e),null!=e._dayOfYear&&(r=ht(e._a[me],s[me]),(e._dayOfYear>De(r)||0===e._dayOfYear)&&(g(e)._overflowDayOfYear=!0),n=Ge(r,0,e._dayOfYear),e._a[_e]=n.getUTCMonth(),e._a[ye]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=s[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ge]&&0===e._a[pe]&&0===e._a[ve]&&0===e._a[we]&&(e._nextDay=!0,e._a[ge]=0),e._d=(e._useUTC?Ge:function(e,t,n,s,i,r,a){var o=new Date(e,t,n,s,i,r,a);return e<100&&0<=e&&isFinite(o.getFullYear())&&o.setFullYear(e),o}).apply(null,a),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ge]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(g(e).weekdayMismatch=!0)}}var ft=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_t=/Z|[+-]\d\d(?::?\d\d)?/,yt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],gt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],pt=/^\/?Date\((\-?\d+)/i;function vt(e){var t,n,s,i,r,a,o=e._i,u=ft.exec(o)||mt.exec(o);if(u){for(g(e).iso=!0,t=0,n=yt.length;t<n;t++)if(yt[t][1].exec(u[1])){i=yt[t][0],s=!1!==yt[t][2];break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=gt.length;t<n;t++)if(gt[t][1].exec(u[3])){r=(u[2]||" ")+gt[t][0];break}if(null==r)return void(e._isValid=!1)}if(!s&&null!=r)return void(e._isValid=!1);if(u[4]){if(!_t.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=i+(r||"")+(a||""),kt(e)}else e._isValid=!1}var wt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function Mt(e,t,n,s,i,r){var a=[function(e){var t=parseInt(e,10);{if(t<=49)return 2e3+t;if(t<=999)return 1900+t}return t}(e),Re.indexOf(t),parseInt(n,10),parseInt(s,10),parseInt(i,10)];return r&&a.push(parseInt(r,10)),a}var St={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Dt(e){var t,n,s,i=wt.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim());if(i){var r=Mt(i[4],i[3],i[2],i[5],i[6],i[7]);if(t=i[1],n=r,s=e,t&&Ze.indexOf(t)!==new Date(n[0],n[1],n[2]).getDay()&&(g(s).weekdayMismatch=!0,!(s._isValid=!1)))return;e._a=r,e._tzm=function(e,t,n){if(e)return St[e];if(t)return 0;var s=parseInt(n,10),i=s%100;return(s-i)/100*60+i}(i[8],i[9],i[10]),e._d=Ge.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),g(e).rfc2822=!0}else e._isValid=!1}function kt(e){if(e._f!==c.ISO_8601)if(e._f!==c.RFC_2822){e._a=[],g(e).empty=!0;var t,n,s,i,r,a,o,u,l=""+e._i,d=l.length,h=0;for(s=j(e._f,e._locale).match(N)||[],t=0;t<s.length;t++)i=s[t],(n=(l.match(le(i,e))||[])[0])&&(0<(r=l.substr(0,l.indexOf(n))).length&&g(e).unusedInput.push(r),l=l.slice(l.indexOf(n)+n.length),h+=n.length),E[i]?(n?g(e).empty=!1:g(e).unusedTokens.push(i),a=i,u=e,null!=(o=n)&&m(he,a)&&he[a](o,u._a,u,a)):e._strict&&!n&&g(e).unusedTokens.push(i);g(e).charsLeftOver=d-h,0<l.length&&g(e).unusedInput.push(l),e._a[ge]<=12&&!0===g(e).bigHour&&0<e._a[ge]&&(g(e).bigHour=void 0),g(e).parsedDateParts=e._a.slice(0),g(e).meridiem=e._meridiem,e._a[ge]=function(e,t,n){var s;if(null==n)return t;return null!=e.meridiemHour?e.meridiemHour(t,n):(null!=e.isPM&&((s=e.isPM(n))&&t<12&&(t+=12),s||12!==t||(t=0)),t)}(e._locale,e._a[ge],e._meridiem),ct(e),dt(e)}else Dt(e);else vt(e)}function Yt(e){var t,n,s,i,r=e._i,a=e._f;return e._locale=e._locale||lt(e._l),null===r||void 0===a&&""===r?v({nullInput:!0}):("string"==typeof r&&(e._i=r=e._locale.preparse(r)),S(r)?new M(dt(r)):(h(r)?e._d=r:o(a)?function(e){var t,n,s,i,r;if(0===e._f.length)return g(e).invalidFormat=!0,e._d=new Date(NaN);for(i=0;i<e._f.length;i++)r=0,t=w({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],kt(t),p(t)&&(r+=g(t).charsLeftOver,r+=10*g(t).unusedTokens.length,g(t).score=r,(null==s||r<s)&&(s=r,n=t));_(e,n||t)}(e):a?kt(e):l(n=(t=e)._i)?t._d=new Date(c.now()):h(n)?t._d=new Date(n.valueOf()):"string"==typeof n?(s=t,null===(i=pt.exec(s._i))?(vt(s),!1===s._isValid&&(delete s._isValid,Dt(s),!1===s._isValid&&(delete s._isValid,c.createFromInputFallback(s)))):s._d=new Date(+i[1])):o(n)?(t._a=f(n.slice(0),function(e){return parseInt(e,10)}),ct(t)):u(n)?function(e){if(!e._d){var t=C(e._i);e._a=f([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ct(e)}}(t):d(n)?t._d=new Date(n):c.createFromInputFallback(t),p(e)||(e._d=null),e))}function Ot(e,t,n,s,i){var r,a={};return!0!==n&&!1!==n||(s=n,n=void 0),(u(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||o(e)&&0===e.length)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=n,a._i=e,a._f=t,a._strict=s,(r=new M(dt(Yt(a))))._nextDay&&(r.add(1,"d"),r._nextDay=void 0),r}function Tt(e,t,n,s){return Ot(e,t,n,s,!1)}c.createFromInputFallback=n("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),c.ISO_8601=function(){},c.RFC_2822=function(){};var xt=n("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Tt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:v()}),bt=n("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Tt.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:v()});function Pt(e,t){var n,s;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return Tt();for(n=t[0],s=1;s<t.length;++s)t[s].isValid()&&!t[s][e](n)||(n=t[s]);return n}var Wt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ht(e){var t=C(e),n=t.year||0,s=t.quarter||0,i=t.month||0,r=t.week||0,a=t.day||0,o=t.hour||0,u=t.minute||0,l=t.second||0,d=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===Ye.call(Wt,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,s=0;s<Wt.length;++s)if(e[Wt[s]]){if(n)return!1;parseFloat(e[Wt[s]])!==k(e[Wt[s]])&&(n=!0)}return!0}(t),this._milliseconds=+d+1e3*l+6e4*u+1e3*o*60*60,this._days=+a+7*r,this._months=+i+3*s+12*n,this._data={},this._locale=lt(),this._bubble()}function Rt(e){return e instanceof Ht}function Ct(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ft(e,n){I(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+U(~~(e/60),2)+n+U(~~e%60,2)})}Ft("Z",":"),Ft("ZZ",""),ue("Z",re),ue("ZZ",re),ce(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Ut(re,e)});var Lt=/([\+\-]|\d\d)/gi;function Ut(e,t){var n=(t||"").match(e);if(null===n)return null;var s=((n[n.length-1]||[])+"").match(Lt)||["-",0,0],i=60*s[1]+k(s[2]);return 0===i?0:"+"===s[0]?i:-i}function Nt(e,t){var n,s;return t._isUTC?(n=t.clone(),s=(S(e)||h(e)?e.valueOf():Tt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+s),c.updateOffset(n,!1),n):Tt(e).local()}function Gt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Vt(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}c.updateOffset=function(){};var Et=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,It=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function At(e,t){var n,s,i,r=e,a=null;return Rt(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:d(e)?(r={},t?r[t]=e:r.milliseconds=e):(a=Et.exec(e))?(n="-"===a[1]?-1:1,r={y:0,d:k(a[ye])*n,h:k(a[ge])*n,m:k(a[pe])*n,s:k(a[ve])*n,ms:k(Ct(1e3*a[we]))*n}):(a=It.exec(e))?(n="-"===a[1]?-1:(a[1],1),r={y:jt(a[2],n),M:jt(a[3],n),w:jt(a[4],n),d:jt(a[5],n),h:jt(a[6],n),m:jt(a[7],n),s:jt(a[8],n)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(i=function(e,t){var n;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=Nt(t,e),e.isBefore(t)?n=Zt(e,t):((n=Zt(t,e)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(Tt(r.from),Tt(r.to)),(r={}).ms=i.milliseconds,r.M=i.months),s=new Ht(r),Rt(e)&&m(e,"_locale")&&(s._locale=e._locale),s}function jt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Zt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function zt(s,i){return function(e,t){var n;return null===t||isNaN(+t)||(T(i,"moment()."+i+"(period, number) is deprecated. Please use moment()."+i+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=e,e=t,t=n),$t(this,At(e="string"==typeof e?+e:e,t),s),this}}function $t(e,t,n,s){var i=t._milliseconds,r=Ct(t._days),a=Ct(t._months);e.isValid()&&(s=null==s||s,a&&Ce(e,xe(e,"Month")+a*n),r&&be(e,"Date",xe(e,"Date")+r*n),i&&e._d.setTime(e._d.valueOf()+i*n),s&&c.updateOffset(e,r||a))}At.fn=Ht.prototype,At.invalid=function(){return At(NaN)};var qt=zt(1,"add"),Jt=zt(-1,"subtract");function Bt(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(n,"months");return-(n+(t-s<0?(t-s)/(s-e.clone().add(n-1,"months")):(t-s)/(e.clone().add(n+1,"months")-s)))||0}function Qt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=lt(e))&&(this._locale=t),this)}c.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",c.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Xt=n("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function Kt(){return this._locale}function en(e,t){I(0,[e,e.length],0,t)}function tn(e,t,n,s,i){var r;return null==e?Ie(this,s,i).year:((r=Ae(e,s,i))<t&&(t=r),function(e,t,n,s,i){var r=Ee(e,t,n,s,i),a=Ge(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}.call(this,e,t,n,s,i))}I(0,["gg",2],0,function(){return this.weekYear()%100}),I(0,["GG",2],0,function(){return this.isoWeekYear()%100}),en("gggg","weekYear"),en("ggggg","weekYear"),en("GGGG","isoWeekYear"),en("GGGGG","isoWeekYear"),H("weekYear","gg"),H("isoWeekYear","GG"),L("weekYear",1),L("isoWeekYear",1),ue("G",se),ue("g",se),ue("GG",B,z),ue("gg",B,z),ue("GGGG",ee,q),ue("gggg",ee,q),ue("GGGGG",te,J),ue("ggggg",te,J),fe(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,s){t[s.substr(0,2)]=k(e)}),fe(["gg","GG"],function(e,t,n,s){t[s]=c.parseTwoDigitYear(e)}),I("Q",0,"Qo","quarter"),H("quarter","Q"),L("quarter",7),ue("Q",Z),ce("Q",function(e,t){t[_e]=3*(k(e)-1)}),I("D",["DD",2],"Do","date"),H("date","D"),L("date",9),ue("D",B),ue("DD",B,z),ue("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),ce(["D","DD"],ye),ce("Do",function(e,t){t[ye]=k(e.match(B)[0])});var nn=Te("Date",!0);I("DDD",["DDDD",3],"DDDo","dayOfYear"),H("dayOfYear","DDD"),L("dayOfYear",4),ue("DDD",K),ue("DDDD",$),ce(["DDD","DDDD"],function(e,t,n){n._dayOfYear=k(e)}),I("m",["mm",2],0,"minute"),H("minute","m"),L("minute",14),ue("m",B),ue("mm",B,z),ce(["m","mm"],pe);var sn=Te("Minutes",!1);I("s",["ss",2],0,"second"),H("second","s"),L("second",15),ue("s",B),ue("ss",B,z),ce(["s","ss"],ve);var rn,an=Te("Seconds",!1);for(I("S",0,0,function(){return~~(this.millisecond()/100)}),I(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),I(0,["SSS",3],0,"millisecond"),I(0,["SSSS",4],0,function(){return 10*this.millisecond()}),I(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),I(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),I(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),I(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),I(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),H("millisecond","ms"),L("millisecond",16),ue("S",K,Z),ue("SS",K,z),ue("SSS",K,$),rn="SSSS";rn.length<=9;rn+="S")ue(rn,ne);function on(e,t){t[we]=k(1e3*("0."+e))}for(rn="S";rn.length<=9;rn+="S")ce(rn,on);var un=Te("Milliseconds",!1);I("z",0,0,"zoneAbbr"),I("zz",0,0,"zoneName");var ln=M.prototype;function dn(e){return e}ln.add=qt,ln.calendar=function(e,t){var n=e||Tt(),s=Nt(n,this).startOf("day"),i=c.calendarFormat(this,s)||"sameElse",r=t&&(x(t[i])?t[i].call(this,n):t[i]);return this.format(r||this.localeData().calendar(i,this,Tt(n)))},ln.clone=function(){return new M(this)},ln.diff=function(e,t,n){var s,i,r;if(!this.isValid())return NaN;if(!(s=Nt(e,this)).isValid())return NaN;switch(i=6e4*(s.utcOffset()-this.utcOffset()),t=R(t)){case"year":r=Bt(this,s)/12;break;case"month":r=Bt(this,s);break;case"quarter":r=Bt(this,s)/3;break;case"second":r=(this-s)/1e3;break;case"minute":r=(this-s)/6e4;break;case"hour":r=(this-s)/36e5;break;case"day":r=(this-s-i)/864e5;break;case"week":r=(this-s-i)/6048e5;break;default:r=this-s}return n?r:D(r)},ln.endOf=function(e){return void 0===(e=R(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))},ln.format=function(e){e||(e=this.isUtc()?c.defaultFormatUtc:c.defaultFormat);var t=A(this,e);return this.localeData().postformat(t)},ln.from=function(e,t){return this.isValid()&&(S(e)&&e.isValid()||Tt(e).isValid())?At({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},ln.fromNow=function(e){return this.from(Tt(),e)},ln.to=function(e,t){return this.isValid()&&(S(e)&&e.isValid()||Tt(e).isValid())?At({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},ln.toNow=function(e){return this.to(Tt(),e)},ln.get=function(e){return x(this[e=R(e)])?this[e]():this},ln.invalidAt=function(){return g(this).overflow},ln.isAfter=function(e,t){var n=S(e)?e:Tt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(l(t)?"millisecond":t))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},ln.isBefore=function(e,t){var n=S(e)?e:Tt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=R(l(t)?"millisecond":t))?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},ln.isBetween=function(e,t,n,s){return("("===(s=s||"()")[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===s[1]?this.isBefore(t,n):!this.isAfter(t,n))},ln.isSame=function(e,t){var n,s=S(e)?e:Tt(e);return!(!this.isValid()||!s.isValid())&&("millisecond"===(t=R(t||"millisecond"))?this.valueOf()===s.valueOf():(n=s.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},ln.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},ln.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},ln.isValid=function(){return p(this)},ln.lang=Xt,ln.locale=Qt,ln.localeData=Kt,ln.max=bt,ln.min=xt,ln.parsingFlags=function(){return _({},g(this))},ln.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:F[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}(e=C(e)),s=0;s<n.length;s++)this[n[s].unit](e[n[s].unit]);else if(x(this[e=R(e)]))return this[e](t);return this},ln.startOf=function(e){switch(e=R(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},ln.subtract=Jt,ln.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},ln.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},ln.toDate=function(){return new Date(this.valueOf())},ln.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||9999<n.year()?A(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):x(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",A(n,"Z")):A(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},ln.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i=t+'[")]';return this.format(n+s+"-MM-DD[T]HH:mm:ss.SSS"+i)},ln.toJSON=function(){return this.isValid()?this.toISOString():null},ln.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},ln.unix=function(){return Math.floor(this.valueOf()/1e3)},ln.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},ln.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},ln.year=Oe,ln.isLeapYear=function(){return ke(this.year())},ln.weekYear=function(e){return tn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},ln.isoWeekYear=function(e){return tn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},ln.quarter=ln.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},ln.month=Fe,ln.daysInMonth=function(){return Pe(this.year(),this.month())},ln.week=ln.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},ln.isoWeek=ln.isoWeeks=function(e){var t=Ie(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},ln.weeksInYear=function(){var e=this.localeData()._week;return Ae(this.year(),e.dow,e.doy)},ln.isoWeeksInYear=function(){return Ae(this.year(),1,4)},ln.date=nn,ln.day=ln.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t,n,s=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(t=e,n=this.localeData(),e="string"!=typeof t?t:isNaN(t)?"number"==typeof(t=n.weekdaysParse(t))?t:null:parseInt(t,10),this.add(e-s,"d")):s},ln.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},ln.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=(n=e,s=this.localeData(),"string"==typeof n?s.weekdaysParse(n)%7||7:isNaN(n)?null:n);return this.day(this.day()%7?t:t-7)}return this.day()||7;var n,s},ln.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},ln.hour=ln.hours=tt,ln.minute=ln.minutes=sn,ln.second=ln.seconds=an,ln.millisecond=ln.milliseconds=un,ln.utcOffset=function(e,t,n){var s,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Ut(re,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(s=Gt(this)),this._offset=e,this._isUTC=!0,null!=s&&this.add(s,"m"),i!==e&&(!t||this._changeInProgress?$t(this,At(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,c.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:Gt(this)},ln.utc=function(e){return this.utcOffset(0,e)},ln.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Gt(this),"m")),this},ln.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Ut(ie,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},ln.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Tt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},ln.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},ln.isLocal=function(){return!!this.isValid()&&!this._isUTC},ln.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},ln.isUtc=Vt,ln.isUTC=Vt,ln.zoneAbbr=function(){return this._isUTC?"UTC":""},ln.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},ln.dates=n("dates accessor is deprecated. Use date instead.",nn),ln.months=n("months accessor is deprecated. Use month instead",Fe),ln.years=n("years accessor is deprecated. Use year instead",Oe),ln.zone=n("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),ln.isDSTShifted=n("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!l(this._isDSTShifted))return this._isDSTShifted;var e={};if(w(e,this),(e=Yt(e))._a){var t=e._isUTC?y(e._a):Tt(e._a);this._isDSTShifted=this.isValid()&&0<a(e._a,t.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var hn=P.prototype;function cn(e,t,n,s){var i=lt(),r=y().set(s,t);return i[n](r,e)}function fn(e,t,n){if(d(e)&&(t=e,e=void 0),e=e||"",null!=t)return cn(e,t,n,"month");var s,i=[];for(s=0;s<12;s++)i[s]=cn(e,s,n,"month");return i}function mn(e,t,n,s){"boolean"==typeof e?d(t)&&(n=t,t=void 0):(t=e,e=!1,d(n=t)&&(n=t,t=void 0)),t=t||"";var i,r=lt(),a=e?r._week.dow:0;if(null!=n)return cn(t,(n+a)%7,s,"day");var o=[];for(i=0;i<7;i++)o[i]=cn(t,(i+a)%7,s,"day");return o}hn.calendar=function(e,t,n){var s=this._calendar[e]||this._calendar.sameElse;return x(s)?s.call(t,n):s},hn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},hn.invalidDate=function(){return this._invalidDate},hn.ordinal=function(e){return this._ordinal.replace("%d",e)},hn.preparse=dn,hn.postformat=dn,hn.relativeTime=function(e,t,n,s){var i=this._relativeTime[n];return x(i)?i(e,t,n,s):i.replace(/%d/i,e)},hn.pastFuture=function(e,t){var n=this._relativeTime[0<e?"future":"past"];return x(n)?n(t):n.replace(/%s/i,t)},hn.set=function(e){var t,n;for(n in e)x(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},hn.months=function(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||We).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone},hn.monthsShort=function(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[We.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},hn.monthsParse=function(e,t,n){var s,i,r;if(this._monthsParseExact)return function(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=y([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Ye.call(this._shortMonthsParse,a))?i:null:-1!==(i=Ye.call(this._longMonthsParse,a))?i:null:"MMM"===t?-1!==(i=Ye.call(this._shortMonthsParse,a))?i:-1!==(i=Ye.call(this._longMonthsParse,a))?i:null:-1!==(i=Ye.call(this._longMonthsParse,a))?i:-1!==(i=Ye.call(this._shortMonthsParse,a))?i:null}.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(i=y([2e3,s]),n&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[s]||(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[s]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[s].test(e))return s;if(n&&"MMM"===t&&this._shortMonthsParse[s].test(e))return s;if(!n&&this._monthsParse[s].test(e))return s}},hn.monthsRegex=function(e){return this._monthsParseExact?(m(this,"_monthsRegex")||Ne.call(this),e?this._monthsStrictRegex:this._monthsRegex):(m(this,"_monthsRegex")||(this._monthsRegex=Ue),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},hn.monthsShortRegex=function(e){return this._monthsParseExact?(m(this,"_monthsRegex")||Ne.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(m(this,"_monthsShortRegex")||(this._monthsShortRegex=Le),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},hn.week=function(e){return Ie(e,this._week.dow,this._week.doy).week},hn.firstDayOfYear=function(){return this._week.doy},hn.firstDayOfWeek=function(){return this._week.dow},hn.weekdays=function(e,t){return e?o(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:o(this._weekdays)?this._weekdays:this._weekdays.standalone},hn.weekdaysMin=function(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin},hn.weekdaysShort=function(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort},hn.weekdaysParse=function(e,t,n){var s,i,r;if(this._weekdaysParseExact)return function(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=y([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Ye.call(this._weekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:"dddd"===t?-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:null:-1!==(i=Ye.call(this._minWeekdaysParse,a))?i:-1!==(i=Ye.call(this._weekdaysParse,a))?i:-1!==(i=Ye.call(this._shortWeekdaysParse,a))?i:null}.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(i=y([2e3,1]).day(s),n&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[s]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[s]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[s].test(e))return s;if(n&&"ddd"===t&&this._shortWeekdaysParse[s].test(e))return s;if(n&&"dd"===t&&this._minWeekdaysParse[s].test(e))return s;if(!n&&this._weekdaysParse[s].test(e))return s}},hn.weekdaysRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(m(this,"_weekdaysRegex")||(this._weekdaysRegex=$e),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},hn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(m(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=qe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},hn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(m(this,"_weekdaysRegex")||Be.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(m(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Je),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},hn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},hn.meridiem=function(e,t,n){return 11<e?n?"pm":"PM":n?"am":"AM"},ot("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===k(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),c.lang=n("moment.lang is deprecated. Use moment.locale instead.",ot),c.langData=n("moment.langData is deprecated. Use moment.localeData instead.",lt);var _n=Math.abs;function yn(e,t,n,s){var i=At(t,n);return e._milliseconds+=s*i._milliseconds,e._days+=s*i._days,e._months+=s*i._months,e._bubble()}function gn(e){return e<0?Math.floor(e):Math.ceil(e)}function pn(e){return 4800*e/146097}function vn(e){return 146097*e/4800}function wn(e){return function(){return this.as(e)}}var Mn=wn("ms"),Sn=wn("s"),Dn=wn("m"),kn=wn("h"),Yn=wn("d"),On=wn("w"),Tn=wn("M"),xn=wn("y");function bn(e){return function(){return this.isValid()?this._data[e]:NaN}}var Pn=bn("milliseconds"),Wn=bn("seconds"),Hn=bn("minutes"),Rn=bn("hours"),Cn=bn("days"),Fn=bn("months"),Ln=bn("years");var Un=Math.round,Nn={ss:44,s:45,m:45,h:22,d:26,M:11};var Gn=Math.abs;function Vn(e){return(0<e)-(e<0)||+e}function En(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=Gn(this._milliseconds)/1e3,s=Gn(this._days),i=Gn(this._months);t=D((e=D(n/60))/60),n%=60,e%=60;var r=D(i/12),a=i%=12,o=s,u=t,l=e,d=n?n.toFixed(3).replace(/\.?0+$/,""):"",h=this.asSeconds();if(!h)return"P0D";var c=h<0?"-":"",f=Vn(this._months)!==Vn(h)?"-":"",m=Vn(this._days)!==Vn(h)?"-":"",_=Vn(this._milliseconds)!==Vn(h)?"-":"";return c+"P"+(r?f+r+"Y":"")+(a?f+a+"M":"")+(o?m+o+"D":"")+(u||l||d?"T":"")+(u?_+u+"H":"")+(l?_+l+"M":"")+(d?_+d+"S":"")}var In=Ht.prototype;return In.isValid=function(){return this._isValid},In.abs=function(){var e=this._data;return this._milliseconds=_n(this._milliseconds),this._days=_n(this._days),this._months=_n(this._months),e.milliseconds=_n(e.milliseconds),e.seconds=_n(e.seconds),e.minutes=_n(e.minutes),e.hours=_n(e.hours),e.months=_n(e.months),e.years=_n(e.years),this},In.add=function(e,t){return yn(this,e,t,1)},In.subtract=function(e,t){return yn(this,e,t,-1)},In.as=function(e){if(!this.isValid())return NaN;var t,n,s=this._milliseconds;if("month"===(e=R(e))||"year"===e)return t=this._days+s/864e5,n=this._months+pn(t),"month"===e?n:n/12;switch(t=this._days+Math.round(vn(this._months)),e){case"week":return t/7+s/6048e5;case"day":return t+s/864e5;case"hour":return 24*t+s/36e5;case"minute":return 1440*t+s/6e4;case"second":return 86400*t+s/1e3;case"millisecond":return Math.floor(864e5*t)+s;default:throw new Error("Unknown unit "+e)}},In.asMilliseconds=Mn,In.asSeconds=Sn,In.asMinutes=Dn,In.asHours=kn,In.asDays=Yn,In.asWeeks=On,In.asMonths=Tn,In.asYears=xn,In.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*k(this._months/12):NaN},In._bubble=function(){var e,t,n,s,i,r=this._milliseconds,a=this._days,o=this._months,u=this._data;return 0<=r&&0<=a&&0<=o||r<=0&&a<=0&&o<=0||(r+=864e5*gn(vn(o)+a),o=a=0),u.milliseconds=r%1e3,e=D(r/1e3),u.seconds=e%60,t=D(e/60),u.minutes=t%60,n=D(t/60),u.hours=n%24,o+=i=D(pn(a+=D(n/24))),a-=gn(vn(i)),s=D(o/12),o%=12,u.days=a,u.months=o,u.years=s,this},In.clone=function(){return At(this)},In.get=function(e){return e=R(e),this.isValid()?this[e+"s"]():NaN},In.milliseconds=Pn,In.seconds=Wn,In.minutes=Hn,In.hours=Rn,In.days=Cn,In.weeks=function(){return D(this.days()/7)},In.months=Fn,In.years=Ln,In.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t,n,s,i,r,a,o,u,l,d,h,c=this.localeData(),f=(n=!e,s=c,i=At(t=this).abs(),r=Un(i.as("s")),a=Un(i.as("m")),o=Un(i.as("h")),u=Un(i.as("d")),l=Un(i.as("M")),d=Un(i.as("y")),(h=r<=Nn.ss&&["s",r]||r<Nn.s&&["ss",r]||a<=1&&["m"]||a<Nn.m&&["mm",a]||o<=1&&["h"]||o<Nn.h&&["hh",o]||u<=1&&["d"]||u<Nn.d&&["dd",u]||l<=1&&["M"]||l<Nn.M&&["MM",l]||d<=1&&["y"]||["yy",d])[2]=n,h[3]=0<+t,h[4]=s,function(e,t,n,s,i){return i.relativeTime(t||1,!!n,e,s)}.apply(null,h));return e&&(f=c.pastFuture(+this,f)),c.postformat(f)},In.toISOString=En,In.toString=En,In.toJSON=En,In.locale=Qt,In.localeData=Kt,In.toIsoString=n("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",En),In.lang=Xt,I("X",0,0,"unix"),I("x",0,0,"valueOf"),ue("x",se),ue("X",/[+-]?\d+(\.\d{1,3})?/),ce("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),ce("x",function(e,t,n){n._d=new Date(k(e))}),c.version="2.22.1",e=Tt,c.fn=ln,c.min=function(){return Pt("isBefore",[].slice.call(arguments,0))},c.max=function(){return Pt("isAfter",[].slice.call(arguments,0))},c.now=function(){return Date.now?Date.now():+new Date},c.utc=y,c.unix=function(e){return Tt(1e3*e)},c.months=function(e,t){return fn(e,t,"months")},c.isDate=h,c.locale=ot,c.invalid=v,c.duration=At,c.isMoment=S,c.weekdays=function(e,t,n){return mn(e,t,n,"weekdays")},c.parseZone=function(){return Tt.apply(null,arguments).parseZone()},c.localeData=lt,c.isDuration=Rt,c.monthsShort=function(e,t){return fn(e,t,"monthsShort")},c.weekdaysMin=function(e,t,n){return mn(e,t,n,"weekdaysMin")},c.defineLocale=ut,c.updateLocale=function(e,t){if(null!=t){var n,s,i=nt;null!=(s=at(e))&&(i=s._config),(n=new P(t=b(i,t))).parentLocale=st[e],st[e]=n,ot(e)}else null!=st[e]&&(null!=st[e].parentLocale?st[e]=st[e].parentLocale:null!=st[e]&&delete st[e]);return st[e]},c.locales=function(){return s(st)},c.weekdaysShort=function(e,t,n){return mn(e,t,n,"weekdaysShort")},c.normalizeUnits=R,c.relativeTimeRounding=function(e){return void 0===e?Un:"function"==typeof e&&(Un=e,!0)},c.relativeTimeThreshold=function(e,t){return void 0!==Nn[e]&&(void 0===t?Nn[e]:(Nn[e]=t,"s"===e&&(Nn.ss=t-1),!0))},c.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},c.prototype=ln,c.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},c});
!function(n){function t(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var e={};t.m=n,t.c=e,t.i=function(n){return n},t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:r})},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=4)}([function(n,t,e){"use strict";!function(n){function t(n){var t=n||"the-accordion";null!==(i=document.querySelector("#"+t))&&(a=i.querySelectorAll(".accordion-panel"),a.length>0&&e())}function e(){f=u(),a.forEach(function(n){n.querySelector("a").addEventListener("click",r)})}function r(n){n.preventDefault();var t=n.currentTarget.parentElement.parentElement;f!==t&&(c(),o(t))}function o(n){n.classList.add(l),f=n}function c(){if(void 0===f)return this;f.classList.remove(l)}function u(){for(var n=0;n<a.length;n++)if(a[n].classList.contains(l))return a[n]}var i=null,l="is-active",a=null,f=null;n.AccordionJS=t}(window)},,,,function(n,t,e){n.exports=e(0)}]);
/*!
 * Chart.js
 * http://chartjs.org/
 * Version: 2.7.3
 *
 * Copyright 2018 Chart.js Contributors
 * Released under the MIT license
 * https://github.com/chartjs/Chart.js/blob/master/LICENSE.md
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Chart=t()}}(function(){return function o(r,s,l){function u(e,t){if(!s[e]){if(!r[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(d)return d(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var a=s[e]={exports:{}};r[e][0].call(a.exports,function(t){return u(r[e][1][t]||t)},a,a.exports,o,r,s,l)}return s[e].exports}for(var d="function"==typeof require&&require,t=0;t<l.length;t++)u(l[t]);return u}({1:[function(t,e,i){},{}],2:[function(t,e,i){var o=t(6);function n(t){if(t){var e=[0,0,0],i=1,n=t.match(/^#([a-fA-F0-9]{3})$/i);if(n){n=n[1];for(var a=0;a<e.length;a++)e[a]=parseInt(n[a]+n[a],16)}else if(n=t.match(/^#([a-fA-F0-9]{6})$/i)){n=n[1];for(a=0;a<e.length;a++)e[a]=parseInt(n.slice(2*a,2*a+2),16)}else if(n=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(a=0;a<e.length;a++)e[a]=parseInt(n[a+1]);i=parseFloat(n[4])}else if(n=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(a=0;a<e.length;a++)e[a]=Math.round(2.55*parseFloat(n[a+1]));i=parseFloat(n[4])}else if(n=t.match(/(\w+)/)){if("transparent"==n[1])return[0,0,0,0];if(!(e=o[n[1]]))return}for(a=0;a<e.length;a++)e[a]=d(e[a],0,255);return i=i||0==i?d(i,0,1):1,e[3]=i,e}}function a(t){if(t){var e=t.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var i=parseFloat(e[4]);return[d(parseInt(e[1]),0,360),d(parseFloat(e[2]),0,100),d(parseFloat(e[3]),0,100),d(isNaN(i)?1:i,0,1)]}}}function r(t){if(t){var e=t.match(/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(e){var i=parseFloat(e[4]);return[d(parseInt(e[1]),0,360),d(parseFloat(e[2]),0,100),d(parseFloat(e[3]),0,100),d(isNaN(i)?1:i,0,1)]}}}function s(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+e+")"}function l(t,e){return"rgba("+Math.round(t[0]/255*100)+"%, "+Math.round(t[1]/255*100)+"%, "+Math.round(t[2]/255*100)+"%, "+(e||t[3]||1)+")"}function u(t,e){return void 0===e&&(e=void 0!==t[3]?t[3]:1),"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+e+")"}function d(t,e,i){return Math.min(Math.max(e,t),i)}function c(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}e.exports={getRgba:n,getHsla:a,getRgb:function(t){var e=n(t);return e&&e.slice(0,3)},getHsl:function(t){var e=a(t);return e&&e.slice(0,3)},getHwb:r,getAlpha:function(t){var e=n(t);{if(e)return e[3];if(e=a(t))return e[3];if(e=r(t))return e[3]}},hexString:function(t){return"#"+c(t[0])+c(t[1])+c(t[2])},rgbString:function(t,e){if(e<1||t[3]&&t[3]<1)return s(t,e);return"rgb("+t[0]+", "+t[1]+", "+t[2]+")"},rgbaString:s,percentString:function(t,e){if(e<1||t[3]&&t[3]<1)return l(t,e);var i=Math.round(t[0]/255*100),n=Math.round(t[1]/255*100),a=Math.round(t[2]/255*100);return"rgb("+i+"%, "+n+"%, "+a+"%)"},percentaString:l,hslString:function(t,e){if(e<1||t[3]&&t[3]<1)return u(t,e);return"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)"},hslaString:u,hwbString:function(t,e){void 0===e&&(e=void 0!==t[3]?t[3]:1);return"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+(void 0!==e&&1!==e?", "+e:"")+")"},keyword:function(t){return h[t.slice(0,3)]}};var h={};for(var f in o)h[o[f]]=f},{6:6}],3:[function(t,e,i){var d=t(5),n=t(2),r=function(t){return t instanceof r?t:this instanceof r?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"==typeof t?(e=n.getRgba(t))?this.setValues("rgb",e):(e=n.getHsla(t))?this.setValues("hsl",e):(e=n.getHwb(t))&&this.setValues("hwb",e):"object"==typeof t&&(void 0!==(e=t).r||void 0!==e.red?this.setValues("rgb",e):void 0!==e.l||void 0!==e.lightness?this.setValues("hsl",e):void 0!==e.v||void 0!==e.value?this.setValues("hsv",e):void 0!==e.w||void 0!==e.whiteness?this.setValues("hwb",e):void 0===e.c&&void 0===e.cyan||this.setValues("cmyk",e)))):new r(t);var e};r.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var t=this.values;return 1!==t.alpha?t.hwb.concat([t.alpha]):t.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var t=this.values;return t.rgb.concat([t.alpha])},hslaArray:function(){var t=this.values;return t.hsl.concat([t.alpha])},alpha:function(t){return void 0===t?this.values.alpha:(this.setValues("alpha",t),this)},red:function(t){return this.setChannel("rgb",0,t)},green:function(t){return this.setChannel("rgb",1,t)},blue:function(t){return this.setChannel("rgb",2,t)},hue:function(t){return t&&(t=(t%=360)<0?360+t:t),this.setChannel("hsl",0,t)},saturation:function(t){return this.setChannel("hsl",1,t)},lightness:function(t){return this.setChannel("hsl",2,t)},saturationv:function(t){return this.setChannel("hsv",1,t)},whiteness:function(t){return this.setChannel("hwb",1,t)},blackness:function(t){return this.setChannel("hwb",2,t)},value:function(t){return this.setChannel("hsv",2,t)},cyan:function(t){return this.setChannel("cmyk",0,t)},magenta:function(t){return this.setChannel("cmyk",1,t)},yellow:function(t){return this.setChannel("cmyk",2,t)},black:function(t){return this.setChannel("cmyk",3,t)},hexString:function(){return n.hexString(this.values.rgb)},rgbString:function(){return n.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return n.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return n.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return n.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return n.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return n.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return n.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var t=this.values.rgb;return t[0]<<16|t[1]<<8|t[2]},luminosity:function(){for(var t=this.values.rgb,e=[],i=0;i<t.length;i++){var n=t[i]/255;e[i]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),i=t.luminosity();return i<e?(e+.05)/(i+.05):(i+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return 7.1<=e?"AAA":4.5<=e?"AA":""},dark:function(){var t=this.values.rgb;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var t=[],e=0;e<3;e++)t[e]=255-this.values.rgb[e];return this.setValues("rgb",t),this},lighten:function(t){var e=this.values.hsl;return e[2]+=e[2]*t,this.setValues("hsl",e),this},darken:function(t){var e=this.values.hsl;return e[2]-=e[2]*t,this.setValues("hsl",e),this},saturate:function(t){var e=this.values.hsl;return e[1]+=e[1]*t,this.setValues("hsl",e),this},desaturate:function(t){var e=this.values.hsl;return e[1]-=e[1]*t,this.setValues("hsl",e),this},whiten:function(t){var e=this.values.hwb;return e[1]+=e[1]*t,this.setValues("hwb",e),this},blacken:function(t){var e=this.values.hwb;return e[2]+=e[2]*t,this.setValues("hwb",e),this},greyscale:function(){var t=this.values.rgb,e=.3*t[0]+.59*t[1]+.11*t[2];return this.setValues("rgb",[e,e,e]),this},clearer:function(t){var e=this.values.alpha;return this.setValues("alpha",e-e*t),this},opaquer:function(t){var e=this.values.alpha;return this.setValues("alpha",e+e*t),this},rotate:function(t){var e=this.values.hsl,i=(e[0]+t)%360;return e[0]=i<0?360+i:i,this.setValues("hsl",e),this},mix:function(t,e){var i=this,n=t,a=void 0===e?.5:e,o=2*a-1,r=i.alpha()-n.alpha(),s=((o*r==-1?o:(o+r)/(1+o*r))+1)/2,l=1-s;return this.rgb(s*i.red()+l*n.red(),s*i.green()+l*n.green(),s*i.blue()+l*n.blue()).alpha(i.alpha()*a+n.alpha()*(1-a))},toJSON:function(){return this.rgb()},clone:function(){var t,e,i=new r,n=this.values,a=i.values;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],"[object Array]"===(e={}.toString.call(t))?a[o]=t.slice(0):"[object Number]"===e?a[o]=t:console.error("unexpected color value:",t));return i}},r.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},r.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},r.prototype.getValues=function(t){for(var e=this.values,i={},n=0;n<t.length;n++)i[t.charAt(n)]=e[t][n];return 1!==e.alpha&&(i.a=e.alpha),i},r.prototype.setValues=function(t,e){var i,n,a=this.values,o=this.spaces,r=this.maxes,s=1;if(this.valid=!0,"alpha"===t)s=e;else if(e.length)a[t]=e.slice(0,t.length),s=e[t.length];else if(void 0!==e[t.charAt(0)]){for(i=0;i<t.length;i++)a[t][i]=e[t.charAt(i)];s=e.a}else if(void 0!==e[o[t][0]]){var l=o[t];for(i=0;i<t.length;i++)a[t][i]=e[l[i]];s=e.alpha}if(a.alpha=Math.max(0,Math.min(1,void 0===s?a.alpha:s)),"alpha"===t)return!1;for(i=0;i<t.length;i++)n=Math.max(0,Math.min(r[t][i],a[t][i])),a[t][i]=Math.round(n);for(var u in o)u!==t&&(a[u]=d[t][u](a[t]));return!0},r.prototype.setSpace=function(t,e){var i=e[0];return void 0===i?this.getValues(t):("number"==typeof i&&(i=Array.prototype.slice.call(e)),this.setValues(t,i),this)},r.prototype.setChannel=function(t,e,i){var n=this.values[t];return void 0===i?n[e]:(i===n[e]||(n[e]=i,this.setValues(t,n)),this)},"undefined"!=typeof window&&(window.Color=r),e.exports=r},{2:2,5:5}],4:[function(t,e,i){function a(t){var e,i,n=t[0]/255,a=t[1]/255,o=t[2]/255,r=Math.min(n,a,o),s=Math.max(n,a,o),l=s-r;return s==r?e=0:n==s?e=(a-o)/l:a==s?e=2+(o-n)/l:o==s&&(e=4+(n-a)/l),(e=Math.min(60*e,360))<0&&(e+=360),i=(r+s)/2,[e,100*(s==r?0:i<=.5?l/(s+r):l/(2-s-r)),100*i]}function n(t){var e,i,n=t[0],a=t[1],o=t[2],r=Math.min(n,a,o),s=Math.max(n,a,o),l=s-r;return i=0==s?0:l/s*1e3/10,s==r?e=0:n==s?e=(a-o)/l:a==s?e=2+(o-n)/l:o==s&&(e=4+(n-a)/l),(e=Math.min(60*e,360))<0&&(e+=360),[e,i,s/255*1e3/10]}function o(t){var e=t[0],i=t[1],n=t[2];return[a(t)[0],100*(1/255*Math.min(e,Math.min(i,n))),100*(n=1-1/255*Math.max(e,Math.max(i,n)))]}function s(t){var e,i=t[0]/255,n=t[1]/255,a=t[2]/255;return[100*((1-i-(e=Math.min(1-i,1-n,1-a)))/(1-e)||0),100*((1-n-e)/(1-e)||0),100*((1-a-e)/(1-e)||0),100*e]}function l(t){return S[JSON.stringify(t)]}function u(t){var e=t[0]/255,i=t[1]/255,n=t[2]/255;return[100*(.4124*(e=.04045<e?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(i=.04045<i?Math.pow((i+.055)/1.055,2.4):i/12.92)+.1805*(n=.04045<n?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*e+.7152*i+.0722*n),100*(.0193*e+.1192*i+.9505*n)]}function d(t){var e=u(t),i=e[0],n=e[1],a=e[2];return n/=100,a/=108.883,i=.008856<(i/=95.047)?Math.pow(i,1/3):7.787*i+16/116,[116*(n=.008856<n?Math.pow(n,1/3):7.787*n+16/116)-16,500*(i-n),200*(n-(a=.008856<a?Math.pow(a,1/3):7.787*a+16/116))]}function c(t){var e,i,n,a,o,r=t[0]/360,s=t[1]/100,l=t[2]/100;if(0==s)return[o=255*l,o,o];e=2*l-(i=l<.5?l*(1+s):l+s-l*s),a=[0,0,0];for(var u=0;u<3;u++)(n=r+1/3*-(u-1))<0&&n++,1<n&&n--,o=6*n<1?e+6*(i-e)*n:2*n<1?i:3*n<2?e+(i-e)*(2/3-n)*6:e,a[u]=255*o;return a}function h(t){var e=t[0]/60,i=t[1]/100,n=t[2]/100,a=Math.floor(e)%6,o=e-Math.floor(e),r=255*n*(1-i),s=255*n*(1-i*o),l=255*n*(1-i*(1-o));n*=255;switch(a){case 0:return[n,l,r];case 1:return[s,n,r];case 2:return[r,n,l];case 3:return[r,s,n];case 4:return[l,r,n];case 5:return[n,r,s]}}function f(t){var e,i,n,a,o=t[0]/360,s=t[1]/100,l=t[2]/100,u=s+l;switch(1<u&&(s/=u,l/=u),n=6*o-(e=Math.floor(6*o)),0!=(1&e)&&(n=1-n),a=s+n*((i=1-l)-s),e){default:case 6:case 0:r=i,g=a,b=s;break;case 1:r=a,g=i,b=s;break;case 2:r=s,g=i,b=a;break;case 3:r=s,g=a,b=i;break;case 4:r=a,g=s,b=i;break;case 5:r=i,g=s,b=a}return[255*r,255*g,255*b]}function p(t){var e=t[0]/100,i=t[1]/100,n=t[2]/100,a=t[3]/100;return[255*(1-Math.min(1,e*(1-a)+a)),255*(1-Math.min(1,i*(1-a)+a)),255*(1-Math.min(1,n*(1-a)+a))]}function m(t){var e,i,n,a=t[0]/100,o=t[1]/100,r=t[2]/100;return i=-.9689*a+1.8758*o+.0415*r,n=.0557*a+-.204*o+1.057*r,e=.0031308<(e=3.2406*a+-1.5372*o+-.4986*r)?1.055*Math.pow(e,1/2.4)-.055:e*=12.92,i=.0031308<i?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,n=.0031308<n?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,[255*(e=Math.min(Math.max(0,e),1)),255*(i=Math.min(Math.max(0,i),1)),255*(n=Math.min(Math.max(0,n),1))]}function v(t){var e=t[0],i=t[1],n=t[2];return i/=100,n/=108.883,e=.008856<(e/=95.047)?Math.pow(e,1/3):7.787*e+16/116,[116*(i=.008856<i?Math.pow(i,1/3):7.787*i+16/116)-16,500*(e-i),200*(i-(n=.008856<n?Math.pow(n,1/3):7.787*n+16/116))]}function x(t){var e,i,n,a,o=t[0],r=t[1],s=t[2];return a=o<=8?(i=100*o/903.3)/100*7.787+16/116:(i=100*Math.pow((o+16)/116,3),Math.pow(i/100,1/3)),[e=e/95.047<=.008856?e=95.047*(r/500+a-16/116)/7.787:95.047*Math.pow(r/500+a,3),i,n=n/108.883<=.008859?n=108.883*(a-s/200-16/116)/7.787:108.883*Math.pow(a-s/200,3)]}function y(t){var e,i=t[0],n=t[1],a=t[2];return(e=360*Math.atan2(a,n)/2/Math.PI)<0&&(e+=360),[i,Math.sqrt(n*n+a*a),e]}function k(t){return m(x(t))}function M(t){var e,i=t[0],n=t[1];return e=t[2]/360*2*Math.PI,[i,n*Math.cos(e),n*Math.sin(e)]}function w(t){return C[t]}e.exports={rgb2hsl:a,rgb2hsv:n,rgb2hwb:o,rgb2cmyk:s,rgb2keyword:l,rgb2xyz:u,rgb2lab:d,rgb2lch:function(t){return y(d(t))},hsl2rgb:c,hsl2hsv:function(t){var e=t[0],i=t[1]/100,n=t[2]/100;return 0!==n?[e,100*(2*(i*=(n*=2)<=1?n:2-n)/(n+i)),100*((n+i)/2)]:[0,0,0]},hsl2hwb:function(t){return o(c(t))},hsl2cmyk:function(t){return s(c(t))},hsl2keyword:function(t){return l(c(t))},hsv2rgb:h,hsv2hsl:function(t){var e,i,n=t[0],a=t[1]/100,o=t[2]/100;return e=a*o,[n,100*(e=(e/=(i=(2-a)*o)<=1?i:2-i)||0),100*(i/=2)]},hsv2hwb:function(t){return o(h(t))},hsv2cmyk:function(t){return s(h(t))},hsv2keyword:function(t){return l(h(t))},hwb2rgb:f,hwb2hsl:function(t){return a(f(t))},hwb2hsv:function(t){return n(f(t))},hwb2cmyk:function(t){return s(f(t))},hwb2keyword:function(t){return l(f(t))},cmyk2rgb:p,cmyk2hsl:function(t){return a(p(t))},cmyk2hsv:function(t){return n(p(t))},cmyk2hwb:function(t){return o(p(t))},cmyk2keyword:function(t){return l(p(t))},keyword2rgb:w,keyword2hsl:function(t){return a(w(t))},keyword2hsv:function(t){return n(w(t))},keyword2hwb:function(t){return o(w(t))},keyword2cmyk:function(t){return s(w(t))},keyword2lab:function(t){return d(w(t))},keyword2xyz:function(t){return u(w(t))},xyz2rgb:m,xyz2lab:v,xyz2lch:function(t){return y(v(t))},lab2xyz:x,lab2rgb:k,lab2lch:y,lch2lab:M,lch2xyz:function(t){return x(M(t))},lch2rgb:function(t){return k(M(t))}};var C={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},S={};for(var _ in C)S[JSON.stringify(C[_])]=_},{}],5:[function(t,e,i){var a=t(4),o=function(){return new u};for(var n in a){o[n+"Raw"]=function(e){return function(t){return"number"==typeof t&&(t=Array.prototype.slice.call(arguments)),a[e](t)}}(n);var r=/(\w+)2(\w+)/.exec(n),s=r[1],l=r[2];(o[s]=o[s]||{})[l]=o[n]=function(n){return function(t){"number"==typeof t&&(t=Array.prototype.slice.call(arguments));var e=a[n](t);if("string"==typeof e||void 0===e)return e;for(var i=0;i<e.length;i++)e[i]=Math.round(e[i]);return e}}(n)}var u=function(){this.convs={}};u.prototype.routeSpace=function(t,e){var i=e[0];return void 0===i?this.getValues(t):("number"==typeof i&&(i=Array.prototype.slice.call(e)),this.setValues(t,i))},u.prototype.setValues=function(t,e){return this.space=t,this.convs={},this.convs[t]=e,this},u.prototype.getValues=function(t){var e=this.convs[t];if(!e){var i=this.space,n=this.convs[i];e=o[i][t](n),this.convs[t]=e}return e},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(e){u.prototype[e]=function(t){return this.routeSpace(e,arguments)}}),e.exports=o},{4:4}],6:[function(t,e,i){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],7:[function(t,e,i){var n=t(30)();n.helpers=t(46),t(28)(n),n.Animation=t(22),n.animationService=t(23),n.defaults=t(26),n.Element=t(27),n.elements=t(41),n.Interaction=t(29),n.layouts=t(31),n.platform=t(49),n.plugins=t(32),n.Scale=t(33),n.scaleService=t(34),n.Ticks=t(35),n.Tooltip=t(36),t(24)(n),t(25)(n),t(56)(n),t(54)(n),t(55)(n),t(57)(n),t(58)(n),t(59)(n),t(15)(n),t(16)(n),t(17)(n),t(18)(n),t(19)(n),t(20)(n),t(21)(n),t(8)(n),t(9)(n),t(10)(n),t(11)(n),t(12)(n),t(13)(n),t(14)(n);var a=t(50);for(var o in a)a.hasOwnProperty(o)&&n.plugins.register(a[o]);n.platform.initialize(),e.exports=n,"undefined"!=typeof window&&(window.Chart=n),n.Legend=a.legend._element,n.Title=a.title._element,n.pluginService=n.plugins,n.PluginBase=n.Element.extend({}),n.canvasHelpers=n.helpers.canvas,n.layoutService=n.layouts},{10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,41:41,46:46,49:49,50:50,54:54,55:55,56:56,57:57,58:58,59:59,8:8,9:9}],8:[function(t,e,i){"use strict";e.exports=function(i){i.Bar=function(t,e){return e.type="bar",new i(t,e)}}},{}],9:[function(t,e,i){"use strict";e.exports=function(i){i.Bubble=function(t,e){return e.type="bubble",new i(t,e)}}},{}],10:[function(t,e,i){"use strict";e.exports=function(i){i.Doughnut=function(t,e){return e.type="doughnut",new i(t,e)}}},{}],11:[function(t,e,i){"use strict";e.exports=function(i){i.Line=function(t,e){return e.type="line",new i(t,e)}}},{}],12:[function(t,e,i){"use strict";e.exports=function(i){i.PolarArea=function(t,e){return e.type="polarArea",new i(t,e)}}},{}],13:[function(t,e,i){"use strict";e.exports=function(i){i.Radar=function(t,e){return e.type="radar",new i(t,e)}}},{}],14:[function(t,e,i){"use strict";e.exports=function(i){i.Scatter=function(t,e){return e.type="scatter",new i(t,e)}}},{}],15:[function(t,e,i){"use strict";var n=t(26),a=t(41),S=t(46);n._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}}),n._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{position:"left",type:"category",categoryPercentage:.8,barPercentage:.9,offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{callbacks:{title:function(t,e){var i="";return 0<t.length&&(t[0].yLabel?i=t[0].yLabel:0<e.labels.length&&t[0].index<e.labels.length&&(i=e.labels[t[0].index])),i},label:function(t,e){return(e.datasets[t.datasetIndex].label||"")+": "+t.xLabel}},mode:"index",axis:"y"}}),e.exports=function(e){e.controllers.bar=e.DatasetController.extend({dataElementType:a.Rectangle,initialize:function(){var t;e.DatasetController.prototype.initialize.apply(this,arguments),(t=this.getMeta()).stack=this.getDataset().stack,t.bar=!0},update:function(t){var e,i,n=this.getMeta().data;for(this._ruler=this.getRuler(),e=0,i=n.length;e<i;++e)this.updateElement(n[e],e,t)},updateElement:function(t,e,i){var n=this,a=n.chart,o=n.getMeta(),r=n.getDataset(),s=t.custom||{},l=a.options.elements.rectangle;t._xScale=n.getScaleForId(o.xAxisID),t._yScale=n.getScaleForId(o.yAxisID),t._datasetIndex=n.index,t._index=e,t._model={datasetLabel:r.label,label:a.data.labels[e],borderSkipped:s.borderSkipped?s.borderSkipped:l.borderSkipped,backgroundColor:s.backgroundColor?s.backgroundColor:S.valueAtIndexOrDefault(r.backgroundColor,e,l.backgroundColor),borderColor:s.borderColor?s.borderColor:S.valueAtIndexOrDefault(r.borderColor,e,l.borderColor),borderWidth:s.borderWidth?s.borderWidth:S.valueAtIndexOrDefault(r.borderWidth,e,l.borderWidth)},n.updateElementGeometry(t,e,i),t.pivot()},updateElementGeometry:function(t,e,i){var n=this,a=t._model,o=n.getValueScale(),r=o.getBasePixel(),s=o.isHorizontal(),l=n._ruler||n.getRuler(),u=n.calculateBarValuePixels(n.index,e),d=n.calculateBarIndexPixels(n.index,e,l);a.horizontal=s,a.base=i?r:u.base,a.x=s?i?r:u.head:d.center,a.y=s?d.center:i?r:u.head,a.height=s?d.size:void 0,a.width=s?void 0:d.size},getValueScaleId:function(){return this.getMeta().yAxisID},getIndexScaleId:function(){return this.getMeta().xAxisID},getValueScale:function(){return this.getScaleForId(this.getValueScaleId())},getIndexScale:function(){return this.getScaleForId(this.getIndexScaleId())},_getStacks:function(t){var e,i,n=this.chart,a=this.getIndexScale().options.stacked,o=void 0===t?n.data.datasets.length:t+1,r=[];for(e=0;e<o;++e)(i=n.getDatasetMeta(e)).bar&&n.isDatasetVisible(e)&&(!1===a||!0===a&&-1===r.indexOf(i.stack)||void 0===a&&(void 0===i.stack||-1===r.indexOf(i.stack)))&&r.push(i.stack);return r},getStackCount:function(){return this._getStacks().length},getStackIndex:function(t,e){var i=this._getStacks(t),n=void 0!==e?i.indexOf(e):-1;return-1===n?i.length-1:n},getRuler:function(){var t,e,i=this.getIndexScale(),n=this.getStackCount(),a=this.index,o=i.isHorizontal(),r=o?i.left:i.top,s=r+(o?i.width:i.height),l=[];for(t=0,e=this.getMeta().data.length;t<e;++t)l.push(i.getPixelForValue(null,t,a));return{min:S.isNullOrUndef(i.options.barThickness)?function(t,e){var i,n,a,o,r=t.isHorizontal()?t.width:t.height,s=t.getTicks();for(a=1,o=e.length;a<o;++a)r=Math.min(r,e[a]-e[a-1]);for(a=0,o=s.length;a<o;++a)n=t.getPixelForTick(a),r=0<a?Math.min(r,n-i):r,i=n;return r}(i,l):-1,pixels:l,start:r,end:s,stackCount:n,scale:i}},calculateBarValuePixels:function(t,e){var i,n,a,o,r,s,l=this.chart,u=this.getMeta(),d=this.getValueScale(),c=l.data.datasets,h=d.getRightValue(c[t].data[e]),f=d.options.stacked,g=u.stack,p=0;if(f||void 0===f&&void 0!==g)for(i=0;i<t;++i)(n=l.getDatasetMeta(i)).bar&&n.stack===g&&n.controller.getValueScaleId()===d.id&&l.isDatasetVisible(i)&&(a=d.getRightValue(c[i].data[e]),(h<0&&a<0||0<=h&&0<a)&&(p+=a));return o=d.getPixelForValue(p),{size:s=((r=d.getPixelForValue(p+h))-o)/2,base:o,head:r,center:r+s/2}},calculateBarIndexPixels:function(t,e,i){var n,a,o,r,s,l,u,d,c,h,f,g,p,m,v,b,x,y=i.scale.options,k="flex"===y.barThickness?(c=e,f=y,p=(h=i).pixels,m=p[c],v=0<c?p[c-1]:null,b=c<p.length-1?p[c+1]:null,x=f.categoryPercentage,null===v&&(v=m-(null===b?h.end-m:b-m)),null===b&&(b=m+m-v),g=m-(m-v)/2*x,{chunk:(b-v)/2*x/h.stackCount,ratio:f.barPercentage,start:g}):(n=e,a=i,l=(o=y).barThickness,u=a.stackCount,d=a.pixels[n],s=S.isNullOrUndef(l)?(r=a.min*o.categoryPercentage,o.barPercentage):(r=l*u,1),{chunk:r/u,ratio:s,start:d-r/2}),M=this.getStackIndex(t,this.getMeta().stack),w=k.start+k.chunk*M+k.chunk/2,C=Math.min(S.valueOrDefault(y.maxBarThickness,1/0),k.chunk*k.ratio);return{base:w-C/2,head:w+C/2,center:w,size:C}},draw:function(){var t=this.chart,e=this.getValueScale(),i=this.getMeta().data,n=this.getDataset(),a=i.length,o=0;for(S.canvas.clipArea(t.ctx,t.chartArea);o<a;++o)isNaN(e.getRightValue(n.data[o]))||i[o].draw();S.canvas.unclipArea(t.ctx)}}),e.controllers.horizontalBar=e.controllers.bar.extend({getValueScaleId:function(){return this.getMeta().xAxisID},getIndexScaleId:function(){return this.getMeta().yAxisID}})}},{26:26,41:41,46:46}],16:[function(t,e,i){"use strict";var n=t(26),a=t(41),g=t(46);n._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(t,e){var i=e.datasets[t.datasetIndex].label||"",n=e.datasets[t.datasetIndex].data[t.index];return i+": ("+t.xLabel+", "+t.yLabel+", "+n.r+")"}}}}),e.exports=function(t){t.controllers.bubble=t.DatasetController.extend({dataElementType:a.Point,update:function(i){var n=this,t=n.getMeta().data;g.each(t,function(t,e){n.updateElement(t,e,i)})},updateElement:function(t,e,i){var n=this,a=n.getMeta(),o=t.custom||{},r=n.getScaleForId(a.xAxisID),s=n.getScaleForId(a.yAxisID),l=n._resolveElementOptions(t,e),u=n.getDataset().data[e],d=n.index,c=i?r.getPixelForDecimal(.5):r.getPixelForValue("object"==typeof u?u:NaN,e,d),h=i?s.getBasePixel():s.getPixelForValue(u,e,d);t._xScale=r,t._yScale=s,t._options=l,t._datasetIndex=d,t._index=e,t._model={backgroundColor:l.backgroundColor,borderColor:l.borderColor,borderWidth:l.borderWidth,hitRadius:l.hitRadius,pointStyle:l.pointStyle,rotation:l.rotation,radius:i?0:l.radius,skip:o.skip||isNaN(c)||isNaN(h),x:c,y:h},t.pivot()},setHoverStyle:function(t){var e=t._model,i=t._options;t.$previousStyle={backgroundColor:e.backgroundColor,borderColor:e.borderColor,borderWidth:e.borderWidth,radius:e.radius},e.backgroundColor=g.valueOrDefault(i.hoverBackgroundColor,g.getHoverColor(i.backgroundColor)),e.borderColor=g.valueOrDefault(i.hoverBorderColor,g.getHoverColor(i.borderColor)),e.borderWidth=g.valueOrDefault(i.hoverBorderWidth,i.borderWidth),e.radius=i.radius+i.hoverRadius},_resolveElementOptions:function(t,e){var i,n,a,o=this.chart,r=o.data.datasets[this.index],s=t.custom||{},l=o.options.elements.point,u=g.options.resolve,d=r.data[e],c={},h={chart:o,dataIndex:e,dataset:r,datasetIndex:this.index},f=["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"];for(i=0,n=f.length;i<n;++i)c[a=f[i]]=u([s[a],r[a],l[a]],h,e);return c.radius=u([s.radius,d?d.r:void 0,r.radius,l.radius],h,e),c}})}},{26:26,41:41,46:46}],17:[function(t,e,i){"use strict";var n=t(26),a=t(41),A=t(46);n._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var i=t.data,n=i.datasets,a=i.labels;if(n.length)for(var o=0;o<n[0].data.length;++o)e.push('<li><span style="background-color:'+n[0].backgroundColor[o]+'"></span>'),a[o]&&e.push(a[o]),e.push("</li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(l){var u=l.data;return u.labels.length&&u.datasets.length?u.labels.map(function(t,e){var i=l.getDatasetMeta(0),n=u.datasets[0],a=i.data[e],o=a&&a.custom||{},r=A.valueAtIndexOrDefault,s=l.options.elements.arc;return{text:t,fillStyle:o.backgroundColor?o.backgroundColor:r(n.backgroundColor,e,s.backgroundColor),strokeStyle:o.borderColor?o.borderColor:r(n.borderColor,e,s.borderColor),lineWidth:o.borderWidth?o.borderWidth:r(n.borderWidth,e,s.borderWidth),hidden:isNaN(n.data[e])||i.data[e].hidden,index:e}}):[]}},onClick:function(t,e){var i,n,a,o=e.index,r=this.chart;for(i=0,n=(r.data.datasets||[]).length;i<n;++i)(a=r.getDatasetMeta(i)).data[o]&&(a.data[o].hidden=!a.data[o].hidden);r.update()}},cutoutPercentage:50,rotation:-.5*Math.PI,circumference:2*Math.PI,tooltips:{callbacks:{title:function(){return""},label:function(t,e){var i=e.labels[t.index],n=": "+e.datasets[t.datasetIndex].data[t.index];return A.isArray(i)?(i=i.slice())[0]+=n:i+=n,i}}}}),n._set("pie",A.clone(n.doughnut)),n._set("pie",{cutoutPercentage:0}),e.exports=function(t){t.controllers.doughnut=t.controllers.pie=t.DatasetController.extend({dataElementType:a.Arc,linkScales:A.noop,getRingIndex:function(t){for(var e=0,i=0;i<t;++i)this.chart.isDatasetVisible(i)&&++e;return e},update:function(i){var n=this,t=n.chart,e=t.chartArea,a=t.options,o=a.elements.arc,r=e.right-e.left-o.borderWidth,s=e.bottom-e.top-o.borderWidth,l=Math.min(r,s),u={x:0,y:0},d=n.getMeta(),c=a.cutoutPercentage,h=a.circumference;if(h<2*Math.PI){var f=a.rotation%(2*Math.PI),g=(f+=2*Math.PI*(f>=Math.PI?-1:f<-Math.PI?1:0))+h,p=Math.cos(f),m=Math.sin(f),v=Math.cos(g),b=Math.sin(g),x=f<=0&&0<=g||f<=2*Math.PI&&2*Math.PI<=g,y=f<=.5*Math.PI&&.5*Math.PI<=g||f<=2.5*Math.PI&&2.5*Math.PI<=g,k=f<=-Math.PI&&-Math.PI<=g||f<=Math.PI&&Math.PI<=g,M=f<=.5*-Math.PI&&.5*-Math.PI<=g||f<=1.5*Math.PI&&1.5*Math.PI<=g,w=c/100,C=k?-1:Math.min(p*(p<0?1:w),v*(v<0?1:w)),S=M?-1:Math.min(m*(m<0?1:w),b*(b<0?1:w)),_=x?1:Math.max(p*(0<p?1:w),v*(0<v?1:w)),D=y?1:Math.max(m*(0<m?1:w),b*(0<b?1:w)),P=.5*(_-C),I=.5*(D-S);l=Math.min(r/P,s/I),u={x:-.5*(_+C),y:-.5*(D+S)}}t.borderWidth=n.getMaxBorderWidth(d.data),t.outerRadius=Math.max((l-t.borderWidth)/2,0),t.innerRadius=Math.max(c?t.outerRadius/100*c:0,0),t.radiusLength=(t.outerRadius-t.innerRadius)/t.getVisibleDatasetCount(),t.offsetX=u.x*t.outerRadius,t.offsetY=u.y*t.outerRadius,d.total=n.calculateTotal(),n.outerRadius=t.outerRadius-t.radiusLength*n.getRingIndex(n.index),n.innerRadius=Math.max(n.outerRadius-t.radiusLength,0),A.each(d.data,function(t,e){n.updateElement(t,e,i)})},updateElement:function(t,e,i){var n=this,a=n.chart,o=a.chartArea,r=a.options,s=r.animation,l=(o.left+o.right)/2,u=(o.top+o.bottom)/2,d=r.rotation,c=r.rotation,h=n.getDataset(),f=i&&s.animateRotate?0:t.hidden?0:n.calculateCircumference(h.data[e])*(r.circumference/(2*Math.PI)),g=i&&s.animateScale?0:n.innerRadius,p=i&&s.animateScale?0:n.outerRadius,m=A.valueAtIndexOrDefault;A.extend(t,{_datasetIndex:n.index,_index:e,_model:{x:l+a.offsetX,y:u+a.offsetY,startAngle:d,endAngle:c,circumference:f,outerRadius:p,innerRadius:g,label:m(h.label,e,a.data.labels[e])}});var v=t._model,b=t.custom||{},x=A.valueAtIndexOrDefault,y=this.chart.options.elements.arc;v.backgroundColor=b.backgroundColor?b.backgroundColor:x(h.backgroundColor,e,y.backgroundColor),v.borderColor=b.borderColor?b.borderColor:x(h.borderColor,e,y.borderColor),v.borderWidth=b.borderWidth?b.borderWidth:x(h.borderWidth,e,y.borderWidth),i&&s.animateRotate||(v.startAngle=0===e?r.rotation:n.getMeta().data[e-1]._model.endAngle,v.endAngle=v.startAngle+v.circumference),t.pivot()},calculateTotal:function(){var i,n=this.getDataset(),t=this.getMeta(),a=0;return A.each(t.data,function(t,e){i=n.data[e],isNaN(i)||t.hidden||(a+=Math.abs(i))}),a},calculateCircumference:function(t){var e=this.getMeta().total;return 0<e&&!isNaN(t)?2*Math.PI*(Math.abs(t)/e):0},getMaxBorderWidth:function(t){for(var e,i,n=0,a=this.index,o=t.length,r=0;r<o;r++)n=(n=n<(e=t[r]._model?t[r]._model.borderWidth:0)?e:n)<(i=t[r]._chart?t[r]._chart.config.data.datasets[a].hoverBorderWidth:0)?i:n;return n}})}},{26:26,41:41,46:46}],18:[function(t,e,i){"use strict";var n=t(26),a=t(41),g=t(46);n._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}}),e.exports=function(t){function f(t,e){return g.valueOrDefault(t.showLine,e.showLines)}t.controllers.line=t.DatasetController.extend({datasetElementType:a.Line,dataElementType:a.Point,update:function(t){var e,i,n,a=this,o=a.getMeta(),r=o.dataset,s=o.data||[],l=a.chart.options,u=l.elements.line,d=a.getScaleForId(o.yAxisID),c=a.getDataset(),h=f(c,l);for(h&&(n=r.custom||{},void 0!==c.tension&&void 0===c.lineTension&&(c.lineTension=c.tension),r._scale=d,r._datasetIndex=a.index,r._children=s,r._model={spanGaps:c.spanGaps?c.spanGaps:l.spanGaps,tension:n.tension?n.tension:g.valueOrDefault(c.lineTension,u.tension),backgroundColor:n.backgroundColor?n.backgroundColor:c.backgroundColor||u.backgroundColor,borderWidth:n.borderWidth?n.borderWidth:c.borderWidth||u.borderWidth,borderColor:n.borderColor?n.borderColor:c.borderColor||u.borderColor,borderCapStyle:n.borderCapStyle?n.borderCapStyle:c.borderCapStyle||u.borderCapStyle,borderDash:n.borderDash?n.borderDash:c.borderDash||u.borderDash,borderDashOffset:n.borderDashOffset?n.borderDashOffset:c.borderDashOffset||u.borderDashOffset,borderJoinStyle:n.borderJoinStyle?n.borderJoinStyle:c.borderJoinStyle||u.borderJoinStyle,fill:n.fill?n.fill:void 0!==c.fill?c.fill:u.fill,steppedLine:n.steppedLine?n.steppedLine:g.valueOrDefault(c.steppedLine,u.stepped),cubicInterpolationMode:n.cubicInterpolationMode?n.cubicInterpolationMode:g.valueOrDefault(c.cubicInterpolationMode,u.cubicInterpolationMode)},r.pivot()),e=0,i=s.length;e<i;++e)a.updateElement(s[e],e,t);for(h&&0!==r._model.tension&&a.updateBezierControlPoints(),e=0,i=s.length;e<i;++e)s[e].pivot()},getPointBackgroundColor:function(t,e){var i=this.chart.options.elements.point.backgroundColor,n=this.getDataset(),a=t.custom||{};return a.backgroundColor?i=a.backgroundColor:n.pointBackgroundColor?i=g.valueAtIndexOrDefault(n.pointBackgroundColor,e,i):n.backgroundColor&&(i=n.backgroundColor),i},getPointBorderColor:function(t,e){var i=this.chart.options.elements.point.borderColor,n=this.getDataset(),a=t.custom||{};return a.borderColor?i=a.borderColor:n.pointBorderColor?i=g.valueAtIndexOrDefault(n.pointBorderColor,e,i):n.borderColor&&(i=n.borderColor),i},getPointBorderWidth:function(t,e){var i=this.chart.options.elements.point.borderWidth,n=this.getDataset(),a=t.custom||{};return isNaN(a.borderWidth)?!isNaN(n.pointBorderWidth)||g.isArray(n.pointBorderWidth)?i=g.valueAtIndexOrDefault(n.pointBorderWidth,e,i):isNaN(n.borderWidth)||(i=n.borderWidth):i=a.borderWidth,i},getPointRotation:function(t,e){var i=this.chart.options.elements.point.rotation,n=this.getDataset(),a=t.custom||{};return isNaN(a.rotation)?isNaN(n.pointRotation)&&!g.isArray(n.pointRotation)||(i=g.valueAtIndexOrDefault(n.pointRotation,e,i)):i=a.rotation,i},updateElement:function(t,e,i){var n,a,o=this,r=o.getMeta(),s=t.custom||{},l=o.getDataset(),u=o.index,d=l.data[e],c=o.getScaleForId(r.yAxisID),h=o.getScaleForId(r.xAxisID),f=o.chart.options.elements.point;void 0!==l.radius&&void 0===l.pointRadius&&(l.pointRadius=l.radius),void 0!==l.hitRadius&&void 0===l.pointHitRadius&&(l.pointHitRadius=l.hitRadius),n=h.getPixelForValue("object"==typeof d?d:NaN,e,u),a=i?c.getBasePixel():o.calculatePointY(d,e,u),t._xScale=h,t._yScale=c,t._datasetIndex=u,t._index=e,t._model={x:n,y:a,skip:s.skip||isNaN(n)||isNaN(a),radius:s.radius||g.valueAtIndexOrDefault(l.pointRadius,e,f.radius),pointStyle:s.pointStyle||g.valueAtIndexOrDefault(l.pointStyle,e,f.pointStyle),rotation:o.getPointRotation(t,e),backgroundColor:o.getPointBackgroundColor(t,e),borderColor:o.getPointBorderColor(t,e),borderWidth:o.getPointBorderWidth(t,e),tension:r.dataset._model?r.dataset._model.tension:0,steppedLine:!!r.dataset._model&&r.dataset._model.steppedLine,hitRadius:s.hitRadius||g.valueAtIndexOrDefault(l.pointHitRadius,e,f.hitRadius)}},calculatePointY:function(t,e,i){var n,a,o,r=this.chart,s=this.getMeta(),l=this.getScaleForId(s.yAxisID),u=0,d=0;if(l.options.stacked){for(n=0;n<i;n++)if(a=r.data.datasets[n],"line"===(o=r.getDatasetMeta(n)).type&&o.yAxisID===l.id&&r.isDatasetVisible(n)){var c=Number(l.getRightValue(a.data[e]));c<0?d+=c||0:u+=c||0}var h=Number(l.getRightValue(t));return h<0?l.getPixelForValue(d+h):l.getPixelForValue(u+h)}return l.getPixelForValue(t)},updateBezierControlPoints:function(){var t,e,i,n,a=this.getMeta(),o=this.chart.chartArea,r=a.data||[];function s(t,e,i){return Math.max(Math.min(t,i),e)}if(a.dataset._model.spanGaps&&(r=r.filter(function(t){return!t._model.skip})),"monotone"===a.dataset._model.cubicInterpolationMode)g.splineCurveMonotone(r);else for(t=0,e=r.length;t<e;++t)i=r[t]._model,n=g.splineCurve(g.previousItem(r,t)._model,i,g.nextItem(r,t)._model,a.dataset._model.tension),i.controlPointPreviousX=n.previous.x,i.controlPointPreviousY=n.previous.y,i.controlPointNextX=n.next.x,i.controlPointNextY=n.next.y;if(this.chart.options.elements.line.capBezierPoints)for(t=0,e=r.length;t<e;++t)(i=r[t]._model).controlPointPreviousX=s(i.controlPointPreviousX,o.left,o.right),i.controlPointPreviousY=s(i.controlPointPreviousY,o.top,o.bottom),i.controlPointNextX=s(i.controlPointNextX,o.left,o.right),i.controlPointNextY=s(i.controlPointNextY,o.top,o.bottom)},draw:function(){var t,e=this.chart,i=this.getMeta(),n=i.data||[],a=e.chartArea,o=n.length,r=0;for(f(this.getDataset(),e.options)&&(t=(i.dataset._model.borderWidth||0)/2,g.canvas.clipArea(e.ctx,{left:a.left,right:a.right,top:a.top-t,bottom:a.bottom+t}),i.dataset.draw(),g.canvas.unclipArea(e.ctx));r<o;++r)n[r].draw(a)},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},a=t._model;t.$previousStyle={backgroundColor:a.backgroundColor,borderColor:a.borderColor,borderWidth:a.borderWidth,radius:a.radius},a.backgroundColor=n.hoverBackgroundColor||g.valueAtIndexOrDefault(e.pointHoverBackgroundColor,i,g.getHoverColor(a.backgroundColor)),a.borderColor=n.hoverBorderColor||g.valueAtIndexOrDefault(e.pointHoverBorderColor,i,g.getHoverColor(a.borderColor)),a.borderWidth=n.hoverBorderWidth||g.valueAtIndexOrDefault(e.pointHoverBorderWidth,i,a.borderWidth),a.radius=n.hoverRadius||g.valueAtIndexOrDefault(e.pointHoverRadius,i,this.chart.options.elements.point.hoverRadius)}})}},{26:26,41:41,46:46}],19:[function(t,e,i){"use strict";var n=t(26),a=t(41),k=t(46);n._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');var i=t.data,n=i.datasets,a=i.labels;if(n.length)for(var o=0;o<n[0].data.length;++o)e.push('<li><span style="background-color:'+n[0].backgroundColor[o]+'"></span>'),a[o]&&e.push(a[o]),e.push("</li>");return e.push("</ul>"),e.join("")},legend:{labels:{generateLabels:function(s){var l=s.data;return l.labels.length&&l.datasets.length?l.labels.map(function(t,e){var i=s.getDatasetMeta(0),n=l.datasets[0],a=i.data[e].custom||{},o=k.valueAtIndexOrDefault,r=s.options.elements.arc;return{text:t,fillStyle:a.backgroundColor?a.backgroundColor:o(n.backgroundColor,e,r.backgroundColor),strokeStyle:a.borderColor?a.borderColor:o(n.borderColor,e,r.borderColor),lineWidth:a.borderWidth?a.borderWidth:o(n.borderWidth,e,r.borderWidth),hidden:isNaN(n.data[e])||i.data[e].hidden,index:e}}):[]}},onClick:function(t,e){var i,n,a,o=e.index,r=this.chart;for(i=0,n=(r.data.datasets||[]).length;i<n;++i)(a=r.getDatasetMeta(i)).data[o].hidden=!a.data[o].hidden;r.update()}},tooltips:{callbacks:{title:function(){return""},label:function(t,e){return e.labels[t.index]+": "+t.yLabel}}}}),e.exports=function(t){t.controllers.polarArea=t.DatasetController.extend({dataElementType:a.Arc,linkScales:k.noop,update:function(i){var t,e,n,a=this,o=a.getDataset(),r=a.getMeta(),s=a.chart.options.startAngle||0,l=a._starts=[],u=a._angles=[];for(a._updateRadius(),r.count=a.countVisibleElements(),t=0,e=o.data.length;t<e;t++)l[t]=s,n=a._computeAngle(t),s+=u[t]=n;k.each(r.data,function(t,e){a.updateElement(t,e,i)})},_updateRadius:function(){var t=this,e=t.chart,i=e.chartArea,n=e.options,a=n.elements.arc,o=Math.min(i.right-i.left,i.bottom-i.top);e.outerRadius=Math.max((o-a.borderWidth/2)/2,0),e.innerRadius=Math.max(n.cutoutPercentage?e.outerRadius/100*n.cutoutPercentage:1,0),e.radiusLength=(e.outerRadius-e.innerRadius)/e.getVisibleDatasetCount(),t.outerRadius=e.outerRadius-e.radiusLength*t.index,t.innerRadius=t.outerRadius-e.radiusLength},updateElement:function(t,e,i){var n=this,a=n.chart,o=n.getDataset(),r=a.options,s=r.animation,l=a.scale,u=a.data.labels,d=l.xCenter,c=l.yCenter,h=r.startAngle,f=t.hidden?0:l.getDistanceFromCenterForValue(o.data[e]),g=n._starts[e],p=g+(t.hidden?0:n._angles[e]),m=s.animateScale?0:l.getDistanceFromCenterForValue(o.data[e]);k.extend(t,{_datasetIndex:n.index,_index:e,_scale:l,_model:{x:d,y:c,innerRadius:0,outerRadius:i?m:f,startAngle:i&&s.animateRotate?h:g,endAngle:i&&s.animateRotate?h:p,label:k.valueAtIndexOrDefault(u,e,u[e])}});var v=this.chart.options.elements.arc,b=t.custom||{},x=k.valueAtIndexOrDefault,y=t._model;y.backgroundColor=b.backgroundColor?b.backgroundColor:x(o.backgroundColor,e,v.backgroundColor),y.borderColor=b.borderColor?b.borderColor:x(o.borderColor,e,v.borderColor),y.borderWidth=b.borderWidth?b.borderWidth:x(o.borderWidth,e,v.borderWidth),t.pivot()},countVisibleElements:function(){var i=this.getDataset(),t=this.getMeta(),n=0;return k.each(t.data,function(t,e){isNaN(i.data[e])||t.hidden||n++}),n},_computeAngle:function(t){var e=this,i=this.getMeta().count,n=e.getDataset(),a=e.getMeta();if(isNaN(n.data[t])||a.data[t].hidden)return 0;var o={chart:e.chart,dataIndex:t,dataset:n,datasetIndex:e.index};return k.options.resolve([e.chart.options.elements.arc.angle,2*Math.PI/i],o,t)}})}},{26:26,41:41,46:46}],20:[function(t,e,i){"use strict";var n=t(26),a=t(41),u=t(46);n._set("radar",{scale:{type:"radialLinear"},elements:{line:{tension:0}}}),e.exports=function(t){t.controllers.radar=t.DatasetController.extend({datasetElementType:a.Line,dataElementType:a.Point,linkScales:u.noop,update:function(i){var n=this,t=n.getMeta(),e=t.dataset,a=t.data,o=e.custom||{},r=n.getDataset(),s=n.chart.options.elements.line,l=n.chart.scale;void 0!==r.tension&&void 0===r.lineTension&&(r.lineTension=r.tension),u.extend(t.dataset,{_datasetIndex:n.index,_scale:l,_children:a,_loop:!0,_model:{tension:o.tension?o.tension:u.valueOrDefault(r.lineTension,s.tension),backgroundColor:o.backgroundColor?o.backgroundColor:r.backgroundColor||s.backgroundColor,borderWidth:o.borderWidth?o.borderWidth:r.borderWidth||s.borderWidth,borderColor:o.borderColor?o.borderColor:r.borderColor||s.borderColor,fill:o.fill?o.fill:void 0!==r.fill?r.fill:s.fill,borderCapStyle:o.borderCapStyle?o.borderCapStyle:r.borderCapStyle||s.borderCapStyle,borderDash:o.borderDash?o.borderDash:r.borderDash||s.borderDash,borderDashOffset:o.borderDashOffset?o.borderDashOffset:r.borderDashOffset||s.borderDashOffset,borderJoinStyle:o.borderJoinStyle?o.borderJoinStyle:r.borderJoinStyle||s.borderJoinStyle}}),t.dataset.pivot(),u.each(a,function(t,e){n.updateElement(t,e,i)},n),n.updateBezierControlPoints()},updateElement:function(t,e,i){var n=this,a=t.custom||{},o=n.getDataset(),r=n.chart.scale,s=n.chart.options.elements.point,l=r.getPointPositionForValue(e,o.data[e]);void 0!==o.radius&&void 0===o.pointRadius&&(o.pointRadius=o.radius),void 0!==o.hitRadius&&void 0===o.pointHitRadius&&(o.pointHitRadius=o.hitRadius),u.extend(t,{_datasetIndex:n.index,_index:e,_scale:r,_model:{x:i?r.xCenter:l.x,y:i?r.yCenter:l.y,tension:a.tension?a.tension:u.valueOrDefault(o.lineTension,n.chart.options.elements.line.tension),radius:a.radius?a.radius:u.valueAtIndexOrDefault(o.pointRadius,e,s.radius),backgroundColor:a.backgroundColor?a.backgroundColor:u.valueAtIndexOrDefault(o.pointBackgroundColor,e,s.backgroundColor),borderColor:a.borderColor?a.borderColor:u.valueAtIndexOrDefault(o.pointBorderColor,e,s.borderColor),borderWidth:a.borderWidth?a.borderWidth:u.valueAtIndexOrDefault(o.pointBorderWidth,e,s.borderWidth),pointStyle:a.pointStyle?a.pointStyle:u.valueAtIndexOrDefault(o.pointStyle,e,s.pointStyle),rotation:a.rotation?a.rotation:u.valueAtIndexOrDefault(o.pointRotation,e,s.rotation),hitRadius:a.hitRadius?a.hitRadius:u.valueAtIndexOrDefault(o.pointHitRadius,e,s.hitRadius)}}),t._model.skip=a.skip?a.skip:isNaN(t._model.x)||isNaN(t._model.y)},updateBezierControlPoints:function(){var a=this.chart.chartArea,o=this.getMeta();u.each(o.data,function(t,e){var i=t._model,n=u.splineCurve(u.previousItem(o.data,e,!0)._model,i,u.nextItem(o.data,e,!0)._model,i.tension);i.controlPointPreviousX=Math.max(Math.min(n.previous.x,a.right),a.left),i.controlPointPreviousY=Math.max(Math.min(n.previous.y,a.bottom),a.top),i.controlPointNextX=Math.max(Math.min(n.next.x,a.right),a.left),i.controlPointNextY=Math.max(Math.min(n.next.y,a.bottom),a.top),t.pivot()})},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t.custom||{},n=t._index,a=t._model;t.$previousStyle={backgroundColor:a.backgroundColor,borderColor:a.borderColor,borderWidth:a.borderWidth,radius:a.radius},a.radius=i.hoverRadius?i.hoverRadius:u.valueAtIndexOrDefault(e.pointHoverRadius,n,this.chart.options.elements.point.hoverRadius),a.backgroundColor=i.hoverBackgroundColor?i.hoverBackgroundColor:u.valueAtIndexOrDefault(e.pointHoverBackgroundColor,n,u.getHoverColor(a.backgroundColor)),a.borderColor=i.hoverBorderColor?i.hoverBorderColor:u.valueAtIndexOrDefault(e.pointHoverBorderColor,n,u.getHoverColor(a.borderColor)),a.borderWidth=i.hoverBorderWidth?i.hoverBorderWidth:u.valueAtIndexOrDefault(e.pointHoverBorderWidth,n,a.borderWidth)}})}},{26:26,41:41,46:46}],21:[function(t,e,i){"use strict";t(26)._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},showLines:!1,tooltips:{callbacks:{title:function(){return""},label:function(t){return"("+t.xLabel+", "+t.yLabel+")"}}}}),e.exports=function(t){t.controllers.scatter=t.controllers.line}},{26:26}],22:[function(t,e,i){"use strict";var n=t(27);i=e.exports=n.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null});Object.defineProperty(i.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(i.prototype,"chartInstance",{get:function(){return this.chart},set:function(t){this.chart=t}})},{27:27}],23:[function(t,e,i){"use strict";var n=t(26),o=t(46);n._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:o.noop,onComplete:o.noop}}),e.exports={frameDuration:17,animations:[],dropFrames:0,request:null,addAnimation:function(t,e,i,n){var a,o,r=this.animations;for(e.chart=t,n||(t.animating=!0),a=0,o=r.length;a<o;++a)if(r[a].chart===t)return void(r[a]=e);r.push(e),1===r.length&&this.requestAnimationFrame()},cancelAnimation:function(e){var t=o.findIndex(this.animations,function(t){return t.chart===e});-1!==t&&(this.animations.splice(t,1),e.animating=!1)},requestAnimationFrame:function(){var t=this;null===t.request&&(t.request=o.requestAnimFrame.call(window,function(){t.request=null,t.startDigest()}))},startDigest:function(){var t=this,e=Date.now(),i=0;1<t.dropFrames&&(i=Math.floor(t.dropFrames),t.dropFrames=t.dropFrames%1),t.advance(1+i);var n=Date.now();t.dropFrames+=(n-e)/t.frameDuration,0<t.animations.length&&t.requestAnimationFrame()},advance:function(t){for(var e,i,n=this.animations,a=0;a<n.length;)i=(e=n[a]).chart,e.currentStep=(e.currentStep||0)+t,e.currentStep=Math.min(e.currentStep,e.numSteps),o.callback(e.render,[i,e],i),o.callback(e.onAnimationProgress,[e],i),e.currentStep>=e.numSteps?(o.callback(e.onAnimationComplete,[e],i),i.animating=!1,n.splice(a,1)):++a}}},{26:26,46:46}],24:[function(t,e,i){"use strict";var s=t(22),l=t(23),c=t(26),h=t(46),a=t(29),o=t(31),f=t(49),g=t(32),p=t(34),n=t(36);e.exports=function(u){function d(t){return"top"===t||"bottom"===t}u.types={},u.instances={},u.controllers={},h.extend(u.prototype,{construct:function(t,e){var i,n,a=this;(n=(i=(i=e)||{}).data=i.data||{}).datasets=n.datasets||[],n.labels=n.labels||[],i.options=h.configMerge(c.global,c[i.type],i.options||{}),e=i;var o=f.acquireContext(t,e),r=o&&o.canvas,s=r&&r.height,l=r&&r.width;a.id=h.uid(),a.ctx=o,a.canvas=r,a.config=e,a.width=l,a.height=s,a.aspectRatio=s?l/s:null,a.options=e.options,a._bufferedRender=!1,(a.chart=a).controller=a,u.instances[a.id]=a,Object.defineProperty(a,"data",{get:function(){return a.config.data},set:function(t){a.config.data=t}}),o&&r?(a.initialize(),a.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){var t=this;return g.notify(t,"beforeInit"),h.retinaScale(t,t.options.devicePixelRatio),t.bindEvents(),t.options.responsive&&t.resize(!0),t.ensureScalesHaveIDs(),t.buildOrUpdateScales(),t.initToolTip(),g.notify(t,"afterInit"),t},clear:function(){return h.canvas.clear(this),this},stop:function(){return l.cancelAnimation(this),this},resize:function(t){var e=this,i=e.options,n=e.canvas,a=i.maintainAspectRatio&&e.aspectRatio||null,o=Math.max(0,Math.floor(h.getMaximumWidth(n))),r=Math.max(0,Math.floor(a?o/a:h.getMaximumHeight(n)));if((e.width!==o||e.height!==r)&&(n.width=e.width=o,n.height=e.height=r,n.style.width=o+"px",n.style.height=r+"px",h.retinaScale(e,i.devicePixelRatio),!t)){var s={width:o,height:r};g.notify(e,"resize",[s]),e.options.onResize&&e.options.onResize(e,s),e.stop(),e.update({duration:e.options.responsiveAnimationDuration})}},ensureScalesHaveIDs:function(){var t=this.options,e=t.scales||{},i=t.scale;h.each(e.xAxes,function(t,e){t.id=t.id||"x-axis-"+e}),h.each(e.yAxes,function(t,e){t.id=t.id||"y-axis-"+e}),i&&(i.id=i.id||"scale")},buildOrUpdateScales:function(){var r=this,t=r.options,s=r.scales||{},e=[],l=Object.keys(s).reduce(function(t,e){return t[e]=!1,t},{});t.scales&&(e=e.concat((t.scales.xAxes||[]).map(function(t){return{options:t,dtype:"category",dposition:"bottom"}}),(t.scales.yAxes||[]).map(function(t){return{options:t,dtype:"linear",dposition:"left"}}))),t.scale&&e.push({options:t.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),h.each(e,function(t){var e=t.options,i=e.id,n=h.valueOrDefault(e.type,t.dtype);d(e.position)!==d(t.dposition)&&(e.position=t.dposition),l[i]=!0;var a=null;if(i in s&&s[i].type===n)(a=s[i]).options=e,a.ctx=r.ctx,a.chart=r;else{var o=p.getScaleConstructor(n);if(!o)return;a=new o({id:i,type:n,options:e,ctx:r.ctx,chart:r}),s[a.id]=a}a.mergeTicksOptions(),t.isDefault&&(r.scale=a)}),h.each(l,function(t,e){t||delete s[e]}),r.scales=s,p.addScalesToLayout(this)},buildOrUpdateControllers:function(){var o=this,r=[],s=[];return h.each(o.data.datasets,function(t,e){var i=o.getDatasetMeta(e),n=t.type||o.config.type;if(i.type&&i.type!==n&&(o.destroyDatasetMeta(e),i=o.getDatasetMeta(e)),i.type=n,r.push(i.type),i.controller)i.controller.updateIndex(e),i.controller.linkScales();else{var a=u.controllers[i.type];if(void 0===a)throw new Error('"'+i.type+'" is not a chart type.');i.controller=new a(o,e),s.push(i.controller)}},o),s},resetElements:function(){var i=this;h.each(i.data.datasets,function(t,e){i.getDatasetMeta(e).controller.reset()},i)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(t){var e,i,n=this;if(t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]}),i=(e=n).options,h.each(e.scales,function(t){o.removeBox(e,t)}),i=h.configMerge(u.defaults.global,u.defaults[e.config.type],i),e.options=e.config.options=i,e.ensureScalesHaveIDs(),e.buildOrUpdateScales(),e.tooltip._options=i.tooltips,e.tooltip.initialize(),g._invalidate(n),!1!==g.notify(n,"beforeUpdate")){n.tooltip._data=n.data;var a=n.buildOrUpdateControllers();h.each(n.data.datasets,function(t,e){n.getDatasetMeta(e).controller.buildOrUpdateElements()},n),n.updateLayout(),n.options.animation&&n.options.animation.duration&&h.each(a,function(t){t.reset()}),n.updateDatasets(),n.tooltip.initialize(),n.lastActive=[],g.notify(n,"afterUpdate"),n._bufferedRender?n._bufferedRequest={duration:t.duration,easing:t.easing,lazy:t.lazy}:n.render(t)}},updateLayout:function(){!1!==g.notify(this,"beforeLayout")&&(o.update(this,this.width,this.height),g.notify(this,"afterScaleUpdate"),g.notify(this,"afterLayout"))},updateDatasets:function(){if(!1!==g.notify(this,"beforeDatasetsUpdate")){for(var t=0,e=this.data.datasets.length;t<e;++t)this.updateDataset(t);g.notify(this,"afterDatasetsUpdate")}},updateDataset:function(t){var e=this.getDatasetMeta(t),i={meta:e,index:t};!1!==g.notify(this,"beforeDatasetUpdate",[i])&&(e.controller.update(),g.notify(this,"afterDatasetUpdate",[i]))},render:function(t){var e=this;t&&"object"==typeof t||(t={duration:t,lazy:arguments[1]});var i=t.duration,n=t.lazy;if(!1!==g.notify(e,"beforeRender")){var a=e.options.animation,o=function(t){g.notify(e,"afterRender"),h.callback(a&&a.onComplete,[t],e)};if(a&&(void 0!==i&&0!==i||void 0===i&&0!==a.duration)){var r=new s({numSteps:(i||a.duration)/16.66,easing:t.easing||a.easing,render:function(t,e){var i=h.easing.effects[e.easing],n=e.currentStep,a=n/e.numSteps;t.draw(i(a),a,n)},onAnimationProgress:a.onProgress,onAnimationComplete:o});l.addAnimation(e,r,i,n)}else e.draw(),o(new s({numSteps:0,chart:e}));return e}},draw:function(t){var e=this;e.clear(),h.isNullOrUndef(t)&&(t=1),e.transition(t),e.width<=0||e.height<=0||!1!==g.notify(e,"beforeDraw",[t])&&(h.each(e.boxes,function(t){t.draw(e.chartArea)},e),e.scale&&e.scale.draw(),e.drawDatasets(t),e._drawTooltip(t),g.notify(e,"afterDraw",[t]))},transition:function(t){for(var e=0,i=(this.data.datasets||[]).length;e<i;++e)this.isDatasetVisible(e)&&this.getDatasetMeta(e).controller.transition(t);this.tooltip.transition(t)},drawDatasets:function(t){var e=this;if(!1!==g.notify(e,"beforeDatasetsDraw",[t])){for(var i=(e.data.datasets||[]).length-1;0<=i;--i)e.isDatasetVisible(i)&&e.drawDataset(i,t);g.notify(e,"afterDatasetsDraw",[t])}},drawDataset:function(t,e){var i=this.getDatasetMeta(t),n={meta:i,index:t,easingValue:e};!1!==g.notify(this,"beforeDatasetDraw",[n])&&(i.controller.draw(e),g.notify(this,"afterDatasetDraw",[n]))},_drawTooltip:function(t){var e=this.tooltip,i={tooltip:e,easingValue:t};!1!==g.notify(this,"beforeTooltipDraw",[i])&&(e.draw(),g.notify(this,"afterTooltipDraw",[i]))},getElementAtEvent:function(t){return a.modes.single(this,t)},getElementsAtEvent:function(t){return a.modes.label(this,t,{intersect:!0})},getElementsAtXAxis:function(t){return a.modes["x-axis"](this,t,{intersect:!0})},getElementsAtEventForMode:function(t,e,i){var n=a.modes[e];return"function"==typeof n?n(this,t,i):[]},getDatasetAtEvent:function(t){return a.modes.dataset(this,t,{intersect:!0})},getDatasetMeta:function(t){var e=this.data.datasets[t];e._meta||(e._meta={});var i=e._meta[this.id];return i||(i=e._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}),i},getVisibleDatasetCount:function(){for(var t=0,e=0,i=this.data.datasets.length;e<i;++e)this.isDatasetVisible(e)&&t++;return t},isDatasetVisible:function(t){var e=this.getDatasetMeta(t);return"boolean"==typeof e.hidden?!e.hidden:!this.data.datasets[t].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(t){var e=this.id,i=this.data.datasets[t],n=i._meta&&i._meta[e];n&&(n.controller.destroy(),delete i._meta[e])},destroy:function(){var t,e,i=this,n=i.canvas;for(i.stop(),t=0,e=i.data.datasets.length;t<e;++t)i.destroyDatasetMeta(t);n&&(i.unbindEvents(),h.canvas.clear(i),f.releaseContext(i.ctx),i.canvas=null,i.ctx=null),g.notify(i,"destroy"),delete u.instances[i.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){var t=this;t.tooltip=new n({_chart:t,_chartInstance:t,_data:t.data,_options:t.options.tooltips},t)},bindEvents:function(){var e=this,i=e._listeners={},n=function(){e.eventHandler.apply(e,arguments)};h.each(e.options.events,function(t){f.addEventListener(e,t,n),i[t]=n}),e.options.responsive&&(n=function(){e.resize()},f.addEventListener(e,"resize",n),i.resize=n)},unbindEvents:function(){var i=this,t=i._listeners;t&&(delete i._listeners,h.each(t,function(t,e){f.removeEventListener(i,e,t)}))},updateHoverStyle:function(t,e,i){var n,a,o,r=i?"setHoverStyle":"removeHoverStyle";for(a=0,o=t.length;a<o;++a)(n=t[a])&&this.getDatasetMeta(n._datasetIndex).controller[r](n)},eventHandler:function(t){var e=this,i=e.tooltip;if(!1!==g.notify(e,"beforeEvent",[t])){e._bufferedRender=!0,e._bufferedRequest=null;var n=e.handleEvent(t);i&&(n=i._start?i.handleEvent(t):n|i.handleEvent(t)),g.notify(e,"afterEvent",[t]);var a=e._bufferedRequest;return a?e.render(a):n&&!e.animating&&(e.stop(),e.render({duration:e.options.hover.animationDuration,lazy:!0})),e._bufferedRender=!1,e._bufferedRequest=null,e}},handleEvent:function(t){var e,i=this,n=i.options||{},a=n.hover;return i.lastActive=i.lastActive||[],"mouseout"===t.type?i.active=[]:i.active=i.getElementsAtEventForMode(t,a.mode,a),h.callback(n.onHover||n.hover.onHover,[t.native,i.active],i),"mouseup"!==t.type&&"click"!==t.type||n.onClick&&n.onClick.call(i,t.native,i.active),i.lastActive.length&&i.updateHoverStyle(i.lastActive,a.mode,!1),i.active.length&&a.mode&&i.updateHoverStyle(i.active,a.mode,!0),e=!h.arrayEquals(i.active,i.lastActive),i.lastActive=i.active,e}}),u.Controller=u}},{22:22,23:23,26:26,29:29,31:31,32:32,34:34,36:36,46:46,49:49}],25:[function(t,e,i){"use strict";var s=t(46);e.exports=function(t){var o=["push","pop","shift","splice","unshift"];function r(e,t){var i=e._chartjs;if(i){var n=i.listeners,a=n.indexOf(t);-1!==a&&n.splice(a,1),0<n.length||(o.forEach(function(t){delete e[t]}),delete e._chartjs)}}t.DatasetController=function(t,e){this.initialize(t,e)},s.extend(t.DatasetController.prototype,{datasetElementType:null,dataElementType:null,initialize:function(t,e){this.chart=t,this.index=e,this.linkScales(),this.addElements()},updateIndex:function(t){this.index=t},linkScales:function(){var t=this,e=t.getMeta(),i=t.getDataset();null!==e.xAxisID&&e.xAxisID in t.chart.scales||(e.xAxisID=i.xAxisID||t.chart.options.scales.xAxes[0].id),null!==e.yAxisID&&e.yAxisID in t.chart.scales||(e.yAxisID=i.yAxisID||t.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(t){return this.chart.scales[t]},reset:function(){this.update(!0)},destroy:function(){this._data&&r(this._data,this)},createMetaDataset:function(){var t=this.datasetElementType;return t&&new t({_chart:this.chart,_datasetIndex:this.index})},createMetaData:function(t){var e=this.dataElementType;return e&&new e({_chart:this.chart,_datasetIndex:this.index,_index:t})},addElements:function(){var t,e,i=this.getMeta(),n=this.getDataset().data||[],a=i.data;for(t=0,e=n.length;t<e;++t)a[t]=a[t]||this.createMetaData(t);i.dataset=i.dataset||this.createMetaDataset()},addElementAndReset:function(t){var e=this.createMetaData(t);this.getMeta().data.splice(t,0,e),this.updateElement(e,t,!0)},buildOrUpdateElements:function(){var a,t,e=this,i=e.getDataset(),n=i.data||(i.data=[]);e._data!==n&&(e._data&&r(e._data,e),t=e,(a=n)._chartjs?a._chartjs.listeners.push(t):(Object.defineProperty(a,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),o.forEach(function(t){var i="onData"+t.charAt(0).toUpperCase()+t.slice(1),n=a[t];Object.defineProperty(a,t,{configurable:!0,enumerable:!1,value:function(){var e=Array.prototype.slice.call(arguments),t=n.apply(this,e);return s.each(a._chartjs.listeners,function(t){"function"==typeof t[i]&&t[i].apply(t,e)}),t}})})),e._data=n),e.resyncElements()},update:s.noop,transition:function(t){for(var e=this.getMeta(),i=e.data||[],n=i.length,a=0;a<n;++a)i[a].transition(t);e.dataset&&e.dataset.transition(t)},draw:function(){var t=this.getMeta(),e=t.data||[],i=e.length,n=0;for(t.dataset&&t.dataset.draw();n<i;++n)e[n].draw()},removeHoverStyle:function(t){s.merge(t._model,t.$previousStyle||{}),delete t.$previousStyle},setHoverStyle:function(t){var e=this.chart.data.datasets[t._datasetIndex],i=t._index,n=t.custom||{},a=s.valueAtIndexOrDefault,o=s.getHoverColor,r=t._model;t.$previousStyle={backgroundColor:r.backgroundColor,borderColor:r.borderColor,borderWidth:r.borderWidth},r.backgroundColor=n.hoverBackgroundColor?n.hoverBackgroundColor:a(e.hoverBackgroundColor,i,o(r.backgroundColor)),r.borderColor=n.hoverBorderColor?n.hoverBorderColor:a(e.hoverBorderColor,i,o(r.borderColor)),r.borderWidth=n.hoverBorderWidth?n.hoverBorderWidth:a(e.hoverBorderWidth,i,r.borderWidth)},resyncElements:function(){var t=this.getMeta(),e=this.getDataset().data,i=t.data.length,n=e.length;n<i?t.data.splice(n,i-n):i<n&&this.insertElements(i,n-i)},insertElements:function(t,e){for(var i=0;i<e;++i)this.addElementAndReset(t+i)},onDataPush:function(){this.insertElements(this.getDataset().data.length-1,arguments.length)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(t,e){this.getMeta().data.splice(t,e),this.insertElements(t,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),t.DatasetController.extend=s.inherits}},{46:46}],26:[function(t,e,i){"use strict";var n=t(46);e.exports={_set:function(t,e){return n.merge(this[t]||(this[t]={}),e)}}},{46:46}],27:[function(t,e,i){"use strict";var g=t(3),n=t(46);var a=function(t){n.extend(this,t),this.initialize.apply(this,arguments)};n.extend(a.prototype,{initialize:function(){this.hidden=!1},pivot:function(){var t=this;return t._view||(t._view=n.clone(t._model)),t._start={},t},transition:function(t){var e=this,i=e._model,n=e._start,a=e._view;return i&&1!==t?(a||(a=e._view={}),n||(n=e._start={}),function(t,e,i,n){var a,o,r,s,l,u,d,c,h,f=Object.keys(i);for(a=0,o=f.length;a<o;++a)if(u=i[r=f[a]],e.hasOwnProperty(r)||(e[r]=u),(s=e[r])!==u&&"_"!==r[0]){if(t.hasOwnProperty(r)||(t[r]=s),(d=typeof u)==typeof(l=t[r]))if("string"===d){if((c=g(l)).valid&&(h=g(u)).valid){e[r]=h.mix(c,n).rgbString();continue}}else if("number"===d&&isFinite(l)&&isFinite(u)){e[r]=l+(u-l)*n;continue}e[r]=u}}(n,a,i,t)):(e._view=i,e._start=null),e},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return n.isNumber(this._model.x)&&n.isNumber(this._model.y)}}),a.extend=n.inherits,e.exports=a},{3:3,46:46}],28:[function(t,e,i){"use strict";var n=t(3),a=t(26),g=t(46),l=t(34);e.exports=function(){function d(t,e,i){var n;return"string"==typeof t?(n=parseInt(t,10),-1!==t.indexOf("%")&&(n=n/100*e.parentNode[i])):n=t,n}function c(t){return null!=t&&"none"!==t}function e(t,e,i){var n=document.defaultView,a=g._getParentNode(t),o=n.getComputedStyle(t)[e],r=n.getComputedStyle(a)[e],s=c(o),l=c(r),u=Number.POSITIVE_INFINITY;return s||l?Math.min(s?d(o,t,i):u,l?d(r,a,i):u):"none"}g.configMerge=function(){return g.merge(g.clone(arguments[0]),[].slice.call(arguments,1),{merger:function(t,e,i,n){var a=e[t]||{},o=i[t];"scales"===t?e[t]=g.scaleMerge(a,o):"scale"===t?e[t]=g.merge(a,[l.getScaleDefaults(o.type),o]):g._merger(t,e,i,n)}})},g.scaleMerge=function(){return g.merge(g.clone(arguments[0]),[].slice.call(arguments,1),{merger:function(t,e,i,n){if("xAxes"===t||"yAxes"===t){var a,o,r,s=i[t].length;for(e[t]||(e[t]=[]),a=0;a<s;++a)r=i[t][a],o=g.valueOrDefault(r.type,"xAxes"===t?"category":"linear"),a>=e[t].length&&e[t].push({}),!e[t][a].type||r.type&&r.type!==e[t][a].type?g.merge(e[t][a],[l.getScaleDefaults(o),r]):g.merge(e[t][a],r)}else g._merger(t,e,i,n)}})},g.where=function(t,e){if(g.isArray(t)&&Array.prototype.filter)return t.filter(e);var i=[];return g.each(t,function(t){e(t)&&i.push(t)}),i},g.findIndex=Array.prototype.findIndex?function(t,e,i){return t.findIndex(e,i)}:function(t,e,i){i=void 0===i?t:i;for(var n=0,a=t.length;n<a;++n)if(e.call(i,t[n],n,t))return n;return-1},g.findNextWhere=function(t,e,i){g.isNullOrUndef(i)&&(i=-1);for(var n=i+1;n<t.length;n++){var a=t[n];if(e(a))return a}},g.findPreviousWhere=function(t,e,i){g.isNullOrUndef(i)&&(i=t.length);for(var n=i-1;0<=n;n--){var a=t[n];if(e(a))return a}},g.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},g.almostEquals=function(t,e,i){return Math.abs(t-e)<i},g.almostWhole=function(t,e){var i=Math.round(t);return i-e<t&&t<i+e},g.max=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.max(t,e)},Number.NEGATIVE_INFINITY)},g.min=function(t){return t.reduce(function(t,e){return isNaN(e)?t:Math.min(t,e)},Number.POSITIVE_INFINITY)},g.sign=Math.sign?function(t){return Math.sign(t)}:function(t){return 0===(t=+t)||isNaN(t)?t:0<t?1:-1},g.log10=Math.log10?function(t){return Math.log10(t)}:function(t){var e=Math.log(t)*Math.LOG10E,i=Math.round(e);return t===Math.pow(10,i)?i:e},g.toRadians=function(t){return t*(Math.PI/180)},g.toDegrees=function(t){return t*(180/Math.PI)},g.getAngleFromPoint=function(t,e){var i=e.x-t.x,n=e.y-t.y,a=Math.sqrt(i*i+n*n),o=Math.atan2(n,i);return o<-.5*Math.PI&&(o+=2*Math.PI),{angle:o,distance:a}},g.distanceBetweenPoints=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},g.aliasPixel=function(t){return t%2==0?0:.5},g.splineCurve=function(t,e,i,n){var a=t.skip?e:t,o=e,r=i.skip?e:i,s=Math.sqrt(Math.pow(o.x-a.x,2)+Math.pow(o.y-a.y,2)),l=Math.sqrt(Math.pow(r.x-o.x,2)+Math.pow(r.y-o.y,2)),u=s/(s+l),d=l/(s+l),c=n*(u=isNaN(u)?0:u),h=n*(d=isNaN(d)?0:d);return{previous:{x:o.x-c*(r.x-a.x),y:o.y-c*(r.y-a.y)},next:{x:o.x+h*(r.x-a.x),y:o.y+h*(r.y-a.y)}}},g.EPSILON=Number.EPSILON||1e-14,g.splineCurveMonotone=function(t){var e,i,n,a,o,r,s,l,u,d=(t||[]).map(function(t){return{model:t._model,deltaK:0,mK:0}}),c=d.length;for(e=0;e<c;++e)if(!(n=d[e]).model.skip){if(i=0<e?d[e-1]:null,(a=e<c-1?d[e+1]:null)&&!a.model.skip){var h=a.model.x-n.model.x;n.deltaK=0!==h?(a.model.y-n.model.y)/h:0}!i||i.model.skip?n.mK=n.deltaK:!a||a.model.skip?n.mK=i.deltaK:this.sign(i.deltaK)!==this.sign(n.deltaK)?n.mK=0:n.mK=(i.deltaK+n.deltaK)/2}for(e=0;e<c-1;++e)n=d[e],a=d[e+1],n.model.skip||a.model.skip||(g.almostEquals(n.deltaK,0,this.EPSILON)?n.mK=a.mK=0:(o=n.mK/n.deltaK,r=a.mK/n.deltaK,(l=Math.pow(o,2)+Math.pow(r,2))<=9||(s=3/Math.sqrt(l),n.mK=o*s*n.deltaK,a.mK=r*s*n.deltaK)));for(e=0;e<c;++e)(n=d[e]).model.skip||(i=0<e?d[e-1]:null,a=e<c-1?d[e+1]:null,i&&!i.model.skip&&(u=(n.model.x-i.model.x)/3,n.model.controlPointPreviousX=n.model.x-u,n.model.controlPointPreviousY=n.model.y-u*n.mK),a&&!a.model.skip&&(u=(a.model.x-n.model.x)/3,n.model.controlPointNextX=n.model.x+u,n.model.controlPointNextY=n.model.y+u*n.mK))},g.nextItem=function(t,e,i){return i?e>=t.length-1?t[0]:t[e+1]:e>=t.length-1?t[t.length-1]:t[e+1]},g.previousItem=function(t,e,i){return i?e<=0?t[t.length-1]:t[e-1]:e<=0?t[0]:t[e-1]},g.niceNum=function(t,e){var i=Math.floor(g.log10(t)),n=t/Math.pow(10,i);return(e?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10)*Math.pow(10,i)},g.requestAnimFrame="undefined"==typeof window?function(t){t()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},g.getRelativePosition=function(t,e){var i,n,a=t.originalEvent||t,o=t.target||t.srcElement,r=o.getBoundingClientRect(),s=a.touches;n=s&&0<s.length?(i=s[0].clientX,s[0].clientY):(i=a.clientX,a.clientY);var l=parseFloat(g.getStyle(o,"padding-left")),u=parseFloat(g.getStyle(o,"padding-top")),d=parseFloat(g.getStyle(o,"padding-right")),c=parseFloat(g.getStyle(o,"padding-bottom")),h=r.right-r.left-l-d,f=r.bottom-r.top-u-c;return{x:i=Math.round((i-r.left-l)/h*o.width/e.currentDevicePixelRatio),y:n=Math.round((n-r.top-u)/f*o.height/e.currentDevicePixelRatio)}},g.getConstraintWidth=function(t){return e(t,"max-width","clientWidth")},g.getConstraintHeight=function(t){return e(t,"max-height","clientHeight")},g._calculatePadding=function(t,e,i){return-1<(e=g.getStyle(t,e)).indexOf("%")?i/parseInt(e,10):parseInt(e,10)},g._getParentNode=function(t){var e=t.parentNode;return e&&e.host&&(e=e.host),e},g.getMaximumWidth=function(t){var e=g._getParentNode(t);if(!e)return t.clientWidth;var i=e.clientWidth,n=i-g._calculatePadding(e,"padding-left",i)-g._calculatePadding(e,"padding-right",i),a=g.getConstraintWidth(t);return isNaN(a)?n:Math.min(n,a)},g.getMaximumHeight=function(t){var e=g._getParentNode(t);if(!e)return t.clientHeight;var i=e.clientHeight,n=i-g._calculatePadding(e,"padding-top",i)-g._calculatePadding(e,"padding-bottom",i),a=g.getConstraintHeight(t);return isNaN(a)?n:Math.min(n,a)},g.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},g.retinaScale=function(t,e){var i=t.currentDevicePixelRatio=e||"undefined"!=typeof window&&window.devicePixelRatio||1;if(1!==i){var n=t.canvas,a=t.height,o=t.width;n.height=a*i,n.width=o*i,t.ctx.scale(i,i),n.style.height||n.style.width||(n.style.height=a+"px",n.style.width=o+"px")}},g.fontString=function(t,e,i){return e+" "+t+"px "+i},g.longestText=function(e,t,i,n){var a=(n=n||{}).data=n.data||{},o=n.garbageCollect=n.garbageCollect||[];n.font!==t&&(a=n.data={},o=n.garbageCollect=[],n.font=t),e.font=t;var r=0;g.each(i,function(t){null!=t&&!0!==g.isArray(t)?r=g.measureText(e,a,o,r,t):g.isArray(t)&&g.each(t,function(t){null==t||g.isArray(t)||(r=g.measureText(e,a,o,r,t))})});var s=o.length/2;if(s>i.length){for(var l=0;l<s;l++)delete a[o[l]];o.splice(0,s)}return r},g.measureText=function(t,e,i,n,a){var o=e[a];return o||(o=e[a]=t.measureText(a).width,i.push(a)),n<o&&(n=o),n},g.numberOfLabelLines=function(t){var e=1;return g.each(t,function(t){g.isArray(t)&&t.length>e&&(e=t.length)}),e},g.color=n?function(t){return t instanceof CanvasGradient&&(t=a.global.defaultColor),n(t)}:function(t){return console.error("Color.js not found!"),t},g.getHoverColor=function(t){return t instanceof CanvasPattern?t:g.color(t).saturate(.5).darken(.1).rgbString()}}},{26:26,3:3,34:34,46:46}],29:[function(t,e,i){"use strict";var n=t(46);function s(t,e){return t.native?{x:t.x,y:t.y}:n.getRelativePosition(t,e)}function l(t,e){var i,n,a,o,r;for(n=0,o=t.data.datasets.length;n<o;++n)if(t.isDatasetVisible(n))for(a=0,r=(i=t.getDatasetMeta(n)).data.length;a<r;++a){var s=i.data[a];s._view.skip||e(s)}}function u(t,e){var i=[];return l(t,function(t){t.inRange(e.x,e.y)&&i.push(t)}),i}function d(t,n,a,o){var r=Number.POSITIVE_INFINITY,s=[];return l(t,function(t){if(!a||t.inRange(n.x,n.y)){var e=t.getCenterPoint(),i=o(n,e);i<r?(s=[t],r=i):i===r&&s.push(t)}}),s}function c(t){var a=-1!==t.indexOf("x"),o=-1!==t.indexOf("y");return function(t,e){var i=a?Math.abs(t.x-e.x):0,n=o?Math.abs(t.y-e.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(n,2))}}function a(n,t,e){var i=s(t,n);e.axis=e.axis||"x";var a=c(e.axis),o=e.intersect?u(n,i):d(n,i,!1,a),r=[];return o.length?(n.data.datasets.forEach(function(t,e){if(n.isDatasetVisible(e)){var i=n.getDatasetMeta(e).data[o[0]._index];i&&!i._view.skip&&r.push(i)}}),r):[]}e.exports={modes:{single:function(t,e){var i=s(e,t),n=[];return l(t,function(t){if(t.inRange(i.x,i.y))return n.push(t),n}),n.slice(0,1)},label:a,index:a,dataset:function(t,e,i){var n=s(e,t);i.axis=i.axis||"xy";var a=c(i.axis),o=i.intersect?u(t,n):d(t,n,!1,a);return 0<o.length&&(o=t.getDatasetMeta(o[0]._datasetIndex).data),o},"x-axis":function(t,e){return a(t,e,{intersect:!1})},point:function(t,e){return u(t,s(e,t))},nearest:function(t,e,i){var n=s(e,t);i.axis=i.axis||"xy";var a=c(i.axis),o=d(t,n,i.intersect,a);return 1<o.length&&o.sort(function(t,e){var i=t.getArea()-e.getArea();return 0===i&&(i=t._datasetIndex-e._datasetIndex),i}),o.slice(0,1)},x:function(t,e,i){var n=s(e,t),a=[],o=!1;return l(t,function(t){t.inXRange(n.x)&&a.push(t),t.inRange(n.x,n.y)&&(o=!0)}),i.intersect&&!o&&(a=[]),a},y:function(t,e,i){var n=s(e,t),a=[],o=!1;return l(t,function(t){t.inYRange(n.y)&&a.push(t),t.inRange(n.x,n.y)&&(o=!0)}),i.intersect&&!o&&(a=[]),a}}}},{46:46}],30:[function(t,e,i){"use strict";t(26)._set("global",{responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!0,events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",showLines:!0,elements:{},layout:{padding:{top:0,right:0,bottom:0,left:0}}}),e.exports=function(){var t=function(t,e){return this.construct(t,e),this};return t.Chart=t}},{26:26}],31:[function(t,e,i){"use strict";var B=t(46);function W(t,e){return B.where(t,function(t){return t.position===e})}function V(t,a){t.forEach(function(t,e){return t._tmpIndex_=e,t}),t.sort(function(t,e){var i=a?e:t,n=a?t:e;return i.weight===n.weight?i._tmpIndex_-n._tmpIndex_:i.weight-n.weight}),t.forEach(function(t){delete t._tmpIndex_})}e.exports={defaults:{},addBox:function(t,e){t.boxes||(t.boxes=[]),e.fullWidth=e.fullWidth||!1,e.position=e.position||"top",e.weight=e.weight||0,t.boxes.push(e)},removeBox:function(t,e){var i=t.boxes?t.boxes.indexOf(e):-1;-1!==i&&t.boxes.splice(i,1)},configure:function(t,e,i){for(var n,a=["fullWidth","position","weight"],o=a.length,r=0;r<o;++r)n=a[r],i.hasOwnProperty(n)&&(e[n]=i[n])},update:function(e,i,t){if(e){var n=e.options.layout||{},a=B.options.toPadding(n.padding),o=a.left,r=a.right,s=a.top,l=a.bottom,u=W(e.boxes,"left"),d=W(e.boxes,"right"),c=W(e.boxes,"top"),h=W(e.boxes,"bottom"),f=W(e.boxes,"chartArea");V(u,!0),V(d,!1),V(c,!0),V(h,!1);var g=i-o-r,p=t-s-l,m=p/2,v=(i-g/2)/(u.length+d.length),b=(t-m)/(c.length+h.length),x=g,y=p,k=[];B.each(u.concat(d,c,h),function(t){var e,i=t.isHorizontal();i?(e=t.update(t.fullWidth?g:x,b),y-=e.height):(e=t.update(v,y),x-=e.width),k.push({horizontal:i,minSize:e,box:t})});var M=0,w=0,C=0,S=0;B.each(c.concat(h),function(t){if(t.getPadding){var e=t.getPadding();M=Math.max(M,e.left),w=Math.max(w,e.right)}}),B.each(u.concat(d),function(t){if(t.getPadding){var e=t.getPadding();C=Math.max(C,e.top),S=Math.max(S,e.bottom)}});var _=o,D=r,P=s,I=l;B.each(u.concat(d),z),B.each(u,function(t){_+=t.width}),B.each(d,function(t){D+=t.width}),B.each(c.concat(h),z),B.each(c,function(t){P+=t.height}),B.each(h,function(t){I+=t.height}),B.each(u.concat(d),function(e){var t=B.findNextWhere(k,function(t){return t.box===e}),i={left:0,right:0,top:P,bottom:I};t&&e.update(t.minSize.width,y,i)}),_=o,D=r,P=s,I=l,B.each(u,function(t){_+=t.width}),B.each(d,function(t){D+=t.width}),B.each(c,function(t){P+=t.height}),B.each(h,function(t){I+=t.height});var A=Math.max(M-_,0);_+=A,D+=Math.max(w-D,0);var T=Math.max(C-P,0);P+=T,I+=Math.max(S-I,0);var F=t-P-I,O=i-_-D;O===x&&F===y||(B.each(u,function(t){t.height=F}),B.each(d,function(t){t.height=F}),B.each(c,function(t){t.fullWidth||(t.width=O)}),B.each(h,function(t){t.fullWidth||(t.width=O)}),y=F,x=O);var R=o+A,L=s+T;B.each(u.concat(c),N),R+=x,L+=y,B.each(d,N),B.each(h,N),e.chartArea={left:_,top:P,right:_+x,bottom:P+y},B.each(f,function(t){t.left=e.chartArea.left,t.top=e.chartArea.top,t.right=e.chartArea.right,t.bottom=e.chartArea.bottom,t.update(x,y)})}function z(e){var t=B.findNextWhere(k,function(t){return t.box===e});if(t)if(e.isHorizontal()){var i={left:Math.max(_,M),right:Math.max(D,w),top:0,bottom:0};e.update(e.fullWidth?g:x,p/2,i)}else e.update(t.minSize.width,y)}function N(t){t.isHorizontal()?(t.left=t.fullWidth?o:_,t.right=t.fullWidth?i-r:_+x,t.top=L,t.bottom=L+t.height,L=t.bottom):(t.left=R,t.right=R+t.width,t.top=P,t.bottom=P+y,R=t.right)}}}},{46:46}],32:[function(t,e,i){"use strict";var r=t(26),s=t(46);r._set("global",{plugins:{}}),e.exports={_plugins:[],_cacheId:0,register:function(t){var e=this._plugins;[].concat(t).forEach(function(t){-1===e.indexOf(t)&&e.push(t)}),this._cacheId++},unregister:function(t){var i=this._plugins;[].concat(t).forEach(function(t){var e=i.indexOf(t);-1!==e&&i.splice(e,1)}),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(t,e,i){var n,a,o,r,s,l=this.descriptors(t),u=l.length;for(n=0;n<u;++n)if("function"==typeof(s=(o=(a=l[n]).plugin)[e])&&((r=[t].concat(i||[])).push(a.options),!1===s.apply(o,r)))return!1;return!0},descriptors:function(t){var e=t.$plugins||(t.$plugins={});if(e.id===this._cacheId)return e.descriptors;var n=[],a=[],i=t&&t.config||{},o=i.options&&i.options.plugins||{};return this._plugins.concat(i.plugins||[]).forEach(function(t){if(-1===n.indexOf(t)){var e=t.id,i=o[e];!1!==i&&(!0===i&&(i=s.clone(r.global.plugins[e])),n.push(t),a.push({plugin:t,options:i||{}}))}}),e.descriptors=a,e.id=this._cacheId,a},_invalidate:function(t){delete t.$plugins}}},{26:26,46:46}],33:[function(t,e,i){"use strict";var y=t(26),n=t(27),H=t(46),a=t(35);function k(t){var e,i,n=[];for(e=0,i=t.length;e<i;++e)n.push(t[e].label);return n}function j(t,e,i){var n=t.getPixelForTick(e);return i&&(n-=0===e?(t.getPixelForTick(1)-n)/2:(n-t.getPixelForTick(e-1))/2),n}function M(t,e,i){return H.isArray(e)?H.longestText(t,i,e):t.measureText(e).width}function w(t){var e=H.valueOrDefault,i=y.global,n=e(t.fontSize,i.defaultFontSize),a=e(t.fontStyle,i.defaultFontStyle),o=e(t.fontFamily,i.defaultFontFamily);return{size:n,style:a,family:o,font:H.fontString(n,a,o)}}function C(t){return H.options.toLineHeight(H.valueOrDefault(t.lineHeight,1.2),H.valueOrDefault(t.fontSize,y.global.defaultFontSize))}y._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",lineHeight:1.2,padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:a.formatters.values,minor:{},major:{}}}),e.exports=n.extend({getPadding:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}},getTicks:function(){return this._ticks},mergeTicksOptions:function(){var t=this.options.ticks;for(var e in!1===t.minor&&(t.minor={display:!1}),!1===t.major&&(t.major={display:!1}),t)"major"!==e&&"minor"!==e&&(void 0===t.minor[e]&&(t.minor[e]=t[e]),void 0===t.major[e]&&(t.major[e]=t[e]))},beforeUpdate:function(){H.callback(this.options.beforeUpdate,[this])},update:function(t,e,i){var n,a,o,r,s,l,u=this;for(u.beforeUpdate(),u.maxWidth=t,u.maxHeight=e,u.margins=H.extend({left:0,right:0,top:0,bottom:0},i),u.longestTextCache=u.longestTextCache||{},u.beforeSetDimensions(),u.setDimensions(),u.afterSetDimensions(),u.beforeDataLimits(),u.determineDataLimits(),u.afterDataLimits(),u.beforeBuildTicks(),s=u.buildTicks()||[],u.afterBuildTicks(),u.beforeTickToLabelConversion(),o=u.convertTicksToLabels(s)||u.ticks,u.afterTickToLabelConversion(),n=0,a=(u.ticks=o).length;n<a;++n)r=o[n],(l=s[n])?l.label=r:s.push(l={label:r,major:!1});return u._ticks=s,u.beforeCalculateTickRotation(),u.calculateTickRotation(),u.afterCalculateTickRotation(),u.beforeFit(),u.fit(),u.afterFit(),u.afterUpdate(),u.minSize},afterUpdate:function(){H.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){H.callback(this.options.beforeSetDimensions,[this])},setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0},afterSetDimensions:function(){H.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){H.callback(this.options.beforeDataLimits,[this])},determineDataLimits:H.noop,afterDataLimits:function(){H.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){H.callback(this.options.beforeBuildTicks,[this])},buildTicks:H.noop,afterBuildTicks:function(){H.callback(this.options.afterBuildTicks,[this])},beforeTickToLabelConversion:function(){H.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var t=this.options.ticks;this.ticks=this.ticks.map(t.userCallback||t.callback,this)},afterTickToLabelConversion:function(){H.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){H.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var t=this,e=t.ctx,i=t.options.ticks,n=k(t._ticks),a=w(i);e.font=a.font;var o=i.minRotation||0;if(n.length&&t.options.display&&t.isHorizontal())for(var r,s=H.longestText(e,a.font,n,t.longestTextCache),l=s,u=t.getPixelForTick(1)-t.getPixelForTick(0)-6;u<l&&o<i.maxRotation;){var d=H.toRadians(o);if(r=Math.cos(d),Math.sin(d)*s>t.maxHeight){o--;break}o++,l=r*s}t.labelRotation=o},afterCalculateTickRotation:function(){H.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){H.callback(this.options.beforeFit,[this])},fit:function(){var t=this,e=t.minSize={width:0,height:0},i=k(t._ticks),n=t.options,a=n.ticks,o=n.scaleLabel,r=n.gridLines,s=n.display,l=t.isHorizontal(),u=w(a),d=n.gridLines.tickMarkLength;if(e.width=l?t.isFullWidth()?t.maxWidth-t.margins.left-t.margins.right:t.maxWidth:s&&r.drawTicks?d:0,e.height=l?s&&r.drawTicks?d:0:t.maxHeight,o.display&&s){var c=C(o)+H.options.toPadding(o.padding).height;l?e.height+=c:e.width+=c}if(a.display&&s){var h=H.longestText(t.ctx,u.font,i,t.longestTextCache),f=H.numberOfLabelLines(i),g=.5*u.size,p=t.options.ticks.padding;if(l){t.longestLabelWidth=h;var m=H.toRadians(t.labelRotation),v=Math.cos(m),b=Math.sin(m)*h+u.size*f+g*(f-1)+g;e.height=Math.min(t.maxHeight,e.height+b+p),t.ctx.font=u.font;var x=M(t.ctx,i[0],u.font),y=M(t.ctx,i[i.length-1],u.font);0!==t.labelRotation?(t.paddingLeft="bottom"===n.position?v*x+3:v*g+3,t.paddingRight="bottom"===n.position?v*g+3:v*y+3):(t.paddingLeft=x/2+3,t.paddingRight=y/2+3)}else a.mirror?h=0:h+=p+g,e.width=Math.min(t.maxWidth,e.width+h),t.paddingTop=u.size/2,t.paddingBottom=u.size/2}t.handleMargins(),t.width=e.width,t.height=e.height},handleMargins:function(){var t=this;t.margins&&(t.paddingLeft=Math.max(t.paddingLeft-t.margins.left,0),t.paddingTop=Math.max(t.paddingTop-t.margins.top,0),t.paddingRight=Math.max(t.paddingRight-t.margins.right,0),t.paddingBottom=Math.max(t.paddingBottom-t.margins.bottom,0))},afterFit:function(){H.callback(this.options.afterFit,[this])},isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(t){if(H.isNullOrUndef(t))return NaN;if("number"==typeof t&&!isFinite(t))return NaN;if(t)if(this.isHorizontal()){if(void 0!==t.x)return this.getRightValue(t.x)}else if(void 0!==t.y)return this.getRightValue(t.y);return t},getLabelForIndex:H.noop,getPixelForValue:H.noop,getValueForPixel:H.noop,getPixelForTick:function(t){var e=this,i=e.options.offset;if(e.isHorizontal()){var n=(e.width-(e.paddingLeft+e.paddingRight))/Math.max(e._ticks.length-(i?0:1),1),a=n*t+e.paddingLeft;i&&(a+=n/2);var o=e.left+Math.round(a);return o+=e.isFullWidth()?e.margins.left:0}var r=e.height-(e.paddingTop+e.paddingBottom);return e.top+t*(r/(e._ticks.length-1))},getPixelForDecimal:function(t){var e=this;if(e.isHorizontal()){var i=(e.width-(e.paddingLeft+e.paddingRight))*t+e.paddingLeft,n=e.left+Math.round(i);return n+=e.isFullWidth()?e.margins.left:0}return e.top+t*e.height},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},getBaseValue:function(){var t=this.min,e=this.max;return this.beginAtZero?0:t<0&&e<0?e:0<t&&0<e?t:0},_autoSkip:function(t){var e,i,n,a,o=this,r=o.isHorizontal(),s=o.options.ticks.minor,l=t.length,u=H.toRadians(o.labelRotation),d=Math.cos(u),c=o.longestLabelWidth*d,h=[];for(s.maxTicksLimit&&(a=s.maxTicksLimit),r&&(e=!1,(c+s.autoSkipPadding)*l>o.width-(o.paddingLeft+o.paddingRight)&&(e=1+Math.floor((c+s.autoSkipPadding)*l/(o.width-(o.paddingLeft+o.paddingRight)))),a&&a<l&&(e=Math.max(e,Math.floor(l/a)))),i=0;i<l;i++)n=t[i],(1<e&&0<i%e||i%e==0&&l<=i+e)&&i!==l-1&&delete n.label,h.push(n);return h},draw:function(S){var _=this,D=_.options;if(D.display){var r=_.ctx,P=y.global,I=D.ticks.minor,t=D.ticks.major||I,A=D.gridLines,e=D.scaleLabel,T=0!==_.labelRotation,F=_.isHorizontal(),O=I.autoSkip?_._autoSkip(_.getTicks()):_.getTicks(),s=H.valueOrDefault(I.fontColor,P.defaultFontColor),l=w(I),u=H.valueOrDefault(t.fontColor,P.defaultFontColor),d=w(t),R=A.drawTicks?A.tickMarkLength:0,i=H.valueOrDefault(e.fontColor,P.defaultFontColor),n=w(e),a=H.options.toPadding(e.padding),L=H.toRadians(_.labelRotation),z=[],N=_.options.gridLines.lineWidth,B="right"===D.position?_.left:_.right-N-R,W="right"===D.position?_.left+R:_.right,V="bottom"===D.position?_.top+N:_.bottom-R-N,E="bottom"===D.position?_.top+N+R:_.bottom+N;if(H.each(O,function(t,e){if(!H.isNullOrUndef(t.label)){var i,n,a,o,r,s,l,u,d,c,h,f,g,p,m=t.label;o=e===_.zeroLineIndex&&D.offset===A.offsetGridLines?(i=A.zeroLineWidth,n=A.zeroLineColor,a=A.zeroLineBorderDash,A.zeroLineBorderDashOffset):(i=H.valueAtIndexOrDefault(A.lineWidth,e),n=H.valueAtIndexOrDefault(A.color,e),a=H.valueOrDefault(A.borderDash,P.borderDash),H.valueOrDefault(A.borderDashOffset,P.borderDashOffset));var v="middle",b="middle",x=I.padding;if(F){var y=R+x;p="bottom"===D.position?(b=T?"middle":"top",v=T?"right":"center",_.top+y):(b=T?"middle":"bottom",v=T?"left":"center",_.bottom-y);var k=j(_,e,A.offsetGridLines&&1<O.length);k<_.left&&(n="rgba(0,0,0,0)"),k+=H.aliasPixel(i),g=_.getPixelForTick(e)+I.labelOffset,r=l=d=h=k,s=V,u=E,c=S.top,f=S.bottom+N}else{var M,w="left"===D.position;M=I.mirror?(v=w?"left":"right",x):(v=w?"right":"left",R+x),g=w?_.right-M:_.left+M;var C=j(_,e,A.offsetGridLines&&1<O.length);C<_.top&&(n="rgba(0,0,0,0)"),C+=H.aliasPixel(i),p=_.getPixelForTick(e)+I.labelOffset,r=B,l=W,d=S.left,h=S.right+N,s=u=c=f=C}z.push({tx1:r,ty1:s,tx2:l,ty2:u,x1:d,y1:c,x2:h,y2:f,labelX:g,labelY:p,glWidth:i,glColor:n,glBorderDash:a,glBorderDashOffset:o,rotation:-1*L,label:m,major:t.major,textBaseline:b,textAlign:v})}}),H.each(z,function(t){if(A.display&&(r.save(),r.lineWidth=t.glWidth,r.strokeStyle=t.glColor,r.setLineDash&&(r.setLineDash(t.glBorderDash),r.lineDashOffset=t.glBorderDashOffset),r.beginPath(),A.drawTicks&&(r.moveTo(t.tx1,t.ty1),r.lineTo(t.tx2,t.ty2)),A.drawOnChartArea&&(r.moveTo(t.x1,t.y1),r.lineTo(t.x2,t.y2)),r.stroke(),r.restore()),I.display){r.save(),r.translate(t.labelX,t.labelY),r.rotate(t.rotation),r.font=t.major?d.font:l.font,r.fillStyle=t.major?u:s,r.textBaseline=t.textBaseline,r.textAlign=t.textAlign;var e=t.label;if(H.isArray(e))for(var i=e.length,n=1.5*l.size,a=_.isHorizontal()?0:-n*(i-1)/2,o=0;o<i;++o)r.fillText(""+e[o],0,a),a+=n;else r.fillText(e,0,0);r.restore()}}),e.display){var o,c,h=0,f=C(e)/2;if(F)o=_.left+(_.right-_.left)/2,c="bottom"===D.position?_.bottom-f-a.bottom:_.top+f+a.top;else{var g="left"===D.position;o=g?_.left+f+a.top:_.right-f-a.top,c=_.top+(_.bottom-_.top)/2,h=g?-.5*Math.PI:.5*Math.PI}r.save(),r.translate(o,c),r.rotate(h),r.textAlign="center",r.textBaseline="middle",r.fillStyle=i,r.font=n.font,r.fillText(e.labelString,0,0),r.restore()}if(A.drawBorder){r.lineWidth=H.valueAtIndexOrDefault(A.lineWidth,0),r.strokeStyle=H.valueAtIndexOrDefault(A.color,0);var p=_.left,m=_.right+N,v=_.top,b=_.bottom+N,x=H.aliasPixel(r.lineWidth);F?(v=b="top"===D.position?_.bottom:_.top,v+=x,b+=x):(p=m="left"===D.position?_.right:_.left,p+=x,m+=x),r.beginPath(),r.moveTo(p,v),r.lineTo(m,b),r.stroke()}}}})},{26:26,27:27,35:35,46:46}],34:[function(t,e,i){"use strict";var n=t(26),a=t(46),o=t(31);e.exports={constructors:{},defaults:{},registerScaleType:function(t,e,i){this.constructors[t]=e,this.defaults[t]=a.clone(i)},getScaleConstructor:function(t){return this.constructors.hasOwnProperty(t)?this.constructors[t]:void 0},getScaleDefaults:function(t){return this.defaults.hasOwnProperty(t)?a.merge({},[n.scale,this.defaults[t]]):{}},updateScaleDefaults:function(t,e){this.defaults.hasOwnProperty(t)&&(this.defaults[t]=a.extend(this.defaults[t],e))},addScalesToLayout:function(e){a.each(e.scales,function(t){t.fullWidth=t.options.fullWidth,t.position=t.options.position,t.weight=t.options.weight,o.addBox(e,t)})}}},{26:26,31:31,46:46}],35:[function(t,e,i){"use strict";var l=t(46);e.exports={formatters:{values:function(t){return l.isArray(t)?t:""+t},linear:function(t,e,i){var n=3<i.length?i[2]-i[1]:i[1]-i[0];1<Math.abs(n)&&t!==Math.floor(t)&&(n=t-Math.floor(t));var a=l.log10(Math.abs(n)),o="";if(0!==t)if(Math.max(Math.abs(i[0]),Math.abs(i[i.length-1]))<1e-4){var r=l.log10(Math.abs(t));o=t.toExponential(Math.floor(r)-Math.floor(a))}else{var s=-1*Math.floor(a);s=Math.max(Math.min(s,20),0),o=t.toFixed(s)}else o="0";return o},logarithmic:function(t,e,i){var n=t/Math.pow(10,Math.floor(l.log10(t)));return 0===t?"0":1===n||2===n||5===n||0===e||e===i.length-1?t.toExponential():""}}}},{46:46}],36:[function(t,e,i){"use strict";var n=t(26),a=t(27),R=t(46);n._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:R.noop,title:function(t,e){var i="",n=e.labels,a=n?n.length:0;if(0<t.length){var o=t[0];o.xLabel?i=o.xLabel:0<a&&o.index<a&&(i=n[o.index])}return i},afterTitle:R.noop,beforeBody:R.noop,beforeLabel:R.noop,label:function(t,e){var i=e.datasets[t.datasetIndex].label||"";return i&&(i+=": "),i+=t.yLabel},labelColor:function(t,e){var i=e.getDatasetMeta(t.datasetIndex).data[t.index]._view;return{borderColor:i.borderColor,backgroundColor:i.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:R.noop,afterBody:R.noop,beforeFooter:R.noop,footer:R.noop,afterFooter:R.noop}}});var L={average:function(t){if(!t.length)return!1;var e,i,n=0,a=0,o=0;for(e=0,i=t.length;e<i;++e){var r=t[e];if(r&&r.hasValue()){var s=r.tooltipPosition();n+=s.x,a+=s.y,++o}}return{x:Math.round(n/o),y:Math.round(a/o)}},nearest:function(t,e){var i,n,a,o=e.x,r=e.y,s=Number.POSITIVE_INFINITY;for(i=0,n=t.length;i<n;++i){var l=t[i];if(l&&l.hasValue()){var u=l.getCenterPoint(),d=R.distanceBetweenPoints(e,u);d<s&&(s=d,a=l)}}if(a){var c=a.tooltipPosition();o=c.x,r=c.y}return{x:o,y:r}}};function h(t,e){var i=R.color(t);return i.alpha(e*i.alpha()).rgbaString()}function r(t,e){return e&&(R.isArray(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function s(t){return("string"==typeof t||t instanceof String)&&-1<t.indexOf("\n")?t.split("\n"):t}function z(t){var e=n.global,i=R.valueOrDefault;return{xPadding:t.xPadding,yPadding:t.yPadding,xAlign:t.xAlign,yAlign:t.yAlign,bodyFontColor:t.bodyFontColor,_bodyFontFamily:i(t.bodyFontFamily,e.defaultFontFamily),_bodyFontStyle:i(t.bodyFontStyle,e.defaultFontStyle),_bodyAlign:t.bodyAlign,bodyFontSize:i(t.bodyFontSize,e.defaultFontSize),bodySpacing:t.bodySpacing,titleFontColor:t.titleFontColor,_titleFontFamily:i(t.titleFontFamily,e.defaultFontFamily),_titleFontStyle:i(t.titleFontStyle,e.defaultFontStyle),titleFontSize:i(t.titleFontSize,e.defaultFontSize),_titleAlign:t.titleAlign,titleSpacing:t.titleSpacing,titleMarginBottom:t.titleMarginBottom,footerFontColor:t.footerFontColor,_footerFontFamily:i(t.footerFontFamily,e.defaultFontFamily),_footerFontStyle:i(t.footerFontStyle,e.defaultFontStyle),footerFontSize:i(t.footerFontSize,e.defaultFontSize),_footerAlign:t.footerAlign,footerSpacing:t.footerSpacing,footerMarginTop:t.footerMarginTop,caretSize:t.caretSize,cornerRadius:t.cornerRadius,backgroundColor:t.backgroundColor,opacity:0,legendColorBackground:t.multiKeyBackground,displayColors:t.displayColors,borderColor:t.borderColor,borderWidth:t.borderWidth}}function o(t){return r([],s(t))}(e.exports=a.extend({initialize:function(){this._model=z(this._options),this._lastActive=[]},getTitle:function(){var t=this._options.callbacks,e=t.beforeTitle.apply(this,arguments),i=t.title.apply(this,arguments),n=t.afterTitle.apply(this,arguments),a=[];return a=r(a=r(a=r(a,s(e)),s(i)),s(n))},getBeforeBody:function(){return o(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function(t,i){var n=this,a=n._options.callbacks,o=[];return R.each(t,function(t){var e={before:[],lines:[],after:[]};r(e.before,s(a.beforeLabel.call(n,t,i))),r(e.lines,a.label.call(n,t,i)),r(e.after,s(a.afterLabel.call(n,t,i))),o.push(e)}),o},getAfterBody:function(){return o(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function(){var t=this._options.callbacks,e=t.beforeFooter.apply(this,arguments),i=t.footer.apply(this,arguments),n=t.afterFooter.apply(this,arguments),a=[];return a=r(a=r(a=r(a,s(e)),s(i)),s(n))},update:function(t){var e,i,n,a,o,r,s,l,u,d,c,h,f,g,p,m,v,b,x,y,k=this,M=k._options,w=k._model,C=k._model=z(M),S=k._active,_=k._data,D={xAlign:w.xAlign,yAlign:w.yAlign},P={x:w.x,y:w.y},I={width:w.width,height:w.height},A={x:w.caretX,y:w.caretY};if(S.length){C.opacity=1;var T=[],F=[];A=L[M.position].call(k,S,k._eventPosition);var O=[];for(e=0,i=S.length;e<i;++e)O.push((m=S[e],b=v=void 0,v=m._xScale,b=m._yScale||m._scale,x=m._index,y=m._datasetIndex,{xLabel:v?v.getLabelForIndex(x,y):"",yLabel:b?b.getLabelForIndex(x,y):"",index:x,datasetIndex:y,x:m._model.x,y:m._model.y}));M.filter&&(O=O.filter(function(t){return M.filter(t,_)})),M.itemSort&&(O=O.sort(function(t,e){return M.itemSort(t,e,_)})),R.each(O,function(t){T.push(M.callbacks.labelColor.call(k,t,k._chart)),F.push(M.callbacks.labelTextColor.call(k,t,k._chart))}),C.title=k.getTitle(O,_),C.beforeBody=k.getBeforeBody(O,_),C.body=k.getBody(O,_),C.afterBody=k.getAfterBody(O,_),C.footer=k.getFooter(O,_),C.x=Math.round(A.x),C.y=Math.round(A.y),C.caretPadding=M.caretPadding,C.labelColors=T,C.labelTextColors=F,C.dataPoints=O,D=function(t,e){var i,n,a,o,r,s=t._model,l=t._chart,u=t._chart.chartArea,d="center",c="center";s.y<e.height?c="top":s.y>l.height-e.height&&(c="bottom");var h=(u.left+u.right)/2,f=(u.top+u.bottom)/2;n="center"===c?(i=function(t){return t<=h},function(t){return h<t}):(i=function(t){return t<=e.width/2},function(t){return t>=l.width-e.width/2}),a=function(t){return t+e.width+s.caretSize+s.caretPadding>l.width},o=function(t){return t-e.width-s.caretSize-s.caretPadding<0},r=function(t){return t<=f?"top":"bottom"},i(s.x)?(d="left",a(s.x)&&(d="center",c=r(s.y))):n(s.x)&&(d="right",o(s.x)&&(d="center",c=r(s.y)));var g=t._options;return{xAlign:g.xAlign?g.xAlign:d,yAlign:g.yAlign?g.yAlign:c}}(this,I=function(t,e){var i=t._chart.ctx,n=2*e.yPadding,a=0,o=e.body,r=o.reduce(function(t,e){return t+e.before.length+e.lines.length+e.after.length},0);r+=e.beforeBody.length+e.afterBody.length;var s=e.title.length,l=e.footer.length,u=e.titleFontSize,d=e.bodyFontSize,c=e.footerFontSize;n+=s*u,n+=s?(s-1)*e.titleSpacing:0,n+=s?e.titleMarginBottom:0,n+=r*d,n+=r?(r-1)*e.bodySpacing:0,n+=l?e.footerMarginTop:0,n+=l*c,n+=l?(l-1)*e.footerSpacing:0;var h=0,f=function(t){a=Math.max(a,i.measureText(t).width+h)};return i.font=R.fontString(u,e._titleFontStyle,e._titleFontFamily),R.each(e.title,f),i.font=R.fontString(d,e._bodyFontStyle,e._bodyFontFamily),R.each(e.beforeBody.concat(e.afterBody),f),h=e.displayColors?d+2:0,R.each(o,function(t){R.each(t.before,f),R.each(t.lines,f),R.each(t.after,f)}),h=0,i.font=R.fontString(c,e._footerFontStyle,e._footerFontFamily),R.each(e.footer,f),{width:a+=2*e.xPadding,height:n}}(this,C)),n=C,a=I,o=D,r=k._chart,s=n.x,l=n.y,u=n.caretSize,d=n.caretPadding,c=n.cornerRadius,h=o.xAlign,f=o.yAlign,g=u+d,p=c+d,"right"===h?s-=a.width:"center"===h&&((s-=a.width/2)+a.width>r.width&&(s=r.width-a.width),s<0&&(s=0)),"top"===f?l+=g:l-="bottom"===f?a.height+g:a.height/2,"center"===f?"left"===h?s+=g:"right"===h&&(s-=g):"left"===h?s-=p:"right"===h&&(s+=p),P={x:s,y:l}}else C.opacity=0;return C.xAlign=D.xAlign,C.yAlign=D.yAlign,C.x=P.x,C.y=P.y,C.width=I.width,C.height=I.height,C.caretX=A.x,C.caretY=A.y,k._model=C,t&&M.custom&&M.custom.call(k,C),k},drawCaret:function(t,e){var i=this._chart.ctx,n=this._view,a=this.getCaretPosition(t,e,n);i.lineTo(a.x1,a.y1),i.lineTo(a.x2,a.y2),i.lineTo(a.x3,a.y3)},getCaretPosition:function(t,e,i){var n,a,o,r,s,l,u=i.caretSize,d=i.cornerRadius,c=i.xAlign,h=i.yAlign,f=t.x,g=t.y,p=e.width,m=e.height;if("center"===h)s=g+m/2,l="left"===c?(a=(n=f)-u,o=n,r=s+u,s-u):(a=(n=f+p)+u,o=n,r=s-u,s+u);else if(o=(n="left"===c?(a=f+d+u)-u:"right"===c?(a=f+p-d-u)-u:(a=i.caretX)-u,a+u),"top"===h)s=(r=g)-u,l=r;else{s=(r=g+m)+u,l=r;var v=o;o=n,n=v}return{x1:n,x2:a,x3:o,y1:r,y2:s,y3:l}},drawTitle:function(t,e,i,n){var a=e.title;if(a.length){i.textAlign=e._titleAlign,i.textBaseline="top";var o,r,s=e.titleFontSize,l=e.titleSpacing;for(i.fillStyle=h(e.titleFontColor,n),i.font=R.fontString(s,e._titleFontStyle,e._titleFontFamily),o=0,r=a.length;o<r;++o)i.fillText(a[o],t.x,t.y),t.y+=s+l,o+1===a.length&&(t.y+=e.titleMarginBottom-l)}},drawBody:function(n,a,o,r){var s=a.bodyFontSize,e=a.bodySpacing,t=a.body;o.textAlign=a._bodyAlign,o.textBaseline="top",o.font=R.fontString(s,a._bodyFontStyle,a._bodyFontFamily);var i=0,l=function(t){o.fillText(t,n.x+i,n.y),n.y+=s+e};o.fillStyle=h(a.bodyFontColor,r),R.each(a.beforeBody,l);var u=a.displayColors;i=u?s+2:0,R.each(t,function(t,e){var i=h(a.labelTextColors[e],r);o.fillStyle=i,R.each(t.before,l),R.each(t.lines,function(t){u&&(o.fillStyle=h(a.legendColorBackground,r),o.fillRect(n.x,n.y,s,s),o.lineWidth=1,o.strokeStyle=h(a.labelColors[e].borderColor,r),o.strokeRect(n.x,n.y,s,s),o.fillStyle=h(a.labelColors[e].backgroundColor,r),o.fillRect(n.x+1,n.y+1,s-2,s-2),o.fillStyle=i),l(t)}),R.each(t.after,l)}),i=0,R.each(a.afterBody,l),n.y-=e},drawFooter:function(e,i,n,t){var a=i.footer;a.length&&(e.y+=i.footerMarginTop,n.textAlign=i._footerAlign,n.textBaseline="top",n.fillStyle=h(i.footerFontColor,t),n.font=R.fontString(i.footerFontSize,i._footerFontStyle,i._footerFontFamily),R.each(a,function(t){n.fillText(t,e.x,e.y),e.y+=i.footerFontSize+i.footerSpacing}))},drawBackground:function(t,e,i,n,a){i.fillStyle=h(e.backgroundColor,a),i.strokeStyle=h(e.borderColor,a),i.lineWidth=e.borderWidth;var o=e.xAlign,r=e.yAlign,s=t.x,l=t.y,u=n.width,d=n.height,c=e.cornerRadius;i.beginPath(),i.moveTo(s+c,l),"top"===r&&this.drawCaret(t,n),i.lineTo(s+u-c,l),i.quadraticCurveTo(s+u,l,s+u,l+c),"center"===r&&"right"===o&&this.drawCaret(t,n),i.lineTo(s+u,l+d-c),i.quadraticCurveTo(s+u,l+d,s+u-c,l+d),"bottom"===r&&this.drawCaret(t,n),i.lineTo(s+c,l+d),i.quadraticCurveTo(s,l+d,s,l+d-c),"center"===r&&"left"===o&&this.drawCaret(t,n),i.lineTo(s,l+c),i.quadraticCurveTo(s,l,s+c,l),i.closePath(),i.fill(),0<e.borderWidth&&i.stroke()},draw:function(){var t=this._chart.ctx,e=this._view;if(0!==e.opacity){var i={width:e.width,height:e.height},n={x:e.x,y:e.y},a=Math.abs(e.opacity<.001)?0:e.opacity,o=e.title.length||e.beforeBody.length||e.body.length||e.afterBody.length||e.footer.length;this._options.enabled&&o&&(this.drawBackground(n,e,t,i,a),n.x+=e.xPadding,n.y+=e.yPadding,this.drawTitle(n,e,t,a),this.drawBody(n,e,t,a),this.drawFooter(n,e,t,a))}},handleEvent:function(t){var e,i=this,n=i._options;return i._lastActive=i._lastActive||[],"mouseout"===t.type?i._active=[]:i._active=i._chart.getElementsAtEventForMode(t,n.mode,n),(e=!R.arrayEquals(i._active,i._lastActive))&&(i._lastActive=i._active,(n.enabled||n.custom)&&(i._eventPosition={x:t.x,y:t.y},i.update(!0),i.pivot())),e}})).positioners=L},{26:26,27:27,46:46}],37:[function(t,e,i){"use strict";var n=t(26),a=t(27),d=t(46);n._set("global",{elements:{arc:{backgroundColor:n.global.defaultColor,borderColor:"#fff",borderWidth:2}}}),e.exports=a.extend({inLabelRange:function(t){var e=this._view;return!!e&&Math.pow(t-e.x,2)<Math.pow(e.radius+e.hoverRadius,2)},inRange:function(t,e){var i=this._view;if(i){for(var n=d.getAngleFromPoint(i,{x:t,y:e}),a=n.angle,o=n.distance,r=i.startAngle,s=i.endAngle;s<r;)s+=2*Math.PI;for(;s<a;)a-=2*Math.PI;for(;a<r;)a+=2*Math.PI;var l=r<=a&&a<=s,u=o>=i.innerRadius&&o<=i.outerRadius;return l&&u}return!1},getCenterPoint:function(){var t=this._view,e=(t.startAngle+t.endAngle)/2,i=(t.innerRadius+t.outerRadius)/2;return{x:t.x+Math.cos(e)*i,y:t.y+Math.sin(e)*i}},getArea:function(){var t=this._view;return Math.PI*((t.endAngle-t.startAngle)/(2*Math.PI))*(Math.pow(t.outerRadius,2)-Math.pow(t.innerRadius,2))},tooltipPosition:function(){var t=this._view,e=t.startAngle+(t.endAngle-t.startAngle)/2,i=(t.outerRadius-t.innerRadius)/2+t.innerRadius;return{x:t.x+Math.cos(e)*i,y:t.y+Math.sin(e)*i}},draw:function(){var t=this._chart.ctx,e=this._view,i=e.startAngle,n=e.endAngle;t.beginPath(),t.arc(e.x,e.y,e.outerRadius,i,n),t.arc(e.x,e.y,e.innerRadius,n,i,!0),t.closePath(),t.strokeStyle=e.borderColor,t.lineWidth=e.borderWidth,t.fillStyle=e.backgroundColor,t.fill(),t.lineJoin="bevel",e.borderWidth&&t.stroke()}})},{26:26,27:27,46:46}],38:[function(t,e,i){"use strict";var n=t(26),a=t(27),d=t(46),c=n.global;n._set("global",{elements:{line:{tension:.4,backgroundColor:c.defaultColor,borderWidth:3,borderColor:c.defaultColor,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}}),e.exports=a.extend({draw:function(){var t,e,i,n,a=this._view,o=this._chart.ctx,r=a.spanGaps,s=this._children.slice(),l=c.elements.line,u=-1;for(this._loop&&s.length&&s.push(s[0]),o.save(),o.lineCap=a.borderCapStyle||l.borderCapStyle,o.setLineDash&&o.setLineDash(a.borderDash||l.borderDash),o.lineDashOffset=a.borderDashOffset||l.borderDashOffset,o.lineJoin=a.borderJoinStyle||l.borderJoinStyle,o.lineWidth=a.borderWidth||l.borderWidth,o.strokeStyle=a.borderColor||c.defaultColor,o.beginPath(),u=-1,t=0;t<s.length;++t)e=s[t],i=d.previousItem(s,t),n=e._view,0===t?n.skip||(o.moveTo(n.x,n.y),u=t):(i=-1===u?i:s[u],n.skip||(u!==t-1&&!r||-1===u?o.moveTo(n.x,n.y):d.canvas.lineTo(o,i._view,e._view),u=t));o.stroke(),o.restore()}})},{26:26,27:27,46:46}],39:[function(t,e,i){"use strict";var u=t(26),n=t(27),d=t(46),c=u.global.defaultColor;function a(t){var e=this._view;return!!e&&Math.abs(t-e.x)<e.radius+e.hitRadius}u._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:c,borderColor:c,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}}),e.exports=n.extend({inRange:function(t,e){var i=this._view;return!!i&&Math.pow(t-i.x,2)+Math.pow(e-i.y,2)<Math.pow(i.hitRadius+i.radius,2)},inLabelRange:a,inXRange:a,inYRange:function(t){var e=this._view;return!!e&&Math.abs(t-e.y)<e.radius+e.hitRadius},getCenterPoint:function(){var t=this._view;return{x:t.x,y:t.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y,padding:t.radius+t.borderWidth}},draw:function(t){var e=this._view,i=this._model,n=this._chart.ctx,a=e.pointStyle,o=e.rotation,r=e.radius,s=e.x,l=e.y;e.skip||(void 0===t||i.x>=t.left&&1.01*t.right>=i.x&&i.y>=t.top&&1.01*t.bottom>=i.y)&&(n.strokeStyle=e.borderColor||c,n.lineWidth=d.valueOrDefault(e.borderWidth,u.global.elements.point.borderWidth),n.fillStyle=e.backgroundColor||c,d.canvas.drawPoint(n,a,r,s,l,o))}})},{26:26,27:27,46:46}],40:[function(t,e,i){"use strict";var n=t(26),a=t(27);function l(t){return void 0!==t._view.width}function o(t){var e,i,n,a,o=t._view;if(l(t)){var r=o.width/2;e=o.x-r,i=o.x+r,n=Math.min(o.y,o.base),a=Math.max(o.y,o.base)}else{var s=o.height/2;e=Math.min(o.x,o.base),i=Math.max(o.x,o.base),n=o.y-s,a=o.y+s}return{left:e,top:n,right:i,bottom:a}}n._set("global",{elements:{rectangle:{backgroundColor:n.global.defaultColor,borderColor:n.global.defaultColor,borderSkipped:"bottom",borderWidth:0}}}),e.exports=a.extend({draw:function(){var t,e,i,n,a,o,r,s=this._chart.ctx,l=this._view,u=l.borderWidth;if(r=l.horizontal?(t=l.base,e=l.x,i=l.y-l.height/2,n=l.y+l.height/2,a=t<e?1:-1,o=1,l.borderSkipped||"left"):(t=l.x-l.width/2,e=l.x+l.width/2,a=1,o=(i=l.y)<(n=l.base)?1:-1,l.borderSkipped||"bottom"),u){var d=Math.min(Math.abs(t-e),Math.abs(i-n)),c=(u=d<u?d:u)/2,h=t+("left"!==r?c*a:0),f=e+("right"!==r?-c*a:0),g=i+("top"!==r?c*o:0),p=n+("bottom"!==r?-c*o:0);h!==f&&(i=g,n=p),g!==p&&(t=h,e=f)}s.beginPath(),s.fillStyle=l.backgroundColor,s.strokeStyle=l.borderColor,s.lineWidth=u;var m=[[t,n],[t,i],[e,i],[e,n]],v=["bottom","left","top","right"].indexOf(r,0);function b(t){return m[(v+t)%4]}-1===v&&(v=0);var x=b(0);s.moveTo(x[0],x[1]);for(var y=1;y<4;y++)x=b(y),s.lineTo(x[0],x[1]);s.fill(),u&&s.stroke()},height:function(){var t=this._view;return t.base-t.y},inRange:function(t,e){var i=!1;if(this._view){var n=o(this);i=t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom}return i},inLabelRange:function(t,e){if(!this._view)return!1;var i=o(this);return l(this)?t>=i.left&&t<=i.right:e>=i.top&&e<=i.bottom},inXRange:function(t){var e=o(this);return t>=e.left&&t<=e.right},inYRange:function(t){var e=o(this);return t>=e.top&&t<=e.bottom},getCenterPoint:function(){var t,e,i=this._view;return e=l(this)?(t=i.x,(i.y+i.base)/2):(t=(i.x+i.base)/2,i.y),{x:t,y:e}},getArea:function(){var t=this._view;return t.width*Math.abs(t.y-t.base)},tooltipPosition:function(){var t=this._view;return{x:t.x,y:t.y}}})},{26:26,27:27}],41:[function(t,e,i){"use strict";e.exports={},e.exports.Arc=t(37),e.exports.Line=t(38),e.exports.Point=t(39),e.exports.Rectangle=t(40)},{37:37,38:38,39:39,40:40}],42:[function(t,e,i){"use strict";var n=t(43);i=e.exports={clear:function(t){t.ctx.clearRect(0,0,t.width,t.height)},roundedRect:function(t,e,i,n,a,o){if(o){var r=Math.min(o,a/2-1e-7,n/2-1e-7);t.moveTo(e+r,i),t.lineTo(e+n-r,i),t.arcTo(e+n,i,e+n,i+r,r),t.lineTo(e+n,i+a-r),t.arcTo(e+n,i+a,e+n-r,i+a,r),t.lineTo(e+r,i+a),t.arcTo(e,i+a,e,i+a-r,r),t.lineTo(e,i+r),t.arcTo(e,i,e+r,i,r),t.closePath(),t.moveTo(e,i)}else t.rect(e,i,n,a)},drawPoint:function(t,e,i,n,a,o){var r,s,l,u,d,c;if(o=o||0,!e||"object"!=typeof e||"[object HTMLImageElement]"!==(r=e.toString())&&"[object HTMLCanvasElement]"!==r){if(!(isNaN(i)||i<=0)){switch(t.save(),t.translate(n,a),t.rotate(o*Math.PI/180),t.beginPath(),e){default:t.arc(0,0,i,0,2*Math.PI),t.closePath();break;case"triangle":d=(s=3*i/Math.sqrt(3))*Math.sqrt(3)/2,t.moveTo(-s/2,d/3),t.lineTo(s/2,d/3),t.lineTo(0,-2*d/3),t.closePath();break;case"rect":c=1/Math.SQRT2*i,t.rect(-c,-c,2*c,2*c);break;case"rectRounded":var h=i/Math.SQRT2,f=-h,g=-h,p=Math.SQRT2*i;this.roundedRect(t,f,g,p,p,.425*i);break;case"rectRot":c=1/Math.SQRT2*i,t.moveTo(-c,0),t.lineTo(0,c),t.lineTo(c,0),t.lineTo(0,-c),t.closePath();break;case"cross":t.moveTo(0,i),t.lineTo(0,-i),t.moveTo(-i,0),t.lineTo(i,0);break;case"crossRot":l=Math.cos(Math.PI/4)*i,u=Math.sin(Math.PI/4)*i,t.moveTo(-l,-u),t.lineTo(l,u),t.moveTo(-l,u),t.lineTo(l,-u);break;case"star":t.moveTo(0,i),t.lineTo(0,-i),t.moveTo(-i,0),t.lineTo(i,0),l=Math.cos(Math.PI/4)*i,u=Math.sin(Math.PI/4)*i,t.moveTo(-l,-u),t.lineTo(l,u),t.moveTo(-l,u),t.lineTo(l,-u);break;case"line":t.moveTo(-i,0),t.lineTo(i,0);break;case"dash":t.moveTo(0,0),t.lineTo(i,0)}t.fill(),t.stroke(),t.restore()}}else t.drawImage(e,n-e.width/2,a-e.height/2,e.width,e.height)},clipArea:function(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()},unclipArea:function(t){t.restore()},lineTo:function(t,e,i,n){if(i.steppedLine)return"after"===i.steppedLine&&!n||"after"!==i.steppedLine&&n?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y),void t.lineTo(i.x,i.y);i.tension?t.bezierCurveTo(n?e.controlPointPreviousX:e.controlPointNextX,n?e.controlPointPreviousY:e.controlPointNextY,n?i.controlPointNextX:i.controlPointPreviousX,n?i.controlPointNextY:i.controlPointPreviousY,i.x,i.y):t.lineTo(i.x,i.y)}};n.clear=i.clear,n.drawRoundedRectangle=function(t){t.beginPath(),i.roundedRect.apply(i,arguments)}},{43:43}],43:[function(t,e,i){"use strict";var n,d={noop:function(){},uid:(n=0,function(){return n++}),isNullOrUndef:function(t){return null==t},isArray:Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isObject:function(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)},valueOrDefault:function(t,e){return void 0===t?e:t},valueAtIndexOrDefault:function(t,e,i){return d.valueOrDefault(d.isArray(t)?t[e]:t,i)},callback:function(t,e,i){if(t&&"function"==typeof t.call)return t.apply(i,e)},each:function(t,e,i,n){var a,o,r;if(d.isArray(t))if(o=t.length,n)for(a=o-1;0<=a;a--)e.call(i,t[a],a);else for(a=0;a<o;a++)e.call(i,t[a],a);else if(d.isObject(t))for(o=(r=Object.keys(t)).length,a=0;a<o;a++)e.call(i,t[r[a]],r[a])},arrayEquals:function(t,e){var i,n,a,o;if(!t||!e||t.length!==e.length)return!1;for(i=0,n=t.length;i<n;++i)if(a=t[i],o=e[i],a instanceof Array&&o instanceof Array){if(!d.arrayEquals(a,o))return!1}else if(a!==o)return!1;return!0},clone:function(t){if(d.isArray(t))return t.map(d.clone);if(d.isObject(t)){for(var e={},i=Object.keys(t),n=i.length,a=0;a<n;++a)e[i[a]]=d.clone(t[i[a]]);return e}return t},_merger:function(t,e,i,n){var a=e[t],o=i[t];d.isObject(a)&&d.isObject(o)?d.merge(a,o,n):e[t]=d.clone(o)},_mergerIf:function(t,e,i){var n=e[t],a=i[t];d.isObject(n)&&d.isObject(a)?d.mergeIf(n,a):e.hasOwnProperty(t)||(e[t]=d.clone(a))},merge:function(t,e,i){var n,a,o,r,s,l=d.isArray(e)?e:[e],u=l.length;if(!d.isObject(t))return t;for(n=(i=i||{}).merger||d._merger,a=0;a<u;++a)if(e=l[a],d.isObject(e))for(s=0,r=(o=Object.keys(e)).length;s<r;++s)n(o[s],t,e,i);return t},mergeIf:function(t,e){return d.merge(t,e,{merger:d._mergerIf})},extend:function(i){for(var t=function(t,e){i[e]=t},e=1,n=arguments.length;e<n;++e)d.each(arguments[e],t);return i},inherits:function(t){var e=this,i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},n=function(){this.constructor=i};return n.prototype=e.prototype,i.prototype=new n,i.extend=d.inherits,t&&d.extend(i.prototype,t),i.__super__=e.prototype,i}};(e.exports=d).callCallback=d.callback,d.indexOf=function(t,e,i){return Array.prototype.indexOf.call(t,e,i)},d.getValueOrDefault=d.valueOrDefault,d.getValueAtIndexOrDefault=d.valueAtIndexOrDefault},{}],44:[function(t,e,i){"use strict";var n=t(43),a={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return(t-=1)*t*t+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-((t-=1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return(t-=1)*t*t*t*t+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return 1<=t?t:-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-(t-=1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),e=n<1?(n=1,i/4):i/(2*Math.PI)*Math.asin(1/n),-n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i))},easeOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),e=n<1?(n=1,i/4):i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/i)+1)},easeInOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:2==(t/=.5)?1:(i||(i=.45),e=n<1?(n=1,i/4):i/(2*Math.PI)*Math.asin(1/n),t<1?n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*-.5:n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*.5+1)},easeInBack:function(t){return t*t*(2.70158*t-1.70158)},easeOutBack:function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:function(t){return 1-a.easeOutBounce(1-t)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:function(t){return t<.5?.5*a.easeInBounce(2*t):.5*a.easeOutBounce(2*t-1)+.5}};e.exports={effects:a},n.easingEffects=a},{43:43}],45:[function(t,e,i){"use strict";var r=t(43);e.exports={toLineHeight:function(t,e){var i=(""+t).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!i||"normal"===i[1])return 1.2*e;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100}return e*t},toPadding:function(t){var e,i,n,a;return r.isObject(t)?(e=+t.top||0,i=+t.right||0,n=+t.bottom||0,a=+t.left||0):e=i=n=a=+t||0,{top:e,right:i,bottom:n,left:a,height:e+n,width:a+i}},resolve:function(t,e,i){var n,a,o;for(n=0,a=t.length;n<a;++n)if(void 0!==(o=t[n])&&(void 0!==e&&"function"==typeof o&&(o=o(e)),void 0!==i&&r.isArray(o)&&(o=o[i]),void 0!==o))return o}}},{43:43}],46:[function(t,e,i){"use strict";e.exports=t(43),e.exports.easing=t(44),e.exports.canvas=t(42),e.exports.options=t(45)},{42:42,43:43,44:44,45:45}],47:[function(t,e,i){e.exports={acquireContext:function(t){return t&&t.canvas&&(t=t.canvas),t&&t.getContext("2d")||null}}},{}],48:[function(t,e,i){"use strict";var f=t(46),g="$chartjs",p="chartjs-",m=p+"render-monitor",v=p+"render-animation",b=["animationstart","webkitAnimationStart"],s={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function l(t,e){var i=f.getStyle(t,e),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?Number(n[1]):void 0}var n=!!function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("e",null,e)}catch(t){}return t}()&&{passive:!0};function x(t,e,i){t.addEventListener(e,i,n)}function r(t,e,i){t.removeEventListener(e,i,n)}function y(t,e,i,n,a){return{type:t,chart:e,native:a||null,x:void 0!==i?i:null,y:void 0!==n?n:null}}function a(e,t,i){var n,a,o,r,s,l,u,d,c=e[g]||(e[g]={}),h=c.resizer=function(t){var e=document.createElement("div"),i=p+"size-monitor",n="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;";e.style.cssText=n,e.className=i,e.innerHTML='<div class="'+i+'-expand" style="'+n+'"><div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div></div><div class="'+i+'-shrink" style="'+n+'"><div style="position:absolute;width:200%;height:200%;left:0; top:0"></div></div>';var a=e.childNodes[0],o=e.childNodes[1];e._reset=function(){a.scrollLeft=1e6,a.scrollTop=1e6,o.scrollLeft=1e6,o.scrollTop=1e6};var r=function(){e._reset(),t()};return x(a,"scroll",r.bind(a,"expand")),x(o,"scroll",r.bind(o,"shrink")),e}((o=!(n=function(){if(c.resizer)return t(y("resize",i))}),r=[],function(){r=Array.prototype.slice.call(arguments),a=a||this,o||(o=!0,f.requestAnimFrame.call(window,function(){o=!1,n.apply(a,r)}))}));l=function(){if(c.resizer){var t=e.parentNode;t&&t!==h.parentNode&&t.insertBefore(h,t.firstChild),h._reset()}},u=(s=e)[g]||(s[g]={}),d=u.renderProxy=function(t){t.animationName===v&&l()},f.each(b,function(t){x(s,t,d)}),u.reflow=!!s.offsetParent,s.classList.add(m)}function o(t){var e,i,n,a=t[g]||{},o=a.resizer;delete a.resizer,i=(e=t)[g]||{},(n=i.renderProxy)&&(f.each(b,function(t){r(e,t,n)}),delete i.renderProxy),e.classList.remove(m),o&&o.parentNode&&o.parentNode.removeChild(o)}e.exports={_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,initialize:function(){var t,e,i,n="from{opacity:0.99}to{opacity:1}";e="@-webkit-keyframes "+v+"{"+n+"}@keyframes "+v+"{"+n+"}."+m+"{-webkit-animation:"+v+" 0.001s;animation:"+v+" 0.001s;}",i=(t=this)._style||document.createElement("style"),t._style||(e="/* Chart.js */\n"+e,(t._style=i).setAttribute("type","text/css"),document.getElementsByTagName("head")[0].appendChild(i)),i.appendChild(document.createTextNode(e))},acquireContext:function(t,e){"string"==typeof t?t=document.getElementById(t):t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas);var i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(function(t,e){var i=t.style,n=t.getAttribute("height"),a=t.getAttribute("width");if(t[g]={initial:{height:n,width:a,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",null===a||""===a){var o=l(t,"width");void 0!==o&&(t.width=o)}if(null===n||""===n)if(""===t.style.height)t.height=t.width/(e.options.aspectRatio||2);else{var r=l(t,"height");void 0!==o&&(t.height=r)}}(t,e),i):null},releaseContext:function(t){var i=t.canvas;if(i[g]){var n=i[g].initial;["height","width"].forEach(function(t){var e=n[t];f.isNullOrUndef(e)?i.removeAttribute(t):i.setAttribute(t,e)}),f.each(n.style||{},function(t,e){i.style[e]=t}),i.width=i.width,delete i[g]}},addEventListener:function(o,t,r){var e=o.canvas;if("resize"!==t){var i=r[g]||(r[g]={});x(e,t,(i.proxies||(i.proxies={}))[o.id+"_"+t]=function(t){var e,i,n,a;r((i=o,n=s[(e=t).type]||e.type,a=f.getRelativePosition(e,i),y(n,i,a.x,a.y,e)))})}else a(e,r,o)},removeEventListener:function(t,e,i){var n=t.canvas;if("resize"!==e){var a=((i[g]||{}).proxies||{})[t.id+"_"+e];a&&r(n,e,a)}else o(n)}},f.addEvent=x,f.removeEvent=r},{46:46}],49:[function(t,e,i){"use strict";var n=t(46),a=t(47),o=t(48),r=o._enabled?o:a;e.exports=n.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},r)},{46:46,47:47,48:48}],50:[function(t,e,i){"use strict";e.exports={},e.exports.filler=t(51),e.exports.legend=t(52),e.exports.title=t(53)},{51:51,52:52,53:53}],51:[function(t,e,i){"use strict";var u=t(26),h=t(41),d=t(46);u._set("global",{plugins:{filler:{propagate:!0}}});var f={dataset:function(t){var e=t.fill,i=t.chart,n=i.getDatasetMeta(e),a=n&&i.isDatasetVisible(e)&&n.dataset._children||[],o=a.length||0;return o?function(t,e){return e<o&&a[e]._view||null}:null},boundary:function(t){var e=t.boundary,i=e?e.x:null,n=e?e.y:null;return function(t){return{x:null===i?t.x:i,y:null===n?t.y:n}}}};function g(t,e,i){var n,a=t._model||{},o=a.fill;if(void 0===o&&(o=!!a.backgroundColor),!1===o||null===o)return!1;if(!0===o)return"origin";if(n=parseFloat(o,10),isFinite(n)&&Math.floor(n)===n)return"-"!==o[0]&&"+"!==o[0]||(n=e+n),!(n===e||n<0||i<=n)&&n;switch(o){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return o;default:return!1}}function p(t){var e,i=t.el._model||{},n=t.el._scale||{},a=t.fill,o=null;if(isFinite(a))return null;if("start"===a?o=void 0===i.scaleBottom?n.bottom:i.scaleBottom:"end"===a?o=void 0===i.scaleTop?n.top:i.scaleTop:void 0!==i.scaleZero?o=i.scaleZero:n.getBasePosition?o=n.getBasePosition():n.getBasePixel&&(o=n.getBasePixel()),null!=o){if(void 0!==o.x&&void 0!==o.y)return o;if("number"==typeof o&&isFinite(o))return{x:(e=n.isHorizontal())?o:null,y:e?null:o}}return null}function m(t,e,i){var n,a=t[e].fill,o=[e];if(!i)return a;for(;!1!==a&&-1===o.indexOf(a);){if(!isFinite(a))return a;if(!(n=t[a]))return!1;if(n.visible)return a;o.push(a),a=n.fill}return!1}function x(t){return t&&!t.skip}function y(t,e,i,n,a){var o;if(n&&a){for(t.moveTo(e[0].x,e[0].y),o=1;o<n;++o)d.canvas.lineTo(t,e[o-1],e[o]);for(t.lineTo(i[a-1].x,i[a-1].y),o=a-1;0<o;--o)d.canvas.lineTo(t,i[o],i[o-1],!0)}}e.exports={id:"filler",afterDatasetsUpdate:function(t,e){var i,n,a,o,r,s,l,u=(t.data.datasets||[]).length,d=e.propagate,c=[];for(n=0;n<u;++n)o=null,(a=(i=t.getDatasetMeta(n)).dataset)&&a._model&&a instanceof h.Line&&(o={visible:t.isDatasetVisible(n),fill:g(a,n,u),chart:t,el:a}),i.$filler=o,c.push(o);for(n=0;n<u;++n)(o=c[n])&&(o.fill=m(c,n,d),o.boundary=p(o),o.mapper=(l=void 0,s=(r=o).fill,!(l="dataset")===s?null:(isFinite(s)||(l="boundary"),f[l](r))))},beforeDatasetDraw:function(t,e){var i=e.meta.$filler;if(i){var n=t.ctx,a=i.el,o=a._view,r=a._children||[],s=i.mapper,l=o.backgroundColor||u.global.defaultColor;s&&l&&r.length&&(d.canvas.clipArea(n,t.chartArea),function(t,e,i,n,a,o){var r,s,l,u,d,c,h,f=e.length,g=n.spanGaps,p=[],m=[],v=0,b=0;for(t.beginPath(),r=0,s=f+!!o;r<s;++r)d=i(u=e[l=r%f]._view,l,n),c=x(u),h=x(d),c&&h?(v=p.push(u),b=m.push(d)):v&&b&&(g?(c&&p.push(u),h&&m.push(d)):(y(t,p,m,v,b),v=b=0,p=[],m=[]));y(t,p,m,v,b),t.closePath(),t.fillStyle=a,t.fill()}(n,r,s,o,l,a._loop),d.canvas.unclipArea(n))}}}},{26:26,41:41,46:46}],52:[function(t,e,i){"use strict";var _=t(26),n=t(27),D=t(46),a=t(31),o=D.noop;function P(t,e){return t.usePointStyle?e*Math.SQRT2:t.boxWidth}_._set("global",{legend:{display:!0,position:"top",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(t,e){var i=e.datasetIndex,n=this.chart,a=n.getDatasetMeta(i);a.hidden=null===a.hidden?!n.data.datasets[i].hidden:null,n.update()},onHover:null,labels:{boxWidth:40,padding:10,generateLabels:function(i){var t=i.data;return D.isArray(t.datasets)?t.datasets.map(function(t,e){return{text:t.label,fillStyle:D.isArray(t.backgroundColor)?t.backgroundColor[0]:t.backgroundColor,hidden:!i.isDatasetVisible(e),lineCap:t.borderCapStyle,lineDash:t.borderDash,lineDashOffset:t.borderDashOffset,lineJoin:t.borderJoinStyle,lineWidth:t.borderWidth,strokeStyle:t.borderColor,pointStyle:t.pointStyle,datasetIndex:e}},this):[]}}},legendCallback:function(t){var e=[];e.push('<ul class="'+t.id+'-legend">');for(var i=0;i<t.data.datasets.length;i++)e.push('<li><span style="background-color:'+t.data.datasets[i].backgroundColor+'"></span>'),t.data.datasets[i].label&&e.push(t.data.datasets[i].label),e.push("</li>");return e.push("</ul>"),e.join("")}});var r=n.extend({initialize:function(t){D.extend(this,t),this.legendHitBoxes=[],this.doughnutMode=!1},beforeUpdate:o,update:function(t,e,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=e,n.margins=i,n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeBuildLabels(),n.buildLabels(),n.afterBuildLabels(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:o,beforeSetDimensions:o,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:o,beforeBuildLabels:o,buildLabels:function(){var e=this,i=e.options.labels||{},t=D.callback(i.generateLabels,[e.chart],e)||[];i.filter&&(t=t.filter(function(t){return i.filter(t,e.chart.data)})),e.options.reverse&&t.reverse(),e.legendItems=t},afterBuildLabels:o,beforeFit:o,fit:function(){var n=this,t=n.options,a=t.labels,e=t.display,o=n.ctx,i=_.global,r=D.valueOrDefault,s=r(a.fontSize,i.defaultFontSize),l=r(a.fontStyle,i.defaultFontStyle),u=r(a.fontFamily,i.defaultFontFamily),d=D.fontString(s,l,u),c=n.legendHitBoxes=[],h=n.minSize,f=n.isHorizontal();if(h.height=f?(h.width=n.maxWidth,e?10:0):(h.width=e?10:0,n.maxHeight),e)if(o.font=d,f){var g=n.lineWidths=[0],p=n.legendItems.length?s+a.padding:0;o.textAlign="left",o.textBaseline="top",D.each(n.legendItems,function(t,e){var i=P(a,s)+s/2+o.measureText(t.text).width;g[g.length-1]+i+a.padding>=n.width&&(p+=s+a.padding,g[g.length]=n.left),c[e]={left:0,top:0,width:i,height:s},g[g.length-1]+=i+a.padding}),h.height+=p}else{var m=a.padding,v=n.columnWidths=[],b=a.padding,x=0,y=0,k=s+m;D.each(n.legendItems,function(t,e){var i=P(a,s)+s/2+o.measureText(t.text).width;y+k>h.height&&(b+=x+a.padding,v.push(x),y=x=0),x=Math.max(x,i),y+=k,c[e]={left:0,top:0,width:i,height:s}}),b+=x,v.push(x),h.width+=b}n.width=h.width,n.height=h.height},afterFit:o,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var c=this,h=c.options,f=h.labels,g=_.global,p=g.elements.line,m=c.width,v=c.lineWidths;if(h.display){var b,x=c.ctx,y=D.valueOrDefault,t=y(f.fontColor,g.defaultFontColor),k=y(f.fontSize,g.defaultFontSize),e=y(f.fontStyle,g.defaultFontStyle),i=y(f.fontFamily,g.defaultFontFamily),n=D.fontString(k,e,i);x.textAlign="left",x.textBaseline="middle",x.lineWidth=.5,x.strokeStyle=t,x.fillStyle=t,x.font=n;var M=P(f,k),w=c.legendHitBoxes,C=c.isHorizontal();b=C?{x:c.left+(m-v[0])/2,y:c.top+f.padding,line:0}:{x:c.left+f.padding,y:c.top+f.padding,line:0};var S=k+f.padding;D.each(c.legendItems,function(t,e){var i,n,a,o,r,s=x.measureText(t.text).width,l=M+k/2+s,u=b.x,d=b.y;C?m<=u+l&&(d=b.y+=S,b.line++,u=b.x=c.left+(m-v[b.line])/2):d+S>c.bottom&&(u=b.x=u+c.columnWidths[b.line]+f.padding,d=b.y=c.top+f.padding,b.line++),function(t,e,i){if(!(isNaN(M)||M<=0)){x.save(),x.fillStyle=y(i.fillStyle,g.defaultColor),x.lineCap=y(i.lineCap,p.borderCapStyle),x.lineDashOffset=y(i.lineDashOffset,p.borderDashOffset),x.lineJoin=y(i.lineJoin,p.borderJoinStyle),x.lineWidth=y(i.lineWidth,p.borderWidth),x.strokeStyle=y(i.strokeStyle,g.defaultColor);var n=0===y(i.lineWidth,p.borderWidth);if(x.setLineDash&&x.setLineDash(y(i.lineDash,p.borderDash)),h.labels&&h.labels.usePointStyle){var a=k*Math.SQRT2/2,o=a/Math.SQRT2,r=t+o,s=e+o;D.canvas.drawPoint(x,i.pointStyle,a,r,s)}else n||x.strokeRect(t,e,M,k),x.fillRect(t,e,M,k);x.restore()}}(u,d,t),w[e].left=u,w[e].top=d,i=t,n=s,o=M+(a=k/2)+u,r=d+a,x.fillText(i.text,o,r),i.hidden&&(x.beginPath(),x.lineWidth=2,x.moveTo(o,r),x.lineTo(o+n,r),x.stroke()),C?b.x+=l+f.padding:b.y+=S})}},handleEvent:function(t){var e=this,i=e.options,n="mouseup"===t.type?"click":t.type,a=!1;if("mousemove"===n){if(!i.onHover)return}else{if("click"!==n)return;if(!i.onClick)return}var o=t.x,r=t.y;if(o>=e.left&&o<=e.right&&r>=e.top&&r<=e.bottom)for(var s=e.legendHitBoxes,l=0;l<s.length;++l){var u=s[l];if(o>=u.left&&o<=u.left+u.width&&r>=u.top&&r<=u.top+u.height){if("click"===n){i.onClick.call(e,t.native,e.legendItems[l]),a=!0;break}if("mousemove"===n){i.onHover.call(e,t.native,e.legendItems[l]),a=!0;break}}}return a}});function s(t,e){var i=new r({ctx:t.ctx,options:e,chart:t});a.configure(t,i,e),a.addBox(t,i),t.legend=i}e.exports={id:"legend",_element:r,beforeInit:function(t){var e=t.options.legend;e&&s(t,e)},beforeUpdate:function(t){var e=t.options.legend,i=t.legend;e?(D.mergeIf(e,_.global.legend),i?(a.configure(t,i,e),i.options=e):s(t,e)):i&&(a.removeBox(t,i),delete t.legend)},afterEvent:function(t,e){var i=t.legend;i&&i.handleEvent(e)}}},{26:26,27:27,31:31,46:46}],53:[function(t,e,i){"use strict";var M=t(26),n=t(27),w=t(46),a=t(31),o=w.noop;M._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,lineHeight:1.2,padding:10,position:"top",text:"",weight:2e3}});var r=n.extend({initialize:function(t){w.extend(this,t),this.legendHitBoxes=[]},beforeUpdate:o,update:function(t,e,i){var n=this;return n.beforeUpdate(),n.maxWidth=t,n.maxHeight=e,n.margins=i,n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeBuildLabels(),n.buildLabels(),n.afterBuildLabels(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:o,beforeSetDimensions:o,setDimensions:function(){var t=this;t.isHorizontal()?(t.width=t.maxWidth,t.left=0,t.right=t.width):(t.height=t.maxHeight,t.top=0,t.bottom=t.height),t.paddingLeft=0,t.paddingTop=0,t.paddingRight=0,t.paddingBottom=0,t.minSize={width:0,height:0}},afterSetDimensions:o,beforeBuildLabels:o,buildLabels:o,afterBuildLabels:o,beforeFit:o,fit:function(){var t=this,e=w.valueOrDefault,i=t.options,n=i.display,a=e(i.fontSize,M.global.defaultFontSize),o=t.minSize,r=w.isArray(i.text)?i.text.length:1,s=w.options.toLineHeight(i.lineHeight,a),l=n?r*s+2*i.padding:0;t.isHorizontal()?(o.width=t.maxWidth,o.height=l):(o.width=l,o.height=t.maxHeight),t.width=o.width,t.height=o.height},afterFit:o,isHorizontal:function(){var t=this.options.position;return"top"===t||"bottom"===t},draw:function(){var t=this,e=t.ctx,i=w.valueOrDefault,n=t.options,a=M.global;if(n.display){var o,r,s,l=i(n.fontSize,a.defaultFontSize),u=i(n.fontStyle,a.defaultFontStyle),d=i(n.fontFamily,a.defaultFontFamily),c=w.fontString(l,u,d),h=w.options.toLineHeight(n.lineHeight,l),f=h/2+n.padding,g=0,p=t.top,m=t.left,v=t.bottom,b=t.right;e.fillStyle=i(n.fontColor,a.defaultFontColor),e.font=c,t.isHorizontal()?(r=m+(b-m)/2,s=p+f,o=b-m):(r="left"===n.position?m+f:b-f,s=p+(v-p)/2,o=v-p,g=Math.PI*("left"===n.position?-.5:.5)),e.save(),e.translate(r,s),e.rotate(g),e.textAlign="center",e.textBaseline="middle";var x=n.text;if(w.isArray(x))for(var y=0,k=0;k<x.length;++k)e.fillText(x[k],0,y,o),y+=h;else e.fillText(x,0,0,o);e.restore()}}});function s(t,e){var i=new r({ctx:t.ctx,options:e,chart:t});a.configure(t,i,e),a.addBox(t,i),t.titleBlock=i}e.exports={id:"title",_element:r,beforeInit:function(t){var e=t.options.title;e&&s(t,e)},beforeUpdate:function(t){var e=t.options.title,i=t.titleBlock;e?(w.mergeIf(e,M.global.title),i?(a.configure(t,i,e),i.options=e):s(t,e)):i&&(a.removeBox(t,i),delete t.titleBlock)}}},{26:26,27:27,31:31,46:46}],54:[function(t,e,i){"use strict";var n=t(33),a=t(34);e.exports=function(){var t=n.extend({getLabels:function(){var t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels},determineDataLimits:function(){var t,e=this,i=e.getLabels();e.minIndex=0,e.maxIndex=i.length-1,void 0!==e.options.ticks.min&&(t=i.indexOf(e.options.ticks.min),e.minIndex=-1!==t?t:e.minIndex),void 0!==e.options.ticks.max&&(t=i.indexOf(e.options.ticks.max),e.maxIndex=-1!==t?t:e.maxIndex),e.min=i[e.minIndex],e.max=i[e.maxIndex]},buildTicks:function(){var t=this,e=t.getLabels();t.ticks=0===t.minIndex&&t.maxIndex===e.length-1?e:e.slice(t.minIndex,t.maxIndex+1)},getLabelForIndex:function(t,e){var i=this,n=i.chart.data,a=i.isHorizontal();return n.yLabels&&!a?i.getRightValue(n.datasets[e].data[t]):i.ticks[t-i.minIndex]},getPixelForValue:function(t,e){var i,n=this,a=n.options.offset,o=Math.max(n.maxIndex+1-n.minIndex-(a?0:1),1);if(null!=t&&(i=n.isHorizontal()?t.x:t.y),void 0!==i||void 0!==t&&isNaN(e)){t=i||t;var r=n.getLabels().indexOf(t);e=-1!==r?r:e}if(n.isHorizontal()){var s=n.width/o,l=s*(e-n.minIndex);return a&&(l+=s/2),n.left+Math.round(l)}var u=n.height/o,d=u*(e-n.minIndex);return a&&(d+=u/2),n.top+Math.round(d)},getPixelForTick:function(t){return this.getPixelForValue(this.ticks[t],t+this.minIndex,null)},getValueForPixel:function(t){var e=this,i=e.options.offset,n=Math.max(e._ticks.length-(i?0:1),1),a=e.isHorizontal(),o=(a?e.width:e.height)/n;return t-=a?e.left:e.top,i&&(t-=o/2),(t<=0?0:Math.round(t/o))+e.minIndex},getBasePixel:function(){return this.bottom}});a.registerScaleType("category",t,{position:"bottom"})}},{33:33,34:34}],55:[function(t,e,i){"use strict";var n=t(26),c=t(46),a=t(34),o=t(35);e.exports=function(t){var e={position:"left",ticks:{callback:o.formatters.linear}},i=t.LinearScaleBase.extend({determineDataLimits:function(){var r=this,s=r.options,l=r.chart,t=l.data.datasets,e=r.isHorizontal();function u(t){return e?t.xAxisID===r.id:t.yAxisID===r.id}r.min=null,r.max=null;var n=s.stacked;if(void 0===n&&c.each(t,function(t,e){if(!n){var i=l.getDatasetMeta(e);l.isDatasetVisible(e)&&u(i)&&void 0!==i.stack&&(n=!0)}}),s.stacked||n){var d={};c.each(t,function(t,e){var n=l.getDatasetMeta(e),i=[n.type,void 0===s.stacked&&void 0===n.stack?e:"",n.stack].join(".");void 0===d[i]&&(d[i]={positiveValues:[],negativeValues:[]});var a=d[i].positiveValues,o=d[i].negativeValues;l.isDatasetVisible(e)&&u(n)&&c.each(t.data,function(t,e){var i=+r.getRightValue(t);isNaN(i)||n.data[e].hidden||(a[e]=a[e]||0,o[e]=o[e]||0,s.relativePoints?a[e]=100:i<0?o[e]+=i:a[e]+=i)})}),c.each(d,function(t){var e=t.positiveValues.concat(t.negativeValues),i=c.min(e),n=c.max(e);r.min=null===r.min?i:Math.min(r.min,i),r.max=null===r.max?n:Math.max(r.max,n)})}else c.each(t,function(t,e){var n=l.getDatasetMeta(e);l.isDatasetVisible(e)&&u(n)&&c.each(t.data,function(t,e){var i=+r.getRightValue(t);isNaN(i)||n.data[e].hidden||(null===r.min?r.min=i:i<r.min&&(r.min=i),null===r.max?r.max=i:i>r.max&&(r.max=i))})});r.min=isFinite(r.min)&&!isNaN(r.min)?r.min:0,r.max=isFinite(r.max)&&!isNaN(r.max)?r.max:1,this.handleTickRangeOptions()},getTickLimit:function(){var t,e=this.options.ticks;if(this.isHorizontal())t=Math.min(e.maxTicksLimit?e.maxTicksLimit:11,Math.ceil(this.width/50));else{var i=c.valueOrDefault(e.fontSize,n.global.defaultFontSize);t=Math.min(e.maxTicksLimit?e.maxTicksLimit:11,Math.ceil(this.height/(2*i)))}return t},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForValue:function(t){var e=this,i=e.start,n=+e.getRightValue(t),a=e.end-i;return e.isHorizontal()?e.left+e.width/a*(n-i):e.bottom-e.height/a*(n-i)},getValueForPixel:function(t){var e=this,i=e.isHorizontal(),n=i?e.width:e.height,a=(i?t-e.left:e.bottom-t)/n;return e.start+(e.end-e.start)*a},getPixelForTick:function(t){return this.getPixelForValue(this.ticksAsNumbers[t])}});a.registerScaleType("linear",i,e)}},{26:26,34:34,35:35,46:46}],56:[function(t,e,i){"use strict";var c=t(46),n=t(33);e.exports=function(t){var e=c.noop;t.LinearScaleBase=n.extend({getRightValue:function(t){return"string"==typeof t?+t:n.prototype.getRightValue.call(this,t)},handleTickRangeOptions:function(){var t=this,e=t.options.ticks;if(e.beginAtZero){var i=c.sign(t.min),n=c.sign(t.max);i<0&&n<0?t.max=0:0<i&&0<n&&(t.min=0)}var a=void 0!==e.min||void 0!==e.suggestedMin,o=void 0!==e.max||void 0!==e.suggestedMax;void 0!==e.min?t.min=e.min:void 0!==e.suggestedMin&&(null===t.min?t.min=e.suggestedMin:t.min=Math.min(t.min,e.suggestedMin)),void 0!==e.max?t.max=e.max:void 0!==e.suggestedMax&&(null===t.max?t.max=e.suggestedMax:t.max=Math.max(t.max,e.suggestedMax)),a!==o&&t.min>=t.max&&(a?t.max=t.min+1:t.min=t.max-1),t.min===t.max&&(t.max++,e.beginAtZero||t.min--)},getTickLimit:e,handleDirectionalChanges:e,buildTicks:function(){var t=this,e=t.options.ticks,i=t.getTickLimit(),n={maxTicks:i=Math.max(2,i),min:e.min,max:e.max,precision:e.precision,stepSize:c.valueOrDefault(e.fixedStepSize,e.stepSize)},a=t.ticks=function(t,e){var i,n,a,o=[];if(t.stepSize&&0<t.stepSize)a=t.stepSize;else{var r=c.niceNum(e.max-e.min,!1);a=c.niceNum(r/(t.maxTicks-1),!0),void 0!==(n=t.precision)&&(i=Math.pow(10,n),a=Math.ceil(a*i)/i)}var s=Math.floor(e.min/a)*a,l=Math.ceil(e.max/a)*a;c.isNullOrUndef(t.min)||c.isNullOrUndef(t.max)||!t.stepSize||c.almostWhole((t.max-t.min)/t.stepSize,a/1e3)&&(s=t.min,l=t.max);var u=(l-s)/a;u=c.almostEquals(u,Math.round(u),a/1e3)?Math.round(u):Math.ceil(u),a<(n=1)&&(n=Math.pow(10,1-Math.floor(c.log10(a))),s=Math.round(s*n)/n,l=Math.round(l*n)/n),o.push(void 0!==t.min?t.min:s);for(var d=1;d<u;++d)o.push(Math.round((s+d*a)*n)/n);return o.push(void 0!==t.max?t.max:l),o}(n,t);t.handleDirectionalChanges(),t.max=c.max(a),t.min=c.min(a),e.reverse?(a.reverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max)},convertTicksToLabels:function(){var t=this;t.ticksAsNumbers=t.ticks.slice(),t.zeroLineIndex=t.ticks.indexOf(0),n.prototype.convertTicksToLabels.call(t)}})}},{33:33,46:46}],57:[function(t,e,i){"use strict";var h=t(46),n=t(33),a=t(34),o=t(35);e.exports=function(c){var t={position:"left",ticks:{callback:o.formatters.logarithmic}},e=n.extend({determineDataLimits:function(){var r=this,i=r.options,s=r.chart,t=s.data.datasets,e=r.isHorizontal();function l(t){return e?t.xAxisID===r.id:t.yAxisID===r.id}r.min=null,r.max=null,r.minNotZero=null;var n=i.stacked;if(void 0===n&&h.each(t,function(t,e){if(!n){var i=s.getDatasetMeta(e);s.isDatasetVisible(e)&&l(i)&&void 0!==i.stack&&(n=!0)}}),i.stacked||n){var u={};h.each(t,function(t,e){var a=s.getDatasetMeta(e),o=[a.type,void 0===i.stacked&&void 0===a.stack?e:"",a.stack].join(".");s.isDatasetVisible(e)&&l(a)&&(void 0===u[o]&&(u[o]=[]),h.each(t.data,function(t,e){var i=u[o],n=+r.getRightValue(t);isNaN(n)||a.data[e].hidden||n<0||(i[e]=i[e]||0,i[e]+=n)}))}),h.each(u,function(t){if(0<t.length){var e=h.min(t),i=h.max(t);r.min=null===r.min?e:Math.min(r.min,e),r.max=null===r.max?i:Math.max(r.max,i)}})}else h.each(t,function(t,e){var n=s.getDatasetMeta(e);s.isDatasetVisible(e)&&l(n)&&h.each(t.data,function(t,e){var i=+r.getRightValue(t);isNaN(i)||n.data[e].hidden||i<0||(null===r.min?r.min=i:i<r.min&&(r.min=i),null===r.max?r.max=i:i>r.max&&(r.max=i),0!==i&&(null===r.minNotZero||i<r.minNotZero)&&(r.minNotZero=i))})});this.handleTickRangeOptions()},handleTickRangeOptions:function(){var t=this,e=t.options.ticks,i=h.valueOrDefault;t.min=i(e.min,t.min),t.max=i(e.max,t.max),t.min===t.max&&(0!==t.min&&null!==t.min?(t.min=Math.pow(10,Math.floor(h.log10(t.min))-1),t.max=Math.pow(10,Math.floor(h.log10(t.max))+1)):(t.min=1,t.max=10)),null===t.min&&(t.min=Math.pow(10,Math.floor(h.log10(t.max))-1)),null===t.max&&(t.max=0!==t.min?Math.pow(10,Math.floor(h.log10(t.min))+1):10),null===t.minNotZero&&(0<t.min?t.minNotZero=t.min:t.max<1?t.minNotZero=Math.pow(10,Math.floor(h.log10(t.max))):t.minNotZero=1)},buildTicks:function(){var t=this,e=t.options.ticks,i=!t.isHorizontal(),n={min:e.min,max:e.max},a=t.ticks=function(t,e){var i,n,a=[],o=h.valueOrDefault,r=o(t.min,Math.pow(10,Math.floor(h.log10(e.min)))),s=Math.floor(h.log10(e.max)),l=Math.ceil(e.max/Math.pow(10,s));0===r?(i=Math.floor(h.log10(e.minNotZero)),n=Math.floor(e.minNotZero/Math.pow(10,i)),a.push(r),r=n*Math.pow(10,i)):(i=Math.floor(h.log10(r)),n=Math.floor(r/Math.pow(10,i)));for(var u=i<0?Math.pow(10,Math.abs(i)):1;a.push(r),10==++n&&(n=1,u=0<=++i?1:u),r=Math.round(n*Math.pow(10,i)*u)/u,i<s||i===s&&n<l;);var d=o(t.max,r);return a.push(d),a}(n,t);t.max=h.max(a),t.min=h.min(a),e.reverse?(i=!i,t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max),i&&a.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),n.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},getPixelForTick:function(t){return this.getPixelForValue(this.tickValues[t])},_getFirstTickValue:function(t){var e=Math.floor(h.log10(t));return Math.floor(t/Math.pow(10,e))*Math.pow(10,e)},getPixelForValue:function(t){var e,i,n,a,o,r=this,s=r.options.ticks.reverse,l=h.log10,u=r._getFirstTickValue(r.minNotZero),d=0;return t=+r.getRightValue(t),o=s?(n=r.end,a=r.start,-1):(n=r.start,a=r.end,1),i=r.isHorizontal()?(e=r.width,s?r.right:r.left):(e=r.height,o*=-1,s?r.top:r.bottom),t!==n&&(0===n&&(e-=d=h.getValueOrDefault(r.options.ticks.fontSize,c.defaults.global.defaultFontSize),n=u),0!==t&&(d+=e/(l(a)-l(n))*(l(t)-l(n))),i+=o*d),i},getValueForPixel:function(t){var e,i,n,a,o=this,r=o.options.ticks.reverse,s=h.log10,l=o._getFirstTickValue(o.minNotZero);if(n=r?(i=o.end,o.start):(i=o.start,o.end),(a=o.isHorizontal()?(e=o.width,r?o.right-t:t-o.left):(e=o.height,r?t-o.top:o.bottom-t))!==i){if(0===i){var u=h.getValueOrDefault(o.options.ticks.fontSize,c.defaults.global.defaultFontSize);a-=u,e-=u,i=l}a*=s(n)-s(i),a/=e,a=Math.pow(10,s(i)+a)}return a}});a.registerScaleType("logarithmic",e,t)}},{33:33,34:34,35:35,46:46}],58:[function(t,e,i){"use strict";var n=t(26),k=t(46),a=t(34),o=t(35);e.exports=function(e){var v=n.global,t={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:o.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(t){return t}}};function b(t){var e=t.options;return e.angleLines.display||e.pointLabels.display?t.chart.data.labels.length:0}function x(t){var e=t.options.pointLabels,i=k.valueOrDefault(e.fontSize,v.defaultFontSize),n=k.valueOrDefault(e.fontStyle,v.defaultFontStyle),a=k.valueOrDefault(e.fontFamily,v.defaultFontFamily);return{size:i,style:n,family:a,font:k.fontString(i,n,a)}}function m(t,e,i,n,a){return t===n||t===a?{start:e-i/2,end:e+i/2}:t<n||a<t?{start:e-i-5,end:e}:{start:e,end:e+i+5}}function y(t,e,i,n){if(k.isArray(e))for(var a=i.y,o=1.5*n,r=0;r<e.length;++r)t.fillText(e[r],i.x,a),a+=o;else t.fillText(e,i.x,i.y)}function s(t){return k.isNumber(t)?t:0}var i=e.LinearScaleBase.extend({setDimensions:function(){var t=this,e=t.options,i=e.ticks;t.width=t.maxWidth,t.height=t.maxHeight,t.xCenter=Math.round(t.width/2),t.yCenter=Math.round(t.height/2);var n=k.min([t.height,t.width]),a=k.valueOrDefault(i.fontSize,v.defaultFontSize);t.drawingArea=e.display?n/2-(a/2+i.backdropPaddingY):n/2},determineDataLimits:function(){var a=this,i=a.chart,o=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;k.each(i.data.datasets,function(t,e){if(i.isDatasetVisible(e)){var n=i.getDatasetMeta(e);k.each(t.data,function(t,e){var i=+a.getRightValue(t);isNaN(i)||n.data[e].hidden||(o=Math.min(i,o),r=Math.max(i,r))})}}),a.min=o===Number.POSITIVE_INFINITY?0:o,a.max=r===Number.NEGATIVE_INFINITY?0:r,a.handleTickRangeOptions()},getTickLimit:function(){var t=this.options.ticks,e=k.valueOrDefault(t.fontSize,v.defaultFontSize);return Math.min(t.maxTicksLimit?t.maxTicksLimit:11,Math.ceil(this.drawingArea/(1.5*e)))},convertTicksToLabels:function(){var t=this;e.LinearScaleBase.prototype.convertTicksToLabels.call(t),t.pointLabels=t.chart.data.labels.map(t.options.pointLabels.callback,t)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},fit:function(){var t,e;this.options.pointLabels.display?function(t){var e,i,n,a=x(t),o=Math.min(t.height/2,t.width/2),r={r:t.width,l:0,t:t.height,b:0},s={};t.ctx.font=a.font,t._pointLabelSizes=[];var l,u,d,c=b(t);for(e=0;e<c;e++){n=t.getPointPosition(e,o),l=t.ctx,u=a.size,d=t.pointLabels[e]||"",i=k.isArray(d)?{w:k.longestText(l,l.font,d),h:d.length*u+1.5*(d.length-1)*u}:{w:l.measureText(d).width,h:u},t._pointLabelSizes[e]=i;var h=t.getIndexAngle(e),f=k.toDegrees(h)%360,g=m(f,n.x,i.w,0,180),p=m(f,n.y,i.h,90,270);g.start<r.l&&(r.l=g.start,s.l=h),g.end>r.r&&(r.r=g.end,s.r=h),p.start<r.t&&(r.t=p.start,s.t=h),p.end>r.b&&(r.b=p.end,s.b=h)}t.setReductions(o,r,s)}(this):(t=this,e=Math.min(t.height/2,t.width/2),t.drawingArea=Math.round(e),t.setCenterPoint(0,0,0,0))},setReductions:function(t,e,i){var n=e.l/Math.sin(i.l),a=Math.max(e.r-this.width,0)/Math.sin(i.r),o=-e.t/Math.cos(i.t),r=-Math.max(e.b-this.height,0)/Math.cos(i.b);n=s(n),a=s(a),o=s(o),r=s(r),this.drawingArea=Math.min(Math.round(t-(n+a)/2),Math.round(t-(o+r)/2)),this.setCenterPoint(n,a,o,r)},setCenterPoint:function(t,e,i,n){var a=this,o=a.width-e-a.drawingArea,r=t+a.drawingArea,s=i+a.drawingArea,l=a.height-n-a.drawingArea;a.xCenter=Math.round((r+o)/2+a.left),a.yCenter=Math.round((s+l)/2+a.top)},getIndexAngle:function(t){return t*(2*Math.PI/b(this))+(this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0)*Math.PI*2/360},getDistanceFromCenterForValue:function(t){var e=this;if(null===t)return 0;var i=e.drawingArea/(e.max-e.min);return e.options.ticks.reverse?(e.max-t)*i:(t-e.min)*i},getPointPosition:function(t,e){var i=this.getIndexAngle(t)-Math.PI/2;return{x:Math.round(Math.cos(i)*e)+this.xCenter,y:Math.round(Math.sin(i)*e)+this.yCenter}},getPointPositionForValue:function(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))},getBasePosition:function(){var t=this.min,e=this.max;return this.getPointPositionForValue(0,this.beginAtZero?0:t<0&&e<0?e:0<t&&0<e?t:0)},draw:function(){var o=this,t=o.options,r=t.gridLines,s=t.ticks,l=k.valueOrDefault;if(t.display){var u=o.ctx,d=this.getIndexAngle(0),c=l(s.fontSize,v.defaultFontSize),e=l(s.fontStyle,v.defaultFontStyle),i=l(s.fontFamily,v.defaultFontFamily),h=k.fontString(c,e,i);k.each(o.ticks,function(t,e){if(0<e||s.reverse){var i=o.getDistanceFromCenterForValue(o.ticksAsNumbers[e]);if(r.display&&0!==e&&function(t,e,i,n){var a=t.ctx;if(a.strokeStyle=k.valueAtIndexOrDefault(e.color,n-1),a.lineWidth=k.valueAtIndexOrDefault(e.lineWidth,n-1),t.options.gridLines.circular)a.beginPath(),a.arc(t.xCenter,t.yCenter,i,0,2*Math.PI),a.closePath(),a.stroke();else{var o=b(t);if(0===o)return;a.beginPath();var r=t.getPointPosition(0,i);a.moveTo(r.x,r.y);for(var s=1;s<o;s++)r=t.getPointPosition(s,i),a.lineTo(r.x,r.y);a.closePath(),a.stroke()}}(o,r,i,e),s.display){var n=l(s.fontColor,v.defaultFontColor);if(u.font=h,u.save(),u.translate(o.xCenter,o.yCenter),u.rotate(d),s.showLabelBackdrop){var a=u.measureText(t).width;u.fillStyle=s.backdropColor,u.fillRect(-a/2-s.backdropPaddingX,-i-c/2-s.backdropPaddingY,a+2*s.backdropPaddingX,c+2*s.backdropPaddingY)}u.textAlign="center",u.textBaseline="middle",u.fillStyle=n,u.fillText(t,0,-i),u.restore()}}}),(t.angleLines.display||t.pointLabels.display)&&function(t){var e=t.ctx,i=t.options,n=i.angleLines,a=i.pointLabels;e.lineWidth=n.lineWidth,e.strokeStyle=n.color;var o,r,s,l,u=t.getDistanceFromCenterForValue(i.ticks.reverse?t.min:t.max),d=x(t);e.textBaseline="top";for(var c=b(t)-1;0<=c;c--){if(n.display){var h=t.getPointPosition(c,u);e.beginPath(),e.moveTo(t.xCenter,t.yCenter),e.lineTo(h.x,h.y),e.stroke(),e.closePath()}if(a.display){var f=t.getPointPosition(c,u+5),g=k.valueAtIndexOrDefault(a.fontColor,c,v.defaultFontColor);e.font=d.font,e.fillStyle=g;var p=t.getIndexAngle(c),m=k.toDegrees(p);e.textAlign=0===(l=m)||180===l?"center":l<180?"left":"right",o=m,r=t._pointLabelSizes[c],s=f,90===o||270===o?s.y-=r.h/2:(270<o||o<90)&&(s.y-=r.h),y(e,t.pointLabels[c]||"",f,d.size)}}}(o)}}});a.registerScaleType("radialLinear",i,t)}},{26:26,34:34,35:35,46:46}],59:[function(t,e,i){"use strict";var x=t(1);x="function"==typeof x?x:window.moment;var r=t(26),m=t(46),n=t(33),a=t(34),p=Number.MIN_SAFE_INTEGER||-9007199254740991,v=Number.MAX_SAFE_INTEGER||9007199254740991,y={millisecond:{common:!0,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:!0,size:1e3,steps:[1,2,5,10,15,30]},minute:{common:!0,size:6e4,steps:[1,2,5,10,15,30]},hour:{common:!0,size:36e5,steps:[1,2,3,6,12]},day:{common:!0,size:864e5,steps:[1,2,5]},week:{common:!1,size:6048e5,steps:[1,2,3,4]},month:{common:!0,size:2628e6,steps:[1,2,3]},quarter:{common:!1,size:7884e6,steps:[1,2,3,4]},year:{common:!0,size:3154e7}},k=Object.keys(y);function b(t,e){return t-e}function M(t){var e,i,n,a={},o=[];for(e=0,i=t.length;e<i;++e)a[n=t[e]]||(a[n]=!0,o.push(n));return o}function w(t,e,i,n){var a=function(t,e,i){for(var n,a,o,r=0,s=t.length-1;0<=r&&r<=s;){if(a=t[(n=r+s>>1)-1]||null,o=t[n],!a)return{lo:null,hi:o};if(o[e]<i)r=n+1;else{if(!(a[e]>i))return{lo:a,hi:o};s=n-1}}return{lo:o,hi:null}}(t,e,i),o=a.lo?a.hi?a.lo:t[t.length-2]:t[0],r=a.lo?a.hi?a.hi:t[t.length-1]:t[1],s=r[e]-o[e],l=s?(i-o[e])/s:0,u=(r[n]-o[n])*l;return o[n]+u}function C(t,e){var i=e.parser,n=e.parser||e.format;return"function"==typeof i?i(t):"string"==typeof t&&"string"==typeof n?x(t,n):(t instanceof x||(t=x(t)),t.isValid()?t:"function"==typeof n?n(t):t)}function S(t,e){if(m.isNullOrUndef(t))return null;var i=e.options.time,n=C(e.getRightValue(t),i);return n.isValid()?(i.round&&n.startOf(i.round),n.valueOf()):null}function _(t){for(var e=k.indexOf(t)+1,i=k.length;e<i;++e)if(y[k[e]].common)return k[e]}function D(t,e,i,n){var a,o=n.time,r=o.unit||function(t,e,i,n){var a,o,r,s=k.length;for(a=k.indexOf(t);a<s-1;++a)if(r=(o=y[k[a]]).steps?o.steps[o.steps.length-1]:v,o.common&&Math.ceil((i-e)/(r*o.size))<=n)return k[a];return k[s-1]}(o.minUnit,t,e,i),s=_(r),l=m.valueOrDefault(o.stepSize,o.unitStepSize),u="week"===r&&o.isoWeekday,d=n.ticks.major.enabled,c=y[r],h=x(t),f=x(e),g=[];for(l||(l=function(t,e,i,n){var a,o,r,s=e-t,l=y[i],u=l.size,d=l.steps;if(!d)return Math.ceil(s/(n*u));for(a=0,o=d.length;a<o&&(r=d[a],!(Math.ceil(s/(u*r))<=n));++a);return r}(t,e,r,i)),u&&(h=h.isoWeekday(u),f=f.isoWeekday(u)),h=h.startOf(u?"day":r),(f=f.startOf(u?"day":r))<e&&f.add(1,r),a=x(h),d&&s&&!u&&!o.round&&(a.startOf(s),a.add(~~((h-a)/(c.size*l))*l,r));a<f;a.add(l,r))g.push(+a);return g.push(+a),g}e.exports=function(){var t=n.extend({initialize:function(){if(!x)throw new Error("Chart.js - Moment.js could not be found! You must include it before Chart.js to use the time scale. Download at https://momentjs.com");this.mergeTicksOptions(),n.prototype.initialize.call(this)},update:function(){var t=this.options;return t.time&&t.time.format&&console.warn("options.time.format is deprecated and replaced by options.time.parser."),n.prototype.update.apply(this,arguments)},getRightValue:function(t){return t&&void 0!==t.t&&(t=t.t),n.prototype.getRightValue.call(this,t)},determineDataLimits:function(){var t,e,i,n,a,o,r=this,s=r.chart,l=r.options.time,u=l.unit||"day",d=v,c=p,h=[],f=[],g=[];for(t=0,i=s.data.labels.length;t<i;++t)g.push(S(s.data.labels[t],r));for(t=0,i=(s.data.datasets||[]).length;t<i;++t)if(s.isDatasetVisible(t))if(a=s.data.datasets[t].data,m.isObject(a[0]))for(f[t]=[],e=0,n=a.length;e<n;++e)o=S(a[e],r),h.push(o),f[t][e]=o;else h.push.apply(h,g),f[t]=g.slice(0);else f[t]=[];g.length&&(g=M(g).sort(b),d=Math.min(d,g[0]),c=Math.max(c,g[g.length-1])),h.length&&(h=M(h).sort(b),d=Math.min(d,h[0]),c=Math.max(c,h[h.length-1])),d=S(l.min,r)||d,c=S(l.max,r)||c,d=d===v?+x().startOf(u):d,c=c===p?+x().endOf(u)+1:c,r.min=Math.min(d,c),r.max=Math.max(d+1,c),r._horizontal=r.isHorizontal(),r._table=[],r._timestamps={data:h,datasets:f,labels:g}},buildTicks:function(){var t,e,i,n,a,o,r,s,l,u,d,c,h=this,f=h.min,g=h.max,p=h.options,m=p.time,v=[],b=[];switch(p.ticks.source){case"data":v=h._timestamps.data;break;case"labels":v=h._timestamps.labels;break;case"auto":default:v=D(f,g,h.getLabelCapacity(f),p)}for("ticks"===p.bounds&&v.length&&(f=v[0],g=v[v.length-1]),f=S(m.min,h)||f,g=S(m.max,h)||g,t=0,e=v.length;t<e;++t)f<=(i=v[t])&&i<=g&&b.push(i);return h.min=f,h.max=g,h._unit=m.unit||function(t,e,i,n){var a,o,r=x.duration(x(n).diff(x(i)));for(a=k.length-1;a>=k.indexOf(e);a--)if(o=k[a],y[o].common&&r.as(o)>=t.length)return o;return k[e?k.indexOf(e):0]}(b,m.minUnit,h.min,h.max),h._majorUnit=_(h._unit),h._table=function(t,e,i,n){if("linear"===n||!t.length)return[{time:e,pos:0},{time:i,pos:1}];var a,o,r,s,l,u=[],d=[e];for(a=0,o=t.length;a<o;++a)e<(s=t[a])&&s<i&&d.push(s);for(d.push(i),a=0,o=d.length;a<o;++a)l=d[a+1],r=d[a-1],s=d[a],void 0!==r&&void 0!==l&&Math.round((l+r)/2)===s||u.push({time:s,pos:a/(o-1)});return u}(h._timestamps.data,f,g,p.distribution),h._offsets=(n=h._table,a=b,o=f,r=g,c=d=0,(s=p).offset&&a.length&&(s.time.min||(l=1<a.length?a[1]:r,u=a[0],d=(w(n,"time",l,"pos")-w(n,"time",u,"pos"))/2),s.time.max||(l=a[a.length-1],u=1<a.length?a[a.length-2]:o,c=(w(n,"time",l,"pos")-w(n,"time",u,"pos"))/2)),{left:d,right:c}),h._labelFormat=function(t,e){var i,n,a,o=t.length;for(i=0;i<o;i++){if(0!==(n=C(t[i],e)).millisecond())return"MMM D, YYYY h:mm:ss.SSS a";0===n.second()&&0===n.minute()&&0===n.hour()||(a=!0)}return a?"MMM D, YYYY h:mm:ss a":"MMM D, YYYY"}(h._timestamps.data,m),function(t,e){var i,n,a,o,r=[];for(i=0,n=t.length;i<n;++i)a=t[i],o=!!e&&a===+x(a).startOf(e),r.push({value:a,major:o});return r}(b,h._majorUnit)},getLabelForIndex:function(t,e){var i=this.chart.data,n=this.options.time,a=i.labels&&t<i.labels.length?i.labels[t]:"",o=i.datasets[e].data[t];return m.isObject(o)&&(a=this.getRightValue(o)),n.tooltipFormat?C(a,n).format(n.tooltipFormat):"string"==typeof a?a:C(a,n).format(this._labelFormat)},tickFormatFunction:function(t,e,i,n){var a=this.options,o=t.valueOf(),r=a.time.displayFormats,s=r[this._unit],l=this._majorUnit,u=r[l],d=t.clone().startOf(l).valueOf(),c=a.ticks.major,h=c.enabled&&l&&u&&o===d,f=t.format(n||(h?u:s)),g=h?c:a.ticks.minor,p=m.valueOrDefault(g.callback,g.userCallback);return p?p(f,e,i):f},convertTicksToLabels:function(t){var e,i,n=[];for(e=0,i=t.length;e<i;++e)n.push(this.tickFormatFunction(x(t[e].value),e,t));return n},getPixelForOffset:function(t){var e=this,i=e._horizontal?e.width:e.height,n=e._horizontal?e.left:e.top,a=w(e._table,"time",t,"pos");return n+i*(e._offsets.left+a)/(e._offsets.left+1+e._offsets.right)},getPixelForValue:function(t,e,i){var n=null;if(void 0!==e&&void 0!==i&&(n=this._timestamps.datasets[i][e]),null===n&&(n=S(t,this)),null!==n)return this.getPixelForOffset(n)},getPixelForTick:function(t){var e=this.getTicks();return 0<=t&&t<e.length?this.getPixelForOffset(e[t].value):null},getValueForPixel:function(t){var e=this,i=e._horizontal?e.width:e.height,n=e._horizontal?e.left:e.top,a=(i?(t-n)/i:0)*(e._offsets.left+1+e._offsets.left)-e._offsets.right,o=w(e._table,"pos",a,"time");return x(o)},getLabelWidth:function(t){var e=this.options.ticks,i=this.ctx.measureText(t).width,n=m.toRadians(e.maxRotation),a=Math.cos(n),o=Math.sin(n);return i*a+m.valueOrDefault(e.fontSize,r.global.defaultFontSize)*o},getLabelCapacity:function(t){var e=this.options.time.displayFormats.millisecond,i=this.tickFormatFunction(x(t),0,[],e),n=this.getLabelWidth(i),a=this.isHorizontal()?this.width:this.height,o=Math.floor(a/n);return 0<o?o:1}});a.registerScaleType("time",t,{position:"bottom",distribution:"linear",bounds:"data",time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}})}},{1:1,26:26,33:33,34:34,46:46}]},{},[7])(7)});
if (!Element.prototype.matches) {
  Element.prototype.matches = Element.prototype.msMatchesSelector ||  Element.prototype.webkitMatchesSelector;
}

if (!Element.prototype.closest) {
  Element.prototype.closest = function(s) {
      var el = this;
      if (!document.documentElement.contains(el)) return null;
      do {
          if (el.matches(s)) return el;
          el = el.parentElement;
      } while (el !== null);
      return null;
  };
}

!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.dragula=e()}}(function(){return function e(n,t,r){function o(u,c){if(!t[u]){if(!n[u]){var a="function"==typeof require&&require;if(!c&&a)return a(u,!0);if(i)return i(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var l=t[u]={exports:{}};n[u][0].call(l.exports,function(e){var t=n[u][1][e];return o(t?t:e)},l,l.exports,e,n,t,r)}return t[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,n,t){"use strict";function r(e){var n=u[e];return n?n.lastIndex=0:u[e]=n=new RegExp(c+e+a,"g"),n}function o(e,n){var t=e.className;t.length?r(n).test(t)||(e.className+=" "+n):e.className=n}function i(e,n){e.className=e.className.replace(r(n)," ").trim()}var u={},c="(?:^|\\s)",a="(?:\\s|$)";n.exports={add:o,rm:i}},{}],2:[function(e,n,t){(function(t){"use strict";function r(e,n){function t(e){return-1!==le.containers.indexOf(e)||fe.isContainer(e)}function r(e){var n=e?"remove":"add";o(S,n,"mousedown",O),o(S,n,"mouseup",L)}function c(e){var n=e?"remove":"add";o(S,n,"mousemove",N)}function m(e){var n=e?"remove":"add";w[n](S,"selectstart",C),w[n](S,"click",C)}function h(){r(!0),L({})}function C(e){ce&&e.preventDefault()}function O(e){ne=e.clientX,te=e.clientY;var n=1!==i(e)||e.metaKey||e.ctrlKey;if(!n){var t=e.target,r=T(t);r&&(ce=r,c(),"mousedown"===e.type&&(p(t)?t.focus():e.preventDefault()))}}function N(e){if(ce){if(0===i(e))return void L({});if(void 0===e.clientX||e.clientX!==ne||void 0===e.clientY||e.clientY!==te){if(fe.ignoreInputTextSelection){var n=y("clientX",e),t=y("clientY",e),r=x.elementFromPoint(n,t);if(p(r))return}var o=ce;c(!0),m(),D(),B(o);var a=u(W);Z=y("pageX",e)-a.left,ee=y("pageY",e)-a.top,E.add(ie||W,"gu-transit"),K(),U(e)}}}function T(e){if(!(le.dragging&&J||t(e))){for(var n=e;v(e)&&t(v(e))===!1;){if(fe.invalid(e,n))return;if(e=v(e),!e)return}var r=v(e);if(r&&!fe.invalid(e,n)){var o=fe.moves(e,r,n,g(e));if(o)return{item:e,source:r}}}}function X(e){return!!T(e)}function Y(e){var n=T(e);n&&B(n)}function B(e){$(e.item,e.source)&&(ie=e.item.cloneNode(!0),le.emit("cloned",ie,e.item,"copy")),Q=e.source,W=e.item,re=oe=g(e.item),le.dragging=!0,le.emit("drag",W,Q)}function P(){return!1}function D(){if(le.dragging){var e=ie||W;M(e,v(e))}}function I(){ce=!1,c(!0),m(!0)}function L(e){if(I(),le.dragging){var n=ie||W,t=y("clientX",e),r=y("clientY",e),o=a(J,t,r),i=q(o,t,r);i&&(ie&&fe.copySortSource||!ie||i!==Q)?M(n,i):fe.removeOnSpill?R():A()}}function M(e,n){var t=v(e);ie&&fe.copySortSource&&n===Q&&t.removeChild(W),k(n)?le.emit("cancel",e,Q,Q):le.emit("drop",e,n,Q,oe),j()}function R(){if(le.dragging){var e=ie||W,n=v(e);n&&n.removeChild(e),le.emit(ie?"cancel":"remove",e,n,Q),j()}}function A(e){if(le.dragging){var n=arguments.length>0?e:fe.revertOnSpill,t=ie||W,r=v(t),o=k(r);o===!1&&n&&(ie?r&&r.removeChild(ie):Q.insertBefore(t,re)),o||n?le.emit("cancel",t,Q,Q):le.emit("drop",t,r,Q,oe),j()}}function j(){var e=ie||W;I(),z(),e&&E.rm(e,"gu-transit"),ue&&clearTimeout(ue),le.dragging=!1,ae&&le.emit("out",e,ae,Q),le.emit("dragend",e),Q=W=ie=re=oe=ue=ae=null}function k(e,n){var t;return t=void 0!==n?n:J?oe:g(ie||W),e===Q&&t===re}function q(e,n,r){function o(){var o=t(i);if(o===!1)return!1;var u=H(i,e),c=V(i,u,n,r),a=k(i,c);return a?!0:fe.accepts(W,i,Q,c)}for(var i=e;i&&!o();)i=v(i);return i}function U(e){function n(e){le.emit(e,f,ae,Q)}function t(){s&&n("over")}function r(){ae&&n("out")}if(J){e.preventDefault();var o=y("clientX",e),i=y("clientY",e),u=o-Z,c=i-ee;J.style.left=u+"px",J.style.top=c+"px";var f=ie||W,l=a(J,o,i),d=q(l,o,i),s=null!==d&&d!==ae;(s||null===d)&&(r(),ae=d,t());var p=v(f);if(d===Q&&ie&&!fe.copySortSource)return void(p&&p.removeChild(f));var m,h=H(d,l);if(null!==h)m=V(d,h,o,i);else{if(fe.revertOnSpill!==!0||ie)return void(ie&&p&&p.removeChild(f));m=re,d=Q}(null===m&&s||m!==f&&m!==g(f))&&(oe=m,d.insertBefore(f,m),le.emit("shadow",f,d,Q))}}function _(e){E.rm(e,"gu-hide")}function F(e){le.dragging&&E.add(e,"gu-hide")}function K(){if(!J){var e=W.getBoundingClientRect();J=W.cloneNode(!0),J.style.width=d(e)+"px",J.style.height=s(e)+"px",E.rm(J,"gu-transit"),E.add(J,"gu-mirror"),fe.mirrorContainer.appendChild(J),o(S,"add","mousemove",U),E.add(fe.mirrorContainer,"gu-unselectable"),le.emit("cloned",J,W,"mirror")}}function z(){J&&(E.rm(fe.mirrorContainer,"gu-unselectable"),o(S,"remove","mousemove",U),v(J).removeChild(J),J=null)}function H(e,n){for(var t=n;t!==e&&v(t)!==e;)t=v(t);return t===S?null:t}function V(e,n,t,r){function o(){var n,o,i,u=e.children.length;for(n=0;u>n;n++){if(o=e.children[n],i=o.getBoundingClientRect(),c&&i.left+i.width/2>t)return o;if(!c&&i.top+i.height/2>r)return o}return null}function i(){var e=n.getBoundingClientRect();return u(c?t>e.left+d(e)/2:r>e.top+s(e)/2)}function u(e){return e?g(n):n}var c="horizontal"===fe.direction,a=n!==e?i():o();return a}function $(e,n){return"boolean"==typeof fe.copy?fe.copy:fe.copy(e,n)}var G=arguments.length;1===G&&Array.isArray(e)===!1&&(n=e,e=[]);var J,Q,W,Z,ee,ne,te,re,oe,ie,ue,ce,ae=null,fe=n||{};void 0===fe.moves&&(fe.moves=l),void 0===fe.accepts&&(fe.accepts=l),void 0===fe.invalid&&(fe.invalid=P),void 0===fe.containers&&(fe.containers=e||[]),void 0===fe.isContainer&&(fe.isContainer=f),void 0===fe.copy&&(fe.copy=!1),void 0===fe.copySortSource&&(fe.copySortSource=!1),void 0===fe.revertOnSpill&&(fe.revertOnSpill=!1),void 0===fe.removeOnSpill&&(fe.removeOnSpill=!1),void 0===fe.direction&&(fe.direction="vertical"),void 0===fe.ignoreInputTextSelection&&(fe.ignoreInputTextSelection=!0),void 0===fe.mirrorContainer&&(fe.mirrorContainer=x.body);var le=b({containers:fe.containers,start:Y,end:D,cancel:A,remove:R,destroy:h,canMove:X,dragging:!1});return fe.removeOnSpill===!0&&le.on("over",_).on("out",F),r(),le}function o(e,n,r,o){var i={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"},u={mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"},c={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};t.navigator.pointerEnabled?w[n](e,u[r],o):t.navigator.msPointerEnabled?w[n](e,c[r],o):(w[n](e,i[r],o),w[n](e,r,o))}function i(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;var n=e.button;return void 0!==n?1&n?1:2&n?3:4&n?2:0:void 0}function u(e){var n=e.getBoundingClientRect();return{left:n.left+c("scrollLeft","pageXOffset"),top:n.top+c("scrollTop","pageYOffset")}}function c(e,n){return"undefined"!=typeof t[n]?t[n]:S.clientHeight?S[e]:x.body[e]}function a(e,n,t){var r,o=e||{},i=o.className;return o.className+=" gu-hide",r=x.elementFromPoint(n,t),o.className=i,r}function f(){return!1}function l(){return!0}function d(e){return e.width||e.right-e.left}function s(e){return e.height||e.bottom-e.top}function v(e){return e.parentNode===x?null:e.parentNode}function p(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||m(e)}function m(e){return e?"false"===e.contentEditable?!1:"true"===e.contentEditable?!0:m(v(e)):!1}function g(e){function n(){var n=e;do n=n.nextSibling;while(n&&1!==n.nodeType);return n}return e.nextElementSibling||n()}function h(e){return e.targetTouches&&e.targetTouches.length?e.targetTouches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e}function y(e,n){var t=h(n),r={pageX:"clientX",pageY:"clientY"};return e in r&&!(e in t)&&r[e]in t&&(e=r[e]),t[e]}var b=e("contra/emitter"),w=e("crossvent"),E=e("./classes"),x=document,S=x.documentElement;n.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./classes":1,"contra/emitter":5,crossvent:6}],3:[function(e,n,t){n.exports=function(e,n){return Array.prototype.slice.call(e,n)}},{}],4:[function(e,n,t){"use strict";var r=e("ticky");n.exports=function(e,n,t){e&&r(function(){e.apply(t||null,n||[])})}},{ticky:9}],5:[function(e,n,t){"use strict";var r=e("atoa"),o=e("./debounce");n.exports=function(e,n){var t=n||{},i={};return void 0===e&&(e={}),e.on=function(n,t){return i[n]?i[n].push(t):i[n]=[t],e},e.once=function(n,t){return t._once=!0,e.on(n,t),e},e.off=function(n,t){var r=arguments.length;if(1===r)delete i[n];else if(0===r)i={};else{var o=i[n];if(!o)return e;o.splice(o.indexOf(t),1)}return e},e.emit=function(){var n=r(arguments);return e.emitterSnapshot(n.shift()).apply(this,n)},e.emitterSnapshot=function(n){var u=(i[n]||[]).slice(0);return function(){var i=r(arguments),c=this||e;if("error"===n&&t["throws"]!==!1&&!u.length)throw 1===i.length?i[0]:i;return u.forEach(function(r){t.async?o(r,i,c):r.apply(c,i),r._once&&e.off(n,r)}),e}},e}},{"./debounce":4,atoa:3}],6:[function(e,n,t){(function(t){"use strict";function r(e,n,t,r){return e.addEventListener(n,t,r)}function o(e,n,t){return e.attachEvent("on"+n,f(e,n,t))}function i(e,n,t,r){return e.removeEventListener(n,t,r)}function u(e,n,t){var r=l(e,n,t);return r?e.detachEvent("on"+n,r):void 0}function c(e,n,t){function r(){var e;return p.createEvent?(e=p.createEvent("Event"),e.initEvent(n,!0,!0)):p.createEventObject&&(e=p.createEventObject()),e}function o(){return new s(n,{detail:t})}var i=-1===v.indexOf(n)?o():r();e.dispatchEvent?e.dispatchEvent(i):e.fireEvent("on"+n,i)}function a(e,n,r){return function(n){var o=n||t.event;o.target=o.target||o.srcElement,o.preventDefault=o.preventDefault||function(){o.returnValue=!1},o.stopPropagation=o.stopPropagation||function(){o.cancelBubble=!0},o.which=o.which||o.keyCode,r.call(e,o)}}function f(e,n,t){var r=l(e,n,t)||a(e,n,t);return h.push({wrapper:r,element:e,type:n,fn:t}),r}function l(e,n,t){var r=d(e,n,t);if(r){var o=h[r].wrapper;return h.splice(r,1),o}}function d(e,n,t){var r,o;for(r=0;r<h.length;r++)if(o=h[r],o.element===e&&o.type===n&&o.fn===t)return r}var s=e("custom-event"),v=e("./eventmap"),p=t.document,m=r,g=i,h=[];t.addEventListener||(m=o,g=u),n.exports={add:m,remove:g,fabricate:c}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./eventmap":7,"custom-event":8}],7:[function(e,n,t){(function(e){"use strict";var t=[],r="",o=/^on/;for(r in e)o.test(r)&&t.push(r.slice(2));n.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,n,t){(function(e){function t(){try{var e=new r("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(n){}return!1}var r=e.CustomEvent;n.exports=t()?r:"function"==typeof document.createEvent?function(e,n){var t=document.createEvent("CustomEvent");return n?t.initCustomEvent(e,n.bubbles,n.cancelable,n.detail):t.initCustomEvent(e,!1,!1,void 0),t}:function(e,n){var t=document.createEventObject();return t.type=e,n?(t.bubbles=Boolean(n.bubbles),t.cancelable=Boolean(n.cancelable),t.detail=n.detail):(t.bubbles=!1,t.cancelable=!1,t.detail=void 0),t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,n,t){var r,o="function"==typeof setImmediate;r=o?function(e){setImmediate(e)}:function(e){setTimeout(e,0)},n.exports=r},{}]},{},[2])(2)});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ES6Promise=e()}(this,function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}function n(t){B=t}function r(t){G=t}function o(){return function(){return process.nextTick(a)}}function i(){return"undefined"!=typeof z?function(){z(a)}:c()}function s(){var t=0,e=new J(a),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function u(){var t=new MessageChannel;return t.port1.onmessage=a,function(){return t.port2.postMessage(0)}}function c(){var t=setTimeout;return function(){return t(a,1)}}function a(){for(var t=0;t<W;t+=2){var e=V[t],n=V[t+1];e(n),V[t]=void 0,V[t+1]=void 0}W=0}function f(){try{var t=Function("return this")().require("vertx");return z=t.runOnLoop||t.runOnContext,i()}catch(e){return c()}}function l(t,e){var n=this,r=new this.constructor(p);void 0===r[Z]&&O(r);var o=n._state;if(o){var i=arguments[o-1];G(function(){return P(o,r,i,n._result)})}else E(n,r,t,e);return r}function h(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(p);return g(n,t),n}function p(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new TypeError("A promises callback cannot return that same promise.")}function _(t){try{return t.then}catch(e){return nt.error=e,nt}}function y(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function m(t,e,n){G(function(t){var r=!1,o=y(n,e,function(n){r||(r=!0,e!==n?g(t,n):S(t,n))},function(e){r||(r=!0,j(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,j(t,o))},t)}function b(t,e){e._state===tt?S(t,e._result):e._state===et?j(t,e._result):E(e,void 0,function(e){return g(t,e)},function(e){return j(t,e)})}function w(t,n,r){n.constructor===t.constructor&&r===l&&n.constructor.resolve===h?b(t,n):r===nt?(j(t,nt.error),nt.error=null):void 0===r?S(t,n):e(r)?m(t,n,r):S(t,n)}function g(e,n){e===n?j(e,v()):t(n)?w(e,n,_(n)):S(e,n)}function A(t){t._onerror&&t._onerror(t._result),T(t)}function S(t,e){t._state===$&&(t._result=e,t._state=tt,0!==t._subscribers.length&&G(T,t))}function j(t,e){t._state===$&&(t._state=et,t._result=e,G(A,t))}function E(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+tt]=n,o[i+et]=r,0===i&&t._state&&G(T,t)}function T(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?P(n,r,o,i):o(i);t._subscribers.length=0}}function M(t,e){try{return t(e)}catch(n){return nt.error=n,nt}}function P(t,n,r,o){var i=e(r),s=void 0,u=void 0,c=void 0,a=void 0;if(i){if(s=M(r,o),s===nt?(a=!0,u=s.error,s.error=null):c=!0,n===s)return void j(n,d())}else s=o,c=!0;n._state!==$||(i&&c?g(n,s):a?j(n,u):t===tt?S(n,s):t===et&&j(n,s))}function x(t,e){try{e(function(e){g(t,e)},function(e){j(t,e)})}catch(n){j(t,n)}}function C(){return rt++}function O(t){t[Z]=rt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function k(){return new Error("Array Methods must be provided an Array")}function F(t){return new ot(this,t).promise}function Y(t){var e=this;return new e(U(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function q(t){var e=this,n=new e(p);return j(n,t),n}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function K(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function L(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(e){}if("[object Promise]"===r&&!n.cast)return}t.Promise=it}var N=void 0;N=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var U=N,W=0,z=void 0,B=void 0,G=function(t,e){V[W]=t,V[W+1]=e,W+=2,2===W&&(B?B(a):X())},H="undefined"!=typeof window?window:void 0,I=H||{},J=I.MutationObserver||I.WebKitMutationObserver,Q="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),R="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,V=new Array(1e3),X=void 0;X=Q?o():J?s():R?u():void 0===H&&"function"==typeof require?f():c();var Z=Math.random().toString(36).substring(2),$=void 0,tt=1,et=2,nt={error:null},rt=0,ot=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(p),this.promise[Z]||O(this.promise),U(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&S(this.promise,this._result))):j(this.promise,k())}return t.prototype._enumerate=function(t){for(var e=0;this._state===$&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===h){var o=_(t);if(o===l&&t._state!==$)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===it){var i=new n(p);w(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===$&&(this._remaining--,t===et?j(r,n):this._result[e]=n),0===this._remaining&&S(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){return n._settledAt(tt,e,t)},function(t){return n._settledAt(et,e,t)})},t}(),it=function(){function t(e){this[Z]=C(),this._result=this._state=void 0,this._subscribers=[],p!==e&&("function"!=typeof e&&D(),this instanceof t?x(this,e):K())}return t.prototype["catch"]=function(t){return this.then(null,t)},t.prototype["finally"]=function(t){var n=this,r=n.constructor;return e(t)?n.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})}):n.then(t,t)},t}();return it.prototype.then=l,it.all=F,it.race=Y,it.resolve=h,it.reject=q,it._setScheduler=n,it._setAsap=r,it._asap=G,it.polyfill=L,it.Promise=it,it.polyfill(),it});

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ES6Promise=e()}(this,function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}function n(t){B=t}function r(t){G=t}function o(){return function(){return process.nextTick(a)}}function i(){return"undefined"!=typeof z?function(){z(a)}:c()}function s(){var t=0,e=new J(a),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function u(){var t=new MessageChannel;return t.port1.onmessage=a,function(){return t.port2.postMessage(0)}}function c(){var t=setTimeout;return function(){return t(a,1)}}function a(){for(var t=0;t<W;t+=2){var e=V[t],n=V[t+1];e(n),V[t]=void 0,V[t+1]=void 0}W=0}function f(){try{var t=Function("return this")().require("vertx");return z=t.runOnLoop||t.runOnContext,i()}catch(e){return c()}}function l(t,e){var n=this,r=new this.constructor(p);void 0===r[Z]&&O(r);var o=n._state;if(o){var i=arguments[o-1];G(function(){return P(o,r,i,n._result)})}else E(n,r,t,e);return r}function h(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(p);return g(n,t),n}function p(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new TypeError("A promises callback cannot return that same promise.")}function _(t){try{return t.then}catch(e){return nt.error=e,nt}}function y(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function m(t,e,n){G(function(t){var r=!1,o=y(n,e,function(n){r||(r=!0,e!==n?g(t,n):S(t,n))},function(e){r||(r=!0,j(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,j(t,o))},t)}function b(t,e){e._state===tt?S(t,e._result):e._state===et?j(t,e._result):E(e,void 0,function(e){return g(t,e)},function(e){return j(t,e)})}function w(t,n,r){n.constructor===t.constructor&&r===l&&n.constructor.resolve===h?b(t,n):r===nt?(j(t,nt.error),nt.error=null):void 0===r?S(t,n):e(r)?m(t,n,r):S(t,n)}function g(e,n){e===n?j(e,v()):t(n)?w(e,n,_(n)):S(e,n)}function A(t){t._onerror&&t._onerror(t._result),T(t)}function S(t,e){t._state===$&&(t._result=e,t._state=tt,0!==t._subscribers.length&&G(T,t))}function j(t,e){t._state===$&&(t._state=et,t._result=e,G(A,t))}function E(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+tt]=n,o[i+et]=r,0===i&&t._state&&G(T,t)}function T(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?P(n,r,o,i):o(i);t._subscribers.length=0}}function M(t,e){try{return t(e)}catch(n){return nt.error=n,nt}}function P(t,n,r,o){var i=e(r),s=void 0,u=void 0,c=void 0,a=void 0;if(i){if(s=M(r,o),s===nt?(a=!0,u=s.error,s.error=null):c=!0,n===s)return void j(n,d())}else s=o,c=!0;n._state!==$||(i&&c?g(n,s):a?j(n,u):t===tt?S(n,s):t===et&&j(n,s))}function x(t,e){try{e(function(e){g(t,e)},function(e){j(t,e)})}catch(n){j(t,n)}}function C(){return rt++}function O(t){t[Z]=rt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function k(){return new Error("Array Methods must be provided an Array")}function F(t){return new ot(this,t).promise}function Y(t){var e=this;return new e(U(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function q(t){var e=this,n=new e(p);return j(n,t),n}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function K(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function L(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(e){}if("[object Promise]"===r&&!n.cast)return}t.Promise=it}var N=void 0;N=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var U=N,W=0,z=void 0,B=void 0,G=function(t,e){V[W]=t,V[W+1]=e,W+=2,2===W&&(B?B(a):X())},H="undefined"!=typeof window?window:void 0,I=H||{},J=I.MutationObserver||I.WebKitMutationObserver,Q="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),R="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,V=new Array(1e3),X=void 0;X=Q?o():J?s():R?u():void 0===H&&"function"==typeof require?f():c();var Z=Math.random().toString(36).substring(2),$=void 0,tt=1,et=2,nt={error:null},rt=0,ot=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(p),this.promise[Z]||O(this.promise),U(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&S(this.promise,this._result))):j(this.promise,k())}return t.prototype._enumerate=function(t){for(var e=0;this._state===$&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===h){var o=_(t);if(o===l&&t._state!==$)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===it){var i=new n(p);w(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===$&&(this._remaining--,t===et?j(r,n):this._result[e]=n),0===this._remaining&&S(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){return n._settledAt(tt,e,t)},function(t){return n._settledAt(et,e,t)})},t}(),it=function(){function t(e){this[Z]=C(),this._result=this._state=void 0,this._subscribers=[],p!==e&&("function"!=typeof e&&D(),this instanceof t?x(this,e):K())}return t.prototype["catch"]=function(t){return this.then(null,t)},t.prototype["finally"]=function(t){var n=this,r=n.constructor;return e(t)?n.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})}):n.then(t,t)},t}();return it.prototype.then=l,it.all=F,it.race=Y,it.resolve=h,it.reject=q,it._setScheduler=n,it._setAsap=r,it._asap=G,it.polyfill=L,it.Promise=it,it});

(function(a,b){if("function"==typeof define&&define.amd)define([],b);else if("undefined"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){"use strict";function b(a,b){return"undefined"==typeof b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Depricated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function c(b,c,d){var e=new XMLHttpRequest;e.open("GET",b),e.responseType="blob",e.onload=function(){a(e.response,c,d)},e.onerror=function(){console.error("could not download file")},e.send()}function d(a){var b=new XMLHttpRequest;return b.open("HEAD",a,!1),b.send(),200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(c){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f=function(){try{return Function("return this")()||(42,eval)("this")}catch(a){return"object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:this}}(),a=f.saveAs||"object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g=g||b.name||"download",j.download=g,j.rel="noopener","string"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,h){if(g=g||f.name||"download","string"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement("a");i.href=f,i.target="_blank",setTimeout(function(){e(i)})}}:function(a,b,d,e){if(e=e||open("","_blank"),e&&(e.document.title=e.document.body.innerText="downloading..."),"string"==typeof a)return c(a,b,d);var g="application/octet-stream"===a.type,h=/constructor/i.test(f.HTMLElement)||f.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||g&&h)&&"object"==typeof FileReader){var j=new FileReader;j.onloadend=function(){var a=j.result;a=i?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),e?e.location.href=a:location=a,e=null},j.readAsDataURL(a)}else{var k=f.URL||f.webkitURL,l=k.createObjectURL(a);e?e.location=l:location.href=l,e=null,setTimeout(function(){k.revokeObjectURL(l)},4E4)}};f.saveAs=a.saveAs=a,"undefined"!=typeof module&&(module.exports=a)});

/*!
 * Flickity PACKAGED v2.1.2
 * Touch, responsive, flickable carousels
 *
 * Licensed GPLv3 for open source use
 * or Flickity Commercial License for commercial use
 *
 * https://flickity.metafizzy.co
 * Copyright 2015-2018 Metafizzy
 */

!function(t,e){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("jquery")):t.jQueryBridget=e(t,t.jQuery)}(window,function(t,e){"use strict";function i(i,o,a){function l(t,e,n){var s,o="$()."+i+'("'+e+'")';return t.each(function(t,l){var h=a.data(l,i);if(!h)return void r(i+" not initialized. Cannot call methods, i.e. "+o);var c=h[e];if(!c||"_"==e.charAt(0))return void r(o+" is not a valid method");var d=c.apply(h,n);s=void 0===s?d:s}),void 0!==s?s:t}function h(t,e){t.each(function(t,n){var s=a.data(n,i);s?(s.option(e),s._init()):(s=new o(n,e),a.data(n,i,s))})}a=a||e||t.jQuery,a&&(o.prototype.option||(o.prototype.option=function(t){a.isPlainObject(t)&&(this.options=a.extend(!0,this.options,t))}),a.fn[i]=function(t){if("string"==typeof t){var e=s.call(arguments,1);return l(this,t,e)}return h(this,t),this},n(a))}function n(t){!t||t&&t.bridget||(t.bridget=i)}var s=Array.prototype.slice,o=t.console,r="undefined"==typeof o?function(){}:function(t){o.error(t)};return n(e||t.jQuery),i}),function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}("undefined"!=typeof window?window:this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return n.indexOf(e)==-1&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},n=i[t]=i[t]||{};return n[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return n!=-1&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){i=i.slice(0),e=e||[];for(var n=this._onceEvents&&this._onceEvents[t],s=0;s<i.length;s++){var o=i[s],r=n&&n[o];r&&(this.off(t,o),delete n[o]),o.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t}),function(t,e){"function"==typeof define&&define.amd?define("get-size/get-size",e):"object"==typeof module&&module.exports?module.exports=e():t.getSize=e()}(window,function(){"use strict";function t(t){var e=parseFloat(t),i=t.indexOf("%")==-1&&!isNaN(e);return i&&e}function e(){}function i(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<h;e++){var i=l[e];t[i]=0}return t}function n(t){var e=getComputedStyle(t);return e||a("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),e}function s(){if(!c){c=!0;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box";var i=document.body||document.documentElement;i.appendChild(e);var s=n(e);r=200==Math.round(t(s.width)),o.isBoxSizeOuter=r,i.removeChild(e)}}function o(e){if(s(),"string"==typeof e&&(e=document.querySelector(e)),e&&"object"==typeof e&&e.nodeType){var o=n(e);if("none"==o.display)return i();var a={};a.width=e.offsetWidth,a.height=e.offsetHeight;for(var c=a.isBorderBox="border-box"==o.boxSizing,d=0;d<h;d++){var u=l[d],f=o[u],p=parseFloat(f);a[u]=isNaN(p)?0:p}var g=a.paddingLeft+a.paddingRight,v=a.paddingTop+a.paddingBottom,m=a.marginLeft+a.marginRight,y=a.marginTop+a.marginBottom,b=a.borderLeftWidth+a.borderRightWidth,E=a.borderTopWidth+a.borderBottomWidth,S=c&&r,C=t(o.width);C!==!1&&(a.width=C+(S?0:g+b));var x=t(o.height);return x!==!1&&(a.height=x+(S?0:v+E)),a.innerWidth=a.width-(g+b),a.innerHeight=a.height-(v+E),a.outerWidth=a.width+m,a.outerHeight=a.height+y,a}}var r,a="undefined"==typeof console?e:function(t){console.error(t)},l=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],h=l.length,c=!1;return o}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",e):"object"==typeof module&&module.exports?module.exports=e():t.matchesSelector=e()}(window,function(){"use strict";var t=function(){var t=window.Element.prototype;if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],i=0;i<e.length;i++){var n=e[i],s=n+"MatchesSelector";if(t[s])return s}}();return function(e,i){return e[t](i)}}),function(t,e){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("desandro-matches-selector")):t.fizzyUIUtils=e(t,t.matchesSelector)}(window,function(t,e){var i={};i.extend=function(t,e){for(var i in e)t[i]=e[i];return t},i.modulo=function(t,e){return(t%e+e)%e};var n=Array.prototype.slice;i.makeArray=function(t){if(Array.isArray(t))return t;if(null===t||void 0===t)return[];var e="object"==typeof t&&"number"==typeof t.length;return e?n.call(t):[t]},i.removeFrom=function(t,e){var i=t.indexOf(e);i!=-1&&t.splice(i,1)},i.getParent=function(t,i){for(;t.parentNode&&t!=document.body;)if(t=t.parentNode,e(t,i))return t},i.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},i.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.filterFindElements=function(t,n){t=i.makeArray(t);var s=[];return t.forEach(function(t){if(t instanceof HTMLElement){if(!n)return void s.push(t);e(t,n)&&s.push(t);for(var i=t.querySelectorAll(n),o=0;o<i.length;o++)s.push(i[o])}}),s},i.debounceMethod=function(t,e,i){i=i||100;var n=t.prototype[e],s=e+"Timeout";t.prototype[e]=function(){var t=this[s];clearTimeout(t);var e=arguments,o=this;this[s]=setTimeout(function(){n.apply(o,e),delete o[s]},i)}},i.docReady=function(t){var e=document.readyState;"complete"==e||"interactive"==e?setTimeout(t):document.addEventListener("DOMContentLoaded",t)},i.toDashed=function(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()};var s=t.console;return i.htmlInit=function(e,n){i.docReady(function(){var o=i.toDashed(n),r="data-"+o,a=document.querySelectorAll("["+r+"]"),l=document.querySelectorAll(".js-"+o),h=i.makeArray(a).concat(i.makeArray(l)),c=r+"-options",d=t.jQuery;h.forEach(function(t){var i,o=t.getAttribute(r)||t.getAttribute(c);try{i=o&&JSON.parse(o)}catch(a){return void(s&&s.error("Error parsing "+r+" on "+t.className+": "+a))}var l=new e(t,i);d&&d.data(t,n,l)})})},i}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/cell",["get-size/get-size"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("get-size")):(t.Flickity=t.Flickity||{},t.Flickity.Cell=e(t,t.getSize))}(window,function(t,e){function i(t,e){this.element=t,this.parent=e,this.create()}var n=i.prototype;return n.create=function(){this.element.style.position="absolute",this.element.setAttribute("aria-selected","false"),this.x=0,this.shift=0},n.destroy=function(){this.element.style.position="";var t=this.parent.originSide;this.element.removeAttribute("aria-selected"),this.element.style[t]=""},n.getSize=function(){this.size=e(this.element)},n.setPosition=function(t){this.x=t,this.updateTarget(),this.renderPosition(t)},n.updateTarget=n.setDefaultTarget=function(){var t="left"==this.parent.originSide?"marginLeft":"marginRight";this.target=this.x+this.size[t]+this.size.width*this.parent.cellAlign},n.renderPosition=function(t){var e=this.parent.originSide;this.element.style[e]=this.parent.getPositionValue(t)},n.wrapShift=function(t){this.shift=t,this.renderPosition(this.x+this.parent.slideableWidth*t)},n.remove=function(){this.element.parentNode.removeChild(this.element)},i}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/slide",e):"object"==typeof module&&module.exports?module.exports=e():(t.Flickity=t.Flickity||{},t.Flickity.Slide=e())}(window,function(){"use strict";function t(t){this.parent=t,this.isOriginLeft="left"==t.originSide,this.cells=[],this.outerWidth=0,this.height=0}var e=t.prototype;return e.addCell=function(t){if(this.cells.push(t),this.outerWidth+=t.size.outerWidth,this.height=Math.max(t.size.outerHeight,this.height),1==this.cells.length){this.x=t.x;var e=this.isOriginLeft?"marginLeft":"marginRight";this.firstMargin=t.size[e]}},e.updateTarget=function(){var t=this.isOriginLeft?"marginRight":"marginLeft",e=this.getLastCell(),i=e?e.size[t]:0,n=this.outerWidth-(this.firstMargin+i);this.target=this.x+this.firstMargin+n*this.parent.cellAlign},e.getLastCell=function(){return this.cells[this.cells.length-1]},e.select=function(){this.changeSelected(!0)},e.unselect=function(){this.changeSelected(!1)},e.changeSelected=function(t){var e=t?"add":"remove";this.cells.forEach(function(i){i.element.classList[e]("is-selected"),i.element.setAttribute("aria-selected",t.toString())})},e.getCellElements=function(){return this.cells.map(function(t){return t.element})},t}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/animate",["fizzy-ui-utils/utils"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("fizzy-ui-utils")):(t.Flickity=t.Flickity||{},t.Flickity.animatePrototype=e(t,t.fizzyUIUtils))}(window,function(t,e){var i={};return i.startAnimation=function(){this.isAnimating||(this.isAnimating=!0,this.restingFrames=0,this.animate())},i.animate=function(){this.applyDragForce(),this.applySelectedAttraction();var t=this.x;if(this.integratePhysics(),this.positionSlider(),this.settle(t),this.isAnimating){var e=this;requestAnimationFrame(function(){e.animate()})}},i.positionSlider=function(){var t=this.x;this.options.wrapAround&&this.cells.length>1&&(t=e.modulo(t,this.slideableWidth),t-=this.slideableWidth,this.shiftWrapCells(t)),t+=this.cursorPosition,t=this.options.rightToLeft?-t:t;var i=this.getPositionValue(t);this.slider.style.transform=this.isAnimating?"translate3d("+i+",0,0)":"translateX("+i+")";var n=this.slides[0];if(n){var s=-this.x-n.target,o=s/this.slidesWidth;this.dispatchEvent("scroll",null,[o,s])}},i.positionSliderAtSelected=function(){this.cells.length&&(this.x=-this.selectedSlide.target,this.velocity=0,this.positionSlider())},i.getPositionValue=function(t){return this.options.percentPosition?.01*Math.round(t/this.size.innerWidth*1e4)+"%":Math.round(t)+"px"},i.settle=function(t){this.isPointerDown||Math.round(100*this.x)!=Math.round(100*t)||this.restingFrames++,this.restingFrames>2&&(this.isAnimating=!1,delete this.isFreeScrolling,this.positionSlider(),this.dispatchEvent("settle",null,[this.selectedIndex]))},i.shiftWrapCells=function(t){var e=this.cursorPosition+t;this._shiftCells(this.beforeShiftCells,e,-1);var i=this.size.innerWidth-(t+this.slideableWidth+this.cursorPosition);this._shiftCells(this.afterShiftCells,i,1)},i._shiftCells=function(t,e,i){for(var n=0;n<t.length;n++){var s=t[n],o=e>0?i:0;s.wrapShift(o),e-=s.size.outerWidth}},i._unshiftCells=function(t){if(t&&t.length)for(var e=0;e<t.length;e++)t[e].wrapShift(0)},i.integratePhysics=function(){this.x+=this.velocity,this.velocity*=this.getFrictionFactor()},i.applyForce=function(t){this.velocity+=t},i.getFrictionFactor=function(){return 1-this.options[this.isFreeScrolling?"freeScrollFriction":"friction"]},i.getRestingPosition=function(){return this.x+this.velocity/(1-this.getFrictionFactor())},i.applyDragForce=function(){if(this.isDraggable&&this.isPointerDown){var t=this.dragX-this.x,e=t-this.velocity;this.applyForce(e)}},i.applySelectedAttraction=function(){var t=this.isDraggable&&this.isPointerDown;if(!t&&!this.isFreeScrolling&&this.slides.length){var e=this.selectedSlide.target*-1-this.x,i=e*this.options.selectedAttraction;this.applyForce(i)}},i}),function(t,e){if("function"==typeof define&&define.amd)define("flickity/js/flickity",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./cell","./slide","./animate"],function(i,n,s,o,r,a){return e(t,i,n,s,o,r,a)});else if("object"==typeof module&&module.exports)module.exports=e(t,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./cell"),require("./slide"),require("./animate"));else{var i=t.Flickity;t.Flickity=e(t,t.EvEmitter,t.getSize,t.fizzyUIUtils,i.Cell,i.Slide,i.animatePrototype)}}(window,function(t,e,i,n,s,o,r){function a(t,e){for(t=n.makeArray(t);t.length;)e.appendChild(t.shift())}function l(t,e){var i=n.getQueryElement(t);if(!i)return void(d&&d.error("Bad element for Flickity: "+(i||t)));if(this.element=i,this.element.flickityGUID){var s=f[this.element.flickityGUID];return s.option(e),s}h&&(this.$element=h(this.element)),this.options=n.extend({},this.constructor.defaults),this.option(e),this._create()}var h=t.jQuery,c=t.getComputedStyle,d=t.console,u=0,f={};l.defaults={accessibility:!0,cellAlign:"center",freeScrollFriction:.075,friction:.28,namespaceJQueryEvents:!0,percentPosition:!0,resize:!0,selectedAttraction:.025,setGallerySize:!0},l.createMethods=[];var p=l.prototype;n.extend(p,e.prototype),p._create=function(){var e=this.guid=++u;this.element.flickityGUID=e,f[e]=this,this.selectedIndex=0,this.restingFrames=0,this.x=0,this.velocity=0,this.originSide=this.options.rightToLeft?"right":"left",this.viewport=document.createElement("div"),this.viewport.className="flickity-viewport",this._createSlider(),(this.options.resize||this.options.watchCSS)&&t.addEventListener("resize",this);for(var i in this.options.on){var n=this.options.on[i];this.on(i,n)}l.createMethods.forEach(function(t){this[t]()},this),this.options.watchCSS?this.watchCSS():this.activate()},p.option=function(t){n.extend(this.options,t)},p.activate=function(){if(!this.isActive){this.isActive=!0,this.element.classList.add("flickity-enabled"),this.options.rightToLeft&&this.element.classList.add("flickity-rtl"),this.getSize();var t=this._filterFindCellElements(this.element.children);a(t,this.slider),this.viewport.appendChild(this.slider),this.element.appendChild(this.viewport),this.reloadCells(),this.options.accessibility&&(this.element.tabIndex=0,this.element.addEventListener("keydown",this)),this.emitEvent("activate");var e,i=this.options.initialIndex;e=this.isInitActivated?this.selectedIndex:void 0!==i&&this.cells[i]?i:0,this.select(e,!1,!0),this.isInitActivated=!0,this.dispatchEvent("ready")}},p._createSlider=function(){var t=document.createElement("div");t.className="flickity-slider",t.style[this.originSide]=0,this.slider=t},p._filterFindCellElements=function(t){return n.filterFindElements(t,this.options.cellSelector)},p.reloadCells=function(){this.cells=this._makeCells(this.slider.children),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize()},p._makeCells=function(t){var e=this._filterFindCellElements(t),i=e.map(function(t){return new s(t,this)},this);return i},p.getLastCell=function(){return this.cells[this.cells.length-1]},p.getLastSlide=function(){return this.slides[this.slides.length-1]},p.positionCells=function(){this._sizeCells(this.cells),this._positionCells(0)},p._positionCells=function(t){t=t||0,this.maxCellHeight=t?this.maxCellHeight||0:0;var e=0;if(t>0){var i=this.cells[t-1];e=i.x+i.size.outerWidth}for(var n=this.cells.length,s=t;s<n;s++){var o=this.cells[s];o.setPosition(e),e+=o.size.outerWidth,this.maxCellHeight=Math.max(o.size.outerHeight,this.maxCellHeight)}this.slideableWidth=e,this.updateSlides(),this._containSlides(),this.slidesWidth=n?this.getLastSlide().target-this.slides[0].target:0},p._sizeCells=function(t){t.forEach(function(t){t.getSize()})},p.updateSlides=function(){if(this.slides=[],this.cells.length){var t=new o(this);this.slides.push(t);var e="left"==this.originSide,i=e?"marginRight":"marginLeft",n=this._getCanCellFit();this.cells.forEach(function(e,s){if(!t.cells.length)return void t.addCell(e);var r=t.outerWidth-t.firstMargin+(e.size.outerWidth-e.size[i]);n.call(this,s,r)?t.addCell(e):(t.updateTarget(),t=new o(this),this.slides.push(t),t.addCell(e))},this),t.updateTarget(),this.updateSelectedSlide()}},p._getCanCellFit=function(){var t=this.options.groupCells;if(!t)return function(){return!1};if("number"==typeof t){var e=parseInt(t,10);return function(t){return t%e!==0}}var i="string"==typeof t&&t.match(/^(\d+)%$/),n=i?parseInt(i[1],10)/100:1;return function(t,e){return e<=(this.size.innerWidth+1)*n}},p._init=p.reposition=function(){this.positionCells(),this.positionSliderAtSelected()},p.getSize=function(){this.size=i(this.element),this.setCellAlign(),this.cursorPosition=this.size.innerWidth*this.cellAlign};var g={center:{left:.5,right:.5},left:{left:0,right:1},right:{right:0,left:1}};return p.setCellAlign=function(){var t=g[this.options.cellAlign];this.cellAlign=t?t[this.originSide]:this.options.cellAlign},p.setGallerySize=function(){if(this.options.setGallerySize){var t=this.options.adaptiveHeight&&this.selectedSlide?this.selectedSlide.height:this.maxCellHeight;this.viewport.style.height=t+"px"}},p._getWrapShiftCells=function(){if(this.options.wrapAround){this._unshiftCells(this.beforeShiftCells),this._unshiftCells(this.afterShiftCells);var t=this.cursorPosition,e=this.cells.length-1;this.beforeShiftCells=this._getGapCells(t,e,-1),t=this.size.innerWidth-this.cursorPosition,this.afterShiftCells=this._getGapCells(t,0,1)}},p._getGapCells=function(t,e,i){for(var n=[];t>0;){var s=this.cells[e];if(!s)break;n.push(s),e+=i,t-=s.size.outerWidth}return n},p._containSlides=function(){if(this.options.contain&&!this.options.wrapAround&&this.cells.length){var t=this.options.rightToLeft,e=t?"marginRight":"marginLeft",i=t?"marginLeft":"marginRight",n=this.slideableWidth-this.getLastCell().size[i],s=n<this.size.innerWidth,o=this.cursorPosition+this.cells[0].size[e],r=n-this.size.innerWidth*(1-this.cellAlign);this.slides.forEach(function(t){s?t.target=n*this.cellAlign:(t.target=Math.max(t.target,o),t.target=Math.min(t.target,r))},this)}},p.dispatchEvent=function(t,e,i){var n=e?[e].concat(i):i;if(this.emitEvent(t,n),h&&this.$element){t+=this.options.namespaceJQueryEvents?".flickity":"";var s=t;if(e){var o=h.Event(e);o.type=t,s=o}this.$element.trigger(s,i)}},p.select=function(t,e,i){if(this.isActive&&(t=parseInt(t,10),this._wrapSelect(t),(this.options.wrapAround||e)&&(t=n.modulo(t,this.slides.length)),this.slides[t])){var s=this.selectedIndex;this.selectedIndex=t,this.updateSelectedSlide(),i?this.positionSliderAtSelected():this.startAnimation(),this.options.adaptiveHeight&&this.setGallerySize(),this.dispatchEvent("select",null,[t]),t!=s&&this.dispatchEvent("change",null,[t]),this.dispatchEvent("cellSelect")}},p._wrapSelect=function(t){var e=this.slides.length,i=this.options.wrapAround&&e>1;if(!i)return t;var s=n.modulo(t,e),o=Math.abs(s-this.selectedIndex),r=Math.abs(s+e-this.selectedIndex),a=Math.abs(s-e-this.selectedIndex);!this.isDragSelect&&r<o?t+=e:!this.isDragSelect&&a<o&&(t-=e),t<0?this.x-=this.slideableWidth:t>=e&&(this.x+=this.slideableWidth)},p.previous=function(t,e){this.select(this.selectedIndex-1,t,e)},p.next=function(t,e){this.select(this.selectedIndex+1,t,e)},p.updateSelectedSlide=function(){var t=this.slides[this.selectedIndex];t&&(this.unselectSelectedSlide(),this.selectedSlide=t,t.select(),this.selectedCells=t.cells,this.selectedElements=t.getCellElements(),this.selectedCell=t.cells[0],this.selectedElement=this.selectedElements[0])},p.unselectSelectedSlide=function(){this.selectedSlide&&this.selectedSlide.unselect()},p.selectCell=function(t,e,i){var n=this.queryCell(t);if(n){var s=this.getCellSlideIndex(n);this.select(s,e,i)}},p.getCellSlideIndex=function(t){for(var e=0;e<this.slides.length;e++){var i=this.slides[e],n=i.cells.indexOf(t);if(n!=-1)return e}},p.getCell=function(t){for(var e=0;e<this.cells.length;e++){var i=this.cells[e];if(i.element==t)return i}},p.getCells=function(t){t=n.makeArray(t);var e=[];return t.forEach(function(t){var i=this.getCell(t);i&&e.push(i)},this),e},p.getCellElements=function(){return this.cells.map(function(t){return t.element})},p.getParentCell=function(t){var e=this.getCell(t);return e?e:(t=n.getParent(t,".flickity-slider > *"),this.getCell(t))},p.getAdjacentCellElements=function(t,e){if(!t)return this.selectedSlide.getCellElements();e=void 0===e?this.selectedIndex:e;var i=this.slides.length;if(1+2*t>=i)return this.getCellElements();for(var s=[],o=e-t;o<=e+t;o++){var r=this.options.wrapAround?n.modulo(o,i):o,a=this.slides[r];a&&(s=s.concat(a.getCellElements()))}return s},p.queryCell=function(t){return"number"==typeof t?this.cells[t]:("string"==typeof t&&(t=this.element.querySelector(t)),this.getCell(t))},p.uiChange=function(){this.emitEvent("uiChange")},p.childUIPointerDown=function(t){this.emitEvent("childUIPointerDown",[t])},p.onresize=function(){this.watchCSS(),this.resize()},n.debounceMethod(l,"onresize",150),p.resize=function(){if(this.isActive){this.getSize(),this.options.wrapAround&&(this.x=n.modulo(this.x,this.slideableWidth)),this.positionCells(),this._getWrapShiftCells(),this.setGallerySize(),this.emitEvent("resize");var t=this.selectedElements&&this.selectedElements[0];this.selectCell(t,!1,!0)}},p.watchCSS=function(){var t=this.options.watchCSS;if(t){var e=c(this.element,":after").content;e.indexOf("flickity")!=-1?this.activate():this.deactivate()}},p.onkeydown=function(t){var e=document.activeElement&&document.activeElement!=this.element;if(this.options.accessibility&&!e){var i=l.keyboardHandlers[t.keyCode];i&&i.call(this)}},l.keyboardHandlers={37:function(){var t=this.options.rightToLeft?"next":"previous";this.uiChange(),this[t]()},39:function(){var t=this.options.rightToLeft?"previous":"next";this.uiChange(),this[t]()}},p.focus=function(){var e=t.pageYOffset;this.element.focus({preventScroll:!0}),t.pageYOffset!=e&&t.scrollTo(t.pageXOffset,e)},p.deactivate=function(){this.isActive&&(this.element.classList.remove("flickity-enabled"),this.element.classList.remove("flickity-rtl"),this.unselectSelectedSlide(),this.cells.forEach(function(t){t.destroy()}),this.element.removeChild(this.viewport),a(this.slider.children,this.element),this.options.accessibility&&(this.element.removeAttribute("tabIndex"),this.element.removeEventListener("keydown",this)),this.isActive=!1,this.emitEvent("deactivate"))},p.destroy=function(){this.deactivate(),t.removeEventListener("resize",this),this.emitEvent("destroy"),h&&this.$element&&h.removeData(this.element,"flickity"),delete this.element.flickityGUID,delete f[this.guid]},n.extend(p,r),l.data=function(t){t=n.getQueryElement(t);var e=t&&t.flickityGUID;return e&&f[e]},n.htmlInit(l,"flickity"),h&&h.bridget&&h.bridget("flickity",l),l.setJQuery=function(t){h=t},l.Cell=s,l}),function(t,e){"function"==typeof define&&define.amd?define("unipointer/unipointer",["ev-emitter/ev-emitter"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter")):t.Unipointer=e(t,t.EvEmitter)}(window,function(t,e){function i(){}function n(){}var s=n.prototype=Object.create(e.prototype);s.bindStartEvent=function(t){this._bindStartEvent(t,!0)},s.unbindStartEvent=function(t){this._bindStartEvent(t,!1)},s._bindStartEvent=function(e,i){i=void 0===i||i;var n=i?"addEventListener":"removeEventListener",s="mousedown";t.PointerEvent?s="pointerdown":"ontouchstart"in t&&(s="touchstart"),e[n](s,this)},s.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},s.getTouch=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.identifier==this.pointerIdentifier)return i}},s.onmousedown=function(t){var e=t.button;e&&0!==e&&1!==e||this._pointerDown(t,t)},s.ontouchstart=function(t){this._pointerDown(t,t.changedTouches[0])},s.onpointerdown=function(t){this._pointerDown(t,t)},s._pointerDown=function(t,e){t.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==e.pointerId?e.pointerId:e.identifier,this.pointerDown(t,e))},s.pointerDown=function(t,e){this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e])};var o={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return s._bindPostStartEvents=function(e){if(e){var i=o[e.type];i.forEach(function(e){t.addEventListener(e,this)},this),this._boundPointerEvents=i}},s._unbindPostStartEvents=function(){this._boundPointerEvents&&(this._boundPointerEvents.forEach(function(e){t.removeEventListener(e,this)},this),delete this._boundPointerEvents)},s.onmousemove=function(t){this._pointerMove(t,t)},s.onpointermove=function(t){t.pointerId==this.pointerIdentifier&&this._pointerMove(t,t)},s.ontouchmove=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerMove(t,e)},s._pointerMove=function(t,e){this.pointerMove(t,e)},s.pointerMove=function(t,e){this.emitEvent("pointerMove",[t,e])},s.onmouseup=function(t){this._pointerUp(t,t)},s.onpointerup=function(t){t.pointerId==this.pointerIdentifier&&this._pointerUp(t,t)},s.ontouchend=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerUp(t,e)},s._pointerUp=function(t,e){this._pointerDone(),this.pointerUp(t,e)},s.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e])},s._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},s._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},s.pointerDone=i,s.onpointercancel=function(t){t.pointerId==this.pointerIdentifier&&this._pointerCancel(t,t)},s.ontouchcancel=function(t){var e=this.getTouch(t.changedTouches);e&&this._pointerCancel(t,e)},s._pointerCancel=function(t,e){this._pointerDone(),this.pointerCancel(t,e)},s.pointerCancel=function(t,e){this.emitEvent("pointerCancel",[t,e])},n.getPointerPoint=function(t){return{x:t.pageX,y:t.pageY}},n}),function(t,e){"function"==typeof define&&define.amd?define("unidragger/unidragger",["unipointer/unipointer"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("unipointer")):t.Unidragger=e(t,t.Unipointer)}(window,function(t,e){function i(){}var n=i.prototype=Object.create(e.prototype);n.bindHandles=function(){this._bindHandles(!0)},n.unbindHandles=function(){this._bindHandles(!1)},n._bindHandles=function(e){e=void 0===e||e;for(var i=e?"addEventListener":"removeEventListener",n=e?this._touchActionValue:"",s=0;s<this.handles.length;s++){var o=this.handles[s];this._bindStartEvent(o,e),o[i]("click",this),t.PointerEvent&&(o.style.touchAction=n)}},n._touchActionValue="none",n.pointerDown=function(t,e){var i=this.okayPointerDown(t);i&&(this.pointerDownPointer=e,t.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(t),this.emitEvent("pointerDown",[t,e]))};var s={TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0},o={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return n.okayPointerDown=function(t){var e=s[t.target.nodeName],i=o[t.target.type],n=!e||i;return n||this._pointerReset(),n},n.pointerDownBlur=function(){var t=document.activeElement,e=t&&t.blur&&t!=document.body;e&&t.blur()},n.pointerMove=function(t,e){var i=this._dragPointerMove(t,e);this.emitEvent("pointerMove",[t,e,i]),this._dragMove(t,e,i)},n._dragPointerMove=function(t,e){var i={x:e.pageX-this.pointerDownPointer.pageX,y:e.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(i)&&this._dragStart(t,e),i},n.hasDragStarted=function(t){return Math.abs(t.x)>3||Math.abs(t.y)>3},n.pointerUp=function(t,e){this.emitEvent("pointerUp",[t,e]),this._dragPointerUp(t,e)},n._dragPointerUp=function(t,e){this.isDragging?this._dragEnd(t,e):this._staticClick(t,e)},n._dragStart=function(t,e){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(t,e)},n.dragStart=function(t,e){this.emitEvent("dragStart",[t,e])},n._dragMove=function(t,e,i){this.isDragging&&this.dragMove(t,e,i)},n.dragMove=function(t,e,i){t.preventDefault(),this.emitEvent("dragMove",[t,e,i])},n._dragEnd=function(t,e){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(t,e)},n.dragEnd=function(t,e){this.emitEvent("dragEnd",[t,e])},n.onclick=function(t){this.isPreventingClicks&&t.preventDefault()},n._staticClick=function(t,e){this.isIgnoringMouseUp&&"mouseup"==t.type||(this.staticClick(t,e),"mouseup"!=t.type&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400)))},n.staticClick=function(t,e){this.emitEvent("staticClick",[t,e])},i.getPointerPoint=e.getPointerPoint,i}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/drag",["./flickity","unidragger/unidragger","fizzy-ui-utils/utils"],function(i,n,s){return e(t,i,n,s)}):"object"==typeof module&&module.exports?module.exports=e(t,require("./flickity"),require("unidragger"),require("fizzy-ui-utils")):t.Flickity=e(t,t.Flickity,t.Unidragger,t.fizzyUIUtils)}(window,function(t,e,i,n){function s(){return{x:t.pageXOffset,y:t.pageYOffset}}n.extend(e.defaults,{draggable:">1",dragThreshold:3}),e.createMethods.push("_createDrag");var o=e.prototype;n.extend(o,i.prototype),o._touchActionValue="pan-y";var r="createTouch"in document,a=!1;o._createDrag=function(){this.on("activate",this.onActivateDrag),this.on("uiChange",this._uiChangeDrag),this.on("childUIPointerDown",this._childUIPointerDownDrag),this.on("deactivate",this.onDeactivateDrag),this.on("cellChange",this.updateDraggable),r&&!a&&(t.addEventListener("touchmove",function(){}),a=!0)},o.onActivateDrag=function(){this.handles=[this.viewport],this.bindHandles(),this.updateDraggable()},o.onDeactivateDrag=function(){this.unbindHandles(),this.element.classList.remove("is-draggable")},o.updateDraggable=function(){">1"==this.options.draggable?this.isDraggable=this.slides.length>1:this.isDraggable=this.options.draggable,this.isDraggable?this.element.classList.add("is-draggable"):this.element.classList.remove("is-draggable")},o.bindDrag=function(){this.options.draggable=!0,this.updateDraggable()},o.unbindDrag=function(){this.options.draggable=!1,this.updateDraggable()},o._uiChangeDrag=function(){delete this.isFreeScrolling},o._childUIPointerDownDrag=function(t){t.preventDefault(),this.pointerDownFocus(t)},o.pointerDown=function(e,i){if(!this.isDraggable)return void this._pointerDownDefault(e,i);var n=this.okayPointerDown(e);n&&(this._pointerDownPreventDefault(e),this.pointerDownFocus(e),document.activeElement!=this.element&&this.pointerDownBlur(),this.dragX=this.x,this.viewport.classList.add("is-pointer-down"),this.pointerDownScroll=s(),t.addEventListener("scroll",this),this._pointerDownDefault(e,i))},o._pointerDownDefault=function(t,e){this.pointerDownPointer=e,this._bindPostStartEvents(t),this.dispatchEvent("pointerDown",t,[e])};var l={INPUT:!0,TEXTAREA:!0,SELECT:!0};return o.pointerDownFocus=function(t){var e=l[t.target.nodeName];e||this.focus()},o._pointerDownPreventDefault=function(t){var e="touchstart"==t.type,i="touch"==t.pointerType,n=l[t.target.nodeName];e||i||n||t.preventDefault()},o.hasDragStarted=function(t){return Math.abs(t.x)>this.options.dragThreshold},o.pointerUp=function(t,e){delete this.isTouchScrolling,this.viewport.classList.remove("is-pointer-down"),this.dispatchEvent("pointerUp",t,[e]),this._dragPointerUp(t,e)},o.pointerDone=function(){t.removeEventListener("scroll",this),delete this.pointerDownScroll},o.dragStart=function(e,i){this.isDraggable&&(this.dragStartPosition=this.x,this.startAnimation(),t.removeEventListener("scroll",this),this.dispatchEvent("dragStart",e,[i]))},o.pointerMove=function(t,e){var i=this._dragPointerMove(t,e);this.dispatchEvent("pointerMove",t,[e,i]),this._dragMove(t,e,i)},o.dragMove=function(t,e,i){if(this.isDraggable){t.preventDefault(),this.previousDragX=this.dragX;var n=this.options.rightToLeft?-1:1;this.options.wrapAround&&(i.x=i.x%this.slideableWidth);var s=this.dragStartPosition+i.x*n;if(!this.options.wrapAround&&this.slides.length){var o=Math.max(-this.slides[0].target,this.dragStartPosition);s=s>o?.5*(s+o):s;var r=Math.min(-this.getLastSlide().target,this.dragStartPosition);s=s<r?.5*(s+r):s}this.dragX=s,this.dragMoveTime=new Date,
this.dispatchEvent("dragMove",t,[e,i])}},o.dragEnd=function(t,e){if(this.isDraggable){this.options.freeScroll&&(this.isFreeScrolling=!0);var i=this.dragEndRestingSelect();if(this.options.freeScroll&&!this.options.wrapAround){var n=this.getRestingPosition();this.isFreeScrolling=-n>this.slides[0].target&&-n<this.getLastSlide().target}else this.options.freeScroll||i!=this.selectedIndex||(i+=this.dragEndBoostSelect());delete this.previousDragX,this.isDragSelect=this.options.wrapAround,this.select(i),delete this.isDragSelect,this.dispatchEvent("dragEnd",t,[e])}},o.dragEndRestingSelect=function(){var t=this.getRestingPosition(),e=Math.abs(this.getSlideDistance(-t,this.selectedIndex)),i=this._getClosestResting(t,e,1),n=this._getClosestResting(t,e,-1),s=i.distance<n.distance?i.index:n.index;return s},o._getClosestResting=function(t,e,i){for(var n=this.selectedIndex,s=1/0,o=this.options.contain&&!this.options.wrapAround?function(t,e){return t<=e}:function(t,e){return t<e};o(e,s)&&(n+=i,s=e,e=this.getSlideDistance(-t,n),null!==e);)e=Math.abs(e);return{distance:s,index:n-i}},o.getSlideDistance=function(t,e){var i=this.slides.length,s=this.options.wrapAround&&i>1,o=s?n.modulo(e,i):e,r=this.slides[o];if(!r)return null;var a=s?this.slideableWidth*Math.floor(e/i):0;return t-(r.target+a)},o.dragEndBoostSelect=function(){if(void 0===this.previousDragX||!this.dragMoveTime||new Date-this.dragMoveTime>100)return 0;var t=this.getSlideDistance(-this.dragX,this.selectedIndex),e=this.previousDragX-this.dragX;return t>0&&e>0?1:t<0&&e<0?-1:0},o.staticClick=function(t,e){var i=this.getParentCell(t.target),n=i&&i.element,s=i&&this.cells.indexOf(i);this.dispatchEvent("staticClick",t,[e,n,s])},o.onscroll=function(){var t=s(),e=this.pointerDownScroll.x-t.x,i=this.pointerDownScroll.y-t.y;(Math.abs(e)>3||Math.abs(i)>3)&&this._pointerDone()},e}),function(t,e){"function"==typeof define&&define.amd?define("tap-listener/tap-listener",["unipointer/unipointer"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("unipointer")):t.TapListener=e(t,t.Unipointer)}(window,function(t,e){function i(t){this.bindTap(t)}var n=i.prototype=Object.create(e.prototype);return n.bindTap=function(t){t&&(this.unbindTap(),this.tapElement=t,this._bindStartEvent(t,!0))},n.unbindTap=function(){this.tapElement&&(this._bindStartEvent(this.tapElement,!0),delete this.tapElement)},n.pointerUp=function(i,n){if(!this.isIgnoringMouseUp||"mouseup"!=i.type){var s=e.getPointerPoint(n),o=this.tapElement.getBoundingClientRect(),r=t.pageXOffset,a=t.pageYOffset,l=s.x>=o.left+r&&s.x<=o.right+r&&s.y>=o.top+a&&s.y<=o.bottom+a;if(l&&this.emitEvent("tap",[i,n]),"mouseup"!=i.type){this.isIgnoringMouseUp=!0;var h=this;setTimeout(function(){delete h.isIgnoringMouseUp},400)}}},n.destroy=function(){this.pointerDone(),this.unbindTap()},i}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/prev-next-button",["./flickity","tap-listener/tap-listener","fizzy-ui-utils/utils"],function(i,n,s){return e(t,i,n,s)}):"object"==typeof module&&module.exports?module.exports=e(t,require("./flickity"),require("tap-listener"),require("fizzy-ui-utils")):e(t,t.Flickity,t.TapListener,t.fizzyUIUtils)}(window,function(t,e,i,n){"use strict";function s(t,e){this.direction=t,this.parent=e,this._create()}function o(t){return"string"==typeof t?t:"M "+t.x0+",50 L "+t.x1+","+(t.y1+50)+" L "+t.x2+","+(t.y2+50)+" L "+t.x3+",50  L "+t.x2+","+(50-t.y2)+" L "+t.x1+","+(50-t.y1)+" Z"}var r="http://www.w3.org/2000/svg";s.prototype=Object.create(i.prototype),s.prototype._create=function(){this.isEnabled=!0,this.isPrevious=this.direction==-1;var t=this.parent.options.rightToLeft?1:-1;this.isLeft=this.direction==t;var e=this.element=document.createElement("button");e.className="flickity-button flickity-prev-next-button",e.className+=this.isPrevious?" previous":" next",e.setAttribute("type","button"),this.disable(),e.setAttribute("aria-label",this.isPrevious?"Previous":"Next");var i=this.createSVG();e.appendChild(i),this.on("tap",this.onTap),this.parent.on("select",this.update.bind(this)),this.on("pointerDown",this.parent.childUIPointerDown.bind(this.parent))},s.prototype.activate=function(){this.bindTap(this.element),this.element.addEventListener("click",this),this.parent.element.appendChild(this.element)},s.prototype.deactivate=function(){this.parent.element.removeChild(this.element),i.prototype.destroy.call(this),this.element.removeEventListener("click",this)},s.prototype.createSVG=function(){var t=document.createElementNS(r,"svg");t.setAttribute("class","flickity-button-icon"),t.setAttribute("viewBox","0 0 100 100");var e=document.createElementNS(r,"path"),i=o(this.parent.options.arrowShape);return e.setAttribute("d",i),e.setAttribute("class","arrow"),this.isLeft||e.setAttribute("transform","translate(100, 100) rotate(180) "),t.appendChild(e),t},s.prototype.onTap=function(){if(this.isEnabled){this.parent.uiChange();var t=this.isPrevious?"previous":"next";this.parent[t]()}},s.prototype.handleEvent=n.handleEvent,s.prototype.onclick=function(t){var e=document.activeElement;e&&e==this.element&&this.onTap(t,t)},s.prototype.enable=function(){this.isEnabled||(this.element.disabled=!1,this.isEnabled=!0)},s.prototype.disable=function(){this.isEnabled&&(this.element.disabled=!0,this.isEnabled=!1)},s.prototype.update=function(){var t=this.parent.slides;if(this.parent.options.wrapAround&&t.length>1)return void this.enable();var e=t.length?t.length-1:0,i=this.isPrevious?0:e,n=this.parent.selectedIndex==i?"disable":"enable";this[n]()},s.prototype.destroy=function(){this.deactivate()},n.extend(e.defaults,{prevNextButtons:!0,arrowShape:{x0:10,x1:60,y1:50,x2:70,y2:40,x3:30}}),e.createMethods.push("_createPrevNextButtons");var a=e.prototype;return a._createPrevNextButtons=function(){this.options.prevNextButtons&&(this.prevButton=new s((-1),this),this.nextButton=new s(1,this),this.on("activate",this.activatePrevNextButtons))},a.activatePrevNextButtons=function(){this.prevButton.activate(),this.nextButton.activate(),this.on("deactivate",this.deactivatePrevNextButtons)},a.deactivatePrevNextButtons=function(){this.prevButton.deactivate(),this.nextButton.deactivate(),this.off("deactivate",this.deactivatePrevNextButtons)},e.PrevNextButton=s,e}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/page-dots",["./flickity","tap-listener/tap-listener","fizzy-ui-utils/utils"],function(i,n,s){return e(t,i,n,s)}):"object"==typeof module&&module.exports?module.exports=e(t,require("./flickity"),require("tap-listener"),require("fizzy-ui-utils")):e(t,t.Flickity,t.TapListener,t.fizzyUIUtils)}(window,function(t,e,i,n){function s(t){this.parent=t,this._create()}s.prototype=new i,s.prototype._create=function(){this.holder=document.createElement("ol"),this.holder.className="flickity-page-dots",this.dots=[],this.on("tap",this.onTap),this.on("pointerDown",this.parent.childUIPointerDown.bind(this.parent))},s.prototype.activate=function(){this.setDots(),this.bindTap(this.holder),this.parent.element.appendChild(this.holder)},s.prototype.deactivate=function(){this.parent.element.removeChild(this.holder),i.prototype.destroy.call(this)},s.prototype.setDots=function(){var t=this.parent.slides.length-this.dots.length;t>0?this.addDots(t):t<0&&this.removeDots(-t)},s.prototype.addDots=function(t){for(var e=document.createDocumentFragment(),i=[],n=this.dots.length,s=n+t,o=n;o<s;o++){var r=document.createElement("li");r.className="dot",r.setAttribute("aria-label","Page dot "+(o+1)),e.appendChild(r),i.push(r)}this.holder.appendChild(e),this.dots=this.dots.concat(i)},s.prototype.removeDots=function(t){var e=this.dots.splice(this.dots.length-t,t);e.forEach(function(t){this.holder.removeChild(t)},this)},s.prototype.updateSelected=function(){this.selectedDot&&(this.selectedDot.className="dot",this.selectedDot.removeAttribute("aria-current")),this.dots.length&&(this.selectedDot=this.dots[this.parent.selectedIndex],this.selectedDot.className="dot is-selected",this.selectedDot.setAttribute("aria-current","step"))},s.prototype.onTap=function(t){var e=t.target;if("LI"==e.nodeName){this.parent.uiChange();var i=this.dots.indexOf(e);this.parent.select(i)}},s.prototype.destroy=function(){this.deactivate()},e.PageDots=s,n.extend(e.defaults,{pageDots:!0}),e.createMethods.push("_createPageDots");var o=e.prototype;return o._createPageDots=function(){this.options.pageDots&&(this.pageDots=new s(this),this.on("activate",this.activatePageDots),this.on("select",this.updateSelectedPageDots),this.on("cellChange",this.updatePageDots),this.on("resize",this.updatePageDots),this.on("deactivate",this.deactivatePageDots))},o.activatePageDots=function(){this.pageDots.activate()},o.updateSelectedPageDots=function(){this.pageDots.updateSelected()},o.updatePageDots=function(){this.pageDots.setDots()},o.deactivatePageDots=function(){this.pageDots.deactivate()},e.PageDots=s,e}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/player",["ev-emitter/ev-emitter","fizzy-ui-utils/utils","./flickity"],function(t,i,n){return e(t,i,n)}):"object"==typeof module&&module.exports?module.exports=e(require("ev-emitter"),require("fizzy-ui-utils"),require("./flickity")):e(t.EvEmitter,t.fizzyUIUtils,t.Flickity)}(window,function(t,e,i){function n(t){this.parent=t,this.state="stopped",this.onVisibilityChange=this.visibilityChange.bind(this),this.onVisibilityPlay=this.visibilityPlay.bind(this)}n.prototype=Object.create(t.prototype),n.prototype.play=function(){if("playing"!=this.state){var t=document.hidden;if(t)return void document.addEventListener("visibilitychange",this.onVisibilityPlay);this.state="playing",document.addEventListener("visibilitychange",this.onVisibilityChange),this.tick()}},n.prototype.tick=function(){if("playing"==this.state){var t=this.parent.options.autoPlay;t="number"==typeof t?t:3e3;var e=this;this.clear(),this.timeout=setTimeout(function(){e.parent.next(!0),e.tick()},t)}},n.prototype.stop=function(){this.state="stopped",this.clear(),document.removeEventListener("visibilitychange",this.onVisibilityChange)},n.prototype.clear=function(){clearTimeout(this.timeout)},n.prototype.pause=function(){"playing"==this.state&&(this.state="paused",this.clear())},n.prototype.unpause=function(){"paused"==this.state&&this.play()},n.prototype.visibilityChange=function(){var t=document.hidden;this[t?"pause":"unpause"]()},n.prototype.visibilityPlay=function(){this.play(),document.removeEventListener("visibilitychange",this.onVisibilityPlay)},e.extend(i.defaults,{pauseAutoPlayOnHover:!0}),i.createMethods.push("_createPlayer");var s=i.prototype;return s._createPlayer=function(){this.player=new n(this),this.on("activate",this.activatePlayer),this.on("uiChange",this.stopPlayer),this.on("pointerDown",this.stopPlayer),this.on("deactivate",this.deactivatePlayer)},s.activatePlayer=function(){this.options.autoPlay&&(this.player.play(),this.element.addEventListener("mouseenter",this))},s.playPlayer=function(){this.player.play()},s.stopPlayer=function(){this.player.stop()},s.pausePlayer=function(){this.player.pause()},s.unpausePlayer=function(){this.player.unpause()},s.deactivatePlayer=function(){this.player.stop(),this.element.removeEventListener("mouseenter",this)},s.onmouseenter=function(){this.options.pauseAutoPlayOnHover&&(this.player.pause(),this.element.addEventListener("mouseleave",this))},s.onmouseleave=function(){this.player.unpause(),this.element.removeEventListener("mouseleave",this)},i.Player=n,i}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/add-remove-cell",["./flickity","fizzy-ui-utils/utils"],function(i,n){return e(t,i,n)}):"object"==typeof module&&module.exports?module.exports=e(t,require("./flickity"),require("fizzy-ui-utils")):e(t,t.Flickity,t.fizzyUIUtils)}(window,function(t,e,i){function n(t){var e=document.createDocumentFragment();return t.forEach(function(t){e.appendChild(t.element)}),e}var s=e.prototype;return s.insert=function(t,e){var i=this._makeCells(t);if(i&&i.length){var s=this.cells.length;e=void 0===e?s:e;var o=n(i),r=e==s;if(r)this.slider.appendChild(o);else{var a=this.cells[e].element;this.slider.insertBefore(o,a)}if(0===e)this.cells=i.concat(this.cells);else if(r)this.cells=this.cells.concat(i);else{var l=this.cells.splice(e,s-e);this.cells=this.cells.concat(i).concat(l)}this._sizeCells(i),this.cellChange(e,!0)}},s.append=function(t){this.insert(t,this.cells.length)},s.prepend=function(t){this.insert(t,0)},s.remove=function(t){var e=this.getCells(t);if(e&&e.length){var n=this.cells.length-1;e.forEach(function(t){t.remove();var e=this.cells.indexOf(t);n=Math.min(e,n),i.removeFrom(this.cells,t)},this),this.cellChange(n,!0)}},s.cellSizeChange=function(t){var e=this.getCell(t);if(e){e.getSize();var i=this.cells.indexOf(e);this.cellChange(i)}},s.cellChange=function(t,e){var i=this.selectedElement;this._positionCells(t),this._getWrapShiftCells(),this.setGallerySize();var n=this.getCell(i);n&&(this.selectedIndex=this.getCellSlideIndex(n)),this.selectedIndex=Math.min(this.slides.length-1,this.selectedIndex),this.emitEvent("cellChange",[t]),this.select(this.selectedIndex),e&&this.positionSliderAtSelected()},e}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/lazyload",["./flickity","fizzy-ui-utils/utils"],function(i,n){return e(t,i,n)}):"object"==typeof module&&module.exports?module.exports=e(t,require("./flickity"),require("fizzy-ui-utils")):e(t,t.Flickity,t.fizzyUIUtils)}(window,function(t,e,i){"use strict";function n(t){if("IMG"==t.nodeName){var e=t.getAttribute("data-flickity-lazyload"),n=t.getAttribute("data-flickity-lazyload-src"),s=t.getAttribute("data-flickity-lazyload-srcset");if(e||n||s)return[t]}var o="img[data-flickity-lazyload], img[data-flickity-lazyload-src], img[data-flickity-lazyload-srcset]",r=t.querySelectorAll(o);return i.makeArray(r)}function s(t,e){this.img=t,this.flickity=e,this.load()}e.createMethods.push("_createLazyload");var o=e.prototype;return o._createLazyload=function(){this.on("select",this.lazyLoad)},o.lazyLoad=function(){var t=this.options.lazyLoad;if(t){var e="number"==typeof t?t:0,i=this.getAdjacentCellElements(e),o=[];i.forEach(function(t){var e=n(t);o=o.concat(e)}),o.forEach(function(t){new s(t,this)},this)}},s.prototype.handleEvent=i.handleEvent,s.prototype.load=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this);var t=this.img.getAttribute("data-flickity-lazyload")||this.img.getAttribute("data-flickity-lazyload-src"),e=this.img.getAttribute("data-flickity-lazyload-srcset");this.img.src=t,e&&this.img.setAttribute("srcset",e),this.img.removeAttribute("data-flickity-lazyload"),this.img.removeAttribute("data-flickity-lazyload-src"),this.img.removeAttribute("data-flickity-lazyload-srcset")},s.prototype.onload=function(t){this.complete(t,"flickity-lazyloaded")},s.prototype.onerror=function(t){this.complete(t,"flickity-lazyerror")},s.prototype.complete=function(t,e){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this);var i=this.flickity.getParentCell(this.img),n=i&&i.element;this.flickity.cellSizeChange(n),this.img.classList.add(e),this.flickity.dispatchEvent("lazyLoad",t,n)},e.LazyLoader=s,e}),function(t,e){"function"==typeof define&&define.amd?define("flickity/js/index",["./flickity","./drag","./prev-next-button","./page-dots","./player","./add-remove-cell","./lazyload"],e):"object"==typeof module&&module.exports&&(module.exports=e(require("./flickity"),require("./drag"),require("./prev-next-button"),require("./page-dots"),require("./player"),require("./add-remove-cell"),require("./lazyload")))}(window,function(t){return t}),function(t,e){"function"==typeof define&&define.amd?define("flickity-as-nav-for/as-nav-for",["flickity/js/index","fizzy-ui-utils/utils"],e):"object"==typeof module&&module.exports?module.exports=e(require("flickity"),require("fizzy-ui-utils")):t.Flickity=e(t.Flickity,t.fizzyUIUtils)}(window,function(t,e){function i(t,e,i){return(e-t)*i+t}t.createMethods.push("_createAsNavFor");var n=t.prototype;return n._createAsNavFor=function(){this.on("activate",this.activateAsNavFor),this.on("deactivate",this.deactivateAsNavFor),this.on("destroy",this.destroyAsNavFor);var t=this.options.asNavFor;if(t){var e=this;setTimeout(function(){e.setNavCompanion(t)})}},n.setNavCompanion=function(i){i=e.getQueryElement(i);var n=t.data(i);if(n&&n!=this){this.navCompanion=n;var s=this;this.onNavCompanionSelect=function(){s.navCompanionSelect()},n.on("select",this.onNavCompanionSelect),this.on("staticClick",this.onNavStaticClick),this.navCompanionSelect(!0)}},n.navCompanionSelect=function(t){if(this.navCompanion){var e=this.navCompanion.selectedCells[0],n=this.navCompanion.cells.indexOf(e),s=n+this.navCompanion.selectedCells.length-1,o=Math.floor(i(n,s,this.navCompanion.cellAlign));if(this.selectCell(o,!1,t),this.removeNavSelectedElements(),!(o>=this.cells.length)){var r=this.cells.slice(n,s+1);this.navSelectedElements=r.map(function(t){return t.element}),this.changeNavSelectedClass("add")}}},n.changeNavSelectedClass=function(t){this.navSelectedElements.forEach(function(e){e.classList[t]("is-nav-selected")})},n.activateAsNavFor=function(){this.navCompanionSelect(!0)},n.removeNavSelectedElements=function(){this.navSelectedElements&&(this.changeNavSelectedClass("remove"),delete this.navSelectedElements)},n.onNavStaticClick=function(t,e,i,n){"number"==typeof n&&this.navCompanion.selectCell(n)},n.deactivateAsNavFor=function(){this.removeNavSelectedElements()},n.destroyAsNavFor=function(){this.navCompanion&&(this.navCompanion.off("select",this.onNavCompanionSelect),this.off("staticClick",this.onNavStaticClick),delete this.navCompanion)},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("imagesloaded/imagesloaded",["ev-emitter/ev-emitter"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter")):t.imagesLoaded=e(t,t.EvEmitter)}("undefined"!=typeof window?window:this,function(t,e){function i(t,e){for(var i in e)t[i]=e[i];return t}function n(t){if(Array.isArray(t))return t;var e="object"==typeof t&&"number"==typeof t.length;return e?h.call(t):[t]}function s(t,e,o){if(!(this instanceof s))return new s(t,e,o);var r=t;return"string"==typeof t&&(r=document.querySelectorAll(t)),r?(this.elements=n(r),this.options=i({},this.options),"function"==typeof e?o=e:i(this.options,e),o&&this.on("always",o),this.getImages(),a&&(this.jqDeferred=new a.Deferred),void setTimeout(this.check.bind(this))):void l.error("Bad element for imagesLoaded "+(r||t))}function o(t){this.img=t}function r(t,e){this.url=t,this.element=e,this.img=new Image}var a=t.jQuery,l=t.console,h=Array.prototype.slice;s.prototype=Object.create(e.prototype),s.prototype.options={},s.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},s.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),this.options.background===!0&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&c[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var s=i[n];this.addImage(s)}if("string"==typeof this.options.background){var o=t.querySelectorAll(this.options.background);for(n=0;n<o.length;n++){var r=o[n];this.addElementBackgroundImages(r)}}}};var c={1:!0,9:!0,11:!0};return s.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var s=n&&n[2];s&&this.addBackground(s,t),n=i.exec(e.backgroundImage)}},s.prototype.addImage=function(t){var e=new o(t);this.images.push(e)},s.prototype.addBackground=function(t,e){var i=new r(t,e);this.images.push(i)},s.prototype.check=function(){function t(t,i,n){setTimeout(function(){e.progress(t,i,n)})}var e=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},s.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&l&&l.log("progress: "+i,t,e)},s.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},o.prototype=Object.create(e.prototype),o.prototype.check=function(){var t=this.getIsImageComplete();return t?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},o.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},o.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},o.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},o.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},o.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},o.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype=Object.create(o.prototype),r.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var t=this.getIsImageComplete();t&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},r.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},s.makeJQueryPlugin=function(e){e=e||t.jQuery,e&&(a=e,a.fn.imagesLoaded=function(t,e){var i=new s(this,t,e);return i.jqDeferred.promise(a(this))})},s.makeJQueryPlugin(),s}),function(t,e){"function"==typeof define&&define.amd?define(["flickity/js/index","imagesloaded/imagesloaded"],function(i,n){return e(t,i,n)}):"object"==typeof module&&module.exports?module.exports=e(t,require("flickity"),require("imagesloaded")):t.Flickity=e(t,t.Flickity,t.imagesLoaded)}(window,function(t,e,i){"use strict";e.createMethods.push("_createImagesLoaded");var n=e.prototype;return n._createImagesLoaded=function(){this.on("activate",this.imagesLoaded)},n.imagesLoaded=function(){function t(t,i){var n=e.getParentCell(i.img);e.cellSizeChange(n&&n.element),e.options.freeScroll||e.positionSliderAtSelected()}if(this.options.imagesLoaded){var e=this;i(this.slider).on("progress",t)}},e});
(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
	typeof define === 'function' && define.amd ? define(factory) :
	(global.IMask = factory());
}(this, (function () { 'use strict';

// 7.2.1 RequireObjectCoercible(argument)
var _defined = function (it) {
  if (it == undefined) throw TypeError("Can't call method on  " + it);
  return it;
};

// 7.1.13 ToObject(argument)

var _toObject = function (it) {
  return Object(_defined(it));
};

var hasOwnProperty = {}.hasOwnProperty;
var _has = function (it, key) {
  return hasOwnProperty.call(it, key);
};

var toString = {}.toString;

var _cof = function (it) {
  return toString.call(it).slice(8, -1);
};

// fallback for non-array-like ES3 and non-enumerable old V8 strings

// eslint-disable-next-line no-prototype-builtins
var _iobject = Object('z').propertyIsEnumerable(0) ? Object : function (it) {
  return _cof(it) == 'String' ? it.split('') : Object(it);
};

// to indexed object, toObject with fallback for non-array-like ES3 strings


var _toIobject = function (it) {
  return _iobject(_defined(it));
};

// 7.1.4 ToInteger
var ceil = Math.ceil;
var floor = Math.floor;
var _toInteger = function (it) {
  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);
};

// 7.1.15 ToLength

var min = Math.min;
var _toLength = function (it) {
  return it > 0 ? min(_toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991
};

var max = Math.max;
var min$1 = Math.min;
var _toAbsoluteIndex = function (index, length) {
  index = _toInteger(index);
  return index < 0 ? max(index + length, 0) : min$1(index, length);
};

// false -> Array#indexOf
// true  -> Array#includes



var _arrayIncludes = function (IS_INCLUDES) {
  return function ($this, el, fromIndex) {
    var O = _toIobject($this);
    var length = _toLength(O.length);
    var index = _toAbsoluteIndex(fromIndex, length);
    var value;
    // Array#includes uses SameValueZero equality algorithm
    // eslint-disable-next-line no-self-compare
    if (IS_INCLUDES && el != el) while (length > index) {
      value = O[index++];
      // eslint-disable-next-line no-self-compare
      if (value != value) return true;
    // Array#indexOf ignores holes, Array#includes - not
    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {
      if (O[index] === el) return IS_INCLUDES || index || 0;
    } return !IS_INCLUDES && -1;
  };
};

function createCommonjsModule(fn, module) {
	return module = { exports: {} }, fn(module, module.exports), module.exports;
}

var _global = createCommonjsModule(function (module) {
// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028
var global = module.exports = typeof window != 'undefined' && window.Math == Math
  ? window : typeof self != 'undefined' && self.Math == Math ? self
  // eslint-disable-next-line no-new-func
  : Function('return this')();
if (typeof __g == 'number') __g = global; // eslint-disable-line no-undef
});

var SHARED = '__core-js_shared__';
var store = _global[SHARED] || (_global[SHARED] = {});
var _shared = function (key) {
  return store[key] || (store[key] = {});
};

var id = 0;
var px = Math.random();
var _uid = function (key) {
  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));
};

var shared = _shared('keys');

var _sharedKey = function (key) {
  return shared[key] || (shared[key] = _uid(key));
};

var arrayIndexOf = _arrayIncludes(false);
var IE_PROTO = _sharedKey('IE_PROTO');

var _objectKeysInternal = function (object, names) {
  var O = _toIobject(object);
  var i = 0;
  var result = [];
  var key;
  for (key in O) if (key != IE_PROTO) _has(O, key) && result.push(key);
  // Don't enum bug & hidden keys
  while (names.length > i) if (_has(O, key = names[i++])) {
    ~arrayIndexOf(result, key) || result.push(key);
  }
  return result;
};

// IE 8- don't enum bug keys
var _enumBugKeys = (
  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'
).split(',');

// 19.1.2.14 / 15.2.3.14 Object.keys(O)



var _objectKeys = Object.keys || function keys(O) {
  return _objectKeysInternal(O, _enumBugKeys);
};

var _core = createCommonjsModule(function (module) {
var core = module.exports = { version: '2.5.3' };
if (typeof __e == 'number') __e = core; // eslint-disable-line no-undef
});

var _core_1 = _core.version;

var _isObject = function (it) {
  return typeof it === 'object' ? it !== null : typeof it === 'function';
};

var _anObject = function (it) {
  if (!_isObject(it)) throw TypeError(it + ' is not an object!');
  return it;
};

var _fails = function (exec) {
  try {
    return !!exec();
  } catch (e) {
    return true;
  }
};

// Thank's IE8 for his funny defineProperty
var _descriptors = !_fails(function () {
  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;
});

var document$1 = _global.document;
// typeof document.createElement is 'object' in old IE
var is = _isObject(document$1) && _isObject(document$1.createElement);
var _domCreate = function (it) {
  return is ? document$1.createElement(it) : {};
};

var _ie8DomDefine = !_descriptors && !_fails(function () {
  return Object.defineProperty(_domCreate('div'), 'a', { get: function () { return 7; } }).a != 7;
});

// 7.1.1 ToPrimitive(input [, PreferredType])

// instead of the ES6 spec version, we didn't implement @@toPrimitive case
// and the second argument - flag - preferred type is a string
var _toPrimitive = function (it, S) {
  if (!_isObject(it)) return it;
  var fn, val;
  if (S && typeof (fn = it.toString) == 'function' && !_isObject(val = fn.call(it))) return val;
  if (typeof (fn = it.valueOf) == 'function' && !_isObject(val = fn.call(it))) return val;
  if (!S && typeof (fn = it.toString) == 'function' && !_isObject(val = fn.call(it))) return val;
  throw TypeError("Can't convert object to primitive value");
};

var dP = Object.defineProperty;

var f = _descriptors ? Object.defineProperty : function defineProperty(O, P, Attributes) {
  _anObject(O);
  P = _toPrimitive(P, true);
  _anObject(Attributes);
  if (_ie8DomDefine) try {
    return dP(O, P, Attributes);
  } catch (e) { /* empty */ }
  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');
  if ('value' in Attributes) O[P] = Attributes.value;
  return O;
};

var _objectDp = {
	f: f
};

var _propertyDesc = function (bitmap, value) {
  return {
    enumerable: !(bitmap & 1),
    configurable: !(bitmap & 2),
    writable: !(bitmap & 4),
    value: value
  };
};

var _hide = _descriptors ? function (object, key, value) {
  return _objectDp.f(object, key, _propertyDesc(1, value));
} : function (object, key, value) {
  object[key] = value;
  return object;
};

var _redefine = createCommonjsModule(function (module) {
var SRC = _uid('src');
var TO_STRING = 'toString';
var $toString = Function[TO_STRING];
var TPL = ('' + $toString).split(TO_STRING);

_core.inspectSource = function (it) {
  return $toString.call(it);
};

(module.exports = function (O, key, val, safe) {
  var isFunction = typeof val == 'function';
  if (isFunction) _has(val, 'name') || _hide(val, 'name', key);
  if (O[key] === val) return;
  if (isFunction) _has(val, SRC) || _hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));
  if (O === _global) {
    O[key] = val;
  } else if (!safe) {
    delete O[key];
    _hide(O, key, val);
  } else if (O[key]) {
    O[key] = val;
  } else {
    _hide(O, key, val);
  }
// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative
})(Function.prototype, TO_STRING, function toString() {
  return typeof this == 'function' && this[SRC] || $toString.call(this);
});
});

var _aFunction = function (it) {
  if (typeof it != 'function') throw TypeError(it + ' is not a function!');
  return it;
};

// optional / simple context binding

var _ctx = function (fn, that, length) {
  _aFunction(fn);
  if (that === undefined) return fn;
  switch (length) {
    case 1: return function (a) {
      return fn.call(that, a);
    };
    case 2: return function (a, b) {
      return fn.call(that, a, b);
    };
    case 3: return function (a, b, c) {
      return fn.call(that, a, b, c);
    };
  }
  return function (/* ...args */) {
    return fn.apply(that, arguments);
  };
};

var PROTOTYPE = 'prototype';

var $export = function (type, name, source) {
  var IS_FORCED = type & $export.F;
  var IS_GLOBAL = type & $export.G;
  var IS_STATIC = type & $export.S;
  var IS_PROTO = type & $export.P;
  var IS_BIND = type & $export.B;
  var target = IS_GLOBAL ? _global : IS_STATIC ? _global[name] || (_global[name] = {}) : (_global[name] || {})[PROTOTYPE];
  var exports = IS_GLOBAL ? _core : _core[name] || (_core[name] = {});
  var expProto = exports[PROTOTYPE] || (exports[PROTOTYPE] = {});
  var key, own, out, exp;
  if (IS_GLOBAL) source = name;
  for (key in source) {
    // contains in native
    own = !IS_FORCED && target && target[key] !== undefined;
    // export native or passed
    out = (own ? target : source)[key];
    // bind timers to global for call from export context
    exp = IS_BIND && own ? _ctx(out, _global) : IS_PROTO && typeof out == 'function' ? _ctx(Function.call, out) : out;
    // extend global
    if (target) _redefine(target, key, out, type & $export.U);
    // export
    if (exports[key] != out) _hide(exports, key, exp);
    if (IS_PROTO && expProto[key] != out) expProto[key] = out;
  }
};
_global.core = _core;
// type bitmap
$export.F = 1;   // forced
$export.G = 2;   // global
$export.S = 4;   // static
$export.P = 8;   // proto
$export.B = 16;  // bind
$export.W = 32;  // wrap
$export.U = 64;  // safe
$export.R = 128; // real proto method for `library`
var _export = $export;

// most Object methods by ES6 should accept primitives



var _objectSap = function (KEY, exec) {
  var fn = (_core.Object || {})[KEY] || Object[KEY];
  var exp = {};
  exp[KEY] = exec(fn);
  _export(_export.S + _export.F * _fails(function () { fn(1); }), 'Object', exp);
};

// 19.1.2.14 Object.keys(O)



_objectSap('keys', function () {
  return function keys(it) {
    return _objectKeys(_toObject(it));
  };
});

var keys = _core.Object.keys;

var _stringRepeat = function repeat(count) {
  var str = String(_defined(this));
  var res = '';
  var n = _toInteger(count);
  if (n < 0 || n == Infinity) throw RangeError("Count can't be negative");
  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) res += str;
  return res;
};

_export(_export.P, 'String', {
  // 21.1.3.13 String.prototype.repeat(count)
  repeat: _stringRepeat
});

var repeat$1 = _core.String.repeat;

// https://github.com/tc39/proposal-string-pad-start-end




var _stringPad = function (that, maxLength, fillString, left) {
  var S = String(_defined(that));
  var stringLength = S.length;
  var fillStr = fillString === undefined ? ' ' : String(fillString);
  var intMaxLength = _toLength(maxLength);
  if (intMaxLength <= stringLength || fillStr == '') return S;
  var fillLen = intMaxLength - stringLength;
  var stringFiller = _stringRepeat.call(fillStr, Math.ceil(fillLen / fillStr.length));
  if (stringFiller.length > fillLen) stringFiller = stringFiller.slice(0, fillLen);
  return left ? stringFiller + S : S + stringFiller;
};

var navigator = _global.navigator;

var _userAgent = navigator && navigator.userAgent || '';

// https://github.com/tc39/proposal-string-pad-start-end




// https://github.com/zloirock/core-js/issues/280
_export(_export.P + _export.F * /Version\/10\.\d+(\.\d+)? Safari\//.test(_userAgent), 'String', {
  padStart: function padStart(maxLength /* , fillString = ' ' */) {
    return _stringPad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, true);
  }
});

var padStart = _core.String.padStart;

// https://github.com/tc39/proposal-string-pad-start-end




// https://github.com/zloirock/core-js/issues/280
_export(_export.P + _export.F * /Version\/10\.\d+(\.\d+)? Safari\//.test(_userAgent), 'String', {
  padEnd: function padEnd(maxLength /* , fillString = ' ' */) {
    return _stringPad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, false);
  }
});

var padEnd = _core.String.padEnd;

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
  return typeof obj;
} : function (obj) {
  return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
};











var classCallCheck = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};

var createClass = function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
}();







var _extends = Object.assign || function (target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i];

    for (var key in source) {
      if (Object.prototype.hasOwnProperty.call(source, key)) {
        target[key] = source[key];
      }
    }
  }

  return target;
};

var get = function get(object, property, receiver) {
  if (object === null) object = Function.prototype;
  var desc = Object.getOwnPropertyDescriptor(object, property);

  if (desc === undefined) {
    var parent = Object.getPrototypeOf(object);

    if (parent === null) {
      return undefined;
    } else {
      return get(parent, property, receiver);
    }
  } else if ("value" in desc) {
    return desc.value;
  } else {
    var getter = desc.get;

    if (getter === undefined) {
      return undefined;
    }

    return getter.call(receiver);
  }
};

var inherits = function (subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
  }

  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      enumerable: false,
      writable: true,
      configurable: true
    }
  });
  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
};











var possibleConstructorReturn = function (self, call) {
  if (!self) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return call && (typeof call === "object" || typeof call === "function") ? call : self;
};



var set = function set(object, property, value, receiver) {
  var desc = Object.getOwnPropertyDescriptor(object, property);

  if (desc === undefined) {
    var parent = Object.getPrototypeOf(object);

    if (parent !== null) {
      set(parent, property, value, receiver);
    }
  } else if ("value" in desc && desc.writable) {
    desc.value = value;
  } else {
    var setter = desc.set;

    if (setter !== undefined) {
      setter.call(receiver, value);
    }
  }

  return value;
};

var slicedToArray = function () {
  function sliceIterator(arr, i) {
    var _arr = [];
    var _n = true;
    var _d = false;
    var _e = undefined;

    try {
      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
        _arr.push(_s.value);

        if (i && _arr.length === i) break;
      }
    } catch (err) {
      _d = true;
      _e = err;
    } finally {
      try {
        if (!_n && _i["return"]) _i["return"]();
      } finally {
        if (_d) throw _e;
      }
    }

    return _arr;
  }

  return function (arr, i) {
    if (Array.isArray(arr)) {
      return arr;
    } else if (Symbol.iterator in Object(arr)) {
      return sliceIterator(arr, i);
    } else {
      throw new TypeError("Invalid attempt to destructure non-iterable instance");
    }
  };
}();













var toConsumableArray = function (arr) {
  if (Array.isArray(arr)) {
    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];

    return arr2;
  } else {
    return Array.from(arr);
  }
};

/** Checks if value is string */
function isString(str) {
  return typeof str === 'string' || str instanceof String;
}

/** Conforms string with fallback */
function conform(res, str) {
  var fallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';

  return isString(res) ? res : res ? str : fallback;
}

/**
  Direction
  @prop {number} NONE
  @prop {number} LEFT
  @prop {number} RIGHT
*/
var DIRECTION = {
  NONE: 0,
  LEFT: -1,
  RIGHT: 1
  /**
    Direction
    @enum {number}
  */
};

/** Returns next char position in direction */
function indexInDirection(pos, direction) {
  if (direction === DIRECTION.LEFT) --pos;
  return pos;
}

/** Escapes regular expression control chars */
function escapeRegExp(str) {
  return str.replace(/([.*+?^=!:${}()|[\]/\\])/g, '\\$1');
}

// cloned from https://github.com/epoberezkin/fast-deep-equal with small changes
function objectIncludes(b, a) {
  if (a === b) return true;

  var arrA = Array.isArray(a),
      arrB = Array.isArray(b),
      i;

  if (arrA && arrB) {
    if (a.length != b.length) return false;
    for (i = 0; i < a.length; i++) {
      if (!objectIncludes(a[i], b[i])) return false;
    }return true;
  }

  if (arrA != arrB) return false;

  if (a && b && (typeof a === 'undefined' ? 'undefined' : _typeof(a)) === 'object' && (typeof b === 'undefined' ? 'undefined' : _typeof(b)) === 'object') {
    var keys = Object.keys(a);
    // if (keys.length !== Object.keys(b).length) return false;

    var dateA = a instanceof Date,
        dateB = b instanceof Date;
    if (dateA && dateB) return a.getTime() == b.getTime();
    if (dateA != dateB) return false;

    var regexpA = a instanceof RegExp,
        regexpB = b instanceof RegExp;
    if (regexpA && regexpB) return a.toString() == b.toString();
    if (regexpA != regexpB) return false;

    for (i = 0; i < keys.length; i++) {
      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;
    }for (i = 0; i < keys.length; i++) {
      if (!objectIncludes(a[keys[i]], b[keys[i]])) return false;
    }return true;
  }

  return false;
}

/* eslint-disable no-undef */
var g = typeof window !== 'undefined' && window || typeof global !== 'undefined' && global.global === global && global || typeof self !== 'undefined' && self.self === self && self || {};
/* eslint-enable no-undef */

/** Selection range */

/** Provides details of changing input */

var ActionDetails = function () {
  /** Old input value */

  /** Current input value */
  function ActionDetails(value, cursorPos, oldValue, oldSelection) {
    classCallCheck(this, ActionDetails);

    this.value = value;
    this.cursorPos = cursorPos;
    this.oldValue = oldValue;
    this.oldSelection = oldSelection;

    // double check if left part was changed (autofilling, other non-standard input triggers)
    while (this.value.slice(0, this.startChangePos) !== this.oldValue.slice(0, this.startChangePos)) {
      --this.oldSelection.start;
    }
  }

  /**
    Start changing position
    @readonly
  */

  /** Old selection */

  /** Current cursor position */


  createClass(ActionDetails, [{
    key: 'startChangePos',
    get: function get$$1() {
      return Math.min(this.cursorPos, this.oldSelection.start);
    }

    /**
      Inserted symbols count
      @readonly
    */

  }, {
    key: 'insertedCount',
    get: function get$$1() {
      return this.cursorPos - this.startChangePos;
    }

    /**
      Inserted symbols
      @readonly
    */

  }, {
    key: 'inserted',
    get: function get$$1() {
      return this.value.substr(this.startChangePos, this.insertedCount);
    }

    /**
      Removed symbols count
      @readonly
    */

  }, {
    key: 'removedCount',
    get: function get$$1() {
      // Math.max for opposite operation
      return Math.max(this.oldSelection.end - this.startChangePos ||
      // for Delete
      this.oldValue.length - this.value.length, 0);
    }

    /**
      Removed symbols
      @readonly
    */

  }, {
    key: 'removed',
    get: function get$$1() {
      return this.oldValue.substr(this.startChangePos, this.removedCount);
    }

    /**
      Unchanged head symbols
      @readonly
    */

  }, {
    key: 'head',
    get: function get$$1() {
      return this.value.substring(0, this.startChangePos);
    }

    /**
      Unchanged tail symbols
      @readonly
    */

  }, {
    key: 'tail',
    get: function get$$1() {
      return this.value.substring(this.startChangePos + this.insertedCount);
    }

    /**
      Remove direction
      @readonly
    */

  }, {
    key: 'removeDirection',
    get: function get$$1() {
      if (!this.removedCount || this.insertedCount) return DIRECTION.NONE;

      // align right if delete at right or if range removed (event with backspace)
      return this.oldSelection.end === this.cursorPos || this.oldSelection.start === this.cursorPos ? DIRECTION.RIGHT : DIRECTION.LEFT;
    }
  }]);
  return ActionDetails;
}();

/**
  Provides details of changing model value
  @param {Object} [details]
  @param {string} [details.inserted] - Inserted symbols
  @param {boolean} [details.overflow] - Is overflowed
  @param {number} [details.removeCount] - Removed symbols count
  @param {number} [details.shift] - Additional offset if any changes occurred before current position
*/
var ChangeDetails = function () {
  /** Additional offset if any changes occurred before current position */

  /** Inserted symbols */
  function ChangeDetails(details) {
    classCallCheck(this, ChangeDetails);

    _extends(this, {
      inserted: '',
      overflow: false,
      shift: 0
    }, details);
  }

  /**
    Aggregate changes
    @returns {ChangeDetails} `this`
  */

  /** Is overflowed */


  createClass(ChangeDetails, [{
    key: 'aggregate',
    value: function aggregate(details) {
      if (details.rawInserted) this.rawInserted += details.rawInserted;
      this.inserted += details.inserted;
      this.shift += details.shift;
      this.overflow = this.overflow || details.overflow;
      return this;
    }

    /** Total offset considering all changes */

  }, {
    key: 'offset',
    get: function get$$1() {
      return this.shift + this.inserted.length;
    }

    /** Raw inserted is used by dynamic mask */

  }, {
    key: 'rawInserted',
    get: function get$$1() {
      return this._rawInserted != null ? this._rawInserted : this.inserted;
    },
    set: function set$$1(rawInserted) {
      this._rawInserted = rawInserted;
    }
  }]);
  return ChangeDetails;
}();

/** Supported mask type */


/** Append flags */


/** Extract flags */

/** Provides common masking stuff */
var Masked = function () {
  /** Does additional processing in the end of editing */

  /** Transforms value before mask processing */
  function Masked(opts) {
    classCallCheck(this, Masked);

    this._value = '';
    this._update(_extends({}, Masked.DEFAULTS, opts));
    this.isInitialized = true;
  }

  /** Sets and applies new options */

  /** */

  /** Validates if value is acceptable */
  // $Shape<MaskedOptions>; TODO after fix https://github.com/facebook/flow/issues/4773

  /** @type {Mask} */


  createClass(Masked, [{
    key: 'updateOptions',
    value: function updateOptions(opts) {
      this.withValueRefresh(this._update.bind(this, opts));
    }

    /**
      Sets new options
      @protected
    */

  }, {
    key: '_update',
    value: function _update(opts) {
      _extends(this, opts);
    }

    /** Clones masked with options and value */

  }, {
    key: 'clone',
    value: function clone() {
      var m = new Masked(this);
      m._value = this.value.slice();
      return m;
    }

    /** */

  }, {
    key: 'assign',
    value: function assign(source) {
      // $FlowFixMe
      return _extends(this, source);
    }

    /** Resets value */

  }, {
    key: 'reset',
    value: function reset() {
      this._value = '';
    }

    /** */

  }, {
    key: 'resolve',


    /** Resolve new value */
    value: function resolve(value) {
      this.reset();
      this._append(value, { input: true });
      this._appendTail();
      this.doCommit();
      return this.value;
    }

    /** */

  }, {
    key: 'nearestInputPos',


    /** Finds nearest input position in direction */
    value: function nearestInputPos(cursorPos, direction) {
      return cursorPos;
    }

    /** Extracts value in range considering flags */

  }, {
    key: 'extractInput',
    value: function extractInput() {
      var fromPos = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var toPos = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.value.length;
      return this.value.slice(fromPos, toPos);
    }

    /** Extracts tail in range */

  }, {
    key: '_extractTail',
    value: function _extractTail() {
      var fromPos = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var toPos = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.value.length;

      return {
        value: this.extractInput(fromPos, toPos),
        fromPos: fromPos,
        toPos: toPos
      };
    }

    /** Appends tail */

  }, {
    key: '_appendTail',
    value: function _appendTail(tail) {
      return this._append(tail ? tail.value : '', { tail: true });
    }

    /** Appends symbols considering flags */

  }, {
    key: '_append',
    value: function _append(str) {
      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      var oldValueLength = this.value.length;
      var consistentValue = this.clone();
      var overflow = false;

      str = this.doPrepare(str, flags);

      for (var ci = 0; ci < str.length; ++ci) {
        this._value += str[ci];
        if (this.doValidate(flags) === false) {
          this.assign(consistentValue);
          if (!flags.input) {
            // in `input` mode dont skip invalid chars
            overflow = true;
            break;
          }
        }

        consistentValue = this.clone();
      }

      return new ChangeDetails({
        inserted: this.value.slice(oldValueLength),
        overflow: overflow
      });
    }

    /** Appends symbols considering tail */

  }, {
    key: 'appendWithTail',
    value: function appendWithTail(str, tail) {
      // TODO refactor
      var aggregateDetails = new ChangeDetails();
      var consistentValue = this.clone();
      var consistentAppended = void 0;

      for (var ci = 0; ci < str.length; ++ci) {
        var ch = str[ci];

        var appendDetails = this._append(ch, { input: true });
        consistentAppended = this.clone();
        var tailAppended = !appendDetails.overflow && !this._appendTail(tail).overflow;
        if (!tailAppended || this.doValidate({ tail: true }) === false) {
          this.assign(consistentValue);
          break;
        }

        this.assign(consistentAppended);
        consistentValue = this.clone();
        aggregateDetails.aggregate(appendDetails);
      }

      // TODO needed for cases when
      // 1) REMOVE ONLY AND NO LOOP AT ALL
      // 2) last loop iteration removes tail
      // 3) when breaks on tail insert

      // aggregate only shift from tail
      aggregateDetails.shift += this._appendTail(tail).shift;

      return aggregateDetails;
    }

    /** */

  }, {
    key: 'remove',
    value: function remove() {
      var from = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var count = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.value.length - from;

      this._value = this.value.slice(0, from) + this.value.slice(from + count);
      return new ChangeDetails();
    }

    /** Calls function and reapplies current value */

  }, {
    key: 'withValueRefresh',
    value: function withValueRefresh(fn) {
      if (this._refreshing || !this.isInitialized) return fn();
      this._refreshing = true;

      var unmasked = this.unmaskedValue;

      var ret = fn();

      this.unmaskedValue = unmasked;

      delete this._refreshing;
      return ret;
    }

    /**
      Prepares string before mask processing
      @protected
    */

  }, {
    key: 'doPrepare',
    value: function doPrepare(str) {
      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      return this.prepare(str, this, flags);
    }

    /**
      Validates if value is acceptable
      @protected
    */

  }, {
    key: 'doValidate',
    value: function doValidate(flags) {
      return this.validate(this.value, this, flags);
    }

    /**
      Does additional processing in the end of editing
      @protected
    */

  }, {
    key: 'doCommit',
    value: function doCommit() {
      this.commit(this.value, this);
    }

    // TODO
    // insert (str, fromPos, flags)

    /** */

  }, {
    key: 'splice',
    value: function splice(start, deleteCount, inserted, removeDirection) {
      var tailPos = start + deleteCount;
      var tail = this._extractTail(tailPos);

      var startChangePos = this.nearestInputPos(start, removeDirection);
      var changeDetails = new ChangeDetails({
        shift: startChangePos - start // adjust shift if start was aligned
      }).aggregate(this.remove(startChangePos)).aggregate(this.appendWithTail(inserted, tail));

      return changeDetails;
    }
  }, {
    key: 'value',
    get: function get$$1() {
      return this._value;
    },
    set: function set$$1(value) {
      this.resolve(value);
    }
  }, {
    key: 'unmaskedValue',
    get: function get$$1() {
      return this.value;
    },
    set: function set$$1(value) {
      this.reset();
      this._append(value);
      this._appendTail();
      this.doCommit();
    }

    /** Value that includes raw user input */

  }, {
    key: 'rawInputValue',
    get: function get$$1() {
      return this.extractInput(0, this.value.length, { raw: true });
    },
    set: function set$$1(value) {
      this.reset();
      this._append(value, { raw: true });
      this._appendTail();
      this.doCommit();
    }

    /** */

  }, {
    key: 'isComplete',
    get: function get$$1() {
      return true;
    }
  }]);
  return Masked;
}();

Masked.DEFAULTS = {
  prepare: function prepare(val) {
    return val;
  },
  validate: function validate() {
    return true;
  },
  commit: function commit() {}
};

/** Get Masked class by mask type */
function maskedClass(mask) {
  if (mask == null) {
    throw new Error('mask property should be defined');
  }

  if (mask instanceof RegExp) return g.IMask.MaskedRegExp;
  if (isString(mask)) return g.IMask.MaskedPattern;
  if (mask instanceof Date || mask === Date) return g.IMask.MaskedDate;
  if (mask instanceof Number || typeof mask === 'number' || mask === Number) return g.IMask.MaskedNumber;
  if (Array.isArray(mask) || mask === Array) return g.IMask.MaskedDynamic;
  // $FlowFixMe
  if (mask.prototype instanceof g.IMask.Masked) return mask;
  // $FlowFixMe
  if (mask instanceof Function) return g.IMask.MaskedFunction;

  console.warn('Mask not found for mask', mask); // eslint-disable-line no-console
  return g.IMask.Masked;
}

/** Creates new {@link Masked} depending on mask type */
function createMask(opts) {
  opts = _extends({}, opts); // clone
  var mask = opts.mask;

  if (mask instanceof g.IMask.Masked) return mask;

  var MaskedClass = maskedClass(mask);
  return new MaskedClass(opts);
}

/** */

/** */
var PatternDefinition = function () {
  /** */

  /** */

  /** */
  function PatternDefinition(opts) {
    classCallCheck(this, PatternDefinition);
    // TODO flow
    _extends(this, opts);

    if (this.mask) {
      this._masked = createMask(opts);
    }
  }

  /** */

  /** */

  /** */

  /** */


  /** */


  createClass(PatternDefinition, [{
    key: 'reset',
    value: function reset() {
      this.isHollow = false;
      this.isRawInput = false;
      if (this._masked) this._masked.reset();
    }

    /** */

  }, {
    key: 'resolve',


    /** */
    value: function resolve(ch) {
      if (!this._masked) return false;
      return this._masked.resolve(ch);
    }
  }, {
    key: 'isInput',
    get: function get$$1() {
      return this.type === PatternDefinition.TYPES.INPUT;
    }

    /** */

  }, {
    key: 'isHiddenHollow',
    get: function get$$1() {
      return this.isHollow && this.optional;
    }
  }]);
  return PatternDefinition;
}();

PatternDefinition.DEFAULTS = {
  '0': /\d/,
  'a': /[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/, // http://stackoverflow.com/a/22075070
  '*': /./
};
/**
  @prop {string} INPUT
  @prop {string} FIXED
*/
PatternDefinition.TYPES = {
  INPUT: 'input',
  FIXED: 'fixed'
};

/** */


/** */

/**
  Pattern group symbols from parent
  @param {MaskedPattern} masked - Internal {@link masked} model
  @param {Object} opts
  @param {string} opts.name - Group name
  @param {number} opts.offset - Group offset in masked definitions array
  @param {string} opts.mask - Group mask
  @param {Function} [opts.validate] - Custom group validator
*/
var PatternGroup = function () {
  /** Group mask */

  /** Group name */

  /** */
  function PatternGroup(masked, _ref) {
    var name = _ref.name,
        offset = _ref.offset,
        mask = _ref.mask,
        validate = _ref.validate;
    classCallCheck(this, PatternGroup);

    this.masked = masked;
    this.name = name;
    this.offset = offset;
    this.mask = mask;
    this.validate = validate || function () {
      return true;
    };
  }

  /** Slice of internal {@link masked} value */

  /** Custom group validator */

  /** Group offset in masked definitions array */


  /** Internal {@link masked} model */

  /** */


  createClass(PatternGroup, [{
    key: 'doValidate',


    /** Validates if current value is acceptable */
    value: function doValidate(flags) {
      return this.validate(this.value, this, flags);
    }
  }, {
    key: 'value',
    get: function get$$1() {
      return this.masked.value.slice(this.masked.mapDefIndexToPos(this.offset), this.masked.mapDefIndexToPos(this.offset + this.mask.length));
    }

    /** Unmasked slice of internal {@link masked} value */

  }, {
    key: 'unmaskedValue',
    get: function get$$1() {
      return this.masked.extractInput(this.masked.mapDefIndexToPos(this.offset), this.masked.mapDefIndexToPos(this.offset + this.mask.length));
    }
  }]);
  return PatternGroup;
}();

var RangeGroup = function () {
  /** @type {Function} */
  function RangeGroup(_ref2) {
    var _ref3 = slicedToArray(_ref2, 2),
        from = _ref3[0],
        to = _ref3[1];

    var maxlen = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : String(to).length;
    classCallCheck(this, RangeGroup);

    this._from = from;
    this._to = to;
    this._maxLength = maxlen;
    this.validate = this.validate.bind(this);

    this._update();
  }
  /** @type {string} */


  createClass(RangeGroup, [{
    key: '_update',
    value: function _update() {
      this._maxLength = Math.max(this._maxLength, String(this.to).length);
      this.mask = '0'.repeat(this._maxLength);
    }
  }, {
    key: 'validate',
    value: function validate(str) {
      var minstr = '';
      var maxstr = '';

      var _ref4 = str.match(/^(\D*)(\d*)(\D*)/) || [],
          _ref5 = slicedToArray(_ref4, 3),
          placeholder = _ref5[1],
          num = _ref5[2];

      if (num) {
        minstr = '0'.repeat(placeholder.length) + num;
        maxstr = '9'.repeat(placeholder.length) + num;
      }

      var firstNonZero = str.search(/[^0]/);
      if (firstNonZero === -1 && str.length <= this._matchFrom) return true;

      minstr = minstr.padEnd(this._maxLength, '0');
      maxstr = maxstr.padEnd(this._maxLength, '9');

      return this.from <= Number(maxstr) && Number(minstr) <= this.to;
    }
  }, {
    key: 'to',
    get: function get$$1() {
      return this._to;
    },
    set: function set$$1(to) {
      this._to = to;
      this._update();
    }
  }, {
    key: 'from',
    get: function get$$1() {
      return this._from;
    },
    set: function set$$1(from) {
      this._from = from;
      this._update();
    }
  }, {
    key: 'maxLength',
    get: function get$$1() {
      return this._maxLength;
    },
    set: function set$$1(maxLength) {
      this._maxLength = maxLength;
      this._update();
    }
  }, {
    key: '_matchFrom',
    get: function get$$1() {
      return this.maxLength - String(this.from).length;
    }
  }]);
  return RangeGroup;
}();

/** Pattern group that validates enum values */
function EnumGroup(enums) {
  return {
    mask: '*'.repeat(enums[0].length),
    validate: function validate(value, group, flags) {
      return enums.some(function (e) {
        return e.indexOf(group.unmaskedValue) >= 0;
      });
    }
  };
}

PatternGroup.Range = RangeGroup;
PatternGroup.Enum = EnumGroup;

var ChunksTailDetails = function () {
  function ChunksTailDetails(chunks) {
    classCallCheck(this, ChunksTailDetails);

    this.chunks = chunks;
  }

  createClass(ChunksTailDetails, [{
    key: 'value',
    get: function get$$1() {
      return this.chunks.map(function (c) {
        return c.value;
      }).join('');
    }
  }, {
    key: 'fromPos',
    get: function get$$1() {
      var firstChunk = this.chunks[0];
      return firstChunk && firstChunk.stop;
    }
  }, {
    key: 'toPos',
    get: function get$$1() {
      var lastChunk = this.chunks[this.chunks.length - 1];
      return lastChunk && lastChunk.stop;
    }
  }]);
  return ChunksTailDetails;
}();

/**
  Pattern mask
  @param {Object} opts
  @param {Object} opts.groups
  @param {Object} opts.definitions
  @param {string} opts.placeholderChar
  @param {boolean} opts.lazy
*/
var MaskedPattern = function (_Masked) {
  inherits(MaskedPattern, _Masked);

  // TODO mask type
  /** Single char for empty input */


  /** */
  function MaskedPattern() {
    var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    classCallCheck(this, MaskedPattern);
    // TODO type $Shape<MaskedPatternOptions>={} does not work
    opts.definitions = _extends({}, PatternDefinition.DEFAULTS, opts.definitions);
    return possibleConstructorReturn(this, (MaskedPattern.__proto__ || Object.getPrototypeOf(MaskedPattern)).call(this, _extends({}, MaskedPattern.DEFAULTS, opts)));
  }

  /**
    @override
    @param {Object} opts
  */

  /** Show placeholder only when needed */

  /** */


  createClass(MaskedPattern, [{
    key: '_update',
    value: function _update() {
      var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};

      opts.definitions = _extends({}, this.definitions, opts.definitions);
      get(MaskedPattern.prototype.__proto__ || Object.getPrototypeOf(MaskedPattern.prototype), '_update', this).call(this, opts);
      this._rebuildMask();
    }

    /** */

  }, {
    key: '_rebuildMask',
    value: function _rebuildMask() {
      var _this2 = this;

      var defs = this.definitions;
      this._charDefs = [];
      this._groupDefs = [];

      var pattern = this.mask;
      if (!pattern || !defs) return;

      var unmaskingBlock = false;
      var optionalBlock = false;
      var stopAlign = false;

      var _loop = function _loop(_i) {
        if (_this2.groups) {
          var p = pattern.slice(_i);
          var gNames = Object.keys(_this2.groups).filter(function (gName) {
            return p.indexOf(gName) === 0;
          });
          // order by key length
          gNames.sort(function (a, b) {
            return b.length - a.length;
          });
          // use group name with max length
          var gName = gNames[0];
          if (gName) {
            var group = _this2.groups[gName];
            _this2._groupDefs.push(new PatternGroup(_this2, {
              name: gName,
              offset: _this2._charDefs.length,
              mask: group.mask,
              validate: group.validate
            }));
            pattern = pattern.replace(gName, group.mask);
          }
        }

        var char = pattern[_i];
        var type = char in defs ? PatternDefinition.TYPES.INPUT : PatternDefinition.TYPES.FIXED;
        var unmasking = type === PatternDefinition.TYPES.INPUT || unmaskingBlock;
        var optional = type === PatternDefinition.TYPES.INPUT && optionalBlock;

        if (char === MaskedPattern.STOP_CHAR) {
          stopAlign = true;
          return 'continue';
        }

        if (char === '{' || char === '}') {
          unmaskingBlock = !unmaskingBlock;
          return 'continue';
        }

        if (char === '[' || char === ']') {
          optionalBlock = !optionalBlock;
          return 'continue';
        }

        if (char === MaskedPattern.ESCAPE_CHAR) {
          ++_i;
          char = pattern[_i];
          if (!char) return 'break';
          type = PatternDefinition.TYPES.FIXED;
        }

        _this2._charDefs.push(new PatternDefinition({
          char: char,
          type: type,
          optional: optional,
          stopAlign: stopAlign,
          unmasking: unmasking,
          mask: type === PatternDefinition.TYPES.INPUT ? defs[char] : function (value) {
            return value === char;
          }
        }));

        stopAlign = false;
        i = _i;
      };

      _loop2: for (var i = 0; i < pattern.length; ++i) {
        var _ret = _loop(i);

        switch (_ret) {
          case 'continue':
            continue;

          case 'break':
            break _loop2;}
      }
    }

    /**
      @override
    */

  }, {
    key: 'doValidate',
    value: function doValidate() {
      var _babelHelpers$get;

      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      return this._groupDefs.every(function (g$$1) {
        return g$$1.doValidate.apply(g$$1, toConsumableArray(args));
      }) && (_babelHelpers$get = get(MaskedPattern.prototype.__proto__ || Object.getPrototypeOf(MaskedPattern.prototype), 'doValidate', this)).call.apply(_babelHelpers$get, [this].concat(toConsumableArray(args)));
    }

    /**
      @override
    */

  }, {
    key: 'clone',
    value: function clone() {
      var _this3 = this;

      var m = new MaskedPattern(this);
      m._value = this.value;
      // $FlowFixMe
      m._charDefs.forEach(function (d, i) {
        return _extends(d, _this3._charDefs[i]);
      });
      // $FlowFixMe
      m._groupDefs.forEach(function (d, i) {
        return _extends(d, _this3._groupDefs[i]);
      });
      return m;
    }

    /**
      @override
    */

  }, {
    key: 'reset',
    value: function reset() {
      get(MaskedPattern.prototype.__proto__ || Object.getPrototypeOf(MaskedPattern.prototype), 'reset', this).call(this);
      this._charDefs.forEach(function (d) {
        delete d.isHollow;
      });
    }

    /**
      @override
    */

  }, {
    key: 'hiddenHollowsBefore',


    /** */
    value: function hiddenHollowsBefore(defIndex) {
      return this._charDefs.slice(0, defIndex).filter(function (d) {
        return d.isHiddenHollow;
      }).length;
    }

    /** Map definition index to position on view */

  }, {
    key: 'mapDefIndexToPos',
    value: function mapDefIndexToPos(defIndex) {
      return defIndex - this.hiddenHollowsBefore(defIndex);
    }

    /** Map position on view to definition index */

  }, {
    key: 'mapPosToDefIndex',
    value: function mapPosToDefIndex(pos) {
      var defIndex = pos;
      for (var di = 0; di < this._charDefs.length; ++di) {
        var def = this._charDefs[di];
        if (di >= defIndex) break;
        if (def.isHiddenHollow) ++defIndex;
      }
      return defIndex;
    }

    /**
      @override
    */

  }, {
    key: '_appendTail',


    /**
      @override
    */
    value: function _appendTail(tail) {
      var details = new ChangeDetails();
      if (tail) {
        details.aggregate(tail instanceof ChunksTailDetails ? this._appendChunks(tail.chunks, { tail: true }) : get(MaskedPattern.prototype.__proto__ || Object.getPrototypeOf(MaskedPattern.prototype), '_appendTail', this).call(this, tail));
      }
      return details.aggregate(this._appendPlaceholder());
    }

    /**
      @override
    */

  }, {
    key: '_append',
    value: function _append(str) {
      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      var oldValueLength = this.value.length;
      var rawInserted = '';
      var overflow = false;

      str = this.doPrepare(str, flags);

      for (var ci = 0, di = this.mapPosToDefIndex(this.value.length); ci < str.length;) {
        var ch = str[ci];
        var def = this._charDefs[di];

        // check overflow
        if (def == null) {
          overflow = true;
          break;
        }

        // reset
        def.isHollow = false;

        var resolved = void 0,
            skipped = void 0;
        var chres = conform(def.resolve(ch), ch);

        if (def.type === PatternDefinition.TYPES.INPUT) {
          if (chres) {
            this._value += chres;
            if (!this.doValidate()) {
              chres = '';
              this._value = this.value.slice(0, -1);
            }
          }

          resolved = !!chres;
          skipped = !chres && !def.optional;

          if (!chres) {
            if (!def.optional && !flags.input && !this.lazy) {
              this._value += this.placeholderChar;
              skipped = false;
            }
            if (!skipped) def.isHollow = true;
          } else {
            rawInserted += chres;
          }
        } else {
          this._value += def.char;
          resolved = chres && (def.unmasking || flags.input || flags.raw) && !flags.tail;
          def.isRawInput = resolved && (flags.raw || flags.input);
          if (def.isRawInput) rawInserted += def.char;
        }

        if (!skipped) ++di;
        if (resolved || skipped) ++ci;
      }

      return new ChangeDetails({
        inserted: this.value.slice(oldValueLength),
        rawInserted: rawInserted,
        overflow: overflow
      });
    }

    /** Appends chunks splitted by stop chars */

  }, {
    key: '_appendChunks',
    value: function _appendChunks(chunks) {
      var details = new ChangeDetails();

      for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
        args[_key2 - 1] = arguments[_key2];
      }

      for (var ci = 0; ci < chunks.length; ++ci) {
        var _chunks$ci = chunks[ci],
            stop = _chunks$ci.stop,
            value = _chunks$ci.value;

        var fromDef = stop != null && this._charDefs[stop];
        // lets double check if stopAlign is here
        if (fromDef && fromDef.stopAlign) details.aggregate(this._appendPlaceholder(stop));
        if (details.aggregate(this._append.apply(this, [value].concat(toConsumableArray(args)))).overflow) break;
      }
      return details;
    }

    /**
      @override
    */

  }, {
    key: '_extractTail',
    value: function _extractTail() {
      var fromPos = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var toPos = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.value.length;

      return new ChunksTailDetails(this._extractInputChunks(fromPos, toPos));
    }

    /**
      @override
    */

  }, {
    key: 'extractInput',
    value: function extractInput() {
      var fromPos = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var toPos = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.value.length;
      var flags = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

      if (fromPos === toPos) return '';

      var str = this.value;
      var input = '';

      var toDefIndex = this.mapPosToDefIndex(toPos);
      for (var ci = fromPos, di = this.mapPosToDefIndex(fromPos); ci < toPos && ci < str.length && di < toDefIndex; ++di) {
        var ch = str[ci];
        var def = this._charDefs[di];

        if (!def) break;
        if (def.isHiddenHollow) continue;

        if (def.isInput && !def.isHollow || flags.raw && !def.isInput && def.isRawInput) input += ch;
        ++ci;
      }
      return input;
    }

    /** Extracts chunks from input splitted by stop chars */

  }, {
    key: '_extractInputChunks',
    value: function _extractInputChunks() {
      var _this4 = this;

      var fromPos = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var toPos = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.value.length;

      if (fromPos === toPos) return [];

      var fromDefIndex = this.mapPosToDefIndex(fromPos);
      var toDefIndex = this.mapPosToDefIndex(toPos);
      var stopDefIndices = this._charDefs.map(function (d, i) {
        return [d, i];
      }).slice(fromDefIndex, toDefIndex).filter(function (_ref) {
        var _ref2 = slicedToArray(_ref, 1),
            d = _ref2[0];

        return d.stopAlign;
      }).map(function (_ref3) {
        var _ref4 = slicedToArray(_ref3, 2),
            i = _ref4[1];

        return i;
      });

      var stops = [fromDefIndex].concat(toConsumableArray(stopDefIndices), [toDefIndex]);

      return stops.map(function (s, i) {
        return {
          stop: stopDefIndices.indexOf(s) >= 0 ? s : null,

          value: _this4.extractInput(_this4.mapDefIndexToPos(s), _this4.mapDefIndexToPos(stops[++i]))
        };
      }).filter(function (_ref5) {
        var stop = _ref5.stop,
            value = _ref5.value;
        return stop != null || value;
      });
    }

    /** Appends placeholder depending on laziness */

  }, {
    key: '_appendPlaceholder',
    value: function _appendPlaceholder(toDefIndex) {
      var oldValueLength = this.value.length;
      var maxDefIndex = toDefIndex || this._charDefs.length;
      for (var di = this.mapPosToDefIndex(this.value.length); di < maxDefIndex; ++di) {
        var def = this._charDefs[di];
        if (def.isInput) def.isHollow = true;

        if (!this.lazy || toDefIndex) {
          this._value += !def.isInput && def.char != null ? def.char : !def.optional ? this.placeholderChar : '';
        }
      }
      return new ChangeDetails({
        inserted: this.value.slice(oldValueLength)
      });
    }

    /**
      @override
    */

  }, {
    key: 'remove',
    value: function remove() {
      var from = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var count = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.value.length - from;

      var fromDefIndex = this.mapPosToDefIndex(from);
      var toDefIndex = this.mapPosToDefIndex(from + count);
      this._charDefs.slice(fromDefIndex, toDefIndex).forEach(function (d) {
        return d.reset();
      });

      return get(MaskedPattern.prototype.__proto__ || Object.getPrototypeOf(MaskedPattern.prototype), 'remove', this).call(this, from, count);
    }

    /**
      @override
    */

  }, {
    key: 'nearestInputPos',
    value: function nearestInputPos(cursorPos) {
      var direction = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : DIRECTION.NONE;

      var step = direction || DIRECTION.RIGHT;

      var initialDefIndex = this.mapPosToDefIndex(cursorPos);
      var initialDef = this._charDefs[initialDefIndex];
      var di = initialDefIndex;

      var firstInputIndex = void 0,
          firstFilledInputIndex = void 0,
          firstVisibleHollowIndex = void 0,
          nextdi = void 0;

      // check if chars at right is acceptable for LEFT and NONE directions
      if (direction !== DIRECTION.RIGHT && (initialDef && initialDef.isInput ||
      // in none direction latest position is acceptable also
      direction === DIRECTION.NONE && cursorPos === this.value.length)) {
        firstInputIndex = initialDefIndex;
        if (initialDef && !initialDef.isHollow) firstFilledInputIndex = initialDefIndex;
      }

      if (firstFilledInputIndex == null && direction == DIRECTION.LEFT || firstInputIndex == null) {
        // search forward
        for (nextdi = indexInDirection(di, step); 0 <= nextdi && nextdi < this._charDefs.length; di += step, nextdi += step) {
          var nextDef = this._charDefs[nextdi];
          if (firstInputIndex == null && nextDef.isInput) {
            firstInputIndex = di;
            if (direction === DIRECTION.NONE) break;
          }
          if (firstVisibleHollowIndex == null && nextDef.isHollow && !nextDef.isHiddenHollow) firstVisibleHollowIndex = di;
          if (nextDef.isInput && !nextDef.isHollow) {
            firstFilledInputIndex = di;
            break;
          }
        }
      }

      // for lazy if has aligned left inside fixed and has came to the start - use start position
      if (direction === DIRECTION.LEFT && di === 0 && this.lazy && !this.extractInput() && (!initialDef || !initialDef.isInput)) firstInputIndex = 0;

      if (direction === DIRECTION.LEFT || firstInputIndex == null) {
        // search backward
        step = -step;
        var overflow = false;

        // find hollows only before initial pos
        for (nextdi = indexInDirection(di, step); 0 <= nextdi && nextdi < this._charDefs.length; di += step, nextdi += step) {
          var _nextDef = this._charDefs[nextdi];
          if (_nextDef.isInput) {
            firstInputIndex = di;
            if (_nextDef.isHollow && !_nextDef.isHiddenHollow) break;
          }

          // if hollow not found before start position - set `overflow`
          // and try to find just any input
          if (di === initialDefIndex) overflow = true;

          // first input found
          if (overflow && firstInputIndex != null) break;
        }

        // process overflow
        overflow = overflow || nextdi >= this._charDefs.length;
        if (overflow && firstInputIndex != null) di = firstInputIndex;
      } else if (firstFilledInputIndex == null) {
        // adjust index if delete at right and filled input not found at right
        di = firstVisibleHollowIndex != null ? firstVisibleHollowIndex : firstInputIndex;
      }

      return this.mapDefIndexToPos(di);
    }

    /** Get group by name */

  }, {
    key: 'group',
    value: function group(name) {
      return this.groupsByName(name)[0];
    }

    /** Get all groups by name */

  }, {
    key: 'groupsByName',
    value: function groupsByName(name) {
      return this._groupDefs.filter(function (g$$1) {
        return g$$1.name === name;
      });
    }
  }, {
    key: 'isComplete',
    get: function get$$1() {
      var _this5 = this;

      return !this._charDefs.some(function (d, i) {
        return d.isInput && !d.optional && (d.isHollow || !_this5.extractInput(i, i + 1));
      });
    }
  }, {
    key: 'unmaskedValue',
    get: function get$$1() {
      var str = this.value;
      var unmasked = '';

      for (var ci = 0, di = 0; ci < str.length && di < this._charDefs.length; ++di) {
        var ch = str[ci];
        var def = this._charDefs[di];

        if (def.isHiddenHollow) continue;
        if (def.unmasking && !def.isHollow) unmasked += ch;
        ++ci;
      }

      return unmasked;
    },
    set: function set$$1(unmaskedValue) {
      set(MaskedPattern.prototype.__proto__ || Object.getPrototypeOf(MaskedPattern.prototype), 'unmaskedValue', unmaskedValue, this);
    }
  }]);
  return MaskedPattern;
}(Masked);

MaskedPattern.DEFAULTS = {
  lazy: true,
  placeholderChar: '_'
};
MaskedPattern.STOP_CHAR = '`';
MaskedPattern.ESCAPE_CHAR = '\\';
MaskedPattern.Definition = PatternDefinition;
MaskedPattern.Group = PatternGroup;

/** Date mask */

var MaskedDate = function (_MaskedPattern) {
  inherits(MaskedDate, _MaskedPattern);

  /**
    @param {Object} opts
  */

  /** Start date */

  /** Format Date to string */
  function MaskedDate(opts) {
    classCallCheck(this, MaskedDate);
    return possibleConstructorReturn(this, (MaskedDate.__proto__ || Object.getPrototypeOf(MaskedDate)).call(this, _extends({}, MaskedDate.DEFAULTS, opts)));
  }

  /**
    @override
  */

  /** End date */

  /** Pattern mask for date according to {@link MaskedDate#format} */


  /** Parse string to Date */


  createClass(MaskedDate, [{
    key: '_update',
    value: function _update(opts) {
      if (opts.mask === Date) delete opts.mask;
      if (opts.pattern) {
        opts.mask = opts.pattern;
        delete opts.pattern;
      }

      var groups = opts.groups;
      opts.groups = _extends({}, MaskedDate.GET_DEFAULT_GROUPS());
      // adjust year group
      if (opts.min) opts.groups.Y.from = opts.min.getFullYear();
      if (opts.max) opts.groups.Y.to = opts.max.getFullYear();
      _extends(opts.groups, groups);

      get(MaskedDate.prototype.__proto__ || Object.getPrototypeOf(MaskedDate.prototype), '_update', this).call(this, opts);
    }

    /**
      @override
    */

  }, {
    key: 'doValidate',
    value: function doValidate() {
      var _babelHelpers$get;

      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      var valid = (_babelHelpers$get = get(MaskedDate.prototype.__proto__ || Object.getPrototypeOf(MaskedDate.prototype), 'doValidate', this)).call.apply(_babelHelpers$get, [this].concat(toConsumableArray(args)));
      var date = this.date;

      return valid && (!this.isComplete || this.isDateExist(this.value) && date && (this.min == null || this.min <= date) && (this.max == null || date <= this.max));
    }

    /** Checks if date is exists */

  }, {
    key: 'isDateExist',
    value: function isDateExist(str) {
      return this.format(this.parse(str)) === str;
    }

    /** Parsed Date */

  }, {
    key: 'date',
    get: function get$$1() {
      return this.isComplete ? this.parse(this.value) : null;
    },
    set: function set$$1(date) {
      this.value = this.format(date);
    }
  }]);
  return MaskedDate;
}(MaskedPattern);

MaskedDate.DEFAULTS = {
  pattern: 'd{.}`m{.}`Y',
  format: function format(date) {
    var day = String(date.getDate()).padStart(2, '0');
    var month = String(date.getMonth() + 1).padStart(2, '0');
    var year = date.getFullYear();

    return [day, month, year].join('.');
  },
  parse: function parse(str) {
    var _str$split = str.split('.'),
        _str$split2 = slicedToArray(_str$split, 3),
        day = _str$split2[0],
        month = _str$split2[1],
        year = _str$split2[2];

    return new Date(year, month - 1, day);
  }
};
MaskedDate.GET_DEFAULT_GROUPS = function () {
  return {
    d: new PatternGroup.Range([1, 31]),
    m: new PatternGroup.Range([1, 12]),
    Y: new PatternGroup.Range([1900, 9999])
  };
};

/**
  Generic element API to use with mask
  @interface
*/

/** Listens to element events and controls changes between element and {@link Masked} */
var InputMask = function () {

  /**
    @param {UIElement} el
    @param {Object} opts
  */

  /**
    View element
    @readonly
  */
  function InputMask(el, opts) {
    classCallCheck(this, InputMask);

    this.el = el;
    this.masked = createMask(opts);

    this._listeners = {};
    this._value = '';
    this._unmaskedValue = '';

    this._saveSelection = this._saveSelection.bind(this);
    this._onInput = this._onInput.bind(this);
    this._onChange = this._onChange.bind(this);
    this._onDrop = this._onDrop.bind(this);
    this.alignCursor = this.alignCursor.bind(this);
    this.alignCursorFriendly = this.alignCursorFriendly.bind(this);

    this._bindEvents();

    // refresh
    this.updateValue();
    this._onChange();
  }

  /** Read or update mask */


  /**
    Internal {@link Masked} model
    @readonly
  */


  createClass(InputMask, [{
    key: '_bindEvents',


    /**
      Starts listening to element events
      @protected
    */
    value: function _bindEvents() {
      this.el.addEventListener('keydown', this._saveSelection);
      this.el.addEventListener('input', this._onInput);
      this.el.addEventListener('drop', this._onDrop);
      this.el.addEventListener('click', this.alignCursorFriendly);
      this.el.addEventListener('change', this._onChange);
    }

    /**
      Stops listening to element events
      @protected
     */

  }, {
    key: '_unbindEvents',
    value: function _unbindEvents() {
      this.el.removeEventListener('keydown', this._saveSelection);
      this.el.removeEventListener('input', this._onInput);
      this.el.removeEventListener('drop', this._onDrop);
      this.el.removeEventListener('click', this.alignCursorFriendly);
      this.el.removeEventListener('change', this._onChange);
    }

    /**
      Fires custom event
      @protected
     */

  }, {
    key: '_fireEvent',
    value: function _fireEvent(ev) {
      var listeners = this._listeners[ev] || [];
      listeners.forEach(function (l) {
        return l();
      });
    }

    /**
      Current selection start
      @readonly
    */

  }, {
    key: '_saveSelection',


    /**
      Stores current selection
      @protected
    */
    value: function _saveSelection() /* ev */{
      if (this.value !== this.el.value) {
        console.warn('Uncontrolled input change, refresh mask manually!'); // eslint-disable-line no-console
      }
      this._selection = {
        start: this.selectionStart,
        end: this.cursorPos
      };
    }

    /** Syncronizes model value from view */

  }, {
    key: 'updateValue',
    value: function updateValue() {
      this.masked.value = this.el.value;
    }

    /** Syncronizes view from model value, fires change events */

  }, {
    key: 'updateControl',
    value: function updateControl() {
      var newUnmaskedValue = this.masked.unmaskedValue;
      var newValue = this.masked.value;
      var isChanged = this.unmaskedValue !== newUnmaskedValue || this.value !== newValue;

      this._unmaskedValue = newUnmaskedValue;
      this._value = newValue;

      if (this.el.value !== newValue) this.el.value = newValue;
      if (isChanged) this._fireChangeEvents();
    }

    /** Updates options with deep equal check, recreates @{link Masked} model if mask type changes */

  }, {
    key: 'updateOptions',
    value: function updateOptions(opts) {
      opts = _extends({}, opts); // clone
      if (opts.mask === Date && this.masked instanceof MaskedDate) delete opts.mask;

      // check if changed
      if (objectIncludes(this.masked, opts)) return;

      this.masked.updateOptions(opts);
      this.updateControl();
    }

    /** Updates cursor */

  }, {
    key: 'updateCursor',
    value: function updateCursor(cursorPos) {
      if (cursorPos == null) return;
      this.cursorPos = cursorPos;

      // also queue change cursor for mobile browsers
      this._delayUpdateCursor(cursorPos);
    }

    /**
      Delays cursor update to support mobile browsers
      @private
    */

  }, {
    key: '_delayUpdateCursor',
    value: function _delayUpdateCursor(cursorPos) {
      var _this = this;

      this._abortUpdateCursor();
      this._changingCursorPos = cursorPos;
      this._cursorChanging = setTimeout(function () {
        if (!_this.el) return; // if was destroyed
        _this.cursorPos = _this._changingCursorPos;
        _this._abortUpdateCursor();
      }, 10);
    }

    /**
      Fires custom events
      @protected
    */

  }, {
    key: '_fireChangeEvents',
    value: function _fireChangeEvents() {
      this._fireEvent('accept');
      if (this.masked.isComplete) this._fireEvent('complete');
    }

    /**
      Aborts delayed cursor update
      @private
    */

  }, {
    key: '_abortUpdateCursor',
    value: function _abortUpdateCursor() {
      if (this._cursorChanging) {
        clearTimeout(this._cursorChanging);
        delete this._cursorChanging;
      }
    }

    /** Aligns cursor to nearest available position */

  }, {
    key: 'alignCursor',
    value: function alignCursor() {
      this.cursorPos = this.masked.nearestInputPos(this.cursorPos, DIRECTION.LEFT);
    }

    /** Aligns cursor only if selection is empty */

  }, {
    key: 'alignCursorFriendly',
    value: function alignCursorFriendly() {
      if (this.selectionStart !== this.cursorPos) return;
      this.alignCursor();
    }

    /** Adds listener on custom event */

  }, {
    key: 'on',
    value: function on(ev, handler) {
      if (!this._listeners[ev]) this._listeners[ev] = [];
      this._listeners[ev].push(handler);
      return this;
    }

    /** Removes custom event listener */

  }, {
    key: 'off',
    value: function off(ev, handler) {
      if (!this._listeners[ev]) return;
      if (!handler) {
        delete this._listeners[ev];
        return;
      }
      var hIndex = this._listeners[ev].indexOf(handler);
      if (hIndex >= 0) this._listeners[ev].splice(hIndex, 1);
      return this;
    }

    /** Handles view input event */

  }, {
    key: '_onInput',
    value: function _onInput() {
      this._abortUpdateCursor();

      var details = new ActionDetails(
      // new state
      this.el.value, this.cursorPos,
      // old state
      this.value, this._selection);

      var offset = this.masked.splice(details.startChangePos, details.removed.length, details.inserted, details.removeDirection).offset;

      var cursorPos = this.masked.nearestInputPos(details.startChangePos + offset, details.removeDirection);

      this.updateControl();
      this.updateCursor(cursorPos);
    }

    /** Handles view change event and commits model value */

  }, {
    key: '_onChange',
    value: function _onChange() {
      if (this.value !== this.el.value) {
        this.updateValue();
      }
      this.masked.doCommit();
      this.updateControl();
    }

    /** Handles view drop event, prevents by default */

  }, {
    key: '_onDrop',
    value: function _onDrop(ev) {
      ev.preventDefault();
      ev.stopPropagation();
    }

    /** Unbind view events and removes element reference */

  }, {
    key: 'destroy',
    value: function destroy() {
      this._unbindEvents();
      // $FlowFixMe why not do so?
      this._listeners.length = 0;
      delete this.el;
    }
  }, {
    key: 'mask',
    get: function get$$1() {
      return this.masked.mask;
    },
    set: function set$$1(mask) {
      if (mask == null || mask === this.masked.mask) return;

      if (this.masked.constructor === maskedClass(mask)) {
        this.masked.mask = mask;
        return;
      }

      var masked = createMask({ mask: mask });
      masked.unmaskedValue = this.masked.unmaskedValue;
      this.masked = masked;
    }

    /** Raw value */

  }, {
    key: 'value',
    get: function get$$1() {
      return this._value;
    },
    set: function set$$1(str) {
      this.masked.value = str;
      this.updateControl();
      this.alignCursor();
    }

    /** Unmasked value */

  }, {
    key: 'unmaskedValue',
    get: function get$$1() {
      return this._unmaskedValue;
    },
    set: function set$$1(str) {
      this.masked.unmaskedValue = str;
      this.updateControl();
      this.alignCursor();
    }
  }, {
    key: 'selectionStart',
    get: function get$$1() {
      return this._cursorChanging ? this._changingCursorPos : this.el.selectionStart;
    }

    /** Current cursor position */

  }, {
    key: 'cursorPos',
    get: function get$$1() {
      return this._cursorChanging ? this._changingCursorPos : this.el.selectionEnd;
    },
    set: function set$$1(pos) {
      if (this.el !== document.activeElement) return;

      this.el.setSelectionRange(pos, pos);
      this._saveSelection();
    }
  }]);
  return InputMask;
}();

/**
  Number mask
  @param {Object} opts
  @param {string} opts.radix - Single char
  @param {string} opts.thousandsSeparator - Single char
  @param {Array<string>} opts.mapToRadix - Array of single chars
  @param {number} opts.min
  @param {number} opts.max
  @param {number} opts.scale - Digits after point
  @param {boolean} opts.signed - Allow negative
  @param {boolean} opts.normalizeZeros - Flag to remove leading and trailing zeros in the end of editing
  @param {boolean} opts.padFractionalZeros - Flag to pad trailing zeros after point in the end of editing
*/
var MaskedNumber = function (_Masked) {
  inherits(MaskedNumber, _Masked);

  /** Flag to remove leading and trailing zeros in the end of editing */

  /** Digits after point */

  /** */

  /** Single char */
  function MaskedNumber(opts) {
    classCallCheck(this, MaskedNumber);
    return possibleConstructorReturn(this, (MaskedNumber.__proto__ || Object.getPrototypeOf(MaskedNumber)).call(this, _extends({}, MaskedNumber.DEFAULTS, opts)));
  }

  /**
    @override
  */

  /** Flag to pad trailing zeros after point in the end of editing */

  /** */

  /** */

  /** Array of single chars */


  /** Single char */


  createClass(MaskedNumber, [{
    key: '_update',
    value: function _update(opts) {
      get(MaskedNumber.prototype.__proto__ || Object.getPrototypeOf(MaskedNumber.prototype), '_update', this).call(this, opts);
      this._updateRegExps();
    }

    /** */

  }, {
    key: '_updateRegExps',
    value: function _updateRegExps() {
      // use different regexp to process user input (more strict, input suffix) and tail shifting
      var start = '^';

      var midInput = '';
      var mid = '';
      if (this.allowNegative) {
        midInput += '([+|\\-]?|([+|\\-]?(0|([1-9]+\\d*))))';
        mid += '[+|\\-]?';
      } else {
        midInput += '(0|([1-9]+\\d*))';
      }
      mid += '\\d*';

      var end = (this.scale ? '(' + this.radix + '\\d{0,' + this.scale + '})?' : '') + '$';

      this._numberRegExpInput = new RegExp(start + midInput + end);
      this._numberRegExp = new RegExp(start + mid + end);
      this._mapToRadixRegExp = new RegExp('[' + this.mapToRadix.map(escapeRegExp).join('') + ']', 'g');
      this._thousandsSeparatorRegExp = new RegExp(escapeRegExp(this.thousandsSeparator), 'g');
    }

    /**
      @override
    */

  }, {
    key: '_extractTail',
    value: function _extractTail() {
      var fromPos = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var toPos = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.value.length;

      var tail = get(MaskedNumber.prototype.__proto__ || Object.getPrototypeOf(MaskedNumber.prototype), '_extractTail', this).call(this, fromPos, toPos);

      return _extends({}, tail, {
        value: this._removeThousandsSeparators(tail.value)
      });
    }

    /** */

  }, {
    key: '_removeThousandsSeparators',
    value: function _removeThousandsSeparators(value) {
      return value.replace(this._thousandsSeparatorRegExp, '');
    }

    /** */

  }, {
    key: '_insertThousandsSeparators',
    value: function _insertThousandsSeparators(value) {
      // https://stackoverflow.com/questions/2901102/how-to-print-a-number-with-commas-as-thousands-separators-in-javascript
      var parts = value.split(this.radix);
      parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, this.thousandsSeparator);
      return parts.join(this.radix);
    }

    /**
      @override
    */

  }, {
    key: 'doPrepare',
    value: function doPrepare(str) {
      var _babelHelpers$get;

      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        args[_key - 1] = arguments[_key];
      }

      return (_babelHelpers$get = get(MaskedNumber.prototype.__proto__ || Object.getPrototypeOf(MaskedNumber.prototype), 'doPrepare', this)).call.apply(_babelHelpers$get, [this, this._removeThousandsSeparators(str.replace(this._mapToRadixRegExp, this.radix))].concat(toConsumableArray(args)));
    }

    /**
      @override
    */

  }, {
    key: 'appendWithTail',
    value: function appendWithTail() {
      var _babelHelpers$get2;

      var previousValue = this.value;
      this._value = this._removeThousandsSeparators(this.value);
      var startChangePos = this.value.length;

      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }

      var appendDetails = (_babelHelpers$get2 = get(MaskedNumber.prototype.__proto__ || Object.getPrototypeOf(MaskedNumber.prototype), 'appendWithTail', this)).call.apply(_babelHelpers$get2, [this].concat(toConsumableArray(args)));
      this._value = this._insertThousandsSeparators(this.value);

      // calculate offsets after insert separators
      var beforeTailPos = startChangePos + appendDetails.inserted.length;
      for (var pos = 0; pos <= beforeTailPos; ++pos) {
        if (this.value[pos] === this.thousandsSeparator) {
          if (pos < startChangePos ||
          // check high bound
          // if separator is still there - consider it also
          pos === startChangePos && previousValue[pos] === this.thousandsSeparator) {
            ++startChangePos;
          }
          if (pos < beforeTailPos) ++beforeTailPos;
        }
      }

      // adjust details with separators
      appendDetails.rawInserted = appendDetails.inserted;
      appendDetails.inserted = this.value.slice(startChangePos, beforeTailPos);
      appendDetails.shift += startChangePos - previousValue.length;

      return appendDetails;
    }

    /**
      @override
    */

  }, {
    key: 'nearestInputPos',
    value: function nearestInputPos(cursorPos, direction) {
      if (!direction) return cursorPos;

      var nextPos = indexInDirection(cursorPos, direction);
      if (this.value[nextPos] === this.thousandsSeparator) cursorPos += direction;
      return cursorPos;
    }

    /**
      @override
    */

  }, {
    key: 'doValidate',
    value: function doValidate(flags) {
      var regexp = flags.input ? this._numberRegExpInput : this._numberRegExp;

      // validate as string
      var valid = regexp.test(this._removeThousandsSeparators(this.value));

      if (valid) {
        // validate as number
        var number = this.number;
        valid = valid && !isNaN(number) && (
        // check min bound for negative values
        this.min == null || this.min >= 0 || this.min <= this.number) && (
        // check max bound for positive values
        this.max == null || this.max <= 0 || this.number <= this.max);
      }

      return valid && get(MaskedNumber.prototype.__proto__ || Object.getPrototypeOf(MaskedNumber.prototype), 'doValidate', this).call(this, flags);
    }

    /**
      @override
    */

  }, {
    key: 'doCommit',
    value: function doCommit() {
      var number = this.number;
      var validnum = number;

      // check bounds
      if (this.min != null) validnum = Math.max(validnum, this.min);
      if (this.max != null) validnum = Math.min(validnum, this.max);

      if (validnum !== number) this.unmaskedValue = String(validnum);

      var formatted = this.value;

      if (this.normalizeZeros) formatted = this._normalizeZeros(formatted);
      if (this.padFractionalZeros) formatted = this._padFractionalZeros(formatted);

      this._value = formatted;
      get(MaskedNumber.prototype.__proto__ || Object.getPrototypeOf(MaskedNumber.prototype), 'doCommit', this).call(this);
    }

    /** */

  }, {
    key: '_normalizeZeros',
    value: function _normalizeZeros(value) {
      var parts = this._removeThousandsSeparators(value).split(this.radix);

      // remove leading zeros
      parts[0] = parts[0].replace(/^(\D*)(0*)(\d*)/, function (match, sign, zeros, num) {
        return sign + num;
      });
      // add leading zero
      if (value.length && !/\d$/.test(parts[0])) parts[0] = parts[0] + '0';

      if (parts.length > 1) {
        parts[1] = parts[1].replace(/0*$/, ''); // remove trailing zeros
        if (!parts[1].length) parts.length = 1; // remove fractional
      }

      return this._insertThousandsSeparators(parts.join(this.radix));
    }

    /** */

  }, {
    key: '_padFractionalZeros',
    value: function _padFractionalZeros(value) {
      if (!value) return value;

      var parts = value.split(this.radix);
      if (parts.length < 2) parts.push('');
      parts[1] = parts[1].padEnd(this.scale, '0');
      return parts.join(this.radix);
    }

    /**
      @override
    */

  }, {
    key: 'unmaskedValue',
    get: function get$$1() {
      return this._removeThousandsSeparators(this._normalizeZeros(this.value)).replace(this.radix, '.');
    },
    set: function set$$1(unmaskedValue) {
      set(MaskedNumber.prototype.__proto__ || Object.getPrototypeOf(MaskedNumber.prototype), 'unmaskedValue', unmaskedValue.replace('.', this.radix), this);
    }

    /** Parsed Number */

  }, {
    key: 'number',
    get: function get$$1() {
      return Number(this.unmaskedValue);
    },
    set: function set$$1(number) {
      this.unmaskedValue = String(number);
    }

    /**
      Is negative allowed
      @readonly
    */

  }, {
    key: 'allowNegative',
    get: function get$$1() {
      return this.signed || this.min != null && this.min < 0 || this.max != null && this.max < 0;
    }
  }]);
  return MaskedNumber;
}(Masked);

MaskedNumber.DEFAULTS = {
  radix: ',',
  thousandsSeparator: '',
  mapToRadix: ['.'],
  scale: 2,
  signed: false,
  normalizeZeros: true,
  padFractionalZeros: false
};

/** Masking by RegExp */

var MaskedRegExp = function (_Masked) {
  inherits(MaskedRegExp, _Masked);

  function MaskedRegExp() {
    classCallCheck(this, MaskedRegExp);
    return possibleConstructorReturn(this, (MaskedRegExp.__proto__ || Object.getPrototypeOf(MaskedRegExp)).apply(this, arguments));
  }

  createClass(MaskedRegExp, [{
    key: '_update',

    /**
      @override
      @param {Object} opts
    */
    value: function _update(opts) {
      opts.validate = function (value) {
        return value.search(opts.mask) >= 0;
      };
      get(MaskedRegExp.prototype.__proto__ || Object.getPrototypeOf(MaskedRegExp.prototype), '_update', this).call(this, opts);
    }
  }]);
  return MaskedRegExp;
}(Masked);

/** Masking by custom Function */

var MaskedFunction = function (_Masked) {
  inherits(MaskedFunction, _Masked);

  function MaskedFunction() {
    classCallCheck(this, MaskedFunction);
    return possibleConstructorReturn(this, (MaskedFunction.__proto__ || Object.getPrototypeOf(MaskedFunction)).apply(this, arguments));
  }

  createClass(MaskedFunction, [{
    key: '_update',

    /**
      @override
      @param {Object} opts
    */
    value: function _update(opts) {
      opts.validate = opts.mask;
      get(MaskedFunction.prototype.__proto__ || Object.getPrototypeOf(MaskedFunction.prototype), '_update', this).call(this, opts);
    }
  }]);
  return MaskedFunction;
}(Masked);

/** Dynamic mask for choosing apropriate mask in run-time */
var MaskedDynamic = function (_Masked) {
  inherits(MaskedDynamic, _Masked);

  /**
    @param {Object} opts
  */

  /** Compliled {@link Masked} options */
  function MaskedDynamic(opts) {
    classCallCheck(this, MaskedDynamic);

    var _this = possibleConstructorReturn(this, (MaskedDynamic.__proto__ || Object.getPrototypeOf(MaskedDynamic)).call(this, _extends({}, MaskedDynamic.DEFAULTS, opts)));

    _this.currentMask = null;
    return _this;
  }

  /**
    @override
  */

  /** Chooses {@link Masked} depending on input value */

  /** Currently chosen mask */


  createClass(MaskedDynamic, [{
    key: '_update',
    value: function _update(opts) {
      get(MaskedDynamic.prototype.__proto__ || Object.getPrototypeOf(MaskedDynamic.prototype), '_update', this).call(this, opts);
      // mask could be totally dynamic with only `dispatch` option
      this.compiledMasks = Array.isArray(opts.mask) ? opts.mask.map(function (m) {
        return createMask(m);
      }) : [];
    }

    /**
      @override
    */

  }, {
    key: '_append',
    value: function _append(str) {
      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        args[_key - 1] = arguments[_key];
      }

      str = this.doPrepare.apply(this, [str].concat(toConsumableArray(args)));

      var details = this._applyDispatch.apply(this, [str].concat(toConsumableArray(args)));

      if (this.currentMask) {
        var _currentMask;

        details.aggregate((_currentMask = this.currentMask)._append.apply(_currentMask, [str].concat(toConsumableArray(args))));
      }

      return details;
    }
  }, {
    key: '_applyDispatch',
    value: function _applyDispatch() {
      var appended = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

      var oldValueLength = this.value.length;
      var inputValue = this.rawInputValue;
      var oldMask = this.currentMask;
      var details = new ChangeDetails();

      // dispatch SHOULD NOT modify mask

      for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
        args[_key2 - 1] = arguments[_key2];
      }

      this.currentMask = this.doDispatch.apply(this, [appended].concat(toConsumableArray(args)));

      // restore state after dispatch
      if (this.currentMask && this.currentMask !== oldMask) {
        // if mask changed reapply input
        this.currentMask.reset();
        // $FlowFixMe - it's ok, we don't change current mask
        this.currentMask._append(inputValue, { raw: true });
        details.shift = this.value.length - oldValueLength;
      }

      return details;
    }

    /**
      @override
    */

  }, {
    key: 'doDispatch',
    value: function doDispatch(appended) {
      var flags = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      return this.dispatch(appended, this, flags);
    }

    /**
      @override
    */

  }, {
    key: 'clone',
    value: function clone() {
      var m = new MaskedDynamic(this);
      m._value = this.value;

      // try to keep reference to compiled masks
      var currentMaskIndex = this.compiledMasks.indexOf(this.currentMask);
      if (this.currentMask) {
        m.currentMask = currentMaskIndex >= 0 ? m.compiledMasks[currentMaskIndex].assign(this.currentMask) : this.currentMask.clone();
      }

      return m;
    }

    /**
      @override
    */

  }, {
    key: 'reset',
    value: function reset() {
      if (this.currentMask) this.currentMask.reset();
      this.compiledMasks.forEach(function (cm) {
        return cm.reset();
      });
    }

    /**
      @override
    */

  }, {
    key: 'remove',


    /**
      @override
    */
    value: function remove() {
      var details = new ChangeDetails();
      if (this.currentMask) {
        var _currentMask2;

        details.aggregate((_currentMask2 = this.currentMask).remove.apply(_currentMask2, arguments))
        // update with dispatch
        .aggregate(this._applyDispatch());
      }

      return details;
    }

    /**
      @override
    */

  }, {
    key: 'extractInput',
    value: function extractInput() {
      var _currentMask3;

      return this.currentMask ? (_currentMask3 = this.currentMask).extractInput.apply(_currentMask3, arguments) : '';
    }

    /**
      @override
    */

  }, {
    key: '_extractTail',
    value: function _extractTail() {
      var _currentMask4, _babelHelpers$get;

      for (var _len3 = arguments.length, args = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
        args[_key3] = arguments[_key3];
      }

      return this.currentMask ? (_currentMask4 = this.currentMask)._extractTail.apply(_currentMask4, toConsumableArray(args)) : (_babelHelpers$get = get(MaskedDynamic.prototype.__proto__ || Object.getPrototypeOf(MaskedDynamic.prototype), '_extractTail', this)).call.apply(_babelHelpers$get, [this].concat(toConsumableArray(args)));
    }

    /**
      @override
    */

  }, {
    key: '_appendTail',
    value: function _appendTail(tail) {
      var details = new ChangeDetails();
      if (tail) details.aggregate(this._applyDispatch(tail.value));

      return details.aggregate(this.currentMask ? this.currentMask._appendTail(tail) : get(MaskedDynamic.prototype.__proto__ || Object.getPrototypeOf(MaskedDynamic.prototype), '_appendTail', this).call(this, tail));
    }

    /**
      @override
    */

  }, {
    key: 'doCommit',
    value: function doCommit() {
      if (this.currentMask) this.currentMask.doCommit();
      get(MaskedDynamic.prototype.__proto__ || Object.getPrototypeOf(MaskedDynamic.prototype), 'doCommit', this).call(this);
    }

    /**
      @override
    */

  }, {
    key: 'nearestInputPos',
    value: function nearestInputPos() {
      var _currentMask5, _babelHelpers$get2;

      for (var _len4 = arguments.length, args = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
        args[_key4] = arguments[_key4];
      }

      return this.currentMask ? (_currentMask5 = this.currentMask).nearestInputPos.apply(_currentMask5, toConsumableArray(args)) : (_babelHelpers$get2 = get(MaskedDynamic.prototype.__proto__ || Object.getPrototypeOf(MaskedDynamic.prototype), 'nearestInputPos', this)).call.apply(_babelHelpers$get2, [this].concat(toConsumableArray(args)));
    }
  }, {
    key: 'value',
    get: function get$$1() {
      return this.currentMask ? this.currentMask.value : '';
    },
    set: function set$$1(value) {
      set(MaskedDynamic.prototype.__proto__ || Object.getPrototypeOf(MaskedDynamic.prototype), 'value', value, this);
    }

    /**
      @override
    */

  }, {
    key: 'unmaskedValue',
    get: function get$$1() {
      return this.currentMask ? this.currentMask.unmaskedValue : '';
    },
    set: function set$$1(unmaskedValue) {
      set(MaskedDynamic.prototype.__proto__ || Object.getPrototypeOf(MaskedDynamic.prototype), 'unmaskedValue', unmaskedValue, this);
    }

    /**
      @override
    */

  }, {
    key: 'isComplete',
    get: function get$$1() {
      return !!this.currentMask && this.currentMask.isComplete;
    }
  }]);
  return MaskedDynamic;
}(Masked);

MaskedDynamic.DEFAULTS = {
  dispatch: function dispatch(appended, masked, flags) {
    if (!masked.compiledMasks.length) return;

    var inputValue = masked.rawInputValue;

    // simulate input
    var inputs = masked.compiledMasks.map(function (cm, index) {
      var m = cm.clone();
      m.rawInputValue = inputValue;
      m._append(appended, flags);

      return { value: m.rawInputValue.length, index: index };
    });

    // pop masks with longer values first
    inputs.sort(function (i1, i2) {
      return i2.value - i1.value;
    });

    return masked.compiledMasks[inputs[0].index];
  }
};

/**
 * Applies mask on element.
 * @constructor
 * @param {HTMLInput|UIElement} el - Element to apply mask
 * @param {Object} opts - Custom mask options
 * @return {InputMask}
 */
function IMask(el) {
  var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  // currently available only for input-like elements
  return new InputMask(el, opts);
}

/** {@link InputMask} */
IMask.InputMask = InputMask;

/** {@link Masked} */
IMask.Masked = Masked;
/** {@link MaskedPattern} */
IMask.MaskedPattern = MaskedPattern;
/** {@link MaskedNumber} */
IMask.MaskedNumber = MaskedNumber;
/** {@link MaskedDate} */
IMask.MaskedDate = MaskedDate;
/** {@link MaskedRegExp} */
IMask.MaskedRegExp = MaskedRegExp;
/** {@link MaskedFunction} */
IMask.MaskedFunction = MaskedFunction;
/** {@link MaskedDynamic} */
IMask.MaskedDynamic = MaskedDynamic;
/** {@link createMask} */
IMask.createMask = createMask;

g.IMask = IMask;

return IMask;

})));
//# sourceMappingURL=imask.js.map

/*!
 * Isotope PACKAGED v3.0.5
 *
 * Licensed GPLv3 for open source use
 * or Isotope Commercial License for commercial use
 *
 * https://isotope.metafizzy.co
 * Copyright 2017 Metafizzy
 */

!function(t,e){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("jquery")):t.jQueryBridget=e(t,t.jQuery)}(window,function(t,e){"use strict";function i(i,s,a){function u(t,e,o){var n,s="$()."+i+'("'+e+'")';return t.each(function(t,u){var h=a.data(u,i);if(!h)return void r(i+" not initialized. Cannot call methods, i.e. "+s);var d=h[e];if(!d||"_"==e.charAt(0))return void r(s+" is not a valid method");var l=d.apply(h,o);n=void 0===n?l:n}),void 0!==n?n:t}function h(t,e){t.each(function(t,o){var n=a.data(o,i);n?(n.option(e),n._init()):(n=new s(o,e),a.data(o,i,n))})}a=a||e||t.jQuery,a&&(s.prototype.option||(s.prototype.option=function(t){a.isPlainObject(t)&&(this.options=a.extend(!0,this.options,t))}),a.fn[i]=function(t){if("string"==typeof t){var e=n.call(arguments,1);return u(this,t,e)}return h(this,t),this},o(a))}function o(t){!t||t&&t.bridget||(t.bridget=i)}var n=Array.prototype.slice,s=t.console,r="undefined"==typeof s?function(){}:function(t){s.error(t)};return o(e||t.jQuery),i}),function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}("undefined"!=typeof window?window:this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},o=i[t]=i[t]||[];return o.indexOf(e)==-1&&o.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},o=i[t]=i[t]||{};return o[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var o=i.indexOf(e);return o!=-1&&i.splice(o,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){i=i.slice(0),e=e||[];for(var o=this._onceEvents&&this._onceEvents[t],n=0;n<i.length;n++){var s=i[n],r=o&&o[s];r&&(this.off(t,s),delete o[s]),s.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("get-size/get-size",[],function(){return e()}):"object"==typeof module&&module.exports?module.exports=e():t.getSize=e()}(window,function(){"use strict";function t(t){var e=parseFloat(t),i=t.indexOf("%")==-1&&!isNaN(e);return i&&e}function e(){}function i(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<h;e++){var i=u[e];t[i]=0}return t}function o(t){var e=getComputedStyle(t);return e||a("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),e}function n(){if(!d){d=!0;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box";var i=document.body||document.documentElement;i.appendChild(e);var n=o(e);s.isBoxSizeOuter=r=200==t(n.width),i.removeChild(e)}}function s(e){if(n(),"string"==typeof e&&(e=document.querySelector(e)),e&&"object"==typeof e&&e.nodeType){var s=o(e);if("none"==s.display)return i();var a={};a.width=e.offsetWidth,a.height=e.offsetHeight;for(var d=a.isBorderBox="border-box"==s.boxSizing,l=0;l<h;l++){var f=u[l],c=s[f],m=parseFloat(c);a[f]=isNaN(m)?0:m}var p=a.paddingLeft+a.paddingRight,y=a.paddingTop+a.paddingBottom,g=a.marginLeft+a.marginRight,v=a.marginTop+a.marginBottom,_=a.borderLeftWidth+a.borderRightWidth,I=a.borderTopWidth+a.borderBottomWidth,z=d&&r,x=t(s.width);x!==!1&&(a.width=x+(z?0:p+_));var S=t(s.height);return S!==!1&&(a.height=S+(z?0:y+I)),a.innerWidth=a.width-(p+_),a.innerHeight=a.height-(y+I),a.outerWidth=a.width+g,a.outerHeight=a.height+v,a}}var r,a="undefined"==typeof console?e:function(t){console.error(t)},u=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],h=u.length,d=!1;return s}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",e):"object"==typeof module&&module.exports?module.exports=e():t.matchesSelector=e()}(window,function(){"use strict";var t=function(){var t=window.Element.prototype;if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],i=0;i<e.length;i++){var o=e[i],n=o+"MatchesSelector";if(t[n])return n}}();return function(e,i){return e[t](i)}}),function(t,e){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("desandro-matches-selector")):t.fizzyUIUtils=e(t,t.matchesSelector)}(window,function(t,e){var i={};i.extend=function(t,e){for(var i in e)t[i]=e[i];return t},i.modulo=function(t,e){return(t%e+e)%e},i.makeArray=function(t){var e=[];if(Array.isArray(t))e=t;else if(t&&"object"==typeof t&&"number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e},i.removeFrom=function(t,e){var i=t.indexOf(e);i!=-1&&t.splice(i,1)},i.getParent=function(t,i){for(;t.parentNode&&t!=document.body;)if(t=t.parentNode,e(t,i))return t},i.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},i.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.filterFindElements=function(t,o){t=i.makeArray(t);var n=[];return t.forEach(function(t){if(t instanceof HTMLElement){if(!o)return void n.push(t);e(t,o)&&n.push(t);for(var i=t.querySelectorAll(o),s=0;s<i.length;s++)n.push(i[s])}}),n},i.debounceMethod=function(t,e,i){var o=t.prototype[e],n=e+"Timeout";t.prototype[e]=function(){var t=this[n];t&&clearTimeout(t);var e=arguments,s=this;this[n]=setTimeout(function(){o.apply(s,e),delete s[n]},i||100)}},i.docReady=function(t){var e=document.readyState;"complete"==e||"interactive"==e?setTimeout(t):document.addEventListener("DOMContentLoaded",t)},i.toDashed=function(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()};var o=t.console;return i.htmlInit=function(e,n){i.docReady(function(){var s=i.toDashed(n),r="data-"+s,a=document.querySelectorAll("["+r+"]"),u=document.querySelectorAll(".js-"+s),h=i.makeArray(a).concat(i.makeArray(u)),d=r+"-options",l=t.jQuery;h.forEach(function(t){var i,s=t.getAttribute(r)||t.getAttribute(d);try{i=s&&JSON.parse(s)}catch(a){return void(o&&o.error("Error parsing "+r+" on "+t.className+": "+a))}var u=new e(t,i);l&&l.data(t,n,u)})})},i}),function(t,e){"function"==typeof define&&define.amd?define("outlayer/item",["ev-emitter/ev-emitter","get-size/get-size"],e):"object"==typeof module&&module.exports?module.exports=e(require("ev-emitter"),require("get-size")):(t.Outlayer={},t.Outlayer.Item=e(t.EvEmitter,t.getSize))}(window,function(t,e){"use strict";function i(t){for(var e in t)return!1;return e=null,!0}function o(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}function n(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}var s=document.documentElement.style,r="string"==typeof s.transition?"transition":"WebkitTransition",a="string"==typeof s.transform?"transform":"WebkitTransform",u={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[r],h={transform:a,transition:r,transitionDuration:r+"Duration",transitionProperty:r+"Property",transitionDelay:r+"Delay"},d=o.prototype=Object.create(t.prototype);d.constructor=o,d._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},d.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},d.getSize=function(){this.size=e(this.element)},d.css=function(t){var e=this.element.style;for(var i in t){var o=h[i]||i;e[o]=t[i]}},d.getPosition=function(){var t=getComputedStyle(this.element),e=this.layout._getOption("originLeft"),i=this.layout._getOption("originTop"),o=t[e?"left":"right"],n=t[i?"top":"bottom"],s=this.layout.size,r=o.indexOf("%")!=-1?parseFloat(o)/100*s.width:parseInt(o,10),a=n.indexOf("%")!=-1?parseFloat(n)/100*s.height:parseInt(n,10);r=isNaN(r)?0:r,a=isNaN(a)?0:a,r-=e?s.paddingLeft:s.paddingRight,a-=i?s.paddingTop:s.paddingBottom,this.position.x=r,this.position.y=a},d.layoutPosition=function(){var t=this.layout.size,e={},i=this.layout._getOption("originLeft"),o=this.layout._getOption("originTop"),n=i?"paddingLeft":"paddingRight",s=i?"left":"right",r=i?"right":"left",a=this.position.x+t[n];e[s]=this.getXValue(a),e[r]="";var u=o?"paddingTop":"paddingBottom",h=o?"top":"bottom",d=o?"bottom":"top",l=this.position.y+t[u];e[h]=this.getYValue(l),e[d]="",this.css(e),this.emitEvent("layout",[this])},d.getXValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!e?t/this.layout.size.width*100+"%":t+"px"},d.getYValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&e?t/this.layout.size.height*100+"%":t+"px"},d._transitionTo=function(t,e){this.getPosition();var i=this.position.x,o=this.position.y,n=parseInt(t,10),s=parseInt(e,10),r=n===this.position.x&&s===this.position.y;if(this.setPosition(t,e),r&&!this.isTransitioning)return void this.layoutPosition();var a=t-i,u=e-o,h={};h.transform=this.getTranslate(a,u),this.transition({to:h,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})},d.getTranslate=function(t,e){var i=this.layout._getOption("originLeft"),o=this.layout._getOption("originTop");return t=i?t:-t,e=o?e:-e,"translate3d("+t+"px, "+e+"px, 0)"},d.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},d.moveTo=d._transitionTo,d.setPosition=function(t,e){this.position.x=parseInt(t,10),this.position.y=parseInt(e,10)},d._nonTransition=function(t){this.css(t.to),t.isCleaning&&this._removeStyles(t.to);for(var e in t.onTransitionEnd)t.onTransitionEnd[e].call(this)},d.transition=function(t){if(!parseFloat(this.layout.options.transitionDuration))return void this._nonTransition(t);var e=this._transn;for(var i in t.onTransitionEnd)e.onEnd[i]=t.onTransitionEnd[i];for(i in t.to)e.ingProperties[i]=!0,t.isCleaning&&(e.clean[i]=!0);if(t.from){this.css(t.from);var o=this.element.offsetHeight;o=null}this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0};var l="opacity,"+n(a);d.enableTransition=function(){if(!this.isTransitioning){var t=this.layout.options.transitionDuration;t="number"==typeof t?t+"ms":t,this.css({transitionProperty:l,transitionDuration:t,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(u,this,!1)}},d.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},d.onotransitionend=function(t){this.ontransitionend(t)};var f={"-webkit-transform":"transform"};d.ontransitionend=function(t){if(t.target===this.element){var e=this._transn,o=f[t.propertyName]||t.propertyName;if(delete e.ingProperties[o],i(e.ingProperties)&&this.disableTransition(),o in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[o]),o in e.onEnd){var n=e.onEnd[o];n.call(this),delete e.onEnd[o]}this.emitEvent("transitionEnd",[this])}},d.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(u,this,!1),this.isTransitioning=!1},d._removeStyles=function(t){var e={};for(var i in t)e[i]="";this.css(e)};var c={transitionProperty:"",transitionDuration:"",transitionDelay:""};return d.removeTransitionStyles=function(){this.css(c)},d.stagger=function(t){t=isNaN(t)?0:t,this.staggerDelay=t+"ms"},d.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},d.remove=function(){return r&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",function(){this.removeElem()}),void this.hide()):void this.removeElem()},d.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options,e={},i=this.getHideRevealTransitionEndProperty("visibleStyle");e[i]=this.onRevealTransitionEnd,this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0,onTransitionEnd:e})},d.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},d.getHideRevealTransitionEndProperty=function(t){var e=this.layout.options[t];if(e.opacity)return"opacity";for(var i in e)return i},d.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options,e={},i=this.getHideRevealTransitionEndProperty("hiddenStyle");e[i]=this.onHideTransitionEnd,this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:e})},d.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},d.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},o}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("outlayer/outlayer",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(i,o,n,s){return e(t,i,o,n,s)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./item")):t.Outlayer=e(t,t.EvEmitter,t.getSize,t.fizzyUIUtils,t.Outlayer.Item)}(window,function(t,e,i,o,n){"use strict";function s(t,e){var i=o.getQueryElement(t);if(!i)return void(u&&u.error("Bad element for "+this.constructor.namespace+": "+(i||t)));this.element=i,h&&(this.$element=h(this.element)),this.options=o.extend({},this.constructor.defaults),this.option(e);var n=++l;this.element.outlayerGUID=n,f[n]=this,this._create();var s=this._getOption("initLayout");s&&this.layout()}function r(t){function e(){t.apply(this,arguments)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}function a(t){if("number"==typeof t)return t;var e=t.match(/(^\d*\.?\d*)(\w*)/),i=e&&e[1],o=e&&e[2];if(!i.length)return 0;i=parseFloat(i);var n=m[o]||1;return i*n}var u=t.console,h=t.jQuery,d=function(){},l=0,f={};s.namespace="outlayer",s.Item=n,s.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var c=s.prototype;o.extend(c,e.prototype),c.option=function(t){o.extend(this.options,t)},c._getOption=function(t){var e=this.constructor.compatOptions[t];return e&&void 0!==this.options[e]?this.options[e]:this.options[t]},s.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},c._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),o.extend(this.element.style,this.options.containerStyle);var t=this._getOption("resize");t&&this.bindResize()},c.reloadItems=function(){this.items=this._itemize(this.element.children)},c._itemize=function(t){for(var e=this._filterFindItemElements(t),i=this.constructor.Item,o=[],n=0;n<e.length;n++){var s=e[n],r=new i(s,this);o.push(r)}return o},c._filterFindItemElements=function(t){return o.filterFindElements(t,this.options.itemSelector)},c.getItemElements=function(){return this.items.map(function(t){return t.element})},c.layout=function(){this._resetLayout(),this._manageStamps();var t=this._getOption("layoutInstant"),e=void 0!==t?t:!this._isLayoutInited;this.layoutItems(this.items,e),this._isLayoutInited=!0},c._init=c.layout,c._resetLayout=function(){this.getSize()},c.getSize=function(){this.size=i(this.element)},c._getMeasurement=function(t,e){var o,n=this.options[t];n?("string"==typeof n?o=this.element.querySelector(n):n instanceof HTMLElement&&(o=n),this[t]=o?i(o)[e]:n):this[t]=0},c.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},c._getItemsForLayout=function(t){return t.filter(function(t){return!t.isIgnored})},c._layoutItems=function(t,e){if(this._emitCompleteOnItems("layout",t),t&&t.length){var i=[];t.forEach(function(t){var o=this._getItemLayoutPosition(t);o.item=t,o.isInstant=e||t.isLayoutInstant,i.push(o)},this),this._processLayoutQueue(i)}},c._getItemLayoutPosition=function(){return{x:0,y:0}},c._processLayoutQueue=function(t){this.updateStagger(),t.forEach(function(t,e){this._positionItem(t.item,t.x,t.y,t.isInstant,e)},this)},c.updateStagger=function(){var t=this.options.stagger;return null===t||void 0===t?void(this.stagger=0):(this.stagger=a(t),this.stagger)},c._positionItem=function(t,e,i,o,n){o?t.goTo(e,i):(t.stagger(n*this.stagger),t.moveTo(e,i))},c._postLayout=function(){this.resizeContainer()},c.resizeContainer=function(){var t=this._getOption("resizeContainer");if(t){var e=this._getContainerSize();e&&(this._setContainerMeasure(e.width,!0),this._setContainerMeasure(e.height,!1))}},c._getContainerSize=d,c._setContainerMeasure=function(t,e){if(void 0!==t){var i=this.size;i.isBorderBox&&(t+=e?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},c._emitCompleteOnItems=function(t,e){function i(){n.dispatchEvent(t+"Complete",null,[e])}function o(){r++,r==s&&i()}var n=this,s=e.length;if(!e||!s)return void i();var r=0;e.forEach(function(e){e.once(t,o)})},c.dispatchEvent=function(t,e,i){var o=e?[e].concat(i):i;if(this.emitEvent(t,o),h)if(this.$element=this.$element||h(this.element),e){var n=h.Event(e);n.type=t,this.$element.trigger(n,i)}else this.$element.trigger(t,i)},c.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},c.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},c.stamp=function(t){t=this._find(t),t&&(this.stamps=this.stamps.concat(t),t.forEach(this.ignore,this))},c.unstamp=function(t){t=this._find(t),t&&t.forEach(function(t){o.removeFrom(this.stamps,t),this.unignore(t)},this)},c._find=function(t){if(t)return"string"==typeof t&&(t=this.element.querySelectorAll(t)),t=o.makeArray(t)},c._manageStamps=function(){this.stamps&&this.stamps.length&&(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},c._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},c._manageStamp=d,c._getElementOffset=function(t){var e=t.getBoundingClientRect(),o=this._boundingRect,n=i(t),s={left:e.left-o.left-n.marginLeft,top:e.top-o.top-n.marginTop,right:o.right-e.right-n.marginRight,bottom:o.bottom-e.bottom-n.marginBottom};return s},c.handleEvent=o.handleEvent,c.bindResize=function(){t.addEventListener("resize",this),this.isResizeBound=!0},c.unbindResize=function(){t.removeEventListener("resize",this),this.isResizeBound=!1},c.onresize=function(){this.resize()},o.debounceMethod(s,"onresize",100),c.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},c.needsResizeLayout=function(){var t=i(this.element),e=this.size&&t;return e&&t.innerWidth!==this.size.innerWidth},c.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e},c.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},c.prepended=function(t){var e=this._itemize(t);if(e.length){var i=this.items.slice(0);this.items=e.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(i)}},c.reveal=function(t){if(this._emitCompleteOnItems("reveal",t),t&&t.length){var e=this.updateStagger();t.forEach(function(t,i){t.stagger(i*e),t.reveal()})}},c.hide=function(t){if(this._emitCompleteOnItems("hide",t),t&&t.length){var e=this.updateStagger();t.forEach(function(t,i){t.stagger(i*e),t.hide()})}},c.revealItemElements=function(t){var e=this.getItems(t);this.reveal(e)},c.hideItemElements=function(t){var e=this.getItems(t);this.hide(e)},c.getItem=function(t){for(var e=0;e<this.items.length;e++){var i=this.items[e];if(i.element==t)return i}},c.getItems=function(t){t=o.makeArray(t);var e=[];return t.forEach(function(t){var i=this.getItem(t);i&&e.push(i)},this),e},c.remove=function(t){var e=this.getItems(t);this._emitCompleteOnItems("remove",e),e&&e.length&&e.forEach(function(t){t.remove(),o.removeFrom(this.items,t)},this)},c.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="",this.items.forEach(function(t){t.destroy()}),this.unbindResize();var e=this.element.outlayerGUID;delete f[e],delete this.element.outlayerGUID,h&&h.removeData(this.element,this.constructor.namespace)},s.data=function(t){t=o.getQueryElement(t);var e=t&&t.outlayerGUID;return e&&f[e]},s.create=function(t,e){var i=r(s);return i.defaults=o.extend({},s.defaults),o.extend(i.defaults,e),i.compatOptions=o.extend({},s.compatOptions),i.namespace=t,i.data=s.data,i.Item=r(n),o.htmlInit(i,t),h&&h.bridget&&h.bridget(t,i),i};var m={ms:1,s:1e3};return s.Item=n,s}),function(t,e){"function"==typeof define&&define.amd?define("isotope-layout/js/item",["outlayer/outlayer"],e):"object"==typeof module&&module.exports?module.exports=e(require("outlayer")):(t.Isotope=t.Isotope||{},t.Isotope.Item=e(t.Outlayer))}(window,function(t){"use strict";function e(){t.Item.apply(this,arguments)}var i=e.prototype=Object.create(t.Item.prototype),o=i._create;i._create=function(){this.id=this.layout.itemGUID++,o.call(this),this.sortData={}},i.updateSortData=function(){if(!this.isIgnored){this.sortData.id=this.id,this.sortData["original-order"]=this.id,this.sortData.random=Math.random();var t=this.layout.options.getSortData,e=this.layout._sorters;for(var i in t){var o=e[i];this.sortData[i]=o(this.element,this)}}};var n=i.destroy;return i.destroy=function(){n.apply(this,arguments),this.css({display:""})},e}),function(t,e){"function"==typeof define&&define.amd?define("isotope-layout/js/layout-mode",["get-size/get-size","outlayer/outlayer"],e):"object"==typeof module&&module.exports?module.exports=e(require("get-size"),require("outlayer")):(t.Isotope=t.Isotope||{},t.Isotope.LayoutMode=e(t.getSize,t.Outlayer))}(window,function(t,e){"use strict";function i(t){this.isotope=t,t&&(this.options=t.options[this.namespace],this.element=t.element,this.items=t.filteredItems,this.size=t.size)}var o=i.prototype,n=["_resetLayout","_getItemLayoutPosition","_manageStamp","_getContainerSize","_getElementOffset","needsResizeLayout","_getOption"];return n.forEach(function(t){o[t]=function(){return e.prototype[t].apply(this.isotope,arguments)}}),o.needsVerticalResizeLayout=function(){var e=t(this.isotope.element),i=this.isotope.size&&e;return i&&e.innerHeight!=this.isotope.size.innerHeight},o._getMeasurement=function(){this.isotope._getMeasurement.apply(this,arguments)},o.getColumnWidth=function(){this.getSegmentSize("column","Width")},o.getRowHeight=function(){this.getSegmentSize("row","Height")},o.getSegmentSize=function(t,e){var i=t+e,o="outer"+e;if(this._getMeasurement(i,o),!this[i]){var n=this.getFirstItemSize();this[i]=n&&n[o]||this.isotope.size["inner"+e]}},o.getFirstItemSize=function(){var e=this.isotope.filteredItems[0];return e&&e.element&&t(e.element)},o.layout=function(){this.isotope.layout.apply(this.isotope,arguments)},o.getSize=function(){this.isotope.getSize(),this.size=this.isotope.size},i.modes={},i.create=function(t,e){function n(){i.apply(this,arguments)}return n.prototype=Object.create(o),n.prototype.constructor=n,e&&(n.options=e),n.prototype.namespace=t,i.modes[t]=n,n},i}),function(t,e){"function"==typeof define&&define.amd?define("masonry-layout/masonry",["outlayer/outlayer","get-size/get-size"],e):"object"==typeof module&&module.exports?module.exports=e(require("outlayer"),require("get-size")):t.Masonry=e(t.Outlayer,t.getSize)}(window,function(t,e){var i=t.create("masonry");i.compatOptions.fitWidth="isFitWidth";var o=i.prototype;return o._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var t=0;t<this.cols;t++)this.colYs.push(0);this.maxY=0,this.horizontalColIndex=0},o.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var t=this.items[0],i=t&&t.element;this.columnWidth=i&&e(i).outerWidth||this.containerWidth}var o=this.columnWidth+=this.gutter,n=this.containerWidth+this.gutter,s=n/o,r=o-n%o,a=r&&r<1?"round":"floor";s=Math[a](s),this.cols=Math.max(s,1)},o.getContainerWidth=function(){var t=this._getOption("fitWidth"),i=t?this.element.parentNode:this.element,o=e(i);this.containerWidth=o&&o.innerWidth},o._getItemLayoutPosition=function(t){t.getSize();var e=t.size.outerWidth%this.columnWidth,i=e&&e<1?"round":"ceil",o=Math[i](t.size.outerWidth/this.columnWidth);o=Math.min(o,this.cols);for(var n=this.options.horizontalOrder?"_getHorizontalColPosition":"_getTopColPosition",s=this[n](o,t),r={x:this.columnWidth*s.col,y:s.y},a=s.y+t.size.outerHeight,u=o+s.col,h=s.col;h<u;h++)this.colYs[h]=a;return r},o._getTopColPosition=function(t){var e=this._getTopColGroup(t),i=Math.min.apply(Math,e);return{col:e.indexOf(i),y:i}},o._getTopColGroup=function(t){if(t<2)return this.colYs;for(var e=[],i=this.cols+1-t,o=0;o<i;o++)e[o]=this._getColGroupY(o,t);return e},o._getColGroupY=function(t,e){if(e<2)return this.colYs[t];var i=this.colYs.slice(t,t+e);return Math.max.apply(Math,i)},o._getHorizontalColPosition=function(t,e){var i=this.horizontalColIndex%this.cols,o=t>1&&i+t>this.cols;i=o?0:i;var n=e.size.outerWidth&&e.size.outerHeight;return this.horizontalColIndex=n?i+t:this.horizontalColIndex,{col:i,y:this._getColGroupY(i,t)}},o._manageStamp=function(t){var i=e(t),o=this._getElementOffset(t),n=this._getOption("originLeft"),s=n?o.left:o.right,r=s+i.outerWidth,a=Math.floor(s/this.columnWidth);a=Math.max(0,a);var u=Math.floor(r/this.columnWidth);u-=r%this.columnWidth?0:1,u=Math.min(this.cols-1,u);for(var h=this._getOption("originTop"),d=(h?o.top:o.bottom)+i.outerHeight,l=a;l<=u;l++)this.colYs[l]=Math.max(d,this.colYs[l])},o._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var t={height:this.maxY};return this._getOption("fitWidth")&&(t.width=this._getContainerFitWidth()),t},o._getContainerFitWidth=function(){for(var t=0,e=this.cols;--e&&0===this.colYs[e];)t++;return(this.cols-t)*this.columnWidth-this.gutter},o.needsResizeLayout=function(){var t=this.containerWidth;return this.getContainerWidth(),t!=this.containerWidth},i}),function(t,e){"function"==typeof define&&define.amd?define("isotope-layout/js/layout-modes/masonry",["../layout-mode","masonry-layout/masonry"],e):"object"==typeof module&&module.exports?module.exports=e(require("../layout-mode"),require("masonry-layout")):e(t.Isotope.LayoutMode,t.Masonry)}(window,function(t,e){"use strict";var i=t.create("masonry"),o=i.prototype,n={_getElementOffset:!0,layout:!0,_getMeasurement:!0};for(var s in e.prototype)n[s]||(o[s]=e.prototype[s]);var r=o.measureColumns;o.measureColumns=function(){this.items=this.isotope.filteredItems,r.call(this)};var a=o._getOption;return o._getOption=function(t){return"fitWidth"==t?void 0!==this.options.isFitWidth?this.options.isFitWidth:this.options.fitWidth:a.apply(this.isotope,arguments)},i}),function(t,e){"function"==typeof define&&define.amd?define("isotope-layout/js/layout-modes/fit-rows",["../layout-mode"],e):"object"==typeof exports?module.exports=e(require("../layout-mode")):e(t.Isotope.LayoutMode)}(window,function(t){"use strict";var e=t.create("fitRows"),i=e.prototype;return i._resetLayout=function(){this.x=0,this.y=0,this.maxY=0,this._getMeasurement("gutter","outerWidth")},i._getItemLayoutPosition=function(t){t.getSize();var e=t.size.outerWidth+this.gutter,i=this.isotope.size.innerWidth+this.gutter;0!==this.x&&e+this.x>i&&(this.x=0,this.y=this.maxY);var o={x:this.x,y:this.y};return this.maxY=Math.max(this.maxY,this.y+t.size.outerHeight),this.x+=e,o},i._getContainerSize=function(){return{height:this.maxY}},e}),function(t,e){"function"==typeof define&&define.amd?define("isotope-layout/js/layout-modes/vertical",["../layout-mode"],e):"object"==typeof module&&module.exports?module.exports=e(require("../layout-mode")):e(t.Isotope.LayoutMode)}(window,function(t){"use strict";var e=t.create("vertical",{horizontalAlignment:0}),i=e.prototype;return i._resetLayout=function(){this.y=0},i._getItemLayoutPosition=function(t){t.getSize();var e=(this.isotope.size.innerWidth-t.size.outerWidth)*this.options.horizontalAlignment,i=this.y;return this.y+=t.size.outerHeight,{x:e,y:i}},i._getContainerSize=function(){return{height:this.y}},e}),function(t,e){"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size","desandro-matches-selector/matches-selector","fizzy-ui-utils/utils","isotope-layout/js/item","isotope-layout/js/layout-mode","isotope-layout/js/layout-modes/masonry","isotope-layout/js/layout-modes/fit-rows","isotope-layout/js/layout-modes/vertical"],function(i,o,n,s,r,a){return e(t,i,o,n,s,r,a)}):"object"==typeof module&&module.exports?module.exports=e(t,require("outlayer"),require("get-size"),require("desandro-matches-selector"),require("fizzy-ui-utils"),require("isotope-layout/js/item"),require("isotope-layout/js/layout-mode"),require("isotope-layout/js/layout-modes/masonry"),require("isotope-layout/js/layout-modes/fit-rows"),require("isotope-layout/js/layout-modes/vertical")):t.Isotope=e(t,t.Outlayer,t.getSize,t.matchesSelector,t.fizzyUIUtils,t.Isotope.Item,t.Isotope.LayoutMode)}(window,function(t,e,i,o,n,s,r){function a(t,e){return function(i,o){for(var n=0;n<t.length;n++){var s=t[n],r=i.sortData[s],a=o.sortData[s];if(r>a||r<a){var u=void 0!==e[s]?e[s]:e,h=u?1:-1;return(r>a?1:-1)*h}}return 0}}var u=t.jQuery,h=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^\s+|\s+$/g,"")},d=e.create("isotope",{layoutMode:"masonry",isJQueryFiltering:!0,sortAscending:!0});d.Item=s,d.LayoutMode=r;var l=d.prototype;l._create=function(){this.itemGUID=0,this._sorters={},this._getSorters(),e.prototype._create.call(this),this.modes={},this.filteredItems=this.items,this.sortHistory=["original-order"];for(var t in r.modes)this._initLayoutMode(t)},l.reloadItems=function(){this.itemGUID=0,e.prototype.reloadItems.call(this)},l._itemize=function(){for(var t=e.prototype._itemize.apply(this,arguments),i=0;i<t.length;i++){var o=t[i];o.id=this.itemGUID++}return this._updateItemsSortData(t),t},l._initLayoutMode=function(t){var e=r.modes[t],i=this.options[t]||{};this.options[t]=e.options?n.extend(e.options,i):i,this.modes[t]=new e(this)},l.layout=function(){return!this._isLayoutInited&&this._getOption("initLayout")?void this.arrange():void this._layout()},l._layout=function(){var t=this._getIsInstant();this._resetLayout(),this._manageStamps(),this.layoutItems(this.filteredItems,t),this._isLayoutInited=!0},l.arrange=function(t){this.option(t),this._getIsInstant();var e=this._filter(this.items);this.filteredItems=e.matches,this._bindArrangeComplete(),this._isInstant?this._noTransition(this._hideReveal,[e]):this._hideReveal(e),this._sort(),this._layout()},l._init=l.arrange,l._hideReveal=function(t){this.reveal(t.needReveal),this.hide(t.needHide)},l._getIsInstant=function(){var t=this._getOption("layoutInstant"),e=void 0!==t?t:!this._isLayoutInited;return this._isInstant=e,e},l._bindArrangeComplete=function(){function t(){e&&i&&o&&n.dispatchEvent("arrangeComplete",null,[n.filteredItems])}var e,i,o,n=this;this.once("layoutComplete",function(){e=!0,t()}),this.once("hideComplete",function(){i=!0,t()}),this.once("revealComplete",function(){o=!0,t()})},l._filter=function(t){var e=this.options.filter;e=e||"*";for(var i=[],o=[],n=[],s=this._getFilterTest(e),r=0;r<t.length;r++){var a=t[r];if(!a.isIgnored){var u=s(a);u&&i.push(a),u&&a.isHidden?o.push(a):u||a.isHidden||n.push(a)}}return{matches:i,needReveal:o,needHide:n}},l._getFilterTest=function(t){
return u&&this.options.isJQueryFiltering?function(e){return u(e.element).is(t)}:"function"==typeof t?function(e){return t(e.element)}:function(e){return o(e.element,t)}},l.updateSortData=function(t){var e;t?(t=n.makeArray(t),e=this.getItems(t)):e=this.items,this._getSorters(),this._updateItemsSortData(e)},l._getSorters=function(){var t=this.options.getSortData;for(var e in t){var i=t[e];this._sorters[e]=f(i)}},l._updateItemsSortData=function(t){for(var e=t&&t.length,i=0;e&&i<e;i++){var o=t[i];o.updateSortData()}};var f=function(){function t(t){if("string"!=typeof t)return t;var i=h(t).split(" "),o=i[0],n=o.match(/^\[(.+)\]$/),s=n&&n[1],r=e(s,o),a=d.sortDataParsers[i[1]];return t=a?function(t){return t&&a(r(t))}:function(t){return t&&r(t)}}function e(t,e){return t?function(e){return e.getAttribute(t)}:function(t){var i=t.querySelector(e);return i&&i.textContent}}return t}();d.sortDataParsers={parseInt:function(t){return parseInt(t,10)},parseFloat:function(t){return parseFloat(t)}},l._sort=function(){if(this.options.sortBy){var t=n.makeArray(this.options.sortBy);this._getIsSameSortBy(t)||(this.sortHistory=t.concat(this.sortHistory));var e=a(this.sortHistory,this.options.sortAscending);this.filteredItems.sort(e)}},l._getIsSameSortBy=function(t){for(var e=0;e<t.length;e++)if(t[e]!=this.sortHistory[e])return!1;return!0},l._mode=function(){var t=this.options.layoutMode,e=this.modes[t];if(!e)throw new Error("No layout mode: "+t);return e.options=this.options[t],e},l._resetLayout=function(){e.prototype._resetLayout.call(this),this._mode()._resetLayout()},l._getItemLayoutPosition=function(t){return this._mode()._getItemLayoutPosition(t)},l._manageStamp=function(t){this._mode()._manageStamp(t)},l._getContainerSize=function(){return this._mode()._getContainerSize()},l.needsResizeLayout=function(){return this._mode().needsResizeLayout()},l.appended=function(t){var e=this.addItems(t);if(e.length){var i=this._filterRevealAdded(e);this.filteredItems=this.filteredItems.concat(i)}},l.prepended=function(t){var e=this._itemize(t);if(e.length){this._resetLayout(),this._manageStamps();var i=this._filterRevealAdded(e);this.layoutItems(this.filteredItems),this.filteredItems=i.concat(this.filteredItems),this.items=e.concat(this.items)}},l._filterRevealAdded=function(t){var e=this._filter(t);return this.hide(e.needHide),this.reveal(e.matches),this.layoutItems(e.matches,!0),e.matches},l.insert=function(t){var e=this.addItems(t);if(e.length){var i,o,n=e.length;for(i=0;i<n;i++)o=e[i],this.element.appendChild(o.element);var s=this._filter(e).matches;for(i=0;i<n;i++)e[i].isLayoutInstant=!0;for(this.arrange(),i=0;i<n;i++)delete e[i].isLayoutInstant;this.reveal(s)}};var c=l.remove;return l.remove=function(t){t=n.makeArray(t);var e=this.getItems(t);c.call(this,t);for(var i=e&&e.length,o=0;i&&o<i;o++){var s=e[o];n.removeFrom(this.filteredItems,s)}},l.shuffle=function(){for(var t=0;t<this.items.length;t++){var e=this.items[t];e.sortData.random=Math.random()}this.options.sortBy="random",this._sort(),this._layout()},l._noTransition=function(t,e){var i=this.options.transitionDuration;this.options.transitionDuration=0;var o=t.apply(this,e);return this.options.transitionDuration=i,o},l.getFilteredItemElements=function(){return this.filteredItems.map(function(t){return t.element})},d});
/*!

JSZip v3.1.5 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
*/
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.JSZip=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";var d=a("./utils"),e=a("./support"),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c.encode=function(a){for(var b,c,e,g,h,i,j,k=[],l=0,m=a.length,n=m,o="string"!==d.getTypeOf(a);l<a.length;)n=m-l,o?(b=a[l++],c=l<m?a[l++]:0,e=l<m?a[l++]:0):(b=a.charCodeAt(l++),c=l<m?a.charCodeAt(l++):0,e=l<m?a.charCodeAt(l++):0),g=b>>2,h=(3&b)<<4|c>>4,i=n>1?(15&c)<<2|e>>6:64,j=n>2?63&e:64,k.push(f.charAt(g)+f.charAt(h)+f.charAt(i)+f.charAt(j));return k.join("")},c.decode=function(a){var b,c,d,g,h,i,j,k=0,l=0,m="data:";if(a.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");var n=3*a.length/4;if(a.charAt(a.length-1)===f.charAt(64)&&n--,a.charAt(a.length-2)===f.charAt(64)&&n--,n%1!==0)throw new Error("Invalid base64 input, bad content length.");var o;for(o=e.uint8array?new Uint8Array(0|n):new Array(0|n);k<a.length;)g=f.indexOf(a.charAt(k++)),h=f.indexOf(a.charAt(k++)),i=f.indexOf(a.charAt(k++)),j=f.indexOf(a.charAt(k++)),b=g<<2|h>>4,c=(15&h)<<4|i>>2,d=(3&i)<<6|j,o[l++]=b,64!==i&&(o[l++]=c),64!==j&&(o[l++]=d);return o}},{"./support":30,"./utils":32}],2:[function(a,b,c){"use strict";function d(a,b,c,d,e){this.compressedSize=a,this.uncompressedSize=b,this.crc32=c,this.compression=d,this.compressedContent=e}var e=a("./external"),f=a("./stream/DataWorker"),g=a("./stream/DataLengthProbe"),h=a("./stream/Crc32Probe"),g=a("./stream/DataLengthProbe");d.prototype={getContentWorker:function(){var a=new f(e.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new g("data_length")),b=this;return a.on("end",function(){if(this.streamInfo.data_length!==b.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),a},getCompressedWorker:function(){return new f(e.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(a,b,c){return a.pipe(new h).pipe(new g("uncompressedSize")).pipe(b.compressWorker(c)).pipe(new g("compressedSize")).withStreamInfo("compression",b)},b.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(a,b,c){"use strict";var d=a("./stream/GenericWorker");c.STORE={magic:"\0\0",compressWorker:function(a){return new d("STORE compression")},uncompressWorker:function(){return new d("STORE decompression")}},c.DEFLATE=a("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(a,b,c){"use strict";function d(){for(var a,b=[],c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;b[c]=a}return b}function e(a,b,c,d){var e=h,f=d+c;a^=-1;for(var g=d;g<f;g++)a=a>>>8^e[255&(a^b[g])];return a^-1}function f(a,b,c,d){var e=h,f=d+c;a^=-1;for(var g=d;g<f;g++)a=a>>>8^e[255&(a^b.charCodeAt(g))];return a^-1}var g=a("./utils"),h=d();b.exports=function(a,b){if("undefined"==typeof a||!a.length)return 0;var c="string"!==g.getTypeOf(a);return c?e(0|b,a,a.length,0):f(0|b,a,a.length,0)}},{"./utils":32}],5:[function(a,b,c){"use strict";c.base64=!1,c.binary=!1,c.dir=!1,c.createFolders=!0,c.date=null,c.compression=null,c.compressionOptions=null,c.comment=null,c.unixPermissions=null,c.dosPermissions=null},{}],6:[function(a,b,c){"use strict";var d=null;d="undefined"!=typeof Promise?Promise:a("lie"),b.exports={Promise:d}},{lie:58}],7:[function(a,b,c){"use strict";function d(a,b){h.call(this,"FlateWorker/"+a),this._pako=null,this._pakoAction=a,this._pakoOptions=b,this.meta={}}var e="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,f=a("pako"),g=a("./utils"),h=a("./stream/GenericWorker"),i=e?"uint8array":"array";c.magic="\b\0",g.inherits(d,h),d.prototype.processChunk=function(a){this.meta=a.meta,null===this._pako&&this._createPako(),this._pako.push(g.transformTo(i,a.data),!1)},d.prototype.flush=function(){h.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){h.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new f[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var a=this;this._pako.onData=function(b){a.push({data:b,meta:a.meta})}},c.compressWorker=function(a){return new d("Deflate",a)},c.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:59}],8:[function(a,b,c){"use strict";function d(a,b,c,d){f.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=c,this.encodeFileName=d,this.streamFiles=a,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}var e=a("../utils"),f=a("../stream/GenericWorker"),g=a("../utf8"),h=a("../crc32"),i=a("../signature"),j=function(a,b){var c,d="";for(c=0;c<b;c++)d+=String.fromCharCode(255&a),a>>>=8;return d},k=function(a,b){var c=a;return a||(c=b?16893:33204),(65535&c)<<16},l=function(a,b){return 63&(a||0)},m=function(a,b,c,d,f,m){var n,o,p=a.file,q=a.compression,r=m!==g.utf8encode,s=e.transformTo("string",m(p.name)),t=e.transformTo("string",g.utf8encode(p.name)),u=p.comment,v=e.transformTo("string",m(u)),w=e.transformTo("string",g.utf8encode(u)),x=t.length!==p.name.length,y=w.length!==u.length,z="",A="",B="",C=p.dir,D=p.date,E={crc32:0,compressedSize:0,uncompressedSize:0};b&&!c||(E.crc32=a.crc32,E.compressedSize=a.compressedSize,E.uncompressedSize=a.uncompressedSize);var F=0;b&&(F|=8),r||!x&&!y||(F|=2048);var G=0,H=0;C&&(G|=16),"UNIX"===f?(H=798,G|=k(p.unixPermissions,C)):(H=20,G|=l(p.dosPermissions,C)),n=D.getUTCHours(),n<<=6,n|=D.getUTCMinutes(),n<<=5,n|=D.getUTCSeconds()/2,o=D.getUTCFullYear()-1980,o<<=4,o|=D.getUTCMonth()+1,o<<=5,o|=D.getUTCDate(),x&&(A=j(1,1)+j(h(s),4)+t,z+="up"+j(A.length,2)+A),y&&(B=j(1,1)+j(h(v),4)+w,z+="uc"+j(B.length,2)+B);var I="";I+="\n\0",I+=j(F,2),I+=q.magic,I+=j(n,2),I+=j(o,2),I+=j(E.crc32,4),I+=j(E.compressedSize,4),I+=j(E.uncompressedSize,4),I+=j(s.length,2),I+=j(z.length,2);var J=i.LOCAL_FILE_HEADER+I+s+z,K=i.CENTRAL_FILE_HEADER+j(H,2)+I+j(v.length,2)+"\0\0\0\0"+j(G,4)+j(d,4)+s+z+v;return{fileRecord:J,dirRecord:K}},n=function(a,b,c,d,f){var g="",h=e.transformTo("string",f(d));return g=i.CENTRAL_DIRECTORY_END+"\0\0\0\0"+j(a,2)+j(a,2)+j(b,4)+j(c,4)+j(h.length,2)+h},o=function(a){var b="";return b=i.DATA_DESCRIPTOR+j(a.crc32,4)+j(a.compressedSize,4)+j(a.uncompressedSize,4)};e.inherits(d,f),d.prototype.push=function(a){var b=a.meta.percent||0,c=this.entriesCount,d=this._sources.length;this.accumulate?this.contentBuffer.push(a):(this.bytesWritten+=a.data.length,f.prototype.push.call(this,{data:a.data,meta:{currentFile:this.currentFile,percent:c?(b+100*(c-d-1))/c:100}}))},d.prototype.openedSource=function(a){this.currentSourceOffset=this.bytesWritten,this.currentFile=a.file.name;var b=this.streamFiles&&!a.file.dir;if(b){var c=m(a,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:c.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(a){this.accumulate=!1;var b=this.streamFiles&&!a.file.dir,c=m(a,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(c.dirRecord),b)this.push({data:o(a),meta:{percent:100}});else for(this.push({data:c.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var a=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var c=this.bytesWritten-a,d=n(this.dirRecords.length,c,a,this.zipComment,this.encodeFileName);this.push({data:d,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(a){this._sources.push(a);var b=this;return a.on("data",function(a){b.processChunk(a)}),a.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),a.on("error",function(a){b.error(a)}),this},d.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(a){var b=this._sources;if(!f.prototype.error.call(this,a))return!1;for(var c=0;c<b.length;c++)try{b[c].error(a)}catch(a){}return!0},d.prototype.lock=function(){f.prototype.lock.call(this);for(var a=this._sources,b=0;b<a.length;b++)a[b].lock()},b.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(a,b,c){"use strict";var d=a("../compressions"),e=a("./ZipFileWorker"),f=function(a,b){var c=a||b,e=d[c];if(!e)throw new Error(c+" is not a valid compression method !");return e};c.generateWorker=function(a,b,c){var d=new e(b.streamFiles,c,b.platform,b.encodeFileName),g=0;try{a.forEach(function(a,c){g++;var e=f(c.options.compression,b.compression),h=c.options.compressionOptions||b.compressionOptions||{},i=c.dir,j=c.date;c._compressWorker(e,h).withStreamInfo("file",{name:a,dir:i,date:j,comment:c.comment||"",unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions}).pipe(d)}),d.entriesCount=g}catch(h){d.error(h)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(a,b,c){"use strict";function d(){if(!(this instanceof d))return new d;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var a=new d;for(var b in this)"function"!=typeof this[b]&&(a[b]=this[b]);return a}}d.prototype=a("./object"),d.prototype.loadAsync=a("./load"),d.support=a("./support"),d.defaults=a("./defaults"),d.version="3.1.5",d.loadAsync=function(a,b){return(new d).loadAsync(a,b)},d.external=a("./external"),b.exports=d},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(a,b,c){"use strict";function d(a){return new f.Promise(function(b,c){var d=a.decompressed.getContentWorker().pipe(new i);d.on("error",function(a){c(a)}).on("end",function(){d.streamInfo.crc32!==a.decompressed.crc32?c(new Error("Corrupted zip : CRC32 mismatch")):b()}).resume()})}var e=a("./utils"),f=a("./external"),g=a("./utf8"),e=a("./utils"),h=a("./zipEntries"),i=a("./stream/Crc32Probe"),j=a("./nodejsUtils");b.exports=function(a,b){var c=this;return b=e.extend(b||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:g.utf8decode}),j.isNode&&j.isStream(a)?f.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):e.prepareContent("the loaded zip file",a,!0,b.optimizedBinaryString,b.base64).then(function(a){var c=new h(b);return c.load(a),c}).then(function(a){var c=[f.Promise.resolve(a)],e=a.files;if(b.checkCRC32)for(var g=0;g<e.length;g++)c.push(d(e[g]));return f.Promise.all(c)}).then(function(a){for(var d=a.shift(),e=d.files,f=0;f<e.length;f++){var g=e[f];c.file(g.fileNameStr,g.decompressed,{binary:!0,optimizedBinaryString:!0,date:g.date,dir:g.dir,comment:g.fileCommentStr.length?g.fileCommentStr:null,unixPermissions:g.unixPermissions,dosPermissions:g.dosPermissions,createFolders:b.createFolders})}return d.zipComment.length&&(c.comment=d.zipComment),c})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(a,b,c){"use strict";function d(a,b){f.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(b)}var e=a("../utils"),f=a("../stream/GenericWorker");e.inherits(d,f),d.prototype._bindStream=function(a){var b=this;this._stream=a,a.pause(),a.on("data",function(a){b.push({data:a,meta:{percent:0}})}).on("error",function(a){b.isPaused?this.generatedError=a:b.error(a)}).on("end",function(){b.isPaused?b._upstreamEnded=!0:b.end()})},d.prototype.pause=function(){return!!f.prototype.pause.call(this)&&(this._stream.pause(),!0)},d.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},b.exports=d},{"../stream/GenericWorker":28,"../utils":32}],13:[function(a,b,c){"use strict";function d(a,b,c){e.call(this,b),this._helper=a;var d=this;a.on("data",function(a,b){d.push(a)||d._helper.pause(),c&&c(b)}).on("error",function(a){d.emit("error",a)}).on("end",function(){d.push(null)})}var e=a("readable-stream").Readable,f=a("../utils");f.inherits(d,e),d.prototype._read=function(){this._helper.resume()},b.exports=d},{"../utils":32,"readable-stream":16}],14:[function(a,b,c){"use strict";b.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(a,b){return new Buffer(a,b)},allocBuffer:function(a){return Buffer.alloc?Buffer.alloc(a):new Buffer(a)},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&"function"==typeof a.on&&"function"==typeof a.pause&&"function"==typeof a.resume}}},{}],15:[function(a,b,c){"use strict";function d(a){return"[object RegExp]"===Object.prototype.toString.call(a)}var e=a("./utf8"),f=a("./utils"),g=a("./stream/GenericWorker"),h=a("./stream/StreamHelper"),i=a("./defaults"),j=a("./compressedObject"),k=a("./zipObject"),l=a("./generate"),m=a("./nodejsUtils"),n=a("./nodejs/NodejsStreamInputAdapter"),o=function(a,b,c){var d,e=f.getTypeOf(b),h=f.extend(c||{},i);h.date=h.date||new Date,null!==h.compression&&(h.compression=h.compression.toUpperCase()),"string"==typeof h.unixPermissions&&(h.unixPermissions=parseInt(h.unixPermissions,8)),h.unixPermissions&&16384&h.unixPermissions&&(h.dir=!0),h.dosPermissions&&16&h.dosPermissions&&(h.dir=!0),h.dir&&(a=q(a)),h.createFolders&&(d=p(a))&&r.call(this,d,!0);var l="string"===e&&h.binary===!1&&h.base64===!1;c&&"undefined"!=typeof c.binary||(h.binary=!l);var o=b instanceof j&&0===b.uncompressedSize;(o||h.dir||!b||0===b.length)&&(h.base64=!1,h.binary=!0,b="",h.compression="STORE",e="string");var s=null;s=b instanceof j||b instanceof g?b:m.isNode&&m.isStream(b)?new n(a,b):f.prepareContent(a,b,h.binary,h.optimizedBinaryString,h.base64);var t=new k(a,s,h);this.files[a]=t},p=function(a){"/"===a.slice(-1)&&(a=a.substring(0,a.length-1));var b=a.lastIndexOf("/");return b>0?a.substring(0,b):""},q=function(a){return"/"!==a.slice(-1)&&(a+="/"),a},r=function(a,b){return b="undefined"!=typeof b?b:i.createFolders,a=q(a),this.files[a]||o.call(this,a,null,{dir:!0,createFolders:b}),this.files[a]},s={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(a){var b,c,d;for(b in this.files)this.files.hasOwnProperty(b)&&(d=this.files[b],c=b.slice(this.root.length,b.length),c&&b.slice(0,this.root.length)===this.root&&a(c,d))},filter:function(a){var b=[];return this.forEach(function(c,d){a(c,d)&&b.push(d)}),b},file:function(a,b,c){if(1===arguments.length){if(d(a)){var e=a;return this.filter(function(a,b){return!b.dir&&e.test(a)})}var f=this.files[this.root+a];return f&&!f.dir?f:null}return a=this.root+a,o.call(this,a,b,c),this},folder:function(a){if(!a)return this;if(d(a))return this.filter(function(b,c){return c.dir&&a.test(b)});var b=this.root+a,c=r.call(this,b),e=this.clone();return e.root=c.name,e},remove:function(a){a=this.root+a;var b=this.files[a];if(b||("/"!==a.slice(-1)&&(a+="/"),b=this.files[a]),b&&!b.dir)delete this.files[a];else for(var c=this.filter(function(b,c){return c.name.slice(0,a.length)===a}),d=0;d<c.length;d++)delete this.files[c[d].name];return this},generate:function(a){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(a){var b,c={};try{if(c=f.extend(a||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:e.utf8encode}),c.type=c.type.toLowerCase(),c.compression=c.compression.toUpperCase(),"binarystring"===c.type&&(c.type="string"),!c.type)throw new Error("No output type specified.");f.checkSupport(c.type),"darwin"!==c.platform&&"freebsd"!==c.platform&&"linux"!==c.platform&&"sunos"!==c.platform||(c.platform="UNIX"),"win32"===c.platform&&(c.platform="DOS");var d=c.comment||this.comment||"";b=l.generateWorker(this,c,d)}catch(i){b=new g("error"),b.error(i)}return new h(b,c.type||"string",c.mimeType)},generateAsync:function(a,b){return this.generateInternalStream(a).accumulate(b)},generateNodeStream:function(a,b){return a=a||{},a.type||(a.type="nodebuffer"),this.generateInternalStream(a).toNodejsStream(b)}};b.exports=s},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(a,b,c){b.exports=a("stream")},{stream:void 0}],17:[function(a,b,c){"use strict";function d(a){e.call(this,a);for(var b=0;b<this.data.length;b++)a[b]=255&a[b]}var e=a("./DataReader"),f=a("../utils");f.inherits(d,e),d.prototype.byteAt=function(a){return this.data[this.zero+a]},d.prototype.lastIndexOfSignature=function(a){for(var b=a.charCodeAt(0),c=a.charCodeAt(1),d=a.charCodeAt(2),e=a.charCodeAt(3),f=this.length-4;f>=0;--f)if(this.data[f]===b&&this.data[f+1]===c&&this.data[f+2]===d&&this.data[f+3]===e)return f-this.zero;return-1},d.prototype.readAndCheckSignature=function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1),d=a.charCodeAt(2),e=a.charCodeAt(3),f=this.readData(4);return b===f[0]&&c===f[1]&&d===f[2]&&e===f[3]},d.prototype.readData=function(a){if(this.checkOffset(a),0===a)return[];var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,b},b.exports=d},{"../utils":32,"./DataReader":18}],18:[function(a,b,c){"use strict";function d(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}var e=a("../utils");d.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(a){},readInt:function(a){var b,c=0;for(this.checkOffset(a),b=this.index+a-1;b>=this.index;b--)c=(c<<8)+this.byteAt(b);return this.index+=a,c},readString:function(a){return e.transformTo("string",this.readData(a))},readData:function(a){},lastIndexOfSignature:function(a){},readAndCheckSignature:function(a){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},b.exports=d},{"../utils":32}],19:[function(a,b,c){"use strict";function d(a){e.call(this,a)}var e=a("./Uint8ArrayReader"),f=a("../utils");f.inherits(d,e),d.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,b},b.exports=d},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(a,b,c){"use strict";function d(a){e.call(this,a)}var e=a("./DataReader"),f=a("../utils");f.inherits(d,e),d.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},d.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},d.prototype.readAndCheckSignature=function(a){var b=this.readData(4);return a===b},d.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,b},b.exports=d},{"../utils":32,"./DataReader":18}],21:[function(a,b,c){"use strict";function d(a){e.call(this,a)}var e=a("./ArrayReader"),f=a("../utils");f.inherits(d,e),d.prototype.readData=function(a){if(this.checkOffset(a),0===a)return new Uint8Array(0);var b=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,b},b.exports=d},{"../utils":32,"./ArrayReader":17}],22:[function(a,b,c){"use strict";var d=a("../utils"),e=a("../support"),f=a("./ArrayReader"),g=a("./StringReader"),h=a("./NodeBufferReader"),i=a("./Uint8ArrayReader");b.exports=function(a){var b=d.getTypeOf(a);return d.checkSupport(b),"string"!==b||e.uint8array?"nodebuffer"===b?new h(a):e.uint8array?new i(d.transformTo("uint8array",a)):new f(d.transformTo("array",a)):new g(a)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(a,b,c){"use strict";c.LOCAL_FILE_HEADER="PK",c.CENTRAL_FILE_HEADER="PK",c.CENTRAL_DIRECTORY_END="PK",c.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",c.ZIP64_CENTRAL_DIRECTORY_END="PK",c.DATA_DESCRIPTOR="PK\b"},{}],24:[function(a,b,c){"use strict";function d(a){e.call(this,"ConvertWorker to "+a),this.destType=a}var e=a("./GenericWorker"),f=a("../utils");f.inherits(d,e),d.prototype.processChunk=function(a){this.push({data:f.transformTo(this.destType,a.data),meta:a.meta})},b.exports=d},{"../utils":32,"./GenericWorker":28}],25:[function(a,b,c){"use strict";function d(){e.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}var e=a("./GenericWorker"),f=a("../crc32"),g=a("../utils");g.inherits(d,e),d.prototype.processChunk=function(a){this.streamInfo.crc32=f(a.data,this.streamInfo.crc32||0),this.push(a)},b.exports=d},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(a,b,c){"use strict";function d(a){f.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}var e=a("../utils"),f=a("./GenericWorker");e.inherits(d,f),d.prototype.processChunk=function(a){if(a){var b=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=b+a.data.length}f.prototype.processChunk.call(this,a)},b.exports=d},{"../utils":32,"./GenericWorker":28}],27:[function(a,b,c){"use strict";function d(a){f.call(this,"DataWorker");var b=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,a.then(function(a){b.dataIsReady=!0,b.data=a,b.max=a&&a.length||0,b.type=e.getTypeOf(a),b.isPaused||b._tickAndRepeat()},function(a){b.error(a)})}var e=a("../utils"),f=a("./GenericWorker"),g=16384;e.inherits(d,f),d.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this.data=null},d.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,e.delay(this._tickAndRepeat,[],this)),!0)},d.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(e.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},d.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var a=g,b=null,c=Math.min(this.max,this.index+a);if(this.index>=this.max)return this.end();switch(this.type){case"string":b=this.data.substring(this.index,c);break;case"uint8array":b=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":b=this.data.slice(this.index,c)}return this.index=c,this.push({data:b,meta:{percent:this.max?this.index/this.max*100:0}})},b.exports=d},{"../utils":32,"./GenericWorker":28}],28:[function(a,b,c){"use strict";function d(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}d.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,b){return this._listeners[a].push(b),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,b){if(this._listeners[a])for(var c=0;c<this._listeners[a].length;c++)this._listeners[a][c].call(this,b)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var b=this;return a.on("data",function(a){b.processChunk(a)}),a.on("end",function(){b.end()}),a.on("error",function(a){b.error(a)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,b){return this.extraStreamInfo[a]=b,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},b.exports=d},{}],29:[function(a,b,c){"use strict";function d(a,b,c){switch(a){case"blob":return h.newBlob(h.transformTo("arraybuffer",b),c);case"base64":return k.encode(b);default:return h.transformTo(a,b)}}function e(a,b){var c,d=0,e=null,f=0;for(c=0;c<b.length;c++)f+=b[c].length;switch(a){case"string":return b.join("");case"array":return Array.prototype.concat.apply([],b);case"uint8array":for(e=new Uint8Array(f),c=0;c<b.length;c++)e.set(b[c],d),d+=b[c].length;return e;case"nodebuffer":return Buffer.concat(b);default:throw new Error("concat : unsupported type '"+a+"'")}}function f(a,b){return new m.Promise(function(c,f){var g=[],h=a._internalType,i=a._outputType,j=a._mimeType;a.on("data",function(a,c){g.push(a),b&&b(c)}).on("error",function(a){g=[],f(a)}).on("end",function(){try{var a=d(i,e(h,g),j);c(a)}catch(b){f(b)}g=[]}).resume()})}function g(a,b,c){var d=b;switch(b){case"blob":case"arraybuffer":d="uint8array";break;case"base64":d="string"}try{this._internalType=d,this._outputType=b,this._mimeType=c,h.checkSupport(d),this._worker=a.pipe(new i(d)),a.lock()}catch(e){this._worker=new j("error"),this._worker.error(e)}}var h=a("../utils"),i=a("./ConvertWorker"),j=a("./GenericWorker"),k=a("../base64"),l=a("../support"),m=a("../external"),n=null;if(l.nodestream)try{n=a("../nodejs/NodejsStreamOutputAdapter")}catch(o){}g.prototype={accumulate:function(a){return f(this,a)},on:function(a,b){var c=this;return"data"===a?this._worker.on(a,function(a){b.call(c,a.data,a.meta)}):this._worker.on(a,function(){h.delay(b,arguments,c)}),this},resume:function(){return h.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(a){if(h.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new n(this,{objectMode:"nodebuffer"!==this._outputType},a)}},b.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(a,b,c){"use strict";if(c.base64=!0,c.array=!0,c.string=!0,c.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,c.nodebuffer="undefined"!=typeof Buffer,c.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)c.blob=!1;else{var d=new ArrayBuffer(0);try{c.blob=0===new Blob([d],{type:"application/zip"}).size}catch(e){try{var f=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,g=new f;g.append(d),c.blob=0===g.getBlob("application/zip").size}catch(e){c.blob=!1}}}try{c.nodestream=!!a("readable-stream").Readable}catch(e){c.nodestream=!1}},{"readable-stream":16}],31:[function(a,b,c){"use strict";function d(){i.call(this,"utf-8 decode"),this.leftOver=null}function e(){i.call(this,"utf-8 encode")}for(var f=a("./utils"),g=a("./support"),h=a("./nodejsUtils"),i=a("./stream/GenericWorker"),j=new Array(256),k=0;k<256;k++)j[k]=k>=252?6:k>=248?5:k>=240?4:k>=224?3:k>=192?2:1;j[254]=j[254]=1;var l=function(a){var b,c,d,e,f,h=a.length,i=0;for(e=0;e<h;e++)c=a.charCodeAt(e),55296===(64512&c)&&e+1<h&&(d=a.charCodeAt(e+1),56320===(64512&d)&&(c=65536+(c-55296<<10)+(d-56320),e++)),i+=c<128?1:c<2048?2:c<65536?3:4;for(b=g.uint8array?new Uint8Array(i):new Array(i),f=0,e=0;f<i;e++)c=a.charCodeAt(e),55296===(64512&c)&&e+1<h&&(d=a.charCodeAt(e+1),56320===(64512&d)&&(c=65536+(c-55296<<10)+(d-56320),e++)),c<128?b[f++]=c:c<2048?(b[f++]=192|c>>>6,b[f++]=128|63&c):c<65536?(b[f++]=224|c>>>12,b[f++]=128|c>>>6&63,b[f++]=128|63&c):(b[f++]=240|c>>>18,b[f++]=128|c>>>12&63,b[f++]=128|c>>>6&63,b[f++]=128|63&c);return b},m=function(a,b){var c;for(b=b||a.length,b>a.length&&(b=a.length),c=b-1;c>=0&&128===(192&a[c]);)c--;return c<0?b:0===c?b:c+j[a[c]]>b?c:b},n=function(a){var b,c,d,e,g=a.length,h=new Array(2*g);for(c=0,b=0;b<g;)if(d=a[b++],d<128)h[c++]=d;else if(e=j[d],e>4)h[c++]=65533,b+=e-1;else{for(d&=2===e?31:3===e?15:7;e>1&&b<g;)d=d<<6|63&a[b++],e--;e>1?h[c++]=65533:d<65536?h[c++]=d:(d-=65536,h[c++]=55296|d>>10&1023,h[c++]=56320|1023&d)}return h.length!==c&&(h.subarray?h=h.subarray(0,c):h.length=c),f.applyFromCharCode(h)};c.utf8encode=function(a){return g.nodebuffer?h.newBufferFrom(a,"utf-8"):l(a)},c.utf8decode=function(a){return g.nodebuffer?f.transformTo("nodebuffer",a).toString("utf-8"):(a=f.transformTo(g.uint8array?"uint8array":"array",a),n(a))},f.inherits(d,i),d.prototype.processChunk=function(a){var b=f.transformTo(g.uint8array?"uint8array":"array",a.data);if(this.leftOver&&this.leftOver.length){if(g.uint8array){var d=b;b=new Uint8Array(d.length+this.leftOver.length),b.set(this.leftOver,0),b.set(d,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var e=m(b),h=b;e!==b.length&&(g.uint8array?(h=b.subarray(0,e),this.leftOver=b.subarray(e,b.length)):(h=b.slice(0,e),this.leftOver=b.slice(e,b.length))),this.push({data:c.utf8decode(h),meta:a.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:c.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},c.Utf8DecodeWorker=d,f.inherits(e,i),e.prototype.processChunk=function(a){this.push({data:c.utf8encode(a.data),meta:a.meta})},c.Utf8EncodeWorker=e},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(a,b,c){"use strict";function d(a){var b=null;return b=i.uint8array?new Uint8Array(a.length):new Array(a.length),f(a,b)}function e(a){return a}function f(a,b){for(var c=0;c<a.length;++c)b[c]=255&a.charCodeAt(c);return b}function g(a){var b=65536,d=c.getTypeOf(a),e=!0;if("uint8array"===d?e=n.applyCanBeUsed.uint8array:"nodebuffer"===d&&(e=n.applyCanBeUsed.nodebuffer),e)for(;b>1;)try{return n.stringifyByChunk(a,d,b)}catch(f){b=Math.floor(b/2)}return n.stringifyByChar(a)}function h(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];
return b}var i=a("./support"),j=a("./base64"),k=a("./nodejsUtils"),l=a("core-js/library/fn/set-immediate"),m=a("./external");c.newBlob=function(a,b){c.checkSupport("blob");try{return new Blob([a],{type:b})}catch(d){try{var e=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,f=new e;return f.append(a),f.getBlob(b)}catch(d){throw new Error("Bug : can't construct the Blob.")}}};var n={stringifyByChunk:function(a,b,c){var d=[],e=0,f=a.length;if(f<=c)return String.fromCharCode.apply(null,a);for(;e<f;)"array"===b||"nodebuffer"===b?d.push(String.fromCharCode.apply(null,a.slice(e,Math.min(e+c,f)))):d.push(String.fromCharCode.apply(null,a.subarray(e,Math.min(e+c,f)))),e+=c;return d.join("")},stringifyByChar:function(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(a){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,k.allocBuffer(1)).length}catch(a){return!1}}()}};c.applyFromCharCode=g;var o={};o.string={string:e,array:function(a){return f(a,new Array(a.length))},arraybuffer:function(a){return o.string.uint8array(a).buffer},uint8array:function(a){return f(a,new Uint8Array(a.length))},nodebuffer:function(a){return f(a,k.allocBuffer(a.length))}},o.array={string:g,array:e,arraybuffer:function(a){return new Uint8Array(a).buffer},uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return k.newBufferFrom(a)}},o.arraybuffer={string:function(a){return g(new Uint8Array(a))},array:function(a){return h(new Uint8Array(a),new Array(a.byteLength))},arraybuffer:e,uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return k.newBufferFrom(new Uint8Array(a))}},o.uint8array={string:g,array:function(a){return h(a,new Array(a.length))},arraybuffer:function(a){return a.buffer},uint8array:e,nodebuffer:function(a){return k.newBufferFrom(a)}},o.nodebuffer={string:g,array:function(a){return h(a,new Array(a.length))},arraybuffer:function(a){return o.nodebuffer.uint8array(a).buffer},uint8array:function(a){return h(a,new Uint8Array(a.length))},nodebuffer:e},c.transformTo=function(a,b){if(b||(b=""),!a)return b;c.checkSupport(a);var d=c.getTypeOf(b),e=o[d][a](b);return e},c.getTypeOf=function(a){return"string"==typeof a?"string":"[object Array]"===Object.prototype.toString.call(a)?"array":i.nodebuffer&&k.isBuffer(a)?"nodebuffer":i.uint8array&&a instanceof Uint8Array?"uint8array":i.arraybuffer&&a instanceof ArrayBuffer?"arraybuffer":void 0},c.checkSupport=function(a){var b=i[a.toLowerCase()];if(!b)throw new Error(a+" is not supported by this platform")},c.MAX_VALUE_16BITS=65535,c.MAX_VALUE_32BITS=-1,c.pretty=function(a){var b,c,d="";for(c=0;c<(a||"").length;c++)b=a.charCodeAt(c),d+="\\x"+(b<16?"0":"")+b.toString(16).toUpperCase();return d},c.delay=function(a,b,c){l(function(){a.apply(c||null,b||[])})},c.inherits=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c},c.extend=function(){var a,b,c={};for(a=0;a<arguments.length;a++)for(b in arguments[a])arguments[a].hasOwnProperty(b)&&"undefined"==typeof c[b]&&(c[b]=arguments[a][b]);return c},c.prepareContent=function(a,b,e,f,g){var h=m.Promise.resolve(b).then(function(a){var b=i.blob&&(a instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(a))!==-1);return b&&"undefined"!=typeof FileReader?new m.Promise(function(b,c){var d=new FileReader;d.onload=function(a){b(a.target.result)},d.onerror=function(a){c(a.target.error)},d.readAsArrayBuffer(a)}):a});return h.then(function(b){var h=c.getTypeOf(b);return h?("arraybuffer"===h?b=c.transformTo("uint8array",b):"string"===h&&(g?b=j.decode(b):e&&f!==!0&&(b=d(b))),b):m.Promise.reject(new Error("Can't read the data of '"+a+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"core-js/library/fn/set-immediate":36}],33:[function(a,b,c){"use strict";function d(a){this.files=[],this.loadOptions=a}var e=a("./reader/readerFor"),f=a("./utils"),g=a("./signature"),h=a("./zipEntry"),i=(a("./utf8"),a("./support"));d.prototype={checkSignature:function(a){if(!this.reader.readAndCheckSignature(a)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+f.pretty(b)+", expected "+f.pretty(a)+")")}},isSignature:function(a,b){var c=this.reader.index;this.reader.setIndex(a);var d=this.reader.readString(4),e=d===b;return this.reader.setIndex(c),e},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var a=this.reader.readData(this.zipCommentLength),b=i.uint8array?"uint8array":"array",c=f.transformTo(b,a);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var a,b,c,d=this.zip64EndOfCentralSize-44,e=0;e<d;)a=this.reader.readInt(2),b=this.reader.readInt(4),c=this.reader.readData(b),this.zip64ExtensibleData[a]={id:a,length:b,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var a,b;for(a=0;a<this.files.length;a++)b=this.files[a],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(g.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var a;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(g.CENTRAL_FILE_HEADER);)a=new h({zip64:this.zip64},this.loadOptions),a.readCentralPart(this.reader),this.files.push(a);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var a=this.reader.lastIndexOfSignature(g.CENTRAL_DIRECTORY_END);if(a<0){var b=!this.isSignature(0,g.LOCAL_FILE_HEADER);throw b?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(a);var c=a;if(this.checkSignature(g.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===f.MAX_VALUE_16BITS||this.diskWithCentralDirStart===f.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===f.MAX_VALUE_16BITS||this.centralDirRecords===f.MAX_VALUE_16BITS||this.centralDirSize===f.MAX_VALUE_32BITS||this.centralDirOffset===f.MAX_VALUE_32BITS){if(this.zip64=!0,a=this.reader.lastIndexOfSignature(g.ZIP64_CENTRAL_DIRECTORY_LOCATOR),a<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(a),this.checkSignature(g.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,g.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(g.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(g.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var e=c-d;if(e>0)this.isSignature(c,g.CENTRAL_FILE_HEADER)||(this.reader.zero=e);else if(e<0)throw new Error("Corrupted zip: missing "+Math.abs(e)+" bytes.")},prepareReader:function(a){this.reader=e(a)},load:function(a){this.prepareReader(a),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},b.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(a,b,c){"use strict";function d(a,b){this.options=a,this.loadOptions=b}var e=a("./reader/readerFor"),f=a("./utils"),g=a("./compressedObject"),h=a("./crc32"),i=a("./utf8"),j=a("./compressions"),k=a("./support"),l=0,m=3,n=function(a){for(var b in j)if(j.hasOwnProperty(b)&&j[b].magic===a)return j[b];return null};d.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},readLocalPart:function(a){var b,c;if(a.skip(22),this.fileNameLength=a.readInt(2),c=a.readInt(2),this.fileName=a.readData(this.fileNameLength),a.skip(c),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(b=n(this.compressionMethod),null===b)throw new Error("Corrupted zip : compression "+f.pretty(this.compressionMethod)+" unknown (inner file : "+f.transformTo("string",this.fileName)+")");this.decompressed=new g(this.compressedSize,this.uncompressedSize,this.crc32,b,a.readData(this.compressedSize))},readCentralPart:function(a){this.versionMadeBy=a.readInt(2),a.skip(2),this.bitFlag=a.readInt(2),this.compressionMethod=a.readString(2),this.date=a.readDate(),this.crc32=a.readInt(4),this.compressedSize=a.readInt(4),this.uncompressedSize=a.readInt(4);var b=a.readInt(2);if(this.extraFieldsLength=a.readInt(2),this.fileCommentLength=a.readInt(2),this.diskNumberStart=a.readInt(2),this.internalFileAttributes=a.readInt(2),this.externalFileAttributes=a.readInt(4),this.localHeaderOffset=a.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");a.skip(b),this.readExtraFields(a),this.parseZIP64ExtraField(a),this.fileComment=a.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var a=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),a===l&&(this.dosPermissions=63&this.externalFileAttributes),a===m&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(a){if(this.extraFields[1]){var b=e(this.extraFields[1].value);this.uncompressedSize===f.MAX_VALUE_32BITS&&(this.uncompressedSize=b.readInt(8)),this.compressedSize===f.MAX_VALUE_32BITS&&(this.compressedSize=b.readInt(8)),this.localHeaderOffset===f.MAX_VALUE_32BITS&&(this.localHeaderOffset=b.readInt(8)),this.diskNumberStart===f.MAX_VALUE_32BITS&&(this.diskNumberStart=b.readInt(4))}},readExtraFields:function(a){var b,c,d,e=a.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});a.index<e;)b=a.readInt(2),c=a.readInt(2),d=a.readData(c),this.extraFields[b]={id:b,length:c,value:d}},handleUTF8:function(){var a=k.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=i.utf8decode(this.fileName),this.fileCommentStr=i.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(null!==b)this.fileNameStr=b;else{var c=f.transformTo(a,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}var d=this.findExtraFieldUnicodeComment();if(null!==d)this.fileCommentStr=d;else{var e=f.transformTo(a,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(e)}}},findExtraFieldUnicodePath:function(){var a=this.extraFields[28789];if(a){var b=e(a.value);return 1!==b.readInt(1)?null:h(this.fileName)!==b.readInt(4)?null:i.utf8decode(b.readData(a.length-5))}return null},findExtraFieldUnicodeComment:function(){var a=this.extraFields[25461];if(a){var b=e(a.value);return 1!==b.readInt(1)?null:h(this.fileComment)!==b.readInt(4)?null:i.utf8decode(b.readData(a.length-5))}return null}},b.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(a,b,c){"use strict";var d=a("./stream/StreamHelper"),e=a("./stream/DataWorker"),f=a("./utf8"),g=a("./compressedObject"),h=a("./stream/GenericWorker"),i=function(a,b,c){this.name=a,this.dir=c.dir,this.date=c.date,this.comment=c.comment,this.unixPermissions=c.unixPermissions,this.dosPermissions=c.dosPermissions,this._data=b,this._dataBinary=c.binary,this.options={compression:c.compression,compressionOptions:c.compressionOptions}};i.prototype={internalStream:function(a){var b=null,c="string";try{if(!a)throw new Error("No output type specified.");c=a.toLowerCase();var e="string"===c||"text"===c;"binarystring"!==c&&"text"!==c||(c="string"),b=this._decompressWorker();var g=!this._dataBinary;g&&!e&&(b=b.pipe(new f.Utf8EncodeWorker)),!g&&e&&(b=b.pipe(new f.Utf8DecodeWorker))}catch(i){b=new h("error"),b.error(i)}return new d(b,c,"")},async:function(a,b){return this.internalStream(a).accumulate(b)},nodeStream:function(a,b){return this.internalStream(a||"nodebuffer").toNodejsStream(b)},_compressWorker:function(a,b){if(this._data instanceof g&&this._data.compression.magic===a.magic)return this._data.getCompressedWorker();var c=this._decompressWorker();return this._dataBinary||(c=c.pipe(new f.Utf8EncodeWorker)),g.createWorkerFrom(c,a,b)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof h?this._data:new e(this._data)}};for(var j=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],k=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},l=0;l<j.length;l++)i.prototype[j[l]]=k;b.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(a,b,c){a("../modules/web.immediate"),b.exports=a("../modules/_core").setImmediate},{"../modules/_core":40,"../modules/web.immediate":56}],37:[function(a,b,c){b.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a}},{}],38:[function(a,b,c){var d=a("./_is-object");b.exports=function(a){if(!d(a))throw TypeError(a+" is not an object!");return a}},{"./_is-object":51}],39:[function(a,b,c){var d={}.toString;b.exports=function(a){return d.call(a).slice(8,-1)}},{}],40:[function(a,b,c){var d=b.exports={version:"2.3.0"};"number"==typeof __e&&(__e=d)},{}],41:[function(a,b,c){var d=a("./_a-function");b.exports=function(a,b,c){if(d(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}}},{"./_a-function":37}],42:[function(a,b,c){b.exports=!a("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":45}],43:[function(a,b,c){var d=a("./_is-object"),e=a("./_global").document,f=d(e)&&d(e.createElement);b.exports=function(a){return f?e.createElement(a):{}}},{"./_global":46,"./_is-object":51}],44:[function(a,b,c){var d=a("./_global"),e=a("./_core"),f=a("./_ctx"),g=a("./_hide"),h="prototype",i=function(a,b,c){var j,k,l,m=a&i.F,n=a&i.G,o=a&i.S,p=a&i.P,q=a&i.B,r=a&i.W,s=n?e:e[b]||(e[b]={}),t=s[h],u=n?d:o?d[b]:(d[b]||{})[h];n&&(c=b);for(j in c)k=!m&&u&&void 0!==u[j],k&&j in s||(l=k?u[j]:c[j],s[j]=n&&"function"!=typeof u[j]?c[j]:q&&k?f(l,d):r&&u[j]==l?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b[h]=a[h],b}(l):p&&"function"==typeof l?f(Function.call,l):l,p&&((s.virtual||(s.virtual={}))[j]=l,a&i.R&&t&&!t[j]&&g(t,j,l)))};i.F=1,i.G=2,i.S=4,i.P=8,i.B=16,i.W=32,i.U=64,i.R=128,b.exports=i},{"./_core":40,"./_ctx":41,"./_global":46,"./_hide":47}],45:[function(a,b,c){b.exports=function(a){try{return!!a()}catch(b){return!0}}},{}],46:[function(a,b,c){var d=b.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=d)},{}],47:[function(a,b,c){var d=a("./_object-dp"),e=a("./_property-desc");b.exports=a("./_descriptors")?function(a,b,c){return d.f(a,b,e(1,c))}:function(a,b,c){return a[b]=c,a}},{"./_descriptors":42,"./_object-dp":52,"./_property-desc":53}],48:[function(a,b,c){b.exports=a("./_global").document&&document.documentElement},{"./_global":46}],49:[function(a,b,c){b.exports=!a("./_descriptors")&&!a("./_fails")(function(){return 7!=Object.defineProperty(a("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":42,"./_dom-create":43,"./_fails":45}],50:[function(a,b,c){b.exports=function(a,b,c){var d=void 0===c;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3])}return a.apply(c,b)}},{}],51:[function(a,b,c){b.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}},{}],52:[function(a,b,c){var d=a("./_an-object"),e=a("./_ie8-dom-define"),f=a("./_to-primitive"),g=Object.defineProperty;c.f=a("./_descriptors")?Object.defineProperty:function(a,b,c){if(d(a),b=f(b,!0),d(c),e)try{return g(a,b,c)}catch(h){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a}},{"./_an-object":38,"./_descriptors":42,"./_ie8-dom-define":49,"./_to-primitive":55}],53:[function(a,b,c){b.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}},{}],54:[function(a,b,c){var d,e,f,g=a("./_ctx"),h=a("./_invoke"),i=a("./_html"),j=a("./_dom-create"),k=a("./_global"),l=k.process,m=k.setImmediate,n=k.clearImmediate,o=k.MessageChannel,p=0,q={},r="onreadystatechange",s=function(){var a=+this;if(q.hasOwnProperty(a)){var b=q[a];delete q[a],b()}},t=function(a){s.call(a.data)};m&&n||(m=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return q[++p]=function(){h("function"==typeof a?a:Function(a),b)},d(p),p},n=function(a){delete q[a]},"process"==a("./_cof")(l)?d=function(a){l.nextTick(g(s,a,1))}:o?(e=new o,f=e.port2,e.port1.onmessage=t,d=g(f.postMessage,f,1)):k.addEventListener&&"function"==typeof postMessage&&!k.importScripts?(d=function(a){k.postMessage(a+"","*")},k.addEventListener("message",t,!1)):d=r in j("script")?function(a){i.appendChild(j("script"))[r]=function(){i.removeChild(this),s.call(a)}}:function(a){setTimeout(g(s,a,1),0)}),b.exports={set:m,clear:n}},{"./_cof":39,"./_ctx":41,"./_dom-create":43,"./_global":46,"./_html":48,"./_invoke":50}],55:[function(a,b,c){var d=a("./_is-object");b.exports=function(a,b){if(!d(a))return a;var c,e;if(b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;if("function"==typeof(c=a.valueOf)&&!d(e=c.call(a)))return e;if(!b&&"function"==typeof(c=a.toString)&&!d(e=c.call(a)))return e;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":51}],56:[function(a,b,c){var d=a("./_export"),e=a("./_task");d(d.G+d.B,{setImmediate:e.set,clearImmediate:e.clear})},{"./_export":44,"./_task":54}],57:[function(a,b,c){(function(a){"use strict";function c(){k=!0;for(var a,b,c=l.length;c;){for(b=l,l=[],a=-1;++a<c;)b[a]();c=l.length}k=!1}function d(a){1!==l.push(a)||k||e()}var e,f=a.MutationObserver||a.WebKitMutationObserver;if(f){var g=0,h=new f(c),i=a.document.createTextNode("");h.observe(i,{characterData:!0}),e=function(){i.data=g=++g%2}}else if(a.setImmediate||"undefined"==typeof a.MessageChannel)e="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var b=a.document.createElement("script");b.onreadystatechange=function(){c(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},a.document.documentElement.appendChild(b)}:function(){setTimeout(c,0)};else{var j=new a.MessageChannel;j.port1.onmessage=c,e=function(){j.port2.postMessage(0)}}var k,l=[];b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],58:[function(a,b,c){"use strict";function d(){}function e(a){if("function"!=typeof a)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,a!==d&&i(this,a)}function f(a,b,c){this.promise=a,"function"==typeof b&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),"function"==typeof c&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}function g(a,b,c){o(function(){var d;try{d=b(c)}catch(e){return p.reject(a,e)}d===a?p.reject(a,new TypeError("Cannot resolve promise with itself")):p.resolve(a,d)})}function h(a){var b=a&&a.then;if(a&&("object"==typeof a||"function"==typeof a)&&"function"==typeof b)return function(){b.apply(a,arguments)}}function i(a,b){function c(b){f||(f=!0,p.reject(a,b))}function d(b){f||(f=!0,p.resolve(a,b))}function e(){b(d,c)}var f=!1,g=j(e);"error"===g.status&&c(g.value)}function j(a,b){var c={};try{c.value=a(b),c.status="success"}catch(d){c.status="error",c.value=d}return c}function k(a){return a instanceof this?a:p.resolve(new this(d),a)}function l(a){var b=new this(d);return p.reject(b,a)}function m(a){function b(a,b){function d(a){g[b]=a,++h!==e||f||(f=!0,p.resolve(j,g))}c.resolve(a).then(d,function(a){f||(f=!0,p.reject(j,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=new Array(e),h=0,i=-1,j=new this(d);++i<e;)b(a[i],i);return j}function n(a){function b(a){c.resolve(a).then(function(a){f||(f=!0,p.resolve(h,a))},function(a){f||(f=!0,p.reject(h,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=-1,h=new this(d);++g<e;)b(a[g]);return h}var o=a("immediate"),p={},q=["REJECTED"],r=["FULFILLED"],s=["PENDING"];b.exports=e,e.prototype["catch"]=function(a){return this.then(null,a)},e.prototype.then=function(a,b){if("function"!=typeof a&&this.state===r||"function"!=typeof b&&this.state===q)return this;var c=new this.constructor(d);if(this.state!==s){var e=this.state===r?a:b;g(c,e,this.outcome)}else this.queue.push(new f(c,a,b));return c},f.prototype.callFulfilled=function(a){p.resolve(this.promise,a)},f.prototype.otherCallFulfilled=function(a){g(this.promise,this.onFulfilled,a)},f.prototype.callRejected=function(a){p.reject(this.promise,a)},f.prototype.otherCallRejected=function(a){g(this.promise,this.onRejected,a)},p.resolve=function(a,b){var c=j(h,b);if("error"===c.status)return p.reject(a,c.value);var d=c.value;if(d)i(a,d);else{a.state=r,a.outcome=b;for(var e=-1,f=a.queue.length;++e<f;)a.queue[e].callFulfilled(b)}return a},p.reject=function(a,b){a.state=q,a.outcome=b;for(var c=-1,d=a.queue.length;++c<d;)a.queue[c].callRejected(b);return a},e.resolve=k,e.reject=l,e.all=m,e.race=n},{immediate:57}],59:[function(a,b,c){"use strict";var d=a("./lib/utils/common").assign,e=a("./lib/deflate"),f=a("./lib/inflate"),g=a("./lib/zlib/constants"),h={};d(h,e,f,g),b.exports=h},{"./lib/deflate":60,"./lib/inflate":61,"./lib/utils/common":62,"./lib/zlib/constants":65}],60:[function(a,b,c){"use strict";function d(a){if(!(this instanceof d))return new d(a);this.options=i.assign({level:s,method:u,chunkSize:16384,windowBits:15,memLevel:8,strategy:t,to:""},a||{});var b=this.options;b.raw&&b.windowBits>0?b.windowBits=-b.windowBits:b.gzip&&b.windowBits>0&&b.windowBits<16&&(b.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var c=h.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(c!==p)throw new Error(k[c]);if(b.header&&h.deflateSetHeader(this.strm,b.header),b.dictionary){var e;if(e="string"==typeof b.dictionary?j.string2buf(b.dictionary):"[object ArrayBuffer]"===m.call(b.dictionary)?new Uint8Array(b.dictionary):b.dictionary,c=h.deflateSetDictionary(this.strm,e),c!==p)throw new Error(k[c]);this._dict_set=!0}}function e(a,b){var c=new d(b);if(c.push(a,!0),c.err)throw c.msg||k[c.err];return c.result}function f(a,b){return b=b||{},b.raw=!0,e(a,b)}function g(a,b){return b=b||{},b.gzip=!0,e(a,b)}var h=a("./zlib/deflate"),i=a("./utils/common"),j=a("./utils/strings"),k=a("./zlib/messages"),l=a("./zlib/zstream"),m=Object.prototype.toString,n=0,o=4,p=0,q=1,r=2,s=-1,t=0,u=8;d.prototype.push=function(a,b){var c,d,e=this.strm,f=this.options.chunkSize;if(this.ended)return!1;d=b===~~b?b:b===!0?o:n,"string"==typeof a?e.input=j.string2buf(a):"[object ArrayBuffer]"===m.call(a)?e.input=new Uint8Array(a):e.input=a,e.next_in=0,e.avail_in=e.input.length;do{if(0===e.avail_out&&(e.output=new i.Buf8(f),e.next_out=0,e.avail_out=f),c=h.deflate(e,d),c!==q&&c!==p)return this.onEnd(c),this.ended=!0,!1;0!==e.avail_out&&(0!==e.avail_in||d!==o&&d!==r)||("string"===this.options.to?this.onData(j.buf2binstring(i.shrinkBuf(e.output,e.next_out))):this.onData(i.shrinkBuf(e.output,e.next_out)))}while((e.avail_in>0||0===e.avail_out)&&c!==q);return d===o?(c=h.deflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===p):d!==r||(this.onEnd(p),e.avail_out=0,!0)},d.prototype.onData=function(a){this.chunks.push(a)},d.prototype.onEnd=function(a){a===p&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg},c.Deflate=d,c.deflate=e,c.deflateRaw=f,c.gzip=g},{"./utils/common":62,"./utils/strings":63,"./zlib/deflate":67,"./zlib/messages":72,"./zlib/zstream":74}],61:[function(a,b,c){"use strict";function d(a){if(!(this instanceof d))return new d(a);this.options=h.assign({chunkSize:16384,windowBits:0,to:""},a||{});var b=this.options;b.raw&&b.windowBits>=0&&b.windowBits<16&&(b.windowBits=-b.windowBits,0===b.windowBits&&(b.windowBits=-15)),!(b.windowBits>=0&&b.windowBits<16)||a&&a.windowBits||(b.windowBits+=32),b.windowBits>15&&b.windowBits<48&&0===(15&b.windowBits)&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var c=g.inflateInit2(this.strm,b.windowBits);if(c!==j.Z_OK)throw new Error(k[c]);this.header=new m,g.inflateGetHeader(this.strm,this.header)}function e(a,b){var c=new d(b);if(c.push(a,!0),c.err)throw c.msg||k[c.err];return c.result}function f(a,b){return b=b||{},b.raw=!0,e(a,b)}var g=a("./zlib/inflate"),h=a("./utils/common"),i=a("./utils/strings"),j=a("./zlib/constants"),k=a("./zlib/messages"),l=a("./zlib/zstream"),m=a("./zlib/gzheader"),n=Object.prototype.toString;d.prototype.push=function(a,b){var c,d,e,f,k,l,m=this.strm,o=this.options.chunkSize,p=this.options.dictionary,q=!1;if(this.ended)return!1;d=b===~~b?b:b===!0?j.Z_FINISH:j.Z_NO_FLUSH,"string"==typeof a?m.input=i.binstring2buf(a):"[object ArrayBuffer]"===n.call(a)?m.input=new Uint8Array(a):m.input=a,m.next_in=0,m.avail_in=m.input.length;do{if(0===m.avail_out&&(m.output=new h.Buf8(o),m.next_out=0,m.avail_out=o),c=g.inflate(m,j.Z_NO_FLUSH),c===j.Z_NEED_DICT&&p&&(l="string"==typeof p?i.string2buf(p):"[object ArrayBuffer]"===n.call(p)?new Uint8Array(p):p,c=g.inflateSetDictionary(this.strm,l)),c===j.Z_BUF_ERROR&&q===!0&&(c=j.Z_OK,q=!1),c!==j.Z_STREAM_END&&c!==j.Z_OK)return this.onEnd(c),this.ended=!0,!1;m.next_out&&(0!==m.avail_out&&c!==j.Z_STREAM_END&&(0!==m.avail_in||d!==j.Z_FINISH&&d!==j.Z_SYNC_FLUSH)||("string"===this.options.to?(e=i.utf8border(m.output,m.next_out),f=m.next_out-e,k=i.buf2string(m.output,e),m.next_out=f,m.avail_out=o-f,f&&h.arraySet(m.output,m.output,e,f,0),this.onData(k)):this.onData(h.shrinkBuf(m.output,m.next_out)))),0===m.avail_in&&0===m.avail_out&&(q=!0)}while((m.avail_in>0||0===m.avail_out)&&c!==j.Z_STREAM_END);return c===j.Z_STREAM_END&&(d=j.Z_FINISH),d===j.Z_FINISH?(c=g.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===j.Z_OK):d!==j.Z_SYNC_FLUSH||(this.onEnd(j.Z_OK),m.avail_out=0,!0)},d.prototype.onData=function(a){this.chunks.push(a)},d.prototype.onEnd=function(a){a===j.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=h.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg},c.Inflate=d,c.inflate=e,c.inflateRaw=f,c.ungzip=e},{"./utils/common":62,"./utils/strings":63,"./zlib/constants":65,"./zlib/gzheader":68,"./zlib/inflate":70,"./zlib/messages":72,"./zlib/zstream":74}],62:[function(a,b,c){"use strict";var d="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;c.assign=function(a){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var c=b.shift();if(c){if("object"!=typeof c)throw new TypeError(c+"must be non-object");for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}}return a},c.shrinkBuf=function(a,b){return a.length===b?a:a.subarray?a.subarray(0,b):(a.length=b,a)};var e={arraySet:function(a,b,c,d,e){if(b.subarray&&a.subarray)return void a.set(b.subarray(c,c+d),e);for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){var b,c,d,e,f,g;for(d=0,b=0,c=a.length;b<c;b++)d+=a[b].length;for(g=new Uint8Array(d),e=0,b=0,c=a.length;b<c;b++)f=a[b],g.set(f,e),e+=f.length;return g}},f={arraySet:function(a,b,c,d,e){for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){return[].concat.apply([],a)}};c.setTyped=function(a){a?(c.Buf8=Uint8Array,c.Buf16=Uint16Array,c.Buf32=Int32Array,c.assign(c,e)):(c.Buf8=Array,c.Buf16=Array,c.Buf32=Array,c.assign(c,f))},c.setTyped(d)},{}],63:[function(a,b,c){"use strict";function d(a,b){if(b<65537&&(a.subarray&&g||!a.subarray&&f))return String.fromCharCode.apply(null,e.shrinkBuf(a,b));for(var c="",d=0;d<b;d++)c+=String.fromCharCode(a[d]);return c}var e=a("./common"),f=!0,g=!0;try{String.fromCharCode.apply(null,[0])}catch(h){f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(h){g=!1}for(var i=new e.Buf8(256),j=0;j<256;j++)i[j]=j>=252?6:j>=248?5:j>=240?4:j>=224?3:j>=192?2:1;i[254]=i[254]=1,c.string2buf=function(a){var b,c,d,f,g,h=a.length,i=0;for(f=0;f<h;f++)c=a.charCodeAt(f),55296===(64512&c)&&f+1<h&&(d=a.charCodeAt(f+1),56320===(64512&d)&&(c=65536+(c-55296<<10)+(d-56320),f++)),i+=c<128?1:c<2048?2:c<65536?3:4;for(b=new e.Buf8(i),g=0,f=0;g<i;f++)c=a.charCodeAt(f),55296===(64512&c)&&f+1<h&&(d=a.charCodeAt(f+1),56320===(64512&d)&&(c=65536+(c-55296<<10)+(d-56320),f++)),c<128?b[g++]=c:c<2048?(b[g++]=192|c>>>6,b[g++]=128|63&c):c<65536?(b[g++]=224|c>>>12,b[g++]=128|c>>>6&63,b[g++]=128|63&c):(b[g++]=240|c>>>18,b[g++]=128|c>>>12&63,b[g++]=128|c>>>6&63,b[g++]=128|63&c);return b},c.buf2binstring=function(a){return d(a,a.length)},c.binstring2buf=function(a){for(var b=new e.Buf8(a.length),c=0,d=b.length;c<d;c++)b[c]=a.charCodeAt(c);return b},c.buf2string=function(a,b){var c,e,f,g,h=b||a.length,j=new Array(2*h);for(e=0,c=0;c<h;)if(f=a[c++],f<128)j[e++]=f;else if(g=i[f],g>4)j[e++]=65533,c+=g-1;else{for(f&=2===g?31:3===g?15:7;g>1&&c<h;)f=f<<6|63&a[c++],g--;g>1?j[e++]=65533:f<65536?j[e++]=f:(f-=65536,j[e++]=55296|f>>10&1023,j[e++]=56320|1023&f)}return d(j,e)},c.utf8border=function(a,b){var c;for(b=b||a.length,b>a.length&&(b=a.length),c=b-1;c>=0&&128===(192&a[c]);)c--;return c<0?b:0===c?b:c+i[a[c]]>b?c:b}},{"./common":62}],64:[function(a,b,c){"use strict";function d(a,b,c,d){for(var e=65535&a|0,f=a>>>16&65535|0,g=0;0!==c;){g=c>2e3?2e3:c,c-=g;do e=e+b[d++]|0,f=f+e|0;while(--g);e%=65521,f%=65521}return e|f<<16|0;
}b.exports=d},{}],65:[function(a,b,c){"use strict";b.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],66:[function(a,b,c){"use strict";function d(){for(var a,b=[],c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;b[c]=a}return b}function e(a,b,c,d){var e=f,g=d+c;a^=-1;for(var h=d;h<g;h++)a=a>>>8^e[255&(a^b[h])];return a^-1}var f=d();b.exports=e},{}],67:[function(a,b,c){"use strict";function d(a,b){return a.msg=I[b],b}function e(a){return(a<<1)-(a>4?9:0)}function f(a){for(var b=a.length;--b>=0;)a[b]=0}function g(a){var b=a.state,c=b.pending;c>a.avail_out&&(c=a.avail_out),0!==c&&(E.arraySet(a.output,b.pending_buf,b.pending_out,c,a.next_out),a.next_out+=c,b.pending_out+=c,a.total_out+=c,a.avail_out-=c,b.pending-=c,0===b.pending&&(b.pending_out=0))}function h(a,b){F._tr_flush_block(a,a.block_start>=0?a.block_start:-1,a.strstart-a.block_start,b),a.block_start=a.strstart,g(a.strm)}function i(a,b){a.pending_buf[a.pending++]=b}function j(a,b){a.pending_buf[a.pending++]=b>>>8&255,a.pending_buf[a.pending++]=255&b}function k(a,b,c,d){var e=a.avail_in;return e>d&&(e=d),0===e?0:(a.avail_in-=e,E.arraySet(b,a.input,a.next_in,e,c),1===a.state.wrap?a.adler=G(a.adler,b,e,c):2===a.state.wrap&&(a.adler=H(a.adler,b,e,c)),a.next_in+=e,a.total_in+=e,e)}function l(a,b){var c,d,e=a.max_chain_length,f=a.strstart,g=a.prev_length,h=a.nice_match,i=a.strstart>a.w_size-la?a.strstart-(a.w_size-la):0,j=a.window,k=a.w_mask,l=a.prev,m=a.strstart+ka,n=j[f+g-1],o=j[f+g];a.prev_length>=a.good_match&&(e>>=2),h>a.lookahead&&(h=a.lookahead);do if(c=b,j[c+g]===o&&j[c+g-1]===n&&j[c]===j[f]&&j[++c]===j[f+1]){f+=2,c++;do;while(j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&f<m);if(d=ka-(m-f),f=m-ka,d>g){if(a.match_start=b,g=d,d>=h)break;n=j[f+g-1],o=j[f+g]}}while((b=l[b&k])>i&&0!==--e);return g<=a.lookahead?g:a.lookahead}function m(a){var b,c,d,e,f,g=a.w_size;do{if(e=a.window_size-a.lookahead-a.strstart,a.strstart>=g+(g-la)){E.arraySet(a.window,a.window,g,g,0),a.match_start-=g,a.strstart-=g,a.block_start-=g,c=a.hash_size,b=c;do d=a.head[--b],a.head[b]=d>=g?d-g:0;while(--c);c=g,b=c;do d=a.prev[--b],a.prev[b]=d>=g?d-g:0;while(--c);e+=g}if(0===a.strm.avail_in)break;if(c=k(a.strm,a.window,a.strstart+a.lookahead,e),a.lookahead+=c,a.lookahead+a.insert>=ja)for(f=a.strstart-a.insert,a.ins_h=a.window[f],a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+ja-1])&a.hash_mask,a.prev[f&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=f,f++,a.insert--,!(a.lookahead+a.insert<ja)););}while(a.lookahead<la&&0!==a.strm.avail_in)}function n(a,b){var c=65535;for(c>a.pending_buf_size-5&&(c=a.pending_buf_size-5);;){if(a.lookahead<=1){if(m(a),0===a.lookahead&&b===J)return ua;if(0===a.lookahead)break}a.strstart+=a.lookahead,a.lookahead=0;var d=a.block_start+c;if((0===a.strstart||a.strstart>=d)&&(a.lookahead=a.strstart-d,a.strstart=d,h(a,!1),0===a.strm.avail_out))return ua;if(a.strstart-a.block_start>=a.w_size-la&&(h(a,!1),0===a.strm.avail_out))return ua}return a.insert=0,b===M?(h(a,!0),0===a.strm.avail_out?wa:xa):a.strstart>a.block_start&&(h(a,!1),0===a.strm.avail_out)?ua:ua}function o(a,b){for(var c,d;;){if(a.lookahead<la){if(m(a),a.lookahead<la&&b===J)return ua;if(0===a.lookahead)break}if(c=0,a.lookahead>=ja&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ja-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),0!==c&&a.strstart-c<=a.w_size-la&&(a.match_length=l(a,c)),a.match_length>=ja)if(d=F._tr_tally(a,a.strstart-a.match_start,a.match_length-ja),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=ja){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ja-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(0!==--a.match_length);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else d=F._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(d&&(h(a,!1),0===a.strm.avail_out))return ua}return a.insert=a.strstart<ja-1?a.strstart:ja-1,b===M?(h(a,!0),0===a.strm.avail_out?wa:xa):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?ua:va}function p(a,b){for(var c,d,e;;){if(a.lookahead<la){if(m(a),a.lookahead<la&&b===J)return ua;if(0===a.lookahead)break}if(c=0,a.lookahead>=ja&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ja-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=ja-1,0!==c&&a.prev_length<a.max_lazy_match&&a.strstart-c<=a.w_size-la&&(a.match_length=l(a,c),a.match_length<=5&&(a.strategy===U||a.match_length===ja&&a.strstart-a.match_start>4096)&&(a.match_length=ja-1)),a.prev_length>=ja&&a.match_length<=a.prev_length){e=a.strstart+a.lookahead-ja,d=F._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-ja),a.lookahead-=a.prev_length-1,a.prev_length-=2;do++a.strstart<=e&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ja-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(0!==--a.prev_length);if(a.match_available=0,a.match_length=ja-1,a.strstart++,d&&(h(a,!1),0===a.strm.avail_out))return ua}else if(a.match_available){if(d=F._tr_tally(a,0,a.window[a.strstart-1]),d&&h(a,!1),a.strstart++,a.lookahead--,0===a.strm.avail_out)return ua}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(d=F._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<ja-1?a.strstart:ja-1,b===M?(h(a,!0),0===a.strm.avail_out?wa:xa):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?ua:va}function q(a,b){for(var c,d,e,f,g=a.window;;){if(a.lookahead<=ka){if(m(a),a.lookahead<=ka&&b===J)return ua;if(0===a.lookahead)break}if(a.match_length=0,a.lookahead>=ja&&a.strstart>0&&(e=a.strstart-1,d=g[e],d===g[++e]&&d===g[++e]&&d===g[++e])){f=a.strstart+ka;do;while(d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&e<f);a.match_length=ka-(f-e),a.match_length>a.lookahead&&(a.match_length=a.lookahead)}if(a.match_length>=ja?(c=F._tr_tally(a,1,a.match_length-ja),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(c=F._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++),c&&(h(a,!1),0===a.strm.avail_out))return ua}return a.insert=0,b===M?(h(a,!0),0===a.strm.avail_out?wa:xa):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?ua:va}function r(a,b){for(var c;;){if(0===a.lookahead&&(m(a),0===a.lookahead)){if(b===J)return ua;break}if(a.match_length=0,c=F._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++,c&&(h(a,!1),0===a.strm.avail_out))return ua}return a.insert=0,b===M?(h(a,!0),0===a.strm.avail_out?wa:xa):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?ua:va}function s(a,b,c,d,e){this.good_length=a,this.max_lazy=b,this.nice_length=c,this.max_chain=d,this.func=e}function t(a){a.window_size=2*a.w_size,f(a.head),a.max_lazy_match=D[a.level].max_lazy,a.good_match=D[a.level].good_length,a.nice_match=D[a.level].nice_length,a.max_chain_length=D[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=ja-1,a.match_available=0,a.ins_h=0}function u(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=$,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new E.Buf16(2*ha),this.dyn_dtree=new E.Buf16(2*(2*fa+1)),this.bl_tree=new E.Buf16(2*(2*ga+1)),f(this.dyn_ltree),f(this.dyn_dtree),f(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new E.Buf16(ia+1),this.heap=new E.Buf16(2*ea+1),f(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new E.Buf16(2*ea+1),f(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function v(a){var b;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=Z,b=a.state,b.pending=0,b.pending_out=0,b.wrap<0&&(b.wrap=-b.wrap),b.status=b.wrap?na:sa,a.adler=2===b.wrap?0:1,b.last_flush=J,F._tr_init(b),O):d(a,Q)}function w(a){var b=v(a);return b===O&&t(a.state),b}function x(a,b){return a&&a.state?2!==a.state.wrap?Q:(a.state.gzhead=b,O):Q}function y(a,b,c,e,f,g){if(!a)return Q;var h=1;if(b===T&&(b=6),e<0?(h=0,e=-e):e>15&&(h=2,e-=16),f<1||f>_||c!==$||e<8||e>15||b<0||b>9||g<0||g>X)return d(a,Q);8===e&&(e=9);var i=new u;return a.state=i,i.strm=a,i.wrap=h,i.gzhead=null,i.w_bits=e,i.w_size=1<<i.w_bits,i.w_mask=i.w_size-1,i.hash_bits=f+7,i.hash_size=1<<i.hash_bits,i.hash_mask=i.hash_size-1,i.hash_shift=~~((i.hash_bits+ja-1)/ja),i.window=new E.Buf8(2*i.w_size),i.head=new E.Buf16(i.hash_size),i.prev=new E.Buf16(i.w_size),i.lit_bufsize=1<<f+6,i.pending_buf_size=4*i.lit_bufsize,i.pending_buf=new E.Buf8(i.pending_buf_size),i.d_buf=1*i.lit_bufsize,i.l_buf=3*i.lit_bufsize,i.level=b,i.strategy=g,i.method=c,w(a)}function z(a,b){return y(a,b,$,aa,ba,Y)}function A(a,b){var c,h,k,l;if(!a||!a.state||b>N||b<0)return a?d(a,Q):Q;if(h=a.state,!a.output||!a.input&&0!==a.avail_in||h.status===ta&&b!==M)return d(a,0===a.avail_out?S:Q);if(h.strm=a,c=h.last_flush,h.last_flush=b,h.status===na)if(2===h.wrap)a.adler=0,i(h,31),i(h,139),i(h,8),h.gzhead?(i(h,(h.gzhead.text?1:0)+(h.gzhead.hcrc?2:0)+(h.gzhead.extra?4:0)+(h.gzhead.name?8:0)+(h.gzhead.comment?16:0)),i(h,255&h.gzhead.time),i(h,h.gzhead.time>>8&255),i(h,h.gzhead.time>>16&255),i(h,h.gzhead.time>>24&255),i(h,9===h.level?2:h.strategy>=V||h.level<2?4:0),i(h,255&h.gzhead.os),h.gzhead.extra&&h.gzhead.extra.length&&(i(h,255&h.gzhead.extra.length),i(h,h.gzhead.extra.length>>8&255)),h.gzhead.hcrc&&(a.adler=H(a.adler,h.pending_buf,h.pending,0)),h.gzindex=0,h.status=oa):(i(h,0),i(h,0),i(h,0),i(h,0),i(h,0),i(h,9===h.level?2:h.strategy>=V||h.level<2?4:0),i(h,ya),h.status=sa);else{var m=$+(h.w_bits-8<<4)<<8,n=-1;n=h.strategy>=V||h.level<2?0:h.level<6?1:6===h.level?2:3,m|=n<<6,0!==h.strstart&&(m|=ma),m+=31-m%31,h.status=sa,j(h,m),0!==h.strstart&&(j(h,a.adler>>>16),j(h,65535&a.adler)),a.adler=1}if(h.status===oa)if(h.gzhead.extra){for(k=h.pending;h.gzindex<(65535&h.gzhead.extra.length)&&(h.pending!==h.pending_buf_size||(h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending!==h.pending_buf_size));)i(h,255&h.gzhead.extra[h.gzindex]),h.gzindex++;h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),h.gzindex===h.gzhead.extra.length&&(h.gzindex=0,h.status=pa)}else h.status=pa;if(h.status===pa)if(h.gzhead.name){k=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending===h.pending_buf_size)){l=1;break}l=h.gzindex<h.gzhead.name.length?255&h.gzhead.name.charCodeAt(h.gzindex++):0,i(h,l)}while(0!==l);h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),0===l&&(h.gzindex=0,h.status=qa)}else h.status=qa;if(h.status===qa)if(h.gzhead.comment){k=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending===h.pending_buf_size)){l=1;break}l=h.gzindex<h.gzhead.comment.length?255&h.gzhead.comment.charCodeAt(h.gzindex++):0,i(h,l)}while(0!==l);h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),0===l&&(h.status=ra)}else h.status=ra;if(h.status===ra&&(h.gzhead.hcrc?(h.pending+2>h.pending_buf_size&&g(a),h.pending+2<=h.pending_buf_size&&(i(h,255&a.adler),i(h,a.adler>>8&255),a.adler=0,h.status=sa)):h.status=sa),0!==h.pending){if(g(a),0===a.avail_out)return h.last_flush=-1,O}else if(0===a.avail_in&&e(b)<=e(c)&&b!==M)return d(a,S);if(h.status===ta&&0!==a.avail_in)return d(a,S);if(0!==a.avail_in||0!==h.lookahead||b!==J&&h.status!==ta){var o=h.strategy===V?r(h,b):h.strategy===W?q(h,b):D[h.level].func(h,b);if(o!==wa&&o!==xa||(h.status=ta),o===ua||o===wa)return 0===a.avail_out&&(h.last_flush=-1),O;if(o===va&&(b===K?F._tr_align(h):b!==N&&(F._tr_stored_block(h,0,0,!1),b===L&&(f(h.head),0===h.lookahead&&(h.strstart=0,h.block_start=0,h.insert=0))),g(a),0===a.avail_out))return h.last_flush=-1,O}return b!==M?O:h.wrap<=0?P:(2===h.wrap?(i(h,255&a.adler),i(h,a.adler>>8&255),i(h,a.adler>>16&255),i(h,a.adler>>24&255),i(h,255&a.total_in),i(h,a.total_in>>8&255),i(h,a.total_in>>16&255),i(h,a.total_in>>24&255)):(j(h,a.adler>>>16),j(h,65535&a.adler)),g(a),h.wrap>0&&(h.wrap=-h.wrap),0!==h.pending?O:P)}function B(a){var b;return a&&a.state?(b=a.state.status,b!==na&&b!==oa&&b!==pa&&b!==qa&&b!==ra&&b!==sa&&b!==ta?d(a,Q):(a.state=null,b===sa?d(a,R):O)):Q}function C(a,b){var c,d,e,g,h,i,j,k,l=b.length;if(!a||!a.state)return Q;if(c=a.state,g=c.wrap,2===g||1===g&&c.status!==na||c.lookahead)return Q;for(1===g&&(a.adler=G(a.adler,b,l,0)),c.wrap=0,l>=c.w_size&&(0===g&&(f(c.head),c.strstart=0,c.block_start=0,c.insert=0),k=new E.Buf8(c.w_size),E.arraySet(k,b,l-c.w_size,c.w_size,0),b=k,l=c.w_size),h=a.avail_in,i=a.next_in,j=a.input,a.avail_in=l,a.next_in=0,a.input=b,m(c);c.lookahead>=ja;){d=c.strstart,e=c.lookahead-(ja-1);do c.ins_h=(c.ins_h<<c.hash_shift^c.window[d+ja-1])&c.hash_mask,c.prev[d&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=d,d++;while(--e);c.strstart=d,c.lookahead=ja-1,m(c)}return c.strstart+=c.lookahead,c.block_start=c.strstart,c.insert=c.lookahead,c.lookahead=0,c.match_length=c.prev_length=ja-1,c.match_available=0,a.next_in=i,a.input=j,a.avail_in=h,c.wrap=g,O}var D,E=a("../utils/common"),F=a("./trees"),G=a("./adler32"),H=a("./crc32"),I=a("./messages"),J=0,K=1,L=3,M=4,N=5,O=0,P=1,Q=-2,R=-3,S=-5,T=-1,U=1,V=2,W=3,X=4,Y=0,Z=2,$=8,_=9,aa=15,ba=8,ca=29,da=256,ea=da+1+ca,fa=30,ga=19,ha=2*ea+1,ia=15,ja=3,ka=258,la=ka+ja+1,ma=32,na=42,oa=69,pa=73,qa=91,ra=103,sa=113,ta=666,ua=1,va=2,wa=3,xa=4,ya=3;D=[new s(0,0,0,0,n),new s(4,4,8,4,o),new s(4,5,16,8,o),new s(4,6,32,32,o),new s(4,4,16,16,p),new s(8,16,32,32,p),new s(8,16,128,128,p),new s(8,32,128,256,p),new s(32,128,258,1024,p),new s(32,258,258,4096,p)],c.deflateInit=z,c.deflateInit2=y,c.deflateReset=w,c.deflateResetKeep=v,c.deflateSetHeader=x,c.deflate=A,c.deflateEnd=B,c.deflateSetDictionary=C,c.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":62,"./adler32":64,"./crc32":66,"./messages":72,"./trees":73}],68:[function(a,b,c){"use strict";function d(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}b.exports=d},{}],69:[function(a,b,c){"use strict";var d=30,e=12;b.exports=function(a,b){var c,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;c=a.state,f=a.next_in,B=a.input,g=f+(a.avail_in-5),h=a.next_out,C=a.output,i=h-(b-a.avail_out),j=h+(a.avail_out-257),k=c.dmax,l=c.wsize,m=c.whave,n=c.wnext,o=c.window,p=c.hold,q=c.bits,r=c.lencode,s=c.distcode,t=(1<<c.lenbits)-1,u=(1<<c.distbits)-1;a:do{q<15&&(p+=B[f++]<<q,q+=8,p+=B[f++]<<q,q+=8),v=r[p&t];b:for(;;){if(w=v>>>24,p>>>=w,q-=w,w=v>>>16&255,0===w)C[h++]=65535&v;else{if(!(16&w)){if(0===(64&w)){v=r[(65535&v)+(p&(1<<w)-1)];continue b}if(32&w){c.mode=e;break a}a.msg="invalid literal/length code",c.mode=d;break a}x=65535&v,w&=15,w&&(q<w&&(p+=B[f++]<<q,q+=8),x+=p&(1<<w)-1,p>>>=w,q-=w),q<15&&(p+=B[f++]<<q,q+=8,p+=B[f++]<<q,q+=8),v=s[p&u];c:for(;;){if(w=v>>>24,p>>>=w,q-=w,w=v>>>16&255,!(16&w)){if(0===(64&w)){v=s[(65535&v)+(p&(1<<w)-1)];continue c}a.msg="invalid distance code",c.mode=d;break a}if(y=65535&v,w&=15,q<w&&(p+=B[f++]<<q,q+=8,q<w&&(p+=B[f++]<<q,q+=8)),y+=p&(1<<w)-1,y>k){a.msg="invalid distance too far back",c.mode=d;break a}if(p>>>=w,q-=w,w=h-i,y>w){if(w=y-w,w>m&&c.sane){a.msg="invalid distance too far back",c.mode=d;break a}if(z=0,A=o,0===n){if(z+=l-w,w<x){x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}}else if(n<w){if(z+=l+n-w,w-=n,w<x){x-=w;do C[h++]=o[z++];while(--w);if(z=0,n<x){w=n,x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}}}else if(z+=n-w,w<x){x-=w;do C[h++]=o[z++];while(--w);z=h-y,A=C}for(;x>2;)C[h++]=A[z++],C[h++]=A[z++],C[h++]=A[z++],x-=3;x&&(C[h++]=A[z++],x>1&&(C[h++]=A[z++]))}else{z=h-y;do C[h++]=C[z++],C[h++]=C[z++],C[h++]=C[z++],x-=3;while(x>2);x&&(C[h++]=C[z++],x>1&&(C[h++]=C[z++]))}break}}break}}while(f<g&&h<j);x=q>>3,f-=x,q-=x<<3,p&=(1<<q)-1,a.next_in=f,a.next_out=h,a.avail_in=f<g?5+(g-f):5-(f-g),a.avail_out=h<j?257+(j-h):257-(h-j),c.hold=p,c.bits=q}},{}],70:[function(a,b,c){"use strict";function d(a){return(a>>>24&255)+(a>>>8&65280)+((65280&a)<<8)+((255&a)<<24)}function e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(a){var b;return a&&a.state?(b=a.state,a.total_in=a.total_out=b.total=0,a.msg="",b.wrap&&(a.adler=1&b.wrap),b.mode=L,b.last=0,b.havedict=0,b.dmax=32768,b.head=null,b.hold=0,b.bits=0,b.lencode=b.lendyn=new s.Buf32(pa),b.distcode=b.distdyn=new s.Buf32(qa),b.sane=1,b.back=-1,D):G}function g(a){var b;return a&&a.state?(b=a.state,b.wsize=0,b.whave=0,b.wnext=0,f(a)):G}function h(a,b){var c,d;return a&&a.state?(d=a.state,b<0?(c=0,b=-b):(c=(b>>4)+1,b<48&&(b&=15)),b&&(b<8||b>15)?G:(null!==d.window&&d.wbits!==b&&(d.window=null),d.wrap=c,d.wbits=b,g(a))):G}function i(a,b){var c,d;return a?(d=new e,a.state=d,d.window=null,c=h(a,b),c!==D&&(a.state=null),c):G}function j(a){return i(a,sa)}function k(a){if(ta){var b;for(q=new s.Buf32(512),r=new s.Buf32(32),b=0;b<144;)a.lens[b++]=8;for(;b<256;)a.lens[b++]=9;for(;b<280;)a.lens[b++]=7;for(;b<288;)a.lens[b++]=8;for(w(y,a.lens,0,288,q,0,a.work,{bits:9}),b=0;b<32;)a.lens[b++]=5;w(z,a.lens,0,32,r,0,a.work,{bits:5}),ta=!1}a.lencode=q,a.lenbits=9,a.distcode=r,a.distbits=5}function l(a,b,c,d){var e,f=a.state;return null===f.window&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new s.Buf8(f.wsize)),d>=f.wsize?(s.arraySet(f.window,b,c-f.wsize,f.wsize,0),f.wnext=0,f.whave=f.wsize):(e=f.wsize-f.wnext,e>d&&(e=d),s.arraySet(f.window,b,c-d,e,f.wnext),d-=e,d?(s.arraySet(f.window,b,c-d,d,0),f.wnext=d,f.whave=f.wsize):(f.wnext+=e,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=e))),0}function m(a,b){var c,e,f,g,h,i,j,m,n,o,p,q,r,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa=0,Ba=new s.Buf8(4),Ca=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return G;c=a.state,c.mode===W&&(c.mode=X),h=a.next_out,f=a.output,j=a.avail_out,g=a.next_in,e=a.input,i=a.avail_in,m=c.hold,n=c.bits,o=i,p=j,xa=D;a:for(;;)switch(c.mode){case L:if(0===c.wrap){c.mode=X;break}for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(2&c.wrap&&35615===m){c.check=0,Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0),m=0,n=0,c.mode=M;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&m)<<8)+(m>>8))%31){a.msg="incorrect header check",c.mode=ma;break}if((15&m)!==K){a.msg="unknown compression method",c.mode=ma;break}if(m>>>=4,n-=4,wa=(15&m)+8,0===c.wbits)c.wbits=wa;else if(wa>c.wbits){a.msg="invalid window size",c.mode=ma;break}c.dmax=1<<wa,a.adler=c.check=1,c.mode=512&m?U:W,m=0,n=0;break;case M:for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(c.flags=m,(255&c.flags)!==K){a.msg="unknown compression method",c.mode=ma;break}if(57344&c.flags){a.msg="unknown header flags set",c.mode=ma;break}c.head&&(c.head.text=m>>8&1),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0)),m=0,n=0,c.mode=N;case N:for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.head&&(c.head.time=m),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,Ba[2]=m>>>16&255,Ba[3]=m>>>24&255,c.check=u(c.check,Ba,4,0)),m=0,n=0,c.mode=O;case O:for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.head&&(c.head.xflags=255&m,c.head.os=m>>8),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0)),m=0,n=0,c.mode=P;case P:if(1024&c.flags){for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.length=m,c.head&&(c.head.extra_len=m),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0)),m=0,n=0}else c.head&&(c.head.extra=null);c.mode=Q;case Q:if(1024&c.flags&&(q=c.length,q>i&&(q=i),q&&(c.head&&(wa=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Array(c.head.extra_len)),s.arraySet(c.head.extra,e,g,q,wa)),512&c.flags&&(c.check=u(c.check,e,q,g)),i-=q,g+=q,c.length-=q),c.length))break a;c.length=0,c.mode=R;case R:if(2048&c.flags){if(0===i)break a;q=0;do wa=e[g+q++],c.head&&wa&&c.length<65536&&(c.head.name+=String.fromCharCode(wa));while(wa&&q<i);if(512&c.flags&&(c.check=u(c.check,e,q,g)),i-=q,g+=q,wa)break a}else c.head&&(c.head.name=null);c.length=0,c.mode=S;case S:if(4096&c.flags){if(0===i)break a;q=0;do wa=e[g+q++],c.head&&wa&&c.length<65536&&(c.head.comment+=String.fromCharCode(wa));while(wa&&q<i);if(512&c.flags&&(c.check=u(c.check,e,q,g)),i-=q,g+=q,wa)break a}else c.head&&(c.head.comment=null);c.mode=T;case T:if(512&c.flags){for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m!==(65535&c.check)){a.msg="header crc mismatch",c.mode=ma;break}m=0,n=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),a.adler=c.check=0,c.mode=W;break;case U:for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}a.adler=c.check=d(m),m=0,n=0,c.mode=V;case V:if(0===c.havedict)return a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,F;a.adler=c.check=1,c.mode=W;case W:if(b===B||b===C)break a;case X:if(c.last){m>>>=7&n,n-=7&n,c.mode=ja;break}for(;n<3;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}switch(c.last=1&m,m>>>=1,n-=1,3&m){case 0:c.mode=Y;break;case 1:if(k(c),c.mode=ca,b===C){m>>>=2,n-=2;break a}break;case 2:c.mode=_;break;case 3:a.msg="invalid block type",c.mode=ma}m>>>=2,n-=2;break;case Y:for(m>>>=7&n,n-=7&n;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if((65535&m)!==(m>>>16^65535)){a.msg="invalid stored block lengths",c.mode=ma;break}if(c.length=65535&m,m=0,n=0,c.mode=Z,b===C)break a;case Z:c.mode=$;case $:if(q=c.length){if(q>i&&(q=i),q>j&&(q=j),0===q)break a;s.arraySet(f,e,g,q,h),i-=q,g+=q,j-=q,h+=q,c.length-=q;break}c.mode=W;break;case _:for(;n<14;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(c.nlen=(31&m)+257,m>>>=5,n-=5,c.ndist=(31&m)+1,m>>>=5,n-=5,c.ncode=(15&m)+4,m>>>=4,n-=4,c.nlen>286||c.ndist>30){a.msg="too many length or distance symbols",c.mode=ma;break}c.have=0,c.mode=aa;case aa:for(;c.have<c.ncode;){for(;n<3;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.lens[Ca[c.have++]]=7&m,m>>>=3,n-=3}for(;c.have<19;)c.lens[Ca[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,ya={bits:c.lenbits},xa=w(x,c.lens,0,19,c.lencode,0,c.work,ya),c.lenbits=ya.bits,xa){a.msg="invalid code lengths set",c.mode=ma;break}c.have=0,c.mode=ba;case ba:for(;c.have<c.nlen+c.ndist;){for(;Aa=c.lencode[m&(1<<c.lenbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(sa<16)m>>>=qa,n-=qa,c.lens[c.have++]=sa;else{if(16===sa){for(za=qa+2;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m>>>=qa,n-=qa,0===c.have){a.msg="invalid bit length repeat",c.mode=ma;break}wa=c.lens[c.have-1],q=3+(3&m),m>>>=2,n-=2}else if(17===sa){for(za=qa+3;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=qa,n-=qa,wa=0,q=3+(7&m),m>>>=3,n-=3}else{for(za=qa+7;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=qa,n-=qa,wa=0,q=11+(127&m),m>>>=7,n-=7}if(c.have+q>c.nlen+c.ndist){a.msg="invalid bit length repeat",c.mode=ma;break}for(;q--;)c.lens[c.have++]=wa}}if(c.mode===ma)break;if(0===c.lens[256]){a.msg="invalid code -- missing end-of-block",c.mode=ma;break}if(c.lenbits=9,ya={bits:c.lenbits},xa=w(y,c.lens,0,c.nlen,c.lencode,0,c.work,ya),c.lenbits=ya.bits,xa){a.msg="invalid literal/lengths set",c.mode=ma;break}if(c.distbits=6,c.distcode=c.distdyn,ya={bits:c.distbits},xa=w(z,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,ya),c.distbits=ya.bits,xa){a.msg="invalid distances set",c.mode=ma;break}if(c.mode=ca,b===C)break a;case ca:c.mode=da;case da:if(i>=6&&j>=258){a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,v(a,p),h=a.next_out,f=a.output,j=a.avail_out,g=a.next_in,e=a.input,i=a.avail_in,m=c.hold,n=c.bits,c.mode===W&&(c.back=-1);break}for(c.back=0;Aa=c.lencode[m&(1<<c.lenbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(ra&&0===(240&ra)){for(ta=qa,ua=ra,va=sa;Aa=c.lencode[va+((m&(1<<ta+ua)-1)>>ta)],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(ta+qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=ta,n-=ta,c.back+=ta}if(m>>>=qa,n-=qa,c.back+=qa,c.length=sa,0===ra){c.mode=ia;break}if(32&ra){c.back=-1,c.mode=W;break}if(64&ra){a.msg="invalid literal/length code",c.mode=ma;break}c.extra=15&ra,c.mode=ea;case ea:if(c.extra){for(za=c.extra;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.length+=m&(1<<c.extra)-1,m>>>=c.extra,n-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=fa;case fa:for(;Aa=c.distcode[m&(1<<c.distbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(0===(240&ra)){for(ta=qa,ua=ra,va=sa;Aa=c.distcode[va+((m&(1<<ta+ua)-1)>>ta)],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(ta+qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=ta,n-=ta,c.back+=ta}if(m>>>=qa,n-=qa,c.back+=qa,64&ra){a.msg="invalid distance code",c.mode=ma;break}c.offset=sa,c.extra=15&ra,c.mode=ga;case ga:if(c.extra){for(za=c.extra;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.offset+=m&(1<<c.extra)-1,m>>>=c.extra,n-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){a.msg="invalid distance too far back",c.mode=ma;break}c.mode=ha;case ha:if(0===j)break a;if(q=p-j,c.offset>q){if(q=c.offset-q,q>c.whave&&c.sane){a.msg="invalid distance too far back",c.mode=ma;break}q>c.wnext?(q-=c.wnext,r=c.wsize-q):r=c.wnext-q,q>c.length&&(q=c.length),pa=c.window}else pa=f,r=h-c.offset,q=c.length;q>j&&(q=j),j-=q,c.length-=q;do f[h++]=pa[r++];while(--q);0===c.length&&(c.mode=da);break;case ia:if(0===j)break a;f[h++]=c.length,j--,c.mode=da;break;case ja:if(c.wrap){for(;n<32;){if(0===i)break a;i--,m|=e[g++]<<n,n+=8}if(p-=j,a.total_out+=p,c.total+=p,p&&(a.adler=c.check=c.flags?u(c.check,f,p,h-p):t(c.check,f,p,h-p)),p=j,(c.flags?m:d(m))!==c.check){a.msg="incorrect data check",c.mode=ma;break}m=0,n=0}c.mode=ka;case ka:if(c.wrap&&c.flags){for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m!==(4294967295&c.total)){a.msg="incorrect length check",c.mode=ma;break}m=0,n=0}c.mode=la;case la:xa=E;break a;case ma:xa=H;break a;case na:return I;case oa:default:return G}return a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,(c.wsize||p!==a.avail_out&&c.mode<ma&&(c.mode<ja||b!==A))&&l(a,a.output,a.next_out,p-a.avail_out)?(c.mode=na,I):(o-=a.avail_in,p-=a.avail_out,a.total_in+=o,a.total_out+=p,c.total+=p,c.wrap&&p&&(a.adler=c.check=c.flags?u(c.check,f,p,a.next_out-p):t(c.check,f,p,a.next_out-p)),a.data_type=c.bits+(c.last?64:0)+(c.mode===W?128:0)+(c.mode===ca||c.mode===Z?256:0),(0===o&&0===p||b===A)&&xa===D&&(xa=J),xa)}function n(a){if(!a||!a.state)return G;var b=a.state;return b.window&&(b.window=null),a.state=null,D}function o(a,b){var c;return a&&a.state?(c=a.state,0===(2&c.wrap)?G:(c.head=b,b.done=!1,D)):G}function p(a,b){var c,d,e,f=b.length;return a&&a.state?(c=a.state,0!==c.wrap&&c.mode!==V?G:c.mode===V&&(d=1,d=t(d,b,f,0),d!==c.check)?H:(e=l(a,b,f,f))?(c.mode=na,I):(c.havedict=1,D)):G}var q,r,s=a("../utils/common"),t=a("./adler32"),u=a("./crc32"),v=a("./inffast"),w=a("./inftrees"),x=0,y=1,z=2,A=4,B=5,C=6,D=0,E=1,F=2,G=-2,H=-3,I=-4,J=-5,K=8,L=1,M=2,N=3,O=4,P=5,Q=6,R=7,S=8,T=9,U=10,V=11,W=12,X=13,Y=14,Z=15,$=16,_=17,aa=18,ba=19,ca=20,da=21,ea=22,fa=23,ga=24,ha=25,ia=26,ja=27,ka=28,la=29,ma=30,na=31,oa=32,pa=852,qa=592,ra=15,sa=ra,ta=!0;c.inflateReset=g,c.inflateReset2=h,c.inflateResetKeep=f,c.inflateInit=j,c.inflateInit2=i,c.inflate=m,c.inflateEnd=n,c.inflateGetHeader=o,c.inflateSetDictionary=p,c.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":62,"./adler32":64,"./crc32":66,"./inffast":69,"./inftrees":71}],71:[function(a,b,c){"use strict";var d=a("../utils/common"),e=15,f=852,g=592,h=0,i=1,j=2,k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],n=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];b.exports=function(a,b,c,o,p,q,r,s){var t,u,v,w,x,y,z,A,B,C=s.bits,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=null,O=0,P=new d.Buf16(e+1),Q=new d.Buf16(e+1),R=null,S=0;for(D=0;D<=e;D++)P[D]=0;for(E=0;E<o;E++)P[b[c+E]]++;for(H=C,G=e;G>=1&&0===P[G];G--);if(H>G&&(H=G),0===G)return p[q++]=20971520,p[q++]=20971520,s.bits=1,0;for(F=1;F<G&&0===P[F];F++);for(H<F&&(H=F),K=1,D=1;D<=e;D++)if(K<<=1,K-=P[D],K<0)return-1;if(K>0&&(a===h||1!==G))return-1;for(Q[1]=0,D=1;D<e;D++)Q[D+1]=Q[D]+P[D];for(E=0;E<o;E++)0!==b[c+E]&&(r[Q[b[c+E]]++]=E);if(a===h?(N=R=r,y=19):a===i?(N=k,O-=257,R=l,S-=257,y=256):(N=m,R=n,y=-1),M=0,E=0,D=F,x=q,I=H,J=0,v=-1,L=1<<H,w=L-1,a===i&&L>f||a===j&&L>g)return 1;for(;;){z=D-J,r[E]<y?(A=0,B=r[E]):r[E]>y?(A=R[S+r[E]],B=N[O+r[E]]):(A=96,B=0),t=1<<D-J,u=1<<I,F=u;do u-=t,p[x+(M>>J)+u]=z<<24|A<<16|B|0;while(0!==u);for(t=1<<D-1;M&t;)t>>=1;if(0!==t?(M&=t-1,M+=t):M=0,E++,0===--P[D]){if(D===G)break;D=b[c+r[E]]}if(D>H&&(M&w)!==v){for(0===J&&(J=H),x+=F,I=D-J,K=1<<I;I+J<G&&(K-=P[I+J],!(K<=0));)I++,K<<=1;if(L+=1<<I,a===i&&L>f||a===j&&L>g)return 1;v=M&w,p[v]=H<<24|I<<16|x-q|0}}return 0!==M&&(p[x+M]=D-J<<24|64<<16|0),s.bits=H,0}},{"../utils/common":62}],72:[function(a,b,c){"use strict";b.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],73:[function(a,b,c){"use strict";function d(a){for(var b=a.length;--b>=0;)a[b]=0}function e(a,b,c,d,e){this.static_tree=a,this.extra_bits=b,this.extra_base=c,this.elems=d,this.max_length=e,this.has_stree=a&&a.length}function f(a,b){this.dyn_tree=a,this.max_code=0,this.stat_desc=b}function g(a){return a<256?ia[a]:ia[256+(a>>>7)]}function h(a,b){a.pending_buf[a.pending++]=255&b,a.pending_buf[a.pending++]=b>>>8&255}function i(a,b,c){a.bi_valid>X-c?(a.bi_buf|=b<<a.bi_valid&65535,h(a,a.bi_buf),a.bi_buf=b>>X-a.bi_valid,a.bi_valid+=c-X):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=c)}function j(a,b,c){i(a,c[2*b],c[2*b+1])}function k(a,b){var c=0;do c|=1&a,a>>>=1,c<<=1;while(--b>0);return c>>>1}function l(a){16===a.bi_valid?(h(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):a.bi_valid>=8&&(a.pending_buf[a.pending++]=255&a.bi_buf,a.bi_buf>>=8,a.bi_valid-=8)}function m(a,b){var c,d,e,f,g,h,i=b.dyn_tree,j=b.max_code,k=b.stat_desc.static_tree,l=b.stat_desc.has_stree,m=b.stat_desc.extra_bits,n=b.stat_desc.extra_base,o=b.stat_desc.max_length,p=0;for(f=0;f<=W;f++)a.bl_count[f]=0;for(i[2*a.heap[a.heap_max]+1]=0,
c=a.heap_max+1;c<V;c++)d=a.heap[c],f=i[2*i[2*d+1]+1]+1,f>o&&(f=o,p++),i[2*d+1]=f,d>j||(a.bl_count[f]++,g=0,d>=n&&(g=m[d-n]),h=i[2*d],a.opt_len+=h*(f+g),l&&(a.static_len+=h*(k[2*d+1]+g)));if(0!==p){do{for(f=o-1;0===a.bl_count[f];)f--;a.bl_count[f]--,a.bl_count[f+1]+=2,a.bl_count[o]--,p-=2}while(p>0);for(f=o;0!==f;f--)for(d=a.bl_count[f];0!==d;)e=a.heap[--c],e>j||(i[2*e+1]!==f&&(a.opt_len+=(f-i[2*e+1])*i[2*e],i[2*e+1]=f),d--)}}function n(a,b,c){var d,e,f=new Array(W+1),g=0;for(d=1;d<=W;d++)f[d]=g=g+c[d-1]<<1;for(e=0;e<=b;e++){var h=a[2*e+1];0!==h&&(a[2*e]=k(f[h]++,h))}}function o(){var a,b,c,d,f,g=new Array(W+1);for(c=0,d=0;d<Q-1;d++)for(ka[d]=c,a=0;a<1<<ba[d];a++)ja[c++]=d;for(ja[c-1]=d,f=0,d=0;d<16;d++)for(la[d]=f,a=0;a<1<<ca[d];a++)ia[f++]=d;for(f>>=7;d<T;d++)for(la[d]=f<<7,a=0;a<1<<ca[d]-7;a++)ia[256+f++]=d;for(b=0;b<=W;b++)g[b]=0;for(a=0;a<=143;)ga[2*a+1]=8,a++,g[8]++;for(;a<=255;)ga[2*a+1]=9,a++,g[9]++;for(;a<=279;)ga[2*a+1]=7,a++,g[7]++;for(;a<=287;)ga[2*a+1]=8,a++,g[8]++;for(n(ga,S+1,g),a=0;a<T;a++)ha[2*a+1]=5,ha[2*a]=k(a,5);ma=new e(ga,ba,R+1,S,W),na=new e(ha,ca,0,T,W),oa=new e(new Array(0),da,0,U,Y)}function p(a){var b;for(b=0;b<S;b++)a.dyn_ltree[2*b]=0;for(b=0;b<T;b++)a.dyn_dtree[2*b]=0;for(b=0;b<U;b++)a.bl_tree[2*b]=0;a.dyn_ltree[2*Z]=1,a.opt_len=a.static_len=0,a.last_lit=a.matches=0}function q(a){a.bi_valid>8?h(a,a.bi_buf):a.bi_valid>0&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0}function r(a,b,c,d){q(a),d&&(h(a,c),h(a,~c)),G.arraySet(a.pending_buf,a.window,b,c,a.pending),a.pending+=c}function s(a,b,c,d){var e=2*b,f=2*c;return a[e]<a[f]||a[e]===a[f]&&d[b]<=d[c]}function t(a,b,c){for(var d=a.heap[c],e=c<<1;e<=a.heap_len&&(e<a.heap_len&&s(b,a.heap[e+1],a.heap[e],a.depth)&&e++,!s(b,d,a.heap[e],a.depth));)a.heap[c]=a.heap[e],c=e,e<<=1;a.heap[c]=d}function u(a,b,c){var d,e,f,h,k=0;if(0!==a.last_lit)do d=a.pending_buf[a.d_buf+2*k]<<8|a.pending_buf[a.d_buf+2*k+1],e=a.pending_buf[a.l_buf+k],k++,0===d?j(a,e,b):(f=ja[e],j(a,f+R+1,b),h=ba[f],0!==h&&(e-=ka[f],i(a,e,h)),d--,f=g(d),j(a,f,c),h=ca[f],0!==h&&(d-=la[f],i(a,d,h)));while(k<a.last_lit);j(a,Z,b)}function v(a,b){var c,d,e,f=b.dyn_tree,g=b.stat_desc.static_tree,h=b.stat_desc.has_stree,i=b.stat_desc.elems,j=-1;for(a.heap_len=0,a.heap_max=V,c=0;c<i;c++)0!==f[2*c]?(a.heap[++a.heap_len]=j=c,a.depth[c]=0):f[2*c+1]=0;for(;a.heap_len<2;)e=a.heap[++a.heap_len]=j<2?++j:0,f[2*e]=1,a.depth[e]=0,a.opt_len--,h&&(a.static_len-=g[2*e+1]);for(b.max_code=j,c=a.heap_len>>1;c>=1;c--)t(a,f,c);e=i;do c=a.heap[1],a.heap[1]=a.heap[a.heap_len--],t(a,f,1),d=a.heap[1],a.heap[--a.heap_max]=c,a.heap[--a.heap_max]=d,f[2*e]=f[2*c]+f[2*d],a.depth[e]=(a.depth[c]>=a.depth[d]?a.depth[c]:a.depth[d])+1,f[2*c+1]=f[2*d+1]=e,a.heap[1]=e++,t(a,f,1);while(a.heap_len>=2);a.heap[--a.heap_max]=a.heap[1],m(a,b),n(f,j,a.bl_count)}function w(a,b,c){var d,e,f=-1,g=b[1],h=0,i=7,j=4;for(0===g&&(i=138,j=3),b[2*(c+1)+1]=65535,d=0;d<=c;d++)e=g,g=b[2*(d+1)+1],++h<i&&e===g||(h<j?a.bl_tree[2*e]+=h:0!==e?(e!==f&&a.bl_tree[2*e]++,a.bl_tree[2*$]++):h<=10?a.bl_tree[2*_]++:a.bl_tree[2*aa]++,h=0,f=e,0===g?(i=138,j=3):e===g?(i=6,j=3):(i=7,j=4))}function x(a,b,c){var d,e,f=-1,g=b[1],h=0,k=7,l=4;for(0===g&&(k=138,l=3),d=0;d<=c;d++)if(e=g,g=b[2*(d+1)+1],!(++h<k&&e===g)){if(h<l){do j(a,e,a.bl_tree);while(0!==--h)}else 0!==e?(e!==f&&(j(a,e,a.bl_tree),h--),j(a,$,a.bl_tree),i(a,h-3,2)):h<=10?(j(a,_,a.bl_tree),i(a,h-3,3)):(j(a,aa,a.bl_tree),i(a,h-11,7));h=0,f=e,0===g?(k=138,l=3):e===g?(k=6,l=3):(k=7,l=4)}}function y(a){var b;for(w(a,a.dyn_ltree,a.l_desc.max_code),w(a,a.dyn_dtree,a.d_desc.max_code),v(a,a.bl_desc),b=U-1;b>=3&&0===a.bl_tree[2*ea[b]+1];b--);return a.opt_len+=3*(b+1)+5+5+4,b}function z(a,b,c,d){var e;for(i(a,b-257,5),i(a,c-1,5),i(a,d-4,4),e=0;e<d;e++)i(a,a.bl_tree[2*ea[e]+1],3);x(a,a.dyn_ltree,b-1),x(a,a.dyn_dtree,c-1)}function A(a){var b,c=4093624447;for(b=0;b<=31;b++,c>>>=1)if(1&c&&0!==a.dyn_ltree[2*b])return I;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return J;for(b=32;b<R;b++)if(0!==a.dyn_ltree[2*b])return J;return I}function B(a){pa||(o(),pa=!0),a.l_desc=new f(a.dyn_ltree,ma),a.d_desc=new f(a.dyn_dtree,na),a.bl_desc=new f(a.bl_tree,oa),a.bi_buf=0,a.bi_valid=0,p(a)}function C(a,b,c,d){i(a,(L<<1)+(d?1:0),3),r(a,b,c,!0)}function D(a){i(a,M<<1,3),j(a,Z,ga),l(a)}function E(a,b,c,d){var e,f,g=0;a.level>0?(a.strm.data_type===K&&(a.strm.data_type=A(a)),v(a,a.l_desc),v(a,a.d_desc),g=y(a),e=a.opt_len+3+7>>>3,f=a.static_len+3+7>>>3,f<=e&&(e=f)):e=f=c+5,c+4<=e&&b!==-1?C(a,b,c,d):a.strategy===H||f===e?(i(a,(M<<1)+(d?1:0),3),u(a,ga,ha)):(i(a,(N<<1)+(d?1:0),3),z(a,a.l_desc.max_code+1,a.d_desc.max_code+1,g+1),u(a,a.dyn_ltree,a.dyn_dtree)),p(a),d&&q(a)}function F(a,b,c){return a.pending_buf[a.d_buf+2*a.last_lit]=b>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=255&b,a.pending_buf[a.l_buf+a.last_lit]=255&c,a.last_lit++,0===b?a.dyn_ltree[2*c]++:(a.matches++,b--,a.dyn_ltree[2*(ja[c]+R+1)]++,a.dyn_dtree[2*g(b)]++),a.last_lit===a.lit_bufsize-1}var G=a("../utils/common"),H=4,I=0,J=1,K=2,L=0,M=1,N=2,O=3,P=258,Q=29,R=256,S=R+1+Q,T=30,U=19,V=2*S+1,W=15,X=16,Y=7,Z=256,$=16,_=17,aa=18,ba=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ca=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],da=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ea=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],fa=512,ga=new Array(2*(S+2));d(ga);var ha=new Array(2*T);d(ha);var ia=new Array(fa);d(ia);var ja=new Array(P-O+1);d(ja);var ka=new Array(Q);d(ka);var la=new Array(T);d(la);var ma,na,oa,pa=!1;c._tr_init=B,c._tr_stored_block=C,c._tr_flush_block=E,c._tr_tally=F,c._tr_align=D},{"../utils/common":62}],74:[function(a,b,c){"use strict";function d(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}b.exports=d},{}]},{},[10])(10)});
/*! js-cookie v2.2.1 | MIT */

!function(a){var b;if("function"==typeof define&&define.amd&&(define(a),b=!0),"object"==typeof exports&&(module.exports=a(),b=!0),!b){var c=window.Cookies,d=window.Cookies=a();d.noConflict=function(){return window.Cookies=c,d}}}(function(){function a(){for(var a=0,b={};a<arguments.length;a++){var c=arguments[a];for(var d in c)b[d]=c[d]}return b}function b(a){return a.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function c(d){function e(){}function f(b,c,f){if("undefined"!=typeof document){f=a({path:"/"},e.defaults,f),"number"==typeof f.expires&&(f.expires=new Date(1*new Date+864e5*f.expires)),f.expires=f.expires?f.expires.toUTCString():"";try{var g=JSON.stringify(c);/^[\{\[]/.test(g)&&(c=g)}catch(j){}c=d.write?d.write(c,b):encodeURIComponent(c+"").replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),b=encodeURIComponent(b+"").replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var h="";for(var i in f)f[i]&&(h+="; "+i,!0!==f[i]&&(h+="="+f[i].split(";")[0]));return document.cookie=b+"="+c+h}}function g(a,c){if("undefined"!=typeof document){for(var e={},f=document.cookie?document.cookie.split("; "):[],g=0;g<f.length;g++){var h=f[g].split("="),i=h.slice(1).join("=");c||'"'!==i.charAt(0)||(i=i.slice(1,-1));try{var j=b(h[0]);if(i=(d.read||d)(i,j)||b(i),c)try{i=JSON.parse(i)}catch(k){}if(e[j]=i,a===j)break}catch(k){}}return a?e[a]:e}}return e.set=f,e.get=function(a){return g(a,!1)},e.getJSON=function(a){return g(a,!0)},e.remove=function(b,c){f(b,"",a(c,{expires:-1}))},e.defaults={},e.withConverter=c,e}return c(function(){})});
/**
* @author: Rinat G. http://coding.kz
* @copyright: Copyright (c) 2019 Rinat G.
* @license: Licensed under the MIT license. See http://www.opensource.org/licenses/mit-license.php
*/

// Following the UMD template https://github.com/umdjs/umd/blob/master/templates/returnExportsGlobal.js
(function (root, factory) {
  if (typeof define === 'function' && define.amd) {
      // AMD. Make globaly available as well
      define(['moment'], function (moment) {
          return factory(moment);
      });
  } else if (typeof module === 'object' && module.exports) {
      // Node / Browserify
      var moment = (typeof window != 'undefined' && typeof window.moment != 'undefined') ? window.moment : require('moment');
      module.exports = factory(moment);
  } else {
      // Browser globals
      root.Lightpick = factory(root.moment);
  }
}(this, function(moment) {
  'use strict';

  var document = window.document,

  defaults = {
      field: null,
      secondField: null,
      firstDay: 1,
      parentEl: 'body',
      lang: 'auto',
      format: 'DD/MM/YYYY',
      separator: ' - ',
      numberOfMonths: 1,
      numberOfColumns: 2,
      singleDate: true,
      autoclose: true,
      repick: false,
      startDate: null,
      endDate: null,
      minDate: null,
      maxDate: null,
      disableDates: null,
      selectForward: false,
      selectBackward: false,
      minDays: null,
      maxDays: null,
      onSelect: null,
      onOpen: null,
      onClose: null,
      onError: null,
      hoveringTooltip: true,
      hideOnBodyClick: true,
      footer: false,
      disabledDatesInRange: true,
      tooltipNights: false,
      orientation: 'auto',
      disableWeekends: false,
      locale: {
          buttons: {
              prev: '&leftarrow;',
              next: '&rightarrow;',
              close: '&times;',
              reset: 'Reset',
              apply: 'Apply',
          },
          tooltip: {
              one: 'day',
              other: 'days',
          },
          tooltipOnDisabled: null,
          pluralize: function(i, locale){
              if (typeof i === "string") i = parseInt(i, 10);

              if (i === 1 && 'one' in locale) return locale.one;
              if ('other' in locale) return locale.other;

              return '';
          }
      }
  },

  renderTopButtons = function(opts, viewMode)
  {
      return '<div class="lightpick__toolbar">'
          + ''
          + '<button type="button" class="lightpick__previous-action" data-view-mode="' + viewMode + '">' + opts.locale.buttons.prev + '</button>'
          + '<button type="button" class="lightpick__next-action" data-view-mode="' + viewMode + '">' + opts.locale.buttons.next + '</button>'
          + (!opts.autoclose ? '<button type="button" class="lightpick__close-action">' + opts.locale.buttons.close + '</button>'  : '')
          + '</div>';
  },

  weekdayName = function(opts, day, short)
  {
      return new Date(1970, 0, day).toLocaleString(opts.lang, { weekday: short ? 'short' : 'long' })
  },

  renderDay = function(opts, date, dummy, extraClass)
  {
      if (dummy) return '<div></div>';

      var date = moment(date),
          prevMonth = moment(date).subtract(1, 'month'),
          nextMonth = moment(date).add(1, 'month');

      var day = {
          time: moment(date).valueOf(),
          className: ['lightpick__day', 'is-available']
      };

      if (extraClass instanceof Array || Object.prototype.toString.call(extraClass) === '[object Array]') {
          extraClass = extraClass.filter( function( el ) {
              return ['lightpick__day', 'is-available', 'is-previous-month', 'is-next-month'].indexOf( el ) >= 0;
          });
          day.className = day.className.concat(extraClass);
      }
      else {
          day.className.push(extraClass);
      }

      if (opts.disableDates) {
          for (var i = 0; i < opts.disableDates.length; i++) {
              if (opts.disableDates[i] instanceof Array || Object.prototype.toString.call(opts.disableDates[i]) === '[object Array]') {
                  var _from = moment(opts.disableDates[i][0]),
                      _to = moment(opts.disableDates[i][1]);

                  if (_from.isValid() && _to.isValid() && date.isBetween(_from, _to, 'day', '[]')){
                      day.className.push('is-disabled');
                  }
              }
              else if (moment(opts.disableDates[i]).isValid() && moment(opts.disableDates[i]).isSame(date, 'day')) {
                  day.className.push('is-disabled');
              }

              if (day.className.indexOf('is-disabled') >= 0) {

                  if (opts.locale.tooltipOnDisabled && (!opts.startDate || date.isAfter(opts.startDate) || opts.startDate && opts.endDate)) {
                      day.className.push('disabled-tooltip');
                  }

                  if (day.className.indexOf('is-start-date') >= 0) {
                      this.setStartDate(null);
                      this.setEndDate(null);
                  }
                  else if (day.className.indexOf('is-end-date') >= 0) {
                      this.setEndDate(null);
                  }
              }
          }
      }

      if (opts.minDays && opts.startDate && !opts.endDate) {
          if (date.isBetween(moment(opts.startDate).subtract(opts.minDays - 1, 'day'), moment(opts.startDate).add(opts.minDays - 1, 'day'), 'day')) {
              day.className.push('is-disabled');

              if (opts.selectForward && date.isSameOrAfter(opts.startDate)) {
                  day.className.push('is-forward-selected');
                  day.className.push('is-in-range');
              }
          }
      }

      if (opts.maxDays && opts.startDate && !opts.endDate) {
          if (date.isSameOrBefore(moment(opts.startDate).subtract(opts.maxDays, 'day'), 'day')) {
              day.className.push('is-disabled');
          }
          else if (date.isSameOrAfter(moment(opts.startDate).add(opts.maxDays, 'day'), 'day')) {
              day.className.push('is-disabled');
          }
      }

      if (opts.repick && (opts.minDays || opts.maxDays) && opts.startDate && opts.endDate) {
          var tempStartDate = moment(opts.repickTrigger == opts.field ? opts.endDate : opts.startDate);

          if (opts.minDays) {
              if (date.isBetween(moment(tempStartDate).subtract(opts.minDays - 1, 'day'), moment(tempStartDate).add(opts.minDays - 1, 'day'), 'day')) {
                  day.className.push('is-disabled');
              }
          }

          if (opts.maxDays) {
              if (date.isSameOrBefore(moment(tempStartDate).subtract(opts.maxDays, 'day'), 'day')) {
                  day.className.push('is-disabled');
              }
              else if (date.isSameOrAfter(moment(tempStartDate).add(opts.maxDays, 'day'), 'day')) {
                  day.className.push('is-disabled');
              }
          }
      }

      if (date.isSame(new Date(), 'day')) {
          day.className.push('is-today');
      }

      if (date.isSame(opts.startDate, 'day')) {
          day.className.push('is-start-date');
      }

      if (date.isSame(opts.endDate, 'day')) {
          day.className.push('is-end-date');
      }

      if (opts.startDate && opts.endDate && date.isBetween(opts.startDate, opts.endDate, 'day', '[]')) {
          day.className.push('is-in-range');
      }

      if (moment().isSame(date, 'month')) {

      }
      else if (prevMonth.isSame(date, 'month')) {
          day.className.push('is-previous-month');
      }
      else if (nextMonth.isSame(date, 'month')) {
          day.className.push('is-next-month');
      }

      if (opts.minDate && date.isBefore(opts.minDate, 'day')) {
          day.className.push('is-disabled');
      }

      if (opts.maxDate && date.isAfter(opts.maxDate, 'day')) {
          day.className.push('is-disabled');
      }

      if (opts.selectForward && !opts.singleDate && opts.startDate && !opts.endDate && date.isBefore(opts.startDate, 'day')) {
          day.className.push('is-disabled');
      }

      if (opts.selectBackward && !opts.singleDate && opts.startDate && !opts.endDate && date.isAfter(opts.startDate, 'day')) {
          day.className.push('is-disabled');
      }

      if (opts.disableWeekends && (date.isoWeekday() == 6 || date.isoWeekday() == 7)) {
          day.className.push('is-disabled');
      }

      day.className = day.className.filter(function(value, index, self) {
          return self.indexOf(value) === index;
      });

      if (day.className.indexOf('is-disabled') >= 0 && day.className.indexOf('is-available') >= 0) {
          day.className.splice(day.className.indexOf('is-available'), 1);
      }

      var div = document.createElement('div');
      div.className = day.className.join(' ');
      div.innerHTML = date.get('date');
      div.setAttribute('data-time', day.time);

      return div.outerHTML;
  },

  renderCalendar = function(el, opts)
  {
      var html = '',
          monthDate = moment(opts.calendar[0]);

      for (var i = 0; i < opts.numberOfMonths; i++) {
          var day = moment(monthDate);

          html += '<section class="lightpick__month">';
          html += '<header class="lightpick__month-title-bar">'
          html += '<h1 class="lightpick__month-title" data-ym="' + day.format('YYYY-MM') + '">'
          + '<b class="lightpick__month-title-accent">' + day.toDate().toLocaleString(opts.lang, { month: 'long' }) + '</b> '
          + day.format('YYYY')
          + '</h1>';

          if (opts.numberOfMonths === 1) {
              html += renderTopButtons(opts, 'days');
          }

          html += '</header>'; // lightpick__month-title-bar

          html += '<div class="lightpick__days-of-the-week">';
          for (var w = opts.firstDay + 4; w < 7 + opts.firstDay + 4; ++w) {
              html += '<div class="lightpick__day-of-the-week" title="' + weekdayName(opts, w) + '">' + weekdayName(opts, w, true) + '</div>';
          }
          html += '</div>'; // lightpick__days-of-the-week

          html += '<div class="lightpick__days">';

          if (day.isoWeekday() !== opts.firstDay) {
              var prevDays = day.isoWeekday() - opts.firstDay > 0 ? day.isoWeekday() - opts.firstDay : day.isoWeekday(),
                  prevMonth = moment(day).subtract(prevDays, 'day'),
                  daysInMonth = prevMonth.daysInMonth();

              for (var d = prevMonth.get('date'); d <= daysInMonth; d++) {
                  html += renderDay(opts, prevMonth, i > 0, 'is-previous-month');

                  prevMonth.add(1, 'day');
              }
          }

          var daysInMonth = day.daysInMonth(),
              today = new Date();

          for (var d = 0; d < daysInMonth; d++) {
              html += renderDay(opts, day);

              day.add(1, 'day');
          }

          var nextMonth = moment(day),
              nextDays = 7 - nextMonth.isoWeekday() + opts.firstDay;

          if (nextDays < 7) {
              for (var d = nextMonth.get('date'); d <= nextDays; d++) {
                  html += renderDay(opts, nextMonth, i < opts.numberOfMonths - 1, 'is-next-month');

                  nextMonth.add(1, 'day');
              }
          }

          html += '</div>'; // lightpick__days

          html += '</section>'; // lightpick__month

          monthDate.add(1, 'month');
      }

      opts.calendar[1] = moment(monthDate);

      el.querySelector('.lightpick__months').innerHTML = html;
  },

  renderMonthsOfYear = function(el, opts, date)
  {
      if (date) {
          opts.calendar[0] = moment(date);
      }
      var ym = moment(opts.calendar[0]);

      var html = '<header class="lightpick__month-title-bar">'
      html += '<h1 class="lightpick__month-title">' + ym.format('YYYY') +  '</h1>';
      html += renderTopButtons(opts, 'months');
      html += '</header>';

      html += '<div class="lightpick__months-of-the-year-list">';

      for (var i = 1; i <= 12; i++) {
          html += '<div class="lightpick__month-of-the-year" data-goto-month="' + ym.format('YYYY') + '-' + i + '">'
               + '<div>' + moment(i, 'M').toDate().toLocaleString(opts.lang, { month: 'long' }) + '</div>'
               + '<div>' + ym.format('YYYY') + '</div>'
               + '</div>';
      }
      html += '</div>';

      el.querySelector('.lightpick__months-of-the-year').innerHTML = html;
  },

  updateDates = function(el, opts)
  {
      var days = el.querySelectorAll('.lightpick__day');
      [].forEach.call(days, function(day) {
          day.outerHTML = renderDay(opts, parseInt(day.getAttribute('data-time')), false, day.className.split(' '));
      });

      checkDisabledDatesInRange(el, opts);
  },

  checkDisabledDatesInRange = function(el, opts)
  {
      if (opts.disabledDatesInRange || !opts.startDate || opts.endDate || !opts.disableDates) return;

      var days = el.querySelectorAll('.lightpick__day'),
          disabledArray = opts.disableDates.map(function(entry){
              return entry instanceof Array || Object.prototype.toString.call(entry) === '[object Array]' ? entry[0] : entry;
          }),
          closestPrev = moment(disabledArray.filter(function(d) {
              return moment(d).isBefore(opts.startDate);
          }).sort(function(a,b){
              return moment(b).isAfter(moment(a));
          })[0]),
          closestNext = moment(disabledArray.filter(function(d) {
              return moment(d).isAfter(opts.startDate);
          }).sort(function(a,b){
              return moment(a).isAfter(moment(b));
          })[0]);

      [].forEach.call(days, function(dayCell) {
          var day = moment(parseInt(dayCell.getAttribute('data-time')));
          if (
              (closestPrev && day.isBefore(closestPrev) && opts.startDate.isAfter(closestPrev))
              || (closestNext && day.isAfter(closestNext) && closestNext.isAfter(opts.startDate))
          ) {
              dayCell.classList.remove('is-available');
              dayCell.classList.add('is-disabled');
          }
      });
  },

  Lightpick = function(options)
  {
      var self = this,
          opts = self.config(options);

      self.el = document.createElement('section');

      self.el.className = 'lightpick lightpick--' + opts.numberOfColumns + '-columns is-hidden';

      if (opts.parentEl !== 'body') {
          self.el.className += ' lightpick--inlined';
      }

      var html = '<div class="lightpick__inner">'
      + (opts.numberOfMonths > 1 ? renderTopButtons(opts, 'days') : '')
      + '<div class="lightpick__months"></div>'
      + '<div class="lightpick__tooltip" style="visibility: hidden"></div>'
      + '<div class="lightpick__months-of-the-year"></div>';

      if (opts.footer) {
          html += '<div class="lightpick__footer">';
          if (opts.footer === true) {
              html += '<button type="button" class="lightpick__reset-action">' + opts.locale.buttons.reset + '</button>';
              html += '<div class="lightpick__footer-message"></div>';
              html += '<button type="button" class="lightpick__apply-action">' + opts.locale.buttons.apply + '</button>';
          }
          else {
              html += opts.footer;
          }
          html += '</div>';
      }

      html += '</div>';

      self.el.innerHTML = html;


      if (opts.parentEl instanceof Node) {
          opts.parentEl.appendChild(self.el)
      } else {
          document.querySelector(opts.parentEl).appendChild(self.el);
      }

      self._onMouseDown = function(e)
      {
          if (!self.isShowing) {
              return;
          }

          e = e || window.event;
          var target = e.target || e.srcElement;
          if (!target) {
              return;
          }

          e.stopPropagation();
          e.preventDefault();

          var opts = self._opts;

          if (target.classList.contains('lightpick__day') && target.classList.contains('is-available')) {

              var day = moment(parseInt(target.getAttribute('data-time')));

              if (!opts.disabledDatesInRange && opts.disableDates && opts.startDate) {
                  var start = day.isAfter(opts.startDate) ? moment(opts.startDate) : moment(day),
                      end = day.isAfter(opts.startDate) ? moment(day) : moment(opts.startDate),

                      isInvalidRange = opts.disableDates.filter(function(d) {
                      if (d instanceof Array || Object.prototype.toString.call(d) === '[object Array]') {
                          var _from = moment(d[0]),
                              _to = moment(d[1]);

                          return _from.isValid() && _to.isValid() && (_from.isBetween(start, end, 'day', '[]') || _to.isBetween(start, end, 'day', '[]'));
                      }

                      return moment(d).isBetween(start, end, 'day', '[]');
                  });

                  if (isInvalidRange.length) {
                      self.setStartDate(null);
                      self.setEndDate(null);

                      target.dispatchEvent(new Event('mousedown'));
                      self.el.querySelector('.lightpick__tooltip').style.visibility = 'hidden';

                      updateDates(self.el, opts);
                      return;
                  }
              }

              if (opts.singleDate || (!opts.startDate && !opts.endDate) || (opts.startDate && opts.endDate)) {
                  if (opts.repick && opts.startDate && opts.endDate) {
                      if (opts.repickTrigger === opts.field) {
                          self.setStartDate(day);
                          target.classList.add('is-start-date');
                      }
                      else {
                          self.setEndDate(day);
                          target.classList.add('is-end-date');
                      }

                      if (opts.startDate.isAfter(opts.endDate)) {
                          self.swapDate();
                      }

                      if (opts.autoclose) {
                          setTimeout(function() {
                              self.hide();
                          }, 100);
                      }
                  }
                  else {
                      self.setStartDate(day);
                      self.setEndDate(null);

                      target.classList.add('is-start-date');

                      if (opts.singleDate && opts.autoclose) {
                          setTimeout(function() {
                              self.hide();
                          }, 100);
                      }
                      else if (!opts.singleDate) {
                          updateDates(self.el, opts);
                      }
                  }
              }
              else if (opts.startDate && !opts.endDate) {
                  self.setEndDate(day);

                  if (opts.startDate.isAfter(opts.endDate)) {
                      self.swapDate();
                  }

                  target.classList.add('is-end-date');


                  if (opts.autoclose) {
                      setTimeout(function() {
                          self.hide();
                      }, 100);
                  }
                  else {
                      updateDates(self.el, opts);
                  }
              }

              if (!opts.disabledDatesInRange) {
                  if (self.el.querySelectorAll('.lightpick__day.is-available').length === 0) {
                      self.setStartDate(null);
                      updateDates(self.el, opts);

                      if (opts.footer) {
                          if (typeof self._opts.onError === 'function') {
                              self._opts.onError.call(self, 'Invalid range');
                          }
                          else {
                              var footerMessage = self.el.querySelector('.lightpick__footer-message');

                              if (footerMessage) {
                                  footerMessage.innerHTML = opts.locale.not_allowed_range;

                                  setTimeout(function(){
                                      footerMessage.innerHTML = '';
                                  }, 3000);
                              }
                          }
                      }
                  }
              }
          }
          else if (target.classList.contains('lightpick__previous-action')) {
              if (target.hasAttribute('data-view-mode')) {
                  var viewMode = target.getAttribute('data-view-mode');

                  switch (viewMode) {
                      case 'days':
                          self.prevMonth();
                      break;

                      case 'months':
                          self.prevYear();
                      break;
                  }
              }
          }
          else if (target.classList.contains('lightpick__next-action')) {
              if (target.hasAttribute('data-view-mode')) {
                  var viewMode = target.getAttribute('data-view-mode');

                  switch (viewMode) {
                      case 'days':
                          self.nextMonth();
                      break;

                      case 'months':
                          self.nextYear();
                      break;
                  }
              }
          }
          else if (target.classList.contains('lightpick__close-action') || target.classList.contains('lightpick__apply-action')) {
              self.hide();
          }
          else if (target.classList.contains('lightpick__reset-action')) {
              self.reset();
          }
          else if (target.classList.contains('lightpick__month-title-accent')) {
            if (target.parentNode.hasAttribute('data-ym')) {
                var _toolbar = self.el.querySelector('.lightpick__inner > .lightpick__toolbar');
                if (_toolbar) {
                    _toolbar.style.display = 'none';
                }

                self.el.querySelector('.lightpick__months').innerHTML = '';
                renderMonthsOfYear(self.el, opts, target.getAttribute('data-ym'));
            }
          }
          else if (target.classList.contains('lightpick__month-title')) {
              if (target.hasAttribute('data-ym')) {
                  var _toolbar = self.el.querySelector('.lightpick__inner > .lightpick__toolbar');
                  if (_toolbar) {
                      _toolbar.style.display = 'none';
                  }

                  self.el.querySelector('.lightpick__months').innerHTML = '';
                  renderMonthsOfYear(self.el, opts, target.getAttribute('data-ym'));
              }
          }
          else if (target.hasAttribute('data-goto-month')) {
              var month = moment(target.getAttribute('data-goto-month'), 'YYYY-M');
              if (month.isValid()) {
                  self.gotoDate(month);

                  self.el.querySelector('.lightpick__months-of-the-year').innerHTML = '';

                  var _toolbar = self.el.querySelector('.lightpick__inner > .lightpick__toolbar');
                  if (_toolbar) {
                      _toolbar.style.display = 'flex';
                  }
              }
          }

      };
      self._onMouseEnter = function(e)
      {
          if (!self.isShowing) {
              return;
          }

          e = e || window.event;
          var target = e.target || e.srcElement;
          if (!target) {
              return;
          }

          var opts = self._opts;

          if (target.classList.contains('lightpick__day') && target.classList.contains('disabled-tooltip') && opts.locale.tooltipOnDisabled) {
              self.showTooltip(target, opts.locale.tooltipOnDisabled);
              return;
          }
          else {
              self.hideTooltip();
          }

          if (opts.singleDate || (!opts.startDate && !opts.endDate)) {
              return;
          }

          if (!target.classList.contains('lightpick__day') && !target.classList.contains('is-available')) {
              return;
          }

          if ((opts.startDate && !opts.endDate) || opts.repick) {
              var hoverDate = moment(parseInt(target.getAttribute('data-time')));

              if (!hoverDate.isValid()) {
                  return;
              }

              var startDate = (opts.startDate && !opts.endDate) || (opts.repick && opts.repickTrigger === opts.secondField) ? opts.startDate : opts.endDate;

              var days = self.el.querySelectorAll('.lightpick__day');
              [].forEach.call(days, function(day) {
                  var dt = moment(parseInt(day.getAttribute('data-time')));

                  day.classList.remove('is-flipped');

                  if (dt.isValid() && dt.isSameOrAfter(startDate, 'day') && dt.isSameOrBefore(hoverDate, 'day')) {
                      day.classList.add('is-in-range');

                      if (opts.repickTrigger === opts.field && dt.isSameOrAfter(opts.endDate)) {
                          day.classList.add('is-flipped');
                      }
                  }
                  else if (dt.isValid() && dt.isSameOrAfter(hoverDate, 'day') && dt.isSameOrBefore(startDate, 'day')) {
                      day.classList.add('is-in-range');

                      if (((opts.startDate && !opts.endDate) || opts.repickTrigger === opts.secondField) && dt.isSameOrBefore(opts.startDate)) {
                          day.classList.add('is-flipped');
                      }
                  }
                  else {
                      day.classList.remove('is-in-range');
                  }

                  if (opts.startDate && opts.endDate && opts.repick && opts.repickTrigger === opts.field) {
                      day.classList.remove('is-start-date');
                  }
                  else {
                      day.classList.remove('is-end-date');
                  }
              });

              if (opts.hoveringTooltip) {
                  days = Math.abs(hoverDate.isAfter(startDate) ? hoverDate.diff(startDate, 'day') : startDate.diff(hoverDate, 'day'));

                  if (!opts.tooltipNights) {
                      days += 1;
                  }

                  var tooltip = self.el.querySelector('.lightpick__tooltip');

                  if (days > 0 && !target.classList.contains('is-disabled')) {

                      var pluralText = '';
                      if (typeof opts.locale.pluralize === 'function') {
                          pluralText = opts.locale.pluralize.call(self, days, opts.locale.tooltip);
                      }

                      self.showTooltip(target, days + ' ' + pluralText);
                  }
                  else {
                      self.hideTooltip();
                  }
              }

              if (opts.startDate && opts.endDate && opts.repick && opts.repickTrigger === opts.field) {
                  target.classList.add('is-start-date');
              }
              else {
                  target.classList.add('is-end-date');
              }
          }
      };
      self._onChange = function(e)
      {
          e = e || window.event;
          var target = e.target || e.srcElement;
          if (!target) {
              return;
          }

          if (target.classList.contains('is-selected-lightpick-month')) {
              self.gotoMonth(target.value);
          }
          else if (target.classList.contains('is-selected-lightpick-year')) {
              self.gotoYear(target.value);
          }
      };

      self._onInputChange = function(e)
      {
          var target = e.target || e.srcElement;

          if (self._opts.singleDate) {
              if (!self._opts.autoclose) {
                  self.gotoDate(opts.field.value);
              }

              self.setStartDate(opts.field.value);
          }

          if (!self.isShowing) {
              self.show();
          }
      };

      self._onInputFocus = function(e)
      {
          var target = e.target || e.srcElement;

          self.show(target);
      };

      self._onInputClick = function(e)
      {
          var target = e.target || e.srcElement;

          self.show(target);
      };

      self._onClick = function(e)
      {
          e = e || window.event;
          var target = e.target || e.srcElement,
              parentEl = target;

          if (!target) {
              return;
          }

          do {
              if ((parentEl.classList && parentEl.classList.contains('lightpick')) || parentEl === opts.field || (opts.secondField && parentEl === opts.secondField)) {
                  return;
              }
          }
          while ((parentEl = parentEl.parentNode));

          if (self.isShowing && opts.hideOnBodyClick && target !== opts.field && parentEl !== opts.field) {
              self.hide();
          }
      };

      self.showTooltip = function(target, text)
      {
          var tooltip = self.el.querySelector('.lightpick__tooltip');

          var hasParentEl = self.el.classList.contains('lightpick--inlined'),
          dayBounding = target.getBoundingClientRect(),
          pickerBouding = hasParentEl ? self.el.parentNode.getBoundingClientRect() : self.el.getBoundingClientRect(),
          _left = (dayBounding.left - pickerBouding.left) + (dayBounding.width / 2),
          _top = dayBounding.top - pickerBouding.top;

          tooltip.style.visibility = 'visible';
          tooltip.textContent = text;

          var tooltipBounding = tooltip.getBoundingClientRect();

          _top -= tooltipBounding.height;
          _left -= (tooltipBounding.width / 2);

          setTimeout(function(){
              tooltip.style.top = _top + 'px';
              tooltip.style.left = _left + 'px';
          }, 10);
      };

      self.hideTooltip = function()
      {
          var tooltip = self.el.querySelector('.lightpick__tooltip');
          tooltip.style.visibility = 'hidden';
      };

      self.el.addEventListener('mousedown', self._onMouseDown, true);
      self.el.addEventListener('mouseenter', self._onMouseEnter, true);
      //self.el.addEventListener('touchend', self._onMouseDown, true); // touchend being overwritten inside DatePick.js. Rollback in case of issues.

      self.hide();

      opts.field.addEventListener('change', self._onInputChange);
      opts.field.addEventListener('click', self._onInputClick);
      opts.field.addEventListener('focus', self._onInputFocus);

      if (opts.secondField) {
          opts.secondField.addEventListener('change', self._onInputChange);
          opts.secondField.addEventListener('click', self._onInputClick);
          opts.secondField.addEventListener('focus', self._onInputFocus);
      }
  };

  Lightpick.prototype = {
      config: function(options)
      {
          var opts = Object.assign({}, defaults, options);

          opts.field = (opts.field && opts.field.nodeName) ? opts.field : null;

          opts.calendar = [moment().set('date', 1)];

          if (opts.numberOfMonths === 1 && opts.numberOfColumns > 1) {
              opts.numberOfColumns = 1;
          }

          opts.minDate = opts.minDate && moment(opts.minDate).isValid() ? moment(opts.minDate) : null;

          opts.maxDate = opts.maxDate && moment(opts.maxDate).isValid() ? moment(opts.maxDate) : null;

          if (opts.lang === 'auto') {
              var browserLang = navigator.language || navigator.userLanguage;
              if (browserLang) {
                  opts.lang = browserLang;
              }
              else {
                  opts.lang = 'en-US';
              }
          }

          if (opts.secondField && opts.singleDate) {
              opts.singleDate = false;
          }

          if (opts.hoveringTooltip && opts.singleDate) {
              opts.hoveringTooltip = false;
          }

          if (Object.prototype.toString.call(options.locale) === '[object Object]') {
              opts.locale = Object.assign({}, defaults.locale, options.locale);
          }

          if (window.innerWidth < 480 && opts.numberOfMonths > 1) {
              opts.numberOfMonths = 1;
              opts.numberOfColumns = 1;
          }

          if (opts.repick && !opts.secondField) {
              opts.repick = false;
          }

          this._opts = Object.assign({}, opts);

          if (this.getStartDate() === null && moment(this._opts.field.value, this._opts.format).isValid()) {
              this._opts.startDate = moment(this._opts.field.value, this._opts.format);
          }

          if (this.getEndDate() === null && this._opts.secondField && moment(this._opts.secondField.value, this._opts.format).isValid()) {
              this._opts.endDate = moment(this._opts.secondField.value, this._opts.format);
          }

          this.setStartDate(this._opts.startDate, true);
          this.setEndDate(this._opts.endDate, true);

          return this._opts;
      },

      swapDate: function()
      {
          var tmp = moment(this._opts.startDate);
          this.setDateRange(this._opts.endDate, tmp);
      },

      gotoToday: function()
      {
          this.gotoDate(new Date());
      },

      gotoDate: function(date)
      {
          var date = moment(date);

          if (!date.isValid()) {
              date = moment();
          }

          date.set('date', 1);

          this._opts.calendar = [moment(date)];

          renderCalendar(this.el, this._opts);
      },

      gotoMonth: function(month)
      {
          if (isNaN(month)) {
              return;
          }

          this._opts.calendar[0].set('month', month);

          renderCalendar(this.el, this._opts);
      },

      prevMonth: function()
      {
          this._opts.calendar[0] = moment(this._opts.calendar[0]).subtract(this._opts.numberOfMonths, 'month');

          renderCalendar(this.el, this._opts);

          checkDisabledDatesInRange(this.el, this._opts);
      },

      nextMonth: function()
      {
          this._opts.calendar[0] = moment(this._opts.calendar[1]);

          renderCalendar(this.el, this._opts);

          checkDisabledDatesInRange(this.el, this._opts);
      },

      prevYear: function()
      {
          this._opts.calendar[0] = moment(this._opts.calendar[0]).subtract(1, 'year');

          renderMonthsOfYear(this.el, this._opts);
      },

      nextYear: function()
      {
          this._opts.calendar[0] = moment(this._opts.calendar[0]).add(1, 'year');

          renderMonthsOfYear(this.el, this._opts);
      },

      updatePosition: function()
      {
          if (this.el.classList.contains('lightpick--inlined')) return;

          // remove `is-hidden` class for getBoundingClientRect
          this.el.classList.remove('is-hidden');

          var rect = this._opts.field.getBoundingClientRect(),
              calRect = this.el.getBoundingClientRect(),
              orientation = this._opts.orientation.split(' '),
              top = 0,
              left = 0;

          if (orientation[0] == 'auto' || !(/top|bottom/.test(orientation[0]))) {
              if (rect.bottom + calRect.height > window.innerHeight && window.pageYOffset > calRect.height) {
                  top = (rect.top + window.pageYOffset) - calRect.height;
              }
              else {
                  top = rect.bottom + window.pageYOffset;
              }
          }
          else {
              top = rect[orientation[0]] + window.pageYOffset;

              if (orientation[0] == 'top') {
                  top -= calRect.height;
              }
          }

          if (!(/left|right/.test(orientation[0])) && (!orientation[1] || orientation[1] == 'auto' || !(/left|right/.test(orientation[1])))) {
              if (rect.left + calRect.width > window.innerWidth) {
                  left = (rect.right + window.pageXOffset) - calRect.width;
              }
              else {
                  left = rect.left + window.pageXOffset;
              }
          }
          else {
              if (/left|right/.test(orientation[0])) {
                  left = rect[orientation[0]] + window.pageXOffset;
              }
              else {
                  left = rect[orientation[1]] + window.pageXOffset;
              }

              if (orientation[0] == 'right' || orientation[1] == 'right') {
                  left -= calRect.width;
              }
          }

          this.el.classList.add('is-hidden');

          this.el.style.top = top + 'px';
          this.el.style.left = left + 'px';
      },

      setStartDate: function(date, preventOnSelect)
      {
          var dateISO = moment(date, moment.ISO_8601),
              dateOptFormat = moment(date, this._opts.format);

          if (!dateISO.isValid() && !dateOptFormat.isValid()) {
              this._opts.startDate = null;
              this._opts.field.value = '';
              return;
          }

          this._opts.startDate = moment(dateISO.isValid() ? dateISO : dateOptFormat);

          if (this._opts.singleDate || this._opts.secondField) {
              this._opts.field.value = this._opts.startDate.format(this._opts.format);
          }
          else {
              this._opts.field.value = this._opts.startDate.format(this._opts.format) + this._opts.separator + '...'
          }

          if (!preventOnSelect && typeof this._opts.onSelect === 'function') {
              this._opts.onSelect.call(this, this.getStartDate(), this.getEndDate());
          }
      },

      setEndDate: function(date, preventOnSelect)
      {
          var dateISO = moment(date, moment.ISO_8601),
              dateOptFormat = moment(date, this._opts.format);

          if (!dateISO.isValid() && !dateOptFormat.isValid()) {
              this._opts.endDate = null;

              if (this._opts.secondField) {
                  this._opts.secondField.value = '';
              }
              else if (!this._opts.singleDate && this._opts.startDate) {
                  this._opts.field.value = this._opts.startDate.format(this._opts.format) + this._opts.separator + '...'
              }
              return;
          }

          this._opts.endDate = moment(dateISO.isValid() ? dateISO : dateOptFormat);

          if (this._opts.secondField) {
              this._opts.field.value = this._opts.startDate.format(this._opts.format);
              this._opts.secondField.value = this._opts.endDate.format(this._opts.format);
          }
          else {
              this._opts.field.value = this._opts.startDate.format(this._opts.format) + this._opts.separator + this._opts.endDate.format(this._opts.format);
          }

          if (!preventOnSelect && typeof this._opts.onSelect === 'function') {
              this._opts.onSelect.call(this, this.getStartDate(), this.getEndDate());
          }
      },

      setDate: function(date)
      {
          if (!this._opts.singleDate) {
              return;
          }
          this.setStartDate(date, true);
      },

      setDateRange: function(start, end, preventOnSelect)
      {
          if (this._opts.singleDate) {
              return;
          }
          this.setStartDate(start, true);
          this.setEndDate(end, true);

          if (this.isShowing) {
              updateDates(this.el, this._opts);
          }

          if (!preventOnSelect && typeof this._opts.onSelect === 'function') {
              this._opts.onSelect.call(this, this.getStartDate(), this.getEndDate());
          }
      },

      setDisableDates: function(dates)
      {
          this._opts.disableDates = dates;

          if (this.isShowing) {
              updateDates(this.el, this._opts);
          }
      },

      getStartDate: function()
      {
          return moment(this._opts.startDate).isValid() ? this._opts.startDate : null;
      },

      getEndDate: function()
      {
          return moment(this._opts.endDate).isValid() ? this._opts.endDate : null;
      },

      getDate: function()
      {
          return moment(this._opts.startDate).isValid() ? this._opts.startDate : null;
      },

      toString: function(format)
      {
          if (this._opts.singleDate) {
              return moment(this._opts.startDate).isValid() ? this._opts.startDate.format(format) : '';
          }

          if (moment(this._opts.startDate).isValid() && moment(this._opts.endDate).isValid()) {
              return this._opts.startDate.format(format) + this._opts.separator + this._opts.endDate.format(format);
          }

          if (moment(this._opts.startDate).isValid() && !moment(this._opts.endDate).isValid()) {
              return this._opts.startDate.format(format) + this._opts.separator + '...';
          }

          if (!moment(this._opts.startDate).isValid() && moment(this._opts.endDate).isValid()) {
              return '...' + this._opts.separator + this._opts.endDate.format(format);
          }

          return '';
      },

      show: function(target)
      {
          if (!this.isShowing) {
              this.isShowing = true;

              if (this._opts.repick) {
                  this._opts.repickTrigger = target;
              }

              if (this._opts.secondField && this._opts.secondField === target && this._opts.endDate) {
                  this.gotoDate(this._opts.endDate);
              }
              else {
                  this.gotoDate(this._opts.startDate);
              }

              document.addEventListener('click', this._onClick);

              this.updatePosition();

              this.el.classList.remove('is-hidden');

              if (typeof this._opts.onOpen === 'function') {
                  this._opts.onOpen.call(this);
              }

              this.el.querySelector('.lightpick__months-of-the-year').innerHTML = '';

              if (document.activeElement && document.activeElement != document.body) {
                  document.activeElement.blur();
              }
          }
      },

      hide: function()
      {
          if (this.isShowing) {
              this.isShowing = false;

              document.removeEventListener('click', this._onClick);

              this.el.classList.add('is-hidden');

              this.el.querySelector('.lightpick__tooltip').style.visibility = 'hidden';

              if (typeof this._opts.onClose === 'function') {
                  this._opts.onClose.call(this);
              }
          }
      },

      destroy: function()
      {
          var opts = this._opts;

          this.hide();
          this.el.removeEventListener('mousedown', this._onMouseDown, true);
          this.el.removeEventListener('touchend', this._onMouseDown, true);
          this.el.removeEventListener('change', this._onChange, true);

          opts.field.removeEventListener('change', this._onInputChange);
          opts.field.removeEventListener('click', this._onInputClick);
          opts.field.removeEventListener('focus', this._onInputFocus);

          if (opts.secondField) {
              opts.secondField.removeEventListener('change', this._onInputChange);
              opts.secondField.removeEventListener('click', this._onInputClick);
              opts.secondField.removeEventListener('focus', this._onInputFocus);
          }

          if (this.el.parentNode) {
              this.el.parentNode.removeChild(this.el);
          }
      },

      reset: function()
      {
          this.setStartDate(null, true);
          this.setEndDate(null, true);

          updateDates(this.el, this._opts);

          if (typeof this._opts.onSelect === 'function') {
              this._opts.onSelect.call(this, this.getStartDate(), this.getEndDate());
          }

          this.el.querySelector('.lightpick__tooltip').style.visibility = 'hidden';
      },

      reloadOptions: function(options)
      {
          this._opts = Object.assign({}, this._opts, options);
      }

  };

  return Lightpick;
}));

/**
 * Object-fit Images for IE11
 * @link https://github.com/renansan/object-fit-images
 * @link npm.im/object-fit-images 3.2.4
 *
 * The project's archived by the owner, so we made changes directly in this file. More info:
 * @link https://github.com/bfred-it/object-fit-images/issues/104#issuecomment-437572463
 */
 var objectFitImages=function(){"use strict";function t(t,e){return"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='"+t+"' height='"+e+"'%3E%3C/svg%3E"}function e(t){if(t.srcset&&!m&&window.picturefill){var e=window.picturefill._;t[e.ns]&&t[e.ns].evaled||e.fillImg(t,{reselect:!0}),t[e.ns].curSrc||(t[e.ns].supported=!1,e.fillImg(t,{reselect:!0})),t.currentSrc=t[e.ns].curSrc||t.src}}function r(t){for(var e,r=getComputedStyle(t).fontFamily,i={};null!==(e=u.exec(r));)i[e[1]]=e[2];return i}function i(e,r,i){var n=t(r||1,i||0);p.call(e,"src")!==n&&b.call(e,"src",n)}function n(t,e){t.naturalWidth?e(t):setTimeout(n,100,t,e)}function c(t){var c=r(t),o=t[a];if(t.naturalWidth){if(c["object-fit"]=c["object-fit"]||"fill",!o.img){if("fill"===c["object-fit"])return;if(!o.skipTest&&g&&!c["object-position"])return}if(!o.img){o.img=new Image(t.width,t.height),o.img.srcset=p.call(t,"data-ofi-srcset")||t.srcset;var u=p.call(t,"data-ofi-src")||t.src;u&&(o.img.src=u),b.call(t,"data-ofi-src",t.src),t.srcset&&b.call(t,"data-ofi-srcset",t.srcset),i(t,t.naturalWidth||t.width,t.naturalHeight||t.height),t.srcset&&(t.srcset="");try{s(t)}catch(t){window.console&&console.warn("https://bit.ly/ofi-old-browser")}}e(o.img);(o.img.currentSrc||o.img.src)&&(t.style.backgroundImage='url("'+(o.img.currentSrc||o.img.src).replace(/"/g,'\\"')+'")'),t.style.backgroundImage='url("'+(o.img.currentSrc||o.img.src).replace(/"/g,'\\"')+'")',t.style.backgroundPosition=c["object-position"]||"center",t.style.backgroundRepeat="no-repeat",t.style.backgroundOrigin="content-box",/scale-down/.test(c["object-fit"])?n(o.img,function(){o.img.naturalWidth>t.width||o.img.naturalHeight>t.height?t.style.backgroundSize="contain":t.style.backgroundSize="auto"}):t.style.backgroundSize=c["object-fit"].replace("none","auto").replace("fill","100% 100%"),n(o.img,function(e){i(t,e.naturalWidth,e.naturalHeight)})}}function s(t){var e={get:function(e){return t[a].img[e||"src"]},set:function(e,r){return t[a].img[r||"src"]=e,b.call(t,"data-ofi-"+r,e),c(t),e}};Object.defineProperty(t,"src",e),Object.defineProperty(t,"currentSrc",{get:function(){return e.get("currentSrc")}}),Object.defineProperty(t,"srcset",{get:function(){return e.get("srcset")},set:function(t){return e.set(t,"srcset")}})}function o(t,e){var r=!h&&!t;if(e=e||{},t=t||"img",f&&!e.skipTest||!d)return!1;"img"===t?t=document.getElementsByTagName("img"):"string"==typeof t?t=document.querySelectorAll(t):"length"in t||(t=[t]);for(var i=0;i<t.length;i++)t[i][a]=t[i][a]||{skipTest:e.skipTest},c(t[i]);r&&(document.body.addEventListener("load",function(t){"IMG"===t.target.tagName&&o(t.target,{skipTest:e.skipTest})},!0),h=!0,t="img"),e.watchMQ&&window.addEventListener("resize",o.bind(null,t,{skipTest:e.skipTest}))}var a="bfred-it:object-fit-images",u=/(object-fit|object-position)\s*:\s*([-.\w\s%]+)/g,l="undefined"==typeof Image?{style:{"object-position":1}}:new Image,g="object-fit"in l.style,f="object-position"in l.style,d="background-size"in l.style,m="string"==typeof l.currentSrc,p=l.getAttribute,b=l.setAttribute,h=!1;return o.supportsObjectFit=g,o.supportsObjectPosition=f,function(){function t(t,e){return t[a]&&t[a].img&&("src"===e||"srcset"===e)?t[a].img:t}f||(HTMLImageElement.prototype.getAttribute=function(e){return p.call(t(this,e),e)},HTMLImageElement.prototype.setAttribute=function(e,r){return b.call(t(this,e),e,String(r))})}(),o}();

/*!
 * Packery layout mode PACKAGED v2.0.1
 * sub-classes Packery
 */

!function(a,b){"function"==typeof define&&define.amd?define("packery/js/rect",b):"object"==typeof module&&module.exports?module.exports=b():(a.Packery=a.Packery||{},a.Packery.Rect=b())}(window,function(){function a(b){for(var c in a.defaults)this[c]=a.defaults[c];for(c in b)this[c]=b[c]}a.defaults={x:0,y:0,width:0,height:0};var b=a.prototype;return b.contains=function(a){var b=a.width||0,c=a.height||0;return this.x<=a.x&&this.y<=a.y&&this.x+this.width>=a.x+b&&this.y+this.height>=a.y+c},b.overlaps=function(a){var b=this.x+this.width,c=this.y+this.height,d=a.x+a.width,e=a.y+a.height;return this.x<d&&b>a.x&&this.y<e&&c>a.y},b.getMaximalFreeRects=function(b){if(!this.overlaps(b))return!1;var c,d=[],e=this.x+this.width,f=this.y+this.height,g=b.x+b.width,h=b.y+b.height;return this.y<b.y&&(c=new a({x:this.x,y:this.y,width:this.width,height:b.y-this.y}),d.push(c)),e>g&&(c=new a({x:g,y:this.y,width:e-g,height:this.height}),d.push(c)),f>h&&(c=new a({x:this.x,y:h,width:this.width,height:f-h}),d.push(c)),this.x<b.x&&(c=new a({x:this.x,y:this.y,width:b.x-this.x,height:this.height}),d.push(c)),d},b.canFit=function(a){return this.width>=a.width&&this.height>=a.height},a}),function(a,b){if("function"==typeof define&&define.amd)define("packery/js/packer",["./rect"],b);else if("object"==typeof module&&module.exports)module.exports=b(require("./rect"));else{var c=a.Packery=a.Packery||{};c.Packer=b(c.Rect)}}(window,function(a){function b(a,b,c){this.width=a||0,this.height=b||0,this.sortDirection=c||"downwardLeftToRight",this.reset()}var c=b.prototype;c.reset=function(){this.spaces=[];var b=new a({x:0,y:0,width:this.width,height:this.height});this.spaces.push(b),this.sorter=d[this.sortDirection]||d.downwardLeftToRight},c.pack=function(a){for(var b=0;b<this.spaces.length;b++){var c=this.spaces[b];if(c.canFit(a)){this.placeInSpace(a,c);break}}},c.columnPack=function(a){for(var b=0;b<this.spaces.length;b++){var c=this.spaces[b],d=c.x<=a.x&&c.x+c.width>=a.x+a.width&&c.height>=a.height-.01;if(d){a.y=c.y,this.placed(a);break}}},c.rowPack=function(a){for(var b=0;b<this.spaces.length;b++){var c=this.spaces[b],d=c.y<=a.y&&c.y+c.height>=a.y+a.height&&c.width>=a.width-.01;if(d){a.x=c.x,this.placed(a);break}}},c.placeInSpace=function(a,b){a.x=b.x,a.y=b.y,this.placed(a)},c.placed=function(a){for(var b=[],c=0;c<this.spaces.length;c++){var d=this.spaces[c],e=d.getMaximalFreeRects(a);e?b.push.apply(b,e):b.push(d)}this.spaces=b,this.mergeSortSpaces()},c.mergeSortSpaces=function(){b.mergeRects(this.spaces),this.spaces.sort(this.sorter)},c.addSpace=function(a){this.spaces.push(a),this.mergeSortSpaces()},b.mergeRects=function(a){var b=0,c=a[b];a:for(;c;){for(var d=0,e=a[b+d];e;){if(e==c)d++;else{if(e.contains(c)){a.splice(b,1),c=a[b];continue a}c.contains(e)?a.splice(b+d,1):d++}e=a[b+d]}b++,c=a[b]}return a};var d={downwardLeftToRight:function(a,b){return a.y-b.y||a.x-b.x},rightwardTopToBottom:function(a,b){return a.x-b.x||a.y-b.y}};return b}),function(a,b){"function"==typeof define&&define.amd?define("packery/js/item",["outlayer/outlayer","./rect"],b):"object"==typeof module&&module.exports?module.exports=b(require("outlayer"),require("./rect")):a.Packery.Item=b(a.Outlayer,a.Packery.Rect)}(window,function(a,b){var c=document.documentElement.style,d="string"==typeof c.transform?"transform":"WebkitTransform",e=function(){a.Item.apply(this,arguments)},f=e.prototype=Object.create(a.Item.prototype),g=f._create;f._create=function(){g.call(this),this.rect=new b};var h=f.moveTo;return f.moveTo=function(a,b){var c=Math.abs(this.position.x-a),d=Math.abs(this.position.y-b),e=this.layout.dragItemCount&&!this.isPlacing&&!this.isTransitioning&&1>c&&1>d;return e?void this.goTo(a,b):void h.apply(this,arguments)},f.enablePlacing=function(){this.removeTransitionStyles(),this.isTransitioning&&d&&(this.element.style[d]="none"),this.isTransitioning=!1,this.getSize(),this.layout._setRectSize(this.element,this.rect),this.isPlacing=!0},f.disablePlacing=function(){this.isPlacing=!1},f.removeElem=function(){this.element.parentNode.removeChild(this.element),this.layout.packer.addSpace(this.rect),this.emitEvent("remove",[this])},f.showDropPlaceholder=function(){var a=this.dropPlaceholder;a||(a=this.dropPlaceholder=document.createElement("div"),a.className="packery-drop-placeholder",a.style.position="absolute"),a.style.width=this.size.width+"px",a.style.height=this.size.height+"px",this.positionDropPlaceholder(),this.layout.element.appendChild(a)},f.positionDropPlaceholder=function(){this.dropPlaceholder.style[d]="translate("+this.rect.x+"px, "+this.rect.y+"px)"},f.hideDropPlaceholder=function(){this.layout.element.removeChild(this.dropPlaceholder)},e}),function(a,b){"function"==typeof define&&define.amd?define("packery/js/packery",["get-size/get-size","outlayer/outlayer","./rect","./packer","./item"],b):"object"==typeof module&&module.exports?module.exports=b(require("get-size"),require("outlayer"),require("./rect"),require("./packer"),require("./item")):a.Packery=b(a.getSize,a.Outlayer,a.Packery.Rect,a.Packery.Packer,a.Packery.Item)}(window,function(a,b,c,d,e){function f(a,b){return a.position.y-b.position.y||a.position.x-b.position.x}function g(a,b){return a.position.x-b.position.x||a.position.y-b.position.y}function h(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+d*d)}c.prototype.canFit=function(a){return this.width>=a.width-1&&this.height>=a.height-1};var i=b.create("packery");i.Item=e;var j=i.prototype;j._create=function(){b.prototype._create.call(this),this.packer=new d,this.shiftPacker=new d,this.isEnabled=!0,this.dragItemCount=0;var a=this;this.handleDraggabilly={dragStart:function(){a.itemDragStart(this.element)},dragMove:function(){a.itemDragMove(this.element,this.position.x,this.position.y)},dragEnd:function(){a.itemDragEnd(this.element)}},this.handleUIDraggable={start:function(b,c){c&&a.itemDragStart(b.currentTarget)},drag:function(b,c){c&&a.itemDragMove(b.currentTarget,c.position.left,c.position.top)},stop:function(b,c){c&&a.itemDragEnd(b.currentTarget)}}},j._resetLayout=function(){this.getSize(),this._getMeasurements();var a,b,c;this._getOption("horizontal")?(a=1/0,b=this.size.innerHeight+this.gutter,c="rightwardTopToBottom"):(a=this.size.innerWidth+this.gutter,b=1/0,c="downwardLeftToRight"),this.packer.width=this.shiftPacker.width=a,this.packer.height=this.shiftPacker.height=b,this.packer.sortDirection=this.shiftPacker.sortDirection=c,this.packer.reset(),this.maxY=0,this.maxX=0},j._getMeasurements=function(){this._getMeasurement("columnWidth","width"),this._getMeasurement("rowHeight","height"),this._getMeasurement("gutter","width")},j._getItemLayoutPosition=function(a){if(this._setRectSize(a.element,a.rect),this.isShifting||this.dragItemCount>0){var b=this._getPackMethod();this.packer[b](a.rect)}else this.packer.pack(a.rect);return this._setMaxXY(a.rect),a.rect},j.shiftLayout=function(){this.isShifting=!0,this.layout(),delete this.isShifting},j._getPackMethod=function(){return this._getOption("horizontal")?"rowPack":"columnPack"},j._setMaxXY=function(a){this.maxX=Math.max(a.x+a.width,this.maxX),this.maxY=Math.max(a.y+a.height,this.maxY)},j._setRectSize=function(b,c){var d=a(b),e=d.outerWidth,f=d.outerHeight;(e||f)&&(e=this._applyGridGutter(e,this.columnWidth),f=this._applyGridGutter(f,this.rowHeight)),c.width=Math.min(e,this.packer.width),c.height=Math.min(f,this.packer.height)},j._applyGridGutter=function(a,b){if(!b)return a+this.gutter;b+=this.gutter;var c=a%b,d=c&&1>c?"round":"ceil";return a=Math[d](a/b)*b},j._getContainerSize=function(){return this._getOption("horizontal")?{width:this.maxX-this.gutter}:{height:this.maxY-this.gutter}},j._manageStamp=function(a){var b,d=this.getItem(a);if(d&&d.isPlacing)b=d.rect;else{var e=this._getElementOffset(a);b=new c({x:this._getOption("originLeft")?e.left:e.right,y:this._getOption("originTop")?e.top:e.bottom})}this._setRectSize(a,b),this.packer.placed(b),this._setMaxXY(b)},j.sortItemsByPosition=function(){var a=this._getOption("horizontal")?g:f;this.items.sort(a)},j.fit=function(a,b,c){var d=this.getItem(a);d&&(this.stamp(d.element),d.enablePlacing(),this.updateShiftTargets(d),b=void 0===b?d.rect.x:b,c=void 0===c?d.rect.y:c,this.shift(d,b,c),this._bindFitEvents(d),d.moveTo(d.rect.x,d.rect.y),this.shiftLayout(),this.unstamp(d.element),this.sortItemsByPosition(),d.disablePlacing())},j._bindFitEvents=function(a){function b(){d++,2==d&&c.dispatchEvent("fitComplete",null,[a])}var c=this,d=0;a.once("layout",b),this.once("layoutComplete",b)},j.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&(this.options.shiftPercentResize?this.resizeShiftPercentLayout():this.layout())},j.needsResizeLayout=function(){var b=a(this.element),c=this._getOption("horizontal")?"innerHeight":"innerWidth";return b[c]!=this.size[c]},j.resizeShiftPercentLayout=function(){var b=this._getItemsForLayout(this.items),c=this._getOption("horizontal"),d=c?"y":"x",e=c?"height":"width",f=c?"rowHeight":"columnWidth",g=c?"innerHeight":"innerWidth",h=this[f];if(h=h&&h+this.gutter){this._getMeasurements();var i=this[f]+this.gutter;b.forEach(function(a){var b=Math.round(a.rect[d]/h);a.rect[d]=b*i})}else{var j=a(this.element)[g]+this.gutter,k=this.packer[e];b.forEach(function(a){a.rect[d]=a.rect[d]/k*j})}this.shiftLayout()},j.itemDragStart=function(a){if(this.isEnabled){this.stamp(a);var b=this.getItem(a);b&&(b.enablePlacing(),b.showDropPlaceholder(),this.dragItemCount++,this.updateShiftTargets(b))}},j.updateShiftTargets=function(a){this.shiftPacker.reset(),this._getBoundingRect();var b=this._getOption("originLeft"),d=this._getOption("originTop");this.stamps.forEach(function(a){var e=this.getItem(a);if(!e||!e.isPlacing){var f=this._getElementOffset(a),g=new c({x:b?f.left:f.right,y:d?f.top:f.bottom});this._setRectSize(a,g),this.shiftPacker.placed(g)}},this);var e=this._getOption("horizontal"),f=e?"rowHeight":"columnWidth",g=e?"height":"width";this.shiftTargetKeys=[],this.shiftTargets=[];var h,i=this[f];if(i=i&&i+this.gutter){var j=Math.ceil(a.rect[g]/i),k=Math.floor((this.shiftPacker[g]+this.gutter)/i);h=(k-j)*i;for(var l=0;k>l;l++)this._addShiftTarget(l*i,0,h)}else h=this.shiftPacker[g]+this.gutter-a.rect[g],this._addShiftTarget(0,0,h);var m=this._getItemsForLayout(this.items),n=this._getPackMethod();m.forEach(function(a){var b=a.rect;this._setRectSize(a.element,b),this.shiftPacker[n](b),this._addShiftTarget(b.x,b.y,h);var c=e?b.x+b.width:b.x,d=e?b.y:b.y+b.height;if(this._addShiftTarget(c,d,h),i)for(var f=Math.round(b[g]/i),j=1;f>j;j++){var k=e?c:b.x+i*j,l=e?b.y+i*j:d;this._addShiftTarget(k,l,h)}},this)},j._addShiftTarget=function(a,b,c){var d=this._getOption("horizontal")?b:a;if(!(0!==d&&d>c)){var e=a+","+b,f=-1!=this.shiftTargetKeys.indexOf(e);f||(this.shiftTargetKeys.push(e),this.shiftTargets.push({x:a,y:b}))}},j.shift=function(a,b,c){var d,e=1/0,f={x:b,y:c};this.shiftTargets.forEach(function(a){var b=h(a,f);e>b&&(d=a,e=b)}),a.rect.x=d.x,a.rect.y=d.y};var k=120;j.itemDragMove=function(a,b,c){function d(){f.shift(e,b,c),e.positionDropPlaceholder(),f.layout()}var e=this.isEnabled&&this.getItem(a);if(e){b-=this.size.paddingLeft,c-=this.size.paddingTop;var f=this,g=new Date;this._itemDragTime&&g-this._itemDragTime<k?(clearTimeout(this.dragTimeout),this.dragTimeout=setTimeout(d,k)):(d(),this._itemDragTime=g)}},j.itemDragEnd=function(a){function b(){d++,2==d&&(c.element.classList.remove("is-positioning-post-drag"),c.hideDropPlaceholder(),e.dispatchEvent("dragItemPositioned",null,[c]))}var c=this.isEnabled&&this.getItem(a);if(c){clearTimeout(this.dragTimeout),c.element.classList.add("is-positioning-post-drag");var d=0,e=this;c.once("layout",b),this.once("layoutComplete",b),c.moveTo(c.rect.x,c.rect.y),this.layout(),this.dragItemCount=Math.max(0,this.dragItemCount-1),this.sortItemsByPosition(),c.disablePlacing(),this.unstamp(c.element)}},j.bindDraggabillyEvents=function(a){this._bindDraggabillyEvents(a,"on")},j.unbindDraggabillyEvents=function(a){this._bindDraggabillyEvents(a,"off")},j._bindDraggabillyEvents=function(a,b){var c=this.handleDraggabilly;a[b]("dragStart",c.dragStart),a[b]("dragMove",c.dragMove),a[b]("dragEnd",c.dragEnd)},j.bindUIDraggableEvents=function(a){this._bindUIDraggableEvents(a,"on")},j.unbindUIDraggableEvents=function(a){this._bindUIDraggableEvents(a,"off")},j._bindUIDraggableEvents=function(a,b){var c=this.handleUIDraggable;a[b]("dragstart",c.start)[b]("drag",c.drag)[b]("dragstop",c.stop)};var l=j.destroy;return j.destroy=function(){l.apply(this,arguments),this.isEnabled=!1},i.Rect=c,i.Packer=d,i}),function(a,b){"function"==typeof define&&define.amd?define(["isotope-layout/js/layout-mode","packery/js/packery"],b):"object"==typeof module&&module.exports?module.exports=b(require("isotope-layout/js/layout-mode"),require("packery")):b(a.Isotope.LayoutMode,a.Packery)}(window,function(a,b){var c=a.create("packery"),d=c.prototype,e={_getElementOffset:!0,_getMeasurement:!0};for(var f in b.prototype)e[f]||(d[f]=b.prototype[f]);var g=d._resetLayout;d._resetLayout=function(){this.packer=this.packer||new b.Packer,this.shiftPacker=this.shiftPacker||new b.Packer,g.apply(this,arguments)};var h=d._getItemLayoutPosition;d._getItemLayoutPosition=function(a){return a.rect=a.rect||new b.Rect,h.call(this,a)};var i=d.needsResizeLayout;d.needsResizeLayout=function(){return this._getOption("horizontal")?this.needsVerticalResizeLayout():i.call(this)};var j=d._getOption;return d._getOption=function(a){return"horizontal"==a?void 0!==this.options.isHorizontal?this.options.isHorizontal:this.options.horizontal:j.apply(this.isotope,arguments)},c});

/*! picturefill - v3.0.2 - 2016-02-12
 * https://scottjehl.github.io/picturefill/
 * Copyright (c) 2016 https://github.com/scottjehl/picturefill/blob/master/Authors.txt; Licensed MIT
 */
!function(a){var b=navigator.userAgent;a.HTMLPictureElement&&/ecko/.test(b)&&b.match(/rv\:(\d+)/)&&RegExp.$1<45&&addEventListener("resize",function(){var b,c=document.createElement("source"),d=function(a){var b,d,e=a.parentNode;"PICTURE"===e.nodeName.toUpperCase()?(b=c.cloneNode(),e.insertBefore(b,e.firstElementChild),setTimeout(function(){e.removeChild(b)})):(!a._pfLastSize||a.offsetWidth>a._pfLastSize)&&(a._pfLastSize=a.offsetWidth,d=a.sizes,a.sizes+=",100vw",setTimeout(function(){a.sizes=d}))},e=function(){var a,b=document.querySelectorAll("picture > img, img[srcset][sizes]");for(a=0;a<b.length;a++)d(b[a])},f=function(){clearTimeout(b),b=setTimeout(e,99)},g=a.matchMedia&&matchMedia("(orientation: landscape)"),h=function(){f(),g&&g.addListener&&g.addListener(f)};return c.srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",/^[c|i]|d$/.test(document.readyState||"")?h():document.addEventListener("DOMContentLoaded",h),f}())}(window),function(a,b,c){"use strict";function d(a){return" "===a||"	"===a||"\n"===a||"\f"===a||"\r"===a}function e(b,c){var d=new a.Image;return d.onerror=function(){A[b]=!1,ba()},d.onload=function(){A[b]=1===d.width,ba()},d.src=c,"pending"}function f(){M=!1,P=a.devicePixelRatio,N={},O={},s.DPR=P||1,Q.width=Math.max(a.innerWidth||0,z.clientWidth),Q.height=Math.max(a.innerHeight||0,z.clientHeight),Q.vw=Q.width/100,Q.vh=Q.height/100,r=[Q.height,Q.width,P].join("-"),Q.em=s.getEmValue(),Q.rem=Q.em}function g(a,b,c,d){var e,f,g,h;return"saveData"===B.algorithm?a>2.7?h=c+1:(f=b-c,e=Math.pow(a-.6,1.5),g=f*e,d&&(g+=.1*e),h=a+g):h=c>1?Math.sqrt(a*b):a,h>c}function h(a){var b,c=s.getSet(a),d=!1;"pending"!==c&&(d=r,c&&(b=s.setRes(c),s.applySetCandidate(b,a))),a[s.ns].evaled=d}function i(a,b){return a.res-b.res}function j(a,b,c){var d;return!c&&b&&(c=a[s.ns].sets,c=c&&c[c.length-1]),d=k(b,c),d&&(b=s.makeUrl(b),a[s.ns].curSrc=b,a[s.ns].curCan=d,d.res||aa(d,d.set.sizes)),d}function k(a,b){var c,d,e;if(a&&b)for(e=s.parseSet(b),a=s.makeUrl(a),c=0;c<e.length;c++)if(a===s.makeUrl(e[c].url)){d=e[c];break}return d}function l(a,b){var c,d,e,f,g=a.getElementsByTagName("source");for(c=0,d=g.length;d>c;c++)e=g[c],e[s.ns]=!0,f=e.getAttribute("srcset"),f&&b.push({srcset:f,media:e.getAttribute("media"),type:e.getAttribute("type"),sizes:e.getAttribute("sizes")})}function m(a,b){function c(b){var c,d=b.exec(a.substring(m));return d?(c=d[0],m+=c.length,c):void 0}function e(){var a,c,d,e,f,i,j,k,l,m=!1,o={};for(e=0;e<h.length;e++)f=h[e],i=f[f.length-1],j=f.substring(0,f.length-1),k=parseInt(j,10),l=parseFloat(j),X.test(j)&&"w"===i?((a||c)&&(m=!0),0===k?m=!0:a=k):Y.test(j)&&"x"===i?((a||c||d)&&(m=!0),0>l?m=!0:c=l):X.test(j)&&"h"===i?((d||c)&&(m=!0),0===k?m=!0:d=k):m=!0;m||(o.url=g,a&&(o.w=a),c&&(o.d=c),d&&(o.h=d),d||c||a||(o.d=1),1===o.d&&(b.has1x=!0),o.set=b,n.push(o))}function f(){for(c(T),i="",j="in descriptor";;){if(k=a.charAt(m),"in descriptor"===j)if(d(k))i&&(h.push(i),i="",j="after descriptor");else{if(","===k)return m+=1,i&&h.push(i),void e();if("("===k)i+=k,j="in parens";else{if(""===k)return i&&h.push(i),void e();i+=k}}else if("in parens"===j)if(")"===k)i+=k,j="in descriptor";else{if(""===k)return h.push(i),void e();i+=k}else if("after descriptor"===j)if(d(k));else{if(""===k)return void e();j="in descriptor",m-=1}m+=1}}for(var g,h,i,j,k,l=a.length,m=0,n=[];;){if(c(U),m>=l)return n;g=c(V),h=[],","===g.slice(-1)?(g=g.replace(W,""),e()):f()}}function n(a){function b(a){function b(){f&&(g.push(f),f="")}function c(){g[0]&&(h.push(g),g=[])}for(var e,f="",g=[],h=[],i=0,j=0,k=!1;;){if(e=a.charAt(j),""===e)return b(),c(),h;if(k){if("*"===e&&"/"===a[j+1]){k=!1,j+=2,b();continue}j+=1}else{if(d(e)){if(a.charAt(j-1)&&d(a.charAt(j-1))||!f){j+=1;continue}if(0===i){b(),j+=1;continue}e=" "}else if("("===e)i+=1;else if(")"===e)i-=1;else{if(","===e){b(),c(),j+=1;continue}if("/"===e&&"*"===a.charAt(j+1)){k=!0,j+=2;continue}}f+=e,j+=1}}}function c(a){return k.test(a)&&parseFloat(a)>=0?!0:l.test(a)?!0:"0"===a||"-0"===a||"+0"===a?!0:!1}var e,f,g,h,i,j,k=/^(?:[+-]?[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?(?:ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmin|vmax|vw)$/i,l=/^calc\((?:[0-9a-z \.\+\-\*\/\(\)]+)\)$/i;for(f=b(a),g=f.length,e=0;g>e;e++)if(h=f[e],i=h[h.length-1],c(i)){if(j=i,h.pop(),0===h.length)return j;if(h=h.join(" "),s.matchesMedia(h))return j}return"100vw"}b.createElement("picture");var o,p,q,r,s={},t=!1,u=function(){},v=b.createElement("img"),w=v.getAttribute,x=v.setAttribute,y=v.removeAttribute,z=b.documentElement,A={},B={algorithm:""},C="data-pfsrc",D=C+"set",E=navigator.userAgent,F=/rident/.test(E)||/ecko/.test(E)&&E.match(/rv\:(\d+)/)&&RegExp.$1>35,G="currentSrc",H=/\s+\+?\d+(e\d+)?w/,I=/(\([^)]+\))?\s*(.+)/,J=a.picturefillCFG,K="position:absolute;left:0;visibility:hidden;display:block;padding:0;border:none;font-size:1em;width:1em;overflow:hidden;clip:rect(0px, 0px, 0px, 0px)",L="font-size:100%!important;",M=!0,N={},O={},P=a.devicePixelRatio,Q={px:1,"in":96},R=b.createElement("a"),S=!1,T=/^[ \t\n\r\u000c]+/,U=/^[, \t\n\r\u000c]+/,V=/^[^ \t\n\r\u000c]+/,W=/[,]+$/,X=/^\d+$/,Y=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,Z=function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d||!1):a.attachEvent&&a.attachEvent("on"+b,c)},$=function(a){var b={};return function(c){return c in b||(b[c]=a(c)),b[c]}},_=function(){var a=/^([\d\.]+)(em|vw|px)$/,b=function(){for(var a=arguments,b=0,c=a[0];++b in a;)c=c.replace(a[b],a[++b]);return c},c=$(function(a){return"return "+b((a||"").toLowerCase(),/\band\b/g,"&&",/,/g,"||",/min-([a-z-\s]+):/g,"e.$1>=",/max-([a-z-\s]+):/g,"e.$1<=",/calc([^)]+)/g,"($1)",/(\d+[\.]*[\d]*)([a-z]+)/g,"($1 * e.$2)",/^(?!(e.[a-z]|[0-9\.&=|><\+\-\*\(\)\/])).*/gi,"")+";"});return function(b,d){var e;if(!(b in N))if(N[b]=!1,d&&(e=b.match(a)))N[b]=e[1]*Q[e[2]];else try{N[b]=new Function("e",c(b))(Q)}catch(f){}return N[b]}}(),aa=function(a,b){return a.w?(a.cWidth=s.calcListLength(b||"100vw"),a.res=a.w/a.cWidth):a.res=a.d,a},ba=function(a){if(t){var c,d,e,f=a||{};if(f.elements&&1===f.elements.nodeType&&("IMG"===f.elements.nodeName.toUpperCase()?f.elements=[f.elements]:(f.context=f.elements,f.elements=null)),c=f.elements||s.qsa(f.context||b,f.reevaluate||f.reselect?s.sel:s.selShort),e=c.length){for(s.setupRun(f),S=!0,d=0;e>d;d++)s.fillImg(c[d],f);s.teardownRun(f)}}};o=a.console&&console.warn?function(a){console.warn(a)}:u,G in v||(G="src"),A["image/jpeg"]=!0,A["image/gif"]=!0,A["image/png"]=!0,A["image/svg+xml"]=b.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1"),s.ns=("pf"+(new Date).getTime()).substr(0,9),s.supSrcset="srcset"in v,s.supSizes="sizes"in v,s.supPicture=!!a.HTMLPictureElement,s.supSrcset&&s.supPicture&&!s.supSizes&&!function(a){v.srcset="data:,a",a.src="data:,a",s.supSrcset=v.complete===a.complete,s.supPicture=s.supSrcset&&s.supPicture}(b.createElement("img")),s.supSrcset&&!s.supSizes?!function(){var a="data:image/gif;base64,R0lGODlhAgABAPAAAP///wAAACH5BAAAAAAALAAAAAACAAEAAAICBAoAOw==",c="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",d=b.createElement("img"),e=function(){var a=d.width;2===a&&(s.supSizes=!0),q=s.supSrcset&&!s.supSizes,t=!0,setTimeout(ba)};d.onload=e,d.onerror=e,d.setAttribute("sizes","9px"),d.srcset=c+" 1w,"+a+" 9w",d.src=c}():t=!0,s.selShort="picture>img,img[srcset]",s.sel=s.selShort,s.cfg=B,s.DPR=P||1,s.u=Q,s.types=A,s.setSize=u,s.makeUrl=$(function(a){return R.href=a,R.href}),s.qsa=function(a,b){return"querySelector"in a?a.querySelectorAll(b):[]},s.matchesMedia=function(){return a.matchMedia&&(matchMedia("(min-width: 0.1em)")||{}).matches?s.matchesMedia=function(a){return!a||matchMedia(a).matches}:s.matchesMedia=s.mMQ,s.matchesMedia.apply(this,arguments)},s.mMQ=function(a){return a?_(a):!0},s.calcLength=function(a){var b=_(a,!0)||!1;return 0>b&&(b=!1),b},s.supportsType=function(a){return a?A[a]:!0},s.parseSize=$(function(a){var b=(a||"").match(I);return{media:b&&b[1],length:b&&b[2]}}),s.parseSet=function(a){return a.cands||(a.cands=m(a.srcset,a)),a.cands},s.getEmValue=function(){var a;if(!p&&(a=b.body)){var c=b.createElement("div"),d=z.style.cssText,e=a.style.cssText;c.style.cssText=K,z.style.cssText=L,a.style.cssText=L,a.appendChild(c),p=c.offsetWidth,a.removeChild(c),p=parseFloat(p,10),z.style.cssText=d,a.style.cssText=e}return p||16},s.calcListLength=function(a){if(!(a in O)||B.uT){var b=s.calcLength(n(a));O[a]=b?b:Q.width}return O[a]},s.setRes=function(a){var b;if(a){b=s.parseSet(a);for(var c=0,d=b.length;d>c;c++)aa(b[c],a.sizes)}return b},s.setRes.res=aa,s.applySetCandidate=function(a,b){if(a.length){var c,d,e,f,h,k,l,m,n,o=b[s.ns],p=s.DPR;if(k=o.curSrc||b[G],l=o.curCan||j(b,k,a[0].set),l&&l.set===a[0].set&&(n=F&&!b.complete&&l.res-.1>p,n||(l.cached=!0,l.res>=p&&(h=l))),!h)for(a.sort(i),f=a.length,h=a[f-1],d=0;f>d;d++)if(c=a[d],c.res>=p){e=d-1,h=a[e]&&(n||k!==s.makeUrl(c.url))&&g(a[e].res,c.res,p,a[e].cached)?a[e]:c;break}h&&(m=s.makeUrl(h.url),o.curSrc=m,o.curCan=h,m!==k&&s.setSrc(b,h),s.setSize(b))}},s.setSrc=function(a,b){var c;a.src=b.url,"image/svg+xml"===b.set.type&&(c=a.style.width,a.style.width=a.offsetWidth+1+"px",a.offsetWidth+1&&(a.style.width=c))},s.getSet=function(a){var b,c,d,e=!1,f=a[s.ns].sets;for(b=0;b<f.length&&!e;b++)if(c=f[b],c.srcset&&s.matchesMedia(c.media)&&(d=s.supportsType(c.type))){"pending"===d&&(c=d),e=c;break}return e},s.parseSets=function(a,b,d){var e,f,g,h,i=b&&"PICTURE"===b.nodeName.toUpperCase(),j=a[s.ns];(j.src===c||d.src)&&(j.src=w.call(a,"src"),j.src?x.call(a,C,j.src):y.call(a,C)),(j.srcset===c||d.srcset||!s.supSrcset||a.srcset)&&(e=w.call(a,"srcset"),j.srcset=e,h=!0),j.sets=[],i&&(j.pic=!0,l(b,j.sets)),j.srcset?(f={srcset:j.srcset,sizes:w.call(a,"sizes")},j.sets.push(f),g=(q||j.src)&&H.test(j.srcset||""),g||!j.src||k(j.src,f)||f.has1x||(f.srcset+=", "+j.src,f.cands.push({url:j.src,d:1,set:f}))):j.src&&j.sets.push({srcset:j.src,sizes:null}),j.curCan=null,j.curSrc=c,j.supported=!(i||f&&!s.supSrcset||g&&!s.supSizes),h&&s.supSrcset&&!j.supported&&(e?(x.call(a,D,e),a.srcset=""):y.call(a,D)),j.supported&&!j.srcset&&(!j.src&&a.src||a.src!==s.makeUrl(j.src))&&(null===j.src?a.removeAttribute("src"):a.src=j.src),j.parsed=!0},s.fillImg=function(a,b){var c,d=b.reselect||b.reevaluate;a[s.ns]||(a[s.ns]={}),c=a[s.ns],(d||c.evaled!==r)&&((!c.parsed||b.reevaluate)&&s.parseSets(a,a.parentNode,b),c.supported?c.evaled=r:h(a))},s.setupRun=function(){(!S||M||P!==a.devicePixelRatio)&&f()},s.supPicture?(ba=u,s.fillImg=u):!function(){var c,d=a.attachEvent?/d$|^c/:/d$|^c|^i/,e=function(){var a=b.readyState||"";f=setTimeout(e,"loading"===a?200:999),b.body&&(s.fillImgs(),c=c||d.test(a),c&&clearTimeout(f))},f=setTimeout(e,b.body?9:99),g=function(a,b){var c,d,e=function(){var f=new Date-d;b>f?c=setTimeout(e,b-f):(c=null,a())};return function(){d=new Date,c||(c=setTimeout(e,b))}},h=z.clientHeight,i=function(){M=Math.max(a.innerWidth||0,z.clientWidth)!==Q.width||z.clientHeight!==h,h=z.clientHeight,M&&s.fillImgs()};Z(a,"resize",g(i,99)),Z(b,"readystatechange",e)}(),s.picturefill=ba,s.fillImgs=ba,s.teardownRun=u,ba._=s,a.picturefillCFG={pf:s,push:function(a){var b=a.shift();"function"==typeof s[b]?s[b].apply(s,a):(B[b]=a[0],S&&s.fillImgs({reselect:!0}))}};for(;J&&J.length;)a.picturefillCFG.push(J.shift());a.picturefill=ba,"object"==typeof module&&"object"==typeof module.exports?module.exports=ba:"function"==typeof define&&define.amd&&define("picturefill",function(){return ba}),s.supPicture||(A["image/webp"]=e("image/webp","data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA=="))}(window,document);

/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */

(function (root, factory)
{
    'use strict';

    var moment;
    if (typeof exports === 'object') {
        // CommonJS module
        // Load moment.js as an optional dependency
        try { moment = require('moment'); } catch (e) {}
        module.exports = factory(moment);
    } else if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(function (req)
        {
            // Load moment.js as an optional dependency
            var id = 'moment';
            try { moment = req(id); } catch (e) {}
            return factory(moment);
        });
    } else {
        root.Pikaday = factory(root.moment);
    }
}(this, function (moment)
{
    'use strict';

    /**
     * feature detection and helper functions
     */
    var hasMoment = typeof moment === 'function',

    hasEventListeners = !!window.addEventListener,

    document = window.document,

    sto = window.setTimeout,

    addEvent = function(el, e, callback, capture)
    {
        if (hasEventListeners) {
            el.addEventListener(e, callback, !!capture);
        } else {
            el.attachEvent('on' + e, callback);
        }
    },

    removeEvent = function(el, e, callback, capture)
    {
        if (hasEventListeners) {
            el.removeEventListener(e, callback, !!capture);
        } else {
            el.detachEvent('on' + e, callback);
        }
    },

    trim = function(str)
    {
        return str.trim ? str.trim() : str.replace(/^\s+|\s+$/g,'');
    },

    hasClass = function(el, cn)
    {
        return (' ' + el.className + ' ').indexOf(' ' + cn + ' ') !== -1;
    },

    addClass = function(el, cn)
    {
        if (!hasClass(el, cn)) {
            el.className = (el.className === '') ? cn : el.className + ' ' + cn;
        }
    },

    removeClass = function(el, cn)
    {
        el.className = trim((' ' + el.className + ' ').replace(' ' + cn + ' ', ' '));
    },

    isArray = function(obj)
    {
        return (/Array/).test(Object.prototype.toString.call(obj));
    },

    isDate = function(obj)
    {
        return (/Date/).test(Object.prototype.toString.call(obj)) && !isNaN(obj.getTime());
    },

    isWeekend = function(date)
    {
        var day = date.getDay();
        return day === 0 || day === 6;
    },

    isLeapYear = function(year)
    {
        // solution by Matti Virkkunen: http://stackoverflow.com/a/4881951
        return year % 4 === 0 && year % 100 !== 0 || year % 400 === 0;
    },

    getDaysInMonth = function(year, month)
    {
        return [31, isLeapYear(year) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];
    },

    setToStartOfDay = function(date)
    {
        if (isDate(date)) date.setHours(0,0,0,0);
    },

    compareDates = function(a,b)
    {
        // weak date comparison (use setToStartOfDay(date) to ensure correct result)
        return a.getTime() === b.getTime();
    },

    extend = function(to, from, overwrite)
    {
        var prop, hasProp;
        for (prop in from) {
            hasProp = to[prop] !== undefined;
            if (hasProp && typeof from[prop] === 'object' && from[prop] !== null && from[prop].nodeName === undefined) {
                if (isDate(from[prop])) {
                    if (overwrite) {
                        to[prop] = new Date(from[prop].getTime());
                    }
                }
                else if (isArray(from[prop])) {
                    if (overwrite) {
                        to[prop] = from[prop].slice(0);
                    }
                } else {
                    to[prop] = extend({}, from[prop], overwrite);
                }
            } else if (overwrite || !hasProp) {
                to[prop] = from[prop];
            }
        }
        return to;
    },

    fireEvent = function(el, eventName, data)
    {
        var ev;

        if (document.createEvent) {
            ev = document.createEvent('HTMLEvents');
            ev.initEvent(eventName, true, false);
            ev = extend(ev, data);
            el.dispatchEvent(ev);
        } else if (document.createEventObject) {
            ev = document.createEventObject();
            ev = extend(ev, data);
            el.fireEvent('on' + eventName, ev);
        }
    },

    adjustCalendar = function(calendar) {
        if (calendar.month < 0) {
            calendar.year -= Math.ceil(Math.abs(calendar.month)/12);
            calendar.month += 12;
        }
        if (calendar.month > 11) {
            calendar.year += Math.floor(Math.abs(calendar.month)/12);
            calendar.month -= 12;
        }
        return calendar;
    },

    /**
     * defaults and localisation
     */
    defaults = {

        // bind the picker to a form field
        field: null,

        // automatically show/hide the picker on `field` focus (default `true` if `field` is set)
        bound: undefined,

        // position of the datepicker, relative to the field (default to bottom & left)
        // ('bottom' & 'left' keywords are not used, 'top' & 'right' are modifier on the bottom/left position)
        position: 'bottom left',

        // automatically fit in the viewport even if it means repositioning from the position option
        reposition: true,

        // the default output format for `.toString()` and `field` value
        format: 'YYYY-MM-DD',

        // the toString function which gets passed a current date object and format
        // and returns a string
        toString: null,

        // used to create date object from current input string
        parse: null,

        // the initial date to view when first opened
        defaultDate: null,

        // make the `defaultDate` the initial selected value
        setDefaultDate: false,

        // first day of week (0: Sunday, 1: Monday etc)
        firstDay: 0,

        // the default flag for moment's strict date parsing
        formatStrict: false,

        // the minimum/earliest date that can be selected
        minDate: null,
        // the maximum/latest date that can be selected
        maxDate: null,

        // number of years either side, or array of upper/lower range
        yearRange: 10,

        // show week numbers at head of row
        showWeekNumber: false,

        // Week picker mode
        pickWholeWeek: false,

        // used internally (don't config outside)
        minYear: 0,
        maxYear: 9999,
        minMonth: undefined,
        maxMonth: undefined,

        startRange: null,
        endRange: null,

        isRTL: false,

        // Additional text to append to the year in the calendar title
        yearSuffix: '',

        // Render the month after year in the calendar title
        showMonthAfterYear: false,

        // Render days of the calendar grid that fall in the next or previous month
        showDaysInNextAndPreviousMonths: false,

        // how many months are visible
        numberOfMonths: 1,

        // when numberOfMonths is used, this will help you to choose where the main calendar will be (default `left`, can be set to `right`)
        // only used for the first display or when a selected date is not visible
        mainCalendar: 'left',

        // Specify a DOM element to render the calendar in
        container: undefined,

        // Blur field when date is selected
        blurFieldOnSelect : true,

        // internationalization
        i18n: {
            previousMonth : 'Previous Month',
            nextMonth     : 'Next Month',
            months        : ['January','February','March','April','May','June','July','August','September','October','November','December'],
            weekdays      : ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],
            weekdaysShort : ['Sun','Mon','Tue','Wed','Thu','Fri','Sat']
        },

        // Theme Classname
        theme: null,

        // events array
        events: [],

        // callback function
        onSelect: null,
        onOpen: null,
        onClose: null,
        onDraw: null
    },


    /**
     * templating functions to abstract HTML rendering
     */
    renderDayName = function(opts, day, abbr)
    {
        day += opts.firstDay;
        while (day >= 7) {
            day -= 7;
        }
        return abbr ? opts.i18n.weekdaysShort[day] : opts.i18n.weekdays[day];
    },

    renderDay = function(opts)
    {
        var arr = [];
        var ariaSelected = 'false';
        if (opts.isEmpty) {
            if (opts.showDaysInNextAndPreviousMonths) {
                arr.push('is-outside-current-month');
            } else {
                return '<td class="is-empty"></td>';
            }
        }
        if (opts.isDisabled) {
            arr.push('is-disabled');
        }
        if (opts.isToday) {
            arr.push('is-today');
        }
        if (opts.isSelected) {
            arr.push('is-selected');
            ariaSelected = 'true';
        }
        if (opts.hasEvent) {
            arr.push('has-event');
        }
        if (opts.isInRange) {
            arr.push('is-inrange');
        }
        if (opts.isStartRange) {
            arr.push('is-startrange');
        }
        if (opts.isEndRange) {
            arr.push('is-endrange');
        }
        return '<td data-day="' + opts.day + '" class="' + arr.join(' ') + '" aria-selected="' + ariaSelected + '">' +
                 '<button class="pika-button pika-day" type="button" ' +
                    'data-pika-year="' + opts.year + '" data-pika-month="' + opts.month + '" data-pika-day="' + opts.day + '">' +
                        opts.day +
                 '</button>' +
               '</td>';
    },

    renderWeek = function (d, m, y) {
        // Lifted from http://javascript.about.com/library/blweekyear.htm, lightly modified.
        var onejan = new Date(y, 0, 1),
            weekNum = Math.ceil((((new Date(y, m, d) - onejan) / 86400000) + onejan.getDay()+1)/7);
        return '<td class="pika-week">' + weekNum + '</td>';
    },

    renderRow = function(days, isRTL, pickWholeWeek, isRowSelected)
    {
        return '<tr class="pika-row' + (pickWholeWeek ? ' pick-whole-week' : '') + (isRowSelected ? ' is-selected' : '') + '">' + (isRTL ? days.reverse() : days).join('') + '</tr>';
    },

    renderBody = function(rows)
    {
        return '<tbody>' + rows.join('') + '</tbody>';
    },

    renderHead = function(opts)
    {
        var i, arr = [];
        if (opts.showWeekNumber) {
            arr.push('<th></th>');
        }
        for (i = 0; i < 7; i++) {
            arr.push('<th scope="col"><abbr title="' + renderDayName(opts, i) + '">' + renderDayName(opts, i, true) + '</abbr></th>');
        }
        return '<thead><tr>' + (opts.isRTL ? arr.reverse() : arr).join('') + '</tr></thead>';
    },

    renderTitle = function(instance, c, year, month, refYear, randId)
    {
        var i, j, arr,
            opts = instance._o,
            isMinYear = year === opts.minYear,
            isMaxYear = year === opts.maxYear,
            html = '<div id="' + randId + '" class="pika-title" role="heading" aria-live="assertive">',
            monthHtml,
            yearHtml,
            prev = true,
            next = true;

        for (arr = [], i = 0; i < 12; i++) {
            arr.push('<option value="' + (year === refYear ? i - c : 12 + i - c) + '"' +
                (i === month ? ' selected="selected"': '') +
                ((isMinYear && i < opts.minMonth) || (isMaxYear && i > opts.maxMonth) ? 'disabled="disabled"' : '') + '>' +
                opts.i18n.months[i] + '</option>');
        }

        monthHtml = '<div class="pika-label">' + opts.i18n.months[month] + '<select class="pika-select pika-select-month" tabindex="-1">' + arr.join('') + '</select></div>';

        if (isArray(opts.yearRange)) {
            i = opts.yearRange[0];
            j = opts.yearRange[1] + 1;
        } else {
            i = year - opts.yearRange;
            j = 1 + year + opts.yearRange;
        }

        for (arr = []; i < j && i <= opts.maxYear; i++) {
            if (i >= opts.minYear) {
                arr.push('<option value="' + i + '"' + (i === year ? ' selected="selected"': '') + '>' + (i) + '</option>');
            }
        }
        yearHtml = '<div class="pika-label">' + year + opts.yearSuffix + '<select class="pika-select pika-select-year" tabindex="-1">' + arr.join('') + '</select></div>';

        if (opts.showMonthAfterYear) {
            html += yearHtml + monthHtml;
        } else {
            html += monthHtml + yearHtml;
        }

        if (isMinYear && (month === 0 || opts.minMonth >= month)) {
            prev = false;
        }

        if (isMaxYear && (month === 11 || opts.maxMonth <= month)) {
            next = false;
        }

        if (c === 0) {
            html += '<button class="pika-prev' + (prev ? '' : ' is-disabled') + '" type="button">' + opts.i18n.previousMonth + '</button>';
        }
        if (c === (instance._o.numberOfMonths - 1) ) {
            html += '<button class="pika-next' + (next ? '' : ' is-disabled') + '" type="button">' + opts.i18n.nextMonth + '</button>';
        }

        return html += '</div>';
    },

    renderTable = function(opts, data, randId)
    {
        return '<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="' + randId + '">' + renderHead(opts) + renderBody(data) + '</table>';
    },


    /**
     * Pikaday constructor
     */
    Pikaday = function(options)
    {
        var self = this,
            opts = self.config(options);

        self._onMouseDown = function(e)
        {
            if (!self._v) {
                return;
            }
            e = e || window.event;
            var target = e.target || e.srcElement;
            if (!target) {
                return;
            }

            if (!hasClass(target, 'is-disabled')) {
                if (hasClass(target, 'pika-button') && !hasClass(target, 'is-empty') && !hasClass(target.parentNode, 'is-disabled')) {
                    self.setDate(new Date(target.getAttribute('data-pika-year'), target.getAttribute('data-pika-month'), target.getAttribute('data-pika-day')));
                    if (opts.bound) {
                        sto(function() {
                            self.hide();
                            if (opts.blurFieldOnSelect && opts.field) {
                                opts.field.blur();
                            }
                        }, 100);
                    }
                }
                else if (hasClass(target, 'pika-prev')) {
                    self.prevMonth();
                }
                else if (hasClass(target, 'pika-next')) {
                    self.nextMonth();
                }
            }
            if (!hasClass(target, 'pika-select')) {
                // if this is touch event prevent mouse events emulation
                if (e.preventDefault) {
                    e.preventDefault();
                } else {
                    e.returnValue = false;
                    return false;
                }
            } else {
                self._c = true;
            }
        };

        self._onChange = function(e)
        {
            e = e || window.event;
            var target = e.target || e.srcElement;
            if (!target) {
                return;
            }
            if (hasClass(target, 'pika-select-month')) {
                self.gotoMonth(target.value);
            }
            else if (hasClass(target, 'pika-select-year')) {
                self.gotoYear(target.value);
            }
        };

        self._onKeyChange = function(e)
        {
            e = e || window.event;

            if (self.isVisible()) {

                switch(e.keyCode){
                    case 13:
                    case 27:
                        if (opts.field) {
                            opts.field.blur();
                        }
                        break;
                    case 37:
                        e.preventDefault();
                        self.adjustDate('subtract', 1);
                        break;
                    case 38:
                        self.adjustDate('subtract', 7);
                        break;
                    case 39:
                        self.adjustDate('add', 1);
                        break;
                    case 40:
                        self.adjustDate('add', 7);
                        break;
                }
            }
        };

        self._onInputChange = function(e)
        {
            var date;

            if (e.firedBy === self) {
                return;
            }
            if (opts.parse) {
                date = opts.parse(opts.field.value, opts.format);
            } else if (hasMoment) {
                date = moment(opts.field.value, opts.format, opts.formatStrict);
                date = (date && date.isValid()) ? date.toDate() : null;
            }
            else {
                date = new Date(Date.parse(opts.field.value));
            }
            if (isDate(date)) {
              self.setDate(date);
            }
            if (!self._v) {
                self.show();
            }
        };

        self._onInputFocus = function()
        {
            self.show();
        };

        self._onInputClick = function()
        {
            self.show();
        };

        self._onInputBlur = function()
        {
            // IE allows pika div to gain focus; catch blur the input field
            var pEl = document.activeElement;
            do {
                if (hasClass(pEl, 'pika-single')) {
                    return;
                }
            }
            while ((pEl = pEl.parentNode));

            if (!self._c) {
                self._b = sto(function() {
                    self.hide();
                }, 50);
            }
            self._c = false;
        };

        self._onClick = function(e)
        {
            e = e || window.event;
            var target = e.target || e.srcElement,
                pEl = target;
            if (!target) {
                return;
            }
            if (!hasEventListeners && hasClass(target, 'pika-select')) {
                if (!target.onchange) {
                    target.setAttribute('onchange', 'return;');
                    addEvent(target, 'change', self._onChange);
                }
            }
            do {
                if (hasClass(pEl, 'pika-single') || pEl === opts.trigger) {
                    return;
                }
            }
            while ((pEl = pEl.parentNode));
            if (self._v && target !== opts.trigger && pEl !== opts.trigger) {
                self.hide();
            }
        };

        self.el = document.createElement('div');
        self.el.className = 'pika-single' + (opts.isRTL ? ' is-rtl' : '') + (opts.theme ? ' ' + opts.theme : '');

        addEvent(self.el, 'mousedown', self._onMouseDown, true);
        addEvent(self.el, 'touchend', self._onMouseDown, true);
        addEvent(self.el, 'change', self._onChange);
        addEvent(document, 'keydown', self._onKeyChange);

        if (opts.field) {
            if (opts.container) {
                opts.container.appendChild(self.el);
            } else if (opts.bound) {
                document.body.appendChild(self.el);
            } else {
                opts.field.parentNode.insertBefore(self.el, opts.field.nextSibling);
            }
            addEvent(opts.field, 'change', self._onInputChange);

            if (!opts.defaultDate) {
                if (hasMoment && opts.field.value) {
                    opts.defaultDate = moment(opts.field.value, opts.format).toDate();
                } else {
                    opts.defaultDate = new Date(Date.parse(opts.field.value));
                }
                opts.setDefaultDate = true;
            }
        }

        var defDate = opts.defaultDate;

        if (isDate(defDate)) {
            if (opts.setDefaultDate) {
                self.setDate(defDate, true);
            } else {
                self.gotoDate(defDate);
            }
        } else {
            self.gotoDate(new Date());
        }

        if (opts.bound) {
            this.hide();
            self.el.className += ' is-bound';
            addEvent(opts.trigger, 'click', self._onInputClick);
            addEvent(opts.trigger, 'focus', self._onInputFocus);
            addEvent(opts.trigger, 'blur', self._onInputBlur);
        } else {
            this.show();
        }
    };


    /**
     * public Pikaday API
     */
    Pikaday.prototype = {


        /**
         * configure functionality
         */
        config: function(options)
        {
            if (!this._o) {
                this._o = extend({}, defaults, true);
            }

            var opts = extend(this._o, options, true);

            opts.isRTL = !!opts.isRTL;

            opts.field = (opts.field && opts.field.nodeName) ? opts.field : null;

            opts.theme = (typeof opts.theme) === 'string' && opts.theme ? opts.theme : null;

            opts.bound = !!(opts.bound !== undefined ? opts.field && opts.bound : opts.field);

            opts.trigger = (opts.trigger && opts.trigger.nodeName) ? opts.trigger : opts.field;

            opts.disableWeekends = !!opts.disableWeekends;

            opts.disableDayFn = (typeof opts.disableDayFn) === 'function' ? opts.disableDayFn : null;

            var nom = parseInt(opts.numberOfMonths, 10) || 1;
            opts.numberOfMonths = nom > 4 ? 4 : nom;

            if (!isDate(opts.minDate)) {
                opts.minDate = false;
            }
            if (!isDate(opts.maxDate)) {
                opts.maxDate = false;
            }
            if ((opts.minDate && opts.maxDate) && opts.maxDate < opts.minDate) {
                opts.maxDate = opts.minDate = false;
            }
            if (opts.minDate) {
                this.setMinDate(opts.minDate);
            }
            if (opts.maxDate) {
                this.setMaxDate(opts.maxDate);
            }

            if (isArray(opts.yearRange)) {
                var fallback = new Date().getFullYear() - 10;
                opts.yearRange[0] = parseInt(opts.yearRange[0], 10) || fallback;
                opts.yearRange[1] = parseInt(opts.yearRange[1], 10) || fallback;
            } else {
                opts.yearRange = Math.abs(parseInt(opts.yearRange, 10)) || defaults.yearRange;
                if (opts.yearRange > 100) {
                    opts.yearRange = 100;
                }
            }

            return opts;
        },

        /**
         * return a formatted string of the current selection (using Moment.js if available)
         */
        toString: function(format)
        {
            format = format || this._o.format;
            if (!isDate(this._d)) {
                return '';
            }
            if (this._o.toString) {
              return this._o.toString(this._d, format);
            }
            if (hasMoment) {
              return moment(this._d).format(format);
            }
            return this._d.toDateString();
        },

        /**
         * return a Moment.js object of the current selection (if available)
         */
        getMoment: function()
        {
            return hasMoment ? moment(this._d) : null;
        },

        /**
         * set the current selection from a Moment.js object (if available)
         */
        setMoment: function(date, preventOnSelect)
        {
            if (hasMoment && moment.isMoment(date)) {
                this.setDate(date.toDate(), preventOnSelect);
            }
        },

        /**
         * return a Date object of the current selection
         */
        getDate: function()
        {
            return isDate(this._d) ? new Date(this._d.getTime()) : null;
        },

        /**
         * set the current selection
         */
        setDate: function(date, preventOnSelect)
        {
            if (!date) {
                this._d = null;

                if (this._o.field) {
                    this._o.field.value = '';
                    fireEvent(this._o.field, 'change', { firedBy: this });
                }

                return this.draw();
            }
            if (typeof date === 'string') {
                date = new Date(Date.parse(date));
            }
            if (!isDate(date)) {
                return;
            }

            var min = this._o.minDate,
                max = this._o.maxDate;

            if (isDate(min) && date < min) {
                date = min;
            } else if (isDate(max) && date > max) {
                date = max;
            }

            this._d = new Date(date.getTime());
            setToStartOfDay(this._d);
            this.gotoDate(this._d);

            if (this._o.field) {
                this._o.field.value = this.toString();
                fireEvent(this._o.field, 'change', { firedBy: this });
            }
            if (!preventOnSelect && typeof this._o.onSelect === 'function') {
                this._o.onSelect.call(this, this.getDate());
            }
        },

        /**
         * change view to a specific date
         */
        gotoDate: function(date)
        {
            var newCalendar = true;

            if (!isDate(date)) {
                return;
            }

            if (this.calendars) {
                var firstVisibleDate = new Date(this.calendars[0].year, this.calendars[0].month, 1),
                    lastVisibleDate = new Date(this.calendars[this.calendars.length-1].year, this.calendars[this.calendars.length-1].month, 1),
                    visibleDate = date.getTime();
                // get the end of the month
                lastVisibleDate.setMonth(lastVisibleDate.getMonth()+1);
                lastVisibleDate.setDate(lastVisibleDate.getDate()-1);
                newCalendar = (visibleDate < firstVisibleDate.getTime() || lastVisibleDate.getTime() < visibleDate);
            }

            if (newCalendar) {
                this.calendars = [{
                    month: date.getMonth(),
                    year: date.getFullYear()
                }];
                if (this._o.mainCalendar === 'right') {
                    this.calendars[0].month += 1 - this._o.numberOfMonths;
                }
            }

            this.adjustCalendars();
        },

        adjustDate: function(sign, days) {

            var day = this.getDate() || new Date();
            var difference = parseInt(days)*24*60*60*1000;

            var newDay;

            if (sign === 'add') {
                newDay = new Date(day.valueOf() + difference);
            } else if (sign === 'subtract') {
                newDay = new Date(day.valueOf() - difference);
            }

            this.setDate(newDay);
        },

        adjustCalendars: function() {
            this.calendars[0] = adjustCalendar(this.calendars[0]);
            for (var c = 1; c < this._o.numberOfMonths; c++) {
                this.calendars[c] = adjustCalendar({
                    month: this.calendars[0].month + c,
                    year: this.calendars[0].year
                });
            }
            this.draw();
        },

        gotoToday: function()
        {
            this.gotoDate(new Date());
        },

        /**
         * change view to a specific month (zero-index, e.g. 0: January)
         */
        gotoMonth: function(month)
        {
            if (!isNaN(month)) {
                this.calendars[0].month = parseInt(month, 10);
                this.adjustCalendars();
            }
        },

        nextMonth: function()
        {
            this.calendars[0].month++;
            this.adjustCalendars();
        },

        prevMonth: function()
        {
            this.calendars[0].month--;
            this.adjustCalendars();
        },

        /**
         * change view to a specific full year (e.g. "2012")
         */
        gotoYear: function(year)
        {
            if (!isNaN(year)) {
                this.calendars[0].year = parseInt(year, 10);
                this.adjustCalendars();
            }
        },

        /**
         * change the minDate
         */
        setMinDate: function(value)
        {
            if(value instanceof Date) {
                setToStartOfDay(value);
                this._o.minDate = value;
                this._o.minYear  = value.getFullYear();
                this._o.minMonth = value.getMonth();
            } else {
                this._o.minDate = defaults.minDate;
                this._o.minYear  = defaults.minYear;
                this._o.minMonth = defaults.minMonth;
                this._o.startRange = defaults.startRange;
            }

            this.draw();
        },

        /**
         * change the maxDate
         */
        setMaxDate: function(value)
        {
            if(value instanceof Date) {
                setToStartOfDay(value);
                this._o.maxDate = value;
                this._o.maxYear = value.getFullYear();
                this._o.maxMonth = value.getMonth();
            } else {
                this._o.maxDate = defaults.maxDate;
                this._o.maxYear = defaults.maxYear;
                this._o.maxMonth = defaults.maxMonth;
                this._o.endRange = defaults.endRange;
            }

            this.draw();
        },

        setStartRange: function(value)
        {
            this._o.startRange = value;
        },

        setEndRange: function(value)
        {
            this._o.endRange = value;
        },

        /**
         * refresh the HTML
         */
        draw: function(force)
        {
            if (!this._v && !force) {
                return;
            }
            var opts = this._o,
                minYear = opts.minYear,
                maxYear = opts.maxYear,
                minMonth = opts.minMonth,
                maxMonth = opts.maxMonth,
                html = '',
                randId;

            if (this._y <= minYear) {
                this._y = minYear;
                if (!isNaN(minMonth) && this._m < minMonth) {
                    this._m = minMonth;
                }
            }
            if (this._y >= maxYear) {
                this._y = maxYear;
                if (!isNaN(maxMonth) && this._m > maxMonth) {
                    this._m = maxMonth;
                }
            }

            randId = 'pika-title-' + Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0, 2);

            for (var c = 0; c < opts.numberOfMonths; c++) {
                html += '<div class="pika-lendar">' + renderTitle(this, c, this.calendars[c].year, this.calendars[c].month, this.calendars[0].year, randId) + this.render(this.calendars[c].year, this.calendars[c].month, randId) + '</div>';
            }

            this.el.innerHTML = html;

            if (opts.bound) {
                if(opts.field.type !== 'hidden') {
                    sto(function() {
                        opts.trigger.focus();
                    }, 1);
                }
            }

            if (typeof this._o.onDraw === 'function') {
                this._o.onDraw(this);
            }

            if (opts.bound) {
                // let the screen reader user know to use arrow keys
                opts.field.setAttribute('aria-label', 'Use the arrow keys to pick a date');
            }
        },

        adjustPosition: function()
        {
            var field, pEl, width, height, viewportWidth, viewportHeight, scrollTop, left, top, clientRect;

            if (this._o.container) return;

            this.el.style.position = 'absolute';

            field = this._o.trigger;
            pEl = field;
            width = this.el.offsetWidth;
            height = this.el.offsetHeight;
            viewportWidth = window.innerWidth || document.documentElement.clientWidth;
            viewportHeight = window.innerHeight || document.documentElement.clientHeight;
            scrollTop = window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop;

            if (typeof field.getBoundingClientRect === 'function') {
                clientRect = field.getBoundingClientRect();
                left = clientRect.left + window.pageXOffset;
                top = clientRect.bottom + window.pageYOffset;
            } else {
                left = pEl.offsetLeft;
                top  = pEl.offsetTop + pEl.offsetHeight;
                while((pEl = pEl.offsetParent)) {
                    left += pEl.offsetLeft;
                    top  += pEl.offsetTop;
                }
            }

            // default position is bottom & left
            if ((this._o.reposition && left + width > viewportWidth) ||
                (
                    this._o.position.indexOf('right') > -1 &&
                    left - width + field.offsetWidth > 0
                )
            ) {
                left = left - width + field.offsetWidth;
            }
            if ((this._o.reposition && top + height > viewportHeight + scrollTop) ||
                (
                    this._o.position.indexOf('top') > -1 &&
                    top - height - field.offsetHeight > 0
                )
            ) {
                top = top - height - field.offsetHeight;
            }

            this.el.style.left = left + 'px';
            this.el.style.top = top + 'px';
        },

        /**
         * render HTML for a particular month
         */
        render: function(year, month, randId)
        {
            var opts   = this._o,
                now    = new Date(),
                days   = getDaysInMonth(year, month),
                before = new Date(year, month, 1).getDay(),
                data   = [],
                row    = [];
            setToStartOfDay(now);
            if (opts.firstDay > 0) {
                before -= opts.firstDay;
                if (before < 0) {
                    before += 7;
                }
            }
            var previousMonth = month === 0 ? 11 : month - 1,
                nextMonth = month === 11 ? 0 : month + 1,
                yearOfPreviousMonth = month === 0 ? year - 1 : year,
                yearOfNextMonth = month === 11 ? year + 1 : year,
                daysInPreviousMonth = getDaysInMonth(yearOfPreviousMonth, previousMonth);
            var cells = days + before,
                after = cells;
            while(after > 7) {
                after -= 7;
            }
            cells += 7 - after;
            var isWeekSelected = false;
            for (var i = 0, r = 0; i < cells; i++)
            {
                var day = new Date(year, month, 1 + (i - before)),
                    isSelected = isDate(this._d) ? compareDates(day, this._d) : false,
                    isToday = compareDates(day, now),
                    hasEvent = opts.events.indexOf(day.toDateString()) !== -1 ? true : false,
                    isEmpty = i < before || i >= (days + before),
                    dayNumber = 1 + (i - before),
                    monthNumber = month,
                    yearNumber = year,
                    isStartRange = opts.startRange && compareDates(opts.startRange, day),
                    isEndRange = opts.endRange && compareDates(opts.endRange, day),
                    isInRange = opts.startRange && opts.endRange && opts.startRange < day && day < opts.endRange,
                    isDisabled = (opts.minDate && day < opts.minDate) ||
                                 (opts.maxDate && day > opts.maxDate) ||
                                 (opts.disableWeekends && isWeekend(day)) ||
                                 (opts.disableDayFn && opts.disableDayFn(day));

                if (isEmpty) {
                    if (i < before) {
                        dayNumber = daysInPreviousMonth + dayNumber;
                        monthNumber = previousMonth;
                        yearNumber = yearOfPreviousMonth;
                    } else {
                        dayNumber = dayNumber - days;
                        monthNumber = nextMonth;
                        yearNumber = yearOfNextMonth;
                    }
                }

                var dayConfig = {
                        day: dayNumber,
                        month: monthNumber,
                        year: yearNumber,
                        hasEvent: hasEvent,
                        isSelected: isSelected,
                        isToday: isToday,
                        isDisabled: isDisabled,
                        isEmpty: isEmpty,
                        isStartRange: isStartRange,
                        isEndRange: isEndRange,
                        isInRange: isInRange,
                        showDaysInNextAndPreviousMonths: opts.showDaysInNextAndPreviousMonths
                    };

                if (opts.pickWholeWeek && isSelected) {
                    isWeekSelected = true;
                }

                row.push(renderDay(dayConfig));

                if (++r === 7) {
                    if (opts.showWeekNumber) {
                        row.unshift(renderWeek(i - before, month, year));
                    }
                    data.push(renderRow(row, opts.isRTL, opts.pickWholeWeek, isWeekSelected));
                    row = [];
                    r = 0;
                    isWeekSelected = false;
                }
            }
            return renderTable(opts, data, randId);
        },

        isVisible: function()
        {
            return this._v;
        },

        show: function()
        {
            if (!this.isVisible()) {
                this._v = true;
                this.draw();
                removeClass(this.el, 'is-hidden');
                if (this._o.bound) {
                    addEvent(document, 'click', this._onClick);
                    this.adjustPosition();
                }
                if (typeof this._o.onOpen === 'function') {
                    this._o.onOpen.call(this);
                }
            }
        },

        hide: function()
        {
            var v = this._v;
            if (v !== false) {
                if (this._o.bound) {
                    removeEvent(document, 'click', this._onClick);
                }
                this.el.style.position = 'static'; // reset
                this.el.style.left = 'auto';
                this.el.style.top = 'auto';
                addClass(this.el, 'is-hidden');
                this._v = false;
                if (v !== undefined && typeof this._o.onClose === 'function') {
                    this._o.onClose.call(this);
                }
            }
        },

        /**
         * GAME OVER
         */
        destroy: function()
        {
            this.hide();
            removeEvent(this.el, 'mousedown', this._onMouseDown, true);
            removeEvent(this.el, 'touchend', this._onMouseDown, true);
            removeEvent(this.el, 'change', this._onChange);
            if (this._o.field) {
                removeEvent(this._o.field, 'change', this._onInputChange);
                if (this._o.bound) {
                    removeEvent(this._o.trigger, 'click', this._onInputClick);
                    removeEvent(this._o.trigger, 'focus', this._onInputFocus);
                    removeEvent(this._o.trigger, 'blur', this._onInputBlur);
                }
            }
            if (this.el.parentNode) {
                this.el.parentNode.removeChild(this.el);
            }
        }

    };

    return Pikaday;

}));

!function(){"use strict";function e(n){return"undefined"==typeof this||Object.getPrototypeOf(this)!==e.prototype?new e(n):(O=this,O.version="3.3.6",O.tools=new E,O.isSupported()?(O.tools.extend(O.defaults,n||{}),O.defaults.container=t(O.defaults),O.store={elements:{},containers:[]},O.sequences={},O.history=[],O.uid=0,O.initialized=!1):"undefined"!=typeof console&&null!==console,O)}function t(e){if(e&&e.container){if("string"==typeof e.container)return window.document.documentElement.querySelector(e.container);if(O.tools.isNode(e.container))return e.container}return O.defaults.container}function n(e,t){return"string"==typeof e?Array.prototype.slice.call(t.querySelectorAll(e)):O.tools.isNode(e)?[e]:O.tools.isNodeList(e)?Array.prototype.slice.call(e):[]}function i(){return++O.uid}function o(e,t,n){t.container&&(t.container=n),e.config?e.config=O.tools.extendClone(e.config,t):e.config=O.tools.extendClone(O.defaults,t),"top"===e.config.origin||"bottom"===e.config.origin?e.config.axis="Y":e.config.axis="X"}function r(e){var t=window.getComputedStyle(e.domEl);e.styles||(e.styles={transition:{},transform:{},computed:{}},e.styles.inline=e.domEl.getAttribute("style")||"",e.styles.inline+="; visibility: visible; ",e.styles.computed.opacity=t.opacity,t.transition&&"all 0s ease 0s"!==t.transition?e.styles.computed.transition=t.transition+", ":e.styles.computed.transition=""),e.styles.transition.instant=s(e,0),e.styles.transition.delayed=s(e,e.config.delay),e.styles.transform.initial=" -webkit-transform:",e.styles.transform.target=" -webkit-transform:",a(e),e.styles.transform.initial+="transform:",e.styles.transform.target+="transform:",a(e)}function s(e,t){var n=e.config;return"-webkit-transition: "+e.styles.computed.transition+"-webkit-transform "+n.duration/1e3+"s "+n.easing+" "+t/1e3+"s, opacity "+n.duration/1e3+"s "+n.easing+" "+t/1e3+"s; transition: "+e.styles.computed.transition+"transform "+n.duration/1e3+"s "+n.easing+" "+t/1e3+"s, opacity "+n.duration/1e3+"s "+n.easing+" "+t/1e3+"s; "}function a(e){var t,n=e.config,i=e.styles.transform;t="top"===n.origin||"left"===n.origin?/^-/.test(n.distance)?n.distance.substr(1):"-"+n.distance:n.distance,parseInt(n.distance)&&(i.initial+=" translate"+n.axis+"("+t+")",i.target+=" translate"+n.axis+"(0)"),n.scale&&(i.initial+=" scale("+n.scale+")",i.target+=" scale(1)"),n.rotate.x&&(i.initial+=" rotateX("+n.rotate.x+"deg)",i.target+=" rotateX(0)"),n.rotate.y&&(i.initial+=" rotateY("+n.rotate.y+"deg)",i.target+=" rotateY(0)"),n.rotate.z&&(i.initial+=" rotateZ("+n.rotate.z+"deg)",i.target+=" rotateZ(0)"),i.initial+="; opacity: "+n.opacity+";",i.target+="; opacity: "+e.styles.computed.opacity+";"}function l(e){var t=e.config.container;t&&O.store.containers.indexOf(t)===-1&&O.store.containers.push(e.config.container),O.store.elements[e.id]=e}function c(e,t,n){var i={target:e,config:t,interval:n};O.history.push(i)}function f(){if(O.isSupported()){y();for(var e=0;e<O.store.containers.length;e++)O.store.containers[e].addEventListener("scroll",d),O.store.containers[e].addEventListener("resize",d);O.initialized||(window.addEventListener("scroll",d),window.addEventListener("resize",d),O.initialized=!0)}return O}function d(){T(y)}function u(){var e,t,n,i;O.tools.forOwn(O.sequences,function(o){i=O.sequences[o],e=!1;for(var r=0;r<i.elemIds.length;r++)n=i.elemIds[r],t=O.store.elements[n],q(t)&&!e&&(e=!0);i.active=e})}function y(){var e,t;u(),O.tools.forOwn(O.store.elements,function(n){t=O.store.elements[n],e=w(t),g(t)?(t.config.beforeReveal(t.domEl),e?t.domEl.setAttribute("style",t.styles.inline+t.styles.transform.target+t.styles.transition.delayed):t.domEl.setAttribute("style",t.styles.inline+t.styles.transform.target+t.styles.transition.instant),p("reveal",t,e),t.revealing=!0,t.seen=!0,t.sequence&&m(t,e)):v(t)&&(t.config.beforeReset(t.domEl),t.domEl.setAttribute("style",t.styles.inline+t.styles.transform.initial+t.styles.transition.instant),p("reset",t),t.revealing=!1)})}function m(e,t){var n=0,i=0,o=O.sequences[e.sequence.id];o.blocked=!0,t&&"onload"===e.config.useDelay&&(i=e.config.delay),e.sequence.timer&&(n=Math.abs(e.sequence.timer.started-new Date),window.clearTimeout(e.sequence.timer)),e.sequence.timer={started:new Date},e.sequence.timer.clock=window.setTimeout(function(){o.blocked=!1,e.sequence.timer=null,d()},Math.abs(o.interval)+i-n)}function p(e,t,n){var i=0,o=0,r="after";switch(e){case"reveal":o=t.config.duration,n&&(o+=t.config.delay),r+="Reveal";break;case"reset":o=t.config.duration,r+="Reset"}t.timer&&(i=Math.abs(t.timer.started-new Date),window.clearTimeout(t.timer.clock)),t.timer={started:new Date},t.timer.clock=window.setTimeout(function(){t.config[r](t.domEl),t.timer=null},o-i)}function g(e){if(e.sequence){var t=O.sequences[e.sequence.id];return t.active&&!t.blocked&&!e.revealing&&!e.disabled}return q(e)&&!e.revealing&&!e.disabled}function w(e){var t=e.config.useDelay;return"always"===t||"onload"===t&&!O.initialized||"once"===t&&!e.seen}function v(e){if(e.sequence){var t=O.sequences[e.sequence.id];return!t.active&&e.config.reset&&e.revealing&&!e.disabled}return!q(e)&&e.config.reset&&e.revealing&&!e.disabled}function b(e){return{width:e.clientWidth,height:e.clientHeight}}function h(e){if(e&&e!==window.document.documentElement){var t=x(e);return{x:e.scrollLeft+t.left,y:e.scrollTop+t.top}}return{x:window.pageXOffset,y:window.pageYOffset}}function x(e){var t=0,n=0,i=e.offsetHeight,o=e.offsetWidth;do isNaN(e.offsetTop)||(t+=e.offsetTop),isNaN(e.offsetLeft)||(n+=e.offsetLeft),e=e.offsetParent;while(e);return{top:t,left:n,height:i,width:o}}function q(e){function t(){var t=c+a*s,n=f+l*s,i=d-a*s,y=u-l*s,m=r.y+e.config.viewOffset.top,p=r.x+e.config.viewOffset.left,g=r.y-e.config.viewOffset.bottom+o.height,w=r.x-e.config.viewOffset.right+o.width;return t<g&&i>m&&n<w&&y>p}function n(){return"fixed"===window.getComputedStyle(e.domEl).position}var i=x(e.domEl),o=b(e.config.container),r=h(e.config.container),s=e.config.viewFactor,a=i.height,l=i.width,c=i.top,f=i.left,d=c+a,u=f+l;return t()||n()}function E(){}var O,T;e.prototype.defaults={origin:"bottom",distance:"20px",duration:500,delay:0,rotate:{x:0,y:0,z:0},opacity:0,scale:.9,easing:"cubic-bezier(0.6, 0.2, 0.1, 1)",container:window.document.documentElement,mobile:!0,reset:!1,useDelay:"always",viewFactor:.2,viewOffset:{top:0,right:0,bottom:0,left:0},beforeReveal:function(e){},beforeReset:function(e){},afterReveal:function(e){},afterReset:function(e){}},e.prototype.isSupported=function(){var e=document.documentElement.style;return"WebkitTransition"in e&&"WebkitTransform"in e||"transition"in e&&"transform"in e},e.prototype.reveal=function(e,s,a,d){var u,y,m,p,g,w;if(void 0!==s&&"number"==typeof s?(a=s,s={}):void 0!==s&&null!==s||(s={}),u=t(s),y=n(e,u),!y.length)return O;a&&"number"==typeof a&&(w=i(),g=O.sequences[w]={id:w,interval:a,elemIds:[],active:!1});for(var v=0;v<y.length;v++)p=y[v].getAttribute("data-sr-id"),p?m=O.store.elements[p]:(m={id:i(),domEl:y[v],seen:!1,revealing:!1},m.domEl.setAttribute("data-sr-id",m.id)),g&&(m.sequence={id:g.id,index:g.elemIds.length},g.elemIds.push(m.id)),o(m,s,u),r(m),l(m),O.tools.isMobile()&&!m.config.mobile||!O.isSupported()?(m.domEl.setAttribute("style",m.styles.inline),m.disabled=!0):m.revealing||m.domEl.setAttribute("style",m.styles.inline+m.styles.transform.initial);return!d&&O.isSupported()&&(c(e,s,a),O.initTimeout&&window.clearTimeout(O.initTimeout),O.initTimeout=window.setTimeout(f,0)),O},e.prototype.sync=function(){if(O.history.length&&O.isSupported()){for(var e=0;e<O.history.length;e++){var t=O.history[e];O.reveal(t.target,t.config,t.interval,!0)}f()}return O},E.prototype.isObject=function(e){return null!==e&&"object"==typeof e&&e.constructor===Object},E.prototype.isNode=function(e){return"object"==typeof window.Node?e instanceof window.Node:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},E.prototype.isNodeList=function(e){var t=Object.prototype.toString.call(e),n=/^\[object (HTMLCollection|NodeList|Object)\]$/;return"object"==typeof window.NodeList?e instanceof window.NodeList:e&&"object"==typeof e&&n.test(t)&&"number"==typeof e.length&&(0===e.length||this.isNode(e[0]))},E.prototype.forOwn=function(e,t){if(!this.isObject(e))throw new TypeError('Expected "object", but received "'+typeof e+'".');for(var n in e)e.hasOwnProperty(n)&&t(n)},E.prototype.extend=function(e,t){return this.forOwn(t,function(n){this.isObject(t[n])?(e[n]&&this.isObject(e[n])||(e[n]={}),this.extend(e[n],t[n])):e[n]=t[n]}.bind(this)),e},E.prototype.extendClone=function(e,t){return this.extend(this.extend({},e),t)},E.prototype.isMobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},T=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return e}):"undefined"!=typeof module&&module.exports?module.exports=e:window.ScrollReveal=e}();

/**
 * shave - Shave is a javascript plugin that truncates multi-line text within a html element based on set max height
 * @version v2.1.7
 * @link https://github.com/dollarshaveclub/shave#readme
 * @author Jeff Wainwright <jjwainwright2@gmail.com> (jeffry.in)
 * @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.shave=t()}(this,function(){"use strict";function e(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)throw Error("maxHeight is required");var i="string"==typeof e?document.querySelectorAll(e):e;if(i){var r=n.character||"",s=n.classname||"js-shave",a=n.spaces||!0,o='<span class="js-shave-char">'+r+"</span>";"length"in i||(i=[i]);for(var h=0;h<i.length;h+=1){var c=i[h],l=c.style,f=c.querySelector("."+s),d=void 0===c.textContent?"innerText":"textContent";f&&(c.removeChild(c.querySelector(".js-shave-char")),c[d]=c[d]);var v=c[d],g=a?v:v.split(" ");if(!(g.length<2)){var u=l.height;l.height="auto";var p=l.maxHeight;if(l.maxHeight="none",c.offsetHeight<=t)l.height=u,l.maxHeight=p;else{for(var m=g.length-1,j=0,x=void 0;j<m;)x=j+m+1>>1,c[d]=a?g.slice(0,x):g.slice(0,x).join(" "),c.insertAdjacentHTML("beforeend",o),c.offsetHeight>t?m=a?x-2:x-1:j=x;c[d]=a?g.slice(0,m):g.slice(0,m).join(" "),c.insertAdjacentHTML("beforeend",o);var y=a?g.slice(m):g.slice(m).join(" ");c.insertAdjacentHTML("beforeend",'<span class="'+s+'" style="display:none;">'+y+"</span>"),l.height=u,l.maxHeight=p}}}}}return e});
/**
 * Simple Mask Money (edited)
 * Peguei o cdigo original, converti pra <es6 no babel
 * e fiz algumas modificaes pra funcionar.
 * @link: https://github.com/codermarcos/simple-mask-money/blob/master/lib/simple-mask-money.js
 * @return {String} Money formated
 */
var SimpleMaskMoney = function () {
  var args = {
    prefix: '',
    suffix: '',
    fixed: true,
    fractionDigits: 2,
    decimalSeparator: ',',
    thousandsSeparator: '.',
    autoCompleteDecimal: false,
    emptyOrInvalid: function emptyOrInvalid() {
      return args.fixed ? '0' + args.decimalSeparator + '00' : '_' + args.decimalSeparator + '__';
    }
  };

  var functions = {
    get args() {
      return args;
    },
    set args(value) {
      args = Object.assign(args, value);
      args.prefix = value.prefix || value.preffix;
    },

    onlyNumber: function onlyNumber(value) {
      var retorno = '';

      for (var i = 0; i < value.length; i++) {
        if (isFinite(value[i])) {
          retorno += value[i];
        }
      }

      return retorno;
    },

    addingPrefix: function addingPrefix(value) {
      return '' + args.prefix + value;
    },
    removingPrefix: function removingPrefix(value) {
      return value.replace(args.prefix, '');
    },

    addingSuffix: function addingSuffix(value) {
      return '' + value + args.suffix;
    },
    removingSuffix: function removingSuffix(value) {
      if (value.includes(args.suffix, value.length - args.fractionDigits)) {
        value = value.replace(args.suffix, '');
      } else {
        value = value.substring(0, value.length - 1);
      }
      return value;
    },

    addingCompleterFromStart: function addingCompleterFromStart(value, completer) {
      while (value.length < args.fractionDigits) {
        value = '' + completer + value;
      }
      return value;
    },

    addingCompleterFromEnd: function addingCompleterFromEnd(value, completer) {
      while (value.length < args.fractionDigits) {
        value = '' + value + completer;
      }
      return value;
    },

    removingCompleterFromStart: function removingCompleterFromStart(value, completer) {
      while (value[0] === completer) {
        value = value.replace(completer, '');
      }
      return value;
    },

    removingCompleterFromEnd: function removingCompleterFromEnd(value, completer) {
      while (value[value.length - 1] === completer) {
        value = value.substring(0, value.length - 1);
      }
      return value;
    },

    addingAutoComplete: function addingAutoComplete(value) {
      var n = '' + value + functions.addingCompleterFromEnd('', '0');
      return n;
    },

    autoComplete: function autoComplete(value) {
      var array = value.match(new RegExp('\\' + args.decimalSeparator, 'g')) || [];
      if (array.length > 1) {
        value = functions.addingAutoComplete(value);
      }
      return value;
    },

    addingDecimalSeparator: function addingDecimalSeparator(value, completer, separator) {
      var length = value.length - args.fractionDigits;

      var regexpFraction = void 0;
      var decimals = '$1';
      var dezenas = completer;
      var character = isFinite(completer) ? 'd' : 'w';

      regexpFraction = '(\\' + character + '{' + args.fractionDigits + '})';
      if (length > 0) {
        regexpFraction = '(\\' + character + '{' + length + '})' + regexpFraction;
        dezenas = decimals;
        decimals = '$2';
      }

      return value.replace(new RegExp(regexpFraction), '' + dezenas + separator + decimals);
    },

    addingHundredsSeparator: function addingHundredsSeparator(value) {
      var size = value.length - args.fractionDigits;
      var hundreds = Math.ceil(size / 3);
      var regexpHundreds = '(\\d)';

      var replacement = args.decimalSeparator + '$' + (hundreds + 1);

      for (var i = hundreds; i !== 0; i--) {
        if (size >= 3) {
          regexpHundreds = '(\\d{3})' + regexpHundreds;
          size -= 3;
        } else {
          regexpHundreds = '(\\d{' + size + '})' + regexpHundreds;
        }

        if (i > 1) {
          replacement = args.thousandsSeparator + '$' + i + replacement;
        } else {
          replacement = '$' + i + replacement;
        }
      }

      return value.replace(new RegExp(regexpHundreds), replacement);
    },
    removeSeparator: function removeSeparator(value, separator) {
      return value.replace(new RegExp('\\' + separator, 'g'), '');
    },
    formatDecimal: function formatDecimal(value, completer, separator) {
      value = functions.addingCompleterFromStart(value, completer);
      value = functions.addingDecimalSeparator(value, completer, separator);
      return value;
    },

    textToNumber: function textToNumber(input) {
      var retorno = input.toString();
      var completer = args.fixed ? '0' : '_';

      if (args.prefix) {
        retorno = functions.removingPrefix(retorno);
      }

      if (args.suffix) {
        retorno = functions.removingSuffix(retorno);
      }

      if (args.autoCompleteDecimal) {
        retorno = functions.autoComplete(retorno);
      }

      retorno = functions.removeSeparator(retorno, args.thousandsSeparator);
      retorno = functions.removeSeparator(retorno, args.decimalSeparator);

      retorno = functions.onlyNumber(retorno);

      retorno = functions.removingCompleterFromStart(retorno, completer);

      return retorno || (args.fixed ? '0' : '');
    },

    numberToText: function numberToText(input) {
      var retorno = args.emptyOrInvalid();

      if (parseFloat(input) !== 'NaN') {
        if (input.length <= args.fractionDigits) {
          retorno = functions.formatDecimal(input, args.fixed ? '0' : '_', args.decimalSeparator);
        } else {
          retorno = functions.addingHundredsSeparator(input);
        }
      }

      if (args.prefix) {
        retorno = functions.addingPrefix(retorno);
      }
      if (args.suffix) {
        retorno = functions.addingSuffix(retorno);
      }

      return retorno;
    },

    format: function format(value) {
      return functions.numberToText(functions.textToNumber(value));
    },

    formatToNumber: function formatToNumber(input) {
      var retorno = '0';
      var value = functions.textToNumber(input);

      if (parseFloat(value) !== 'NaN') {
        if (value.length <= args.fractionDigits) {
          value = functions.formatDecimal(value, '0', '.');
        } else {
          var lengthWithoutDecimals = value.length - args.fractionDigits;
          value = value.replace(new RegExp('(\\d{' + lengthWithoutDecimals + '})(\\d{' + args.fractionDigits + '})'), '$1.$2');
        }

        retorno = value;
      }

      return parseFloat(retorno);
    },

    setMask: function setMask(element, args) {
      var input = typeof element == 'string' ? document.querySelector(element) : element;

      if (args) {
        args = args;
      }

      input.addEventListener('input', function () {
        input.value = functions.format(input.value);
      });
      input['formatToNumber'] = function () {
        return functions.formatToNumber(input.value);
      };

      return input.value;
    }
  };

  return functions;
}();

/*! smooth-scroll v14.2.1 | (c) 2018 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/smooth-scroll */
window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t,n=(this.document||this.ownerDocument).querySelectorAll(e),o=this;do{for(t=n.length;--t>=0&&n.item(t)!==o;);}while(t<0&&(o=o.parentElement));return o}),(function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}if("function"==typeof window.CustomEvent)return!1;e.prototype=window.Event.prototype,window.CustomEvent=e})(),(function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var o=(new Date).getTime(),i=Math.max(0,16-(o-e)),r=window.setTimeout((function(){t(o+i)}),i);return e=o+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})})(),(function(e,t){"function"==typeof define&&define.amd?define([],(function(){return t(e)})):"object"==typeof exports?module.exports=t(e):e.SmoothScroll=t(e)})("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(e){"use strict";var t={ignore:"[data-scroll-ignore]",header:null,topOnEmptyHash:!0,speed:500,clip:!0,offset:0,easing:"easeInOutCubic",customEasing:null,updateURL:!0,popstate:!0,emitEvents:!0},n=function(){return"querySelector"in document&&"addEventListener"in e&&"requestAnimationFrame"in e&&"closest"in e.Element.prototype},o=function(){for(var e={},t=0;t<arguments.length;t++)!(function(t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(arguments[t]);return e},i=function(t){return!!("matchMedia"in e&&e.matchMedia("(prefers-reduced-motion)").matches)},r=function(t){return parseInt(e.getComputedStyle(t).height,10)},a=function(e){var t;try{t=decodeURIComponent(e)}catch(n){t=e}return t},u=function(e){"#"===e.charAt(0)&&(e=e.substr(1));for(var t,n=String(e),o=n.length,i=-1,r="",a=n.charCodeAt(0);++i<o;){if(0===(t=n.charCodeAt(i)))throw new InvalidCharacterError("Invalid character: the input contains U+0000.");t>=1&&t<=31||127==t||0===i&&t>=48&&t<=57||1===i&&t>=48&&t<=57&&45===a?r+="\\"+t.toString(16)+" ":r+=t>=128||45===t||95===t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122?n.charAt(i):"\\"+n.charAt(i)}var u;try{u=decodeURIComponent("#"+r)}catch(e){u="#"+r}return u},c=function(e,t){var n;return"easeInQuad"===e.easing&&(n=t*t),"easeOutQuad"===e.easing&&(n=t*(2-t)),"easeInOutQuad"===e.easing&&(n=t<.5?2*t*t:(4-2*t)*t-1),"easeInCubic"===e.easing&&(n=t*t*t),"easeOutCubic"===e.easing&&(n=--t*t*t+1),"easeInOutCubic"===e.easing&&(n=t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1),"easeInQuart"===e.easing&&(n=t*t*t*t),"easeOutQuart"===e.easing&&(n=1- --t*t*t*t),"easeInOutQuart"===e.easing&&(n=t<.5?8*t*t*t*t:1-8*--t*t*t*t),"easeInQuint"===e.easing&&(n=t*t*t*t*t),"easeOutQuint"===e.easing&&(n=1+--t*t*t*t*t),"easeInOutQuint"===e.easing&&(n=t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t),e.customEasing&&(n=e.customEasing(t)),n||t},s=function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)},l=function(t,n,o,i){var r=0;if(t.offsetParent)do{r+=t.offsetTop,t=t.offsetParent}while(t);return r=Math.max(r-n-o,0),i&&(r=Math.min(r,s()-e.innerHeight)),r},m=function(e){return e?r(e)+e.offsetTop:0},d=function(e,t,n){t||history.pushState&&n.updateURL&&history.pushState({smoothScroll:JSON.stringify(n),anchor:e.id},document.title,e===document.documentElement?"#top":"#"+e.id)},f=function(t,n,o){0===t&&document.body.focus(),o||(t.focus(),document.activeElement!==t&&(t.setAttribute("tabindex","-1"),t.focus(),t.style.outline="none"),e.scrollTo(0,n))},h=function(t,n,o,i){if(n.emitEvents&&"function"==typeof e.CustomEvent){var r=new CustomEvent(t,{bubbles:!0,detail:{anchor:o,toggle:i}});document.dispatchEvent(r)}};return function(r,p){var g,v,w,y,E,b,S,A={};A.cancelScroll=function(e){cancelAnimationFrame(S),S=null,e||h("scrollCancel",g)},A.animateScroll=function(n,i,r){var a=o(g||t,r||{}),u="[object Number]"===Object.prototype.toString.call(n),p=u||!n.tagName?null:n;if(u||p){var v=e.pageYOffset;a.header&&!y&&(y=document.querySelector(a.header)),E||(E=m(y));var w,b,C,O=u?n:l(p,E,parseInt("function"==typeof a.offset?a.offset(n,i):a.offset,10),a.clip),I=O-v,q=s(),F=0,L=function(t,o){var r=e.pageYOffset;if(t==o||r==o||(v<o&&e.innerHeight+r)>=q)return A.cancelScroll(!0),f(n,o,u),h("scrollStop",a,n,i),w=null,S=null,!0},H=function(t){w||(w=t),F+=t-w,b=F/parseInt(a.speed,10),b=b>1?1:b,C=v+I*c(a,b),e.scrollTo(0,Math.floor(C)),L(C,O)||(S=e.requestAnimationFrame(H),w=t)};0===e.pageYOffset&&e.scrollTo(0,0),d(n,u,a),h("scrollStart",a,n,i),A.cancelScroll(!0),e.requestAnimationFrame(H)}};var C=function(t){if(!i()&&0===t.button&&!t.metaKey&&!t.ctrlKey&&"closest"in t.target&&(w=t.target.closest(r))&&"a"===w.tagName.toLowerCase()&&!t.target.closest(g.ignore)&&w.hostname===e.location.hostname&&w.pathname===e.location.pathname&&/#/.test(w.href)){var n=u(a(w.hash)),o=g.topOnEmptyHash&&"#"===n?document.documentElement:document.querySelector(n);o=o||"#top"!==n?o:document.documentElement,o&&(t.preventDefault(),A.animateScroll(o,w))}},O=function(e){if(null!==history.state&&history.state.smoothScroll&&history.state.smoothScroll===JSON.stringify(g)&&history.state.anchor){var t=document.querySelector(u(a(history.state.anchor)));t&&A.animateScroll(t,null,{updateURL:!1})}},I=function(e){b||(b=setTimeout((function(){b=null,E=m(y)}),66))};return A.destroy=function(){g&&(document.removeEventListener("click",C,!1),e.removeEventListener("resize",I,!1),e.removeEventListener("popstate",O,!1),A.cancelScroll(),g=null,v=null,w=null,y=null,E=null,b=null,S=null)},A.init=function(i){if(!n())throw"Smooth Scroll: This browser does not support the required JavaScript methods and browser APIs.";A.destroy(),g=o(t,i||{}),y=g.header?document.querySelector(g.header):null,E=m(y),document.addEventListener("click",C,!1),y&&e.addEventListener("resize",I,!1),g.updateURL&&g.popstate&&e.addEventListener("popstate",O,!1)},A.init(p),A}}));

/*!
 * tablesort v5.0.2 (2017-11-12)
 * http://tristen.ca/tablesort/demo/
 * Copyright (c) 2017 ; Licensed MIT
*/!function(){function a(b,c){if(!(this instanceof a))return new a(b,c);if(!b||"TABLE"!==b.tagName)throw new Error("Element must be a table");this.init(b,c||{})}var b=[],c=function(a){var b;return window.CustomEvent&&"function"==typeof window.CustomEvent?b=new CustomEvent(a):(b=document.createEvent("CustomEvent"),b.initCustomEvent(a,!1,!1,void 0)),b},d=function(a){return a.getAttribute("data-sort")||a.textContent||a.innerText||""},e=function(a,b){return a=a.trim().toLowerCase(),b=b.trim().toLowerCase(),a===b?0:a<b?1:-1},f=function(a,b){return function(c,d){var e=a(c.td,d.td);return 0===e?b?d.index-c.index:c.index-d.index:e}};a.extend=function(a,c,d){if("function"!=typeof c||"function"!=typeof d)throw new Error("Pattern and sort must be a function");b.push({name:a,pattern:c,sort:d})},a.prototype={init:function(a,b){var c,d,e,f,g=this;if(g.table=a,g.thead=!1,g.options=b,a.rows&&a.rows.length>0)if(a.tHead&&a.tHead.rows.length>0){for(e=0;e<a.tHead.rows.length;e++)if("thead"===a.tHead.rows[e].getAttribute("data-sort-method")){c=a.tHead.rows[e];break}c||(c=a.tHead.rows[a.tHead.rows.length-1]),g.thead=!0}else c=a.rows[0];if(c){var h=function(){g.current&&g.current!==this&&g.current.removeAttribute("aria-sort"),g.current=this,g.sortTable(this)};for(e=0;e<c.cells.length;e++)f=c.cells[e],f.setAttribute("role","columnheader"),"none"!==f.getAttribute("data-sort-method")&&(f.tabindex=0,f.addEventListener("click",h,!1),null!==f.getAttribute("data-sort-default")&&(d=f));d&&(g.current=d,g.sortTable(d))}},sortTable:function(a,g){var h=this,i=a.cellIndex,j=e,k="",l=[],m=h.thead?0:1,n=a.getAttribute("data-sort-method"),o=a.getAttribute("aria-sort");if(h.table.dispatchEvent(c("beforeSort")),g||(o="ascending"===o?"descending":"descending"===o?"ascending":h.options.descending?"descending":"ascending",a.setAttribute("aria-sort",o)),!(h.table.rows.length<2)){if(!n){for(;l.length<3&&m<h.table.tBodies[0].rows.length;)k=d(h.table.tBodies[0].rows[m].cells[i]),k=k.trim(),k.length>0&&l.push(k),m++;if(!l)return}for(m=0;m<b.length;m++)if(k=b[m],n){if(k.name===n){j=k.sort;break}}else if(l.every(k.pattern)){j=k.sort;break}for(h.col=i,m=0;m<h.table.tBodies.length;m++){var p,q=[],r={},s=0,t=0;if(!(h.table.tBodies[m].rows.length<2)){for(p=0;p<h.table.tBodies[m].rows.length;p++)k=h.table.tBodies[m].rows[p],"none"===k.getAttribute("data-sort-method")?r[s]=k:q.push({tr:k,td:d(k.cells[h.col]),index:s}),s++;for("descending"===o?q.sort(f(j,!0)):(q.sort(f(j,!1)),q.reverse()),p=0;p<s;p++)r[p]?(k=r[p],t++):k=q[p-t].tr,h.table.tBodies[m].appendChild(k)}}h.table.dispatchEvent(c("afterSort"))}},refresh:function(){void 0!==this.current&&this.sortTable(this.current,!0)}},"undefined"!=typeof module&&module.exports?module.exports=a:window.Tablesort=a}();

/*!
 * tablesort v5.0.2 (2017-11-12)
 * http://tristen.ca/tablesort/demo/
 * Copyright (c) 2017 ; Licensed MIT
*/!function(){var a=function(a){return a=a.replace(/\-/g,"/"),a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3"),new Date(a).getTime()||-1};Tablesort.extend("date",function(b){return(b.search(/(Mon|Tue|Wed|Thu|Fri|Sat|Sun)\.?\,?\s*/i)!==-1||b.search(/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/)!==-1||b.search(/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)/i)!==-1)&&!isNaN(a(b))},function(b,c){return b=b.toLowerCase(),c=c.toLowerCase(),a(c)-a(b)})}();

(function(e,t){'object'==typeof exports&&'undefined'!=typeof module?module.exports=t():'function'==typeof define&&define.amd?define(t):e.tippy=t()})(this,function(){'use strict';function e(e){return e&&'[object Function]'==={}.toString.call(e)}function t(e,t){if(1!==e.nodeType)return[];var r=e.ownerDocument.defaultView,a=r.getComputedStyle(e,null);return t?a[t]:a}function r(e){return'HTML'===e.nodeName?e:e.parentNode||e.host}function a(e){if(!e)return document.body;switch(e.nodeName){case'HTML':case'BODY':return e.ownerDocument.body;case'#document':return e.body;}var p=t(e),o=p.overflow,i=p.overflowX,n=p.overflowY;return /(auto|scroll|overlay)/.test(o+n+i)?e:a(r(e))}function p(e){return 11===e?bt:10===e?yt:bt||yt}function o(e){if(!e)return document.documentElement;for(var r=p(10)?document.body:null,a=e.offsetParent||null;a===r&&e.nextElementSibling;)a=(e=e.nextElementSibling).offsetParent;var i=a&&a.nodeName;return i&&'BODY'!==i&&'HTML'!==i?-1!==['TH','TD','TABLE'].indexOf(a.nodeName)&&'static'===t(a,'position')?o(a):a:e?e.ownerDocument.documentElement:document.documentElement}function n(e){var t=e.nodeName;return'BODY'!==t&&('HTML'===t||o(e.firstElementChild)===e)}function s(e){return null===e.parentNode?e:s(e.parentNode)}function l(e,t){if(!e||!e.nodeType||!t||!t.nodeType)return document.documentElement;var r=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,a=r?e:t,p=r?t:e,i=document.createRange();i.setStart(a,0),i.setEnd(p,0);var d=i.commonAncestorContainer;if(e!==d&&t!==d||a.contains(p))return n(d)?d:o(d);var c=s(e);return c.host?l(c.host,t):l(e,s(t).host)}function d(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'top',r='top'===t?'scrollTop':'scrollLeft',a=e.nodeName;if('BODY'===a||'HTML'===a){var p=e.ownerDocument.documentElement,o=e.ownerDocument.scrollingElement||p;return o[r]}return e[r]}function c(e,t){var r=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],a=d(t,'top'),p=d(t,'left'),o=r?-1:1;return e.top+=a*o,e.bottom+=a*o,e.left+=p*o,e.right+=p*o,e}function m(e,t){var r='x'===t?'Left':'Top',a='Left'===r?'Right':'Bottom';return parseFloat(e['border'+r+'Width'],10)+parseFloat(e['border'+a+'Width'],10)}function f(e,t,r,a){return Ze(t['offset'+e],t['scroll'+e],r['client'+e],r['offset'+e],r['scroll'+e],p(10)?parseInt(r['offset'+e])+parseInt(a['margin'+('Height'===e?'Top':'Left')])+parseInt(a['margin'+('Height'===e?'Bottom':'Right')]):0)}function h(e){var t=e.body,r=e.documentElement,a=p(10)&&getComputedStyle(r);return{height:f('Height',t,r,a),width:f('Width',t,r,a)}}function b(e){return wt({},e,{right:e.left+e.width,bottom:e.top+e.height})}function u(e){var r={};try{if(p(10)){r=e.getBoundingClientRect();var a=d(e,'top'),o=d(e,'left');r.top+=a,r.left+=o,r.bottom+=a,r.right+=o}else r=e.getBoundingClientRect()}catch(t){}var i={left:r.left,top:r.top,width:r.right-r.left,height:r.bottom-r.top},n='HTML'===e.nodeName?h(e.ownerDocument):{},s=n.width||e.clientWidth||i.right-i.left,l=n.height||e.clientHeight||i.bottom-i.top,c=e.offsetWidth-s,f=e.offsetHeight-l;if(c||f){var y=t(e);c-=m(y,'x'),f-=m(y,'y'),i.width-=c,i.height-=f}return b(i)}function y(e,r){var o=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],i=p(10),n='HTML'===r.nodeName,s=u(e),l=u(r),d=a(e),m=t(r),f=parseFloat(m.borderTopWidth,10),h=parseFloat(m.borderLeftWidth,10);o&&n&&(l.top=Ze(l.top,0),l.left=Ze(l.left,0));var y=b({top:s.top-l.top-f,left:s.left-l.left-h,width:s.width,height:s.height});if(y.marginTop=0,y.marginLeft=0,!i&&n){var g=parseFloat(m.marginTop,10),x=parseFloat(m.marginLeft,10);y.top-=f-g,y.bottom-=f-g,y.left-=h-x,y.right-=h-x,y.marginTop=g,y.marginLeft=x}return(i&&!o?r.contains(d):r===d&&'BODY'!==d.nodeName)&&(y=c(y,r)),y}function g(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],r=e.ownerDocument.documentElement,a=y(e,r),p=Ze(r.clientWidth,window.innerWidth||0),o=Ze(r.clientHeight,window.innerHeight||0),i=t?0:d(r),n=t?0:d(r,'left'),s={top:i-a.top+a.marginTop,left:n-a.left+a.marginLeft,width:p,height:o};return b(s)}function x(e){var a=e.nodeName;return'BODY'!==a&&'HTML'!==a&&('fixed'===t(e,'position')||x(r(e)))}function w(e){if(!e||!e.parentElement||p())return document.documentElement;for(var r=e.parentElement;r&&'none'===t(r,'transform');)r=r.parentElement;return r||document.documentElement}function v(e,t,p,o){var i=!!(4<arguments.length&&void 0!==arguments[4])&&arguments[4],n={top:0,left:0},s=i?w(e):l(e,t);if('viewport'===o)n=g(s,i);else{var d;'scrollParent'===o?(d=a(r(t)),'BODY'===d.nodeName&&(d=e.ownerDocument.documentElement)):'window'===o?d=e.ownerDocument.documentElement:d=o;var c=y(d,s,i);if('HTML'===d.nodeName&&!x(s)){var m=h(e.ownerDocument),f=m.height,b=m.width;n.top+=c.top-c.marginTop,n.bottom=f+c.top,n.left+=c.left-c.marginLeft,n.right=b+c.left}else n=c}p=p||0;var u='number'==typeof p;return n.left+=u?p:p.left||0,n.top+=u?p:p.top||0,n.right-=u?p:p.right||0,n.bottom-=u?p:p.bottom||0,n}function k(e){var t=e.width,r=e.height;return t*r}function E(e,t,r,a,p){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf('auto'))return e;var i=v(r,a,o,p),n={top:{width:i.width,height:t.top-i.top},right:{width:i.right-t.right,height:i.height},bottom:{width:i.width,height:i.bottom-t.bottom},left:{width:t.left-i.left,height:i.height}},s=Object.keys(n).map(function(e){return wt({key:e},n[e],{area:k(n[e])})}).sort(function(e,t){return t.area-e.area}),l=s.filter(function(e){var t=e.width,a=e.height;return t>=r.clientWidth&&a>=r.clientHeight}),d=0<l.length?l[0].key:s[0].key,c=e.split('-')[1];return d+(c?'-'+c:'')}function C(e,t,r){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,p=a?w(t):l(t,r);return y(r,p,a)}function L(e){var t=e.ownerDocument.defaultView,r=t.getComputedStyle(e),a=parseFloat(r.marginTop||0)+parseFloat(r.marginBottom||0),p=parseFloat(r.marginLeft||0)+parseFloat(r.marginRight||0),o={width:e.offsetWidth+p,height:e.offsetHeight+a};return o}function O(e){var t={left:'right',right:'left',bottom:'top',top:'bottom'};return e.replace(/left|right|bottom|top/g,function(e){return t[e]})}function T(e,t,r){r=r.split('-')[0];var a=L(e),p={width:a.width,height:a.height},o=-1!==['right','left'].indexOf(r),i=o?'top':'left',n=o?'left':'top',s=o?'height':'width',l=o?'width':'height';return p[i]=t[i]+t[s]/2-a[s]/2,p[n]=r===n?t[n]-a[l]:t[O(n)],p}function S(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function A(e,t,r){if(Array.prototype.findIndex)return e.findIndex(function(e){return e[t]===r});var a=S(e,function(e){return e[t]===r});return e.indexOf(a)}function Y(t,r,a){var p=void 0===a?t:t.slice(0,A(t,'name',a));return p.forEach(function(t){t['function']&&console.warn('`modifier.function` is deprecated, use `modifier.fn`!');var a=t['function']||t.fn;t.enabled&&e(a)&&(r.offsets.popper=b(r.offsets.popper),r.offsets.reference=b(r.offsets.reference),r=a(r,t))}),r}function P(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=C(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=E(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=T(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?'fixed':'absolute',e=Y(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function D(e,t){return e.some(function(e){var r=e.name,a=e.enabled;return a&&r===t})}function X(e){for(var t=[!1,'ms','Webkit','Moz','O'],r=e.charAt(0).toUpperCase()+e.slice(1),a=0;a<t.length;a++){var p=t[a],o=p?''+p+r:e;if('undefined'!=typeof document.body.style[o])return o}return null}function I(){return this.state.isDestroyed=!0,D(this.modifiers,'applyStyle')&&(this.popper.removeAttribute('x-placement'),this.popper.style.position='',this.popper.style.top='',this.popper.style.left='',this.popper.style.right='',this.popper.style.bottom='',this.popper.style.willChange='',this.popper.style[X('transform')]=''),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function N(e){var t=e.ownerDocument;return t?t.defaultView:window}function H(e,t,r,p){var o='BODY'===e.nodeName,i=o?e.ownerDocument.defaultView:e;i.addEventListener(t,r,{passive:!0}),o||H(a(i.parentNode),t,r,p),p.push(i)}function W(e,t,r,p){r.updateBound=p,N(e).addEventListener('resize',r.updateBound,{passive:!0});var o=a(e);return H(o,'scroll',r.updateBound,r.scrollParents),r.scrollElement=o,r.eventsEnabled=!0,r}function M(){this.state.eventsEnabled||(this.state=W(this.reference,this.options,this.state,this.scheduleUpdate))}function B(e,t){return N(e).removeEventListener('resize',t.updateBound),t.scrollParents.forEach(function(e){e.removeEventListener('scroll',t.updateBound)}),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}function R(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=B(this.reference,this.state))}function z(e){return''!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function F(e,t){Object.keys(t).forEach(function(r){var a='';-1!==['width','height','top','right','bottom','left'].indexOf(r)&&z(t[r])&&(a='px'),e.style[r]=t[r]+a})}function _(e,t){Object.keys(t).forEach(function(r){var a=t[r];!1===a?e.removeAttribute(r):e.setAttribute(r,t[r])})}function U(e,t){var r=e.offsets,a=r.popper,p=r.reference,o=Qe,i=function(e){return e},n=o(a.width),s=o(p.width),l=-1!==['left','right'].indexOf(e.placement),d=-1!==e.placement.indexOf('-'),c=t?l||d||s%2==n%2?o:Je:i,m=t?o:i;return{left:c(1==s%2&&1==n%2&&!d&&t?a.left-1:a.left),top:m(a.top),bottom:m(a.bottom),right:c(a.right)}}function V(e,t,r){var a=S(e,function(e){var r=e.name;return r===t}),p=!!a&&e.some(function(e){return e.name===r&&e.enabled&&e.order<a.order});if(!p){var o='`'+t+'`';console.warn('`'+r+'`'+' modifier is required by '+o+' modifier in order to work, be sure to include it before '+o+'!')}return p}function q(e){return'end'===e?'start':'start'===e?'end':e}function j(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],r=Et.indexOf(e),a=Et.slice(r+1).concat(Et.slice(0,r));return t?a.reverse():a}function K(e,t,r,a){var p=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),o=+p[1],i=p[2];if(!o)return e;if(0===i.indexOf('%')){var n;switch(i){case'%p':n=r;break;case'%':case'%r':default:n=a;}var s=b(n);return s[t]/100*o}if('vh'===i||'vw'===i){var l;return l='vh'===i?Ze(document.documentElement.clientHeight,window.innerHeight||0):Ze(document.documentElement.clientWidth,window.innerWidth||0),l/100*o}return o}function G(e,t,r,a){var p=[0,0],o=-1!==['right','left'].indexOf(a),i=e.split(/(\+|\-)/).map(function(e){return e.trim()}),n=i.indexOf(S(i,function(e){return-1!==e.search(/,|\s/)}));i[n]&&-1===i[n].indexOf(',')&&console.warn('Offsets separated by white space(s) are deprecated, use a comma (,) instead.');var s=/\s*,\s*|\s+/,l=-1===n?[i]:[i.slice(0,n).concat([i[n].split(s)[0]]),[i[n].split(s)[1]].concat(i.slice(n+1))];return l=l.map(function(e,a){var p=(1===a?!o:o)?'height':'width',i=!1;return e.reduce(function(e,t){return''===e[e.length-1]&&-1!==['+','-'].indexOf(t)?(e[e.length-1]=t,i=!0,e):i?(e[e.length-1]+=t,i=!1,e):e.concat(t)},[]).map(function(e){return K(e,p,t,r)})}),l.forEach(function(e,t){e.forEach(function(r,a){z(r)&&(p[t]+=r*('-'===e[a-1]?-1:1))})}),p}function J(e,t){var r=t.offset,a=e.placement,p=e.offsets,o=p.popper,i=p.reference,n=a.split('-')[0],s=void 0;return s=z(+r)?[+r,0]:G(r,o,i,n),'left'===n?(o.top+=s[0],o.left-=s[1]):'right'===n?(o.top+=s[0],o.left+=s[1]):'top'===n?(o.left+=s[0],o.top-=s[1]):'bottom'===n&&(o.left+=s[0],o.top+=s[1]),e.popper=o,e}function Q(e){return[].slice.call(e)}function Z(e,t){return(Tt.closest||function(e){for(var t=this;t;){if(St.call(t,e))return t;t=t.parentElement}}).call(e,t)}function $(e,t){for(;e;){if(t(e))return e;e=e.parentElement}}function ee(){return document.createElement('div')}function te(e,t){e[Yt.x&&'innerHTML']=t instanceof Element?t[Yt.x&&'innerHTML']:t}function re(e,t){t.content instanceof Element?(te(e,''),e.appendChild(t.content)):e[t.allowHTML?'innerHTML':'textContent']=t.content}function ae(e){return{tooltip:e.querySelector(Ot.TOOLTIP),backdrop:e.querySelector(Ot.BACKDROP),content:e.querySelector(Ot.CONTENT),arrow:e.querySelector(Ot.ARROW)||e.querySelector(Ot.ROUND_ARROW)}}function pe(e){e.setAttribute('data-inertia','')}function oe(e){e.removeAttribute('data-inertia')}function ie(e){var t=ee();return'round'===e?(t.className='tippy-roundarrow',te(t,'<svg viewBox="0 0 24 8" xmlns="http://www.w3.org/2000/svg"><path d="M3 8s2.021-.015 5.253-4.218C9.584 2.051 10.797 1.007 12 1c1.203-.007 2.416 1.035 3.761 2.782C19.012 8.005 21 8 21 8H3z"/></svg>')):t.className='tippy-arrow',t}function ne(){var e=ee();return e.className='tippy-backdrop',e.setAttribute('data-state','hidden'),e}function se(e,t){e.setAttribute('tabindex','-1'),t.setAttribute('data-interactive','')}function le(e,t){e.removeAttribute('tabindex'),t.removeAttribute('data-interactive')}function de(e,t){e.forEach(function(e){e&&(e.style.transitionDuration=t+'ms')})}function ce(e,t,r){e[t+'EventListener']('transitionend',r)}function me(e){var t=e.getAttribute('x-placement');return t?t.split('-')[0]:''}function fe(e,t){e.forEach(function(e){e&&e.setAttribute('data-state',t)})}function he(e){void e.offsetHeight}function be(e,t){var r=ee();r.className='tippy-popper',r.setAttribute('role','tooltip'),r.id='tippy-'+e,r.style.zIndex=t.zIndex;var a=ee();a.className='tippy-tooltip',a.style.maxWidth=t.maxWidth+('number'==typeof t.maxWidth?'px':''),a.setAttribute('data-size',t.size),a.setAttribute('data-animation',t.animation),a.setAttribute('data-state','hidden'),t.theme.split(' ').forEach(function(e){a.classList.add(e+'-theme')});var p=ee();return p.className='tippy-content',p.setAttribute('data-state','hidden'),t.interactive&&se(r,a),t.arrow&&a.appendChild(ie(t.arrowType)),t.animateFill&&(a.appendChild(ne()),a.setAttribute('data-animatefill','')),t.inertia&&pe(a),re(p,t),a.appendChild(p),r.appendChild(a),r.addEventListener('focusout',function(t){t.relatedTarget&&r._tippy&&!$(t.relatedTarget,function(e){return e===r})&&t.relatedTarget!==r._tippy.reference&&r._tippy.props.shouldPopperHideOnBlur(t)&&r._tippy.hide()}),r}function ye(e,t,r){var a=ae(e),p=a.tooltip,o=a.content,i=a.backdrop,n=a.arrow;e.style.zIndex=r.zIndex,p.setAttribute('data-size',r.size),p.setAttribute('data-animation',r.animation),p.style.maxWidth=r.maxWidth+('number'==typeof r.maxWidth?'px':''),t.content!==r.content&&re(o,r),!t.animateFill&&r.animateFill?(p.appendChild(ne()),p.setAttribute('data-animatefill','')):t.animateFill&&!r.animateFill&&(p.removeChild(i),p.removeAttribute('data-animatefill')),!t.arrow&&r.arrow?p.appendChild(ie(r.arrowType)):t.arrow&&!r.arrow&&p.removeChild(n),t.arrow&&r.arrow&&t.arrowType!==r.arrowType&&p.replaceChild(ie(r.arrowType),n),!t.interactive&&r.interactive?se(e,p):t.interactive&&!r.interactive&&le(e,p),!t.inertia&&r.inertia?pe(p):t.inertia&&!r.inertia&&oe(p),t.theme!==r.theme&&(t.theme.split(' ').forEach(function(e){p.classList.remove(e+'-theme')}),r.theme.split(' ').forEach(function(e){p.classList.add(e+'-theme')}))}function ue(e,t){var r=e.popper,a=e.options,p=a.onCreate,o=a.onUpdate;a.onCreate=a.onUpdate=function(){he(r),t(),o(),a.onCreate=p,a.onUpdate=o}}function ge(e){Q(document.querySelectorAll(Ot.POPPER)).forEach(function(t){var r=t._tippy;r&&!0===r.props.hideOnClick&&(!e||t!==e.popper)&&r.hide()})}function xe(e,t,r,a){if(!e)return!0;var p=r.clientX,o=r.clientY,i=a.interactiveBorder,n=a.distance,s=t.top-o>('top'===e?i+n:i),l=o-t.bottom>('bottom'===e?i+n:i),d=t.left-p>('left'===e?i+n:i),c=p-t.right>('right'===e?i+n:i);return s||l||d||c}function we(e,t){return-(e-t)+'px'}function ve(e){return'[object Object]'==={}.toString.call(e)}function ke(e,t){return{}.hasOwnProperty.call(e,t)}function Ee(e){return!isNaN(e)&&!isNaN(parseFloat(e))}function Ce(e){if(e instanceof Element||ve(e))return[e];if(e instanceof NodeList)return Q(e);if(Array.isArray(e))return e;try{return Q(document.querySelectorAll(e))}catch(t){return[]}}function Le(e,t,r){if(Array.isArray(e)){var a=e[t];return null==a?r:a}return e}function Oe(e){var t=window.scrollX||window.pageXOffset,r=window.scrollY||window.pageYOffset;e.focus(),scroll(t,r)}function Te(e){setTimeout(e,1)}function Se(e,t){var r;return function(){var a=this,p=arguments;clearTimeout(r),r=setTimeout(function(){return e.apply(a,p)},t)}}function Ae(e,t){return e&&e.modifiers&&e.modifiers[t]}function Ye(e,t){return-1<e.indexOf(t)}function Pe(){Pt||(Pt=!0,it&&document.body.classList.add('tippy-iOS'),window.performance&&document.addEventListener('mousemove',De))}function De(){var e=performance.now();20>e-Dt&&(Pt=!1,document.removeEventListener('mousemove',De),!it&&document.body.classList.remove('tippy-iOS')),Dt=e}function Xe(e){var t=e.target;if(!(t instanceof Element))return ge();var r=Z(t,Ot.POPPER);if(!(r&&r._tippy&&r._tippy.props.interactive)){var a=$(t,function(e){return e._tippy&&e._tippy.reference===e});if(a){var p=a._tippy,o=Ye(p.props.trigger,'click');if(Pt||o)return ge(p);if(!0!==p.props.hideOnClick||o)return;p.clearDelayTimeouts()}ge()}}function Ie(){var e=document,t=e.activeElement;t&&t.blur&&t._tippy&&t.blur()}function Ne(){Q(document.querySelectorAll(Ot.POPPER)).forEach(function(e){var t=e._tippy;t.props.livePlacement||t.popperInstance.scheduleUpdate()})}function He(){document.addEventListener('click',Xe,!0),document.addEventListener('touchstart',Pe,At),window.addEventListener('blur',Ie),window.addEventListener('resize',Ne),!nt&&(navigator.maxTouchPoints||navigator.msMaxTouchPoints)&&document.addEventListener('pointerdown',Pe)}function We(e){return!(e instanceof Element)||St.call(e,'a[href],area[href],button,details,input,textarea,select,iframe,[tabindex]')&&!e.hasAttribute('disabled')}function Me(e){return Xt.reduce(function(t,r){var a=(e.getAttribute('data-tippy-'+r)||'').trim();return a?(t[r]='content'===r?a:'true'===a||'false'!==a&&(Ee(a)?+a:'['===a[0]||'{'===a[0]?JSON.parse(a):a),t):t},{})}function Be(e){var t={isVirtual:!0,attributes:e.attributes||{},setAttribute:function(t,r){e.attributes[t]=r},getAttribute:function(t){return e.attributes[t]},removeAttribute:function(t){delete e.attributes[t]},hasAttribute:function(t){return t in e.attributes},addEventListener:function(){},removeEventListener:function(){},classList:{classNames:{},add:function(t){e.classList.classNames[t]=!0},remove:function(t){delete e.classList.classNames[t]},contains:function(t){return t in e.classList.classNames}}};for(var r in t)e[r]=t[r]}function Re(e,t){var r=It({},t,t.performance?{}:Me(e));return r.arrow&&(r.animateFill=!1),'function'==typeof r.appendTo&&(r.appendTo=t.appendTo(e)),'function'==typeof r.content&&(r.content=t.content(e)),r}function ze(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];Object.keys(e).forEach(function(e){if(!ke(t,e))throw new Error('[tippy]: `'+e+'` is not a valid option')})}function Fe(e,t){return(t?e:{X:'Y',Y:'X'}[e])||''}function _e(e,t,r,p){var o=t[0],i=t[1];if(!o&&!i)return'';var n={scale:function(){return i?r?o+', '+i:i+', '+o:''+o}(),translate:function(){return i?r?p?o+'px, '+-i+'px':o+'px, '+i+'px':p?-i+'px, '+o+'px':i+'px, '+o+'px':p?-o+'px':o+'px'}()};return n[e]}function Ue(e,t){var r=e.match(new RegExp(t+'([XY])'));return r?r[1]:''}function Ve(e,t){var r=e.match(t);return r?r[1].split(',').map(function(e){return parseFloat(e,10)}):[]}function qe(e,t){var r=me(Z(e,Ot.POPPER)),a=Ye(['top','bottom'],r),p=Ye(['right','bottom'],r),o={translate:{axis:Ue(t,'translate'),numbers:Ve(t,Nt.translate)},scale:{axis:Ue(t,'scale'),numbers:Ve(t,Nt.scale)}},i=t.replace(Nt.translate,'translate'+Fe(o.translate.axis,a)+'('+_e('translate',o.translate.numbers,a,p)+')').replace(Nt.scale,'scale'+Fe(o.scale.axis,a)+'('+_e('scale',o.scale.numbers,a,p)+')');e.style['undefined'==typeof document.body.style.transform?'webkitTransform':'transform']=i}function je(e,t){function r(){Te(function(){z=!1})}function a(){X=new MutationObserver(function(){q.popperInstance.update()}),X.observe(U,{childList:!0,subtree:!0,characterData:!0})}function p(e){var t=N=e,r=t.clientX,a=t.clientY;if(q.popperInstance){var p=me(q.popper),o=q.popperChildren.arrow?20:5,i=Ye(['top','bottom'],p),n=Ye(['left','right'],p),l=i?Ze(o,r):r,d=n?Ze(o,a):a;i&&l>o&&(l=Ge(r,window.innerWidth-o)),n&&d>o&&(d=Ge(a,window.innerHeight-o));var c=q.reference.getBoundingClientRect(),m=q.props.followCursor,f='horizontal'===m,h='vertical'===m;q.popperInstance.reference={getBoundingClientRect:function(){return{width:0,height:0,top:f?c.top:d,bottom:f?c.bottom:d,left:h?c.left:l,right:h?c.right:l}},clientWidth:0,clientHeight:0},q.popperInstance.scheduleUpdate(),'initial'===m&&q.state.isVisible&&s()}}function o(e){var t=Z(e.target,q.props.target);t&&!t._tippy&&(je(t,It({},q.props,{target:'',showOnInit:!0})),i(e))}function i(e){if(T(),!q.state.isVisible){if(q.props.target)return o(e);if(M=!0,q.props.wait)return q.props.wait(q,e);x()&&!q.state.isMounted&&document.addEventListener('mousemove',p);var t=Le(q.props.delay,0,st.delay);t?H=setTimeout(function(){A()},t):A()}}function n(){if(T(),!q.state.isVisible)return s();M=!1;var e=Le(q.props.delay,1,st.delay);e?W=setTimeout(function(){q.state.isVisible&&Y()},e):Y()}function s(){document.removeEventListener('mousemove',p),N=null}function l(){document.body.removeEventListener('mouseleave',n),document.removeEventListener('mousemove',F)}function d(e){!q.state.isEnabled||y(e)||(!q.state.isVisible&&(I=e),'click'===e.type&&!1!==q.props.hideOnClick&&q.state.isVisible?n():i(e))}function c(e){var t=$(e.target,function(e){return e._tippy}),r=Z(e.target,Ot.POPPER)===q.popper,a=t===q.reference;r||a||xe(me(q.popper),q.popper.getBoundingClientRect(),e,q.props)&&(l(),n())}function m(e){return y(e)?void 0:q.props.interactive?(document.body.addEventListener('mouseleave',n),void document.addEventListener('mousemove',F)):void n()}function f(e){if(e.target===q.reference){if(q.props.interactive){if(!e.relatedTarget)return;if(Z(e.relatedTarget,Ot.POPPER))return}n()}}function h(e){Z(e.target,q.props.target)&&i(e)}function b(e){Z(e.target,q.props.target)&&n()}function y(e){var t=Ye(e.type,'touch'),r=nt&&Pt&&q.props.touchHold&&!t,a=Pt&&!q.props.touchHold&&t;return r||a}function u(){var e=q.props.popperOptions,t=q.popperChildren,r=t.tooltip,a=t.arrow;return new Lt(q.reference,q.popper,It({placement:q.props.placement},e,{modifiers:It({},e?e.modifiers:{},{preventOverflow:It({boundariesElement:q.props.boundary},Ae(e,'preventOverflow')),arrow:It({element:a,enabled:!!a},Ae(e,'arrow')),flip:It({enabled:q.props.flip,padding:q.props.distance+5,behavior:q.props.flipBehavior},Ae(e,'flip')),offset:It({offset:q.props.offset},Ae(e,'offset'))}),onCreate:function(){r.style[me(q.popper)]=we(q.props.distance,st.distance),a&&q.props.arrowTransform&&qe(a,q.props.arrowTransform)},onUpdate:function(){var e=r.style;e.top='',e.bottom='',e.left='',e.right='',e[me(q.popper)]=we(q.props.distance,st.distance),a&&q.props.arrowTransform&&qe(a,q.props.arrowTransform)}}))}function g(e){q.popperInstance?!x()&&(q.popperInstance.scheduleUpdate(),q.props.livePlacement&&q.popperInstance.enableEventListeners()):(q.popperInstance=u(),a(),(!q.props.livePlacement||x())&&q.popperInstance.disableEventListeners()),q.popperInstance.reference=q.reference;var t=q.popperChildren.arrow;if(x()){t&&(t.style.margin='0');var r=Le(q.props.delay,0,st.delay);I.type&&p(r&&N?N:I)}else t&&(t.style.margin='');ue(q.popperInstance,e),q.props.appendTo.contains(q.popper)||(q.props.appendTo.appendChild(q.popper),q.props.onMount(q),q.state.isMounted=!0)}function x(){return q.props.followCursor&&!Pt&&'focus'!==I.type}function w(){de([q.popper],ot?0:q.props.updateDuration);(function e(){q.popperInstance&&q.popperInstance.scheduleUpdate(),q.state.isMounted?requestAnimationFrame(e):de([q.popper],0)})()}function v(e,t){E(e,function(){!q.state.isVisible&&q.props.appendTo.contains(q.popper)&&t()})}function k(e,t){E(e,t)}function E(e,t){if(0===e)return t();var r=q.popperChildren.tooltip,a=function a(p){p.target===r&&(ce(r,'remove',a),t())};ce(r,'remove',B),ce(r,'add',a),B=a}function C(e,t){var r=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];q.reference.addEventListener(e,t,r),R.push({eventType:e,handler:t,options:r})}function L(){q.props.touchHold&&!q.props.target&&(C('touchstart',d,At),C('touchend',m,At)),q.props.trigger.trim().split(' ').forEach(function(e){'manual'===e||(q.props.target?'mouseenter'===e?(C('mouseover',h),C('mouseout',b)):'focus'===e?(C('focusin',h),C('focusout',b)):'click'===e?C(e,h):void 0:(C(e,d),'mouseenter'===e?C('mouseleave',m):'focus'===e?C(ot?'focusout':'blur',f):void 0))})}function O(){R.forEach(function(e){var t=e.eventType,r=e.handler,a=e.options;q.reference.removeEventListener(t,r,a)}),R=[]}function T(){clearTimeout(H),clearTimeout(W)}function S(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};ze(e,st);var t=q.props,r=Re(q.reference,It({},q.props,e,{performance:!0}));r.performance=ke(e,'performance')?e.performance:t.performance,q.props=r,(ke(e,'trigger')||ke(e,'touchHold'))&&(O(),L()),ke(e,'interactiveDebounce')&&(l(),F=Se(c,e.interactiveDebounce)),ye(q.popper,t,r),q.popperChildren=ae(q.popper),q.popperInstance&&lt.some(function(t){return ke(e,t)})&&(q.popperInstance.destroy(),q.popperInstance=u(),!q.state.isVisible&&q.popperInstance.disableEventListeners(),q.props.followCursor&&N&&p(N))}function A(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Le(q.props.duration,0,st.duration[0]);return q.state.isDestroyed||!q.state.isEnabled||Pt&&!q.props.touch?void 0:q.reference.isVirtual||document.documentElement.contains(q.reference)?q.reference.hasAttribute('disabled')?void 0:z?void(z=!1):void(!1===q.props.onShow(q)||(q.popper.style.visibility='visible',q.state.isVisible=!0,de([q.popper,q.popperChildren.tooltip,q.popperChildren.backdrop],0),g(function(){q.state.isVisible&&(!x()&&q.popperInstance.update(),de([q.popperChildren.tooltip,q.popperChildren.backdrop,q.popperChildren.content],e),q.popperChildren.backdrop&&(q.popperChildren.content.style.transitionDelay=Qe(e/6)+'ms'),q.props.interactive&&q.reference.classList.add('tippy-active'),q.props.sticky&&w(),fe([q.popperChildren.tooltip,q.popperChildren.backdrop,q.popperChildren.content],'visible'),k(e,function(){0===q.props.updateDuration&&q.popperChildren.tooltip.classList.add('tippy-notransition'),q.props.autoFocus&&q.props.interactive&&Ye(['focus','click'],I.type)&&Oe(q.popper),q.props.aria&&q.reference.setAttribute('aria-'+q.props.aria,q.popper.id),q.props.onShown(q),q.state.isShown=!0}))}))):P()}function Y(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Le(q.props.duration,1,st.duration[1]);q.state.isDestroyed||!q.state.isEnabled||!1===q.props.onHide(q)||(0===q.props.updateDuration&&q.popperChildren.tooltip.classList.remove('tippy-notransition'),q.props.interactive&&q.reference.classList.remove('tippy-active'),q.popper.style.visibility='hidden',q.state.isVisible=!1,q.state.isShown=!1,de([q.popperChildren.tooltip,q.popperChildren.backdrop,q.popperChildren.content],e),fe([q.popperChildren.tooltip,q.popperChildren.backdrop,q.popperChildren.content],'hidden'),q.props.autoFocus&&q.props.interactive&&!z&&Ye(['focus','click'],I.type)&&('focus'===I.type&&(z=!0),Oe(q.reference)),v(e,function(){M||s(),q.props.aria&&q.reference.removeAttribute('aria-'+q.props.aria),q.popperInstance.disableEventListeners(),q.props.appendTo.removeChild(q.popper),q.state.isMounted=!1,q.props.onHidden(q)}))}function P(e){q.state.isDestroyed||(q.state.isMounted&&Y(0),O(),q.reference.removeEventListener('click',r),delete q.reference._tippy,q.props.target&&e&&Q(q.reference.querySelectorAll(q.props.target)).forEach(function(e){return e._tippy&&e._tippy.destroy()}),q.popperInstance&&q.popperInstance.destroy(),X&&X.disconnect(),q.state.isDestroyed=!0)}var D=Re(e,t);if(!D.multiple&&e._tippy)return null;var X=null,I={},N=null,H=0,W=0,M=!1,B=function(){},R=[],z=!1,F=0<D.interactiveDebounce?Se(c,D.interactiveDebounce):c,_=Ht++,U=be(_,D);U.addEventListener('mouseenter',function(e){q.props.interactive&&q.state.isVisible&&'mouseenter'===I.type&&i(e)}),U.addEventListener('mouseleave',function(e){q.props.interactive&&'mouseenter'===I.type&&0===q.props.interactiveDebounce&&xe(me(U),U.getBoundingClientRect(),e,q.props)&&n()});var V=ae(U),q={id:_,reference:e,popper:U,popperChildren:V,popperInstance:null,props:D,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},clearDelayTimeouts:T,set:S,setContent:function(e){S({content:e})},show:A,hide:Y,enable:function(){q.state.isEnabled=!0},disable:function(){q.state.isEnabled=!1},destroy:P};return L(),e.addEventListener('click',r),D.lazy||(q.popperInstance=u(),q.popperInstance.disableEventListeners()),D.showOnInit&&i(),!D.a11y||D.target||We(e)||e.setAttribute('tabindex','0'),e._tippy=q,U._tippy=q,q}function Ke(e,t,r){ze(t,st),Wt||(He(),Wt=!0);var a=It({},st,t);ve(e)&&Be(e);var p=Ce(e),o=p[0],i=(r&&o?[o]:p).reduce(function(e,t){var r=t&&je(t,a);return r&&e.push(r),e},[]),n={targets:e,props:a,instances:i,destroyAll:function(){n.instances.forEach(function(e){e.destroy()}),n.instances=[]}};return n}for(var Ge=Math.min,Je=Math.floor,Qe=Math.round,Ze=Math.max,$e='.tippy-iOS{cursor:pointer!important}.tippy-notransition{transition:none!important}.tippy-popper{-webkit-perspective:700px;perspective:700px;z-index:9999;outline:0;transition-timing-function:cubic-bezier(.165,.84,.44,1);pointer-events:none;line-height:1.4;max-width:calc(100% - 10px)}.tippy-popper[x-placement^=top] .tippy-backdrop{border-radius:40% 40% 0 0}.tippy-popper[x-placement^=top] .tippy-roundarrow{bottom:-8px;-webkit-transform-origin:50% 0;transform-origin:50% 0}.tippy-popper[x-placement^=top] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(180deg);transform:rotate(180deg)}.tippy-popper[x-placement^=top] .tippy-arrow{border-top:8px solid #333;border-right:8px solid transparent;border-left:8px solid transparent;bottom:-7px;margin:0 6px;-webkit-transform-origin:50% 0;transform-origin:50% 0}.tippy-popper[x-placement^=top] .tippy-backdrop{-webkit-transform-origin:0 25%;transform-origin:0 25%}.tippy-popper[x-placement^=top] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-55%);transform:scale(1) translate(-50%,-55%)}.tippy-popper[x-placement^=top] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-50%,-45%);transform:scale(.2) translate(-50%,-45%);opacity:0}.tippy-popper[x-placement^=top] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateY(-20px);transform:translateY(-20px)}.tippy-popper[x-placement^=top] [data-animation=perspective]{-webkit-transform-origin:bottom;transform-origin:bottom}.tippy-popper[x-placement^=top] [data-animation=perspective][data-state=visible]{-webkit-transform:translateY(-10px) rotateX(0);transform:translateY(-10px) rotateX(0)}.tippy-popper[x-placement^=top] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) rotateX(60deg);transform:translateY(0) rotateX(60deg)}.tippy-popper[x-placement^=top] [data-animation=fade][data-state=visible]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-popper[x-placement^=top] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateY(0);transform:translateY(0)}.tippy-popper[x-placement^=top] [data-animation=scale][data-state=visible]{-webkit-transform:translateY(-10px) scale(1);transform:translateY(-10px) scale(1)}.tippy-popper[x-placement^=top] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) scale(.5);transform:translateY(0) scale(.5)}.tippy-popper[x-placement^=bottom] .tippy-backdrop{border-radius:0 0 30% 30%}.tippy-popper[x-placement^=bottom] .tippy-roundarrow{top:-8px;-webkit-transform-origin:50% 100%;transform-origin:50% 100%}.tippy-popper[x-placement^=bottom] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(0);transform:rotate(0)}.tippy-popper[x-placement^=bottom] .tippy-arrow{border-bottom:8px solid #333;border-right:8px solid transparent;border-left:8px solid transparent;top:-7px;margin:0 6px;-webkit-transform-origin:50% 100%;transform-origin:50% 100%}.tippy-popper[x-placement^=bottom] .tippy-backdrop{-webkit-transform-origin:0 -50%;transform-origin:0 -50%}.tippy-popper[x-placement^=bottom] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-45%);transform:scale(1) translate(-50%,-45%)}.tippy-popper[x-placement^=bottom] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-50%);transform:scale(.2) translate(-50%);opacity:0}.tippy-popper[x-placement^=bottom] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateY(20px);transform:translateY(20px)}.tippy-popper[x-placement^=bottom] [data-animation=perspective]{-webkit-transform-origin:top;transform-origin:top}.tippy-popper[x-placement^=bottom] [data-animation=perspective][data-state=visible]{-webkit-transform:translateY(10px) rotateX(0);transform:translateY(10px) rotateX(0)}.tippy-popper[x-placement^=bottom] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) rotateX(-60deg);transform:translateY(0) rotateX(-60deg)}.tippy-popper[x-placement^=bottom] [data-animation=fade][data-state=visible]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-popper[x-placement^=bottom] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateY(0);transform:translateY(0)}.tippy-popper[x-placement^=bottom] [data-animation=scale][data-state=visible]{-webkit-transform:translateY(10px) scale(1);transform:translateY(10px) scale(1)}.tippy-popper[x-placement^=bottom] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateY(0) scale(.5);transform:translateY(0) scale(.5)}.tippy-popper[x-placement^=left] .tippy-backdrop{border-radius:50% 0 0 50%}.tippy-popper[x-placement^=left] .tippy-roundarrow{right:-16px;-webkit-transform-origin:33.33333333% 50%;transform-origin:33.33333333% 50%}.tippy-popper[x-placement^=left] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.tippy-popper[x-placement^=left] .tippy-arrow{border-left:8px solid #333;border-top:8px solid transparent;border-bottom:8px solid transparent;right:-7px;margin:3px 0;-webkit-transform-origin:0 50%;transform-origin:0 50%}.tippy-popper[x-placement^=left] .tippy-backdrop{-webkit-transform-origin:50% 0;transform-origin:50% 0}.tippy-popper[x-placement^=left] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-50%);transform:scale(1) translate(-50%,-50%)}.tippy-popper[x-placement^=left] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-75%,-50%);transform:scale(.2) translate(-75%,-50%);opacity:0}.tippy-popper[x-placement^=left] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateX(-20px);transform:translateX(-20px)}.tippy-popper[x-placement^=left] [data-animation=perspective]{-webkit-transform-origin:right;transform-origin:right}.tippy-popper[x-placement^=left] [data-animation=perspective][data-state=visible]{-webkit-transform:translateX(-10px) rotateY(0);transform:translateX(-10px) rotateY(0)}.tippy-popper[x-placement^=left] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) rotateY(-60deg);transform:translateX(0) rotateY(-60deg)}.tippy-popper[x-placement^=left] [data-animation=fade][data-state=visible]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.tippy-popper[x-placement^=left] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateX(0);transform:translateX(0)}.tippy-popper[x-placement^=left] [data-animation=scale][data-state=visible]{-webkit-transform:translateX(-10px) scale(1);transform:translateX(-10px) scale(1)}.tippy-popper[x-placement^=left] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) scale(.5);transform:translateX(0) scale(.5)}.tippy-popper[x-placement^=right] .tippy-backdrop{border-radius:0 50% 50% 0}.tippy-popper[x-placement^=right] .tippy-roundarrow{left:-16px;-webkit-transform-origin:66.66666666% 50%;transform-origin:66.66666666% 50%}.tippy-popper[x-placement^=right] .tippy-roundarrow svg{position:absolute;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.tippy-popper[x-placement^=right] .tippy-arrow{border-right:8px solid #333;border-top:8px solid transparent;border-bottom:8px solid transparent;left:-7px;margin:3px 0;-webkit-transform-origin:100% 50%;transform-origin:100% 50%}.tippy-popper[x-placement^=right] .tippy-backdrop{-webkit-transform-origin:-50% 0;transform-origin:-50% 0}.tippy-popper[x-placement^=right] .tippy-backdrop[data-state=visible]{-webkit-transform:scale(1) translate(-50%,-50%);transform:scale(1) translate(-50%,-50%)}.tippy-popper[x-placement^=right] .tippy-backdrop[data-state=hidden]{-webkit-transform:scale(.2) translate(-25%,-50%);transform:scale(.2) translate(-25%,-50%);opacity:0}.tippy-popper[x-placement^=right] [data-animation=shift-toward][data-state=visible]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-toward][data-state=hidden]{opacity:0;-webkit-transform:translateX(20px);transform:translateX(20px)}.tippy-popper[x-placement^=right] [data-animation=perspective]{-webkit-transform-origin:left;transform-origin:left}.tippy-popper[x-placement^=right] [data-animation=perspective][data-state=visible]{-webkit-transform:translateX(10px) rotateY(0);transform:translateX(10px) rotateY(0)}.tippy-popper[x-placement^=right] [data-animation=perspective][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) rotateY(60deg);transform:translateX(0) rotateY(60deg)}.tippy-popper[x-placement^=right] [data-animation=fade][data-state=visible]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=fade][data-state=hidden]{opacity:0;-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-away][data-state=visible]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-popper[x-placement^=right] [data-animation=shift-away][data-state=hidden]{opacity:0;-webkit-transform:translateX(0);transform:translateX(0)}.tippy-popper[x-placement^=right] [data-animation=scale][data-state=visible]{-webkit-transform:translateX(10px) scale(1);transform:translateX(10px) scale(1)}.tippy-popper[x-placement^=right] [data-animation=scale][data-state=hidden]{opacity:0;-webkit-transform:translateX(0) scale(.5);transform:translateX(0) scale(.5)}.tippy-tooltip{position:relative;color:#fff;border-radius:4px;font-size:.9rem;padding:.3rem .6rem;max-width:350px;text-align:center;will-change:transform;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:#333}.tippy-tooltip[data-size=small]{padding:.2rem .4rem;font-size:.75rem}.tippy-tooltip[data-size=large]{padding:.4rem .8rem;font-size:1rem}.tippy-tooltip[data-animatefill]{overflow:hidden;background-color:transparent}.tippy-tooltip[data-interactive],.tippy-tooltip[data-interactive] path{pointer-events:auto}.tippy-tooltip[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-tooltip[data-inertia][data-state=hidden]{transition-timing-function:ease}.tippy-arrow,.tippy-roundarrow{position:absolute;width:0;height:0}.tippy-roundarrow{width:24px;height:8px;fill:#333;pointer-events:none}.tippy-backdrop{position:absolute;will-change:transform;background-color:#333;border-radius:50%;width:calc(110% + 2rem);left:50%;top:50%;z-index:-1;transition:all cubic-bezier(.46,.1,.52,.98);-webkit-backface-visibility:hidden;backface-visibility:hidden}.tippy-backdrop:after{content:"";float:left;padding-top:100%}.tippy-backdrop+.tippy-content{transition-property:opacity;will-change:opacity}.tippy-backdrop+.tippy-content[data-state=visible]{opacity:1}.tippy-backdrop+.tippy-content[data-state=hidden]{opacity:0}',et='3.4.1',tt='undefined'!=typeof window,rt=tt?navigator:{},at=tt?window:{},pt=('MutationObserver'in at),ot=/MSIE |Trident\//.test(rt.userAgent),it=/iPhone|iPad|iPod/.test(rt.platform)&&!at.MSStream,nt=('ontouchstart'in at),st={a11y:!0,allowHTML:!0,animateFill:!0,animation:'shift-away',appendTo:function(){return document.body},aria:'describedby',arrow:!1,arrowTransform:'',arrowType:'sharp',autoFocus:!0,boundary:'scrollParent',content:'',delay:[0,20],distance:10,duration:[325,275],flip:!0,flipBehavior:'flip',followCursor:!1,hideOnClick:!0,inertia:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,lazy:!0,livePlacement:!0,maxWidth:'',multiple:!1,offset:0,onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},performance:!1,placement:'top',popperOptions:{},shouldPopperHideOnBlur:function(){return!0},showOnInit:!1,size:'regular',sticky:!1,target:'',theme:'dark',touch:!0,touchHold:!1,trigger:'mouseenter focus',updateDuration:200,wait:null,zIndex:9999},lt=['arrow','arrowType','distance','flip','flipBehavior','offset','placement','popperOptions'],dt='undefined'!=typeof window&&'undefined'!=typeof document,ct=['Edge','Trident','Firefox'],mt=0,ft=0;ft<ct.length;ft+=1)if(dt&&0<=navigator.userAgent.indexOf(ct[ft])){mt=1;break}var i=dt&&window.Promise,ht=i?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then(function(){t=!1,e()}))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},mt))}},bt=dt&&!!(window.MSInputMethodContext&&document.documentMode),yt=dt&&/MSIE 10/.test(navigator.userAgent),ut=function(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')},gt=function(){function e(e,t){for(var r,a=0;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,'value'in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),xt=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},wt=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var a in t=arguments[r],t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},vt=dt&&/Firefox/i.test(navigator.userAgent),kt=['auto-start','auto','auto-end','top-start','top','top-end','right-start','right','right-end','bottom-end','bottom','bottom-start','left-end','left','left-start'],Et=kt.slice(3),Ct={FLIP:'flip',CLOCKWISE:'clockwise',COUNTERCLOCKWISE:'counterclockwise'},Lt=function(){function t(r,a){var p=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};ut(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(p.update)},this.update=ht(this.update.bind(this)),this.options=wt({},t.Defaults,o),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=r&&r.jquery?r[0]:r,this.popper=a&&a.jquery?a[0]:a,this.options.modifiers={},Object.keys(wt({},t.Defaults.modifiers,o.modifiers)).forEach(function(e){p.options.modifiers[e]=wt({},t.Defaults.modifiers[e]||{},o.modifiers?o.modifiers[e]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(e){return wt({name:e},p.options.modifiers[e])}).sort(function(e,t){return e.order-t.order}),this.modifiers.forEach(function(t){t.enabled&&e(t.onLoad)&&t.onLoad(p.reference,p.popper,p.options,t,p.state)}),this.update();var i=this.options.eventsEnabled;i&&this.enableEventListeners(),this.state.eventsEnabled=i}return gt(t,[{key:'update',value:function(){return P.call(this)}},{key:'destroy',value:function(){return I.call(this)}},{key:'enableEventListeners',value:function(){return M.call(this)}},{key:'disableEventListeners',value:function(){return R.call(this)}}]),t}();Lt.Utils=('undefined'==typeof window?global:window).PopperUtils,Lt.placements=kt,Lt.Defaults={placement:'bottom',positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,r=t.split('-')[0],a=t.split('-')[1];if(a){var p=e.offsets,o=p.reference,i=p.popper,n=-1!==['bottom','top'].indexOf(r),s=n?'left':'top',l=n?'width':'height',d={start:xt({},s,o[s]),end:xt({},s,o[s]+o[l]-i[l])};e.offsets.popper=wt({},i,d[a])}return e}},offset:{order:200,enabled:!0,fn:J,offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var r=t.boundariesElement||o(e.instance.popper);e.instance.reference===r&&(r=o(r));var a=X('transform'),p=e.instance.popper.style,i=p.top,n=p.left,s=p[a];p.top='',p.left='',p[a]='';var l=v(e.instance.popper,e.instance.reference,t.padding,r,e.positionFixed);p.top=i,p.left=n,p[a]=s,t.boundaries=l;var d=t.priority,c=e.offsets.popper,m={primary:function(e){var r=c[e];return c[e]<l[e]&&!t.escapeWithReference&&(r=Ze(c[e],l[e])),xt({},e,r)},secondary:function(e){var r='right'===e?'left':'top',a=c[r];return c[e]>l[e]&&!t.escapeWithReference&&(a=Ge(c[r],l[e]-('right'===e?c.width:c.height))),xt({},r,a)}};return d.forEach(function(e){var t=-1===['left','top'].indexOf(e)?'secondary':'primary';c=wt({},c,m[t](e))}),e.offsets.popper=c,e},priority:['left','right','top','bottom'],padding:5,boundariesElement:'scrollParent'},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,r=t.popper,a=t.reference,p=e.placement.split('-')[0],o=Je,i=-1!==['top','bottom'].indexOf(p),n=i?'right':'bottom',s=i?'left':'top',l=i?'width':'height';return r[n]<o(a[s])&&(e.offsets.popper[s]=o(a[s])-r[l]),r[s]>o(a[n])&&(e.offsets.popper[s]=o(a[n])),e}},arrow:{order:500,enabled:!0,fn:function(e,r){var a;if(!V(e.instance.modifiers,'arrow','keepTogether'))return e;var p=r.element;if('string'==typeof p){if(p=e.instance.popper.querySelector(p),!p)return e;}else if(!e.instance.popper.contains(p))return console.warn('WARNING: `arrow.element` must be child of its popper element!'),e;var o=e.placement.split('-')[0],i=e.offsets,n=i.popper,s=i.reference,l=-1!==['left','right'].indexOf(o),d=l?'height':'width',c=l?'Top':'Left',m=c.toLowerCase(),f=l?'left':'top',h=l?'bottom':'right',y=L(p)[d];s[h]-y<n[m]&&(e.offsets.popper[m]-=n[m]-(s[h]-y)),s[m]+y>n[h]&&(e.offsets.popper[m]+=s[m]+y-n[h]),e.offsets.popper=b(e.offsets.popper);var u=s[m]+s[d]/2-y/2,g=t(e.instance.popper),x=parseFloat(g['margin'+c],10),w=parseFloat(g['border'+c+'Width'],10),v=u-e.offsets.popper[m]-x-w;return v=Ze(Ge(n[d]-y,v),0),e.arrowElement=p,e.offsets.arrow=(a={},xt(a,m,Qe(v)),xt(a,f,''),a),e},element:'[x-arrow]'},flip:{order:600,enabled:!0,fn:function(e,t){if(D(e.instance.modifiers,'inner'))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var r=v(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),a=e.placement.split('-')[0],p=O(a),o=e.placement.split('-')[1]||'',i=[];switch(t.behavior){case Ct.FLIP:i=[a,p];break;case Ct.CLOCKWISE:i=j(a);break;case Ct.COUNTERCLOCKWISE:i=j(a,!0);break;default:i=t.behavior;}return i.forEach(function(n,s){if(a!==n||i.length===s+1)return e;a=e.placement.split('-')[0],p=O(a);var l=e.offsets.popper,d=e.offsets.reference,c=Je,m='left'===a&&c(l.right)>c(d.left)||'right'===a&&c(l.left)<c(d.right)||'top'===a&&c(l.bottom)>c(d.top)||'bottom'===a&&c(l.top)<c(d.bottom),f=c(l.left)<c(r.left),h=c(l.right)>c(r.right),b=c(l.top)<c(r.top),y=c(l.bottom)>c(r.bottom),u='left'===a&&f||'right'===a&&h||'top'===a&&b||'bottom'===a&&y,g=-1!==['top','bottom'].indexOf(a),x=!!t.flipVariations&&(g&&'start'===o&&f||g&&'end'===o&&h||!g&&'start'===o&&b||!g&&'end'===o&&y);(m||u||x)&&(e.flipped=!0,(m||u)&&(a=i[s+1]),x&&(o=q(o)),e.placement=a+(o?'-'+o:''),e.offsets.popper=wt({},e.offsets.popper,T(e.instance.popper,e.offsets.reference,e.placement)),e=Y(e.instance.modifiers,e,'flip'))}),e},behavior:'flip',padding:5,boundariesElement:'viewport'},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,r=t.split('-')[0],a=e.offsets,p=a.popper,o=a.reference,i=-1!==['left','right'].indexOf(r),n=-1===['top','left'].indexOf(r);return p[i?'left':'top']=o[r]-(n?p[i?'width':'height']:0),e.placement=O(t),e.offsets.popper=b(p),e}},hide:{order:800,enabled:!0,fn:function(e){if(!V(e.instance.modifiers,'hide','preventOverflow'))return e;var t=e.offsets.reference,r=S(e.instance.modifiers,function(e){return'preventOverflow'===e.name}).boundaries;if(t.bottom<r.top||t.left>r.right||t.top>r.bottom||t.right<r.left){if(!0===e.hide)return e;e.hide=!0,e.attributes['x-out-of-boundaries']=''}else{if(!1===e.hide)return e;e.hide=!1,e.attributes['x-out-of-boundaries']=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var r=t.x,a=t.y,p=e.offsets.popper,i=S(e.instance.modifiers,function(e){return'applyStyle'===e.name}).gpuAcceleration;void 0!==i&&console.warn('WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!');var n=void 0===i?t.gpuAcceleration:i,s=o(e.instance.popper),l=u(s),d={position:p.position},c=U(e,2>window.devicePixelRatio||!vt),m='bottom'===r?'top':'bottom',f='right'===a?'left':'right',h=X('transform'),b=void 0,y=void 0;if(y='bottom'==m?'HTML'===s.nodeName?-s.clientHeight+c.bottom:-l.height+c.bottom:c.top,b='right'==f?'HTML'===s.nodeName?-s.clientWidth+c.right:-l.width+c.right:c.left,n&&h)d[h]='translate3d('+b+'px, '+y+'px, 0)',d[m]=0,d[f]=0,d.willChange='transform';else{var g='bottom'==m?-1:1,x='right'==f?-1:1;d[m]=y*g,d[f]=b*x,d.willChange=m+', '+f}var w={"x-placement":e.placement};return e.attributes=wt({},w,e.attributes),e.styles=wt({},d,e.styles),e.arrowStyles=wt({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:'bottom',y:'right'},applyStyle:{order:900,enabled:!0,fn:function(e){return F(e.instance.popper,e.styles),_(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&F(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,r,a,p){var o=C(p,t,e,r.positionFixed),i=E(r.placement,o,t,e,r.modifiers.flip.boundariesElement,r.modifiers.flip.padding);return t.setAttribute('x-placement',i),F(t,{position:r.positionFixed?'fixed':'absolute'}),r},gpuAcceleration:void 0}}};var Ot={POPPER:'.tippy-popper',TOOLTIP:'.tippy-tooltip',CONTENT:'.tippy-content',BACKDROP:'.tippy-backdrop',ARROW:'.tippy-arrow',ROUND_ARROW:'.tippy-roundarrow'},Tt=tt?Element.prototype:{},St=Tt.matches||Tt.matchesSelector||Tt.webkitMatchesSelector||Tt.mozMatchesSelector||Tt.msMatchesSelector,At={passive:!0},Yt={x:!0},Pt=!1,Dt=0,Xt=Object.keys(st),It=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var a in t=arguments[r],t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Nt={translate:/translateX?Y?\(([^)]+)\)/,scale:/scaleX?Y?\(([^)]+)\)/},Ht=1,Wt=!1;Ke.version=et,Ke.defaults=st,Ke.one=function(e,t){return Ke(e,t,!0).instances[0]},Ke.setDefaults=function(e){Object.keys(e).forEach(function(t){st[t]=e[t]})},Ke.disableAnimations=function(){Ke.setDefaults({duration:0,updateDuration:0,animateFill:!1})},Ke.hideAllPoppers=ge,Ke.useCapture=function(){};return tt&&setTimeout(function(){Q(document.querySelectorAll('[data-tippy]')).forEach(function(e){var t=e.getAttribute('data-tippy');t&&Ke(e,{content:t})})}),function(e){if(pt){var t=document.createElement('style');t.type='text/css',t.textContent=e,document.head.insertBefore(t,document.head.firstChild)}}($e),Ke});
//# sourceMappingURL=tippy.all.min.js.map

/**
 * Bs Input Validate (anchor)
 */
var BsActivationCodeValidate = (function () {
  // Elements
  var elements = {};
  var $ = elements;

  $.forms = document.querySelectorAll('.bs-js-validate');

  if (!$.forms.length) return;

  // Config
  var config = {
    validate: {
      token: function (input) {
        return input.value === input.getAttribute('data-test-validation');
      },
      cpf: function (input) {
        return input.value.replace(/[^0-9]/g, '') === input.getAttribute('data-test-validation');
      },
      success: function (form) {
        var inputs = form.querySelectorAll('input');
        var formSenha = document.querySelector('.bs-js-form-acesso-criar-senha');
        var formSenhaInputs = formSenha.querySelectorAll('input');
        var tokenErrorMessage = document.querySelector('.bs-js-form-acesso-token-message');

        form.classList.add('bs-is-valid');

        Array.prototype.forEach.call(inputs, function (input) {
          input.setAttribute('disabled', 'disabled');
          form.querySelector('button[type="submit"]').setAttribute('disabled', 'disabled');
        });

        tokenErrorMessage.classList.add('bs-is-hidden');
        formSenha.classList.remove('bs-is-hidden');
        formSenhaInputs[0].focus();
      },
      error: function (form) {
        var inputs = form.querySelectorAll('input');
        var formSenha = document.querySelector('.bs-js-form-acesso-criar-senha');
        var tokenErrorMessage = document.querySelector('.bs-js-form-acesso-token-message');

        tokenErrorMessage.classList.remove('bs-is-hidden');
        formSenha.classList.add('bs-is-hidden');

        inputs[0].focus();
      },
    },
    validateOnInput: true,
    cleanOnInput: true,
  };

  var init = function () {
    Array.prototype.forEach.call($.forms, function (form) {
      var inputs = form.querySelectorAll('input');
      if (inputs.length === 1) {
        inputs[0].addEventListener('input', validateForm.bind(null, form));
      }
      form.addEventListener('formIsValid', validateForm.bind(null, form));

      // if (config.validateOnInput) {
      //   input.addEventListener('input', validate.bind(null, input));
      // } else if (config.cleanOnInput) {
      //   input.addEventListener('input', cleanState.bind(null, input));
      // }

      // var teste = BsFormValidate.validateForm(form);

      // Como agora  um form/submit, no precisa do keyup
      // input.addEventListener('keyup', function (e) {
      //   if (e.keyCode === 13) validate(el);
      // });
    });
  };

  var validateForm = function (form) {
    var inputs = form.querySelectorAll('input');
    var isFormValid = false;

    isFormValid = validateInputs(inputs);

    if (isFormValid) {
      config.validate.success(form);
    } else {
      config.validate.error(form);
    }
  };

  var validateInputs = function (inputs) {
    var output = true;
    var inputConfig = config.validate;

    Array.prototype.forEach.call(inputs, function (input) {
      var inputName = input.name;
      var patternIsValid = BsFormValidate.validateInput(input);
      var valueIsValid = inputConfig[inputName];
      if (!patternIsValid || !valueIsValid(input)) output = false;
    });

    return output;
  };

  return {
    init: init,
  };
}());

/**
 * Init BsActivationCodeValidate Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-js-validate').length) {
    BsActivationCodeValidate.init();
  }
});

/**
 * Back To Top
 * Smooth scroll to top of the page
 * @link https://codepen.io/Qbrid/pen/EgAYNg
 */
var BsBackToTop = (function () {
  var config = {
    interval: null,
  };

  /**
   * Inicializa a funo
   * @param {Object} el a DOM element
  */
  var init = function (el) {
    if (el) {
      el.addEventListener('click', function () {
        config.interval = setInterval(scrollStep, 2);
      });
    }
  };

  var scrollStep = function () {
    // Check if we're at the top already. If so, stop scrolling by clearing the interval
    if (window.pageYOffset === 0) {
      clearInterval(config.interval);
    }
    window.scroll(0, window.pageYOffset - 50);
  };

  return {
    init: init,
  };
}());

document.addEventListener('DOMContentLoaded', function () {
  var buttons = document.querySelectorAll('.js-back-to-top');

  if (buttons.length) {
    Array.prototype.forEach.call(buttons, function (el) {
      BsBackToTop.init(el);
    });
  }
});

navigator.version = (function () {
  // bring all browser
  var ua= navigator.userAgent, tem,
  M = ua.match(/(opera|chrome|safari|firefox|ie|trident(?=\/))\/?\s*(\d+)/i) || [];
  if(/trident/i.test(M[1])){
      tem=  /\brv[ :]+(\d+)/g.exec(ua) || [];
      return 'IE '+(tem[1] || '');
  }
  if(M[1]=== 'Chrome'){
      tem= ua.match(/\b(OPR|Edge)\/(\d+)/);
      if(tem!= null) return tem.slice(1).join(' ').replace('OPR', 'Opera');
  }
  // get version
  M= M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];
  if((tem= ua.match(/version\/(\d+)/i))!= null) M.splice(1, 1, tem[1]);
  return M.join(' ');
}());

if (navigator.version === 'IE 9' || navigator.version === 'IE 10' || navigator.version === 'MSIE 10' || navigator.version === 'MSIE 9') {

  // create elem
  var browser = document.createElement('div');
  var browserContent = document.createElement('div');
  var browserText = document.createElement('p');
  var browserTextDescription = document.createElement('p');
  var buttonClose = document.createElement('button');

  // add class
  browser.classList.add('bs-browser-update');
  browserContent.classList.add('bs-browser-update__content');
  browserText.classList.add('bs-browser-update__text');
  browserTextDescription.classList.add('bs-browser-update__text-description');
  buttonClose.classList.add('bs-button');
  buttonClose.classList.add('bs-button--ghost');
  buttonClose.classList.add('bs-button--primary');

  // append create
  browser.appendChild(browserContent);
  browserContent.appendChild(browserText);
  browserContent.appendChild(browserTextDescription);
  browserContent.appendChild(buttonClose);

  // Text create
  var textnode = document.createTextNode('Seu navegador ' + navigator.version + ' est desatualizado');
  var descriptionNode = document.createTextNode('Atualize seu navegador para ter mais segurana e velocidade, alm da melhor experincia neste site.');
  var buttontext = document.createTextNode('Continuar mesmo assim');

  // insert text
  browserText.appendChild(textnode);
  browserTextDescription.appendChild(descriptionNode);
  buttonClose.appendChild(buttontext);
  document.body.appendChild(browser);

  document.body.style.overflow = 'hidden';

  // only close elem browser
  buttonClose.addEventListener('click', function () {
    document.body.style.overflow = '';
    browser.remove();
  });
}


/**
 * Wrap HTML element within another element
 * e.g. Wrap a table within div.bs-table to make it responsive
 *
 */
var BsFixPortalHTML = (function () {
  // Config
  var config = {
    elements: document.querySelectorAll('.bs-portal-content table'),
  };

  var init = function () {
    Array.prototype.forEach.call(config.elements, function (table) {
      var tableWrapper = document.createElement('div');
      tableWrapper.classList.add('bs-table');
      wrapElement(table, tableWrapper);
    });
  };

  return {
    init: init,
  };
}());

/**
 * Init BsFixPortalHTML Constructor
 * @return {void} BsFixPortalHTML.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-portal-content').length) {
    BsFixPortalHTML.init();
  }
});

var getParents = function (elem, parentClass, firstOcurrencyOnly) {
  var parents = [];

  for (; elem && elem !== document; elem = elem.parentNode) {
    if (elem.classList.contains(parentClass)) {
      parents.push(elem);

      if (firstOcurrencyOnly) break;
    }
  }
  return parents;
};

var getParent = function (elem, parentClass) {
  return getParents(elem, parentClass, true)[0];
};


/**
 * Click Outside
 *
 * Obs: no funciona ainda :(
 *
 */
var outside = function () {
  var notTargets = function (elements, eventTarget) {
    var result = false;
    elements.forEach(function (element) {
      result = !element.classList.contains(eventTarget);
    });
    return !result;
  };

  var clickOutside = function (elementActive, allowedTargets, callback) {
    document.querySelectorAll('body, html').forEach(function (el) {
      el.addEventListener('click', function (event) {
        event.stopPropagation();
        if (elementActive() && notTargets(allowedTargets, event.target)) {
          callback();
          return false;
        }
      });
    });
  };

  // Close search on click outside
  // Use:
  // clickOutside(searchActive, [config.search, config.searchToggle], closeSearch);
};

/**
 * Wrap HTML element within another element
 * e.g. Wrap a table within div.bs-table to make it responsive
 * @param {Element} toWrap element to be wrapped
 * @param {Element} wrapper dom element that'll wrap toWrap
 * @returns {Element}
 */
var wrapElement = function (toWrap, wrapper) {
  wrapper = wrapper || document.createElement('div');
  toWrap.parentNode.insertBefore(wrapper, toWrap);
  return wrapper.appendChild(toWrap);
};

/**
 * Checks all checkboxes with the given name
 * @param {Element} checkboxTarget the checkbox that'll select all the other checkboxes
 * @param {Element} name checkboxes name
 */
var selectAllCheckboxes = function (checkboxTarget, name) {
  checkboxes = document.getElementsByName(name);

  if (checkboxes) {
    checkboxes.forEach(function (checkbox) {
      checkbox.checked = checkboxTarget.checked;
    });
  }
}

/**
 * grayscaleImage
 * Generates and base64 url grayscale image from an image source
 *
 * Reference:
 * @link: https://www.majas-lapu-izstrade.lv/cross-browser-grayscale-image-example-using-css3-js/
 *
 * @param  {string}  src The src image
 * @return {boolean}     DataURL of the src image
 */
var grayscaleImage = function (src) {
  var canvas = document.createElement('canvas');
  var ctx = canvas.getContext('2d');
  var imgObj = new Image();
  imgObj.src = src;
  canvas.width = imgObj.width;
  canvas.height = imgObj.height;
  ctx.drawImage(imgObj, 0, 0);
  var imgPixels = ctx.getImageData(0, 0, canvas.width, canvas.height);
  for (var y = 0; y < imgPixels.height; y++) {
    for (var x = 0; x < imgPixels.width; x++) {
      // var i = (y * 4) * imgPixels.width + x * 4;
      var i = ((y * 4) * imgPixels.width) + (x * 4);
      var avg = (imgPixels.data[i] + imgPixels.data[i + 1] + imgPixels.data[i + 2]) / 3;
      imgPixels.data[i] = avg;
      imgPixels.data[i + 1] = avg;
      imgPixels.data[i + 2] = avg;
    }
  }
  ctx.putImageData(imgPixels, 0, 0, 0, 0, imgPixels.width, imgPixels.height);
  return canvas.toDataURL();
};

/**
 * Replace All
 * Replace all ocurrences of an string into another
 * @link https://stackoverflow.com/a/17606289
 *
 * Use: string.replaceAll(stringToSearch, stringToReplace)
 *
 * @param  {string} search      the term to search in string
 * @param  {string} replacement the value to replace term's by
 * @return {string}             a string updated by replaces
 */
String.prototype.replaceAll = function (search, replacement) {
  var target = this;
  return target.split(search).join(replacement);
};

/**
 * convertAccentedCharacters
 *  convert accented characters to non-accented
 * @param  {string} str some string
 * @return {string}     a string with non accented characters
 */
var convertAccentedCharacters = function (str) {
  var conversions = {
    'ae': '||',
    'oe': '|',
    'ue': '',
    'Ae': '',
    'Ue': '',
    'Oe': '',
    'A': '||||||||||',
    'a': '||||||||||',
    'C': '||||',
    'c': '||||',
    'D': '||',
    'd': '||',
    'E': '||||||||',
    'e': '||||||||',
    'G': '|||',
    'g': '|||',
    'H': '|',
    'h': '|',
    'I': '|||||||||',
    'i': '|||||||||',
    'J': '',
    'j': '',
    'K': '',
    'k': '',
    'L': '||||',
    'l': '||||',
    'N': '|||',
    'n': '||||',
    'O': '||||||||||',
    'o': '|||||||||||',
    'R': '||',
    'r': '||',
    'S': '|||',
    's': '||||',
    'T': '||',
    't': '||',
    'U': '||||||||||||||',
    'u': '||||||||||||||',
    'Y': '||',
    'y': '||',
    'W': '',
    'w': '',
    'Z': '||',
    'z': '||',
    'AE': '|',
    'ss': '',
    'IJ': '',
    'ij': '',
    'OE': '',
    'f': '',
  }

  for (var i in conversions) {
    if (i) {
      var re = new RegExp(conversions[i], 'g');
      str = str.replace(re, i);
    }
  }

  return str;
};

/**
 * indexOf Special
 * Like indexOf, but taking accented characters into account
 * @param  {string} str    string where search
 * @param  {string} search string to search
 * @param  {number} index  index to start
 * @return {string}        index of search in str
 */
var indexOfSpecial = function (str, search, index) {
  var compareString;
  var compareReplace;
  // Check required params
  if (typeof str === 'undefined' || typeof search === 'undefined') {
    // throw new Error('both str and search parameters are required');
    console.error('both str and search parameters are required');
  }
  // If strings are empty, there's no index
  if (!str.replace(/\s/g, '').length || !search.replace(/\s/g, '').length) return -1;
  if (typeof index === 'undefined') index = 0;

  // Remove special characters and case size
  compareString = convertAccentedCharacters(str.toLowerCase());
  compareReplace = convertAccentedCharacters(search.toLowerCase());

  // return index of compareReplace in compareString
  return compareString.indexOf(compareReplace, index);
};

/**
 * httpGet
 *
 * get data from url
 * URL example: https://swapi.co/api/people/?format=json
 *
 * @param  {string}   url      valid API url
 * @param  {Function} callback callback
 * @return {void}              return callback function
 */
var httpGet = function (url, callback, sync) {
  var xmlHttp = new XMLHttpRequest();
  if (sync !== true && sync !== 1) sync = 0;
  if (!sync) {
    xmlHttp.onreadystatechange = function () {
      if (xmlHttp.readyState === 4 && xmlHttp.status === 200) {
        callback(xmlHttp.responseText);
      }
    };
  }
  xmlHttp.open('GET', url, !sync); // true for asynchronous
  xmlHttp.send(null);
  if (sync) return xmlHttp.responseText;
};

/**
 * toggleBodyOverflowHidden
 * Add or remove overflow hidden to body and html tags
 *
 * @param {Boolean} hidden If should set overflow as hidden
 */
var toggleBodyOverflowHidden = function (hidden) {
  var html = document.querySelectorAll('body, html');
  var overflowIsHidden = false;

  // Check if hidden is passed and its typeof is boolean
  if (typeof hidden !== 'boolean') {
    // If not, check if body or html has overflow hidden
    Array.prototype.some.call(html, function (el) {
      var styles = window.getComputedStyle(el);
      var overflow = styles.getPropertyValue('overflow');

      // If html or body has overflow hidden
      if (overflow === 'hidden') {
        // set overflowIsHidden as true
        overflowIsHidden = true;
        return;
      }
    });
  } else {
    // if hidden is passed, set overflowIsHidden as opposite of hidden
    overflowIsHidden = !hidden;
  }

  // Toggle overflow hidden
  Array.prototype.forEach.call(html, function (el) {
    if (overflowIsHidden) el.style.overflow = '';
    else el.style.overflow = 'hidden';
  });
};

/**
 * Init Google Map
 * @param  {Function} cb        Callback Function
 * @param  {String}   customKey a custom maps api key
 */
initGoogleMap = function (cb, customKey) {
  var body = document.querySelector('body');
  var script = document.createElement('script');
  var mapKey = customKey || 'AIzaSyDJ6yS2YH19-sndShzPhG1O29LiU9JMof8';
  var baseSrc = 'https://maps.googleapis.com/maps/api/js?v=3.33&libraries=places&key=' + mapKey;
  var hasMapScript = document.querySelector('script[src="' + baseSrc + '"]');

  if (typeof cb !== 'function') cb = function () {}

  if (hasMapScript) return cb();

  // Insert script tag on document
  script.src = baseSrc;
  script.defer = true;
  body.appendChild(script);

  // call callback function
  script.onload = function () {
    return cb();
  };
};

/**
 * Obtm a hash a partir da URL da pgina
 * @return {String} Hash tratada (sem #)
*/
var getHash = function () {
  var containerId = window.location.hash;
  return (containerId) ? containerId.replace('#', '') : null;
};

/**
 * Obtm a hash como um seletor ID a partir de um URL como string
 * @param  {[type]} url a URL completa
 * @return {String}     Hash tratada como ID (sem # e demais caracteres especiais)
 */
var getHashAsIdFromUrlString = function (url) {
  var hash = url.substr(url.indexOf('#')).replace(/.*(?=#)|\?.*|[^a-zA-Z0-9-_#]/g, '');
  return (hash.length > 1) ? hash : '';
}

/**
 * Verifica se o elemento passado est dentro da viewport
 * https://gomakethings.com/how-to-test-if-an-element-is-in-the-viewport-with-vanilla-javascript/
 * @param {Element} elem elemento a ser verificado
 * @return {Boolean}
*/
var isInViewport = function (elem) {
  var bounding = elem.getBoundingClientRect();
  return (
    bounding.top >= 0 &&
    bounding.left >= 0 &&
    bounding.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
    bounding.right <= (window.innerWidth || document.documentElement.clientWidth)
  );
};

/**
 * Retorna a verso do IE ou -1 caso seja outro navegador
 * https://stackoverflow.com/questions/19999388/check-if-user-is-using-ie-with-jquery/21712356#21712356
 * @return {Boolean}
*/
var detectIE = function () {
  var ua = window.navigator.userAgent;

  var msie = ua.indexOf('MSIE ');
  var trident = ua.indexOf('Trident/');
  var edge = ua.indexOf('Edge/');

  // IE
  if ((msie > 0) || (trident > 0) || (edge > 0)) {
    return true;
  }

  // Outro navegador
  return false;
};

/**
 * Get
 * Request XMLHttp from url
 *
 * @param  {String} url  URL where
 * @return {Promise}     response of request
 */
var get = function (url, progressCallback) {
  // Return a new promise.
  return new Promise(function (resolve, reject) {
    // Do the usual XHR stuff
    var req = new XMLHttpRequest();
    req.open('GET', url);

    req.addEventListener('progress', progressCallback, false);

    req.onload = function () {
      // This is called even on 404 etc
      // so check the status
      if (req.status == 200) {
        // Resolve the promise with the response text
        resolve(req.response);
      } else {
        // Otherwise reject with the status text
        // which will hopefully be a meaningful error
        reject(Error(req.statusText));
      }
    };

    // Handle network errors
    req.onerror = function () {
      reject(Error('Network Error'));
    };

    req.responseType = 'blob';

    // Make the request
    req.send();
  });
};

/**
 * forEach Promise
 * @param  {Array}     items  An array of items to return from promise
 * @param  {Function}  fn     A function that accepts an item from the array and returns a promise.
 * @returns {Promise}
 */
var forEachPromise = function (items, fn) {
  return items.reduce(function (promise, item) {
    // console.log('promise e item: ');
    // console.log(promise);
    // console.log(item);
    return promise.then(function () {
      return fn(item);
    });
  }, Promise.resolve());
};

/**
 * getFilenameFromPath
 *
 * Test:
   var array = [
     'filename.ext',
     'filename.ext?param',
     'filename.ext#hash',
     'path/to/filename.ext',
     'path/to/filename.ext?param',
     'path/to/filename.ext#hash?param',
     'path/to/filename.ext?param#hash',
   ]
   array.map(str => getFilenameFromPath(str))
 *
 * @param  {String} path the path's string
 * @return {String}      filename returned path
 */
var getFilenameFromPath = function (path) {
  return path.replace(/^.*[\\\/]|\?.*|\#.*/g, '');
}

/**
 * Extend
 * @use extend({}, defaultObject, newObject);
 * @param  {Object} target an object
 * @return {Object}        a new object with values of all argument objects
 */
var extend = function (target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i];

    for (var key in source) {
      if (Object.prototype.hasOwnProperty.call(source, key)) {
        target[key] = source[key];
      }
    }
  }

  return target;
};


/**
 * Debounce
 * @use debounce({}, func, wait, immediate);
 * @param  {Object} target an object
 * @return {Object}        a new object with values of all argument objects
 */
var debounce = function (func, wait) {
  var timeout;

  if (typeof wait === 'undefined') wait = 300;

  return function() {
    var context = this, args = arguments;
    var later = function() {
      timeout = null;
      // if (!immediate) func.apply(context, args);
    };
  // var callNow = immediate && !timeout;
  clearTimeout(timeout);
  timeout = setTimeout(later, wait);
  // if (callNow) func.apply(context, args);
  };
};

/**
 * identifyNotLoadedImages
 * @param  {Object} config a custom valid className;
 */
var identifyNotLoadedImages = function (config) {
  var cfg = typeof config === 'object' ? config : {};
  var errorClass = typeof cfg.errorClass === 'string' ? cfg.errorClass : 'bs-not-loaded';
  var imgSelector = typeof cfg.imgSelector === 'string' ? cfg.imgSelector : 'img';

  document.addEventListener('DOMContentLoaded', function () {
    Array.prototype.forEach.call(document.querySelectorAll(imgSelector), function (img) {
      var testImg = new Image();
      testImg.src = img.src;
      testImg.onload = function () {
        img.classList.remove(errorClass);
      };
      testImg.onerror = function () {
        img.classList.add(errorClass);
      };
    });
  });
};

/**
 * Reload Flickity
 * @param  {Object} flkty   a flickity instance
 * @param  {Number} timeout timeout to reload
 */
var reloadFlkty = function (flkty, timeout) {
  timeout = typeof timeout !== 'number' ? 100 : timeout;

  if (typeof flkty === 'object') {
    setTimeout(function () {
      flkty.reloadCells();
      flkty.resize();
    }, timeout);
  }
}

/**
 * Bs ContentChanger
 */
var BsContentChanger = (function () {
  // Elements
  var elements = {};
  var $ = elements;
  $.body = document.querySelector('body');
  $.selector = document.querySelector('.bs-js-content-changer--selector');
  $.wrapper = document.querySelector('.bs-js-content-changer--wrapper');

  if (!$.selector || !$.wrapper) return;

  $.contents = $.wrapper.children;

  // Config
  var config = {
    contentHiddenClass: 'bs-is-hidden',
    contentDataActive: 'data-content-changer-active',
    contentDataTitle: 'data-content-changer-title',
    contentDataId: 'data-content-changer-id',
  };

  var init = function () {
    buildSelectOptions();
    $.selector.addEventListener('change', function () {
      showContent(this.value);
    });
  };

  var buildSelectOptions = function () {
    var optionsStr = $.selector.innerHTML;
    var optionsArr = [];

    Array.prototype.forEach.call($.contents, function (el) {
      var title = el.getAttribute(config.contentDataTitle);
      var id = el.getAttribute(config.contentDataId);
      optionsArr.push('<option value="' + id + '">' + title + '</option>');
    });

    optionsStr += optionsArr.join('');
    $.selector.innerHTML = optionsStr;
  };

  var showContent = function (contentId) {
    var content = $.wrapper.querySelector('[' + config.contentDataId + '="' + contentId + '"]');
    var currentActive = $.wrapper.querySelector('[' + config.contentDataActive + ']');

    content.classList.remove(config.contentHiddenClass);
    content.setAttribute(config.contentDataActive, '');

    if (currentActive) {
      currentActive.classList.add(config.contentHiddenClass);
      currentActive.removeAttribute(config.contentDataActive);
    }
  };

  return {
    init: init,
  };
}());

/**
 * Init ContentChanger Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-js-content-changer--wrapper').length) {
    BsContentChanger.init();
  }
});

/**
 * Bs Dropdown
 * @return init function
 */
var BsDropdown = function () {
  // Elements
  var elements = {};
  var $ = elements;
  $.body = document.querySelector('body');
  $.toggle = null;
  $.dropdown = null;

  // Config
  var config = {
    dropdownType: null,
    dropdownElement: null,
    toggleActiveClass: 'bs-is-active',
    dropdownActiveClass: 'bs-is-open',
  };

  var init = function (toggle, options) {
    // Check if an element toggle was passed
    if (typeof toggle !== 'undefined') $.toggle = toggle;
    else return;

    // By default, dropdown element is next element sibling of toggle
    $.dropdown = $.toggle.nextElementSibling;

    // Check if options were passed
    if (typeof options !== 'undefined') {
      // config
      if (options.dropdownType) config.dropdownType = options.dropdownType;
      if (options.toggleActiveClass) config.toggleActiveClass = options.toggleActiveClass;
      if (options.dropdownActiveClass) config.dropdownActiveClass = options.dropdownActiveClass;
      // elements
      if (options.dropdownElement) $.dropdown = options.dropdownElement;
    }

    // Return if toggle or dropdown not exists
    if (!$.toggle) return;
    $.toggle.addEventListener('click', toggleDropdown);

    // Close dropdown on click outside
    Array.prototype.forEach.call(document.querySelectorAll('body, html'), function (el) {
      el.addEventListener('click', function (event) {
        if (
          dropdownActive() &&
          // (!$.dropdown.contains(event.target) && dropdownType !== 'filter') &&
          !$.toggle.contains(event.target)) {
          closeDropdown();
          return false;
        }
      });
    });
  };

  var toggleDropdown = function () {
    if (!dropdownActive()) openDropdown();
    else closeDropdown();
  };

  var openDropdown = function () {
    $.dropdown.classList.add(config.dropdownActiveClass);
    $.toggle.classList.add(config.toggleActiveClass);
  };

  var closeDropdown = function () {
    $.dropdown.classList.remove(config.dropdownActiveClass);
    $.toggle.classList.remove(config.toggleActiveClass);
  };

  var dropdownActive = function () {
    return $.dropdown.classList.contains(config.dropdownActiveClass);
  };

  return {
    init: init,
  };
};

/**
 * Init Dropdown Constructor
 * @return {void}
 */
document.addEventListener('DOMContentLoaded', function () {
  var dropdowns = document.querySelectorAll('.bs-js-dropdown--toggle');
  if (dropdowns.length) {
    var dropdown = null;
    Array.prototype.forEach.call(dropdowns, function (el) {
      dropdown = new BsDropdown();
      dropdown.init(el);
    });
  }
});

/**
 * Funo para clicar em botes e exibir o contedo relacionado
*/
var BsExpandContent = (function () {
  var config = {
    el: null,
    button: null,
    collapseHeight: 300,
    maxHeight: 1000,
    contentHeight: 0,
    collapseClass: 'bs-is-collapsed',
    buttonClass: 'bs-portal-content__expand-button',
    buttonText: 'Ver tudo',
  };

  /**
   * Inicializa a funo
   * @param {Object} el a DOM element
  */
  var init = function (el) {
    // check if element exist
    if (!el || typeof el !== 'object') return;
    // check if height is greater than config maxHeight
    if (el.offsetHeight < config.maxHeight) return;

    // set content and button elements to config
    config.el = el;
    config.button = createExpandButton();

    // set content and button elements to config
    el.classList.add(config.collapseClass);
    el.style.height = config.collapseHeight + 'px';
    config.contentHeight = el.height;

    // append button to element
    el.appendChild(config.button);
  };

  /**
   * Create expand Button
   * @return {[type]} [description]
   */
  var createExpandButton = function () {
    var button = document.createElement('button');

    // set button attributes
    button.type = 'button';
    button.innerHTML = config.buttonText;
    button.classList.add(config.buttonClass);

    // add listener to expand Content onClick
    button.addEventListener('click', expandContent);

    return button;
  };

  /**
   * Expand Content
   */
  var expandContent = function () {
    // var height = config.el.scrollHeight;
    config.el.style.height = 'auto';
    config.el.classList.remove(config.collapseClass);
    config.button.remove();
  };

  return {
    init: init,
  };
}());


document.addEventListener('DOMContentLoaded', function () {
  var elements = document.querySelectorAll('.bs-js-expandable-content');

  if (elements.length) {
    Array.prototype.forEach.call(elements, function (el) {
      BsExpandContent.init(el);
    });
  }
});

(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory() :
  typeof define === 'function' && define.amd ? define(factory) :
  (factory());
}(this, (function () { 'use strict';

  /**
   * Applies the :focus-visible polyfill at the given scope.
   * A scope in this case is either the top-level Document or a Shadow Root.
   *
   * @param {(Document|ShadowRoot)} scope
   * @see https://github.com/WICG/focus-visible
   */
  function applyFocusVisiblePolyfill(scope) {
    var hadKeyboardEvent = true;
    var hadFocusVisibleRecently = false;
    var hadFocusVisibleRecentlyTimeout = null;

    var inputTypesWhitelist = {
      text: true,
      search: true,
      url: true,
      tel: true,
      email: true,
      password: true,
      number: true,
      date: true,
      month: true,
      week: true,
      time: true,
      datetime: true,
      'datetime-local': true
    };

    /**
     * Helper function for legacy browsers and iframes which sometimes focus
     * elements like document, body, and non-interactive SVG.
     * @param {Element} el
     */
    function isValidFocusTarget(el) {
      if (
        el &&
        el !== document &&
        el.nodeName !== 'HTML' &&
        el.nodeName !== 'BODY' &&
        'classList' in el &&
        'contains' in el.classList
      ) {
        return true;
      }
      return false;
    }

    /**
     * Computes whether the given element should automatically trigger the
     * `focus-visible` class being added, i.e. whether it should always match
     * `:focus-visible` when focused.
     * @param {Element} el
     * @return {boolean}
     */
    function focusTriggersKeyboardModality(el) {
      var type = el.type;
      var tagName = el.tagName;

      if (tagName === 'INPUT' && inputTypesWhitelist[type] && !el.readOnly) {
        return true;
      }

      if (tagName === 'TEXTAREA' && !el.readOnly) {
        return true;
      }

      if (el.isContentEditable) {
        return true;
      }

      return false;
    }

    /**
     * Add the `focus-visible` class to the given element if it was not added by
     * the author.
     * @param {Element} el
     */
    function addFocusVisibleClass(el) {
      if (el.classList.contains('focus-visible')) {
        return;
      }
      el.classList.add('focus-visible');
      el.setAttribute('data-focus-visible-added', '');
    }

    /**
     * Remove the `focus-visible` class from the given element if it was not
     * originally added by the author.
     * @param {Element} el
     */
    function removeFocusVisibleClass(el) {
      if (!el.hasAttribute('data-focus-visible-added')) {
        return;
      }
      el.classList.remove('focus-visible');
      el.removeAttribute('data-focus-visible-added');
    }

    /**
     * If the most recent user interaction was via the keyboard;
     * and the key press did not include a meta, alt/option, or control key;
     * then the modality is keyboard. Otherwise, the modality is not keyboard.
     * Apply `focus-visible` to any current active element and keep track
     * of our keyboard modality state with `hadKeyboardEvent`.
     * @param {KeyboardEvent} e
     */
    function onKeyDown(e) {
      if (e.metaKey || e.altKey || e.ctrlKey) {
        return;
      }

      if (isValidFocusTarget(scope.activeElement)) {
        addFocusVisibleClass(scope.activeElement);
      }

      hadKeyboardEvent = true;
    }

    /**
     * If at any point a user clicks with a pointing device, ensure that we change
     * the modality away from keyboard.
     * This avoids the situation where a user presses a key on an already focused
     * element, and then clicks on a different element, focusing it with a
     * pointing device, while we still think we're in keyboard modality.
     * @param {Event} e
     */
    function onPointerDown(e) {
      hadKeyboardEvent = false;
    }

    /**
     * On `focus`, add the `focus-visible` class to the target if:
     * - the target received focus as a result of keyboard navigation, or
     * - the event target is an element that will likely require interaction
     *   via the keyboard (e.g. a text box)
     * @param {Event} e
     */
    function onFocus(e) {
      // Prevent IE from focusing the document or HTML element.
      if (!isValidFocusTarget(e.target)) {
        return;
      }

      if (hadKeyboardEvent || focusTriggersKeyboardModality(e.target)) {
        addFocusVisibleClass(e.target);
      }
    }

    /**
     * On `blur`, remove the `focus-visible` class from the target.
     * @param {Event} e
     */
    function onBlur(e) {
      if (!isValidFocusTarget(e.target)) {
        return;
      }

      if (
        e.target.classList.contains('focus-visible') ||
        e.target.hasAttribute('data-focus-visible-added')
      ) {
        // To detect a tab/window switch, we look for a blur event followed
        // rapidly by a visibility change.
        // If we don't see a visibility change within 100ms, it's probably a
        // regular focus change.
        hadFocusVisibleRecently = true;
        window.clearTimeout(hadFocusVisibleRecentlyTimeout);
        hadFocusVisibleRecentlyTimeout = window.setTimeout(function() {
          hadFocusVisibleRecently = false;
        }, 100);
        removeFocusVisibleClass(e.target);
      }
    }

    /**
     * If the user changes tabs, keep track of whether or not the previously
     * focused element had .focus-visible.
     * @param {Event} e
     */
    function onVisibilityChange(e) {
      if (document.visibilityState === 'hidden') {
        // If the tab becomes active again, the browser will handle calling focus
        // on the element (Safari actually calls it twice).
        // If this tab change caused a blur on an element with focus-visible,
        // re-apply the class when the user switches back to the tab.
        if (hadFocusVisibleRecently) {
          hadKeyboardEvent = true;
        }
        addInitialPointerMoveListeners();
      }
    }

    /**
     * Add a group of listeners to detect usage of any pointing devices.
     * These listeners will be added when the polyfill first loads, and anytime
     * the window is blurred, so that they are active when the window regains
     * focus.
     */
    function addInitialPointerMoveListeners() {
      document.addEventListener('mousemove', onInitialPointerMove);
      document.addEventListener('mousedown', onInitialPointerMove);
      document.addEventListener('mouseup', onInitialPointerMove);
      document.addEventListener('pointermove', onInitialPointerMove);
      document.addEventListener('pointerdown', onInitialPointerMove);
      document.addEventListener('pointerup', onInitialPointerMove);
      document.addEventListener('touchmove', onInitialPointerMove);
      document.addEventListener('touchstart', onInitialPointerMove);
      document.addEventListener('touchend', onInitialPointerMove);
    }

    function removeInitialPointerMoveListeners() {
      document.removeEventListener('mousemove', onInitialPointerMove);
      document.removeEventListener('mousedown', onInitialPointerMove);
      document.removeEventListener('mouseup', onInitialPointerMove);
      document.removeEventListener('pointermove', onInitialPointerMove);
      document.removeEventListener('pointerdown', onInitialPointerMove);
      document.removeEventListener('pointerup', onInitialPointerMove);
      document.removeEventListener('touchmove', onInitialPointerMove);
      document.removeEventListener('touchstart', onInitialPointerMove);
      document.removeEventListener('touchend', onInitialPointerMove);
    }

    /**
     * When the polfyill first loads, assume the user is in keyboard modality.
     * If any event is received from a pointing device (e.g. mouse, pointer,
     * touch), turn off keyboard modality.
     * This accounts for situations where focus enters the page from the URL bar.
     * @param {Event} e
     */
    function onInitialPointerMove(e) {
      // Work around a Safari quirk that fires a mousemove on <html> whenever the
      // window blurs, even if you're tabbing out of the page. \_()_/
      if (e.target.nodeName && e.target.nodeName.toLowerCase() === 'html') {
        return;
      }

      hadKeyboardEvent = false;
      removeInitialPointerMoveListeners();
    }

    // For some kinds of state, we are interested in changes at the global scope
    // only. For example, global pointer input, global key presses and global
    // visibility change should affect the state at every scope:
    document.addEventListener('keydown', onKeyDown, true);
    document.addEventListener('mousedown', onPointerDown, true);
    document.addEventListener('pointerdown', onPointerDown, true);
    document.addEventListener('touchstart', onPointerDown, true);
    document.addEventListener('visibilitychange', onVisibilityChange, true);

    addInitialPointerMoveListeners();

    // For focus and blur, we specifically care about state changes in the local
    // scope. This is because focus / blur events that originate from within a
    // shadow root are not re-dispatched from the host element if it was already
    // the active element in its own scope:
    scope.addEventListener('focus', onFocus, true);
    scope.addEventListener('blur', onBlur, true);

    // We detect that a node is a ShadowRoot by ensuring that it is a
    // DocumentFragment and also has a host property. This check covers native
    // implementation and polyfill implementation transparently. If we only cared
    // about the native implementation, we could just check if the scope was
    // an instance of a ShadowRoot.
    if (scope.nodeType === Node.DOCUMENT_FRAGMENT_NODE && scope.host) {
      // Since a ShadowRoot is a special kind of DocumentFragment, it does not
      // have a root element to add a class to. So, we add this attribute to the
      // host element instead:
      scope.host.setAttribute('data-js-focus-visible', '');
    } else if (scope.nodeType === Node.DOCUMENT_NODE) {
      document.documentElement.classList.add('js-focus-visible');
      document.documentElement.setAttribute('data-js-focus-visible', '');
    }
  }

  // It is important to wrap all references to global window and document in
  // these checks to support server-side rendering use cases
  // @see https://github.com/WICG/focus-visible/issues/199
  if (typeof window !== 'undefined' && typeof document !== 'undefined') {
    // Make the polyfill helper globally available. This can be used as a signal
    // to interested libraries that wish to coordinate with the polyfill for e.g.,
    // applying the polyfill to a shadow root:
    window.applyFocusVisiblePolyfill = applyFocusVisiblePolyfill;

    // Notify interested libraries of the polyfill's presence, in case the
    // polyfill was loaded lazily:
    var event;

    try {
      event = new CustomEvent('focus-visible-polyfill-ready');
    } catch (error) {
      // IE11 does not support using CustomEvent as a constructor directly:
      event = document.createEvent('CustomEvent');
      event.initCustomEvent('focus-visible-polyfill-ready', false, false, {});
    }

    window.dispatchEvent(event);
  }

  if (typeof document !== 'undefined') {
    // Apply the polyfill to the global document, so that no JavaScript
    // coordination is required to use the polyfill in the top-level document:
    applyFocusVisiblePolyfill(document);
  }

})));

/**
 * Bs Forms
 * @return init function
 */
var BsForms = (function () {
  // Elements
  var elements = {};
  var $ = elements;
  $.body = document.querySelector('body');
  $.forms = document.querySelectorAll('form');
  $.togglePasswordValue = document.querySelectorAll('.bs-js-toggle-password-value');
  $.toggleInfoValue = document.querySelectorAll('.bs-js-toggle-info-value');
  $.toggleInfoContent = document.querySelector('.bs-info-value');
  $.overlay = document.querySelector('.bs-overlay');
  $.toggleTelMask = document.querySelectorAll('select[data-tel]');
  $.revealTelephone = document.querySelector('.bs-js-reveal-telephone');
  // $.focusCalendar = document.querySelectorAll('input[data-type="datepicker"]');
  $.adaptivePlaceholder = document.querySelectorAll('.bs-form__label--adaptive input, bs-form__label--adaptive textarea');
  $.inputFile = document.querySelectorAll('.bs-form__control--file');
  $.fileInput = document.querySelectorAll('.bs-js-input-file');
  $.infoActive = 'bs-active';
  $.overlayActive = 'bs-is-visible';
  $.hasFile = 'bs-has-file';
  $.removeFile = document.querySelectorAll('.bs-remove-file');

  // Config
  var config = {
    passwordVisibleClass: 'bs-form__password--is-visible',
    adaptivePlaceholderValidClass: 'bs-form__field--not-empty',
    datepicker: {},
    datepickerOptions: {},
  };

  var init = function () {

    if ($.togglePasswordValue.length > 0) {
      Array.prototype.forEach.call($.togglePasswordValue, function (el) {
        el.addEventListener('click', toggleInputPasswordValue);
      });
    }

    if ($.toggleInfoValue.length > 0) {
      Array.prototype.forEach.call($.toggleInfoValue, function (el) {
        el.addEventListener('click', toggleTitleInfoValue);
      });
    }

    if ($.overlay) {
      $.overlay.addEventListener('click', closeTitleInfoValue);
    }

    if ($.revealTelephone) $.revealTelephone.addEventListener('click', revealTelephoneField);

    if ($.toggleTelMask.length > 0) {
      Array.prototype.forEach.call($.toggleTelMask, function (e) {
        e.addEventListener('change', function () {
          var dataTel = this.dataset.tel;
          var valueTel = e.value;
          var input = document.querySelector('input[data-tel=' + dataTel + ']');

          if (valueTel !== 55) {
            InputMasks.destroy(input);
          } else {
            InputMasks.update(input);
          }
        });
      });
    }

    // if ($.focusCalendar.length > 0) {
    //   Array.prototype.forEach.call($.focusCalendar, function (el) {
    //     var inputId = el.getAttribute('id');
    //     var toggleCalendar = el.parentNode.querySelector('.bs-js-toggle-datepicker');

    //     config.datepicker[inputId] = new Pikaday({
    //       bound: true,
    //       field: el,
    //       firstDay: 1,
    //       format: 'DD/MM/YYYY',
    //       i18n: {
    //         previousMonth: 'Ms Anterior',
    //         nextMonth: 'Prximo Ms',
    //         months: ['Janeiro', 'Fevereiro', 'Maro', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],
    //         weekdays: ['Domingo', 'Segunda-Feira', 'Tera-Feira', 'Quarta-Feira', 'Quinta-Feira', 'Sexta-Feira', 'Sbado'],
    //         weekdaysShort: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sb'],
    //       },
    //       position: 'bottom right',
    //       trigger: toggleCalendar,
    //       minDate: new Date(1900, 1, 1),
    //       maxDate: new Date(2020, 12, 31),
    //       yearRange: [1900, 2020],
    //     });
    //     // el.addEventListener('focus', toggleCalendar.bind(null, el));
    //   });
    // }

    if ($.adaptivePlaceholder.length > 0) {
      Array.prototype.forEach.call($.adaptivePlaceholder, function (el) {
        el.addEventListener('blur', function () {
          if (this.value) this.classList.add(config.adaptivePlaceholderValidClass);
          else this.classList.remove(config.adaptivePlaceholderValidClass);
        });
      });
    }

    if ($.forms.length > 0) {
      Array.prototype.forEach.call($.forms, function (form) {
        onFormReset(form);
      });
    }

    if ($.fileInput.length > 0) {
      
      Array.prototype.forEach.call($.fileInput, function (input_form) {
        input_form.addEventListener('change', function () {
          fakeFilePath(input_form, input_form.value);
        });
      });

      if ($.removeFile.length > 0 ) {
        Array.prototype.forEach.call($.removeFile, function (e) {
          e.addEventListener('click', function(e) {
            var container = this.parentNode.parentNode.parentNode;
            var input_file = container.querySelector('.bs-js-input-file');

            input_file.value = null;

            e.preventDefault();
            fakeFilePath(input_file, "");
          })
        })
      }
    }
  };

  var fakeFilePath = function (input, input_value) {
    var container = input.parentNode;
    var custom_input = container.querySelector('.bs-js-input-file-fake');
    var custom_button = container.querySelector('.bs-js-input-file-toggle');

    var filepath = input_value;
    if (filepath) {
      custom_input.innerText = filepath.replace(/^.*\\/, '');
      custom_input.classList.add($.hasFile);
      custom_button.innerHTML = 'Alterar arquivo';
    } else {
      custom_input.innerText = custom_input.getAttribute('data-placeholder');
      custom_input.classList.remove($.hasFile);
      custom_button.innerHTML = 'Anexar arquivo';
    }
  }

  var toggleTitleInfoValue = function (event) {
    var clickedElem = event.target;
    clickedElem.children[0].classList.toggle($.infoActive);
    $.overlay.classList.add($.overlayActive);
  }

  var closeTitleInfoValue = function () {
    if ($.toggleInfoContent) {
      $.toggleInfoContent.classList.remove($.infoActive);
      $.overlay.classList.remove($.overlayActive);
    }
  }

  var toggleInputPasswordValue = function () {
    var parent = this.parentNode;
    var input = parent.querySelector('input');

    if (input.getAttribute('type') === 'text') {
      parent.classList.remove(config.passwordVisibleClass);
      input.setAttribute('type', 'password');
    } else {
      parent.classList.add(config.passwordVisibleClass);
      input.setAttribute('type', 'text');
    }

    input.focus();
  };

  /* var toggleMaskDDI = function() {
    var dataTel = el.dataset.tel;
    var tel = document.querySelector('input[data-tel='+ dataTel +']');
    console.log('asd');

    if(dataTel != 55) {
      destroy mask
      console.log('DIFERENTE');
    }
  } */

  var revealTelephoneField = function () {
    var aditionalTelephones = document.querySelectorAll('.bs-form__telephone-aditional.bs-is-hidden');
    if (aditionalTelephones.length === 1) {
      aditionalTelephones[0].classList.remove('bs-is-hidden');
      $.revealTelephone.classList.add('bs-is-disabled');
    } else if (aditionalTelephones.length > 0) {
      aditionalTelephones[0].classList.remove('bs-is-hidden');
    }
  };

  var toggleMaskDDI = function () {
    // var dataTel = el.dataset.tel;
    // var tel = document.querySelector('input[data-tel='+ dataTel +']');
    // console.log('asd');

    // if (dataTel != 55) {
    //   destroy mask
    //   console.log('DIFERENTE');
    // }
  };

  var toggleCalendar = function (input) {}

  var onFormReset = function (form) {
    form.addEventListener('reset', function () {
      var fakeFileInputs = form.querySelectorAll('span.bs-form__field');
      if (fakeFileInputs.length) {
        Array.prototype.forEach.call(fakeFileInputs, function (fake) {
          fake.innerText = fake.getAttribute('data-placeholder') || '';
          fake.classList.remove($.hasFile);
        });
      }
    });
  }

  return {
    init: init,
  };
}());

/**
 * Init Forms Constructor
 * @return {void}
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('form')) {
    BsForms.init();
  }
});

var BsformSteps = (function () {
  var config = {
    buttons: {
      next: document.querySelectorAll('.bs-form--steps .bs-js-form-next'),
      prev: document.querySelectorAll('.bs-form--steps .bs-js-form-prev'),
    },
    classes: {
      activeFieldset: 'bs-form__fieldset--active',
    },
    currentStep: document.querySelector('.bs-js-form-current-step'),
    currentStepInt: 0,
    fieldsets: document.querySelectorAll('.bs-form--steps .bs-form__fieldset'),
    form: document.querySelector('.bs-form--steps'),
    percentage: document.querySelector('.bs-js-form-percentage'),
    progressBar: document.querySelector('.bs-form--steps .bs-js-progress-bar'),
    totalSteps: document.querySelector('.bs-js-form-total-steps'),
    totalStepsInt: 0,
  };

  var init = function () {
    _setTotalSteps();
    _updateCurrentStep();

    Array.prototype.forEach.call(config.buttons.next, function (button) {
      button.addEventListener('click', function (e) {
        e.preventDefault();
        _nextStep(button);
      });
    });

    Array.prototype.forEach.call(config.buttons.prev, function (button) {
      button.addEventListener('click', function (e) {
        e.preventDefault();
        _prevStep(button);
      });
    });
  };

  /**
  * Atualiza o passo atual do formulrio
  */
  var _updateCurrentStep = function () {
    var activeFieldset = config.form.querySelector('.' + config.classes.activeFieldset);

    // Transformo o NodeList em um Array
    var fieldsets = Array.prototype.slice.call(config.fieldsets);

    if (fieldsets) {
      // Obtenho a posio (index) do fieldset
      var currentStepInt = fieldsets.indexOf(activeFieldset) + 1;

      // Atualizo o passo do formulrio
      config.currentStepInt = currentStepInt;
      config.currentStep.textContent = currentStepInt;
      _updatePercentage();
    }
  };

  /**
  * Define o total de passos do formulrio
  */
  var _setTotalSteps = function () {
    var fieldsets = config.fieldsets;
    if (fieldsets && fieldsets.length > 0) {
      config.totalStepsInt = fieldsets.length;
      config.totalSteps.textContent = fieldsets.length;
      _updatePercentage();
    }
  };

  /**
   * Valida o formulrio e avana para o prximo passo
   * @param  {Element} button Boto para avanar um passo
   */
  var _nextStep = function (button) {
    var currentFieldset = getParents(button, 'bs-form__fieldset', true)[0];
    var nextFieldset = currentFieldset.nextElementSibling;
    var isFormOk = BsFormValidate.validateForm(currentFieldset);
    if (isFormOk) _switchFieldset(nextFieldset);
  };

  /**
   * Volta um passo no formulrio
   * @param  {Element} button Boto para voltar um passo
   */
  var _prevStep = function (button) {
    var currentFieldset = getParents(button, 'bs-form__fieldset', true)[0];
    var prevFieldset = currentFieldset.previousElementSibling;
    if (prevFieldset) _switchFieldset(prevFieldset);
  };

  /**
   * Esconde os fieldsets e exibe apenas o atual
   * @param  {Element} fieldset Fieldset que ser exibido
   */
  var _switchFieldset = function (fieldset) {
    Array.prototype.forEach.call(config.fieldsets, function (fs) {
      fs.classList.remove(config.classes.activeFieldset);
    });
    fieldset.classList.add(config.classes.activeFieldset);
    _updateCurrentStep();
  };

  /**
   * Atualiza o percentual de progresso
   */
  var _updatePercentage = function () {
    if (config.totalStepsInt > 0) {
      // Calculo o percentual de progresso
      // Diminui 1 para iniciar com 0%
      var percentage = parseInt((((config.currentStepInt - 1) * 100) / config.totalStepsInt), 10);
      config.percentage.textContent = percentage;
      config.progressBar.value = percentage;
    }
  };

  return {
    init: init,
  };
}());

/**
 * Init BsformSteps constructor
 * @return {void} BsformSteps.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-form--steps').length) {
    BsformSteps.init();
  }
});

/**
 * Form Validate (anchor)
 */
var BsFormValidate = (function () {
  // Elements
  var elements = {};
  var $ = elements;

  $.forms = document.querySelectorAll('form');

  if (!$.forms.length) return;

  // Config
  var config = {
    errorMessageClass: 'bs-form-error__message',
    labelClass: 'bs-form__label',
    validate: {
      default: {
        pattern: /(?!^ +$)^.+$/g,
        error: 'Esse campo  obrigatrio.',
      },
      nome: {
        pattern: /[\w\s]+/g,
        error: 'Voc deve digitar seu nome completo.',
      },
      cpf: {
        pattern: /([0-9]{3}[.]?[0-9]{3}[.]?[0-9]{3}[-]?[0-9]{2})/g,
        error: 'O CPF  invlido',
      },
      cnpj: {
        pattern: /([0-9]{2}[.]?[0-9]{3}[.]?[0-9]{3}[/]?[0-9]{4}[-]?[0-9]{2})/g,
        error: 'O CNPJ  invlido',
      },
      tel: {
        // https://regexr.com/3m3s2
        pattern: /[(]?[1-9]{2}[)]?[\s]?[2-9][0-9]{3,4}[-\s]?[1-9]{4}/g,
        error: 'O telefone  invlido',
      },
      'activation-code': {
        pattern: /[0-9]{6}/g,
        error: 'O cdigo  invlido',
      },
    },
    validatedCustomEvent: function () {
      return new Event('formIsValid')
    },
    validInputs: 'input, textarea',
    inputOptions: {
      // string
      error: null,
      // regex
      pattern: null,
      // string
      type: null,
      // function
      validation: null,
      // boolean
      noState: false,
      // // boolean
      // validateOnInput: false,
      // // boolean
      // cleanOnInput: false,
    },
  };

  /**
   * [description]
   */
  var init = function () {
    Array.prototype.forEach.call($.forms, function (form) {
      var validateCallback = form.getAttribute('data-validate-callback');
      form.addEventListener('submit', function (event) {
        // Se o formulrio no for vlido, previne o submit
        if (!validateForm(this)) {
          event.preventDefault();
          // debugger;
          // Se o formulrio for vlido e tiver um callback
          // customizado, tambm previne o submit
        } else if (validateCallback) {
          event.preventDefault();
          this.dispatchEvent(config.validatedCustomEvent);
          // debugger;
        }
      });
    });
  };

  /**
   * [description]
   * @param  {[type]} form [description]
   * @return {[type]}      [description]
   */
  var validateForm = function (form) {
    var inputs = form.querySelectorAll(config.validInputs);
    var output = true;

    Array.prototype.forEach.call(inputs, function (input) {
      cleanState(input);
      if (!validateInput(input)) output = false;
      input.addEventListener('blur', validateInput.bind(null, input));
    });

    return output;
  };

  /**
   * [description]
   * @param  {[type]} input   [description]
   * @param  {[type]} options [description]
   * @return {[type]}         [description]
   */
  var validateInput = function (input, options) {
    // custom settings
    var settings = {};
    var inlineSettings = input.getAttribute('data-validate-options') || null;

    // if exists, extend inline options in default settings
    if (inlineSettings) settings = extend(config.inputOptions, options);

    // check if options has an object
    if (typeof options !== 'object') options = {};
    // extend options object properties in settings
    else settings = extend(config.inputOptions, options);

    // set loading state if settings has custom validation function
    if (settings.validation === 'function') setState(input, 'loading');

    // Set error state if input is invalid
    if (!inputIsValid(input, settings) && !settings.noState) {
      // debugger;
      setState(input, 'invalid', settings.error);
      return false;
    }

    if (!settings.noState) {
      // debugger;
      // Set success state if input is valid
      setState(input, 'valid');
    }

    return true;
  };

  /**
   * [description]
   * @param  {[type]} input    [description]
   * @param  {[type]} settings [description]
   * @return {[type]}          [description]
   */
  var inputIsValid = function (input, settings) {
    // if input is required
    var isRequired =
      input.getAttribute('required') === '' ||
      input.getAttribute('required') === 'required';

    if (!isRequired) return true;

    // type of the validation
    var type = input.getAttribute('data-validate-type') || settings.type;

    // custom pattern (regex)
    var pattern =
      input.getAttribute('data-validate-pattern') ||
      input.getAttribute('pattern') ||
      settings.pattern;

    // input value
    var value = input.value;

    // default pattern by type
    var typeValidate = config.validate[type] || [];

    // if input is valid or not
    var output = false;

    // check if a string matches a regex pattern
    var checkRegex = function (string, regex) {
      return string.match(regex);
    };

    // if is not required, validation is not needed
    // if has not value, validation is not possible
    if (!isRequired || !value) return;

    // if input has custom data to validate
    if (settings.validation) {
      output = settings.validation(value);
      // if input has a type defined and that has a default pattern
    } else if (typeValidate.pattern) {
      output = checkRegex(value, typeValidate.pattern);
    // if input has not a type defined but a custom pattern
    } else if (pattern) {
      output = checkRegex(value, pattern);
    // if input is checkbox
    } else if (input.type === 'checkbox') {
      output = input.checked;
    // if input has not a type or a pattern, but even so is required
    } else {
      output = value.trim();
    }

    return output;
  };

  /**
   * [description]
   * @param  {[type]} input   [description]
   * @param  {[type]} state   [description]
   * @param  {[type]} message [description]
   */
  var setState = function (input, state, message) {
    // var label = getParents(input, config.labelClass);
    var inputType = input.getAttribute('data-validate-type');
    var errorMessage = document.createElement('span');

    if (typeof message !== 'string') message = null;

    cleanState(input);

    errorMessage.classList.add(config.errorMessageClass);
    errorMessage.innerHTML = (
      config.validate[inputType]) ?
      config.validate[inputType].error :
      config.validate.default.error;

    errorMessage.innerHTML = message || errorMessage.innerHTML;

    // debugger;
    input.setAttribute('data-validation-state', state);

    if (state === 'invalid') {
      if (input.type === 'checkbox' || input.type === 'radio') {
        input.nextElementSibling.appendChild(errorMessage);
      } else {
        insertAfter(errorMessage, input);
      }
      // debugger;
    }
  };

  /**
   * [description]
   * @param  {[type]} input [description]
   * @return {[type]}       [description]
   */
  var getState = function (input) {
    return input.getAttribute('data-validation-state');
  };

  /**
   * [description]
   * @param  {[type]} input [description]
   */
  var cleanState = function (input) {
    var parent = input.parentNode;
    var message = parent.querySelector('.bs-form-error__message');
    input.removeAttribute('data-validation-state');

    if (message) parent.removeChild(message);
  };

  /**
   * insertAfter
   * @param  {[type]} newNode       [description]
   * @param  {[type]} referenceNode [description]
   */
  var insertAfter = function (newNode, referenceNode) {
    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
  };

  /**
   * Extend objects
   * @param  {Object} objA An object
   * @param  {Object} objB Another object
   * @return {Object}      A copy of objectA extended with the properties from objectB
   */
  var extend = function (objA, objB) {
    var objC = {};
    for (var keyA in objA) {
      if (objA.hasOwnProperty(keyA)) {
        objC[keyA] = objA[keyA];
      }
    }

    for (var keyB in objB) {
      if (objB.hasOwnProperty(keyB)) {
        objC[keyB] = objB[keyB];
      }
    }
    return objC;
  };

  return {
    init: init,
    validateInput: validateInput,
    validateForm: validateForm,
    getState: getState,
    setState: setState,
  };
}());

/**
 * Init BsFormValidate Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-js-validate').length) {
    BsFormValidate.init();
  }
});

/**
 * Bs Picture Parallax Effect
 * Parallax effect for full background images with html picture/img tag
 *
 * Use exemple:
 * <picture class="image-container-class">
 *   <img src="path/to/image.jpg">
 * </picture>
 *
 * TODO: jquery extend like function to merge default/options
 *
 */
var BsPictureParallax = (function (document) {
  // Elements
  var elements = {};
  var $ = elements;
  $.parallax = document.querySelectorAll('.bs-js-picture-parallax');
  if (!$.parallax.length) return;

  // Config
  var config = {
    speed: 1,
  };

  var init = function (options) {
    if (options && options.speed) config.speed = options.speed;

    Array.prototype.forEach.call($.parallax, function (el) {
      document.addEventListener('scroll', parallax.bind(null, el));
    });
  };
  var parallax = function (imageContainer) {
    var speed = (config.speed > 1 || config.speed <= 0) ? 1 : config.speed;
    var image = imageContainer.querySelector('img');
    var imageH = image.offsetHeight;
    var imageContainerY = imageContainer.getBoundingClientRect().top;
    var imageContainerH = imageContainer.offsetHeight;
    var winY = (
      window.pageYOffset !== undefined
    ) ?
      window.pageYOffset :
      (
        document.documentElement ||
        document.body.parentNode || document.body
      ).scrollTop;
    var winH = window.innerHeight;
    var scrollDistance = winH + imageContainerH;
    var imageSangria = imageH - imageContainerH;
    var topPxPerScrollPx = imageSangria / scrollDistance;
    var imageTopPosition = (topPxPerScrollPx * (imageContainerY - winH)) * speed;

    // console.log('---------------------');
    // console.log('imageContainerY: ' + imageContainerY);
    // console.log('winY: ' + winY);
    // console.log('winH: ' + winH);
    // console.log('imageContainerH: ' + imageContainerH);
    // console.log('scrollDistance: ' + scrollDistance);
    // console.log('---------------------');
    // console.log('speed: ' + speed);
    // console.log('imageSangria: ' + imageSangria);
    // console.log('topPxPerScrollPx: ' + topPxPerScrollPx);
    // console.log('imageTopPosition: ' + imageTopPosition);

    image.style.top = imageTopPosition + 'px';
  };

  var offset = function (el) {
    var rect = el.getBoundingClientRect();

    return {
      top: rect.top + document.body.scrollTop,
      left: rect.left + document.body.scrollLeft,
    };
  };

  return {
    init: init,
  };
}(document));

/**
 * Init Header Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.bs-js-picture-parallax')) {
    BsPictureParallax.init();
  }
});

/**
 * Bs Input Masks (anchor)
 */
var InputMasks = (function () {
  // Elements
  var elements = {};
  var $ = elements;
  $.body = document.querySelector('body');
  $.input = document.querySelectorAll('.bs-js-inputmask, input');

  // Config
  var config = {
    masks: {
      cpf: {
        mask: '000.000.000-00',
      },
      cnpj: {
        mask: '00.000.000/0000-00',
      },
      'cpf-cnpj': {
        mask: [
          {
            mask: '000.000.000-00',
          },
          {
            mask: '00.000.000/0000-00',
          },
        ],
      },
      rg: {
        mask: '00.000.000-[*]',
      },
      bin: {
        mask: '0000 00',
      },
      'activation-code': {
        mask: '000000',
      },
      cartao: {
        mask: '0000 0000 0000 0000',
      },
      cep: {
        mask: '00.000-000',
      },
      tel: {
        mask: [
          {
            mask: '(00) 0000-0000',
          },
          {
            mask: '(00) [0]0000-0000',
          },
        ],
      },
      data: {
        mask: [
          {
            mask: '00/00/0000',
          },
          // {
          //   mask: Date,
          //   // no funciona com / ou -
          //   pattern: 'd.m.Y',
          //   groups: {
          //     d: new IMask.MaskedPattern.Group.Range([1, 31]),
          //     m: new IMask.MaskedPattern.Group.Range([1, 12]),
          //     Y: new IMask.MaskedPattern.Group.Range([1900, 9999]),
          //   },
          //   lazy: false,
          // },
        ],
      },
      datarange: {
        mask: [
          {
            mask: '00/00/0000 - 00/00/0000',
          },
          // {
          //   mask: Date,
          //   // no funciona com / ou -
          //   pattern: 'd.m.Y',
          //   groups: {
          //     d: new IMask.MaskedPattern.Group.Range([1, 31]),
          //     m: new IMask.MaskedPattern.Group.Range([1, 12]),
          //     Y: new IMask.MaskedPattern.Group.Range([1900, 9999]),
          //   },
          //   lazy: false,
          // },
        ],
      },
      dia: {
        mask: Number,
        min: 0,
        max: 31,
      },
      mes: {
        mask: Number,
        min: 0,
        max: 12,
      },
      ano: {
        mask: Number,
        min: 0,
        max: 9999,
      },
      /* No utilizado, verso com campo de digitao errada
        dimdim: {
          mask: '[000.000.000.000.00]0,00',
        },
      */
      dinheiro: {
        preffix: '',
        suffix: '',
        fixed: true,
        fractionDigits: 2,
        decimalSeparator: ',',
        thousandsSeparator: '.',
        autoCompleteDecimal: false,
      },
      num: {
        mask: '0',
      },
      porcentagem: {
        mask: '0[00]%',
      },
      altura: {
        mask: '[000],`[00]',
      },
      peso: {
        mask: '[000],`[00]',
      },
      placacarro: {
        mask: 'aaa{-}0000',
      },
      ddd: {
        mask: '00',
      },
    },
    teste: {}
  };

  var init = function () {
    Array.prototype.forEach.call($.input, function (el) {
      maskPattern(el);
    });
  };

  var maskPattern = function (element) {
    var maskConfig = config.masks[element.dataset.mask];
    var cb;
    var mask;

    if (!maskConfig) return;

    cb = maskConfig.cb ? maskConfig.cb : null;

    if (element.dataset.mask === 'dinheiro') {
      element.value = SimpleMaskMoney.setMask(element, maskConfig);
    } else {
      if (!maskConfig.mask) return;
      mask = new IMask(element, maskConfig);
    }

    config.teste[element.getAttribute('id')] = mask;

    if (typeof cb === 'function') cb(element, mask, maskConfig);
  };

  var destroyMask = function(el) {
    var id = el.getAttribute('id');
    var unmasked =  config.teste[id].unmaskedValue;

    config.teste[id].destroy();
    el.value = unmasked;
  }

  var updateMask = function(el) {
    maskPattern(el);
  }

  var createMask = function(el) {
    maskPattern(el);
  }

  return {
    config: config,
    create: createMask,
    destroy: destroyMask,
    init: init,
    update: updateMask
  };
}());

/**
 * Init InputMasks Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-js-inputmask, input').length) {
    InputMasks.init();
  }
});

/**
 * Cria uma nova instncia do Google Maps para ser exibido na pgina
 * @param {Element} mapElement Elemento que ir exibir o mapa.
 * @param {Object} options Objeto com as opes de configurao do mapa.
 * Contm locations e mapOptions
 */

/* var options = {
  // altura do mapa em pixels
  mapHeight: 500,
  locations: [
    {
      // id do elemento HTML relacionado  localidade exibida no mapa
      id: 0,
      // latitude da localidade
      lat: -25.428183,
      // longitude da localidade
      lng: -49.267073,
      // funo usada ao clicar no marker no mapa
      fn: function () { return someFunction(); },
      // pequeno modal exibido ao clicar no marker no mapa
      infoWindow: {
        show: false,
        title: 'Ttulo 1',
      },
    },
    {
      id: 1,
      lat: -25.430209,
      lng: -49.264646,
      fn: function () { return someFunction(0); },
      infoWindow: {
        show: false,
        title: 'Ttulo 2',
      },
    },
    {
      id: 2,
      lat: -25.431762,
      lng: -49.270385,
      fn: function () { return someFunction(0); },
      infoWindow: {
        show: false,
        title: 'Ttulo 3',
      },
    },
  ],
  // objeto com opes do Google Maps
  mapOptions: {
    zoom: 14,
    center: new google.maps.LatLng(-25.427702, -49.265159),
    mapTypeId: google.maps.MapTypeId.ROADMAP,
  },
};

BsMaps.init(mapElement, options); */

var BsMaps = (function () {
  var config = {
    // indica se o marker est selecionado
    selectedMarker: false,
    infoWindow: null,
    icons: {
      path: 'assets/img/icons/',
      marker: 'map-marker.svg',
      selectedMarker: 'map-marker-selected.svg',
      size: {
        height: 32,
        width: 20,
      },
    },
    map: null,
    options: null,
    bounds: null,
    geocoder: null,
  };

  var init = function (mapElement, options) {

    if (options) config.options = options;
    if (mapElement) {
      // Cria uma nova instncia do Google Maps
      config.map = createMap(mapElement, options.mapOptions);
      config.bounds = new google.maps.LatLngBounds();
      config.geocoder = new google.maps.Geocoder();
      window.mapTeste = config.map;

      // Define a altura do mapa
      if (options.mapHeight) {
        mapElement.style.height = options.mapHeight + 'px';
      }

      // Insere os marcadores
      if (options.locations.length) {
        options.locations.forEach(function (location) {
          if (location.address) {
            config.geocoder.geocode({
              address: location.address + ', Brasil',
              region: 'BR',
            }, function (results, status) {
              if (status == google.maps.GeocoderStatus.OK) {
                if (results.length) {
                  var latitude = results[0].geometry.location.lat();
                  var longitude = results[0].geometry.location.lng();

                  location.lat = latitude;
                  location.lng = longitude;

                }
              }
              addMarker(config.map, location);
            });
          } else {
            addMarker(config.map, location);
          }
        });
      }
    }
  };

  var ajustCenterZoom = function () {
    var locations = config.options.locations;
    if (locations.length > 1) {
      if (config.bounds) {
        config.map.fitBounds(config.bounds); // auto-zoom
        config.map.panToBounds(config.bounds); // auto-center
      }
    } else {
      config.map.setCenter(new google.maps.LatLng(locations[0].lat, locations[0].lng));
    }
  };

  /**
   * Cria uma nova instncia do mapa
   * @param {Element} mapElement DOM element do mapa
   * @param {Object} mapOptions Opes de inicializao do Google Maps
   * https://developers.google.com/maps/documentation/javascript/tutorial#MapOptions
   * @return {Object} Instncia do Google Maps
  */
  var createMap = function (mapElement, mapOptions) {
    return new google.maps.Map(mapElement, mapOptions);
  };

  /**
   * Adiciona um marker (pin) no mapa
   * @param {Object} map      Instncia do Google Maps
   * @param {Array}  location Ttulo, latitude e longitude do marker
   * @param {String} icon     Imagem
  */
  var addMarker = function (map, location, icon) {
    var marker;
    var infoWindow = null;

    if (icon) config.icons.marker = icon;

    marker = new google.maps.Marker({
      position: new google.maps.LatLng(location.lat, location.lng),
      map: map,
      icon: {
        url: config.icons.path + config.icons.marker,
        // usar scaledSize em todo setIcon()
        scaledSize: new google.maps.Size(config.icons.size.width, config.icons.size.height),
      },
    });

    config.bounds.extend(new google.maps.LatLng(location.lat, location.lng));
    ajustCenterZoom();

    if (location.infoWindow) {
      infoWindow = new google.maps.InfoWindow({
        content: location.infoWindow.title,
      });
    }

    if (location.fn || infoWindow) {
      marker.addListener('click', function () {
        if (infoWindow) {
          updateActiveInfoWindow(infoWindow);
          infoWindow.close();
          infoWindow.open(map, marker);
        }

        if (location.fn) {
          location.fn();
        }

        _toggleSelectedMarkerIcon(this);
      });
    }
  };

  // Deixa ou retira o Marker como selecionado
  var _toggleSelectedMarkerIcon = function (marker) {
    if (config.selectedMarker) {
      config.selectedMarker.setIcon({
        url: config.icons.path + config.icons.marker,
        scaledSize: new google.maps.Size(config.icons.size.width, config.icons.size.height),
      });
    }

    marker.setIcon({
      url: config.icons.path + config.icons.selectedMarker,
      scaledSize: new google.maps.Size(config.icons.size.width, config.icons.size.height),
    });
    config.selectedMarker = marker;
  };

  // Cria uma nova InfoWindow
  var updateActiveInfoWindow = function (infoWindow) {
    if (config.infoWindow) config.infoWindow.close();
    config.infoWindow = infoWindow;
  };

  /**
   Get User Location Coords
   * @return {Object} Coords (lat, lng) of user location
   */
  var getUserLocationCoords = function () {
    return getUserLocation(function (position) {
      return {
        lat: position.coords.latitude,
        lng: position.coords.longitude,
      };
    });
  };

  // need more tests
  var getCoordinatesFromAddress = function (address) {
    var geocoder = new google.maps.Geocoder();

    geocoder.geocode({ address: address }, function (results, status) {
      if (status === google.maps.GeocoderStatus.OK) {
        var pos = {
          lat: results[0].geometry.location.lat(),
          lng: results[0].geometry.location.lng(),
        };
        return pos;
      }
    });
  };

  /**
   * get Address From Coordinates
   * @param  {Number}   lat latitude
   * @param  {Number}   lng longitude
   * @param  {Function} cb  calback fnction
   * @return {Function}     callback funcion with addresses as parameter
   */
  var getAddressFromCoordinates = function (lat, lng, cb) {
    var geocoder = new google.maps.Geocoder();
    var latlng = new google.maps.LatLng(lat, lng);

    if (typeof cb !== 'function') cb = function () {};

    return geocoder.geocode({ latLng: latlng }, function (results, status) {
      if (status === google.maps.GeocoderStatus.OK) {
        return cb(results);
      }
    });
  };

  /**
   * Get User Location
   * @param  {Function} cb  calback fnction
   * @return {Function}     callback funcion with addresses as parameter
   */
  var getUserLocation = function (cb) {
    if (typeof cb !== 'function') cb = function () {};

    if (navigator.geolocation && typeof cb === 'function') {
      return navigator.geolocation.getCurrentPosition(cb, function (error) {
        return cb('Erro: O servio de geolocalizao falhou.', error);
      });
    }

    // Browser doesn't support Geolocation
    return cb(null, 'Erro: O seu navegador no possui suporte  geolocalizao.');
  };

  /**
   * getLocationByTypeFromGeocoderAddresses
   *
   * @link https://developers.google.com/maps/documentation/geocoding/intro#Types
   *
   * @param  {Array}    results List of Google Geocoder's addresses by coords
   * @param  {String}  type    Type of the result
   * @param  {Function} cb      a callback function
   */
  var getLocationByTypeFromGeocoderAddresses = function (results, type, cb) {
    var resultByType = null;
    var componentsByType = null;
    var filterType = function (result) {
      return result.types && result.types.includes(type);
    };

    if (typeof cb !== 'function') cb = function () {};
    if (typeof type !== 'function') type = 'administrative_area_level_1';

    if (results && results.length) {
      resultByType = results.filter(filterType);

      componentsByType = resultByType[0].address_components.filter(filterType);

      if (componentsByType.length) {
        cb({
          name: componentsByType[0].long_name,
          initials: componentsByType[0].short_name,
        }, componentsByType);
      } else {
        cb({}, 'Erro: Nenhum componente encontrado para "' + type + '".');
      }
    } else {
      cb({}, 'Erro: Nenhum resultado encontrado para "' + type + '".');
    }
  };

  /**
   * Get Location State
   *
   * @param  {Function} cb callback function
   */
  var getLocationState = function (cb) {
    var type = 'administrative_area_level_1';
    if (typeof cb !== 'function') cb = function () {};

    initGoogleMap(function () {
      getUserLocation(function (position) {
        getAddressFromCoordinates(
          position.coords.latitude,
          position.coords.longitude,
          function (results) {
            getLocationByTypeFromGeocoderAddresses(results, type, cb);
          }
        );
      });
    });
  };

  return {
    init: init,
    addMarker: addMarker,
    createMap: createMap,
    getCoordinatesFromAddress: getCoordinatesFromAddress,
    getAddressFromCoordinates: getAddressFromCoordinates,
    getUserLocation: getUserLocation,
    getLocationState: getLocationState,
  };
}());

if (!Object.values) {
  Object.values = function (o) {
    return Object.keys(o).map(function (k) {
      return o[k];
    });
  };
}

// Use in LightPick
if (!Object.assign) {
  Object.defineProperty(Object, 'assign', {
    enumerable: false,
    configurable: true,
    writable: true,
    value: function(target) {
      'use strict';
      if (target === undefined || target === null) {
        throw new TypeError('Cannot convert first argument to object');
      }

      var to = Object(target);
      for (var i = 1; i < arguments.length; i++) {
        var nextSource = arguments[i];
        if (nextSource === undefined || nextSource === null) {
          continue;
        }
        nextSource = Object(nextSource);

        var keysArray = Object.keys(Object(nextSource));
        for (var nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {
          var nextKey = keysArray[nextIndex];
          var desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);
          if (desc !== undefined && desc.enumerable) {
            to[nextKey] = nextSource[nextKey];
          }
        }
      }
      return to;
    }
  });
};

(function (arr) {
  arr.forEach(function (item) {
    if (item.hasOwnProperty('remove')) {
      return;
    }
    Object.defineProperty(item, 'remove', {
      configurable: true,
      enumerable: true,
      writable: true,
      value: function remove() {
        this.parentNode.removeChild(this);
      }
    });
  });
})([Element.prototype, CharacterData.prototype, DocumentType.prototype]);

if (!Array.prototype.includes) {
  Object.defineProperty(Array.prototype, 'includes', {
    value: function(searchElement, fromIndex) {

      // 1. Let O be ? ToObject(this value).
      if (this == null) {
        throw new TypeError('"this" is null or not defined');
      }

      var o = Object(this);

      // 2. Let len be ? ToLength(? Get(O, "length")).
      var len = o.length >>> 0;

      // 3. If len is 0, return false.
      if (len === 0) {
        return false;
      }

      // 4. Let n be ? ToInteger(fromIndex).
      //    (If fromIndex is undefined, this step produces the value 0.)
      var n = fromIndex | 0;

      // 5. If n  0, then
      //  a. Let k be n.
      // 6. Else n < 0,
      //  a. Let k be len + n.
      //  b. If k < 0, let k be 0.
      var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);

      // 7. Repeat, while k < len
      while (k < len) {
        // a. Let elementK be the result of ? Get(O, ! ToString(k)).
        // b. If SameValueZero(searchElement, elementK) is true, return true.
        // c. Increase k by 1.
        // NOTE: === provides the correct "SameValueZero" comparison needed here.
        if (o[k] === searchElement) {
          return true;
        }
        k++;
      }

      // 8. Return false
      return false;
    }
  });
}

// // Use in LightPick
// if (!String.prototype.startsWith) {
//   String.prototype.startsWith = function(searchString, position) {
//     position = position || 0;
//     return this.indexOf(searchString, position) === position;
//   };
// };
/**
 * Shift-select Multiple Items
 * Select all checkboxes between lastChecked and currentChecked if
 * shiftKey is pressed during click
 *
 * @Use the function receive an array of checkboxes
 * and active the shiftSelect only for this array
 *
 * @param {Array} checkboxes  an array of checkbox DOM elements
 */
var shiftSelectMultipleCheckboxes = function (checkboxes) {
  var config = {
    lastInputChecked: null,
  };

  /**
   * Init
   */
  var init = function () {
    if (checkboxes.length) {
      Array.prototype.forEach.call(checkboxes, function (checkbox) {
        checkbox.addEventListener('click', shiftSelect);
      });
    }
  };

  /**
   * shift Select on Change
   * @param  {Object} e  a click event in a checkbox
   */
  var shiftSelect = function (e) {
    var input = e.target;
    var start = null;
    var end = null;

    if ((input || {}).type !== 'checkbox') return;

    if (!config.lastInputChecked) {
      config.lastInputChecked = input;
      return;
    }

    if (e.shiftKey) {
      start = Array.prototype.indexOf.call(checkboxes, config.lastInputChecked);
      end = Array.prototype.indexOf.call(checkboxes, input);

      if (Math.abs(start - end) > 1) {
        Array.prototype.slice.apply(checkboxes, [
          Math.min(start, end),
          Math.max(start, end) + 1,
        ]).forEach(function (item) {
          item.checked = true;
        });
      }
    }

    config.lastInputChecked = input;
  };

  init();
};

/**
 * Init Modal Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  var selectors = document.querySelectorAll('.bs-js-shift-select');
  if (selectors.length) {
    Array.prototype.forEach.call(selectors, function (selection) {
      var checkboxes = selection.querySelectorAll('input[type="checkbox"]');
      if (checkboxes.length) {
        shiftSelectMultipleCheckboxes(checkboxes);
      }
    });
  }
});

// https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/String/includes#Implementa%C3%A7%C3%A3o
if (!String.prototype.includes) {
  String.prototype.includes = function() {'use strict';
    return String.prototype.indexOf.apply(this, arguments) !== -1;
  };
}

/**
 * Sort table
 *
 * Reference:
 * https://github.com/tristen/tablesort
 */
var BsTableSort = (function () {
  var init = function (table) {
    if (table) Tablesort(table);
  };

  return {
    init: init,
  };
}());

/**
 * Multiline text Ellipsis (shave.js)
 *
 * Reference:
 * https://github.com/dollarshaveclub/shave
 */
var BsTextEllipsis = (function () {
  // Config
  var config = {
    element: '',
    maxHeight: null,
  };

  var init = function (options) {
    config.element = options.element;
    config.maxHeight = options.maxHeight;
    ellipsis();
  };

  var ellipsis = function () {
    shave(config.element, config.maxHeight);
  };

  return {
    init: init,
  };
}());

/**
 * Bs Text Typer
 *
 * Reference:
 * https://codepen.io/hi-im-si/pen/DHoup
 * [TODO] Improve: https://codepen.io/danielgroen/pen/VeRPOq
 * [TODO] Extend: https://github.com/nk-o/jarallax/blob/master/src/jarallax.js#L206
 */
var BsTextType = function () {
  // Config
  var config = {
    textArr: null,
    el: null,
    loopNum: 0,
    pauseTime: 2000,
    writeTime: 100,
    delTime: 50,
    txt: '',
    tick: tick,
    isDeleting: false,
    fullTxt: '',
    tag: '',
    tagName: 'span',
    tagClass: '',
  };

  var init = function (options) {
    config.textArr = options.textArr;
    config.el = options.el;
    config.pauseTime = options.pauseTime;
    config.el.innerHTML = '<' + config.tagName + ' class="bs-texttype ' + config.tagClass + '"></' + config.tagName + '>';
    config.tag = config.el.querySelector('.bs-texttype');
    tick();
  };

  var tick = function () {
    var delta = config.writeTime;
    var i = config.loopNum % config.textArr.length;

    config.fullTxt = config.textArr[i];

    if (config.isDeleting) {
      config.txt = config.fullTxt.substring(0, config.txt.length - 1);
    } else {
      config.txt = config.fullTxt.substring(0, config.txt.length + 1);
    }

    config.tag.innerHTML = config.txt;

    if (config.isDeleting) { delta = config.delTime; }

    if (!config.isDeleting && config.txt === config.fullTxt) {
      delta = config.pauseTime;
      config.isDeleting = true;
    } else if (config.isDeleting && config.txt === '') {
      config.isDeleting = false;
      config.loopNum++;
      delta = config.writeTime;
    }

    setTimeout(function () {
      tick();
    }, delta);
  };

  return {
    init: init,
  };
};

/**
 * Funo para clicar em botes e exibir o contedo relacionado
*/
var BsToggleContent = function () {
  var config = {
    options: {
      // Botes que, ao serem clicados, exibiro o respectivo container de contedo
      buttons: [],
      // Containeres de contedo
      containers: [],
      // Classe CSS indicando que o boto est ativo
      activeButtonClass: '',
      // Classe CSS para exibir o container
      activeContainerClass: '',
      // Mtodo de ativao da funo: 'click' ou 'hashChange'
      method: '',
      // Se verdadeiro, a pgina ir dar scroll at o
      // contedo ao disparar o evento de showContainerContent
      scrollToContent: false,
    },
  };

  /**
   * Inicializa a funo
   * @param {Object} options opes de configurao
  */
  var init = function (options) {
    if (options.buttons.length > 0 && options.containers.length > 0) {
      config = options;
      _showContentOnPageLoad();

      if (config.method === 'click') {
        Array.prototype.forEach.call(config.buttons, function (button) {
          button.addEventListener('click', function (e) {
            e.preventDefault();
            var attrHref = e.target.getAttribute('href');
            var attrLink = (attrHref) ? attrHref.split('#')[1] : null;
            var containerId = button.dataset.contentButton || attrLink;
            if (containerId) {
              _deactivateButtons();
              _activateButton(button);
              showContainerContent(containerId);
              if (config.scrollToContent) _scrollToContent(containerId);
            }
          });
        });
      } else if (config.method === 'hashChange') {
        window.addEventListener('hashchange', function () {
          var containerId = getHash();
          if (containerId) {
            showContainerContent(containerId);
            if (config.scrollToContent) _scrollToContent();
          }
        });
      }
    }
  };

  var _scrollToContent = function (containerId) {
    var scroll = new SmoothScroll();
    var hash = getHash();
    var attrLink = containerId;

    var anchor = hash || attrLink;

    if (anchor) {
      var containerContent = document.querySelector('[data-content-container="' + anchor + '"]');
      if (containerContent) {
        scroll.animateScroll(containerContent, 300, {
          updateURL: false,
        });
      }
    }
  };

  /**
   * Exibe o contedo caso a hash da URL corresponda a um contedo existente na pgina
  */
  var _showContentOnPageLoad = function () {
    var containerId = getHash();
    if (containerId) {
      var content = document.querySelector('[data-content-container="' + containerId + '"]');
      if (content) {
        hideContainerContent(config.containers);
        showContainerContent(containerId);
      }
    }
  };

  /**
   * Ativa o botao clicado
   * @param {Element} button Boto que receber a classe ativa
   * @param {String} activeButtonClass Classe CSS indicando que o boto est ativo
  */
  var _activateButton = function (button) {
    button.classList.add(config.activeButtonClass);
  };

  /**
   * Remove classe de ativa de todos os botes
   * @param {Array} buttons Botes que, ao serem clicados, exibiro o respectivo
   * container de contedo
   * @param {String} activeButtonClass Classe CSS indicando que o boto est ativo
  */
  var _deactivateButtons = function () {
    Array.prototype.forEach.call(config.buttons, function (button) {
      button.classList.remove(config.activeButtonClass);
    });
  };

  /**
   * Exibe o contedo do container
   * @param {String} containerId Id do container a ser exibido
  */
  var showContainerContent = function (containerId) {
    if (containerId) {
      hideContainerContent(config.containers, config.activeContainerClass);

      var content = document.querySelector('[data-content-container="' + containerId + '"]');
      if (content) content.classList.add(config.activeContainerClass);
    }
  };

  /**
   * Esconde todos os containeres de contedo
   * @param {Array} containers Containeres de contedo
   * @param {String} activeContainerClass Classe CSS utilizada para exibir o contedo
  */
  var hideContainerContent = function (containers) {
    Array.prototype.forEach.call(containers, function (container) {
      container.classList.remove(config.activeContainerClass);
    });
  };

  return {
    init: init,
    hideContainers: hideContainerContent,
    showContainer: showContainerContent,
  };
};


document.addEventListener('DOMContentLoaded', function () {
  var elem = document.querySelector('.bs-js-tab--default');

  if (elem) {
    var buttons = elem.querySelectorAll('[data-content-button]');
    var containers = elem.querySelectorAll('[data-content-container]');

    var options = {
      buttons: buttons,
      containers: containers,
      activeButtonClass: 'bs-is-active',
      activeContainerClass: 'bs-is-active',
      method: 'click',
    };

    var newToggleContent = new BsToggleContent();
    newToggleContent.init(options);
  }
});


/**
 * Youtube Player Iframe API
 */
var BsYTPlayers = (function () {
  // Elements
  var config = {
    videos: {},
  };

  var init = function (videos) {
    if (!videos.length) return;
    config.videos = Array.prototype.reduce.call(videos, function (obj, video) {
      var cryptoObj = window.crypto || window.msCrypto; // for IE 11
      video.id = cryptoObj.getRandomValues(new Uint32Array(1))[0];
      obj[video.id] = {
        el: video,
        player: null,
      };
      return obj;
    }, {});

    includeIframeAPI();
  };

  /**
   * Include Iframe API
   * Loads the IFrame Player API code asynchronously.
   */
  var includeIframeAPI = function () {
    var tag = document.createElement('script');
    tag.src = 'https://www.youtube.com/iframe_api';
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
  };

  window.onYouTubeIframeAPIReady = function () {
    BsYTPlayers.setPlayers();
  };

  var setPlayers = function () {
    Object.keys(config.videos).forEach(function (key) {
      var item = config.videos[key];
      item.player = new YT.Player(key, {
        // events: {
        //   onReady: function (event) {
        //     debugger;
        //   }
        // }
      });
    });
  };

  var getPlayer = function (videoId) {
    if (config.videos[videoId]) {
      return config.videos[videoId].player;
    }
  };

  return {
    init: init,
    setPlayers: setPlayers,
    getPlayer: getPlayer,
  };
}());

/**
 * Init BsFormValidate Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  var videos = document.querySelectorAll('.bs-video');
  if (videos.length) {
    BsYTPlayers.init(videos);
  }
});

var BsAbaNav = (function () {

   var config = {
    aba: document.querySelector('.bs-aba-nav'),
    content: document.querySelector('.bs-aba-nav__content'),
    navContent: document.querySelector('.bs-aba-nav__navigation'),
    navFake: document.querySelector('.bs-aba-nav__fake-selection'),
    navItem: document.querySelectorAll('.bs-aba-nav__navigation-item'),
    contentItem: document.querySelectorAll('.bs-aba-nav__content-item'),
    navContentActive: 'bs-aba-nav__navigation--active',
    navActive: 'bs-aba-nav__navigation-item--active',
    contentActive: 'bs-aba-nav__content-item--active',
  };

  var browserType = /Trident/.test(navigator.userAgent);

  var init = function () {
    var width = window.innerWidth;

    navSizeActive(width, config.contentItem, config.contentActive);
    navSizeActive(width, config.navItem, config.navActive);

    window.addEventListener('resize', function () {
      width = window.innerWidth;
      navSizeActive(width, config.contentItem, config.contentActive);
      navSizeActive(width, config.navItem, config.navActive);
    });

    Array.prototype.forEach.call(config.navItem, function (e, index) {
      e.addEventListener('click', function (item) {

        var topElement = config.aba.offsetTop;
        var selected = item.currentTarget;

        config.navFake.style.transform = 'translate3d(0, ' + index + '00%, 0)';

        Array.prototype.forEach.call(config.navItem, function (el) {
          el.classList.remove(config.navActive);
          el.tabIndex = -1;
        });

        selected.classList.add(config.navActive);
        selected.tabIndex = 0;
        var dataNav = selected.getAttribute('data-ref');
        item.preventDefault();

        Array.prototype.forEach.call(config.contentItem, function (el) {
          var dataContent = el.id;
          var close = el.querySelector('.bs-js-aba-nav-close');

          if (width < '576') {

            config.navContent.classList.add(config.navContentActive);
            window.scrollTo(0, topElement - 20);

            close.addEventListener('click', function () {
              closeContent(el, e);
              config.navContent.classList.remove(config.navContentActive);
            });
          }


          if (dataContent !== dataNav) {
            closeContent(el);
          } else {
            openContent(el);
          }
        });
      });

      e.addEventListener('focus', function (item) {

        var selected = item.currentTarget.tabIndex;

        if (selected === 0) {
          Array.prototype.forEach.call(config.navItem, function (el) {
            el.tabIndex = 1;
          });
        }

      });
    });
  };


  var closeContent = function (el, e) {
    el.classList.remove(config.contentActive);
    el.setAttribute('aria-modal', 'false');
    el.tabIndex = -1;
  };

  var openContent = function (el) {
    el.classList.add(config.contentActive);
    el.tabIndex = 0;
    el.setAttribute('aria-modal', 'true');

    if (!browserType) {
      el.focus({ preventScroll: true });
    }
  };

  var navSizeActive = function (width, item, active) {
    Array.prototype.forEach.call(item, function (e, index) {
      e.classList.remove(active);

      if (width < '576' && e.classList.contains(active)) {
        e.classList.remove(active);
      } else if (width >= '576' && index === 0) {
        e.classList.add(active);
      }

      config.navFake.style.transform = 'translate3d(0, 0%, 0)';
    });
  };

  return {
    init: init,
  };
}());

/**
 * Init Aba Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-aba-nav').length) {
    BsAbaNav.init();
  }
});

/**
 * Bs Accessibility
 *
 */
var BsAccessibility = (function () {
  // Config
  var config = {
    html: document.querySelector('html'),
    body: document.querySelector('body'),
    increaseButton: document.querySelectorAll('.bs-js-increase-font'),
    decreaseButton: document.querySelectorAll('.bs-js-decrease-font'),
    contrastButtons: document.querySelectorAll('.bs-js-change-contrast'),
    librasButton: document.querySelectorAll('.bs-js-libras'),
    allImages: document.querySelectorAll('img'),
    fontSizeBase: 16,
    fontSizeMin: 14,
    fontSizeMax: 18,
    heightMax: 365,
    heightMin: 315,
    contrast: {
      // grayscale: 'bs-contrast--grayscale',
      highColor: 'bs-contrast--high',
    },
    grayscaleClass: 'bs-contrast__image',
    isIE: /Trident/.test(navigator.userAgent),
  };

  var init = function () {
    var contrastArr = [];

    for (key in config.contrast) {
      if (config.contrast.hasOwnProperty(key)) {
        // Se no for IE, adiciona todos
        if (!detectIE()) {
          contrastArr.push(config.contrast[key]);
        } else if (key !== 'grayscale') {
          contrastArr.push(config.contrast[key]);
        }
      }
    }


    // Have problems with cross origin images
    // if (getIEVersion() >= 10) {
    //   generateGrayscaleImages();
    // }

    click(config.increaseButton, increaseFontSize);
    click(config.decreaseButton, decreaseFontSize);
    click(config.contrastButtons, toggleContrast);
    click(config.librasButton, openLibras);
    click(config.librasButton, openLibras);

    checkContrastOnLoad();
    setTabIndexLogo();

    Array.prototype.forEach.call(config.contrastButtons, function (button) {
      if (config.isIE) showHighContrastIEMessageOnFirstClick(button);
    });
  };

  var increaseFontSize = function () {
    if (getCurrentFontSize() === config.fontSizeMax) return;
    config.html.style.fontSize = (getCurrentFontSize() + 1) + 'px';


    // Reload Carroussel de Produtos
    var carousel = document.querySelectorAll('.bs-js-carrousel-prod .bs-media__list--linear');
    for (i = 0; i < carousel.length; i++) {
      var el_viewport = carousel[i].getElementsByClassName("flickity-viewport");

      var flkty = Flickity.data(carousel[i]);

      for (j = 0; j < el_viewport.length; j++) {
        var card = el_viewport[j].getElementsByClassName("bs-media__item");

        for (let x = 0; x < card.length; x++) {
          var card_img = card[x].getElementsByClassName("bs-media__figure")
          var card_desc = card[x].getElementsByClassName("bs-media__text")

          if (x == 0) {
            var calc = card_img[0].clientHeight + card_desc[0].clientHeight;
          } else {
            if (calc < card_img[0].clientHeight + card_desc[0].clientHeight) {
              calc = card_img[0].clientHeight + card_desc[0].clientHeight;
            }
          }
        }
        if (config.isIE) {
          el_viewport[j].style.height = (calc + 30) + 'px';
        } else {
          el_viewport[j].style.height = calc + ('px');
        }
      }


      if (flkty) {
        flkty.reloadCells();
        flkty.resize();
      }
    }

    // Reload Abas Card
    var carousel = document.querySelectorAll('.bs-tabs__panel--slider');
    for (i = 0; i < carousel.length; i++) {
      var flkty = Flickity.data(carousel[i]);

      if (flkty) {
        flkty.reloadCells();
        flkty.resize();
      }
    }

    // Reload Abas Card
    var carousel = document.querySelectorAll('.bs-tabs__list');
    for (i = 0; i < carousel.length; i++) {
      var flkty = Flickity.data(carousel[i]);

      if (flkty) {
        flkty.resize();
        setTimeout(function () {
          flkty.reloadCells();
        }, 1000);
      }
    }

  };

  var decreaseFontSize = function () {
    if (getCurrentFontSize() === config.fontSizeMin) return;
    config.html.style.fontSize = (getCurrentFontSize() - 1) + 'px';
    // Reload Abas Card
    var carousel = document.querySelectorAll('.bs-tabs__panel--slider');
    for (i = 0; i < carousel.length; i++) {
      var flkty = Flickity.data(carousel[i]);

      if (flkty) {
        flkty.reloadCells();
        flkty.resize();
      }
    }

    // Reload Carroussel de Produtos
    var carousel = document.querySelectorAll('.bs-js-carrousel-prod .bs-media__list--linear');
    for (i = 0; i < carousel.length; i++) {
      var el_viewport = carousel[i].getElementsByClassName("flickity-viewport");

      var flkty = Flickity.data(carousel[i]);

      for (j = 0; j < el_viewport.length; j++) {
        var card = el_viewport[j].getElementsByClassName("bs-media__item");

        for (let x = 0; x < card.length; x++) {
          var card_img = card[x].getElementsByClassName("bs-media__figure")
          var card_desc = card[x].getElementsByClassName("bs-media__text")

          if (x == 0) {
            var calc = card_img[0].clientHeight + card_desc[0].clientHeight;
          } else {
            if (calc < card_img[0].clientHeight + card_desc[0].clientHeight) {
              calc = card_img[0].clientHeight + card_desc[0].clientHeight;
            }
          }
        }
        if (config.isIE) {
          el_viewport[j].style.height = (calc + 30) + 'px';
        } else {
          el_viewport[j].style.height = calc + ('px');
        }
      }


      if (flkty) {
        flkty.reloadCells();
        flkty.resize();
      }
    }

    // Reload Abas Card
    var carousel = document.querySelectorAll('.bs-tabs__list');
    for (i = 0; i < carousel.length; i++) {
      var flkty = Flickity.data(carousel[i]);

      if (flkty) {
        flkty.reloadCells();
        flkty.resize();
      }
    }

  };


  var checkContrastOnLoad = function () {
    var storageContrast = localStorage.getItem('bsHighContrastOption');
    if (storageContrast) setContrast(storageContrast);
  };

  var setContrast = function (contrastKey) {
    // remove body contrast classes
    Object.keys(config.contrast).forEach(function (key) {
      document.documentElement.classList.remove(config.contrast[key]);
    });

    // set a new contrast key to body
    if (contrastKey && config.contrast[contrastKey]) {
      Array.prototype.forEach.call(config.contrastButtons, function (button) {
        button.classList.add('bs-is-active');
        button.setAttribute('aria-pressed', 'true');
        button.setAttribute('data-contrast', contrastKey);
      });
      document.documentElement.classList.add(config.contrast[contrastKey]);
      localStorage.setItem('bsHighContrastOption', contrastKey);
      // set a new contrast key to body
    } else {
      Array.prototype.forEach.call(config.contrastButtons, function (button) {
        button.classList.remove('bs-is-active');
        button.setAttribute('aria-pressed', 'false');
        button.setAttribute('data-contrast', '');
      });
      localStorage.setItem('bsHighContrastOption', '');
    }
  };

  var toggleContrast = function () {
    var currentKey = config.contrastButtons[0].getAttribute('data-contrast');
    var contrastArray = Object.keys(config.contrast).map(function (key) {
      return key;
    });
    var currentIdx = contrastArray.indexOf(currentKey);
    var nextIdx;
    var nextKey;

    if (currentIdx < 0) {
      nextIdx = 0;
    } else if (currentIdx < contrastArray.length) {
      nextIdx = currentIdx + 1;
    } else {
      nextIdx = -1;
    }

    nextKey = nextIdx > -1 ? contrastArray[nextIdx] : '';

    setContrast(nextKey);
  };

  var generateGrayscaleImages = function () {
    Array.prototype.forEach.call(config.allImages, function (image) {
      var imgSrc = image.getAttribute('src');
      var grayscaleData = grayscaleImage(imgSrc);
      var newImage = image.cloneNode(true);
      newImage.setAttribute('src', grayscaleData);
      newImage.classList.add(config.grayscaleClass);
      image.parentNode.insertBefore(newImage, image);
    });
  };

  // Esconder cone inicializar libras
  setTimeout(function () {
    var handtalk = document.getElementsByClassName("ht-skip")[0];

    if (handtalk != null) {
      var isOpened = handtalk.querySelectorAll('[x="-10"]');
      if (isOpened.length > 0) {
        setTimeout(function () {
          var btn_libras_close = document.getElementsByClassName("ht-skip")[0].children[0].children[0].children[1].children[0];
          btn_libras_close.addEventListener("click", function () {
            setTimeout(function () {
              document.getElementsByClassName("ht-skip")[0].children[0].children[0].children[0].children[0].style.display = "none";
            }, 100);
          })
        }, 500);
      } else {
        handtalk.children[0].children[0].children[0].children[0].style.display = "none";
      }
    }
  }, 100);


  var openLibras = function () {
    document.getElementsByClassName("ht-skip")[0].children[0].children[0].children[0].children[0].click();

    setTimeout(function () {
      var btn_libras_close = document.getElementsByClassName("ht-skip")[0].children[0].children[0].children[1].children[0];
      btn_libras_close.addEventListener("click", function () {
        setTimeout(function () {
          document.getElementsByClassName("ht-skip")[0].children[0].children[0].children[0].children[0].style.display = "none";
        }, 100);
      })
    }, 500);
  };

  var getCurrentFontSize = function () {
    return parseFloat(window.getComputedStyle(config.html, null).getPropertyValue('font-size'));
  };

  var click = function (elements, callback) {
    var i = 0;
    var l = elements.length;

    for (; i < l; i += 1) {
      elements[i].addEventListener('click', callback);
    }
  };

  /**
   * High Contrast Message for IE11
   * Show a tooltip message the first time the high constrast button is clicked on IE11
   * @param  {[type]} el [description]
   */
  var showHighContrastIEMessageOnFirstClick = function (el) {
    // var el = document.querySelector('.bs-js-change-contrast');
    var storageKey = localStorage.getItem('bsInstHighContrastIEMessageRead');
    var tippyOptions = {
      content: '<div>Para uma melhor experincia, recomendamos o uso dos navegadores <b>Chrome</b>, <b>Edge</b> ou <b>Firefox</b>.</div>',
      trigger: 'manually',
      interactive: true,
      zIndex: 9999,
      boundary: 'window',
    };
    var tippyInstances = tippy(el, tippyOptions);
    var tippyInstance = tippyInstances.instances[0];
    var clicked = false;

    if (el && config.isIE) {
      el.addEventListener('click', function () {
        if (!clicked && !storageKey) {
          tippyInstance.show();
          clicked = true;
          localStorage.setItem('bsInstHighContrastIEMessageRead', 1);
        }
      });
    }
  };

  var setTabIndexLogo = function () {
    var header_logo = document.getElementsByClassName("bs-header__logo");
    if (header_logo[0] != null) {
      var svg = header_logo[0].getElementsByTagName('svg');
      var svg_g = header_logo[0].getElementsByTagName('g');
      var svg_path = header_logo[0].getElementsByTagName('path');
      var svg_rect = header_logo[0].getElementsByTagName('rect');

      if (svg != null) {
        for (i = 0; i < svg.length; i++) {
          svg[i].tabIndex = -1;
        }
      }
      if (svg_g != null) {
        for (i = 0; i < svg_g.length; i++) {
          svg_g[i].tabIndex = -1;
        }
      }
      if (svg_path != null) {
        for (i = 0; i < svg_path.length; i++) {
          svg_path[i].tabIndex = -1;
        }
      }
      if (svg_rect != null) {
        for (i = 0; i < svg_rect.length; i++) {
          svg_rect[i].tabIndex = -1;
        }
      }
    }
  }

  return {
    init: init,
    currentFont: getCurrentFontSize,
    increaseFont: increaseFontSize,
    decreaseFont: decreaseFontSize,
    toggleContrast: toggleContrast,
    generateGrayscaleImages: generateGrayscaleImages,
    setTabIndexLogo: setTabIndexLogo
  };
}());

/**
 * Init Accessibility Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  BsAccessibility.init();
});

var BsAccordion = (function () {

  var config = {
    accordionButton:    document.querySelectorAll('.bs-js-open-accordion'),
    accordion:          document.querySelectorAll('.bs-accordion'),
    accordionContent:   '.bs-js-accordion-content',
    body:               document.querySelector('body'),
    disabledOnDesktop:  'bs-js-accordion-disabled-desktop'
  }

  var modClass = {
    accordionOpenClass: 'bs-accordion__item--open'
  };

  var init = function () {

    // Check if accordion shoud be disabled on desktop
    disableAccordionOnDesktop();

    // Toggle accordion item on click
    for (var i = 0; i < config.accordionButton.length; i += 1) {
      config.accordionButton[i].addEventListener(
        'click',
        toggleAccordionItem.bind(null, config.accordionButton[i])
      );
    }

    window.addEventListener('resize', function () {
      updateContentHeight();
      disableAccordionOnDesktop();
    });

    Array.prototype.forEach.call(config.accordion, function (el) {
      el.addEventListener('keydown', handleAccordionKeyboard);
    });
  };

  var toggleAccordionItem = function (element) {
    if (isAccordionOpen(element)) closeAccordionItem(element);
    else openAccordionItem(element);
  };

  var isAccordionOpen = function (element) {
    var item = getParent(element, 'bs-accordion__item');
    return item.classList.contains(modClass.accordionOpenClass);
  };

  var openAccordionItem = function (openElement) {
    var item = getParent(openElement, 'bs-accordion__item');
    var content = item.querySelector(config.accordionContent);
    var contentHeight = content.scrollHeight;

    openElement.setAttribute('aria-expanded', 'true');
    content.setAttribute('aria-hidden', 'false');

    item.classList.add(modClass.accordionOpenClass);
    content.style.height = contentHeight + 'px';
  };

  var closeAccordionItem = function (closeElement) {
    var item = getParent(closeElement, 'bs-accordion__item');
    var content = item.querySelector(config.accordionContent);
    var contentHeight = content.scrollHeight;

    closeElement.setAttribute('aria-expanded', 'false');
    content.setAttribute('aria-hidden', 'true');

    item.classList.remove(modClass.accordionOpenClass);
    content.style.height = 0;

    fixElementScroll(item);
  };

  // Updates content height on window resize
  var updateContentHeight = function () {
    var items = document.querySelectorAll('.bs-accordion__item');

    Array.prototype.forEach.call(items, function(element, i){
      var content       = element.querySelector(config.accordionContent);
      var contentHeight = content.querySelector('.bs-accordion__box').scrollHeight + 'px';
      var accordion     = getParents(element, config.disabledOnDesktop)[0];

      // If the .bs-js-accordion-content height is different from its content, updates its height
      if( element.classList.contains(modClass.accordionOpenClass) && parseInt(content.style.height) != contentHeight ) {
        content.style.height = contentHeight;
      }


      // If accordion is set to be disabled on desktop, update items height
      if(accordion) {
        if(
          (element.classList.contains(modClass.accordionOpenClass) && parseInt(content.style.height) != contentHeight) ||
          (!element.classList.contains(modClass.accordionOpenClass) && window.innerWidth >= 1200)
        ) {
          content.style.height = contentHeight;
        } else if( !element.classList.contains(modClass.accordionOpenClass) && window.innerWidth < 1200 ) {
          content.style.height = 0;
        }
      }
    });
  }

  // Checks if the accordion should be disabled on desktop
  // and then disable its buttons
  var disableAccordionOnDesktop = function () {
    Array.prototype.forEach.call(config.accordion, function(element, i){
      if(element.classList.contains(config.disabledOnDesktop)) toggleButtons(element);
    });
  }

  // Disable the accordion buttons
  var toggleButtons = function (element) {
    var items = element.querySelectorAll('.bs-js-open-accordion');

    if(window.innerWidth >= 1200) {
      Array.prototype.forEach.call(items, function(el, i){
        el.disabled = true;
      });
    } else {
      Array.prototype.forEach.call(items, function(el, i){
        el.disabled = false;
      });
    }
  }

  // Fix scroll of an element when tabbing focus
  // on an element inside a div who will be hidden
  // after a transition
  var fixElementScroll = function (el) {
    setTimeout(function () {
      el.scrollTo(0, 0);
    }, 300);
  };

  var handleAccordionKeyboard = function (ev) {
    var accordion = ev.currentTarget;
    var currentEl = ev.target;
    var key = ev.key;
    var buttonsNode = accordion.querySelectorAll('.bs-js-open-accordion');
    var buttons = Array.prototype.slice.call(buttonsNode);
    var currentButton = (
      currentEl.classList.contains('bs-js-open-accordion'))
      ? currentEl : currentEl.closest('.bs-js-open-accordion');
    var firstButton = buttons[0];
    var lastButton = buttons[buttons.length - 1];
    var prevButton = buttons.indexOf(currentButton)
      ? buttons[buttons.indexOf(currentButton) - 1]
      : lastButton;
    var nextButton = buttons.indexOf(currentButton) < buttons.length - 1
      ? buttons[buttons.indexOf(currentButton) + 1]
      : firstButton;

    if (currentButton) {
      switch (key) {
        case 'ArrowRight':
          openAccordionItem(currentButton);
          break;
        case 'ArrowLeft':
          closeAccordionItem(currentButton);
          break;
        case 'ArrowDown':
          nextButton.focus();
          break;
        case 'ArrowUp':
          prevButton.focus();
          break;
        case 'Home':
          firstButton.focus();
          break;
        case 'End':
          lastButton.focus();
          break;
        default:
      }
    }
  };

  return {
    init: init,
  };
}());

/**
 * Init Modal Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-accordion').length) {
    BsAccordion.init();
  }
});

var BsAcessoRapido = (function () {

  var init = function () {

    var $boxGeneralComponent = document.querySelector('.bs-nav-menu__box--acesso-rapido');
    var $buttonAcessoRapido = document.querySelector('.bs-nav-menu__primary button');
    var $buttonAcessoRapidoLink = document.querySelector('.bs-nav-menu__primary button');

    $buttonAcessoRapido.addEventListener('click', function (e) {

      $boxGeneralComponent.classList.toggle("open");

      if($boxGeneralComponent.classList.contains("open")){
        $buttonAcessoRapidoLink.setAttribute("aria-expanded", "true");
      }else {
        $buttonAcessoRapidoLink.setAttribute("aria-expanded", "false");
      }
    });
  };

  var adjustHeight = function () {
    let acessoRapido = document.querySelectorAll(".bs-nav-menu__box--acesso-rapido");

    for (let i = 0; i < acessoRapido.length; i++) {
      const ACESSO_RAPIDO_UL = acessoRapido[i].getElementsByTagName("ul")

      if (window.outerWidth > 1024) {
        ACESSO_RAPIDO_UL[0].removeAttribute("style");
        ACESSO_RAPIDO_UL[0].style.height = ACESSO_RAPIDO_UL[0].offsetHeight + "px";
      } else {
        ACESSO_RAPIDO_UL[0].removeAttribute("style");
      }
    }
  }

  var adjustArrowPosition = function() {
    let acessoRapido = document.querySelectorAll(".bs-nav-menu__box--acesso-rapido");

    for (let i = 0; i < acessoRapido.length; i++) {
      const ACESSO_RAPIDO_A = acessoRapido[i].getElementsByClassName("bs-nav-menu__link")[0];
      const ACESSO_RAPIDO_BTN = acessoRapido[i].getElementsByClassName("bs-nav-menu__buttons");
      const ACESSO_RAPIDO_LIST = acessoRapido[i].getElementsByClassName("bs-nav-menu__list")[0];

      if (ACESSO_RAPIDO_BTN.length == 0) {
        ACESSO_RAPIDO_A.classList.add("no-button");
        if (window.outerWidth <= 600) {
          ACESSO_RAPIDO_LIST.style.width = '100%';
        }
      } else {
        acessoRapido[0].classList.add('has-button');
      }      
    }
  }

  return {
    init: init,
    adjustHeight: adjustHeight,
    adjustArrowPosition: adjustArrowPosition
  };
}());

/**
 * Init Acesso Rpido Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-nav-menu__box--acesso-rapido').length) {
    BsAcessoRapido.init();
    BsAcessoRapido.adjustHeight();
    BsAcessoRapido.adjustArrowPosition();
  }
});

window.addEventListener('resize', function() {
  BsAcessoRapido.adjustHeight();
  BsAcessoRapido.adjustArrowPosition();
})

/**
 * Bs Audio
 */
var BsAudio = function (elem, settings) {
  /**
   * General config
   * @type {Object}
   */
  var config = {};

  /**
   * Set Config
   * @param  {Object} el      element
   * @param  {Object} options Custom options
   * @return {Object}         Default options extend by custom
   */
  var setConfig = function (el, options) {
    return extend({
      el: el,
      audio: el.querySelector('.bs-js-audio-src'),
      playButton: el.querySelectorAll('.bs-js-audio-play'),
      pauseButton: el.querySelectorAll('.bs-js-audio-pause'),
      toggleButton: el.querySelectorAll('.bs-js-audio-play-pause'),
      stopButton: el.querySelectorAll('.bs-js-audio-stop'),
      forwardButton: el.querySelectorAll('.bs-js-audio-forward'),
      backwardButton: el.querySelectorAll('.bs-js-audio-backward'),
      startButton: el.querySelectorAll('.bs-js-audio-start'),
      endButton: el.querySelectorAll('.bs-js-audio-end'),
      increaseVolumeButton: el.querySelectorAll('.bs-js-audio-volume-increase'),
      decreaseVolumeButton: el.querySelectorAll('.bs-js-audio-volume-decrease'),
      muteVolumeButton: el.querySelectorAll('.bs-js-audio-volume-mute'),
      progressBar: el.querySelectorAll('.bs-js-audio-progress'),
      progressRange: el.querySelectorAll('.bs-js-audio-progress-range'),
      progressOutput: el.querySelectorAll('.bs-js-audio-progress-output'),
      durationOutput: el.querySelectorAll('.bs-js-audio-duration-output'),
      volumeRange: el.querySelectorAll('.bs-js-audio-volume'),
      volumeOutput: el.querySelectorAll('.bs-js-audio-volume-output'),
      statusOutput: el.querySelectorAll('.bs-js-audio-status'),
      autoplay: false,
    }, options, {
      isPlaying: isPlaying,
      lastVolume: 0,
      duration: 0,
      durationFormated: 0,
      timeInterval: null,
      shouldPlay: null,
      events: {
        play: {},
        stop: {},
        pause: {},
        changeVolume: {},
        changeTime: {},
      },
    });
  };

  var init = function () {
    config = setConfig(elem, settings);

    config.audio.addEventListener('loadeddata', function () {
      config.duration = config.audio.duration;
      config.durationFormated = secondsToTime(config.duration, true).time;

      if (config.progressBar) {
        Array.prototype.forEach.call(config.progressBar, function (el) {
          setProgress(el, 0, 0, config.duration);
        });
      }

      if (config.progressRange) {
        Array.prototype.forEach.call(config.progressRange, function (el) {
          setProgress(el, 0, 0, config.duration);
        });
      }

      if (config.progressOutput) {
        Array.prototype.forEach.call(config.progressOutput, function (el) {
          var currentTime = config.audio.currentTime;
          var currentTimeFormated = secondsToTime(currentTime, true).time;
          var currentTimeText = secondsToTime(currentTime, true).timeText;

          el.textContent = currentTimeFormated;
          el.setAttribute('datetime', currentTimeFormated);
          el.setAttribute('aria-label', 'Tempo atual: ' + currentTimeText);
        });
      }

      if (config.durationOutput) {
        Array.prototype.forEach.call(config.durationOutput, function (el) {
          var textDuration = secondsToTime(config.duration, true).timeText;
          el.textContent = config.durationFormated;
          el.setAttribute('datetime', config.durationFormated);
          el.setAttribute('aria-label', 'Tempo total: ' + textDuration);
        });
      }

      handleVolumeUpdate();

      if (config.playButton) {
        Array.prototype.forEach.call(config.playButton, function (el) {
          el.addEventListener('click', play);
        });
      }

      if (config.pauseButton) {
        Array.prototype.forEach.call(config.pauseButton, function (el) {
          el.addEventListener('click', pause);
        });
      }

      if (config.toggleButton) {
        Array.prototype.forEach.call(config.toggleButton, function (el) {
          el.addEventListener('click', playPause);
        });
      }

      if (config.stopButton) {
        Array.prototype.forEach.call(config.stopButton, function (el) {
          el.addEventListener('click', stop);
        });
      }

      if (config.forwardButton) {
        Array.prototype.forEach.call(config.forwardButton, function (el) {
          el.addEventListener('click', forward);
        });
      }

      if (config.backwardButton) {
        Array.prototype.forEach.call(config.backwardButton, function (el) {
          el.addEventListener('click', backward);
        });
      }

      if (config.startButton) {
        Array.prototype.forEach.call(config.startButton, function (el) {
          el.addEventListener('click', toStart);
        });
      }

      if (config.endButton) {
        Array.prototype.forEach.call(config.endButton, function (el) {
          el.addEventListener('click', toEnd);
        });
      }

      if (config.increaseVolumeButton) {
        Array.prototype.forEach.call(config.increaseVolumeButton, function (el) {
          el.addEventListener('click', increaseVolume);
        });
      }

      if (config.decreaseVolumeButton) {
        Array.prototype.forEach.call(config.decreaseVolumeButton, function (el) {
          el.addEventListener('click', decreaseVolume);
        });
      }

      if (config.muteVolumeButton) {
        Array.prototype.forEach.call(config.muteVolumeButton, function (el) {
          el.addEventListener('click', muteVolume);
        });
      }

      if (config.volumeRange) {
        Array.prototype.forEach.call(config.volumeRange, function (el) {
          el.addEventListener('input', function () {
            var volume = parseFloat(el.value) / 10;
            setVolume(volume);
          });
          el.addEventListener('change', function () {
            var volume = parseFloat(el.value) / 10;
            setVolume(volume);
          });
        });
      }

      if (config.progressRange) {
        Array.prototype.forEach.call(config.progressRange, function (el) {
          el.addEventListener('input', function () {
            setTime(parseFloat(el.value));
          });
          el.addEventListener('change', function () {
            setTime(parseFloat(el.value));
          });
        });
      }

      config.audio.addEventListener('timeupdate', handleTimeUpdate);

      config.audio.addEventListener('volumechange', handleVolumeUpdate);

      if (config.autoplay) {
        play();
      }
    });
  };

  /**
   * Is Playing
   * @return {Boolean} true if audio is playing
   */
  var isPlaying = function () {
    return !config.audio.paused;
    // return config.audio
    //   && config.audio.currentTime > 0
    //   && !config.audio.paused
    //   && !config.audio.ended
    //   && config.audio.readyState > 2;
  };

  /**
   * Toggle play/pause
   */
  var playPause = function () {
    if (isPlaying()) config.audio.pause();
    else config.audio.play();
  };

  /**
   * Play
   */
  var play = function () {
    config.audio.play();
    runEventFunctions('play');
  };

  /**
   * Pause
   */
  var pause = function () {
    config.audio.pause();
  };

  /**
   * Stop
   */
  var stop = function () {
    config.audio.pause();
    config.audio.currentTime = 0;
  };

  /**
   * Skip Forward
   * @param  {Number} seconds how many seconds skip (default: 10)
   */
  var forward = function (seconds) {
    if (typeof seconds !== 'number' || !seconds) seconds = 10;
    changeTime(seconds);
  };

  /**
   * Skip Backward
   * @param  {Number} seconds how many seconds skip (default: 10)
   */
  var backward = function (seconds) {
    if (typeof seconds !== 'number' || !seconds) seconds = 10;
    changeTime(-seconds);
  };

  /**
   * To Start
   */
  var toStart = function () {
    config.audio.currentTime = 0;
    handleTimeUpdate();
  };

  /**
   * To End
   */
  var toEnd = function () {
    if (config.duration) config.audio.currentTime = config.duration;
    handleTimeUpdate();
  };

  /**
   * Change Time
   * @param  {Number} seconds how many seconds skip (default: 10)
   */
  var changeTime = function (seconds) {
    var currentTime = config.audio.currentTime;
    if (typeof seconds !== 'number' || !seconds) return;
    config.audio.currentTime = currentTime + seconds;
    handleTimeUpdate();
  };

  /**
   * Set Audio Time
   * @param  {Number} time specific audio time in seconds
   */
  var setTime = function (time) {
    clearTimeout(config.timeInterval);

    if (config.shouldPlay === null) config.shouldPlay = isPlaying();

    pause();
    changeProgressBar(time);
    changeProgressOutput(time);

    config.timeInterval = setTimeout(function () {
      config.audio.currentTime = time;
      handleTimeUpdate();
      if (config.shouldPlay) play();
      config.shouldPlay = null;
    }, 0);
  };

  /**
   * Increase Volume
   * @param  {Number} step how many decibels to increase (1 - 9)
   */
  var increaseVolume = function (step) {
    if (typeof step !== 'number' || !step) step = 1;
    changeVolume(step);
  };

  /**
   * Decrease Volume
   * @param  {Number} step how many decibels to decrease (1 - 9)
   */
  var decreaseVolume = function (step) {
    if (typeof step !== 'number' || !step) step = 1;
    changeVolume(-step);
  };

  /**
   * Mute Volume
   * @param  {Number} volume how many decibels to decrease (1 - 9)
   */
  var muteVolume = function (volume) {
    var currentDecibels = config.audio.volume;
    if (typeof volume !== 'number' || !volume) volume = 1;
    if (currentDecibels) {
      config.lastVolume = Math.floor(currentDecibels * 10);
      setVolume(0);
    } else {
      setVolume(config.lastVolume);
    }
  };

  /**
   * Change Volume
   * @param  {Number} step how many decibels to increase (1 to 9) or decrease (-1 to -9)
   */
  var changeVolume = function (step) {
    var currentDecibels = config.audio.volume;
    var decibels = 0;

    if (typeof step !== 'number' || !step) step = 1;

    decibels = currentDecibels + (Math.floor(step) / 10);

    if (decibels > 1) decibels = 1;
    if (decibels < 0) decibels = 0;

    if (decibels >= 0 && decibels <= 1) {
      config.audio.volume = parseFloat(decibels.toFixed(1));
      handleVolumeUpdate();
    }
  };

  /**
   * Set Volume
   * @param  {Number} volume specific volume decibels (0 - 10)
   */
  var setVolume = function (volume) {
    var decibels = Math.floor(volume) / 10;
    config.audio.volume = decibels;
  };

  var changeProgressBar = function (time) {
    if (config.progressBar) {
      Array.prototype.forEach.call(config.progressBar, function (el) {
        el.value = time;
      });
    }
  };

  var changeProgressRange = function (time) {
    if (config.progressRange) {
      Array.prototype.forEach.call(config.progressRange, function (el) {
        el.value = time;
      });
    }
  };

  var changeProgressOutput = function (time) {
    var currentTimeFormated = secondsToTime(time, true).time;
    if (config.progressOutput) {
      Array.prototype.forEach.call(config.progressOutput, function (el) {
        el.textContent = currentTimeFormated;
      });
    }
  };

  var handleTimeUpdate = function () {
    var currentTime = config.audio.currentTime;
    changeProgressBar(currentTime);
    changeProgressRange(currentTime);
    changeProgressOutput(currentTime);
  };

  var handleVolumeUpdate = function () {
    var volume = config.audio.volume * 100;

    if (config.volumeRange) {
      Array.prototype.forEach.call(config.volumeRange, function (el) {
        el.value = volume;
      });
    }

    if (config.volumeOutput) {
      Array.prototype.forEach.call(config.volumeOutput, function (el) {
        el.textContent = volume;
        el.value = volume;
      });
    }
  };

  var setProgress = function (element, current, min, max) {
    if (typeof current === 'number') element.value = current;
    if (typeof min === 'number') element.min = min;
    if (typeof max === 'number') element.max = max;
  };

  var secondsToTime = function (pureSeconds, hideZeroHour) {
    var date = new Date(null);
    var toLeadingZero = function (time) {
      return (time < 10 ? '0' : '') + time.toString();
    };
    var toText = function (time, singularText) {
      if (time && singularText) {
        return time.toString() + ' ' + singularText + (time > 1 ? 's' : '');
      }
      return '';
    };
    var seconds = parseInt(pureSeconds, 10);
    var hour = Math.floor(seconds / 3600);
    var minute = Math.floor((seconds - (hour * 3600)) / 60);
    var second = Math.floor(seconds - (hour * 3600) - (minute * 60));
    var hourStr = toLeadingZero(hour);
    var minuteStr = toLeadingZero(minute);
    var secondStr = toLeadingZero(second);
    var hourText = toText(hour, 'hora');
    var minuteText = toText(minute, 'minuto');
    var secondText = toText(second, 'segundo');
    var time = minuteStr + ':' + secondStr;
    var timeText = ''
      + (hourText || '')
      + (hourText && (minuteText || secondText) ? ', ' : '')
      + (minuteText || '')
      + (minuteText && secondText ? ', ' : '')
      + (secondText || '');

    if (hour || !hideZeroHour) time = hourStr + ':' + time;

    date.setSeconds(seconds);

    return {
      date: date,
      time: time,
      timeText: timeText,
      timeLocale: date.toLocaleTimeString('pt-br'),
      hour: hour,
      minute: minute,
      second: second,
      hourText: hourText,
      minuteText: minuteText,
      secondText: secondText,
    };
  };

  /**
   * On
   * Add a function (cb) to run during a specific event (ev)
   * @param  {String}   ev event name
   * @param  {Function} cb callback
   */
  var on = function (ev, cb) {
    if (typeof ev !== 'string' || !config.events[ev]) return;
    if (typeof cb !== 'function') return;

    if (cb.name) {
      config.events[ev][cb.name] = cb;
    } else {
      if (config.events[ev].unnamed || !Array.isArray(config.events[ev].unnamed)) {
        config.events[ev].unnamed = [];
      }
      config.events[ev].unnamed.push(cb);
    }
  };

  /**
   * Off
   * remove a function (cb) from a specific event (ev)
   * @param  {String}  ev           event name
   * @param  {String}  functionName function name
   */
  var off = function (ev, functionName) {
    if (typeof ev !== 'string' || !config.events[ev]) return;
    if (typeof functionName !== 'string') return;

    config.events[ev][functionName] = null;
  };

  /**
   * Run Event Functions
   * @param  {String}   ev event name
   */
  var runEventFunctions = function (ev) {
    if (typeof ev !== 'string' || !config.events[ev]) return;
    if (Object.keys(config.events[ev]).length) {
      Object.keys(config.events[ev]).forEach(function (eventKey) {
        if (eventKey === 'unnamed'
          && config.events[ev].unnamed
          && Array.isArray(config.events[ev].unnamed)) {
          config.events[ev].unnamed.forEach(function (fn) {
            fn();
          });
        } else {
          config.events[ev][eventKey]();
        }
      });
    }
  };

  return {
    init: init,
    on: on,
    off: off,
    isPlaying: isPlaying,
    playPause: playPause,
    play: play,
    pause: pause,
    stop: stop,
    forward: forward,
    backward: backward,
    toStart: toStart,
    toEnd: toEnd,
    changeTime: changeTime,
    setTime: setTime,
    increaseVolume: increaseVolume,
    decreaseVolume: decreaseVolume,
    changeVolume: changeVolume,
    setVolume: setVolume,
    changeProgressBar: changeProgressBar,
    changeProgressRange: changeProgressRange,
    changeProgressOutput: changeProgressOutput,
    handleTimeUpdate: handleTimeUpdate,
    handleVolumeUpdate: handleVolumeUpdate,
    setProgress: setProgress,
    secondsToTime: secondsToTime,
  };
};

/**
 * Init Audio Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  var audios = document.querySelectorAll('.bs-js-audio');
  if (audios.length) {
    Array.prototype.forEach.call(audios, function (audio) {
      var audioConstructor = new BsAudio(audio);
      audioConstructor.init();
    });
  }
});

/**
 * Bs Audio Buttons
 */
var BsAudioButtons = (function () {

  var config = {
    buttonPlay: document.querySelector('.bs-js-audio-play'),
    buttonPause: document.querySelector('.bs-js-audio-pause'),
    buttonVolume: document.querySelector('.bs-js-audio-volume-mute'),
    audioVolume: '.bs-js-audio-volume-mute',
    audioVolumeIncrease: '.bs-js-volume-increase',
    audioVolumeMute: '.bs-js-volume-mute',
    rangeInput: document.querySelector('.bs-audio-controls__volume input'),
    output: document.querySelector('.bs-audio-controls__volume output'),
    volumeIcons: '.icon',
    controlOff: 'bs-audio-controls--off',
  };

  var init = function () {

    config.rangeInput.addEventListener('change', function(e) {
      rangeVolume();
      volumeControlRange(e);
    });
    config.rangeInput.addEventListener('input', function() {
      rangeVolume();
    });
    config.buttonPlay.addEventListener('click', function() {
      play();
    });
    config.buttonPause.addEventListener('click', function() {
      pause();
    });
    config.buttonVolume.addEventListener('click', function(button) {
      volumeControl(button);
      // Set range with fake style - timeout prevent pageload
      setTimeout(function () {
        rangeVolume();
      }, 50);
    });
  };

  var rangeVolume = function () {
    var value = config.rangeInput.value;
    config.output.style.width= value + '%';
  }

  var play = function () {
    config.buttonPlay.classList.add(config.controlOff);
    config.buttonPause.classList.remove(config.controlOff);
  };

  var pause = function () {
    config.buttonPlay.classList.remove(config.controlOff);
    config.buttonPause.classList.add(config.controlOff);
  };

  var volumeControl = function (button) {
    var buttonVolumeIcon = button.currentTarget.querySelectorAll(config.volumeIcons);

    Array.prototype.forEach.call(buttonVolumeIcon, function (el) {
      var btnOff = el.classList.contains(config.controlOff);

      if (btnOff) el.classList.remove(config.controlOff);
      else el.classList.add(config.controlOff);

    });
  };

  var volumeControlRange = function (e) {

    // Receive button mute, to get items
    var button = e.currentTarget.parentNode.parentNode.querySelector(config.audioVolume);
    var increase = button.parentNode.querySelector(config.audioVolumeIncrease);
    var mute = button.parentNode.querySelector(config.audioVolumeMute);
    
    var value = config.rangeInput.value;

    if (value !== '0') {
      increase.classList.remove(config.controlOff);
      mute.classList.add(config.controlOff);
    } else {
      increase.classList.add(config.controlOff);
      mute.classList.remove(config.controlOff);
    }
  };

  return {
    init: init,
  };

}());



/**
 * Init Audio Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.bs-js-audio-controls')) {
    BsAudioButtons.init();
  }
});
/**
 * Banner Topo
 * @return Module config
 */
var BsBannerTopo = (function () {
  /**
   * Init function
   * @return {Function} Module's scope functions
   */
  var init = function () {
    // var banners = document.querySelectorAll('.bs-banner');
    var highlights = document.querySelectorAll('.js-banner-title-highlight');
    if (highlights && highlights.length) {
      Array.prototype.forEach.call(highlights, function (el) {
        var data = el.getAttribute('data-highlight');
        highlight(el, data);
      })
    }

    setSlider();
  };

  var highlight = function (el, data) {
    // var textVelocity = 100;
    var pauseTime = 2000;
    // var dataArr = data.split(/[ ,]+/);
    var dataArr = data.split(',');
    // var dataLen = dataArr.length;
    // var i = 0;
    var textType = new BsTextType();

    if (dataArr) {
      textType.init({
        el: el,
        textArr: dataArr,
        pauseTime: pauseTime,
      });
      // new TxtType(el, dataArr, pauseTime);
    }
  };

  var setSlider = function () {
    var bannerList = document.querySelectorAll('.bs-banner__list');
    Array.prototype.forEach.call(bannerList, function (list) {
      var bannerItems = list.querySelectorAll('.bs-banner__item');
      var buttonPrev = list.parentNode.querySelector('.bs-banner__slider-button.prev');
      var buttonNext = list.parentNode.querySelector('.bs-banner__slider-button.next');
      var flkty = null;
      // set prev/next thumbnails from active slide index
      var setPrevNextThumbnail = function (index) {
        var slides = flkty.cells;
        var prevSlide = (
          (index - 1) > -1
        ) ? slides[index - 1].element
          : slides[slides.length - 1].element;
        var nextSlide = (
          (index + 1) < slides.length
        ) ? slides[index + 1].element
          : slides[0].element;
        var prevThumbSrc = prevSlide.getAttribute('data-thumbnail-src');
        var nextThumbSrc = nextSlide.getAttribute('data-thumbnail-src');
        var buttonPrevImg = buttonPrev.querySelector('img');
        var buttonNextImg = buttonNext.querySelector('img');
        var prevThumbLabel = prevSlide.getAttribute('data-thumbnail-label');
        var nextThumbLabel = nextSlide.getAttribute('data-thumbnail-label');
        var buttonPrevLabel = buttonPrev.querySelector('.bs-banner__slider-preview-label');
        var buttonNextLabel = buttonNext.querySelector('.bs-banner__slider-preview-label');

        buttonPrevImg.src = prevThumbSrc;
        buttonNextImg.src = nextThumbSrc;
        buttonPrevLabel.innerHTML = prevThumbLabel;
        buttonNextLabel.innerHTML = nextThumbLabel;
      };
      // indicate a change in slider was made manually (made by user interaction)
      var manualChange = false;

      // if banner has items
      if (bannerItems && bannerItems.length > 1) {
        // set flickity constructor
        flkty = new Flickity(list, {
          // we made or own custom accessibility features
          accessibility: false,
          wrapAround: true,
          pageDots: true,
          // we made custom prev/next buttons
          prevNextButtons: false,
          adaptiveHeight: true,
          autoPlay: 5000,
          on: {
            ready: function () {
              // add aria hidden to ignore dots for screen readers
              list.querySelector('.flickity-page-dots').setAttribute('aria-hidden', 'true');
            },
          },
        });

        // for debug
        // window.bannerSlider = flkty;
        // document.addEventListener('focusin', function (ev) {console.log(document.activeElement)});

        // handle prev/next thumbnails on slide changes
        setPrevNextThumbnail(0);
        flkty.on('select', setPrevNextThumbnail);

        // add listener for custom prev button
        buttonPrev.addEventListener('click', function () {
          flkty.previous();
          // turn focus back to banner list to avoid banner layout's break
          list.focus();
        });

        // add listener for custom prev button
        buttonNext.addEventListener('click', function () {
          flkty.next();
          // turn focus back to banner list to avoid banner layout's break
          list.focus();
        });

        // handle keyboard navigation
        var handleKeyboard = function (ev) {
          var key = ev.key;
          var target = ev.target;

          switch (key) {
            case 'ArrowRight':
            case 'Right':
              manualChange = true;
              flkty.next(true, true);
              break;
            case 'ArrowLeft':
            case 'Left':
              manualChange = true;
              flkty.previous(true, true);
              break;
            default:
              break;
          }
        };

        // set keyboard navigation's listeners
        list.addEventListener('keydown', handleKeyboard);
        buttonPrev.addEventListener('keydown', handleKeyboard);
        buttonNext.addEventListener('keydown', handleKeyboard);

        // enable tabindex on slides and its anchor when focusin
        flkty.cells.forEach(function (cell, index) {
          cell.element.addEventListener('focusin', function () {
            var anchor = cell.element.querySelector('a, button');
            cell.element.tabIndex = '0';
            if (anchor) anchor.tabIndex = '0';
          });
        });

        // force fickity selection and focus on a slide on slide click
        flkty.on('staticClick', function(event, pointer, cellElement, cellIndex) {
          manualChange = true;
          flkty.select(cellIndex, true, true);
          // focus is setted to clicked element
          event.target.focus();
        });

        // disable slider's autoplay on focus in any element in slider
        list.addEventListener('focusin', function (ev) {
          flkty.stopPlayer();
        });

        // disable slider's autoplay on focus out from slider
        list.addEventListener('focusout', function (ev) {
          flkty.playPlayer();
        });

        // handle focus and tabindexes on slide changes
        flkty.on('select', function (index) {
          flkty.cells.forEach(function (cell, cellIndex) {
            var anchor = cell.element.querySelector('a, button');
            if (anchor) {
              // enable tabindex on current selected slide
              if (cellIndex === index) {
                cell.element.tabIndex = '0';
                anchor.tabIndex = '0';

                // set focus to slide if it's a manual change
                if (manualChange) {
                  cell.element.focus();
                  manualChange = false;
                }
              // disable tabindex on not selected slides
              } else {
                cell.element.tabIndex = '-1';
                anchor.tabIndex = '-1';
              }
            }
          });
        });
      }
    });
  };

  return {
    init: init,
  };
}());

/**
 * Init Header Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.bs-banner')) {
    BsBannerTopo.init();
  }
});

var BsBoxDropdown = function () {
  var config = {
    box: null,
    boxContent: null,
    toggleButton: null,
    interval: null,
    activeClass: 'bs-box--is-expanded',
    isViewport: function (bp) {
      var bps = { xs: 768, sm: 992, md: 1200 };
      return !bp || !bps[bp] || window.innerWidth < bps[bp];
    },
  };

  var init = function (box) {
    if (!box) return;

    config.box = box;
    config.boxContent = box.querySelector('.bs-box__content');
    config.toggleButton = box.querySelector('.bs-box__menu');

    if (!config.toggleButton) {
      config.toggleButton = buildMenuLabel(box);
    }

    config.toggleButton.addEventListener('click', toggleBoxContent);
    window.addEventListener('resize', function () {
      resizeTimer(function () {
        resizeMenuBox();
      });
    });

    // Close modal on click outside
    Array.prototype.forEach.call(document.querySelectorAll('body, html'), function (el) {
      el.addEventListener('click', function (event) {
        if (isExpanded() && !config.box.contains(event.target)) {
          toggleBoxContent();
          return false;
        }
      });
    });
  };

  var isExpanded = function () {
    return config.box.classList.contains(config.activeClass);
  };

  var toggleBoxContent = function () {
    var boxContentHeight = config.boxContent.scrollHeight;

    if (!isExpanded()) {
      config.box.classList.add(config.activeClass);
      config.boxContent.style.height = boxContentHeight + 'px';
      config.toggleButton.setAttribute('aria-expanded', 'true');
    } else {
      config.box.classList.remove(config.activeClass);
      config.boxContent.style.height = '';
      config.toggleButton.setAttribute('aria-expanded', 'false');
    }
  };

  var buildMenuLabel = function (parent) {
    var button = document.createElement('button');
    var boxTitle = config.box.querySelector('.bs-box__title');
    var title = boxTitle ? boxTitle.textContent : 'Menu';

    button.classList.add('bs-box__menu');
    button.innerHTML = title;
    button.type = 'button';
    button.setAttribute('aria-haspopup', 'true');
    button.setAttribute('aria-expanded', 'false');

    parent.insertBefore(button, parent.firstChild);
    return button;
  };

  // debounce setTime offset elem and should remove elements actives when resize
  var resizeMenuBox = function () {
    var boxContentHeight = config.boxContent.offsetHeight;
    var boxContentChild = config.boxContent.children[0];
    var boxContentChildHeight = boxContentChild ? boxContentChild.offsetHeight : 0;
    var boxHeight = (
      config.boxContent.children.length > 1)
      ? boxContentHeight
      : boxContentChildHeight;
    var breakpoint = config.box.dataset.dropdownBp;

    if (!config.isViewport(breakpoint)) {
      config.boxContent.style.height = '';
      return;
    }

    if (isExpanded()) {
      config.boxContent.style.height = boxHeight + 'px';
    }
  };

  var resizeTimer = function (callback) {
    clearTimeout(config.interval);
    config.interval = setTimeout(callback, 300);
  };

  return {
    init: init,
  };
};

/**
* @return {void} Header.init();
*/
document.addEventListener('DOMContentLoaded', function () {
  var dropdowns = document.querySelectorAll('.bs-js-box--dropdown');
  if (dropdowns.length) {
    Array.prototype.forEach.call(dropdowns, function (dropdown) {
      var dropdownBox = new BsBoxDropdown();
      dropdownBox.init(dropdown);
    });
  }
});

var BsBoxMenu = (function () {

  var config = {
    menuButton: document.querySelectorAll('.bs-js-box--menu'),
    menuButtonClass: 'bs-box__menu',
    activeContentClass: 'bs-box__content--active',
    activeMenuClass: 'bs-box__menu--active',
  };

  var init = function () {

    // var resizeMenu = debounce(todo, 500);
    // window.addEventListener('resize', resizeMenu);

    Array.prototype.forEach.call(config.menuButton, function (el) {
      var boxLinks = el.parentNode.querySelector('.bs-box__content');
      var boxLinksList = boxLinks.querySelector('.bs-box__list').offsetHeight;

      // debounce setTime offset elem and should remove elements actives when resize
      var resizeMenuBox = debounce(function () {
        boxLinksList = boxLinks.querySelector('.bs-box__list').offsetHeight;
        el.classList.remove(config.activeMenuClass);
        boxLinks.classList.remove(config.activeContentClass);
        boxLinks.style = '';
        // menu button active by breakpoint
        menuBoxActivated(el);
      });
      window.addEventListener('resize', resizeMenuBox);
      
      // menu button active by breakpoint
      menuBoxActivated(el);

      el.addEventListener('click', function () {

        var contentToggle = boxLinks.classList.contains(config.activeContentClass);

        if (!contentToggle) {
          el.classList.add(config.activeMenuClass);
          boxLinks.classList.add(config.activeContentClass);
          boxLinks.style.height = boxLinksList + 'px';
        } else {
          el.classList.remove(config.activeMenuClass);
          boxLinks.classList.remove(config.activeContentClass);
          boxLinks.style.height = '0';
        };
      });
    });
  };


  var menuBoxActivated = function (el) {
    var witdh = window.innerWidth;
    if (witdh > 768) {
      el.classList.remove(config.menuButtonClass);
      el.style.display = 'none';
    } else {
      el.classList.add(config.menuButtonClass);
      el.style.display = 'flex';
    }
  }

  return {
    init: init,
  };
}());

/**
* @return {void} Header.init();
*/
document.addEventListener('DOMContentLoaded', function() {
  if (document.querySelectorAll('.bs-js-box--menu').length) {
    BsBoxMenu.init();
  }
});

var BsBoxListRef = (function () {

  var config = {
    accordionButton: document.querySelectorAll('.bs-js-open-accordion'),
    accordion: document.querySelectorAll('.bs-boxlist-fone-refactored'),
    accordionContent: '.bs-js-accordion-content-ref',
    body: document.querySelector('body'),
    disabledOnDesktop: 'bs-js-accordion-disabled-desktop'
  }

  var modClass = {
    accordionOpenClass: 'bs-boxlist-fone-refactored__item--open'
  };

  var init = function () {

    // Check if accordion shoud be disabled on desktop
    disableAccordionOnDesktop();

    // Toggle accordion item on click
    for (var i = 0; i < config.accordionButton.length; i += 1) {
      config.accordionButton[i].addEventListener(
        'click',
        toggleAccordionItem.bind(null, config.accordionButton[i])
      );
    }

    window.addEventListener('resize', function () {
      updateContentHeight();
      disableAccordionOnDesktop();
    });

    Array.prototype.forEach.call(config.accordion, function (el) {
      el.addEventListener('keydown', handleAccordionKeyboard);
    });
  };

  var toggleAccordionItem = function (element) {
    if (isAccordionOpen(element)) closeAccordionItem(element);
    else openAccordionItem(element);
  };

  var isAccordionOpen = function (element) {
    var item = getParent(element, 'bs-boxlist-fone-refactored__item');
    return item.classList.contains(modClass.accordionOpenClass);
  };

  var openAccordionItem = function (openElement) {
    var item = getParent(openElement, 'bs-boxlist-fone-refactored__item');
    var content = item.querySelector(config.accordionContent);
    var contentHeight = content.scrollHeight;

    openElement.setAttribute('aria-expanded', 'true');
    content.setAttribute('aria-hidden', 'false');

    item.classList.add(modClass.accordionOpenClass);
    content.style.height = contentHeight + 'px';
  };

  var closeAccordionItem = function (closeElement) {
    var item = getParent(closeElement, 'bs-boxlist-fone-refactored__item');
    var content = item.querySelector(config.accordionContent);
    var contentHeight = content.scrollHeight;

    closeElement.setAttribute('aria-expanded', 'false');
    content.setAttribute('aria-hidden', 'true');

    item.classList.remove(modClass.accordionOpenClass);
    content.style.height = 0;

    fixElementScroll(item);
  };

  // Updates content height on window resize
  var updateContentHeight = function () {
    var items = document.querySelectorAll('.bs-boxlist-fone-refactored__item');

    Array.prototype.forEach.call(items, function (element, i) {
      var content = element.querySelector(config.accordionContent);
      var contentHeight = content.querySelector('.bs-boxlist-fone-refactored__box').scrollHeight + 'px';
      var accordion = getParents(element, config.disabledOnDesktop)[0];

      // If the .bs-js-accordion-content height is different from its content, updates its height
      if (element.classList.contains(modClass.accordionOpenClass) && parseInt(content.style.height) != contentHeight) {
        content.style.height = contentHeight;
      }


      // If accordion is set to be disabled on desktop, update items height
      if (accordion) {
        if (
          (element.classList.contains(modClass.accordionOpenClass) && parseInt(content.style.height) != contentHeight) ||
          (!element.classList.contains(modClass.accordionOpenClass) && window.innerWidth >= 1200)
        ) {
          content.style.height = contentHeight;
        } else if (!element.classList.contains(modClass.accordionOpenClass) && window.innerWidth < 1200) {
          content.style.height = 0;
        }
      }
    });
  }

  // Checks if the accordion should be disabled on desktop
  // and then disable its buttons
  var disableAccordionOnDesktop = function () {
    Array.prototype.forEach.call(config.accordion, function (element, i) {
      if (element.classList.contains(config.disabledOnDesktop)) toggleButtons(element);
    });
  }

  // Disable the accordion buttons
  var toggleButtons = function (element) {
    var items = element.querySelectorAll('.bs-js-open-accordion');

    if (window.innerWidth >= 1200) {
      Array.prototype.forEach.call(items, function (el, i) {
        el.disabled = true;
      });
    } else {
      Array.prototype.forEach.call(items, function (el, i) {
        el.disabled = false;
      });
    }
  }

  // Fix scroll of an element when tabbing focus
  // on an element inside a div who will be hidden
  // after a transition
  var fixElementScroll = function (el) {
    setTimeout(function () {
      el.scrollTo(0, 0);
    }, 300);
  };

  var handleAccordionKeyboard = function (ev) {
    var accordion = ev.currentTarget;
    var currentEl = ev.target;
    var key = ev.key;
    var buttonsNode = accordion.querySelectorAll('.bs-js-open-accordion');
    var buttons = Array.prototype.slice.call(buttonsNode);
    var currentButton = (
        currentEl.classList.contains('bs-js-open-accordion')) ?
      currentEl : currentEl.closest('.bs-js-open-accordion');
    var firstButton = buttons[0];
    var lastButton = buttons[buttons.length - 1];
    var prevButton = buttons.indexOf(currentButton) ?
      buttons[buttons.indexOf(currentButton) - 1] :
      lastButton;
    var nextButton = buttons.indexOf(currentButton) < buttons.length - 1 ?
      buttons[buttons.indexOf(currentButton) + 1] :
      firstButton;

    if (currentButton) {
      switch (key) {
        case "Right": // IE/Edge specific value
        case "ArrowRight":
          openAccordionItem(currentButton);
          break;
        case "Left": // IE/Edge specific value
        case "ArrowLeft":
          closeAccordionItem(currentButton);
          break;
        case "Down": // IE/Edge specific value
        case "ArrowDown":
          nextButton.focus();
          break;
        case "Up": // IE/Edge specific value
        case "ArrowUp":
          prevButton.focus();
          break;
        case 'Home':
          firstButton.focus();
          break;
        case 'End':
          lastButton.focus();
          break;
        default:
      }
    }
  };

  return {
    init: init,
  };
}());

/**
 * Init Modal Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-boxlist-fone-refactored').length) {
    BsBoxListRef.init();
  }
});

var BsBoxListRefactored = (function () {

  var init = function () {

    let $generalBoxContainer = document.querySelector('.bs-box-refactored');
    let $buttonBoxList = document.querySelector('.bs-box-refactored .bs-box__menu');

    $buttonBoxList.addEventListener('click', function() {
      $generalBoxContainer.classList.toggle('open');

      if($generalBoxContainer.classList.contains("open")){
        this.setAttribute("aria-expanded", "true");
      }else {
        this.setAttribute("aria-expanded", "false");
      }

    })
  };

  return {
    init: init
  };
}());

/**
* @return {void} BsBoxListRefactored.init();
*/
document.addEventListener('DOMContentLoaded', function() {
  if (document.querySelectorAll('.bs-box-refactored').length) {
    BsBoxListRefactored.init();
  }
});

document.addEventListener('DOMContentLoaded', mainCardFlipReady);

/**
 * [mainCardFlipReady description]
 * @return {void} MainCard.init()
 */
function mainCardFlipReady() {
  var mainCard = new BsCardFlip();
  mainCard.init();
}

/**
 * BsCardFlip
 * @constructor
 */
function BsCardFlip() {
  this.cardServicesText = document.querySelector('.js-bs-card-services__text');
}

BsCardFlip.prototype = {
  constructor: BsCardFlip,
  init: function () {
    var i;
    var _ = this;
    var item = document.querySelectorAll('.js-bs-open-flip-card');
    // var card = document.querySelector('.js-flip-card');
    var closeFlipCard = document.querySelectorAll('.js-bs-close-flip-card');
    var body = document.querySelector('body');

    if (window.innerWidth < 768) body.classList.add('bs-is-mobile');
    window.addEventListener('resize', function () {
      if (window.innerWidth < 768) body.classList.add('bs-is-mobile');
      else body.classList.remove('bs-is-mobile');
    });

    if (item) {
      for (i = 0; i < item.length; i += 1) {
        item[i].addEventListener('click', function () {
          _._openFlipCard(this);
        });
      }

      for (i = 0; i < closeFlipCard.length; i += 1) {
        closeFlipCard[i].addEventListener('click', function (e) {
          e.stopPropagation();
          var _ = this;
          this.parentElement.classList.remove('bs-flip-card--is-open');
          this.parentElement.classList.add('bs-flip-card--is-removed');
          this.parentElement.parentElement.classList.remove('bs-card-services__item--no-hover');
          setTimeout(function () {
            _.parentElement.classList.remove('bs-flip-card--is-removed');
            _.parentElement.classList.remove('bs-flip-card--is-fixed');
          }, 300);
        });
      }
    }
  },

  _openFlipCard: function (el) {
    el.nextElementSibling.classList.add('bs-flip-card--is-fixed');
    el.nextElementSibling.classList.add('bs-flip-card--is-open');
    el.parentElement.classList.add('bs-card-services__item--no-hover');
  },
};


/**
 * Compare Selector
 * @return Module config
 */
var BsCompareSelector = (function () {
  /**
   * Init function
   * @return {Function} Module's scope functions
   */

   var config = {
    checkboxItems : document.querySelector('.bs-compare__select-cards'),
    listItem : document.querySelectorAll('.bs-compare__select-card'),
    resultListItem : document.querySelectorAll('.bs-compare__result .bs-media__item'),
    buttonCompare : document.querySelector('.bs-js-compare'),
    buttonNewCompare : document.querySelector('.bs-js-new-compare'),
    compareResult : document.querySelector('.bs-compare__result'),
    compareList : document.querySelector('.bs-compare__wrapper'),
    buttonItem : '',
    check : '',
    counter : 0,
    limit : 3,
    minSizeLimit : 2,
   };

   var results = {
    buttonAnchor : document.querySelector('.bs-js-new-compare'),
    smoothScrollSteps : 25,
    scrollAnchorGutter : 120,
    newCompareResult : document.querySelector('.bs-compare__select-cards'),
   };

   if (config.checkboxItems) {
    var selector = {
      checkItem : config.checkboxItems.querySelectorAll('input[type="checkbox"]'),
     };
   };

  var init = function () {
    Array.prototype.forEach.call(selector.checkItem, function (e) {
      config.buttonItem = e;
      config.buttonItem.addEventListener('click', function (el) {
        config.check = el.target;
        newChecker(config.check);
      });
    });

    results.buttonAnchor.addEventListener('click', function (e) {
      var scroll = new SmoothScroll();

      if (config.compareList) {
        scroll.animateScroll(config.compareList, 0, {
          updateURL: false,
          header: '.bs-header',
          offset: function () {
            return 100;
          },
        });
      }
    });

    // dispara ao do comparar
    config.buttonCompare.addEventListener('click', function(e) {
      config.compareResult.style.display = 'block';

      var filterItems = Object.values(selector.checkItem);

      var filtered = filterItems.filter(function (value) {
        return value.checked;
      });

      var contentResult = filtered.map(function (value) {
        return value.getAttribute('data-compare');
      });

      Array.prototype.forEach.call(config.resultListItem, function (el) {
        var scroll = new SmoothScroll();
        var itemCompared = el.getAttribute('data-compare');

        el.classList.remove('bs-compare__active');

        if (contentResult.includes(itemCompared)) {
          el.classList.add('bs-compare__active');
        }

        if (config.compareResult) {
          scroll.animateScroll(config.compareResult, 0, {
            updateURL: false,
          });
        }
      });
    });
  };

  var newChecker = function (e) {
    if (e.checked) config.counter++;
    else config.counter--;
    Array.prototype.forEach.call(selector.checkItem, function (el) {
      config.buttonItem = el;
      if (config.counter === config.limit) { //- 3 limit default
        if (!config.buttonItem.checked) {
          config.buttonItem.disabled = true; // and disable unchecked checkboxes
          config.buttonCompare.classList.remove('bs-button--disabled');
        };
      } else {
        if (config.counter === config.minSizeLimit) {
          config.buttonItem.disabled = false; // enable unchecked checkboxes
          config.buttonCompare.classList.remove('bs-button--disabled');
        } else {
          if (!config.buttonItem.checked) {
            config.buttonItem.disabled = false; // enable unchecked checkboxes
            config.buttonCompare.classList.add('bs-button--disabled');
          };
        };
      };
    });
  };

  return {
    init: init,
  };
}());

/**
 * Init Header Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.bs-compare__select-cards')) {
    BsCompareSelector.init();
  }
});

/**
 * Context Menu
 * DEPRECATED
 * Remove in future
 */
var BsContextMenu = (function () {
  // Config
  var config = {
    buttons: {
      trigger: document.querySelectorAll('.bs-js-trigger-context-menu'),
    },
    classes: {
      open: 'bs-context-menu--open',
      contextMenu: 'bs-context-menu',
    },
  };

  var init = function () {
    // Abre/fecha o Context Menu
    if (config.buttons.trigger) {
      Array.prototype.forEach.call(config.buttons.trigger, function (button) {
        button.addEventListener('click', function (e) {
          e.stopPropagation();
          toggleContextMenu(button);
        });
      });
    }
  };

  var toggleContextMenu = function (button) {
    var isOpen = button.querySelector('.' + config.classes.contextMenu).classList.contains(config.classes.open);

    if (isOpen) closeContextMenu(button);
    else openContextMenu(button);
  };

  var openContextMenu = function (button) {
    closeAllContextMenu();
    button.querySelector('.' + config.classes.contextMenu).classList.add(config.classes.open);
  };

  var closeContextMenu = function (button) {
    button.querySelector('.' + config.classes.contextMenu).classList.remove(config.classes.open);
  };

  var closeAllContextMenu = function () {
    Array.prototype.forEach.call(document.querySelectorAll('.' + config.classes.open), function (contextMenu) {
      contextMenu.classList.remove(config.classes.open);
    });
  };

  // Close menu on click outside
  document.querySelector('html').addEventListener('click', function () {
    closeAllContextMenu();
  });

  return {
    init: init,
    closeAllContextMenu: closeAllContextMenu,
  };
}());

/**
 * Init BsContextMenu constructor
 * @return {void} BsContextMenu.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-context-menu').length) {
    BsContextMenu.init();
  }
});

var BsDatePicker = (function () {

  var config = {
    starInputDefault: document.querySelectorAll('input[data-type="datepicker"]'),
    starInputRange: document.querySelectorAll('input[data-type="datepicker--range"]'),
    selector: document.querySelectorAll('.bs-picker__item'),
    ul: document.querySelector('.bs-js-pickerList'),
    button: '',
    dataItem: '',
    objectAttribute: '',
    resetPicker: document.querySelector('.lightpick__reset-action'),
    optFooter: '',
    lightpick: '',
    toggleCalendar: '',
  };

  var set = function (el) {

    var isRange = el.getAttribute('data-type') === 'datepicker--range';

    if (isRange) setPickerRange(el);
    else setPicker(el);
  };

  var setPicker = function (el) {
    var elParent = el.parentNode;
    var picker = null;
    var datePeriod = el.getAttribute('data-datepicker-period') || '';
    var dateLimit = el.getAttribute('data-datepicker-limit') || '';

    var setMinDatePeriod = datePeriod === 'startToday' ? moment().endOf('day') : null;
    var setMinDateLimit = dateLimit !== '' ? moment().subtract(dateLimit, 'day') : null;

    var setMinDate = setMinDatePeriod !== null && setMinDateLimit === null
      ? setMinDatePeriod : setMinDateLimit;

    var options = {
      field: el,
      parentEl: elParent,
      startDate: el.value || null,
      lang: 'pt-BR',
      minDate: setMinDate,
      maxDate: !datePeriod || datePeriod === 'endToday' ? moment().endOf('day') : null,
    };

    picker = new Lightpick(options);

    // Close picker on keydown
    el.addEventListener('keydown', function () {
      picker.hide();
    });

    // Focus
    el.addEventListener('focus', function () {
      // Fix bug IE11 use setTimeout
      setTimeout( function() {
        // selectorDate();
        el.focus();
      }, 10);
    });
  };

  var setPickerRange = function (el) {
    var elParent = el.parentNode;

    // split date range into an array
    // dates provided manually should have the following format: "DD/MM/YYYY - DD/MM/YYYY"
    var datevalue = el.value.split(" - ");
    

    var picker = new Lightpick({
      field: el,
      parentEl: elParent,
      startDate: datevalue[0] || null,
      endDate: datevalue[1] || null,
      separator: (el.dataset.separator) || ' - ',
      lang: 'pt-BR',
      singleDate: false,
      maxDate: moment().endOf('day'),
      footer: true,
      locale: {
        tooltip: {
          one: 'Dia',
          other: 'Dias',
        },
      },
      onSelect: function (date) {
        var str = date ? date.toString() : '';
        enableCleanButton(str);
      },
    });
    var resetPicker = picker.el.querySelector('.lightpick__reset-action');
    var optFooter = picker.el.querySelector('.lightpick__footer');
    var control = el.closest('.bs-form__control');
    var pickerList = control.querySelector('.bs-js-pickerList');
    var pickerItems = pickerList.querySelectorAll('.bs-picker__item');
    var rangePeriods = [
      { attribute: 'today', value: '' },
      { attribute: 'last-week', value: '7' },
      { attribute: 'last-fortnight', value: '15' },
      { attribute: 'last-month', value: '30' },
      { attribute: 'last-3month', value: '90' },
      { attribute: 'last-more', value: '90' },
      { attribute: 'last-6month', value: '180' },
    ];
    var enableCleanButton = function (value) {
      if (typeof value === 'string' && value.length) {
        resetPicker.removeAttribute('disabled');
      } else {
        resetPicker.setAttribute('disabled', 'disabled');
        picker.hide();
        picker.show();
      }
    };

    if (optFooter) {
      // Append Footer + IE 11 suport
      optFooter.insertBefore(pickerList, optFooter.firstChild);

      // Cria  funo para limpar as datas selcionadas
      resetPicker.innerHTML = 'Limpar';
      resetPicker.classList.add('bs-picker__item');
      resetPicker.setAttribute('disabled', 'disabled');

      // Enable resetPicker button if input has value
      if (el.value != '') {
        resetPicker.removeAttribute('disabled');
      }
    }

    //if value is set manually enable CleanButton
    if (datevalue[0] != "" && datevalue[1] != "") {
      resetPicker.removeAttribute('disabled');
    }

    // Filter Selection last dates
    Array.prototype.forEach.call(pickerItems, function (elem) {
      var button = elem.querySelector('a');

      if (!button) return;

      var setPeriodListeners = function(elem) {
        var dataItem = elem.target.getAttribute('data-picker');
        var dataPickerPeriod = elem.target.getAttribute('data-picker-period');
        var setPickerPeriod = function (period) {
          var subtractDays = moment().subtract(period, 'day');
          var currentDay = moment().endOf('day');
          picker.setDateRange(subtractDays, currentDay);
          picker.hide();
        };

        // If period is set manually
        if (dataPickerPeriod) {
          setPickerPeriod(dataPickerPeriod);
        } else {
          // Get objects in list, to update last days
          Array.prototype.forEach.call(rangePeriods, function (period) {
            if (period.attribute === dataItem) {
              setPickerPeriod(period.value);
            }
          });
        }
      }
           
      // permite selecionar o dia, no filtro/ no  default do plugin
      button.addEventListener('click', function (elem) {
        setPeriodListeners(elem);
      });
      button.addEventListener('touchend', function (elem) {
         elem.stopPropagation();
         elem.preventDefault();
         //setTimeout(function() { // required as a work around for the touchend event. Avoids click on itens behind the calendar. 
           setPeriodListeners(elem);
         //}, 200)
      });
      
        
    });
  };

  var init = function () {

    // Range + Filter Date
    if (config.starInputRange.length > 0) {
      Array.prototype.forEach.call(config.starInputRange, function (el) {

        setTimeout(function () {
          setPickerRange(el);
        }, 200);

      });
    }

    // SIMPLE date
    if (config.starInputDefault.length > 0) {
      Array.prototype.forEach.call(config.starInputDefault, function (el) {

        setTimeout(function () {
          setPicker(el);
        }, 200);

      });
    };
    
  };

  return {
    set: set,
    setPicker: setPicker,
    setRange: setPickerRange,
    init: init,
  };
}());

/**
* Init Modal Constructor
* @return {void} Header.init();
*/
document.addEventListener('DOMContentLoaded', function() {
  if (document.querySelectorAll('.bs-js-lightpick').length) {
    BsDatePicker.init();
  }
});

// Abaixo est escrito a interatvidade referente  discagem VoIP.

const update = function (value, remove) {
  const number = document.querySelector('#voip-dial-number');
  if (remove) {
    let arr = number.innerText.split('');
    let qt = arr.length > 1 ? arr.length - 1 : arr.length;
    number.innerText = arr.splice(0, qt).join('');
  } else number.innerText = number.innerText + value;
}

const dialer = document.querySelectorAll('.pad');


// ----------------------------------------------------------------------------

// Abaixo  para caso queiram ter a opo de apagar o nmero discado.

// const remove = document.querySelector('#number');
// remove.addEventListener('click', () => {
//   update('', true);
// })

// ----------------------------------------------------------------------------

for (let i = 0; i < dialer.length; i++) {
  console.log(dialer[i].querySelector('span').textContent)
  dialer[i].addEventListener('click', function() {
    update(this.querySelector('span').innerText, false);
  })
}

/**
 * Dropdown menu
 * e.g.: Notification and Switch User Menu
 */
var BsDropdownMenu = (function () {
  // Config
  var config = {
    buttons: {
      dropdownMenuTrigger: document.querySelectorAll('.bs-js-toggle-dropdown-menu'),
      markAllAsRead: document.querySelector('.bs-js-mark-all-unread'),
      markAsUnread: document.querySelectorAll('.bs-js-mark-unread'),
      openDropdownMenu: document.querySelectorAll('.bs-user-menu__dropdown .bs-js-open-modal'),
      removeNotification: document.querySelectorAll('.bs-js-remove-notification'),
    },
    classes: {
      dropdownHasNotification: 'bs-dropdown-notification--has-notification',
      dropdownMenuOpen: 'bs-dropdown-menu--open',
      hasNotification: 'bs-dropdown-notification__item--has-notification',
      inDown: 'bs-dropdown-notification__number--in-down-count',
      inUp: 'bs-dropdown-notification__number--in-up-count',
      outDown: 'bs-dropdown-notification__number--out-down-count',
      outUp: 'bs-dropdown-notification__number--out-up-count',
      notificationNumber: 'bs-dropdown-notification__number',
    },
    dropdownMenu: document.querySelector('.bs-dropdown-menu'),
    notificationMenu: document.querySelector('.bs-dropdown-notification'),
    notificationCount: document.querySelector('.bs-dropdown-notification__count'),
    notificationCountInt: null,
    notificationItems: document.querySelectorAll('.bs-js-dropdown-menu-item'),
  };

  var init = function () {
    // Inicializa o valor da notificao
    var hasNotification = document.querySelector('.' + config.classes.dropdownHasNotification);
    if (hasNotification) {
      config.notificationCountInt = parseInt(document.querySelector('.bs-dropdown-notification__count').textContent, 10);

      // Marca notificao como lida
      if (config.notificationItems) {
        Array.prototype.forEach.call(config.notificationItems, function (notification) {
          notification.addEventListener('click', function () {
            markNotificationAsRead(notification);
          });
        });
      }

      // Marca a notificao como no lida
      if (config.buttons.markAsUnread) {
        Array.prototype.forEach.call(config.buttons.markAsUnread, function (notification) {
          notification.addEventListener('click', function (e) {
            e.stopPropagation();
            markNotificationAsUnread(notification);
          });
        });
      }

      // Marca todas as notificaes lidas
      if (config.buttons.markAllAsRead) {
        config.buttons.markAllAsRead.addEventListener('click', function () {
          var hasNotification = document.querySelectorAll('.' + config.classes.hasNotification);
          var dropdown = getParents(this, 'bs-dropdown-menu', true)[0];

          config.notificationCountInt = 0;
          document.querySelector('.' + config.classes.notificationNumber).textContent = config.notificationCountInt;
          dropdown.classList.remove(config.classes.dropdownHasNotification);

          Array.prototype.forEach.call(hasNotification, function (notification) {
            notification.classList.remove(config.classes.hasNotification);
          });
        });
      }

      // Remove notificao
      if (config.buttons.removeNotification) {
        Array.prototype.forEach.call(config.buttons.removeNotification, function (button) {
          button.addEventListener('click', function (e) {
            e.preventDefault();
            e.stopPropagation();
            removeNotification(button);
          });
        });
      }
    }

    // Abre/fecha o Dropdown Menu
    if (config.buttons.dropdownMenuTrigger) {
      Array.prototype.forEach.call(config.buttons.dropdownMenuTrigger, function (button) {
        button.addEventListener('click', function (e) {
          e.preventDefault();
          e.stopPropagation();
          toggleDropdownMenu(button);
        });
      });

      // Previne bug ao carregar o componente
      setTimeout(function () {
        BsTextEllipsis.init({
          element: '.bs-dropdown-menu__description',
          maxHeight: 42,
        });
      }, 100);
    }
  };

  var toggleDropdownMenu = function (button) {
    var isOpen = button.parentNode.classList.contains(config.classes.dropdownMenuOpen);

    if (isOpen) closeDropdownMenu();
    else openDropdownMenuButton(button);
  };

  var openDropdownMenuButton = function (button) {
    closeDropdownMenu();
    button.parentNode.classList.add(config.classes.dropdownMenuOpen);
  };

  var closeDropdownMenu = function () {
    BsContextMenu.closeAllContextMenu();

    Array.prototype.forEach.call(config.buttons.dropdownMenuTrigger, function (button) {
      button.parentNode.classList.remove(config.classes.dropdownMenuOpen);
    });
  };

  var markNotificationAsUnread = function (notification) {
    var notificationItem = getParents(notification, 'bs-dropdown-menu__item', true)[0];

    if (!notificationItem.classList.contains(config.classes.hasNotification)) {
      notificationItem.classList.add(config.classes.hasNotification);
      increaseNotificationCount();
    }
  };

  var markNotificationAsRead = function (notification) {
    if (notification.classList.contains(config.classes.hasNotification)) {
      notification.classList.remove(config.classes.hasNotification);
      decreaseNotificationCount();
    }
  };

  var removeNotification = function (button) {
    // Seleciona a notificao
    var notificationItem = getParents(button, 'bs-dropdown-menu__item', true)[0];

    // Remove a notificao da lista
    notificationItem.classList.add('bs-dropdown-menu__item--removing');
    setTimeout(function () {
      notificationItem.remove();
    }, 200);

    // Verifica se a notifio tem a classe para atualizar o contador
    if (notificationItem.classList.contains(config.classes.hasNotification)) {
      decreaseNotificationCount();
    }
  };

  // Aumenta o contador de notificaes
  var increaseNotificationCount = function () {
    config.notificationCountInt++;

    // verifica se o contador est sendo exibido
    if (
      config.notificationCountInt > 0 &&
      !config.notificationMenu.classList.contains(config.classes.dropdownHasNotification)
    ) {
      config.notificationMenu.classList.add(config.classes.dropdownHasNotification);
    }

    document.querySelector('.' + config.classes.notificationNumber).classList.add(config.classes.outUp);
    updateNotification('increase');
  };

  // Diminui o contador de notificaes
  var decreaseNotificationCount = function () {
    if (config.notificationCountInt > 0) {
      config.notificationCountInt--;

      // verifica se o contador est sendo exibido
      if (config.notificationCountInt === 0) {
        config.notificationMenu.classList.remove(config.classes.dropdownHasNotification);
      }

      document.querySelector('.' + config.classes.notificationNumber).classList.add(config.classes.outDown);
      updateNotification('decrease');
    }
  };

  // Atualiza o contador de notificaes
  var updateNotification = function (increaseDecrease) {
    // debugger;
    var span = document.createElement('span');
    var animationClasses = getNotificationClass(increaseDecrease);

    // Inclui o novo contador no DOM
    // Como se estivesse empurrando o contador antigo para cima/baixo
    span.textContent = config.notificationCountInt;
    span.classList.add('bs-dropdown-notification__number', animationClasses[0]);
    config.notificationCount.appendChild(span);

    // Delay para que o contador seja empurrado
    // Ento removemos o contador antigo e a classe de animao do novo contador
    setTimeout(function () {
      document.querySelector('.' + animationClasses[1]).remove();
      span.classList.remove(animationClasses[0]);
    }, 200);
  };

  // Obtm a classe de animao do contador de notificaes
  var getNotificationClass = function (increaseDecrease) {
    var classIn = '';
    var classOut = '';

    // Atribui as classes CSS de animao
    if (increaseDecrease === 'increase') {
      classIn = config.classes.inUp;
      classOut = config.classes.outUp;
    } else {
      classIn = config.classes.inDown;
      classOut = config.classes.outDown;
    }

    return [classIn, classOut];
  };

  // Close menu on click outside
  document.querySelector('html').addEventListener('click', function (event) {
    Array.prototype.forEach.call(config.buttons.dropdownMenuTrigger, function (button) {
      if (
        button.parentNode.classList.contains(config.classes.dropdownMenuOpen) &&
        !button.nextElementSibling.contains(event.target)) {
        closeDropdownMenu();
        return false;
      }
    });
  });

  return {
    init: init,
  };
}());

/**
 * Init BsDropdownMenu constructor
 * @return {void} BsDropdownMenu.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-dropdown-menu').length) {
    BsDropdownMenu.init();
  }
});

var BsAccordionVoip = (function () {

  var config = {
    accordionButton: document.querySelectorAll('.bs-js-open-accordion'),
    accordion: document.querySelectorAll('.bs-faq-voip'),
    accordionContent: '.bs-js-accordion-content-ref',
    body: document.querySelector('body'),
    disabledOnDesktop: 'bs-js-accordion-disabled-desktop'
  }

  var modClass = {
    accordionOpenClass: 'bs-faq-voip__item--open'
  };

  var init = function () {

    // Check if accordion shoud be disabled on desktop
    disableAccordionOnDesktop();

    // Toggle accordion item on click
    for (var i = 0; i < config.accordionButton.length; i += 1) {
      config.accordionButton[i].addEventListener(
        'click',
        toggleAccordionItem.bind(null, config.accordionButton[i])
      );
    }

    window.addEventListener('resize', function () {
      updateContentHeight();
      disableAccordionOnDesktop();
    });

    Array.prototype.forEach.call(config.accordion, function (el) {
      el.addEventListener('keydown', handleAccordionKeyboard);
    });
  };

  var toggleAccordionItem = function (element) {
    if (isAccordionOpen(element)) closeAccordionItem(element);
    else openAccordionItem(element);
  };

  var isAccordionOpen = function (element) {
    var item = getParent(element, 'bs-faq-voip__item');
    return item.classList.contains(modClass.accordionOpenClass);
  };

  var openAccordionItem = function (openElement) {
    var item = getParent(openElement, 'bs-faq-voip__item');
    var content = item.querySelector(config.accordionContent);
    var contentHeight = content.scrollHeight;

    openElement.setAttribute('aria-expanded', 'true');
    content.setAttribute('aria-hidden', 'false');

    item.classList.add(modClass.accordionOpenClass);
    content.style.height = contentHeight + 'px';
  };

  var closeAccordionItem = function (closeElement) {
    var item = getParent(closeElement, 'bs-faq-voip__item');
    var content = item.querySelector(config.accordionContent);
    var contentHeight = content.scrollHeight;

    closeElement.setAttribute('aria-expanded', 'false');
    content.setAttribute('aria-hidden', 'true');

    item.classList.remove(modClass.accordionOpenClass);
    content.style.height = 0;

    fixElementScroll(item);
  };

  // Updates content height on window resize
  var updateContentHeight = function () {
    var items = document.querySelectorAll('.bs-faq-voip__item');

    Array.prototype.forEach.call(items, function (element, i) {
      var content = element.querySelector(config.accordionContent);
      var contentHeight = content.querySelector('.bs-faq-voip__box').scrollHeight + 'px';
      var accordion = getParents(element, config.disabledOnDesktop)[0];

      // If the .bs-js-accordion-content height is different from its content, updates its height
      if (element.classList.contains(modClass.accordionOpenClass) && parseInt(content.style.height) != contentHeight) {
        content.style.height = contentHeight;
      }


      // If accordion is set to be disabled on desktop, update items height
      if (accordion) {
        if (
          (element.classList.contains(modClass.accordionOpenClass) && parseInt(content.style.height) != contentHeight) ||
          (!element.classList.contains(modClass.accordionOpenClass) && window.innerWidth >= 1200)
        ) {
          content.style.height = contentHeight;
        } else if (!element.classList.contains(modClass.accordionOpenClass) && window.innerWidth < 1200) {
          content.style.height = 0;
        }
      }
    });
  }

  // Checks if the accordion should be disabled on desktop
  // and then disable its buttons
  var disableAccordionOnDesktop = function () {
    Array.prototype.forEach.call(config.accordion, function (element, i) {
      if (element.classList.contains(config.disabledOnDesktop)) toggleButtons(element);
    });
  }

  // Disable the accordion buttons
  var toggleButtons = function (element) {
    var items = element.querySelectorAll('.bs-js-open-accordion');

    if (window.innerWidth >= 1200) {
      Array.prototype.forEach.call(items, function (el, i) {
        el.disabled = true;
      });
    } else {
      Array.prototype.forEach.call(items, function (el, i) {
        el.disabled = false;
      });
    }
  }

  // Fix scroll of an element when tabbing focus
  // on an element inside a div who will be hidden
  // after a transition
  var fixElementScroll = function (el) {
    setTimeout(function () {
      el.scrollTo(0, 0);
    }, 300);
  };

  var handleAccordionKeyboard = function (ev) {
    var accordion = ev.currentTarget;
    var currentEl = ev.target;
    var key = ev.key;
    var buttonsNode = accordion.querySelectorAll('.bs-js-open-accordion');
    var buttons = Array.prototype.slice.call(buttonsNode);
    var currentButton = (
        currentEl.classList.contains('bs-js-open-accordion')) ?
      currentEl : currentEl.closest('.bs-js-open-accordion');
    var firstButton = buttons[0];
    var lastButton = buttons[buttons.length - 1];
    var prevButton = buttons.indexOf(currentButton) ?
      buttons[buttons.indexOf(currentButton) - 1] :
      lastButton;
    var nextButton = buttons.indexOf(currentButton) < buttons.length - 1 ?
      buttons[buttons.indexOf(currentButton) + 1] :
      firstButton;

    if (currentButton) {
      switch (key) {
        case "Right": // IE/Edge specific value
        case "ArrowRight":
          openAccordionItem(currentButton);
          break;
        case "Left": // IE/Edge specific value
        case "ArrowLeft":
          closeAccordionItem(currentButton);
          break;
        case "Down": // IE/Edge specific value
        case "ArrowDown":
          nextButton.focus();
          break;
        case "Up": // IE/Edge specific value
        case "ArrowUp":
          prevButton.focus();
          break;
        case 'Home':
          firstButton.focus();
          break;
        case 'End':
          lastButton.focus();
          break;
        default:
      }
    }
  };

  return {
    init: init,
  };
}());

/**
 * Init Modal Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-faq-voip').length) {
    BsAccordionVoip.init();
  }
});

var BsAccordionRef = (function () {

  var config = {
    accordionButton: document.querySelectorAll('.bs-js-open-accordion'),
    accordion: document.querySelectorAll('.bs-faq-refactored'),
    accordionContent: '.bs-js-accordion-content-ref',
    body: document.querySelector('body'),
    disabledOnDesktop: 'bs-js-accordion-disabled-desktop'
  }

  var modClass = {
    accordionOpenClass: 'bs-faq-refactored__item--open'
  };

  var init = function () {

    // Check if accordion shoud be disabled on desktop
    disableAccordionOnDesktop();

    // Toggle accordion item on click
    for (var i = 0; i < config.accordionButton.length; i += 1) {
      config.accordionButton[i].addEventListener(
        'click',
        toggleAccordionItem.bind(null, config.accordionButton[i])
      );
    }

    window.addEventListener('resize', function () {
      updateContentHeight();
      disableAccordionOnDesktop();
    });

    Array.prototype.forEach.call(config.accordion, function (el) {
      el.addEventListener('keydown', handleAccordionKeyboard);
    });
  };

  var toggleAccordionItem = function (element) {
    if (isAccordionOpen(element)) closeAccordionItem(element);
    else openAccordionItem(element);
  };

  var isAccordionOpen = function (element) {
    var item = getParent(element, 'bs-faq-refactored__item');
    return item.classList.contains(modClass.accordionOpenClass);
  };

  var openAccordionItem = function (openElement) {
    var item = getParent(openElement, 'bs-faq-refactored__item');
    var content = item.querySelector(config.accordionContent);
    var contentHeight = content.scrollHeight;

    openElement.setAttribute('aria-expanded', 'true');
    content.setAttribute('aria-hidden', 'false');

    item.classList.add(modClass.accordionOpenClass);
    content.style.height = contentHeight + 'px';
  };

  var closeAccordionItem = function (closeElement) {
    var item = getParent(closeElement, 'bs-faq-refactored__item');
    var content = item.querySelector(config.accordionContent);
    var contentHeight = content.scrollHeight;

    closeElement.setAttribute('aria-expanded', 'false');
    content.setAttribute('aria-hidden', 'true');

    item.classList.remove(modClass.accordionOpenClass);
    content.style.height = 0;

    fixElementScroll(item);
  };

  // Updates content height on window resize
  var updateContentHeight = function () {
    var items = document.querySelectorAll('.bs-faq-refactored__item');

    Array.prototype.forEach.call(items, function (element, i) {
      var content = element.querySelector(config.accordionContent);
      var contentHeight = content.querySelector('.bs-faq-refactored__box').scrollHeight + 'px';
      var accordion = getParents(element, config.disabledOnDesktop)[0];

      // If the .bs-js-accordion-content height is different from its content, updates its height
      if (element.classList.contains(modClass.accordionOpenClass) && parseInt(content.style.height) != contentHeight) {
        content.style.height = contentHeight;
      }


      // If accordion is set to be disabled on desktop, update items height
      if (accordion) {
        if (
          (element.classList.contains(modClass.accordionOpenClass) && parseInt(content.style.height) != contentHeight) ||
          (!element.classList.contains(modClass.accordionOpenClass) && window.innerWidth >= 1200)
        ) {
          content.style.height = contentHeight;
        } else if (!element.classList.contains(modClass.accordionOpenClass) && window.innerWidth < 1200) {
          content.style.height = 0;
        }
      }
    });
  }

  // Checks if the accordion should be disabled on desktop
  // and then disable its buttons
  var disableAccordionOnDesktop = function () {
    Array.prototype.forEach.call(config.accordion, function (element, i) {
      if (element.classList.contains(config.disabledOnDesktop)) toggleButtons(element);
    });
  }

  // Disable the accordion buttons
  var toggleButtons = function (element) {
    var items = element.querySelectorAll('.bs-js-open-accordion');

    if (window.innerWidth >= 1200) {
      Array.prototype.forEach.call(items, function (el, i) {
        el.disabled = true;
      });
    } else {
      Array.prototype.forEach.call(items, function (el, i) {
        el.disabled = false;
      });
    }
  }

  // Fix scroll of an element when tabbing focus
  // on an element inside a div who will be hidden
  // after a transition
  var fixElementScroll = function (el) {
    setTimeout(function () {
      el.scrollTo(0, 0);
    }, 300);
  };

  var handleAccordionKeyboard = function (ev) {
    var accordion = ev.currentTarget;
    var currentEl = ev.target;
    var key = ev.key;
    var buttonsNode = accordion.querySelectorAll('.bs-js-open-accordion');
    var buttons = Array.prototype.slice.call(buttonsNode);
    var currentButton = (
        currentEl.classList.contains('bs-js-open-accordion')) ?
      currentEl : currentEl.closest('.bs-js-open-accordion');
    var firstButton = buttons[0];
    var lastButton = buttons[buttons.length - 1];
    var prevButton = buttons.indexOf(currentButton) ?
      buttons[buttons.indexOf(currentButton) - 1] :
      lastButton;
    var nextButton = buttons.indexOf(currentButton) < buttons.length - 1 ?
      buttons[buttons.indexOf(currentButton) + 1] :
      firstButton;

    if (currentButton) {
      switch (key) {
        case "Right": // IE/Edge specific value
        case "ArrowRight":
          openAccordionItem(currentButton);
          break;
        case "Left": // IE/Edge specific value
        case "ArrowLeft":
          closeAccordionItem(currentButton);
          break;
        case "Down": // IE/Edge specific value
        case "ArrowDown":
          nextButton.focus();
          break;
        case "Up": // IE/Edge specific value
        case "ArrowUp":
          prevButton.focus();
          break;
        case 'Home':
          firstButton.focus();
          break;
        case 'End':
          lastButton.focus();
          break;
        default:
      }
    }
  };

  return {
    init: init,
  };
}());

/**
 * Init Modal Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-faq-refactored').length) {
    BsAccordionRef.init();
  }
});

/**
 * Bs Filter (anchor)
 */
var BsFilter = (function () {
  // Elements
  var elements = {};
  var $ = elements;
  $.body = document.querySelector('body');
  $.filter = document.querySelector('.bs-js-filter');

  if (!$.filter) return;

  $.nav = $.filter.querySelector('.bs-js-filter--nav');
  $.toggle = $.filter.querySelector('.bs-js-filter--toggle');
  // $.dropdown = new BsDropdown();
  $.list = $.filter.querySelector('.bs-js-filter--list');
  $.grid = $.filter.querySelector('.grid');
  $.items = $.list.querySelectorAll('.bs-js-filter--item');

  // Config
  var config = {
    filter: null,
    itemSelector: '.bs-js-filter--item',
    itemSizerSelector: '.bs-js-filter--sizer',
    buttonActiveClass: 'bs-filter-link--active',
    itemActiveClass: 'bs-filter__item--visible',
    itemSelectorList: document.querySelectorAll('.bs-js-filter--item'),
    buttons: document.querySelectorAll('.bs-js-filter--button'),
    selects : document.querySelectorAll('.bs-js-filter--nav select'),
    checkboxes : document.querySelectorAll('.bs-js-filter--nav input'),
    slider : document.querySelector('.bs-js-modal-carousel'),
    selectsNode : [],
    checkboxesNode : []
  };

  var init = function () {
    // Retorna itens filtrados
    filterMasonry()

    // - Percorre navegao de icones ou tabs superior se exsitir
    Array.prototype.forEach.call(config.buttons, function (el) {
      var tag = el.dataset.filter;
      el.addEventListener('click', function () {
        activeButton(el)
        filterItems(tag)
      })
    })
    //- percorre selects e retorna
    Array.prototype.forEach.call(config.selects, function(elem) {
      config.selectsNode.push(elem)
    })
    //- percorre checkbox pelo data filter, retorna e atualiza o componente se checked
    Array.prototype.forEach.call(config.checkboxes, function(elem) {
      config.checkboxesNode.push(elem);
      if (elem.checked) {
        var tag = elem.getAttribute('data-filter')
        filterItems(tag)
      }
    })

    // Contacatena os elemento de select e checkbox para realizar o filtro multiplo na sequencia
    var returnAllEvent = config.selectsNode.concat(config.checkboxesNode)

    // -Aplica condies para setar filtros e suas comparaes a partir do evento change
    Array.prototype.forEach.call(returnAllEvent, function(elem){
      elem.addEventListener('change', run)
    })

    run();
  };

  var run = function () {
    // map input values to an array
    var exclusives = []
    var inclusives = []

    //- Atribui options de cada select
    Array.prototype.forEach.call(config.selects, function (el) {
      var attr = el.options[el.selectedIndex].getAttribute('data-filter')
      //var attrValue = el.options[el.selectedIndex].value
      if (attr)
        exclusives.push(attr);

      // Percorre Lista apos select change e remove a classe para o flickity, aps change  adicionado no ON.arrange a classe no item seleciona
      Array.prototype.forEach.call(config.itemSelectorList,function(el) {
        el.classList.remove('bs-js-filter--modal');
      })
    })

    // Atribui ao Checkbox o item a ser verificado
    Array.prototype.forEach.call(config.checkboxes, function (el) {
      if (el.checked) {
        var attr = el.getAttribute('data-filter');
        inclusives.push(attr);
      }
    });

    // Armazena os options e os separa
    exclusives = exclusives.join('');

    var tag;
    // Verificao se houver checkebox
    if (inclusives.length){
      // Map para retornar os dois valores e os separa
      // debugger
      tag = inclusives.map( function( value ) {
        return value + exclusives
      })
      tag = tag.join(', ')
    } else {
      tag = exclusives;
    }
    filterItems(tag)
  }

  var filterMasonry = function () {
    config.filter = new Isotope($.list, {
      layoutMode: 'packery',
      itemSelector: config.itemSelector,
      columnWidth: config.itemSizerSelector,
      percentPosition: true,
      rowHeight: 320,
    });

    // Aplica funo da classe modal a itens retornados
    config.filter.on('arrangeComplete', function (filteredItems) {
      var filteredItemsArray = filteredItems.map(function (item) {
        return item.element;
      });


      var filteredItemsIndex = Array.prototype.map.call(config.itemSelectorList, function (el, index) {
        // if (filteredItemsArray.indexOf(el))
        if (filteredItemsArray.includes(el))
          return index;
      });

      var itemsIndex = Array.prototype.filter.call(filteredItemsIndex, function (el, index) {
        return typeof el !== 'undefined'
      });

      //debugger
      if (config.slider) BsModalList.loadSlider(config.slider, itemsIndex);
    });
  };

  // - Aplica filter tag das configuraes e condies
  var filterItems = function (tag) {
    if (typeof tag !== 'string') return
    if (tag !== '*' && tag.indexOf('.') !== 0 && tag !== '') {
      tag = '.' + tag;
    }
    config.filter.arrange({ filter: tag })
  }

  var activeButton = function (el) {
    var itemActive = $.nav.querySelector('.' + config.buttonActiveClass);
    if (itemActive) itemActive.classList.remove(config.buttonActiveClass);
    el.classList.add(config.buttonActiveClass);
    updateLabel(el.innerHTML);
  };

  var updateLabel = function (label) {
    var span = $.toggle.querySelector('span');
    span.innerHTML = label;
  };

  return {
    init: init,
    filter: function () {
      return config.filter
    },
    run: run,
  };
}());

/**
 * Init Filter Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-js-filter').length) {
    BsFilter.init();
  }
})

/**
 * Back To Top
 * Smooth scroll to top of the page
 * @link https://codepen.io/Qbrid/pen/EgAYNg
 */
var BsFooter = (function () {
  var config = {
    interval: null,
    isMobile: function () {
      return window.innerWidth < 768;
    },
    defaultTitleHeight: 60,
    initialized: false,
    items: document.querySelectorAll('.bs-js-footer-accordion-item'),
    contentClass: 'bs-js-footer-accordion-item--content',
    titleClass: 'bs-js-footer-accordion-item--title',
    isOpenClass: 'bs-footer-nav__group--is-open',
  };

  /**
   * Inicializa a funo
   * @param {Object} el a DOM element
  */
  var init = function () {
    handleBuildDestroy();
    window.addEventListener('resize', function () {
      resizeTimer(function () {
        handleBuildDestroy();
      });
    });
  };

  var handleBuildDestroy = function () {
    // debugger;
    // Build menu and add event listeners
    if (config.isMobile() && !config.initialized) {
      build();
    } else if (!config.isMobile() && config.initialized) {
      destroy();
    } else {
      // everything's fine
    }
  };

  var build = function () {
    // debugger;
    config.initialized = true;
    Array.prototype.forEach.call(config.items, function (item) {
      adjustHeight(item, 'collapse');
      item.addEventListener('click', toggle);
    });
  };

  var destroy = function () {
    // debugger;
    config.initialized = false;
    Array.prototype.forEach.call(config.items, function (item) {
      adjustHeight(item);
      item.classList.remove(config.isOpenClass);
      item.removeEventListener('click', toggle);
    });
  };

  var toggle = function (event) {
    var item = event.currentTarget;
    if (!item.classList.contains(config.isOpenClass)) {
      open(item);
    } else {
      close(item);
    }
  };

  var open = function (item) {
    adjustHeight(item, 'expand');
    item.classList.add(config.isOpenClass);
  };

  var close = function (item) {
    adjustHeight(item, 'collapse');
    item.classList.remove(config.isOpenClass);
  };

  var adjustHeight = function (item, action) {
    var title = item.querySelector('.' + config.titleClass);
    var titleHeight = (title && title.offsetHeight) || config.defaultTitleHeight;
    var itemHeight = item.scrollHeight;
    if (action === 'collapse') {
      item.style.height = titleHeight + 'px';
    } else if (action === 'expand') {
      item.style.height = itemHeight + 'px';
    } else {
      item.style.height = '';
    }
  };

  var resizeTimer = function (callback) {
    clearTimeout(config.interval);
    config.interval = setTimeout(callback, 300);
  };

  return {
    init: init,
  };
}());

document.addEventListener('DOMContentLoaded', function () {
  var footerList = document.querySelectorAll('.bs-js-footer-accordion-item');

  if (footerList.length) {
    BsFooter.init();
  }
});

/**
 * Back To Top
 * Smooth scroll to top of the page
 * @link https://codepen.io/Qbrid/pen/EgAYNg
 */
var BsFooter = (function () {
  var config = {
    interval: null,
    isMobile: function () {
      return window.innerWidth < 768;
    },
    defaultTitleHeight: 60,
    initialized: false,
    items: document.querySelectorAll('.bs-js-footer-accordion-item'),
    contentClass: 'bs-js-footer-accordion-item--content',
    titleClass: 'bs-js-footer-accordion-item--title',
    isOpenClass: 'bs-footer-nav__group--is-open',
  };

  /**
   * Inicializa a funo
   * @param {Object} el a DOM element
  */
  var init = function () {
    handleBuildDestroy();
    window.addEventListener('resize', function () {
      resizeTimer(function () {
        handleBuildDestroy();
      });
    });
  };

  var handleBuildDestroy = function () {
    // debugger;
    // Build menu and add event listeners
    if (config.isMobile() && !config.initialized) {
      build();
    } else if (!config.isMobile() && config.initialized) {
      destroy();
    } else {
      // everything's fine
    }
  };

  var build = function () {
    // debugger;
    config.initialized = true;
    Array.prototype.forEach.call(config.items, function (item) {
      adjustHeight(item, 'collapse');
      item.addEventListener('click', toggle);
    });
  };

  var destroy = function () {
    // debugger;
    config.initialized = false;
    Array.prototype.forEach.call(config.items, function (item) {
      adjustHeight(item);
      item.classList.remove(config.isOpenClass);
      item.removeEventListener('click', toggle);
    });
  };

  var toggle = function (event) {
    var item = event.currentTarget;
    if (!item.classList.contains(config.isOpenClass)) {
      open(item);
    } else {
      close(item);
    }
  };

  var open = function (item) {
    adjustHeight(item, 'expand');
    item.classList.add(config.isOpenClass);
  };

  var close = function (item) {
    adjustHeight(item, 'collapse');
    item.classList.remove(config.isOpenClass);
  };

  var adjustHeight = function (item, action) {
    var title = item.querySelector('.' + config.titleClass);
    var titleHeight = (title && title.offsetHeight) || config.defaultTitleHeight;
    var itemHeight = item.scrollHeight;

    if (action === 'collapse') {
      item.style.height = titleHeight + 'px';
    } else if (action === 'expand') {
      item.style.height = itemHeight + 'px';
    } else {
      item.style.height = '';
    }
  };

  var resizeTimer = function (callback) {
    clearTimeout(config.interval);
    config.interval = setTimeout(callback, 300);
  };

  return {
    init: init,
  };
}());

document.addEventListener('DOMContentLoaded', function () {
  var footerList = document.querySelectorAll('.bs-js-footer-accordion-item');

  if (footerList.length) {
    BsFooter.init();
  }
});

/**
 * Gallery
 * @return Module config
 */
var BsGallery = function (element, options) {
  var elem = element;
  var config = {};

  var setConfig = function (el) {
    return {
      el: el,
      navItems: el.querySelectorAll('.bs-gallery__thumb'),
      images: el.querySelectorAll('.bs-gallery__item'),
      navItemActiveClass: 'bs-gallery__thumb--active',
      imageActiveClass: 'bs-gallery__item--active',
      pagTotal: document.querySelector('.bs-gallery__pagination--total'),
      pagCounter: document.querySelector('.bs-gallery__pagination--counter'),
      navIndex: 0,
      navMoment: 0,
    };
  };

  var init = function () {
    if (!elem || typeof elem !== 'object') return;
    config = setConfig(elem);

    Array.prototype.forEach.call(config.navItems, function (item, index) {

      // sum index, after each - print div
      config.navIndex = index + 1;

      item.addEventListener('click', setItem.bind(null, item));

    });

    config.pagTotal.innerHTML = config.navIndex;
  };

  var setItem = function (navItem) {
    var targetIndex = Array.prototype.indexOf.call(config.navItems, navItem);
    var currentNavItemActive = config.el.querySelector('.' + config.navItemActiveClass);
    var currentImageActive = config.el.querySelector('.' + config.imageActiveClass);

    currentNavItemActive.classList.remove(config.navItemActiveClass);
    currentImageActive.classList.remove(config.imageActiveClass);

    navItem.classList.add(config.navItemActiveClass);
    config.images[targetIndex].classList.add(config.imageActiveClass);

    // sum index - print div
    config.navMoment = targetIndex + 1;
    config.pagCounter.innerHTML = config.navMoment;

    // Pausa os vdeos que estejam rodando dentro do modal
    if (currentImageActive.querySelector('.bs-video') && BsYTPlayers) {
      BsYTPlayers.getPlayer(currentImageActive.querySelector('.bs-video').id).stopVideo();
    }
  };

  return {
    init: init,
  };
};

/**
 * Init Header Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  var galleries = document.querySelectorAll('.bs-js-gallery');
  if (galleries.length) {
    Array.prototype.forEach.call(galleries, function (element) {
      var gallery = BsGallery(element, {});
      gallery.init();
    });
  }
});






// /**
//  * Gallery
//  * @return Module config
//  */
// var BsGallery = function (element, options) {
//   var elem = element;
//   var config = {};

//   var setConfig = function (el) {
//     return {
//       el: el,
//       navItems: el.querySelectorAll('.bs-gallery__thumb'),
//       navItemsThumb: el.querySelectorAll('.bs-gallery__nav'),
//       images: el.querySelectorAll('.bs-gallery__item'),
//       navItemActiveClass: 'bs-gallery__thumb--active',
//       imageActiveClass: 'bs-gallery__item--active',
//       pagTotal: document.querySelector('.bs-gallery__pagination--total'),
//       pagCounter: document.querySelector('.bs-gallery__pagination--counter'),
//       navIndex: 0,
//       navMoment: 0,
//     };
//   };

//   var init = function () {
//     if (!elem || typeof elem !== 'object') return;
//     config = setConfig(elem);

//     Array.prototype.forEach.call(config.navItems, function (item, index) {

//       item.addEventListener('click', setItem.bind(null, item));

//     });

//     Array.prototype.forEach.call(config.navItemsThumb, function (item, index) {

//       // sum index, after each - print div
//       config.navIndex = index + 1;

//       item.addEventListener('click', setItemThumb.bind(null, item));

//     });

//     config.pagTotal.innerHTML = config.navIndex;
//   };

//   var setItem = function (navItem) {
//     var targetIndex = Array.prototype.indexOf.call(config.navItems, navItem);
//     var currentNavItemActive = config.el.querySelector('.' + config.navItemActiveClass);
//     var currentImageActive = config.el.querySelector('.' + config.imageActiveClass);

//     currentNavItemActive.classList.remove(config.navItemActiveClass);
//     currentImageActive.classList.remove(config.imageActiveClass);

//     navItem.classList.add(config.navItemActiveClass);
//     config.images[targetIndex].classList.add(config.imageActiveClass);

//     // Pausa os vdeos que estejam rodando dentro do modal
//     if (currentImageActive.querySelector('.bs-video')) {
//       BsYTPlayers.getPlayer(currentImageActive.querySelector('.bs-video').id).stopVideo();
//     }
//   };

//   var setItemThumb = function (navItem) {
//     var targetIndex = Array.prototype.indexOf.call(config.navItemsThumb, navItem);

//     // sum index - print div
//     config.navMoment = targetIndex + 1;
//     config.pagCounter.innerHTML = config.navMoment;
//   };

//   return {
//     init: init,
//   };
// };

// /**
//  * Init Header Constructor
//  * @return {void} Header.init();
//  */
// document.addEventListener('DOMContentLoaded', function () {
//   var galleries = document.querySelectorAll('.bs-js-gallery');
//   if (galleries.length) {
//     Array.prototype.forEach.call(galleries, function (element) {
//       var gallery = BsGallery(element, {});
//       gallery.init();
//     });
//   }
// });

/**
 * Grid
 */
document.addEventListener('DOMContentLoaded', function () {
  /* Grid Filter dropdown */
  var gridFormatToggle = document.querySelectorAll('.bs-js-grid-toggle-format');
  var dropdownToggle = document.querySelector('.bs-js-grid-toggle-dropdown');
  var gridList = document.querySelector('.bs-grid__list');
  var gridDropdown = new BsDropdown();
  var gridFormatClasses = {
    grid: 'bs-media--col3',
    list: 'bs-media--horizontal bs-media--image-prop-1-4 bs-media--hr',
  };

  if (dropdownToggle) {
    gridDropdown.init(dropdownToggle, {
      dropdownElement: dropdownToggle.parentNode,
      dropdownActiveClass: 'bs-is-expanded',
    });
  }

  if (gridList && gridFormatToggle) {
    Array.prototype.forEach.call(gridFormatToggle, function (input) {
      input.addEventListener('change', function (ev) {
        var type = ev.currentTarget.value;
        gridList.className = 'bs-media bs-grid__list ' + gridFormatClasses[type];
      });
    });
  }
});

// /**
//  * Header
//  * @return Module config
//  */
// var BsHeader = (function () {
//   // Class Modifiers
//   var modClass = {
//     headerFixed: 'bs-header--fixed',
//     headerFloating: 'bs-header--floating',
//     headerAccessActive: 'bs-header--access-open',
//     accessPanelActive: 'bs-header-access--open',
//     tabActive: 'bs-tabs__item--active',
//     tabPanelActive: 'bs-tabs__panel--active',
//   };

//   // DOM Elements
//   var el = {
//     header: document.querySelector('.bs-header'),
//     navLinks: document.querySelector('.bs-header-links'),
//     accessPanel: document.querySelector('.bs-header-access'),
//     accessModal: document.querySelector('.bs-header-access__modal'),
//     accessTabs: document.querySelector('.bs-tabs'),
//     accessTabsNav: document.querySelector('.bs-tabs__nav'),
//     accessTabsItem: document.querySelectorAll('.bs-js-toggle-tab'),
//     accessTabsContainer: document.querySelector('.bs-tabs__container'),
//     accessTabsPanel: document.querySelectorAll('.bs-tabs__panel'),
//     // Triggers
//     btnToggleAccessPanel: document.querySelector('.bs-js-toggle-access-panel'),
//     btnCloseAccessModal: document.querySelector('.bs-js-close-access-modal'),
//   };

//   /**
//    * Init function
//    * @return {Function} Module's scope functions
//    */
//   var init = function () {
//     // Toggle Access Panel
//     if (el.btnToggleAccessPanel) {
//       el.btnToggleAccessPanel.addEventListener('click', _toggleAccessPanel);
//     }

//     // Close Access Panel Mobile (Modal)
//     if (el.btnCloseAccessModal) {
//       el.btnCloseAccessModal.addEventListener('click', _closeAccessPanel);
//       document.querySelector('body').addEventListener('click', function (event) {
//         if (
//           !el.accessTabs.contains(event.target) &&
//           !el.btnToggleAccessPanel.contains(event.target)) {
//           _closeAccessPanel();
//           return false;
//         }
//       });
//     }

//     // Change Access Panel Tabs
//     for (var i = 0; i < el.accessTabsItem.length; i += 1) {
//       el.accessTabsItem[i].addEventListener(
//         'click',
//         _changeTab.bind(null, el.accessTabsItem[i])
//       );
//     }

//     // Set floating class to heaer
//     window.addEventListener('scroll', _setHeaderFloating);
//   };

//   var _toggleAccessPanel = function () {
//     var accessIsActive = (
//       !el.header.classList.contains(modClass.headerAccessActive) ||
//       !el.accessPanel.classList.contains(modClass.accessPanelActive)
//     );
//     if (accessIsActive) _openAccessPanel();
//     else _closeAccessPanel();
//   };

//   var _openAccessPanel = function () {
//     el.header.classList.add(modClass.headerAccessActive);
//     el.accessPanel.classList.add(modClass.accessPanelActive);
//   };

//   var _closeAccessPanel = function () {
//     el.header.classList.remove(modClass.headerAccessActive);
//     el.accessPanel.classList.remove(modClass.accessPanelActive);
//   };

//   var _changeTab = function (tabActive) {
//     var tabIndex = [].slice.call(tabActive.parentNode.children).indexOf(tabActive);

//     // Clean active tab class
//     el.accessTabsNav.querySelector('.' + modClass.tabActive)
//       .classList.remove(modClass.tabActive);

//     // Set active class to clicked tab
//     tabActive.classList.add(modClass.tabActive);

//     // Clean active tabs' panel class
//     el.accessTabsContainer.querySelector('.' + modClass.tabPanelActive)
//       .classList.remove(modClass.tabPanelActive);

//     // Set active class to panel that refers to tab clicked
//     el.accessTabsPanel[tabIndex].classList.add(modClass.tabPanelActive);
//   };

//   var _setHeaderFloating = function () {
//     if (_windowScrollDirection() === 'down') el.header.classList.add(modClass.headerFloating);
//     else el.header.classList.remove(modClass.headerFloating);
//   };

//   var _windowScrollDirection = function () {
//     var lastScrollTop = 0;
//     var currentPosition = window.pageYOffset || document.documentElement.scrollTop;
//     var direction = '';

//     // down
//     if (currentPosition > lastScrollTop) {
//       direction = 'down';
//     // up
//     } else {
//       direction = 'up';
//     }

//     lastScrollTop = currentPosition;

//     return direction;
//   };

//   return {
//     init: init,
//   };
// }());

// /**
//  * Init Header Constructor
//  * @return {void} Header.init();
//  */
// document.addEventListener('DOMContentLoaded', function () {
//   if (document.querySelector('.bs-header')) {
//     BsHeader.init();
//   }
// });

/**
 * Bs Header
 *
 * [TODO]: Refatorar para que os elementos do config referenciem um componente
 * header especfico ao invs de pegar todos os existentes no documento.
 */
var BsHeader = (function () {
  // Config
  var config = {
    headerContainer: document.querySelector('.bs-header__container'),
    hasTransparencyClass: 'bs-js-header-has-transparency',
    header: document.querySelector('.bs-header'),
    headerTop: document.querySelector('.bs-header__top'),
    headerMain: document.querySelector('.bs-header__main'),
    headerFloatingClass: 'bs-header--floating',
    headerPinnedClass: 'bs-header--pinned',
    headerFreezeClass: 'bs-header--freezed',
    headerTopPositionToFloat: 0,
    headerTopPositionToPin: 110,
    headerTopPositionToTransparency: 0,
    headerTransparentClass: 'bs-header--transparent',
    headerUnpinnedClass: 'bs-header--unpinned',
    isFixedClass: 'bs-header--fixed',
    isStaticClass: 'bs-header--static',
    scrollTopPosition: function () {
      return window.pageYOffset || document.documentElement.scrollTop;
    },
    scrollDirection: 0,
    lastScrollTop: 0,
  };

  var init = function () {
    // Set header transparent on home page load
    setHeaderTransparent();

    if (config.header.classList.contains(config.isStaticClass)) return;

    window.addEventListener('scroll', function () {
      var header_elm = document.querySelector('.bs-header');
      if ((" " + header_elm.parentNode.className + " ").replace(/[\n\t]/g, " ").indexOf(" bs-refactor ") == -1 ) {
        setHeaderPinned();
        setHeaderFloating();
        setHeaderTransparent();
      }
    });
  };

  var setHeaderFloating = function (force) {

    if (isFreezed()) return;

    if (typeof force === 'undefined') force = false;
    var headerHeight = config.headerMain.offsetHeight + config.headerTop.offsetHeight;
    if (config.scrollTopPosition() > config.headerTopPositionToFloat || force) {
      adjustBodyMargin(headerHeight);
      config.header.classList.add(config.headerFloatingClass);
    } else if (config.scrollTopPosition() < 1) {
      adjustBodyMargin(0);
      config.header.classList.remove(config.headerFloatingClass);
    }
  };

  var setHeaderPinned = function () {

    if (isFreezed()) return;

    if (config.scrollTopPosition() > config.headerTopPositionToPin) {
      if (BsSearchForm.isOpen() || BsSearchForm.hasFocus()) return;
      if (getScrollDirection() === 'down') {
        config.header.classList.remove(config.headerPinnedClass);
        config.header.classList.add(config.headerUnpinnedClass);
        BsSearchForm.close();
      } else {
        config.header.classList.add(config.headerPinnedClass);
        config.header.classList.remove(config.headerUnpinnedClass);
      }
    } else {
      config.header.classList.remove(config.headerUnpinnedClass);

      if (config.scrollTopPosition() > 0) {
        config.header.classList.add(config.headerPinnedClass);
      } else {
        config.header.classList.remove(config.headerPinnedClass);
      }
    }
  };

  var setHeaderUnpinned = function () {

    if (isFreezed()) return;

    config.header.classList.remove(config.headerPinnedClass);
    config.header.classList.add(config.headerUnpinnedClass);
  };

  var setHeaderFreeze = function () {
    config.header.classList.add(config.headerFreezeClass);
  };

  var unsetHeaderFreeze = function () {
    config.header.classList.remove(config.headerFreezeClass);
  };


  var setHeaderTransparent = function () {
    if (!headerHasTransparency()) return;
    if (
      config.scrollTopPosition() === 0 ||
      config.scrollTopPosition() < config.headerTopPositionToTransparency) {
      config.header.classList.add(config.headerTransparentClass);
    } else {
      config.header.classList.remove(config.headerTransparentClass);
    }
  };

  var getScrollDirection = function () {
    // down
    if (config.scrollTopPosition() > config.lastScrollTop) {
      config.scrollDirection = 'down';
    // up
    } else if (config.scrollTopPosition() === config.lastScrollTop) {
      // config.scrollDirection = '';
    } else if (config.scrollTopPosition() < config.lastScrollTop) {
      config.scrollDirection = 'up';
    }

    config.lastScrollTop = config.scrollTopPosition();

    return config.scrollDirection;
  };

  var isFreezed = function () {
    return config.header.classList.contains(config.headerFreezeClass);
  };

  var isHeaderFloating = function () {
    return config.header.classList.contains(config.headerFloatingClass);
  };

  var headerHasTransparency = function () {
    return (
      document.body.classList.contains(config.hasTransparencyClass)
      || config.header.classList.contains(config.hasTransparencyClass)
    );
  };

  var headerIsFixed = function () {
    return config.header.classList.contains(config.isFixedClass);
  };

  var adjustBodyMargin = function (margin) {
    if (config.headerContainer) {
      if (!headerIsFixed() && !headerHasTransparency() && margin) {
        config.headerContainer.style.height = margin + 'px';
      } else {
        config.headerContainer.style.height = 'auto';
      }
    } else if (!headerIsFixed()) {
      // deprecated
      // header must always have a container element
      document.body.style.marginTop = margin + 'px';
    }
  };

  return {
    init: init,
    el: config.header,
    isFloating: isHeaderFloating,
    setHeaderFloating: setHeaderFloating,
    setUnpinned: setHeaderUnpinned,
    setFreeze: setHeaderFreeze,
    unsetFreeze: unsetHeaderFreeze,
    headerPinned: config.headerPinnedClass,
  };
}());

/**
 * Init Header Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-header').length) {
    BsHeader.init();
  }
});

/* JS Novo Menu institucional */
var BSHeaderNew = (function () {

    var header = [];

    var init = function () {

        header = document.getElementsByClassName("bs-header"); // --- elem: header
        btn_menu_dropdown = header[0].getElementsByClassName("dropdown"); // --- elem: menu principal, opes com dropdown
        btn_menu_dropdown_submenus = header[0].getElementsByClassName("bs-option-main-menu"); // --- elem: menu principal, submenus
        btn_menu_mobile = header[0].getElementsByClassName("bs-mobile-header-main-menu")[0]; // --- elem: menu principal hamburger
        btn_menu_buscar = header[0].getElementsByClassName("bs-header-buscar"); // --- elem: boto Luscar
        menu_ico_search = header[0].getElementsByClassName("icon-nav-busca"); // --- elem: boto Luscar
        btn_menu_login = header[0].getElementsByClassName("bs-button--login"); // --- elem: boto Login

        // Verifica qual browser e qual tipo de dispositivo est acessando;
        chkBrowser();
        chkDevice(header);

        // Inicializar comportamento do Scroll caso o menu seja mobile
        scrollHeaderCtrl();

        // Ao botes menu principal (Desktop)

          btn_menu_dropdown[0].addEventListener('keydown', function(e) { // Fechar todos os menus quando o shift+tab for executado na primeira opo
              if (e.which === 9 && e.shiftKey) {
                  closeAllMenus(header);
                  removeHeaderOverlay();
              }
          })
        for(i = 0; i< btn_menu_dropdown.length;i++){
            btn_menu_dropdown[i].addEventListener('click', function(event) {

                // Verificar o tipo de dispositivo est acessando
                var isMobile = document.getElementsByClassName("header-mobile");
                if (isMobile.length == 0) { // Desktop
                    var option_menu_dropdown = this.parentNode.getElementsByClassName("menu");

                    // Verifica o estado atual do menu para determinar se deve abri-lo ou fecha-lo
                    if ((" " + option_menu_dropdown[0].className + " ").replace(/[\n\t]/g, " ").indexOf(" open ") > -1) {

                        // Fecha menu selecionado
                        this.classList.remove("is-open");
                        option_menu_dropdown[0].classList.remove("open");
                        toggleHeaderExpanded(header);

                        // Remove Overlay do header
                        removeHeaderOverlay();
                    }  else {
                        // Fecha todos os menus atualmente abertos
                        closeAllMenus(header);

                        // Remove Overlay do header
                        removeHeaderOverlay();

                        // Abre menu selecionado
                        this.classList.add("is-open");
                        option_menu_dropdown[0].classList.add("open");
                        toggleHeaderExpanded(header, "expand");

                        //Se for ultimo item nevagado, fecha menu
                        var itemsEls = document.querySelectorAll(".bs-refactor .bs-header .bs-header__exp-content .menu.open a");
                        var menuElem = document.querySelectorAll('a.bs-header-menu-option:not(.bs-header-buscar)');
                        var menuCurrentElem = document.querySelector('a.bs-header-menu-option.is-open');

                        for(i=0; i < itemsEls.length; i++){

                          itemsEls[i].addEventListener('keydown', function(e){

                              var currentItem = document.activeElement;
                              var firstItem = itemsEls[0];
                              var lastItem = itemsEls[itemsEls.length - 1];
                              var currentElemPos = 0;

                              // Captura qual  a posiao do elemento que est aberto
                              for (let i = 0; i < menuElem.length; i++) {
                                  if (menuCurrentElem == menuElem[i]) {
                                      currentElemPos = i;
                                  }
                              }

                              if (e.which === 9 && e.shiftKey) { // Captura Shift + Tab

                                  if (currentItem == firstItem) {
                                      // console.log("Shift + Tab: primeiro item");

                                      if (currentElemPos == 0) { // Comportamento quando for o primeiro item do menu (focar na logo da BS)
                                          closeAllMenus(header);
                                          removeHeaderOverlay();
                                      } else if ((" " + menuElem[currentElemPos-1].className + " ").replace(/[\n\t]/g, " ").indexOf(" dropdown ") > -1) { // Comportamento quando o item anterior for uma dropdown (trazer aberto)
                                          menuElem[currentElemPos].focus();
                                          setTimeout(function() { // Necessrio para previnir que o foco v para o item do submenu
                                              closeAllMenus(header);
                                              removeHeaderOverlay();
                                              menuElem[currentElemPos-1].click()
                                          })
                                      } else { // Comportamento quando o item aterior no for dropdown (fechar os menus)
                                          menuElem[currentElemPos].focus();
                                          closeAllMenus(header);
                                          removeHeaderOverlay();
                                      }
                                  }

                              } else if (e.which === 9) { // Captura apenas Tab

                                  if (currentItem == lastItem) {
                                      // console.log("Tab: ltimo item");

                                      if ((" " + menuElem[currentElemPos+1].className + " ").replace(/[\n\t]/g, " ").indexOf(" dropdown ") > -1) { // Abrir a dropdown se o prximo menu for uma dropdown
                                          menuElem[currentElemPos+1].click();
                                      } else {
                                          closeAllMenus(header);
                                          removeHeaderOverlay();
                                      }
                                  }

                              }
                          });
                        }

                        // Adciona Overlay do header
                        addHeaderOverlay();
                    }

                } else { // Mobile
                    var all_menu_options = this.parentNode.parentNode.getElementsByClassName("bs-main-menu-option");
                    var all_top_menu_options = this.parentNode.parentNode.getElementsByClassName("bs-top-menu__option");
                    var options_acessibility = this.parentNode.parentNode.getElementsByClassName("bs-container-acessibility__mobile");
                    var option_menu_dropdown = this.parentNode.getElementsByClassName("menu");

                    // Verifica o estado atual do menu para determinar se deve abri-lo ou fecha-lo
                    if ((" " + option_menu_dropdown[0].className + " ").replace(/[\n\t]/g, " ").indexOf(" open ") > -1) {

                        // Fecha todos os submenus
                        for(i = 0; i< all_menu_options.length;i++){
                            all_menu_options[i].classList.remove("hide");
                        }
                        for(i = 0; i< all_top_menu_options.length;i++){
                            all_top_menu_options[i].classList.remove("hide");
                        }
                        options_acessibility[0].classList.remove("hide");
                        closeAllSubMenus(header);

                        // Fecha menu selecionado
                        this.parentNode.classList.remove("open");
                        option_menu_dropdown[0].classList.remove("open");
                    }  else {
                        // Oculta as demais opes e o menu de acessibilidade
                        for(i = 0; i< all_menu_options.length;i++){
                            all_menu_options[i].classList.add("hide");
                        }
                        for(i = 0; i< all_top_menu_options.length;i++){
                            all_top_menu_options[i].classList.add("hide");
                        }
                        options_acessibility[0].classList.remove("hide");

                        // Abre menu selecionado
                        this.parentNode.classList.add("open");
                        option_menu_dropdown[0].classList.add("open");
                        options_acessibility[0].classList.add("hide");
                    }
                }
            })
        }

        // Ao Submenus menu principal (Mobile)
        for(i = 0; i< btn_menu_dropdown_submenus.length;i++){
            btn_menu_dropdown_submenus[i].addEventListener('click', function(event) {
                var opcoes_submenu = this.parentNode.parentNode.getElementsByTagName("li");

                // Desabilitar o href do link quando mobile e quando a opo no possuir sub itens
                var isMobile = document.getElementsByClassName("header-mobile");
                if (isMobile.length != 0 && opcoes_submenu.length > 1) {
                    event.preventDefault();
                }

                // Verifica o estado atual do submenu para determinar se deve abri-lo ou fecha-lo
                if ((" " + this.className + " ").replace(/[\n\t]/g, " ").indexOf(" open ") > -1) {
                    // Fecha todos os submenus
                    closeAllSubMenus(header);

                }  else {
                    // Fecha todos os submenus
                    closeAllSubMenus(header);

                    // Abre menu selecionado
                    this.classList.add("open");
                    for(i = 0; i< opcoes_submenu.length;i++){
                        if ((" " + opcoes_submenu[i].className + " ").replace(/[\n\t]/g, " ").indexOf(" open ") == -1) {
                            opcoes_submenu[i].classList.add("open");
                        }
                    }
                }
            })
        }

        // Ao boto menu hamburger (mobile)
        btn_menu_mobile.addEventListener('click', function() {
            var mobile_option_menu_dropdown = this.parentNode.getElementsByClassName("bs-header__exp-content--main-menu");
            var options_acessibility = this.parentNode.getElementsByClassName("bs-container-acessibility__mobile");
            var all_menu_options = this.parentNode.getElementsByClassName("bs-main-menu-option");
            var all_top_menu_options = this.parentNode.getElementsByClassName("bs-top-menu__option");

            if ((" " + mobile_option_menu_dropdown[0].className + " ").replace(/[\n\t]/g, " ").indexOf(" open ") > -1) {
                // Fecha menu hamburger
                this.classList.remove("is-open");
                mobile_option_menu_dropdown[0].classList.remove("open");
                toggleHeaderExpanded(header);

                // Remove Overlay do header
                removeHeaderOverlay();
            } else {
                // Fecha todos os menus atualmente abertos
                closeAllMenus(header);
                for(i = 0; i< all_menu_options.length;i++){
                    all_menu_options[i].classList.remove("hide");
                }
                for(i = 0; i< all_top_menu_options.length;i++){
                    all_top_menu_options[i].classList.remove("hide");
                }
                options_acessibility[0].classList.remove("hide");

                // Remove Overlay do header
                removeHeaderOverlay();

                // Abre menu hamburger
                this.classList.add("is-open");
                mobile_option_menu_dropdown[0].classList.add("open");
                toggleHeaderExpanded(header, "expand");

                // Adciona Overlay do header
                addHeaderOverlay();
            }
        })

        // Ao boto Busca
        btn_menu_buscar[0].addEventListener('click', function(event) {
            var menu_busca = this.parentNode.getElementsByClassName("menu");

            // Verifica o estado atual do menu para determinar se deve abri-lo ou fecha-lo
            if ((" " + menu_busca[0].className + " ").replace(/[\n\t]/g, " ").indexOf(" open ") > -1) {
                // Fecha menu selecionado
                menu_busca[0].classList.remove("open");
                this.classList.remove("is-open");
                toggleHeaderExpanded(header);

                // Remove Overlay do header
                removeHeaderOverlay();
            }  else {
                // Fecha todos os menus atualmente abertos
                closeAllMenus(header);

                // Remove Overlay do header
                removeHeaderOverlay();

                // Abre menu selecionado
                menu_busca[0].classList.add("open");
                this.classList.add("is-open");
                toggleHeaderExpanded(header, "expand");

                // Adciona Overlay do header
                addHeaderOverlay();
            }
        })

        // Atribui evento de form submit para o icone de lupa do componente busca
        menu_ico_search[0].addEventListener("click", function(e) {

            var form_busca = document.getElementById("bs_form_busca");

            if (form_busca != null) {
                form_busca.submit();
            }
        })

        // Ao boto Login
        btn_menu_login[0].addEventListener('click', function(event) {

            var btn_menu_login = this.parentNode.getElementsByClassName("menu");

            // Verifica o estado atual do menu para determinar se deve abri-lo ou fecha-lo
            if ((" " + btn_menu_login[0].className + " ").replace(/[\n\t]/g, " ").indexOf(" open ") > -1) {
                // Fecha menu selecionado
                btn_menu_login[0].classList.remove("open");
                this.parentNode.classList.remove("is-open");
                toggleHeaderExpanded(header);

                // Remove Overlay do header
                removeHeaderOverlay();
            }  else {
                // Fecha todos os menus atualmente abertos
                closeAllMenus(header);

                // Remove Overlay do header
                removeHeaderOverlay();

                // Reseta as subopes de login para o seu estado inicial padro
                loginDefaultInit(this);

                // Abre menu selecionado
                btn_menu_login[0].classList.add("open");
                this.parentNode.classList.add("is-open");
                toggleHeaderExpanded(header, "expand");

                // Adciona Overlay do header
                addHeaderOverlay();
            }

            // Altera parmetro acessibilidade: aria-expanded do item
            var parameterAriaExpanded = this.getAttribute("aria-expanded");
            var parameterAriaExpanded = parameterAriaExpanded == "false" ? parameterAriaExpanded = "true" : parameterAriaExpanded = "false";
            this.setAttribute("aria-expanded", parameterAriaExpanded);
        })

        // Inicializar aes dos subitens de Login
        loginBehaviour(btn_menu_login)

        // Clona elementos menu superior para dentro do menu mobile
        topMenuMobile(header);

        // Fechar o menu ao apertar a tecla ESC
        document.onkeydown = function(evt) {
            evt = evt || window.event;
            var isEscape = false;
            if ("key" in evt) {
                isEscape = (evt.key === "Escape" || evt.key === "Esc");
            } else {
                isEscape = (evt.keyCode === 27);
            }
            if (isEscape) {
                removeHeaderOverlay();

                // Focar na opo do menu referente ao elemento ativo quando fechar o menu expandido
                // Menu princial
                if (document.activeElement.closest(".bs-main-menu-option") != null) {
                    var menu_option = document.activeElement.closest(".bs-main-menu-option");
                    menu_option.getElementsByClassName("bs-header-menu-option")[0].focus();
                }

                // Busca
                if (document.activeElement.closest(".menu_search") != null) {
                    document.getElementsByClassName("bs-header-buscar")[0].focus();
                }

                // Login
                if (document.activeElement.closest(".menu_login") != null) {
                    //document.getElementsByClassName("bs-button--login")[0].focus();
                }
            }
        };

        //Setando valor no focalizvel para SVG/Problema IE11
        var removeFocusableSvg = document.querySelector('.bs-logo svg');
        removeFocusableSvg.setAttribute('focusable', 'false');
    }

    // Inicializao padro submenus login
    var loginDefaultInit = function(btn_menu_login) {
        // Containter do login
        var login_container = btn_menu_login.parentNode;
        // Menu expansvel do login
        var login_exp_menu = login_container.getElementsByClassName("bs-header__exp-content");
        // Botes opes Login
        var btn_options_login = login_exp_menu[0].getElementsByClassName("subitem");
        // Subopes Login
        var options_login = login_exp_menu[0].getElementsByClassName("subcontent");

        // Verificar o tipo de dispositivo est acessando
        var isMobile = document.getElementsByClassName("header-mobile");
        if (isMobile.length == 0) { // Desktop
            // Fechar os submenus que esto abertos e desmarcar as opes de login selecionadas
            for(i = 0; i< options_login.length;i++){
                options_login[i].classList.remove("open");
            }
            for(i = 0; i< btn_options_login.length;i++){
                btn_options_login[i].classList.remove("open");
            }

            btn_options_login[0].classList.add("open");
            options_login[0].classList.add("open");
        } else { // Mobile
            // Fechar os submenus que esto abertos e desmarcar as opes de login selecionadas
            for(i = 0; i< options_login.length;i++){
                options_login[i].classList.remove("open");
            }
            for(i = 0; i< btn_options_login.length;i++){
                btn_options_login[i].classList.remove("open");
                btn_options_login[i].classList.remove("hide");
            }
        }
    }

    // Funo comportamento Login
    var loginBehaviour = function(btn_menu_login) {

        // Containter do login
        var login_container = btn_menu_login[0].parentNode;
        // Menu expansvel do login
        var login_exp_menu = login_container.getElementsByClassName("bs-header__exp-content");
        // Botes opes Login
        var btn_options_login = login_exp_menu[0].getElementsByClassName("subitem");
        // Subopes Login
        var options_login = login_exp_menu[0].getElementsByClassName("subcontent");

        // Abrir submenu de acordo com a opo selecionada
        for(i = 0; i< btn_options_login.length;i++){
            if (options_login[i].getElementsByClassName("bs-option-sub-item").length == 0) {
                btn_options_login[i].classList.add("bs-option-title-nosubitems");
            }

            btn_options_login[i].id = "btn-login-"+i;
            options_login[i].id = "submenu-login-"+i;

            btn_options_login[i].addEventListener('click', function(event) {
                // Verificar o tipo de dispositivo est acessando
                var isMobile = document.getElementsByClassName("header-mobile");

                if (isMobile.length == 0) { // Desktop
                    // Pegar o subitem referente ao boto de acordo com o ID do mesmo
                    var subitem_position = this.id.replace( /^\D+/g, '');

                    // Fechar os submenus que esto abertos e desmarcar as opes de login selecionadas
                    for(i = 0; i< options_login.length;i++){
                        options_login[i].classList.remove("open");
                    }
                    for(i = 0; i< btn_options_login.length;i++){
                        btn_options_login[i].classList.remove("open");
                    }

                    // Abrir o submenu selecionado e marcar a subopo selecionada
                    options_login[subitem_position].classList.add("open");
                    this.classList.add("open");

                } else { //Mobile
                    // Pegar o subitem referente ao boto de acordo com o ID do mesmo
                    var subitem_position = this.id.replace( /^\D+/g, '');

                    // Varificar se o submenu est selecionado ou no e abrir/fechar a subopo
                    if ((" " + this.className + " ").replace(/[\n\t]/g, " ").indexOf(" open ") > -1) {
                        // Exibir as subopes no selecionadas
                        for(i = 0; i< btn_options_login.length;i++){
                            btn_options_login[i].classList.remove("hide");
                        }

                        // Abrir o submenu selecionado e marcar a subopo selecionada
                        options_login[subitem_position].classList.remove("open");
                        this.classList.remove("open");
                    } else {
                        // Ocultar as subopes no selecionadas
                        for(i = 0; i< btn_options_login.length;i++){
                            btn_options_login[i].classList.add("hide");
                        }

                        // Abrir o submenu selecionado e marcar a subopo selecionada
                        options_login[subitem_position].classList.add("open");
                        this.classList.add("open");
                    }
                }
            })

            btn_options_login[i].addEventListener('keyup', function(e) {
                var keyPressed = e.keyCode;

                // Pegar o subitem referente ao boto de acordo com o ID do mesmo
                var subitem_position = this.id.replace( /^\D+/g, '');

                switch (keyPressed) {
                    // Seta para direita
                    case 13:
                        // Focar no primeiro item do submenu (Acessibilidade)
                        options_login[subitem_position].getElementsByClassName("bs-option-sub-item")[0].focus();
                        break;

                    // Seta para direita
                    case 39:
                        // Focar no primeiro item do submenu (Acessibilidade)
                        options_login[subitem_position].getElementsByClassName("bs-option-sub-item")[0].focus();
                        break;

                    default:
                        break;
                }
            })
        }

        // Atribuir classes ordenadas para cada link (Acessibilidade)
        for(i = 0; i< options_login.length;i++){
            var submenuLinks = options_login[i].getElementsByClassName("bs-option-sub-item");
            for(j = 0; j< submenuLinks.length;j++){
                submenuLinks[j].classList.add("item-"+j);
            }
        }
    }

    var topMenuMobile = function(header) {
        var top_menu = header[0].getElementsByClassName("bs-header__top-menu")[0];
        var top_menu_option = top_menu.getElementsByClassName("bs-top-menu__option");
        var top_menu_mobile = header[0].getElementsByClassName("bs-header__menu-superior");

        // Clonar as opes do menu superior
        var top_menu_clone = top_menu.cloneNode(true);
        top_menu_mobile[0].appendChild(top_menu_clone);

        // Pegar as opes clonadas no menu mobile e atribuir suas funcionalidades
        top_menu_option = top_menu_mobile[0].getElementsByClassName("bs-top-menu__option");

        for(i = 0; i< top_menu_option.length;i++){
            var is_dropdown = top_menu_option[i].getElementsByClassName("bs-top-menu__dropdown");

            if (is_dropdown.length > 0 ){
                var btn_dropdown = is_dropdown[0].parentNode.getElementsByClassName("bs-top-menu__link")[0];

                btn_dropdown.addEventListener('click', function(event) {
                    var dropdown = this.parentNode.getElementsByClassName("bs-top-menu__dropdown")[0];
                    var top_menu_container = document.getElementsByClassName("bs-header__menu-superior")[0];
                    var all_menu_options = top_menu_container.parentNode.getElementsByClassName("bs-main-menu-option");
                    var all_top_menu_options = top_menu_container.parentNode.getElementsByClassName("bs-top-menu__option");
                    var options_acessibility = top_menu_container.parentNode.getElementsByClassName("bs-container-acessibility__mobile")[0];

                    if ((" " + dropdown.className + " ").replace(/[\n\t]/g, " ").indexOf(" open ") > -1) {
                        // Exibe todas as opes do menu e as opes de acessibilidade
                        for(i = 0; i< all_menu_options.length;i++){
                            all_menu_options[i].classList.remove("hide");
                        }
                        for(i = 0; i< all_top_menu_options.length;i++){
                            all_top_menu_options[i].classList.remove("hide");
                        }
                        options_acessibility.classList.remove("hide");

                        // Fecha opes dropdown
                        this.parentNode.classList.remove("open");
                        dropdown.classList.remove("open");
                    } else {
                        // Oculta todas as opes do menu e as opes de acessibilidade
                        for(i = 0; i< all_menu_options.length;i++){
                            all_menu_options[i].classList.add("hide");
                        }
                        for(i = 0; i< all_top_menu_options.length;i++){
                            all_top_menu_options[i].classList.add("hide");
                        }
                        options_acessibility.classList.add("hide");

                        // Abre opes dropdown
                        this.parentNode.classList.add("open");
                        dropdown.classList.add("open");
                    }
                })
            }
        }
    }

    // Funo responsvel por fechar todos os menus que estiverem abertos
    var closeAllMenus = function(header) {
        var opened_menus = header[0].getElementsByClassName("open");
        var selected_options = header[0].getElementsByClassName("is-open");

        for(i = 0; i< opened_menus.length;i++){
            opened_menus[i].classList.remove("open");
        }
        for(i = 0; i< selected_options.length;i++){
            selected_options[i].classList.remove("is-open");
        }
    }

    // Funo responsvel por fechar todos os submenus que estiverem abertos (mobile)
    var closeAllSubMenus = function(header) {
        var btn_submenu = header[0].getElementsByClassName("bs-option-title");

        for(i = 0; i< btn_submenu.length;i++){
            if ((" " + btn_submenu[i].className + " ").replace(/[\n\t]/g, " ").indexOf(" open ") > -1) {
                btn_submenu[i].classList.remove("open");

                var opcoes_submenu = btn_submenu[i].parentNode.parentNode.getElementsByTagName("li");

                for(i = 0; i< opcoes_submenu.length;i++){
                    if ((" " + opcoes_submenu[i].className + " ").replace(/[\n\t]/g, " ").indexOf(" open ") > -1) {
                        opcoes_submenu[i].classList.remove("open");
                    }
                }
            }
        }
    }

    // Funo para atribuir estado atual do header (expandido/no expandido)
    var toggleHeaderExpanded = function(header, action) {
        // var opened_menus = header[0].getElementsByClassName("open");
        if (action == "expand") {
            header[0].classList.add("expanded")
        } else {
            header[0].classList.remove("expanded");
        }
    }

    // Adicionar overlay do header para controlar o click fora da rea do header
    var addHeaderOverlay = function() {
        var overlay = document.createElement('div');
        document.body.classList.add("overlay-on");

        overlay.classList.add("header-overlay");
        document.body.appendChild(overlay);

        // Atribui a altura do overlay apra ser a mesma do documento
        overlay.setAttribute("style", "height: " + document.body.scrollHeight + "px");

        overlay.addEventListener('click', function (event) {
            removeHeaderOverlay();
        })
    }

    // Remove o overlay do header e reabilita o scroll
    var removeHeaderOverlay = function() {
        var header = document.getElementsByClassName("bs-header");
        var overlay = document.getElementsByClassName("header-overlay");

        document.body.classList.remove("overlay-on");

        for (i = 0; i < overlay.length; i++) {
            overlay[i].parentNode.removeChild(overlay[i]);
        }

        // Fecha todas as opes abertas
        closeAllMenus(header);

        // Remove o estato expansido do header
        toggleHeaderExpanded(header);
    }

    var scrollHeaderCtrl = function() {
        // Get window position
        var lastScrollTop = window.pageYOffset;
        var headerTopPosition;

        if (window.innerWidth < 992) {
            header[0].setAttribute("style", "position: fixed; top: 0");
            document.body.setAttribute("style", "margin-top: 128px");
        }

        window.addEventListener("scroll", function(){
            var logoMobile = document.querySelector('.bs-header__logo .bs-logo');
            let header_mobile = document.querySelectorAll('.header-mobile')[0];
            let headerStatus = -1;

            if (header_mobile != undefined) {
              headerStatus = (" " + header_mobile.className + " ").replace(/[\n\t]/g, " ").indexOf(" expanded ");
            }

            // Check if device is under 992px width
            // Get initial header position
            if (headerTopPosition == null) {
                headerTopPosition = header[0].offsetTop;
            }

            if (window.innerWidth < 992) {
                var currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
                var body = document.body,
                    html = document.documentElement;

                var totalScrollHeight = Math.max( body.scrollHeight, body.offsetHeight, 
                                    html.clientHeight, html.scrollHeight, html.offsetHeight );

                totalScrollHeight = totalScrollHeight - window.innerHeight - 128

                // If is scrolling down and header not expanded
                if (currentScrollTop > lastScrollTop && currentScrollTop < totalScrollHeight && headerStatus == -1 ){
                    header[0].setAttribute("style", "position: fixed; top: -140px");
                    this.document.body.setAttribute("style", "margin-top: 96px");
                // Else scrolling up
                } else {
                    // If current scroll position is greater than initial header position, fix to top
                    if (headerTopPosition < pageYOffset) {
                        header[0].setAttribute("style", "position: fixed; top: 0");
                        this.document.body.setAttribute("style", "margin-top: 126px");
                    } else {
                        header[0].setAttribute("style", "position: fixed; top: 0");
                        this.document.body.setAttribute("style", "margin-top: 128px");
                    }
                }
                lastScrollTop = currentScrollTop <= 0 ? 0 : currentScrollTop;
            } else {
                header[0].setAttribute("style", "position: fixed; top: 0");
                this.document.body.setAttribute("style", "margin-top: 120px");
            }
        }, false);
    }

    // Funo para verificar se o dispositivo  Desktop ou Mobile
    var chkDevice = function(header) {
        if (window.outerWidth > 991) {
            header[0].classList.remove("header-mobile");
        } else {
            header[0].classList.add("header-mobile");
        }
    }

    // ### Inicio tratamento do espaamento dos filhos do menu

    // Funo para contar elementos filhos do menu
    function contar(el) {
        return document.querySelectorAll(el).length;
    }

    // Funo que remove a classe ".bs-space-elements"
    function removeElem(){
        [].forEach.call(elemDel, function (el) {
            el.className = el.className.replace(/\bbs-space-elements\b/, "");
        });
    }

    // Funo que adiciona a classe ".bs-space-elements"
    function addElem(){
        [].forEach.call(elemAdd, function (el) {
            el.className = el.className.replace(/\bbs-header__exp-content--main-menu\b/, "bs-header__exp-content--main-menu bs-space-elements");
        });
    }

    var qtd = contar('.bs-main-menu-option');
    var elemDel = document.querySelectorAll(".bs-header__exp-content--main-menu.bs-space-elements");
    var elemAdd = document.querySelectorAll(".bs-header__exp-content--main-menu");

    // Se houver menos que 3 filhos, executa a remoo da classe ".bs-space-elements" e ativa o flex-start
    if (qtd < 3) {
            removeElem();
        } else {
            addElem();
    }

    // ### Fim tratamento do espaamento dos filhos do menu


    // Funo para verificar o tipo do browser
    var chkBrowser = function() {
        var isOpera = (!!window.opr && !!opr.addons) || !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0; // Opera 8.0+
        var isFirefox = typeof InstallTrigger !== 'undefined'; // Firefox 1.0+
        var isSafari = /constructor/i.test(window.HTMLElement) || (function (p) { return p.toString() === "[object SafariRemoteNotification]"; })(!window['safari'] || (typeof safari !== 'undefined' && safari.pushNotification)); // Safari 3.0+ "[object HTMLElementConstructor]"
        var isIE = /*@cc_on!@*/false || !!document.documentMode; // Internet Explorer 6-11
        if (isIE) {
            document.body.classList.add("is-ie");
        }
        var isEdge = !isIE && !!window.StyleMedia; // Edge 20+
        var isChrome = !!window.chrome && (!!window.chrome.webstore || !!window.chrome.runtime); // Chrome 1 - 79
        var isEdgeChromium = isChrome && (navigator.userAgent.indexOf("Edg") != -1); // Edge (based on chromium) detection
        var isBlink = (isChrome || isOpera) && !!window.CSS; // Blink engine detection
    }

    return {
        init: init,
        loginDefaultInit: loginDefaultInit,
        loginBehaviour: loginBehaviour,
        closeAllMenus: closeAllMenus,
        toggleHeaderExpanded: toggleHeaderExpanded,
        removeHeaderOverlay: removeHeaderOverlay,
        chkDevice: chkDevice,
        chkBrowser: chkBrowser
    };

  }());

  window.addEventListener("resize", function(){
    if (document.querySelectorAll('.bs-refactor').length) {
        if (document.querySelectorAll('.bs-header').length) {
            var header = document.getElementsByClassName("bs-header");

            BSHeaderNew.chkDevice(header);

            // Correo IN5634292
            if ((" " + document.activeElement.className + " ").indexOf("bs-form__field") < -1) {
                BSHeaderNew.removeHeaderOverlay();
                BSHeaderNew.closeAllMenus(header);
            }
        }
    }
  });

  /**
  * Init New Header Constructor
  * @return {void} BSHeaderNew.init();
  */
  document.addEventListener('DOMContentLoaded', function () {
    if (document.querySelectorAll('.bs-refactor').length) {
        if (document.querySelectorAll('.bs-header').length) {
            BSHeaderNew.init();
            // BSHeaderNew.chkBrowser();
        }
    }
  });

  // Acessibilidade
  document.addEventListener("keydown", function(e) {
    var keyPressed = e.keyCode;

    // Navegao menu Login
    var loginMenus = document.querySelectorAll('*[id^="btn-login-"]');
    var loginSubMenus = document.querySelectorAll('*[id^="submenu-login-"]');

    // Menu
    if (document.activeElement.id.indexOf("btn-login-") > -1) {

        var currentLoginMenu = document.activeElement.id;
        currentLoginMenu = parseInt(currentLoginMenu.replace(/^\D+/g, ''));

        var currentItemEls = document.activeElement;

        //ltimo item do menu: Prestador de Servios
        var lastItemEls = loginMenus[loginMenus.length - 1];

        //Boto Principal Login
        var btn_login = document.getElementsByClassName("bs-button--login")[0];

        //Item pessoal fsica
        //var firstItemList = document.getElementById("btn-login-" + (currentLoginMenu - 1)).focus();

        switch (keyPressed) {

            // Tab
            case 9:

                //Item Pessoa Fsica
                //document.getElementById("btn-login-" + (currentLoginMenu - 1)).focus();
                //console.log("Numero do item: ", currentLoginMenu);

                e.preventDefault();

                //Navegao TAB por shift
                if (e.shiftKey) {

                  //Se for o item antes do ltimo item
                  if(currentLoginMenu - 1 == -1) {
                    BSHeaderNew.removeHeaderOverlay();
                    btn_login.focus();
                  }else {
                    document.getElementById("btn-login-" + (currentLoginMenu - 1)).focus();
                  }

                }
                //Navegao TAB normal
                else {

                  if (currentLoginMenu + 1 < loginMenus.length) {
                    document.getElementById("btn-login-" + (currentLoginMenu + 1)).focus();

                  }else {
                    BSHeaderNew.removeHeaderOverlay();
                    btn_login.focus();
                  }

                }

                /*
                if (currentLoginMenu + 1 < loginMenus.length) {
                  document.getElementById("btn-login-" + (currentLoginMenu + 1)).focus();

                }else {
                  BSHeaderNew.removeHeaderOverlay();
                  btn_login.focus();
                }

                */

                break;

                // Seta para cima
            case 38:
                if (currentLoginMenu > 0) {
                    document.getElementById("btn-login-" + (currentLoginMenu - 1)).focus();
                } else {
                    document.getElementById("btn-login-" + (loginMenus.length - 1)).focus();
                }
                break;

                // Seta para direita
            case 39:
                document.activeElement.click();
                break;

                // Seta para baixo
            case 40:
                if (currentLoginMenu + 1 < loginMenus.length) {
                    document.getElementById("btn-login-" + (currentLoginMenu + 1)).focus();
                } else {
                    document.getElementById("btn-login-0").click();
                }
                break;

            default:
                break;
        }
    }

    // Submenu
    if ((" " + document.activeElement.className + " ").replace(/[\n\t]/g, " ").indexOf(" bs-option-sub-item ") > -1) {
        if (document.activeElement.parentNode.id.indexOf("submenu-login-") > -1) {

            var btn_login = document.getElementsByClassName("bs-button--login")[0];

            var currentLoginSubmenu = document.activeElement.parentNode.id;
            currentLoginSubmenu = parseInt(currentLoginSubmenu.replace(/^\D+/g, ''));

            var currentLinkSubmenu = document.activeElement.className;
            currentLinkSubmenu = parseInt(currentLinkSubmenu.replace(/^\D+/g, ''));

            var loginSubmenus = document.activeElement.parentNode.getElementsByClassName("bs-option-sub-item");
            var firstFocusableEl = loginSubmenus[0];
            var lastFocusableEl  = loginSubmenus[loginSubmenus.length -1];
            var activeFocusableEl =  document.activeElement;

            switch (keyPressed) {

                // Tab
                case 9:
                  console.log("Numero do item: ", currentLinkSubmenu - 1);

                    e.preventDefault();
                    if (currentLinkSubmenu + 1 < loginSubmenus.length) {
                      document.activeElement.parentNode.getElementsByClassName("item-" + (currentLinkSubmenu + 1))[0].focus();

                      if (e.shiftKey) {

                        if(currentLinkSubmenu - 1 == -1) {
                          var prevMenu =  document.getElementById("btn-login-" + (currentLoginSubmenu));
                          prevMenu.focus();
                        }
                        document.activeElement.parentNode.getElementsByClassName("item-" + (currentLinkSubmenu - 1))[0].focus();
                      }
                    } else {
                      var nextMenu =  document.getElementById("btn-login-" + (currentLoginSubmenu + 1));
                      if (e.shiftKey) {
                        document.activeElement.parentNode.getElementsByClassName("item-" + (currentLinkSubmenu - 1))[0].focus();
                      } else {
                        if (nextMenu != undefined) {
                          nextMenu.focus();
                          document.getElementById("btn-login-" + (currentLoginSubmenu + 1)).click();
                        } else {
                          BSHeaderNew.removeHeaderOverlay();
                          btn_login.focus();
                        }
                      }

                  }
                    break;

                    // Seta para esquerda
                case 37:
                    document.getElementById("btn-login-" + (currentLoginSubmenu)).focus();
                    break;

                    // Seta para cima
                case 38:
                    if (currentLinkSubmenu > 0) {
                        document.activeElement.parentNode.getElementsByClassName("item-" + (currentLinkSubmenu - 1))[0].focus();
                    } else {
                        document.activeElement.parentNode.getElementsByClassName("item-" + (loginSubmenus.length - 1))[0].focus();
                    }
                    break;

                    // Seta para baixo
                case 40:
                    if (currentLinkSubmenu + 1 < loginSubmenus.length) {
                        document.activeElement.parentNode.getElementsByClassName("item-" + (currentLinkSubmenu + 1))[0].focus();
                    } else {
                        var nextMenu =  document.getElementById("btn-login-" + (currentLoginSubmenu + 1));
                        if (nextMenu != undefined) {
                          document.getElementById("btn-login-" + (currentLoginSubmenu + 1)).focus();
                          if (!(document.getElementById("btn-login-" + (currentLoginSubmenu + 1)).classList.contains('bs-option-title-nosubitems'))){
                            document.getElementById("btn-login-" + (currentLoginSubmenu + 1)).click();
                            var nextSub = document.getElementById("submenu-login-" + (currentLoginSubmenu + 1)).childNodes[1];
                            nextSub.focus();
                          }
                        } else {
                          BSHeaderNew.removeHeaderOverlay();
                          btn_login.focus();
                        }
                    }
                    break;
                default:
                    break;
            }
        }
    }

  });


var IconMediaRefactored = (function () {

  var init = function () {

    var box = document.querySelectorAll('.bs-media__item--none .bs-media__box--content');

    for(var i = 0; i < box.length; i++) {
      var item = box[i];

      item.addEventListener('click', function(event) {
        event.stopPropagation()
        this.querySelector('.bs-button-link').click();
      })

      //Acessando Link via tab
      item.addEventListener('keyup', function(event) {

          if (event.keyCode === 13 || event.key === "Enter") {
            this.querySelector('.bs-button-link').click();
          }

      })


    }
  };

  return {
    init: init,
  };
}());

/**
 * Init Modal Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.icon-media-ref').length) {
    IconMediaRefactored.init();
  }
});

// // Inicia modal de configurao dos cookies
// function configurarCookie() {
//   var btnConfigurar = document.querySelector('.js-configurar');

//   btnConfigurar.addEventListener('click', function (e) {
//     abreModal("js-modal");
//   })
// }

// Variaveis globais
var ctaCookie = document.querySelector(".js-cookie");
var nomeClasse, arr;

// Funo para gravar cookie
function aceitarCookie() {
  var btnAceitar = document.querySelector(".js-aceitar");

  nomeClasse = "is-hidden";
  nomeClasseHide = "is-visible";
  arr = ctaCookie.className.split(" ");

  // Verifica se h o nome do cookie se, existir ele no ser exibido no proximo acesso no periodo de 12 meses
  if (!Cookies.get('lgpd')) {
    // adiciona classe is-hidden (compativel com todos navegadores)
    ctaCookie.className += " " + nomeClasseHide;
} else {
    ctaCookie.className += " " + nomeClasse;
  }

  btnAceitar.addEventListener('click', function () {
    // Definio do Cookie - chave , valor e expires (data de expirao)
    Cookies.set('lgpd', true, {
      expires: 365
    })

    if (!arr.indexOf(nomeClasse) == -1) {
      ctaCookie.className += " " + nomeClasseHide;
    } else {
        console.log('testre');
      ctaCookie.className += " " + nomeClasse;
        var els = document.querySelectorAll('.cookies.js-cookie.is-visible')
        function removeElem() {
            for (var i = 0; i < els.length; i++) {
                els[i].classList.remove('is-visible')
            }
        }
        removeElem();
    }
  });

};

// Funo apenas para fechar o elemnto cookies completo
function fecharCookie() {
  var btnFechar = document.querySelector('.js-fechar');

  nomeClasse = "is-hidden";
  arr = ctaCookie.className.split(" ");

  btnFechar.addEventListener("click", function () {

    if (!arr.indexOf(nomeClasse) == -1) {
      ctaCookie.className += " " + nomeClasseHide;
    } else {
      ctaCookie.className += " " + nomeClasse;
      var els = document.querySelectorAll('.cookies.js-cookie.is-visible')

      function removeElem() {
        for (var i = 0; i < els.length; i++) {
          els[i].classList.remove('is-visible')
        }
      }
      removeElem();
    }
  });
};

// Defini cookie nome, valor e dias
function definirCookie(nome, valor, dias) {
  var hoje = new Date();
  hoje.setTime(hoje.getTime() + (dias * 24 * 60 * 60 * 1000));
  var expira = "expires=" + hoje.toGMTString();
  document.cookie = nome + "=" + valor + ";" + expira + ";path=/";
};

// Obtem o valor do cookie
function obterCookie(cnome) {

  var nome = cnome + "=";
  var ca = document.cookie.split(';');
  for (var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(nome) == 0) {
      return c = c.substring(nome.length, c.length);
    }
  }
  return " ";
};

// Iniciliza todas as funes
function init() {
    if (document.querySelectorAll('.js-cookie').length) {
        fecharCookie();
        aceitarCookie();
        // configurarCookie();
        }
};

document.addEventListener('DOMContentLoaded', init);

/**
 * BsListAccordion
 */
var BsListAccordion = (function () {
  var config = {};

  var setConfig = function (options) {
    var defaults = {
      list: '.bs-js-list-accordion',
      item: '.bs-js-list-accordion__item',
      toggleButton: '.bs-js-list-accordion__toggle',
      itemExpandedClass: 'bs-is-expanded',
    };

    if (typeof options !== 'object') options = {};
    return extend({}, defaults, options);
  };

  var init = function (options) {
    var listAccordion;

    config = setConfig(options);
    listAccordion = document.querySelectorAll(config.list);

    if (!listAccordion.length) return;

    Array.prototype.forEach.call(listAccordion, function (list) {
      var items = list.querySelectorAll(config.item);

      Array.prototype.forEach.call(items, function (item) {
        var button = item.querySelector(config.toggleButton);

        if (button) {
          button.addEventListener('click', function () {
            toggleItem(item);
          });
        }
      });
    });
  };

  var extend = function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  var expandItem = function (item) {
    item.classList.add(config.itemExpandedClass);
  };

  var collapseItem = function (item) {
    item.classList.remove(config.itemExpandedClass);
  };

  var toggleItem = function (item) {
    if (itemIsExpanded(item)) collapseItem(item);
    else expandItem(item);
  };

  var itemIsExpanded = function (item) {
    return item.classList.contains(config.itemExpandedClass);
  };

  return {
    init: init,
    expand: expandItem,
    collapse: collapseItem,
    toggle: toggleItem,
  };
}());

/**
 * Init ListAccordion constructor
 * @return {void} ListAccordion.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-list-description--accordion').length) {
    BsListAccordion.init({
      item: '.bs-list-description__item',
      toggleButton: '.bs-list-description__title',
    });
  }
});

var BsDownloadsList = function (element, options) {
  // Config List and Select
  var elem = element;
  var config = {};
  var setConfig = function (el) {
    return {
      el: el,
      body: document.querySelector('body'),
      items: el.querySelectorAll('.bs-download__item'),
      itemsInput: el.querySelectorAll('.bs-js-downloads-input'),
      groupInput: el.querySelectorAll('.bs-js-downloads-select-all'),
      filterForm: el.querySelector('.bs-js-downloads-filter'),
      filterInputs: el.querySelectorAll('.bs-js-downloads-filter .bs-form__field'),
      categories: el.querySelectorAll('.bs-download__list'),
      accordionButton: el.querySelectorAll('.bs-js-open-accordion'),
      accordion: el.querySelectorAll('.bs-download__content--accordion'),
      accordionList: el.querySelectorAll('.bs-download__list'),
      downloadButton: el.querySelector('.bs-js-downloads-button'),
      accordionContentClass: 'bs-js-download__content--accordion',
      multiDownloadFormClass: 'bs-js-download-multi-form',
      hasAccordionClass: 'bs-download--accordion',
      itemActiveClass: 'bs-download__item--active',
      categoryActiveClass: 'bs-download__list--active',
      accordionOpenClass: 'bs-download__list--open',
      accordionResizer: null,
      lastInputChecked: null,
      zipOnClient: true,
      zipFileId: null,
      downloadProgress: new BsSnackProgress(),
      downloadIsActive: false,
      keyMap: {},
    };
  };

  var init = function () {
    if (!elem || typeof elem !== 'object') return;
    config = setConfig(elem);

    // If element allow multi download
    if (hasMultiDownload()) {
      // prevent form submit
      elem.addEventListener('submit', function (ev) {
        ev.preventDefault();
        addDownloadListener();
      });

      // Init download progress
      config.downloadProgress.init();
      config.downloadProgress.elements.progress.id = elem.id + '-progress';
      config.downloadProgress.onCancel(abortdownload);
    }

    // handle keyboard
    if (hasAccordion()) config.el.addEventListener('keydown', handleAccordionKeyboard);

    // handle keyboard
    if (hasMultiDownload()) {
      config.el.addEventListener('keydown', handleMultiDownloadKeyboard);
      config.el.addEventListener('keyup', function (ev) {
        config.keyMap[ev.key] = false;
      });
    }

    if (hasMultiDownload() && config.downloadButton) {
      if (config.downloadButton.type !== 'submit') {
        config.downloadButton.addEventListener('click', addDownloadListener);
      }
    }

    // Add event for filters
    Array.prototype.forEach.call(config.filterInputs, function (input) {
      if (input) {
        if (input.name === 'year') buildYearSelect(input);
        input.addEventListener('change', function (event) {
          handleFilters(event.target);
          setTimeout(function () {
            uncheckAllItems(getInactiveItems());
            openAllAccordions();
            adjustAccordionItemsHeight();
          }, 300);
        });
      }
    });

    // Toggle accordion item on click
    Array.prototype.forEach.call(config.accordionButton, function (el) {
      el.addEventListener(
        'click',
        toggleAccordionItem.bind(null, el)
      );
    });

    // Check if there's an accordion item active and adjust its height
    if (hasAccordion()) {
      Array.prototype.forEach.call(config.accordionList, function (el) {
        var accOpen = el.classList.contains(config.accordionOpenClass);

        if (accOpen) {
          var content = el.querySelector('.' + config.accordionContentClass);
          var contentHeight = content.scrollHeight;
          el.classList.add(config.accordionOpenClass);
          content.style.height = contentHeight + 'px';
        }
      });
    }

    // Add event for all checkboxes
    if (config.itemsInput && config.itemsInput.length) {
      Array.prototype.forEach.call(config.itemsInput, function (input) {
        input.addEventListener('click', handleItemsCheckbox);
      });
    }

    if (config.groupInput) {
      Array.prototype.forEach.call(config.groupInput, function (input) {
        input.addEventListener('click', handleSelectAllCheckbox);
      });
    }

    window.addEventListener('resize', function () {
      clearTimeout(config.accordionResizer);
      config.accordionResizer = setTimeout(function () {
        adjustAccordionItemsHeight();
      }, 300);
    });
  };

  // --------------------------------
  // Accordion
  // --------------------------------

  /**
   * Has Accordion Class
   * @return {[type]} [description]
   */
  var hasAccordion = function () {
    return config.el.classList.contains(config.hasAccordionClass)
      || (config.accordionButton && config.accordionButton.length);
  };

  /**
   * Check if accordion item's expanded
   * @param  {object}  el  an HTML element of the accordion item
   * @return {boolean}     true if accordion item is open
   */
  var isAccordionOpen = function (el) {
    var item = getParent(el, 'bs-download__list');
    // var item2 = closest(el, '.bs-download__list');
    // debugger;
    return item.classList.contains(config.accordionOpenClass);
  };

  /**
   * toggle Accordion Item
   * @param  {object} el HTML element of the accordion item
   * @return {void}
   */
  var toggleAccordionItem = function (el) {
    if (isAccordionOpen(el)) closeAccordionItem(el);
    else openAccordionItem(el);
  };

  /**
   * open Accordion Item
   * @param  {object} el HTML element of the accordion item
   * @return {void}
   */
  var openAccordionItem = function (el) {
    var item = getParent(el, 'bs-download__list');
    var content = item.querySelector('.' + config.accordionContentClass);
    var contentHeight = content.scrollHeight;

    el.setAttribute('aria-expanded', 'true');
    item.classList.add(config.accordionOpenClass);
    content.style.height = contentHeight + 'px';
  };

  /**
   * close Accordion Item
   * @param  {object} el HTML element of the accordion item
   * @return {void}
   */
  var closeAccordionItem = function (el) {
    var item = getParent(el, 'bs-download__list');
    var content = item.querySelector('.' + config.accordionContentClass);

    el.setAttribute('aria-expanded', 'false');
    item.classList.remove(config.accordionOpenClass);
    content.style.height = 0;
  };

  var openAllAccordions = function () {
    if (config.accordionButton && config.accordionButton.length) {
      Array.prototype.forEach.call(config.accordionButton, function (el) {
        openAccordionItem(el);
      });
    }
  };

  var closeAllAccordions = function () {
    if (config.accordionButton && config.accordionButton.length) {
      Array.prototype.forEach.call(config.accordionButton, function (el) {
        closeAccordionItem(el);
      });
    }
  };

  var handleAccordionKeyboard = function (ev) {
    var currentEl = ev.target;
    var key = ev.key;
    var buttons = Array.prototype.slice.call(config.accordionButton);
    var isButtonFocused = currentEl.classList.contains('bs-js-open-accordion');
    var currentButton = (isButtonFocused) ? currentEl : currentEl.closest('.bs-js-open-accordion');
    var firstButton = buttons[0];
    var lastButton = buttons[buttons.length - 1];
    var prevButton = buttons.indexOf(currentButton)
      ? buttons[buttons.indexOf(currentButton) - 1]
      : lastButton;
    var nextButton = buttons.indexOf(currentButton) < buttons.length - 1
      ? buttons[buttons.indexOf(currentButton) + 1]
      : firstButton;
    var currentPanel;
    var prevPanel;
    var prevButton;
    var firstCheckbox;
    var prevPanelCheckboxes;
    var allCheckboxes;
    var lastCheckbox;

    if (isButtonFocused) {
      allCheckboxes = config.el.querySelectorAll('.bs-js-downloads-input, .bs-js-downloads-select-all');
      lastCheckbox = allCheckboxes && allCheckboxes.length && allCheckboxes[allCheckboxes.length - 1];
      currentPanel = currentButton.closest('.bs-download__list');
      prevPanel = currentPanel.previousElementSibling;
      prevButton = prevPanel && prevPanel.querySelector('.bs-js-open-accordion');
      firstCheckbox = currentPanel.querySelector('.bs-js-downloads-input, .bs-js-downloads-select-all');
      prevPanelCheckboxes = prevPanel && prevPanel.querySelectorAll('.bs-js-downloads-input, .bs-js-downloads-select-all');
      prevPanelLastCheckbox = prevPanelCheckboxes
        && prevPanelCheckboxes.length
        && prevPanelCheckboxes[prevPanelCheckboxes.length - 1]

      switch (key) {
        case 'ArrowRight':
        case 'Right': // ie
          if (!isAccordionOpen(currentButton)) {
            openAccordionItem(currentButton);
          } else if (firstCheckbox) {
            firstCheckbox.focus();
          }
          ev.preventDefault();
          break;
        case 'ArrowLeft':
        case 'Left': // ie
          if (isAccordionOpen(currentButton)) {
            closeAccordionItem(currentButton);
          } else {
            // firstCheckbox.focus();
          }
          ev.preventDefault();
          break;
        case 'ArrowDown':
        case 'Down': // ie
          if (!isAccordionOpen(currentButton)) {
            nextButton.focus();
          } else if (firstCheckbox) {
            firstCheckbox.focus();
          } else {
            nextButton.focus();
          }
          ev.preventDefault();
          break;
        case 'ArrowUp':
        case 'Up': // ie
          if (prevButton && isAccordionOpen(prevButton) && prevPanelLastCheckbox) {
            prevPanelLastCheckbox.focus();
          } else if (prevButton) {
            prevButton.focus();
          } else if (lastCheckbox && isAccordionOpen(lastCheckbox)) {
            lastCheckbox.focus();
          } else {
            lastButton.focus();
          }
          ev.preventDefault();
          break;
        case 'Home':
          firstButton.focus();
          ev.preventDefault();
          break;
        case 'End':
          lastButton.focus();
          ev.preventDefault();
          break;
        default:
      }
    }
  };

  var handleMultiDownloadKeyboard = function (ev) {
    var currentEl = ev.target;
    var key = ev.key;
    var checkboxesNode = config.el.querySelectorAll('.bs-js-downloads-input, .bs-js-downloads-select-all');
    var checkboxes = Array.prototype.slice.call(checkboxesNode);
    var currentCheckbox = (
      currentEl.classList.contains('bs-js-downloads-input')
      || currentEl.classList.contains('bs-js-downloads-select-all'))
      ? currentEl
      : null; // currentEl.closest('.bs-js-open-accordion');
    var firstCheckbox = checkboxes[0];
    var lastCheckbox = checkboxes[checkboxes.length - 1];
    var prevCheckbox = checkboxes.indexOf(currentCheckbox)
      ? checkboxes[checkboxes.indexOf(currentCheckbox) - 1]
      : lastCheckbox;
    var nextCheckbox = checkboxes.indexOf(currentCheckbox) < checkboxes.length - 1
      ? checkboxes[checkboxes.indexOf(currentCheckbox) + 1]
      : firstCheckbox;
    var firstButton = config.el.querySelector('.bs-js-open-accordion');
    var currentPanel;
    var nextPanel;
    var currentButton;
    var nextButton;
    var panelCheckboxes;
    var prevPanel;
    var prevPanelCheckboxes;
    var prevPanelLastCheckbox;
    var activeCheckboxes = getActiveItems();
    var isAllChecked = activeCheckboxes && activeCheckboxes.every(function (checkItem) {
      return checkItem.checked;
    });
    var allAccordions;
    var firstAccordion;

    config.keyMap[key] = true;

    if (currentCheckbox) {
      allAccordions = config.el.querySelectorAll('.bs-js-open-accordion');
      firstAccordion = allAccordions && allAccordions.length && allAccordions[0];
      currentPanel = currentCheckbox.closest('.bs-download__list');
      nextPanel = currentPanel.nextElementSibling;
      prevPanel = currentPanel.previousElementSibling;
      currentButton = currentPanel && currentPanel.querySelector('.bs-js-open-accordion');
      nextButton = nextPanel && nextPanel.querySelector('.bs-js-open-accordion');
      panelCheckboxes = currentPanel.querySelectorAll('.bs-js-downloads-input, .bs-js-downloads-select-all');
      prevPanelCheckboxes = prevPanel && prevPanel.querySelectorAll('.bs-js-downloads-input, .bs-js-downloads-select-all');
      prevPanelLastCheckbox = prevPanelCheckboxes
        && prevPanelCheckboxes.length
        && prevPanelCheckboxes[prevPanelCheckboxes.length - 1]

      switch (key) {
        case 'ArrowRight':
        case 'Right':
          break;
        case 'ArrowLeft':
        case 'Left':
          if (currentButton) {
            currentButton.focus();
          }
          ev.preventDefault();
          break;
        case 'ArrowDown':
        case 'Down':
          if (panelCheckboxes[panelCheckboxes.length - 1] === currentCheckbox && nextButton) {
            nextButton.focus();
          } else if (currentCheckbox === lastCheckbox && nextButton) {
            firstButton.focus();
          } else if (currentCheckbox === lastCheckbox && firstAccordion) {
            firstAccordion.focus();
          } else if (currentCheckbox === lastCheckbox) {
            firstCheckbox.focus();
          } else {
            nextCheckbox.focus();
          }
          ev.preventDefault();
          break;
        case 'ArrowUp':
        case 'Up':
          if (panelCheckboxes[0] === currentCheckbox && currentButton) {
            currentButton.focus();
          } else if (panelCheckboxes[0] === currentCheckbox && prevPanelLastCheckbox) {
            prevPanelLastCheckbox.focus();
          } else if (panelCheckboxes[0] === currentCheckbox) {
            lastCheckbox.focus();
          } else {
            prevCheckbox.focus();
          }
          ev.preventDefault();
          break;
        case 'Home':
          ev.preventDefault();
          firstCheckbox.focus();
          break;
        case 'End':
          ev.preventDefault();
          lastCheckbox.focus();
          break;
        case 'Escape':
          abortdownload();
          ev.preventDefault();
          break;
        case 'a':
          if (config.keyMap.Control) {
            if (isAllChecked) {
              uncheckAllItems();
            } else {
              checkAllItems();
              openAllAccordions();
            }
          }
          ev.preventDefault();
          break;
        default:
      }
    }
  };

  /**
   * Adjust Height of all Accordion Items
   * When items are filtered or the viewport changes, the height of each
   * accordion item must be adjusted according to its content height
   *
   * @return {void}
   */
  var adjustAccordionItemsHeight = function () {
    var activeItems = Array.prototype.filter.call(config.accordionList, function (panel) {
      return panel.classList.contains(config.accordionOpenClass)
        && panel.classList.contains(config.categoryActiveClass);
    });

    if (hasAccordion() && activeItems.length) {
      Array.prototype.forEach.call(activeItems, function (item) {
        var itemChildren = item.querySelectorAll('.bs-download__item');
        var content = item.querySelector('.' + config.accordionContentClass);
        // sum of each children height
        var childrenHeight = Array.prototype.reduce.call(itemChildren, function (total, subitem) {
          total += subitem.scrollHeight;
          return total;
        }, 0);
        // update accordion item height
        content.style.height = childrenHeight + 'px';
      });
    }
  };

  // --------------------------------
  // Downloads of multiple items
  // --------------------------------

  /**
   * Has Multiple Download
   * @return {Boolean} true if download has multiDownload options
   */
  var hasMultiDownload = function () {
    return config.el.classList.contains(config.multiDownloadFormClass)
      || (config.itemsInput && config.itemsInput.length);
  };

  /**
   * Update active checkbox list
   * @param  {object}  event  a change event
   * @return {void}
   */
  var handleSelectedItems = function () {
    var selectedInputs = null;
    var progressText = function (itemsAmount) {
      var text = '';
      text += itemsAmount + ' arquivo' + (itemsAmount > 1 ? 's ' : '');
      text += ' selecionado' + (itemsAmount > 1 ? 's' : '');
      return text;
    };

    // enable/disable download button
    toggleDownloadButton();

    // get the updated list of checked
    selectedInputs = getCheckedItems();

    // if has a snackbar
    if (config.downloadProgress) {
      // if there are checked items, show snackbar
      if (selectedInputs.length) {
        config.downloadProgress.show();
        config.downloadProgress.setProgress('', progressText(selectedInputs.length));
        config.downloadProgress.activeButton('icon-nav-baixar', 'Fazer download', addDownloadListener);
      // if there all items are unchecked, hide snackbar
      } else {
        config.downloadProgress.hide();
        config.downloadProgress.disableButton();
      }
    }
  };

  /**
   * handle Items Checkbox
   * @param  {object}  event  a change event
   * @return {void}
   */
  var handleItemsCheckbox = function (event) {
    // handle shift-select multiple items
    shiftSelectMultipleItems(event);
    // toggle active item style
    toggleItemCheckbox(event.target);
    // handle list of selected items
    handleSelectedItems();
    //
    handleSelectAllByChildChange(event.target);
  };

  /**
   * handle Items Checkbox
   * @param  {object}  event  a change event
   * @return {void}
   */
  var handleSelectAllCheckbox = function (event) {
    var inputEl = event.target;
    var groupEl = inputEl.closest('.bs-download__group');
    var childInputs;

    // return if event is not related to a group
    if (!groupEl) return;

    // get the child inputs of the current group
    childInputs = groupEl.querySelectorAll('.bs-js-downloads-input');

    // if the event is from selectAll checkbox
    if (inputEl.classList.contains('bs-js-downloads-select-all')) {
      // if group have children
      if (childInputs && childInputs.length) {
        // handle shift-select multiple items
        if (event) shiftSelectMultipleItems(event, childInputs[0]);

        // toggle each child based in selectAllInput status
        Array.prototype.forEach.call(childInputs, function (input) {
          if (inputEl.checked) {
            toggleItemCheckbox(input, true);
          } else {
            toggleItemCheckbox(input, false);
          }
        });

        // handle list of selected items
        handleSelectedItems();
      }
    }
  };

  // if the event is from a specific download checkbox
  var handleSelectAllByChildChange = function (input) {
    var groupEl = input.closest('.bs-download__group');
    var allInputsChecked = false;
    var childInputs;
    var selectAllInput;

    // return if event is not related to a group
    if (!groupEl) return;

    // get the selectAll input of the current group
    selectAllInput = groupEl.querySelector('.bs-js-downloads-select-all');

    // get the child inputs of the current group
    childInputs = groupEl.querySelectorAll('.bs-js-downloads-input');

    // check if every child is checked or not
    allInputsChecked = Array.prototype.every.call(childInputs, function (input) {
      return input.checked;
    });

    // check selectAllInput if all childs is checked
    if (allInputsChecked) {
      selectAllInput.checked = true;
    // uncheck selectAllInput if any childs is unchecked
    } else {
      selectAllInput.checked = false;
    }
  }

  var addDownloadListener = function () {
    var filename = config.downloadButton.dataset.zipFilename;
    generateZipFile(filename);
  };

  var abortdownload = function () {
    // Reset progress
    config.downloadProgress.elements.progress.classList.remove('bs-progress--is-loading');
    config.downloadProgress.setProgress();
    config.downloadProgress.hide();

    // Disable download button and uncheck items
    uncheckAllItems();

    // Abort if on downloading or zipping process
    config.downloadIsActive = false;

    return false;
  };

  /**
   * get checked items
   * @return {array} list of checked inputs
   */
  var getCheckedItems = function () {
    return config.el.querySelectorAll('.bs-js-downloads-input:checked');
  };

  var isActiveItem = function (item) {
    var panelActive = item.closest('.bs-download__list').classList.contains(config.categoryActiveClass);
    var itemContainer = item.closest('.bs-download__item');
    return panelActive && itemContainer.style.display !== 'none';
  }

  var getActiveItems = function (items) {
    return Array.prototype.filter.call(items || config.itemsInput, function (item) {
      return isActiveItem(item);
    });
  };

  var getInactiveItems = function (items) {
    return Array.prototype.filter.call(items || config.itemsInput, function (item) {
      return !isActiveItem(item);
    });
  };

  /**
   * Check all items
   */
  var checkAllItems = function (items) {
    Array.prototype.forEach.call(items || config.itemsInput, function (el) {
      var panel = el.closest('.bs-download__list');

      if (hasAccordion() && !panel.classList.contains(config.categoryActiveClass)) return;
      if (!isActiveItem(el)) return;

      toggleItemCheckbox(el, true);
      handleSelectAllByChildChange(el);
    });
    handleSelectedItems();
  };

  /**
   * Uncheck all items
   */
  var uncheckAllItems = function (items) {
    Array.prototype.forEach.call(items || config.itemsInput, function (el) {
      toggleItemCheckbox(el, false);
      handleSelectAllByChildChange(el);
    });

    if (config.groupInput) {
      Array.prototype.forEach.call(config.groupInput, function (input) {
        input.checked = false;
      });
    }

    handleSelectedItems();
  };

  /**
   * toggle Item Checkbox
   * @param  {object}  checkbox  the HTML element of the checkbox
   * @param  {boolean} check     force check true/false
   * @return {void}
   */
  var toggleItemCheckbox = function (checkbox, check) {
    // Get div parent to apply conditions
    var inputItem = checkbox.closest('.bs-download__item');
    var checked = (typeof check === 'boolean') ? check : checkbox.checked;

    // If checkbox is checked or should be forced to
    if (checked || check) {
      checkbox.checked = true;
      inputItem.classList.add(config.itemActiveClass);
    // If checkbox is unchecked or should be forced to
    } else {
      checkbox.checked = false;
      inputItem.classList.remove(config.itemActiveClass);
    }
  };

  /**
   * toggle Download Button
   * @return {void}
   */
  var toggleDownloadButton = function () {
    var downloadButton = config.downloadButton;
    var downloadButtonTitle = '';
    var hasInputChecked = getCheckedItems().length;

    if (downloadButton) {
      // enable download button if has some input checked
      if (!hasInputChecked) {
        downloadButtonTitle = downloadButton.getAttribute('data-disable-title') || '';
        downloadButton.title = downloadButtonTitle;
        downloadButton.classList.add('bs-button--disabled');
        downloadButton.disabled = true;
      // disable download button if hasn't any input checked
      } else {
        downloadButtonTitle = downloadButton.getAttribute('data-active-title') || '';
        downloadButton.title = downloadButtonTitle;
        downloadButton.classList.remove('bs-button--disabled');
        downloadButton.disabled = '';
      }
    }
  };

  /**
   * Shift-select Multiple Items
   * Select all checkboxes between lastChecked and currentChecked if
   * shiftKey is pressed during click
   *
   * @param  {Object} e  a click event in a checkbox
   * @return {void}
   */
  var shiftSelectMultipleItems = function (e, customInput) {
    var input = customInput || e.target;
    var start = null;
    var end = null;
    var shift = e && e.shiftKey;

    if ((input || {}).type !== 'checkbox') return;

    if (!config.lastInputChecked) {
      config.lastInputChecked = input;
      return;
    }

    if (shift) {
      start = Array.prototype.indexOf.call(config.itemsInput, config.lastInputChecked);
      end = Array.prototype.indexOf.call(config.itemsInput, input);

      if (Math.abs(start - end) > 1) {
        Array.prototype.slice.apply(config.itemsInput, [
          Math.min(start, end),
          Math.max(start, end) + 1,
        ]).forEach(function (item) {
          toggleItemCheckbox(item, true);

          // handle SelectAll Checkbox
          handleSelectAllByChildChange(item);
        });
      }
    }

    config.lastInputChecked = input;
  };

  /**
   * Zip File Generate
   * @param  {String} zipName Name of the zip file
   */
  var generateZipFile = function (zipName) {
    var checkedInputs = config.el.querySelectorAll('.bs-js-downloads-input:checked');
    var zip = null;
    var progress = null;
    var percentage = -1;
    var partialPercentage = 0;
    var urls = [];

    // Check if all dependencies exists
    if (
      !config.zipOnClient ||
      typeof JSZip === 'undefined' ||
      typeof saveAs === 'undefined' ||
      typeof forEachPromise === 'undefined' ||
      typeof get === 'undefined'
    ) return;

    // Set default value for zipName
    if (typeof zipName !== 'string') zipName = 'download.zip';

    // If there's one or more inputs checked
    if (checkedInputs.length) {
      // create an array with the URL of the files
      // of each checked input to ZIP
      urls = Array.prototype.map.call(checkedInputs, function (item) {
        var downloadItem = item.closest('.bs-download__item');
        var href = downloadItem.querySelector('a').href;
        return href;
      });

      // Start JSZip and BsSnackProgress
      zip = new JSZip();
      progress = config.downloadProgress;
      progress.elements.progress.classList.add('bs-progress--is-loading');
      progress.disableButton();
      progress.show();
      // console.log('starting downloads');
      progress.setProgress(0, 'Baixando ' + urls.length + ' arquivo' + (urls.length > 1 ? 's' : ''));

      // Set true to downloadIsActive
      // It's used to cancel the process (zipping process just run when it's
      // true, so a cancel action just need to set it to false) since JSZip
      // have no abort method
      config.downloadIsActive = true;

      // loop for each URL as a promise
      forEachPromise(urls, function (filepath) {
        var filename = getFilenameFromPath(filepath);

        // console.log('starting ' + filename);
        // progress.setProgress(0);

        if (!config.downloadIsActive) return;

        // Request XMLHttp from url
        return get(filepath, function (event) {
          if (event.lengthComputable) {
            var filePercentage = parseInt((event.loaded / event.total) * 100, 10);
            var partialFilePercentage = parseInt(filePercentage / urls.length, 10);
            var newPercentage = partialPercentage + partialFilePercentage;
            var interval = setInterval(function () {
              if (newPercentage > percentage) {
                // Update total percentage
                // The total value is the higher number between the sum of the
                // last partial percentage with the current file partial percentage
                // and the current percentage
                percentage = newPercentage;

                // update progress
                // console.log('downloading ' + filename, percentage);
                progress.setProgress(percentage);
              }

              // when the single file is downloaded, update the partial
              // percentage with the current percentage value
              if (filePercentage >= 100) {
                clearInterval(interval);
                partialPercentage = percentage;
                progress.setProgress(percentage);
              }
            }, 10);

            if (!config.downloadIsActive) this.abort();

            if (filePercentage >= 100) {
              clearInterval(interval);
              percentage = newPercentage;
              partialPercentage = percentage;
              progress.setProgress(percentage);
            }
          } else {
            // Unable to compute progress information since the total size is unknown
            console.warn('Unable to compute progress information since the total size is unknown');
          }
        })
        // get then
          .then(function (response) {
            // console.log('adding to zip', percentage);
            zip.file(getFilenameFromPath(filepath), response);
          }, function (error) {
            console.error(error);
          });
      })
      // forEachPromise then
        .then(function () {
          var zipPercentage = 0;

          // console.log('all files downloaded');
          // console.log('starting zipping');

          progress.setProgress(0, 'Compactando');

          // If there's no "valid" (status 200) files to zip
          // Abort zipping and throw error
          if (Object.keys(zip.files).length === 0) {
            abortdownload();
            throw new Error('No files found to zip');
          }

          // Stop if zip is no active
          if (!config.downloadIsActive) return;

          // start zipping process
          zip.generateAsync({ type: 'blob' }, function updateCallback(metadata) {
            // https://github.com/Amin52J/Download-Progress/blob/master/dist/download-progress.js
            var currentZipPercentage = parseInt(metadata.percent, 10);
            var newPercentage = (
              currentZipPercentage > zipPercentage
            ) ? currentZipPercentage : zipPercentage;

            // console.log(metadata.percent);
            // progress.setProgress(metadata.percent);

            if (!config.downloadIsActive) {
              clearInterval(zipInterval);
              return false;
            }

            var zipInterval = setInterval(function () {
              if (currentZipPercentage >= 100) {
                clearInterval(zipInterval);
                progress.setProgress(currentZipPercentage);
                return;
              }

              // zipPercentage = newPercentage;;
              // console.log(zipPercentage + '%');
              progress.setProgress(currentZipPercentage);

              clearInterval(zipInterval);
            }, 100);

            if (currentZipPercentage >= 100) {
              // clearInterval(zipInterval);
              // progress.setProgress(currentZipPercentage, 'c');
            }
          }).then(function (content) {
            // console.log('finish zipping');
            // console.log('save file');
            // debugger;

            // Stop if zip is no active
            if (!config.downloadIsActive) return;
            // console.log('fim');

            setTimeout(function () {
              progress.setProgress('', 'Download concludo!');
              progress.elements.progress.classList.remove('bs-progress--is-loading');
              uncheckAllItems();
              setTimeout(function () {
                progress.hide();
              }, 5000);

              // Stop if zip is no active
              if (!config.downloadIsActive) return;

              // run saveAs on browser
              saveAs(content, zipName);
            }, 1000);
          });
        });
    }
  };

  var storeZipFile = function (content) {
    config.zipFileId = Date.now();
    // Salva os dados na sessionStorage
    sessionStorage.setItem(config.zipFileId, content);
  };

  var getZipFile = function () {
    // Obtm os dados da sessionStorage
    return sessionStorage.getItem(config.zipFileId);
  };

  // --------------------------------
  // Filter Items
  // --------------------------------

  /**
   * Retorna um array com todos os anos de acordo com os itens para download
   *
   * @param  {object} parentEl um elemento pai de todos os itens
   * @return {array}           array com os anos disponveis
   */
  var getActiveYears = function () {
    var arrYears = [];
    var categories = config.categories;
    // var categories = config.el.querySelectorAll('.bs-download__list--active');

    arrYears = Array.prototype.reduce.call(categories, function (years, category) {
      var itemYears = getYearsByCategory(category);
      if (category.style.display !== 'none') {
        itemYears.forEach(function (year) {
          if (!years.includes(year)) years.push(year);
        });
      }
      return years;
    }, []);

    return arrYears.sort(function (a, b) { return a - b; }).reverse();
  };

  /**
   * Cria um array com todos os anos de acordo com os itens para download
   *
   * @param  {object}  category   um elemento pai de todos os itens
   * @param  {boolean} onlyActive ...
   * @return {array}              array com os anos disponveis
   */
  var getYearsByCategory = function (category, onlyActive) {
    var arrYears = [];
    var items = null;

    if (!category || typeof category !== 'object') return arrYears;
    if (typeof onlyActive !== 'boolean') onlyActive = false;

    items = category.querySelectorAll('.bs-download__item[data-download-year]');

    arrYears = Array.prototype.reduce.call(items, function (years, item) {
      var itemYears = item.getAttribute('data-download-year').split(' ');
      if (onlyActive) {
        if (item.style.display !== 'none') {
          itemYears.forEach(function (year) {
            if (!years.includes(year)) years.push(year);
          });
        }
      } else {
        itemYears.forEach(function (year) {
          if (!years.includes(year)) years.push(year);
        });
      }
      return years;
    }, []);

    return arrYears.sort(function (a, b) { return a - b; }).reverse();
  };

  /**
   * Cria um array com todos os anos de acordo com os itens para download
   *
   * @param  {string} year um elemento pai de todos os itens
   * @return {array}       array com os anos disponveis
   */
  var getCategoriesByYear = function (year) {
    var arrCategories = [];

    if (typeof year !== 'string' || year === '') return arrCategories;

    Array.prototype.forEach.call(config.categories, function (category) {
      var items = category.querySelectorAll('.bs-download__item[data-download-year]');

      Array.prototype.some.call(items, function (item) {
        var itemYears = item.getAttribute('data-download-year').split(' ');
        if (itemYears.includes(year)) return arrCategories.push(category);
      });
    });

    return arrCategories;
  };

  /**
   * Cria o filtro de ano
   * Popula o select de filtro de anos de acordo com os anos cadastrados nos itens
   *
   * @param  {object} select a tag select que vai receber os anos como options
   * @return {void}
   */
  var buildYearSelect = function (select) {
    var years = getActiveYears();

    years.forEach(function (year) {
      var option = document.createElement('option');
      option.value = year;
      option.textContent = year;
      select.appendChild(option);
    });
  };

  var handleFilters = function (select) {
    var categoryInput = config.filterForm.querySelector('.bs-form__field[name="category"]');
    var yearInput = config.filterForm.querySelector('.bs-form__field[name="year"]');
    var selectedCategoryId = (categoryInput && categoryInput.value) ? categoryInput.value : null;
    var selectedCategory = config.el.querySelector('[data-download-category="' + selectedCategoryId + '"]');
    var selectedYear = (yearInput && yearInput.value) ? yearInput.value : null;
    // var categoryOptions = (categoryInput) ? categoryInput.querySelectorAll('option') : null;
    var yearOptions = (yearInput) ? yearInput.querySelectorAll('option') : null;
    var categories = config.categories;
    var activeCategories = null;
    var activeYears = [];

    /**
     * Filtra a lista de downloads por categorias de downloads
     */
    Array.prototype.forEach.call(categories, function (category) {
      // ID da categoria atual
      var categoryId = category.getAttribute('data-download-category');
      // Itens para download da categoria atual
      var categoryItems = category.querySelectorAll('[data-download-year]');
      var hideGroup = true;

      // Se h uma categoria seleciona no filtro e no for essa, esconde
      if (selectedCategoryId) {
        if (selectedCategoryId === categoryId) hideGroup = false;
      } else {
        hideGroup = false;
      }

      // Se h um ano selecionado no filtro, reseta a hideGroup para o filtro
      // de ano tratar se esconde ou no o grupo
      if (selectedYear) {
        hideGroup = true;
      }

      // Se no h categorias selecionadas ou se a categoria selecionado
      // for a categoria atual no loop
      if (!selectedCategoryId || selectedCategoryId === categoryId) {
        // Se h itens dentro dessa categoria
        if (categoryItems && categoryItems.length) {
          /**
          * Filtra os itens da lista de downloads por ano
          */
          Array.prototype.forEach.call(categoryItems, function (item) {
            // Anos cadastrados para o item
            var itemYears = item.getAttribute('data-download-year').split(' ');

            // Se o filtro de anos existe, no est vazio e este item
            // NO possui o ano filtrado, esconde o item
            if (yearInput && yearInput.value) {
              if (!itemYears.includes(yearInput.value)) {
                item.style.display = 'none';
              } else {
                item.style.display = '';
                hideGroup = false;
              }
            } else {
              item.style.display = '';
              hideGroup = false;
            }
          });
        }
      }

      // Esconde a categoria
      if (hideGroup) {
        category.classList.remove(config.categoryActiveClass);
        category.style.display = 'none';
      } else {
        category.classList.add(config.categoryActiveClass);
        category.style.display = '';
      }
    });

    if (categoryInput && select === yearInput) {
      activeCategories = getCategoriesByYear(selectedYear);
      if (categories) {
        Array.prototype.forEach.call(categories, function (category) {
          var id = category.getAttribute('data-download-category');
          var option = categoryInput.querySelector('option[value="' + id + '"]');
          if (activeCategories.length && !activeCategories.includes(category)) {
            option.style.display = 'none';
            option.style.color = 'red';
            option.disabled = 'disabled';
          } else {
            option.style.display = '';
            option.style.color = '';
            option.disabled = '';
          }
        });
      }
    }

    if (yearInput && select === categoryInput) {
      activeYears = getYearsByCategory(selectedCategory);
      yearOptions = yearInput.querySelectorAll('option');
      if (yearOptions.length) {
        Array.prototype.forEach.call(yearOptions, function (option) {
          if (option.value && activeYears.length && !activeYears.includes(option.value)) {
            option.style.display = 'none';
            option.style.color = 'red';
            option.disabled = 'disabled';
          } else {
            option.style.color = '';
            option.style.display = '';
            option.disabled = '';
          }
        });
      }
    }
  };

  return {
    init: init,
    progress: function () {
      return config.downloadProgress
    },
    filter: handleFilters,
  };
};

/**
 * Init Modal Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  window.downloadsArr = [];
  var downloads = document.querySelectorAll('.bs-download');
  if (downloads.length) {
    var download = null;
    Array.prototype.forEach.call(downloads, function (el) {
      download = new BsDownloadsList(el);
      download.init();
      downloadsArr.push(download);
    });
  }
});

var BsLoginVida = (function () {

  var init = function () {

    var elInput = document.getElementById('atend-auto-cpf-cnpj')
    elInput.addEventListener('keypress', validateInput);

    function validateInput() {
      var el = document.getElementById('atend-auto-cpf-cnpj').value;
      var textRGEX = /[a-z]/i;
      var textResult = textRGEX.test(el);
      if (textResult == true || el == '') {
        //console.log('texto')
        elInput.removeAttribute('maxlength');
      } else {
        function mask() {
          var cpf = document.getElementById('atend-auto-cpf-cnpj')
          if (cpf.value.length == 3 || cpf.value.length == 7) {
            cpf.value += "."
          } else if (cpf.value.length == 11) {
            cpf.value += "-"
          }
        }
        mask();
        elInput.setAttribute('maxlength', '14');

      }

    }

    //Setando valor no focalizvel para SVG/Problema IE11
    var removeFocusableSvg = document.querySelector('.bs-header__logo svg');
    if (removeFocusableSvg != null) {
      removeFocusableSvg.setAttribute('focusable', 'false');
    }

  };

  return {
    init: init,
  };
}());

/**
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {

  if (document.querySelectorAll('.bs-banner-form-login-sign').length) {
    BsLoginVida.init();
  }

  isLoginVida = document.querySelector('.bs-login-vida')
  
  if (/iPhone/i.test(navigator.userAgent) && isLoginVida != null) {
    document.querySelector('.bs-login-vida').classList.add('is-iphone');
  } else if (/iPad/i.test(navigator.userAgent)) {
    document.querySelector('.bs-login-vida').classList.add('is-ipad');
  };

});


/**
 * Script mapa + card telefone
 */
var MultiMarkerMap = (function () {

  var mapElementAll = document.querySelectorAll('.pi-maps');

  var init = function (mapSelector) {
    var mapElement = document.querySelector(mapSelector);
    
    Array.prototype.forEach.call(mapElementAll, function (elem) {
      var config = {
        mapEl: elem,
        mapLocations: elem.querySelectorAll('.bs-map-info__location'),
        centerPointLat: elem.getAttribute('data-map-lat'),
        centerPointLng: elem.getAttribute('data-map-lng'),
        insideTitle: '',
        insideAddress: '',
        insideLat: '',
        insideLng: '',
        finalList: [],
      };
      
      Array.prototype.forEach.call(config.mapLocations, function (e, index) {
        config.insideTitle = e.getAttribute('data-title');
        config.insideAddress = e.getAttribute('data-address');
        config.insideLat = e.getAttribute('data-lat');
        config.insideLng = e.getAttribute('data-lng');
  
        var listInside = {
          id: index,
          address: config.insideAddress,
          lat: config.insideLat,
          lng: config.insideLng,
          fn: function () { return scrollTo(index); },
          infoWindow: {
            show: false,
            title: config.insideTitle,
          },
        };
  
        config.finalList.push(listInside);
  
      });
  
      if (config.mapEl && config.finalList.length) {
        var options = {
          mapHeight: 500,
          locations: config.finalList,
          mapOptions: {
            zoom: 14,
            center: new google.maps.LatLng(config.centerPointLat, config.centerPointLng),
            mapTypeId: google.maps.MapTypeId.ROADMAP,
          },
        };
  
        BsMaps.init(config.mapEl, options);
      } 
    });
  };

  var scrollTo = function (elementId) {
    var targetAnchor = document.querySelector('[data-scroll-anchor="' + elementId + '"]');

    if (targetAnchor) {
      var scroll = new SmoothScroll();
      var currentActive = targetAnchor.parentNode.querySelector('.bs-is-active');
      if (currentActive) currentActive.classList.remove('bs-is-active');
      targetAnchor.classList.add('bs-is-active');
      scroll.animateScroll(targetAnchor, 0, { 
        speed: 300,
        offset: 15,
      });

      BsHeader.setUnpinned();
      BsHeader.setFreeze();
      setTimeout( function() {
        BsHeader.unsetFreeze();
      }, 400)
    };
  };


  var mapAddress = function (add) {
    var geocoder;
    var map;
    var marker;

    var options = {
      zoom: 18,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    map = new google.maps.Map(document.querySelector(".bs-js-map"), options);
    geocoder = new google.maps.Geocoder();
    marker = new google.maps.Marker({
      map: map,
      draggable: true,
    });

    geocoder.geocode({ 'address': add + ', Brasil', 'region': 'BR' }, function (results, status) {

      if (status == google.maps.GeocoderStatus.OK) {
        if (results[0]) {
          var latitude = results[0].geometry.location.lat();
          var longitude = results[0].geometry.location.lng();

          var location = new google.maps.LatLng(latitude, longitude);
          marker.setPosition(location);
          map.setCenter(location);
          map.setZoom(15);
        }
      }
    });
  };

  return {
    init: init,
  };
}());

/**
 * Init MultiMarkerMap constructor
 * @return {void} MultiMarkerMap.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.pi-maps').length) {
    initGoogleMap(function () {
      MultiMarkerMap.init('.bs-js-map');
    });
  }
});

/**
 * BsMediaSlider
 * @return Module config
 */
var BsMediaSlider = (function () {

  // Config
  var config = {
    containers: document.querySelectorAll('.bs-js-slider'),
  }

  var init = function () {

    Array.prototype.forEach.call(config.containers, function (e) {
      var container = e;

      var item = e.querySelectorAll('.bs-card-slider__nav-result .bs-media__item');

      var reducerHeight = Array.prototype.reduce.call(item, function (i, el) {
        var child = el.querySelector('.bs-media__box');

        if (child) {
          var i = i >= child.offsetHeight ? i : child.offsetHeight;
          return i;
        }

      }, 0);

      setTimeout(function () {
        initCarouselContainer(container, reducerHeight);
      }, 2000);
    });

    window.addEventListener('load', function () {
      Array.prototype.forEach.call(config.containers, function (container) {
        setTimeout(function () {
          var carousel = container.querySelector('.bs-media__list');
          var flkty = Flickity.data(carousel);
          if (flkty) {
            flkty.reloadCells();
            flkty.resize();
          }
        }, 3000);
      });
    });
  };

  var initCarouselContainer = function (container, reducerHeight) {

    var carousel = container.querySelector('.bs-media__list');
    var panel = container.querySelector('.bs-media__nav .bs-media__list');
    var loading = container.querySelector('.bs-loading');
    var flktyA;
    var flkty = new Flickity(carousel, {
      asNavFor: panel,
      groupCells: 'true',
      cellAlign: 'left',
      contain: false,
      draggable: true,
      prevNextButtons: false,
      freeScroll: false,
      on: {
        ready: function () {
          this.reloadCells();
          this.resize();
          reloadFlkty(this, 1000);
          loading.parentNode.removeChild(loading);
        },
      },
    });

    // nav items content
    if (panel) {
      flktyA = new Flickity(panel, {
        pageDots: false,
        cellAlign: 'left',
        prevNextButtons: false,
        adaptiveHeight: true,
        draggable: true,
        freeScroll: false,
        on: {
          ready: function () {
            this.reloadCells();
            this.resize();
            reloadFlkty(this, 1000);
          },
        },
      });

      var navClose = container.querySelector('.bs-media__nav--close');
      var navContent = container.querySelector('.bs-media__nav');
      var navItem = container.querySelectorAll('.bs-media__item');

      Array.prototype.forEach.call(navItem, function (e) {

        e.addEventListener('click', function () {

          setTimeout(function () {
            navContent.classList.add('bs-media__nav--active');
            reloadFlkty(flktyA);
            // navContent.style.maxHeight = 60 + reducerHeight + 'px';
          }, 400);
        });
      });


      navClose.addEventListener('click', function () {
        navContent.classList.remove('bs-media__nav--active');
        // navContent.style.maxHeight = 0 + 'px';
      });

    }

    // buttons actions move - left
    var previousButton = container.querySelector('.bs-media__arrow-prev');
    previousButton.addEventListener('click', function () {
      flkty.previous();
    });

    // buttons actions move - right
    var nextButton = container.querySelector('.bs-media__arrow-next');
    nextButton.addEventListener('click', function () {
      flkty.next();
    });

    // flkty.on( 'scroll', function() {
    //   flkty.destroy()
    //   flkty = new Flickity(panel);
    // });

    nextButton.removeAttribute('disabled', 'disabled');
    carousel.classList.add('bs-media__list--linear-next');


    flkty.on('cellSelect', function () {

      // class add or remove effect over in position initial
      if (!flkty.cells[flkty.selectedIndex - 1]) {

        nextButton.removeAttribute('disabled', 'disabled');
        carousel.classList.add('bs-media__list--linear-next');

        previousButton.setAttribute('disabled', 'disabled');
        carousel.classList.remove('bs-media__list--linear-prev');

        // class add or remove effect over in position final
      } else if (!flkty.cells[flkty.cells.length]) {

        previousButton.removeAttribute('disabled', 'disabled');
        carousel.classList.add('bs-media__list--linear-prev');

        // class add or remove effect over in middle position to items big than sides
        if (flkty.selectedIndex === (flkty.pageDots.dots.length - 1)) {

          nextButton.setAttribute('disabled', 'disabled');
          carousel.classList.remove('bs-media__list--linear-next');
        } else {

          previousButton.removeAttribute('disabled', 'disabled');
          nextButton.removeAttribute('disabled', 'disabled');

          carousel.classList.add('bs-media__list--linear-next');
          carousel.classList.add('bs-media__list--linear-prev');
        }
      }
    });

    //Esse t funcionando!!!
    var media_custom = document.getElementsByClassName('bs-media__list--custom');
    for (i = 0; i < media_custom.length; i++) {
      var media_box = media_custom[i].getElementsByClassName('flickity-slider');
      for (j = 0; j < media_box.length; j++) {
        var countItem = media_box[0].getElementsByClassName('bs-media__item');

        if (countItem.length <= 2) {

          if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/Android/i)) {
            //Mobile

            if (countItem.length === 1) {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
              carousel.classList.remove('is-draggable');
              //carousel.parentNode.querySelector('.flickity-page-dots').style.display = 'none';

            } else {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'block';
              carousel.classList.add('is-draggable');
            }

          } else {
            //Desktop
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
            carousel.classList.remove('is-draggable');
          }

          carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
          carousel.classList.remove('is-draggable');

        }


      }
    }

    var media_customSlider = document.getElementsByClassName('bs-media__slider--nav');
    for (i = 0; i < media_customSlider.length; i++) {
      var media_box = media_customSlider[i].getElementsByClassName('flickity-slider');
      for (j = 0; j < media_box.length; j++) {
        var countItem = media_box[0].getElementsByClassName('bs-media__item');

        if (countItem.length <= 2) {

          if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/Android/i)) {
            //Mobile

            if (countItem.length === 1) {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
              carousel.classList.remove('is-draggable');
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none!important';

            } else {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'block';
              carousel.classList.add('is-draggable');
            }

          } else {
            //Desktop
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
            carousel.classList.remove('is-draggable');
          }

          carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
          carousel.classList.remove('is-draggable');

        }


      }
    }

    /*
    var media_customSliderNav = document.getElementsByClassName('bs-media__slider--nav');
    for (i = 0; i < media_customSliderNav.length; i++) {

      console.log('ESSE AQUI')

      var media_box = media_customSliderNav[i].getElementsByClassName('flickity-slider');
      for (j = 0; j < media_box.length; j++) {
        var countItem = media_box[0].getElementsByClassName('bs-media__item');

        if (countItem.length <= 3) {

          if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/Android/i)) {
            //Mobile

            if (countItem.length === 1) {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
              carousel.classList.remove('is-draggable');
            } else {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'block';
              carousel.classList.add('is-draggable');
            }

          } else {
            //Desktop
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
            carousel.classList.remove('is-draggable');
          }

          carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
          carousel.classList.remove('is-draggable');

        }


      }
    }
    */


    var media_customSlider = document.getElementsByClassName('is-card-slide');
    for (i = 0; i < media_customSlider.length; i++) {
      var media_box = media_customSlider[i].getElementsByClassName('flickity-slider');
      for (j = 0; j < media_box.length; j++) {
        var countItem = media_box[0].getElementsByClassName('bs-media__item ');
        if (countItem.length <= 5) {
          carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
          carousel.classList.remove('is-draggable');
        }
      }
    }

    if (!carousel.classList.contains('is-draggable')) {
      carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
    }

    var media_customCardSlide = document.getElementsByClassName('bs-card-slider');
    for (i = 0; i < media_customCardSlide.length; i++) {
      var media_box = media_customCardSlide[i].getElementsByClassName('flickity-slider');
      for (j = 0; j < media_box.length; j++) {
        var countItem = media_box[0].getElementsByClassName('bs-media__item ');

        if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/Android/i)) {
          if (countItem.length <= 4) {
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
            carousel.classList.remove('is-draggable');
          }else {
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'block';
            carousel.classList.add('is-draggable');
          }
        }else {
          if (countItem.length <= 5) {
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
            carousel.classList.remove('is-draggable');
          }else {
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'block';
            carousel.classList.add('is-draggable');
          }
        }

      }
    }

    if (!carousel.classList.contains('is-draggable')) {
      carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
    }


  }

  return {
    init: init,
  };
}());


/**
 * Init Menu Constructor
 * @return {void} Menu.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.bs-media__slider')) {
    BsMediaSlider.init();
  }
});

/**
 * BsMediaSliderRef
 * @return Module config
 */
var BsMediaSliderRef = (function () {

  // Config
  var config = {
    containers: document.querySelectorAll('.bs-js-carrousel-prod'),
  }

  var init = function () {

    Array.prototype.forEach.call(config.containers, function (e) {
      var container = e;

      var item = e.querySelectorAll('.bs-card-slider__nav-result .bs-media__item');

      var reducerHeight = Array.prototype.reduce.call(item, function (i, el) {
        var child = el.querySelector('.bs-media__box');

        if (child) {
          var i = i >= child.offsetHeight ? i : child.offsetHeight;
          return i;
        }

      }, 0);

      setTimeout(function () {
        initCarouselContainerRef(container, reducerHeight);
      }, 2000);
    });

    window.addEventListener('load', function () {
      Array.prototype.forEach.call(config.containers, function (container) {
        setTimeout(function () {
          var carousel = container.querySelector('.bs-media__list');
          var flkty = Flickity.data(carousel);
          if (flkty) {
            flkty.reloadCells();
            flkty.resize();
          }
        }, 3000);
      });
    });
  };

  var initCarouselContainerRef = function (container, reducerHeight) {

    var carousel = container.querySelector('.bs-media__list');
    var panel = container.querySelector('.bs-media__nav .bs-media__list');
    var loading = container.querySelector('.bs-loading');
    var flktyA;
    var flkty = new Flickity(carousel, {
      selectedAttraction: 0.2,
      friction: 1.0,
      asNavFor: panel,
      groupCells: 'true',
      cellAlign: 'left',
      contain: false,
      draggable: true,
      prevNextButtons: false,
      on: {
        ready: function () {
          this.reloadCells();
          this.resize();
          reloadFlkty(this, 1000);
          loading.parentNode.removeChild(loading);
        },
      },
    });

    // nav items content
    if (panel) {
      flktyA = new Flickity(panel, {
        pageDots: false,
        cellAlign: 'left',
        prevNextButtons: false,
        adaptiveHeight: true,
        draggable: true,
        on: {
          ready: function () {
            this.reloadCells();
            this.resize();
            reloadFlkty(this, 1000);
          },
        },
      });

      var navClose = container.querySelector('.bs-media__nav--close');
      var navContent = container.querySelector('.bs-media__nav');
      var navItem = container.querySelectorAll('.bs-media__item');

      Array.prototype.forEach.call(navItem, function (e) {

        e.addEventListener('click', function () {

          setTimeout(function () {
            navContent.classList.add('bs-media__nav--active');
            reloadFlkty(flktyA);
            // navContent.style.maxHeight = 60 + reducerHeight + 'px';
          }, 400);
        });
      });


      navClose.addEventListener('click', function () {
        navContent.classList.remove('bs-media__nav--active');
        // navContent.style.maxHeight = 0 + 'px';
      });

    }

    // buttons actions move - left
    var previousButton = container.querySelector('.bs-media__arrow-prev');
    previousButton.addEventListener('click', function () {
      flkty.previous();
    });

    // buttons actions move - right
    var nextButton = container.querySelector('.bs-media__arrow-next');
    nextButton.addEventListener('click', function () {
      flkty.next();
    });

    // flkty.on( 'scroll', function() {
    //   flkty.destroy()
    //   flkty = new Flickity(panel);
    // });

    nextButton.removeAttribute('disabled', 'disabled');
    carousel.classList.add('bs-media__list--linear-next');


    flkty.on('cellSelect', function () {

      // class add or remove effect over in position initial
      if (!flkty.cells[flkty.selectedIndex - 1]) {

        nextButton.removeAttribute('disabled', 'disabled');
        carousel.classList.add('bs-media__list--linear-next');

        previousButton.setAttribute('disabled', 'disabled');
        carousel.classList.remove('bs-media__list--linear-prev');

        // class add or remove effect over in position final
      } else if (!flkty.cells[flkty.cells.length]) {

        previousButton.removeAttribute('disabled', 'disabled');
        carousel.classList.add('bs-media__list--linear-prev');

        // class add or remove effect over in middle position to items big than sides
        if (flkty.selectedIndex === (flkty.pageDots.dots.length - 1)) {

          nextButton.setAttribute('disabled', 'disabled');
          carousel.classList.remove('bs-media__list--linear-next');
        } else {

          previousButton.removeAttribute('disabled', 'disabled');
          nextButton.removeAttribute('disabled', 'disabled');

          carousel.classList.add('bs-media__list--linear-next');
          carousel.classList.add('bs-media__list--linear-prev');
        }
      }
    });


    //Esse t funcionando!!!
    var media_custom = document.getElementsByClassName('bs-media__list--custom');
    for (i = 0; i < media_custom.length; i++) {
      var media_box = media_custom[i].getElementsByClassName('flickity-slider');
      for (j = 0; j < media_box.length; j++) {
        var countItem = media_box[0].getElementsByClassName('bs-media__item');

        if (countItem.length <= 2) {

          if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/Android/i)) {
            //Mobile

            if (countItem.length === 1) {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
              carousel.classList.remove('is-draggable');
              //carousel.parentNode.querySelector('.flickity-page-dots').style.display = 'none';

            } else {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'block';
              carousel.classList.add('is-draggable');
            }

          } else {
            //Desktop
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
            carousel.classList.remove('is-draggable');
          }

          carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
          carousel.classList.remove('is-draggable');

        }


      }
    }

    var media_customSlider = document.getElementsByClassName('bs-media__slider--nav');
    for (i = 0; i < media_customSlider.length; i++) {
      var media_box = media_customSlider[i].getElementsByClassName('flickity-slider');
      for (j = 0; j < media_box.length; j++) {
        var countItem = media_box[0].getElementsByClassName('bs-media__item');

        if (countItem.length <= 2) {

          if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/Android/i)) {
            //Mobile

            if (countItem.length === 1) {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
              carousel.classList.remove('is-draggable');
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none!important';

            } else {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'block';
              carousel.classList.add('is-draggable');
            }

          } else {
            //Desktop
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
            carousel.classList.remove('is-draggable');
          }

          carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
          carousel.classList.remove('is-draggable');

        }


      }
    }

    /*
    var media_customSliderNav = document.getElementsByClassName('bs-media__slider--nav');
    for (i = 0; i < media_customSliderNav.length; i++) {

      console.log('ESSE AQUI')

      var media_box = media_customSliderNav[i].getElementsByClassName('flickity-slider');
      for (j = 0; j < media_box.length; j++) {
        var countItem = media_box[0].getElementsByClassName('bs-media__item');

        if (countItem.length <= 3) {

          if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/Android/i)) {
            //Mobile

            if (countItem.length === 1) {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
              carousel.classList.remove('is-draggable');
            } else {
              carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'block';
              carousel.classList.add('is-draggable');
            }

          } else {
            //Desktop
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
            carousel.classList.remove('is-draggable');
          }

          carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
          carousel.classList.remove('is-draggable');

        }


      }
    }
    */


    var media_customSlider = document.getElementsByClassName('is-card-slide');
    for (i = 0; i < media_customSlider.length; i++) {
      var media_box = media_customSlider[i].getElementsByClassName('flickity-slider');
      for (j = 0; j < media_box.length; j++) {
        var countItem = media_box[0].getElementsByClassName('bs-media__item ');
        if (countItem.length <= 5) {
          carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
          carousel.classList.remove('is-draggable');
        }
      }
    }

    if (!carousel.classList.contains('is-draggable')) {
      carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
    }

    var media_customCardSlide = document.getElementsByClassName('bs-card-slider');
    for (i = 0; i < media_customCardSlide.length; i++) {
      var media_box = media_customCardSlide[i].getElementsByClassName('flickity-slider');
      for (j = 0; j < media_box.length; j++) {
        var countItem = media_box[0].getElementsByClassName('bs-media__item ');

        if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/Android/i)) {
          if (countItem.length <= 4) {
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
            carousel.classList.remove('is-draggable');
          } else {
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'block';
            carousel.classList.add('is-draggable');
          }
        } else {
          if (countItem.length <= 5) {
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
            carousel.classList.remove('is-draggable');
          } else {
            carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'block';
            carousel.classList.add('is-draggable');
          }
        }

      }
    }

    if (!carousel.classList.contains('is-draggable')) {
      carousel.parentNode.querySelector('.bs-media__arrows').style.display = 'none';
    }


  }

  var displayBulletsArrows = function () {
    const MOBILE_W = 767;
    const TABLET_W = 992;
    const WINDOW_WIDTH = window.screen.width;

    let carrousel = document.getElementsByClassName('bs-js-carrousel-prod');
    let min_slide;

    if (WINDOW_WIDTH <= MOBILE_W) {
      min_slide = 1;
    } else if (WINDOW_WIDTH <= TABLET_W) {
      min_slide = 2
    } else {
      min_slide = 3
    }

    for (let i = 0; i < carrousel.length; i++) {
      let slide_count = carrousel[i].getElementsByClassName("bs-media__item").length;

      if (slide_count <= min_slide) {
        carrousel[i].getElementsByClassName("flickity-page-dots")[0].style.display = "none";
        carrousel[i].getElementsByClassName("bs-media__arrows")[0].style.display = "none";
      } else {
        carrousel[i].getElementsByClassName("flickity-page-dots")[0].style.display = "block";
        carrousel[i].getElementsByClassName("bs-media__arrows")[0].style.display = "block";
      }
    }
  }


  return {
    init: init,
    displayBulletsArrows: displayBulletsArrows
  };
}());

var carrouselResize = (function () {

  var initCalc = function () {
    var carousel = document.querySelectorAll('.bs-js-carrousel-prod .bs-media__list--linear');
    for (i = 0; i < carousel.length; i++) {
      var el_viewport = carousel[i].getElementsByClassName("flickity-viewport");

      var flkty = Flickity.data(carousel[i]);

      for (j = 0; j < el_viewport.length; j++) {
        var card = el_viewport[j].getElementsByClassName("bs-media__item");

        for (let x = 0; x < card.length; x++) {
          var card_img = card[x].getElementsByClassName("bs-media__figure")
          var card_desc = card[x].getElementsByClassName("bs-media__text")

          if (x == 0) {
            var calc = card_img[0].clientHeight + card_desc[0].clientHeight;
          } else {
            if (calc < card_img[0].clientHeight + card_desc[0].clientHeight) {
              calc = card_img[0].clientHeight + card_desc[0].clientHeight;
            }
          }
        }

        if (/Trident/.test(navigator.userAgent)) {
          el_viewport[j].style.minHeight = (calc + 30) + 'px';

        } else {
          el_viewport[j].style.minHeight = calc + ('px');
        }
      }


      if (flkty) {
        flkty.reloadCells();
        flkty.resize();
      }
    }
  }

  return {
    init: init,
    initCalc: initCalc
  };
}());

var carrousel_container = document.querySelectorAll('.bs-js-carrousel-prod');

for (let i = 0; i < carrousel_container.length; i++) {
  let mediaItem = carrousel_container[i].querySelectorAll('.bs-js-carrousel-prod .bs-media__item .bs-media__box');

  for (let j = 0; j < mediaItem.length; j++) {
    mediaItem[j].classList.add("slide-" + j)

    if ((j + 1) / 3 % 1 == 0 && j + 1 < mediaItem.length) {

      // Atribui a funcinoalidade de clicar na seta avanar sempre que o tab for pressionado no terceiro card
      mediaItem[j].addEventListener('keydown', function (e) {
        if ((e.key === 'Tab' || e.keyCode === 9) && !e.shiftKey) {
          var current_slide = this;
          let next_slide = parseInt(current_slide.className.split(" ")[1].split("-")[1]) + 1;
          e.preventDefault(); // Necessrio forar o foco no prximo slide devido a problemas no IE.
          setTimeout(function () {
            current_slide.parentNode.parentNode.querySelector(".slide-" + next_slide).focus();
          }, 100)
          // carrousel_container[i].querySelector('.bs-media__arrow-next').click();
          current_slide.parentNode.parentNode.parentNode.parentNode.parentNode.querySelector('.bs-media__arrow-next').click(); // required to be like this to work on IE
        }
      })

      if (j + 1 < mediaItem.length) {

        // Atribui a funcinoalidade de clicar na seta voltar sempre que o tab + shift forem pressionados no primeiro card de cada slide sequente
        mediaItem[j + 1].addEventListener('keydown', function (e) {
          if (e.which === 9 && e.shiftKey) {
            // carrousel_container[i].querySelector('.bs-media__arrow-prev').click();
            this.parentNode.parentNode.parentNode.parentNode.parentNode.querySelector('.bs-media__arrow-prev').click(); // required to be like this to work on IE
          }
        })
      }
    }
  }
}

/**
 * Init Menu Constructor
 * @return {void} Menu.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.bs-media__slider')) {
    // var isMobile = /iPhone|iPod|Android/i.test(navigator.userAgent);
    BsMediaSliderRef.init();

    window.setTimeout(function () {
      carrouselResize.initCalc();
      BsMediaSliderRef.displayBulletsArrows();
    }, 2000);
  }
});

window.addEventListener("resize", function () {
  BsMediaSliderRef.displayBulletsArrows();
});

/**
 * Menu
 * @return Module config
 */
var Menu = (function () {
  // Class Modifiers
  var modClass = {
    overflowHidden: 'bs-overflow--hidden',
    hamburgerActive: 'bs-header__nav-toggle--open',
    menuActive: 'bs-menu--open',
    menuItemHasChild: 'bs-menu__item--has-child',
    menuItemOpen: 'bs-menu__item--open',
    menuListOpen: 'bs-menu__sublist--open',
    overlayBg: 'bs-overlay--nav',
    visible: 'bs-is-visible',
  };

  // DOM Elements
  var el = {
    body: document.querySelector('body'),
    closeMenu: document.querySelector('.js-close-menu'),
    currentMenu: document.querySelector('.bs-menu__sublist--current'),
    sublist: document.querySelectorAll('.bs-menu__sublist'),
    // true = voltando
    // false = prximo menu
    direction: '',
    nextMenu: '',
    hamburger: document.querySelector('.bs-header__nav-toggle'),
    menu: document.querySelector('.bs-menu'),
    menuButtons: document.querySelectorAll('.js-menu-item'),
    overlay: document.querySelector('.bs-overlay'),
  };

  var init = function () {
    // Toggle menu
    if (el.hamburger) {
      el.hamburger.addEventListener('click', _openMenu);
    }

    // Expand sublists inside main Menu
    if (el.menuButtons) {
      Array.prototype.forEach.call(el.menuButtons, function (element) {
        element.addEventListener('click', function (event) {
          var currentMenu = getParents(element, 'js-menu', true)[0];
          var direction = element.classList.contains('bs-menu__back');
          var parent = element.closest('.bs-menu__item');
          var nextMenu;

          if (direction) {
            // get previous menu (parent menu)
            nextMenu = getParents(element, 'js-menu')[1];
          } else if (element.nextElementSibling) {
            // or get the submenu
            nextMenu = element.nextElementSibling;
          } else {
            // fix when weblibras is active
            nextMenu = parent.querySelector('.js-menu');
          }

          // check if there's a submenu for this item
          if (nextMenu) {
            event.preventDefault();
            currentMenu.scrollTop = 0;

            // open it
            _updatePositions(currentMenu, nextMenu, direction);
            _openSubMenu();
          } else {
            // add class current
          }
        });
      });
    }

    // Close menu on esc key press
    document.addEventListener('keyup', function (e) {
      if (el.menu.classList.contains(modClass.menuActive)) if (e.keyCode === 27) _closeMenu();
    });

    // Close menu
    el.closeMenu.addEventListener('click', function () {
      _closeMenu();
    });

    // Close menu on click outside
    Array.prototype.forEach.call(document.querySelectorAll('body, html'), function (element) {
      element.addEventListener('click', function (event) {
        if (
          el.menu.classList.contains(modClass.menuActive) &&
          !el.menu.contains(event.target) &&
          !el.hamburger.contains(event.target)) {
          _closeMenu();
          return false;
        }
      });
    });

    _setMenuWrapHeight();

    window.addEventListener("resize", function() {
      _setMenuWrapHeight();
    });

    var btn_increse_font = document.getElementsByClassName("bs-js-increase-font");

    for (var i = 0; i < btn_increse_font.length; i++) {
      btn_increse_font[i].addEventListener('click', _setMenuWrapHeight, false);
    }   
    
    var btn_decrease_font = document.getElementsByClassName("bs-js-decrease-font");

    for (var i = 0; i < btn_decrease_font.length; i++) {
      btn_decrease_font[i].addEventListener('click', _setMenuWrapHeight, false);
    }  

  }; 

  // Set menu wrap height according to menu title height
  var _setMenuWrapHeight = function () {
    var window_height = Math.max(document.documentElement.clientHeight, window.innerHeight || 0) - 60;
    var menu = document.getElementsByClassName("bs-menu");
    
    Array.prototype.forEach.call(menu, function (item, index) {
      var menu_title = item.querySelector(".bs-menu__title");
      var menu_wrap = item.querySelector(".bs-menu__wrap");
      
      menu_wrap.style.height = window_height - menu_title.offsetHeight + "px";
    });
  }

  var _openSubMenu = function () {
    _menuOut();
    _menuIn();
  };

  var _menuOut = function () {
    el.currentMenu.classList.remove(modClass.menuListOpen);
  };

  var _menuIn = function () {
    el.nextMenu.classList.add(modClass.menuListOpen);

    _updatePositions(el.nextMenu, '', el.direction);
  };

  var _updatePositions = function (currentMenu, nextMenu, direction) {
    el.currentMenu = currentMenu;
    el.nextMenu = nextMenu;
    el.direction = direction;
  };

  var _openMenu = function () {
    el.hamburger.classList.add(modClass.hamburgerActive);
    el.menu.classList.add(modClass.menuActive);
    el.body.classList.add(modClass.overflowHidden);
    el.overlay.classList.add(modClass.visible);
    el.overlay.classList.add(modClass.overlayBg);
  };

  var _closeMenu = function () {
    el.hamburger.classList.remove(modClass.hamburgerActive);
    el.menu.classList.remove(modClass.menuActive);
    el.body.classList.remove(modClass.overflowHidden);
    el.overlay.classList.remove(modClass.visible);
    el.overlay.classList.remove(modClass.overlayBg);

    Array.prototype.forEach.call(el.sublist, function (element) {
      if (element.classList.contains(modClass.menuListOpen)) {
        element.classList.remove(modClass.menuListOpen);
      }
    });
  };

  return {
    init: init,
  };
}());

/**
 * Init Menu Constructor
 * @return {void} Menu.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.bs-menu')) {
    Menu.init();
  }
});

/**
 * Menu com Dropdown
 */
var BsQuickMenuDrop = (function () {
  // Config
  var config = {
    buttons: {
      back: document.querySelectorAll('.bs-quick-menu__back'),
      item: document.querySelectorAll('.bs-quick-menu__menu .bs-quick-menu__item'),
      triggerMenu: document.querySelectorAll('.bs-js-quick-trigger-menu'),
    },
    classes: {
      itemSubmenuOpen: 'bs-quick-menu__item--sub-open',
      menuOpen: 'bs-quick-menu__menu--open',
      sortable: 'bs-quick-menu__menu--sortable',
      subSubmenuOpen: 'bs-quick-menu__menu--sub-open',
      triggerMenuActive: 'bs-quick-menu__item--active',
    },
    container: document.querySelector('.bs-quick-menu'),
    menu: document.querySelectorAll('.bs-quick-menu__menu'),
    wrapper: document.querySelector('.bs-quick-menu__dropdown'),
    sortable: document.querySelectorAll('.bs-quick-menu__menu.bs-quick-menu__menu--sortable'),
  };

  var init = function () {

    // Recalcula o posicionamento do menu
    setTimeout(function () {
      _calcSubmenuPosition();
    }, 500);

    window.addEventListener('resize', function () {
      _calcSubmenuPosition();
    });

    window.addEventListener('scroll', function () {
      _closeAllMenus();
    });

    config.container.addEventListener('scroll', function () {
      _closeAllMenus();
    });

    _initShadow();

    if (config.buttons.triggerMenu) {
      Array.prototype.forEach.call(config.buttons.triggerMenu, function (button) {
        button.addEventListener('click', function (event) {
          event.preventDefault();
          _calcSubmenuPosition();

          var menu = button.querySelector('.bs-quick-menu__menu');
          var isMenuOpen = (menu.classList.contains(config.classes.menuOpen)) === true;

          if (isMenuOpen && menu) {
            _closeMenu(menu)
          } else {
            _closeAllMenus();
            _openMenu(menu);
          }
        });
      });
    }

    if (config.buttons.item) {
      Array.prototype.forEach.call(config.buttons.item, function (button) {
        var submenu = button.querySelector('.bs-quick-menu__submenu');
        // console.log(submenu)

        if (submenu) {
          button.addEventListener('click', function (event) {
            event.stopPropagation();
            var parentMenu = button.parentNode;

            parentMenu.classList.add(config.classes.subSubmenuOpen);
            button.classList.add(config.classes.itemSubmenuOpen);
          });
        }
      });
    }

    if (config.buttons.back) {
      Array.prototype.forEach.call(config.buttons.back, function (button) {
        button.addEventListener('click', function (event) {
          event.stopPropagation();
          event.preventDefault();

          var menuItem = getParents(button, config.classes.itemSubmenuOpen, true)[0];
          var menu = getParents(button, config.classes.subSubmenuOpen, true)[0];

          if (menuItem) {
            menuItem.classList.remove(config.classes.itemSubmenuOpen);
            menu.classList.remove(config.classes.subSubmenuOpen);
          }
        });
      });
    }

    if (config.sortable) {
      Array.prototype.forEach.call(config.sortable, function (menu) {
        dragula([menu], {
          moves: function (el, source, handle, sibling) {
            return (!el.classList.contains('bs-quick-menu__favorite')) && true;
          },
        });
      });


    }

    // Fecha o menu quando clicar fora dele
    Array.prototype.forEach.call(document.querySelectorAll('body, html'), function (element) {
      element.addEventListener('click', function (event) {
        var parentMenu = getParent(event.target, 'bs-quick-menu__dropdown');
        if (!parentMenu) {
          _closeAllMenus();
          return false;
        }
      });
    });
  };

  // Calcula a posio em que o submenu deve abrir
  var _calcSubmenuPosition = function () {
    var menus = config.menu;

    Array.prototype.forEach.call(menus, function (menu) {
      var left = menu.parentNode.getBoundingClientRect().left;
      var top = menu.parentNode.getBoundingClientRect().bottom;

      if (window.innerWidth >= 576) {
        menu.style.left = left + 'px';
      } else {
        // No mobile o menu  100%, ento no deve ser setado a posio left
        menu.style.removeProperty('left');
      }
      menu.style.top = top + 'px';
    });
  };

  var _openMenu = function (menu) {
    menu.parentNode.classList.add(config.classes.triggerMenuActive);
    menu.classList.add(config.classes.menuOpen);
  };

  var _closeMenu = function (menu) {
    menu.parentNode.classList.remove(config.classes.triggerMenuActive);
    menu.classList.remove(config.classes.menuOpen);
  };

  var _closeAllMenus = function () {
    var openedMenus = document.querySelectorAll('.' + config.classes.menuOpen);
    var openedSubmenus = document.querySelectorAll('.' + config.classes.subSubmenuOpen);
    var openedItems = document.querySelectorAll('.' + config.classes.itemSubmenuOpen);

    Array.prototype.forEach.call(openedMenus, function (menu) {
      menu.classList.remove(config.classes.menuOpen);
      menu.parentNode.classList.remove(config.classes.triggerMenuActive);
    });

    Array.prototype.forEach.call(openedSubmenus, function (submenu) {
      submenu.classList.remove(config.classes.subSubmenuOpen);
    });

    Array.prototype.forEach.call(openedItems, function (item) {
      item.classList.remove(config.classes.itemSubmenuOpen);
    });
  };

  var _initShadow = function () {
    var shadowStart = document.querySelector('.bs-quick-menu__shadow--start');
    var shadowEnd = document.querySelector('.bs-quick-menu__shadow--end');

    /**
     * Define se as sombras devem estar visveis
     * https://markus.oberlehner.net/blog/building-a-responsive-priority-plus-horizontal-scroll-navigation/
    */
    function handleShadowVisibility() {
      var maxScrollStartReached = config.wrapper.scrollLeft <= 0;
      var maxScrollEndReached =
        config.wrapper.scrollLeft >= config.wrapper.scrollWidth - config.wrapper.offsetWidth - 5;

      toggleShadow(shadowStart, maxScrollStartReached);
      toggleShadow(shadowEnd, maxScrollEndReached);
    }

    /**
     * Exibe/oculta as sombras
     * @param {Element} el sombra
     * @param {Boolean} maxScrollReached atingiu o limite do scroll (incio ou fim)
    */
    function toggleShadow(el, maxScrollReached) {
      var shadowIsVisible = el.classList.contains('is-visible');
      var showShadow = !maxScrollReached && !shadowIsVisible;
      var hideShadow = maxScrollReached && shadowIsVisible;

      // Using requestAnimationFrame for optimal scroll performance.
      // https://stackoverflow.com/a/44779316
      if (showShadow) {
        window.requestAnimationFrame(function () { el.classList.add('is-visible'); });
      } else if (hideShadow) {
        window.requestAnimationFrame(function () { el.classList.remove('is-visible'); });
      }
    }

    config.wrapper.addEventListener('scroll', function () {
      handleShadowVisibility();
    });

    handleShadowVisibility();
  };

  return {
    init: init,
  };
}());

/**
 * Init Menu com Dropdown
 * @return {void} BsMd.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-quick-menu__dropdown').length) {
    BsQuickMenuDrop.init();
  }
});

/**
 * Bs Modal
 *
 * Reference:
 *
 * [TODO]: Refatorar para que os elementos do config referenciem
 * um modal especfico ao invs de pegar todos os existentes no documento.
 */
var BsModal = (function () {
  // Config
  var config = {
    allNodes: document.querySelectorAll('*'),
    body: document.querySelector('body'),
    anchors: document.querySelectorAll('a'),
    currentZIndex: 400,
    lastFocus: [],
    lastOpenedModals: [],
    modal: document.querySelectorAll('.bs-modal'),
    modalMain: document.querySelector('.bs-main'),
    modalActiveClass: 'bs-modal--open',
    modalClose: document.querySelectorAll('.bs-js-close-modal'),
    modalCloseAll: document.querySelectorAll('.bs-js-close-all-modals'),
    modalOpen: document.querySelectorAll('.bs-js-open-modal'),
    modalOpenAndClose: document.querySelectorAll('.bs-js-open-close-modal'),
    modalOpenedPage: document.querySelector('.bs-js-opened'),
    overflowHidden: 'bs-overflow--hidden',
  };

  var init = function () {
    // Close modal on click outside
    Array.prototype.forEach.call(document.querySelectorAll('body, html'), function (el) {
      el.addEventListener('click', function (event) {
        var modalActive = isModalActive();
        if (
          modalActive &&
          modalActive.contains(event.target) &&
          !modalActive.querySelector('.bs-modal__container').contains(event.target)
        ) {
          closeModal();
          return false;
        }
      });
    });

    // Open modal on click
    Array.prototype.forEach.call(config.modalOpen, function (opener) {
      if (opener.tagName === 'FORM') {
        openEvent = opener.getAttribute('data-validate-callback') ? 'formIsValid' : 'submit';
        opener.addEventListener(
          openEvent,
          openModal.bind(null, opener)
        );
      } else {
        opener.addEventListener(
          'click',
          openModal.bind(null, opener)
        );
      }
    });

    // Open modal from anchor href
    Array.prototype.forEach.call(config.anchors, function (anchor) {
      var hash = getHashAsIdFromUrlString(anchor.href);
      if (hash.length > 1) anchor.addEventListener('click', openModal.bind(null, hash));
    });

    // Open modal on page load
    window.addEventListener('DOMContentLoaded', function () {
      var hash = getHashAsIdFromUrlString(window.location.hash);
      if (hash.length > 1) openModal(hash);
    });

    // Open modal on hashchange
    // Deprecated:
    //   - not open when page loads
    //   - not fires when the hash is the same
    // window.addEventListener('hashchange', openModal.bind(null, window.location.hash));

    // Close modal on click
    Array.prototype.forEach.call(config.modalClose, function (element) {
      element.addEventListener('click', function () {
        closeModal(element);
      });
    });

    // Close the current modal and opens another
    Array.prototype.forEach.call(config.modalOpenAndClose, function (element) {
      element.addEventListener('click', function () {
        closeModal();
        openModal(element);
      });
    });

    // Close all modals
    Array.prototype.forEach.call(config.modalCloseAll, function (closeModal) {
      closeModal.addEventListener('click', function () {
        closeAllModals();
      });
    });

    // Restringe foco no elemento do modal
    Array.prototype.forEach.call(config.allNodes, function (nodeItem) {
      nodeItem.addEventListener('focus', focusRestrict);
    });

    // Close modal on esc key press
    document.addEventListener('keyup', function (event) {
      if (isModalActive()) if (event.keyCode === 27) closeModal();
    });
  };

  /**
   * Open Modal
   * @param  {Object} openElement  modal element
   * @return {void}
   */
  var openModal = function (openElement) {
    var modal = getModal(openElement);

    // Atualiza o ltimo boto com foco
    config.lastFocus.push(document.activeElement);

    if (modal) {

      if (config.lastOpenedModals.includes(modal)) return;

      config.lastOpenedModals.push(modal);
      config.body.classList.add(config.overflowHidden);
      config.modalOpen = true;

      // Focvel, mas que no deve ser localizado pela navegao sequencial do teclado
      modal.setAttribute('tabindex', '-1');
      modal.classList.add(config.modalActiveClass);
      modal.focus();

      modal.setAttribute('aria-modal', 'true');
      if (config.modalMain != null) {
        config.modalMain.setAttribute('aria-hidden', 'true');
      }

      // Incrementa o z-index do modal
      setZIndex(modal);

      return false;
    }
  };

  /**
   * Close Modal
   * @param  {Object} closeElement  modal element
   * @param  {Object} options       custom options
   */
  var closeModal = function (closeElement, options) {
    var modal = getModal(closeElement);

    if (typeof options !== 'object') options = {};

    if (modal) {
      if (modal.classList.contains('bs-modal--unclosable') && !options.forceClose) return;

      config.lastOpenedModals.pop();
      config.modalOpen = false;

      // Pausa os vdeos que estejam rodando dentro do modal
      stopAllModalVideos(modal);

      // Focvel, mas que no deve ser localizado pela navegao sequencial do teclado
      modal.setAttribute('tabindex', '-1');
      modal.classList.remove(config.modalActiveClass);

      modal.setAttribute('aria-modal', 'false');
      if (config.modalMain != null) {
        config.modalMain.setAttribute('aria-hidden', 'false');
      }

      // Adicionar o foco no elemento do boto assim que encerra o modal
      if (config.lastFocus[config.lastFocus.length - 1]) {
        config.lastFocus[config.lastFocus.length - 1].focus();
      }
      config.lastFocus.pop();

      // Se no houver mais modais ativos, remove o bloqueio do scroll do body
      if (!isModalActive()) {
        config.body.classList.remove(config.overflowHidden);
      }
    }
  };

  /**
   * Close All Active Modal
   */
  var closeAllModals = function () {
    var openModals = document.querySelectorAll('.' + config.modalActiveClass);

    Array.prototype.forEach.call(openModals, function (modal) {
      modal.classList.remove(config.modalActiveClass);
      // Focvel, mas que no deve ser localizado pela navegao sequencial do teclado
      modal.setAttribute('tabindex', '-1');
      modal.setAttribute('aria-modal', 'false');
    });

    if (config.modalMain != null) {
      config.modalMain.setAttribute('aria-hidden', 'false');
    }

    config.body.classList.remove(config.overflowHidden);
    // Adicionar o foto no elemento do boto assim que encerra o modal
    config.lastFocus[config.lastFocus.length - 1].focus();
    config.lastFocus = [];
    config.modalOpen = false;
  };

  // Foco restrito ao modal
  var focusRestrict = function (event) {
    // var currentModal = getParents(event.target, config.modalActiveClass)[0];
    var currentModal = document.querySelector('.' + config.modalActiveClass);

    if (currentModal) {
      if (config.modalOpen && !currentModal.contains(event.target)) {
        event.stopPropagation();
        currentModal.focus();
      }
    }
  };

  /**
   Get Modal
   * @param  {String|Object} element  the id of a modal as string or a HTMLElement
   *                                  with data-modal-target or data-modal-id
   *                                  attributes
   * @return {Object}                 the modal HTMLElement
   */
  var getModal = function (element) {
    var modal;
    var modalId;

    // the function accept a string with the ID or
    // the HTMLElement object of the modal
    if (element) {
      // if it's a string, get it as modalId
      if (typeof element === 'string') {
        modalId = element;
      // if it's not a string, assume it's an element
      // if the element have a modal's ID in its dataset, set it to modalId
      } else {
        modalId = (element.dataset.modalTarget) || element.dataset.modalId;
      }

      // if an ID was found in the previous step
      if (modalId) {
        // remove all "special characters" (including #)
        modalId = modalId.replace(/[^a-zA-Z0-9-_]/g, '');
        // search for a modal element with data-modal-id or id attributes
        // with that matches the modalId
        modal = (
          document.querySelector('.bs-modal[data-modal-id="' + modalId + '"]') ||
          document.querySelector('.bs-modal#' + modalId)
        );

      // if an ID was not found and assuming element is an valid HTMLElement,
      // check if element is inside a modal and, if true, return that modal
      } else {
        modal = getParents(element, 'bs-modal')[0];
      }

    // if element parameter is not passed, try to get the last opened modal
    } else {
      modal = config.lastOpenedModals[config.lastOpenedModals.length - 1];
    }

    return modal;
  };

  /**
   * Is Modal Active
   * Check if there's a modal active
   * @return {Boolean|Object} true if there's at least one modal active
   */
  var isModalActive = function () {
    var modals = config.lastOpenedModals;
    return modals.length && modals[modals.length - 1];
  };

  /**
   * Stop all videos inside modal
   * Remove the video element from node and insert it again. It stops the video!
   * @param  {Object} modal the parent element of video elements
   */
  var stopAllModalVideos = function (modal) {
    var videos = modal.querySelectorAll('.bs-video');

    if (videos.length) {
      Array.prototype.forEach.call(videos, function (video) {
        var player = BsYTPlayers.getPlayer(video.id);
        if (player) {
          player.stopVideo();
        }
      });
    }
  };

  // Faz com que o ltimo modal tenha o z-index maior
  var setZIndex = function (modal) {
    config.currentZIndex = ++config.currentZIndex;
    modal.style.zIndex = config.currentZIndex;
  };

  return {
    init: init,
    open: openModal,
    close: closeModal,
    restrict: focusRestrict,
  };
}());

/**
 * Init Modal Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-modal').length) {
    BsModal.init();
  }
  if (document.querySelector('.bs-js-opened')) {
    BsModal.open(document.querySelector('.bs-js-opened'));
  }
});

/**
 * Bs Alert
 * A variation of modal for alertdialog
 *
 * @use
 *   BsAlert({
 *     id: 'uniqueID',
 *     type: 'success/error/warning/info/question/loading',
 *     title: 'Title of alert',
 *     content: 'Description or HTML for the content',
 *     buttonLabel: 'text of the button',
 *   })
 *
 */
var BsAlert = (function () {
  /**
   * General config
   * @type {Object}
   */
  var config = {};

  /**
   * Set Config
   * @param  {Object} options Custom options
   * @return {Object}         Default options extend by custom
   */
  var setConfig = function (options) {
    return extend({
      id: '',
      type: '',
      title: '',
      content: '',
      footer: '',
      buttonLabel: '',
      showCloseButton: false,
      unclosable: false,
    }, options, {
      modalActive: config.modalActive || {},
    });
  };

  /**
   * Crypto Value
   * Gerador criptogrfico de nmeros aleatrios
   *
   * @info https://developer.mozilla.org/pt-BR/docs/Web/API/Window/crypto
   * @return {String} a random value
   */
  var cryptoValue = function () {
    var cryptoObj = window.crypto || window.msCrypto; // for IE 11
    return (cryptoObj.getRandomValues(new Uint32Array(1))[0]).toString();
  };

  /**
   * Show Alert
   * @param  {Object} options object of options
   */
  var show = function (options) {
    var modalConfig = setConfig(options);
    var modalExist = modalConfig.id === modalConfig.modalActive.id;
    config = modalConfig;

    if (modalExist) {
      updateModalContent();
    } else {
      // append alert modal to body
      document.body.appendChild(buildModal());
    }

    // the timeout is necessary to avoid problems with modal's default
    // animation that don't run on first call of BsAlert() on chrome
    setTimeout(function () {
      // open alert modal
      BsModal.open(config.id);
    }, 100);
  };

  /**
   * Build Modal
   * Create the modal element with full structure, config and content
   * @return {HTMLElement} the modal element
   */
  var buildModal = function () {
    var modalRealId = (config.id || cryptoValue());
    var modalId = 'alertmodal--' + modalRealId;
    var modal = document.createElement('div');
    var modalContainer = document.createElement('div');
    var header = document.createElement('header');
    var body = document.createElement('div');
    var footer = document.createElement('footer');
    var title = document.createElement('strong');
    var closeButton = document.createElement('button');
    var alertButton = document.createElement('button');
    var content = document.createElement('div');

    // Set the ID of modal on config
    config.id = modalId;

    // Remove active modal and set current as active
    if (config.modalActive.modal) config.modalActive.modal.remove();
    config.modalActive.modal = modal;

    // Set modal element config
    modal.id = modalId;
    modal.role = 'alertdialog';
    modal.classList.add('bs-modal');
    modal.classList.add('bs-modal--overlay-dark');
    modal.classList.add('bs-modal--alert');
    modal.classList.add('bs-alert');
    modal.setAttribute('data-modal-id', modalRealId);
    modal.setAttribute('data-alert-type', config.type);
    modal.setAttribute('aria-labelledby', 'alertmodal-heading--' + modalId);
    modal.setAttribute('aria-describedby', 'alertmodal-text--' + modalId);
    config.modalActive.modal = modal;
    config.modalActive.id = modalRealId;

    // add modal's unclosable class
    if (config.unclosable) modal.classList.add('bs-modal--unclosable');

    // Set modal's container config
    modalContainer.classList.add('bs-modal__container');

    // Set modal's header config
    header.classList.add('bs-modal__header');
    header.innerHTML = '<span class="bs-alert__icon"></span>';

    // Set modal's footer config and content
    footer.classList.add('bs-modal__footer');
    footer.innerHTML = config.footer;
    config.modalActive.footer = footer;

    // Set modal's body config
    body.tabIndex = 0;
    body.classList.add('bs-modal__body');

    // Set alert's title config and content
    title.id = 'alertmodal-heading--' + modalId;
    title.classList.add('bs-alert__title');
    title.innerHTML = config.title;
    config.modalActive.title = title;

    // Set alert's title config and content
    content.id = 'alertmodal-text--' + modalId;
    content.classList.add('bs-alert__content');
    content.innerHTML = config.content;
    config.modalActive.content = content;

    closeButton.title = 'Fechar';
    closeButton.type = 'button';
    closeButton.classList.add('bs-modal__close-btn');
    closeButton.innerHTML = '<i class="icon-nav-fechar" aria-hidden="true"></i>';
    closeButton.addEventListener('click', BsModal.close(config.id));

    alertButton.type = 'button';
    alertButton.classList.add('bs-button', 'bs-alert__button');
    alertButton.innerHTML = config.buttonLabel;
    alertButton.addEventListener('click', function () {
      BsModal.close(config.id);
    });
    config.modalActive.button = alertButton;

    // append modal elements
    modal.appendChild(modalContainer);
    modalContainer.appendChild(header);
    modalContainer.appendChild(body);
    modalContainer.appendChild(footer);
    if (config.showCloseButton) modalContainer.appendChild(closeButton);

    // append alert elements
    body.appendChild(title);
    body.appendChild(content);
    body.appendChild(alertButton);

    return modal;
  };

  /**
   * Update Modal
   * Update the content of an existent modal
   * @return {HTMLElement} the updated modal element
   */
  var updateModalContent = function () {
    var modal = config.modalActive.modal;
    var footer = config.modalActive.footer;
    var title = config.modalActive.title;
    var content = config.modalActive.content;
    var button = config.modalActive.button;

    // remove modal's unclosable class
    if (!config.unclosable) modal.classList.remove('bs-modal--unclosable');

    footer.innerHTML = config.footer;
    title.innerHTML = config.title;
    content.innerHTML = config.content;
    button.innerHTML = config.buttonLabel;

    modal.setAttribute('data-alert-type', config.type);

    return modal;
  };

  return {
    show: show,
  };
}());

/**
 * Bs Modal List (anchor)
 */
var BsModalList = (function () {

  // config
  var config = {
    carousel: document.querySelector('.bs-js-modal-carousel'),
    previousButton: document.querySelector('.bs-modal--previous'),
    nextButton: document.querySelector('.bs-modal--next'),
    modalActiveClass: 'bs-modal--open',
    // selects: document.querySelector('.bs-js-filter select'),
    item: document.querySelectorAll('.bs-js-filter--modal'),
    slider: '',
  };
  var flkty = '';

  var init = function () {

    // - Percorre Carosels existentes na Pagina par amontar o flickity
    // - Ativa modal correto conforme o index de cada elemento clicado
    Array.prototype.forEach.call(config.item, function (el) {
      var button = el.querySelector('a');
      button.addEventListener('click', function () {
        var filterTeste = BsFilter.filter();
        var filterItens = filterTeste.getFilteredItemElements();

        openModal(filterItens.indexOf(el));
      });
    });

    // - Aplica mudanas para abrir modal no elemento
    var openModal = function (index) {
      // index = [value] selected,
      // isWrapped = [ true => ltimo slide ser selecionado se no primeiro slide.], 
      // isInstant = [true  => remove animation open index] fgf
      flkty.select(index, false, true);
      BsModal.open('#newModal');

      // vars out, get moment height and modal open
      var height = document.querySelector('.bs-modal--open');
      var itemSlide = document.querySelectorAll('.bs-modal__item');
      var heightWindow = 100;
      Array.prototype.forEach.call(itemSlide, function (elem) {

        // construct after slider mount
        var modalClose = elem.querySelector('.bs-js-close-modal');
        var modal = document.querySelector('.bs-modal');
        // close custom to modal + slider
        modalClose.addEventListener('click', function () {
          modal.setAttribute('tabindex', '-1');
          modal.classList.remove(config.modalActiveClass);
        });

        var modalBody = elem.querySelector('.bs-modal__body');
        modalBody.style.overflow = 'hidden';

        var heightModal = height.clientHeight - heightWindow;
        elem.style.height = heightModal + 'px';
        elem.style.overflow = 'auto';
      });
      // resize height to appply render height box
      window.addEventListener('resize', function () {
        var heightInner = document.querySelector('.bs-modal--open');
        Array.prototype.forEach.call(itemSlide, function (elem) {
          var heightModal = heightInner.clientHeight - heightWindow;
          elem.style.height = heightModal + 'px';
        });
      });
    }
  };

  var loadFlickity = function (carousel, items) {
    var flickityOptions = {
      adaptiveHeight: true,
      watchCSS: false,
    };
    var carouselItems;

    // receber index dos itens conforme o filtro
    if (items) {
      if (config.slider) config.slider.remove();
      config.slider = document.createElement('div');
      carouselItems = carousel.querySelectorAll('.bs-modal__item');
      carousel.parentNode.appendChild(config.slider);
    }
    Array.prototype.forEach.call(carouselItems, function (child) {
      var childIndex = Array.prototype.indexOf.call(carouselItems, child);
      if (items.includes(childIndex)) {
        config.slider.appendChild(child.cloneNode(true));
      }
    })
    // debugger;

    flkty = new Flickity(config.slider, flickityOptions);
    window.flkty = flkty;

    // Set Link to social media
    flkty.on('change', function () {
      var selected = document.querySelector('.is-selected');
      var id = selected.getAttribute('data-hash');
      window.location = '#preview' + id;
    });
  };

  return {
    init: init,
    loadSlider: loadFlickity,
  };
}());

/**
 * Init Filter Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-js-modal--list').length) {
    BsModalList.init();
  }
})

/**
 * Banner Topo
 * @return Module config
 */
var BsMosaico = (function () {
  /**
   * Init function
   * @return {Function} Module's scope functions
   */
  var init = function () {
    var elements = document.querySelectorAll('.js-mosaico-reveal');
    var link = document.querySelector('.bs-mosaico__link');

    reveal(elements, link);
  };

  var reveal = function (elements, link) {
    // https://scrollrevealjs.org/
    window.sr = ScrollReveal();

    sr.reveal(
      elements,
      {
        duration: 1337,
        origin: 'bottom',
        scale: 1,
        distance: '40px',
        reveal: reveal,
      },
      100
    );
  };


  return {
    init: init,
  };
}());

/**
 * Init Header Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.js-mosaico-reveal')) {
    BsMosaico.init();
  }
});

/**
 * Bs Mural (isotope/masonry)
 */
var BsMural = (function () {
  // Config
  var config = {
    mural: null,
  };

  var init = function (el) {
    el = typeof el === 'string' ? querySelector(el) : el;
    filterMasonry(el);
  };

  var filterMasonry = function (el) {
    config.list = new Isotope(el, {
      layoutMode: 'packery',
      itemSelector: config.itemSelector,
      columnWidth: config.itemSizerSelector,
      percentPosition: true,
      rowHeight: 320,
    });
  };

  return {
    init: init,
    list: function () {
      return config.list;
    },
  };
}());

/**
 * Init Mural Constructor
 */
document.addEventListener('DOMContentLoaded', function () {
  var murals = document.querySelectorAll('.bs-js-mural');
  if (murals.length) {
    Array.prototype.forEach.call(murals, function (el) {
      BsMural.init(el);
    })
  }
});

/**
 * Bs Mural (isotope/masonry)
 */
var BsMural = (function () {
  // Config
  var config = {
    mural: null,
  };

  var init = function (el) {
    el = typeof el === 'string' ? querySelector(el) : el;
    filterMasonry(el);
  };

  var filterMasonry = function (el) {
    config.list = new Isotope(el, {
      layoutMode: 'packery',
      itemSelector: config.itemSelector,
      columnWidth: config.itemSizerSelector,
      percentPosition: true,
      rowHeight: 320,
    });
  };

  return {
    init: init,
    list: function () {
      return config.list;
    },
  };
}());

/**
 * Init Mural Constructor
 */
document.addEventListener('DOMContentLoaded', function () {
  var murals = document.querySelectorAll('.bs-js-mural');
  if (murals.length) {
    Array.prototype.forEach.call(murals, function (el) {
      BsMural.init(el);
    })
  }
});

/**
 * Bs QuickMenu (anchor)
 *
 * TODO:
 * 1. Esconder (translate:-100%) menu fixo quando passar
 * da ltima seo da pgina (geralmente, sobre o footer) e
 * voltar a mostrar quando subir a pgina novamente;
 *
 * 2. Calcular a velocidade do smooth scroll relativo  posio
 * da seo, para que a animao do scroll leve sempre o
 * mesmo tempo. Ex: levar o mesmo tempo para scrollar da
 * seo 1 para 2 e da 1 para a ltima.
 *
 * 3. Quando o scroll vai de baixo para cima, por conta do Header
 * ficar visvel, o menu acaba ficando sobre o ttulo. Precisa
 * descontar o tamanho do header da posio alvo da ncora.
 */
var BsQuickMenu = (function() {
    // Elements
    var elements = {};
    var $ = elements;
    $.body = document.querySelector('body');
    $.quickMenu = document.querySelector('.bs-js-quick-menu-anchor');

    if (!$.quickMenu) return;

    $.floater = $.quickMenu.querySelector('.bs-quick-menu__wrapper');
    $.list = $.quickMenu.querySelector('.bs-quick-menu__list');
    $.toggle = $.quickMenu.querySelector('.bs-quick-menu__toggle');
    $.items = $.list.querySelectorAll('.bs-quick-menu__link');


    // Config
    var config = {
        quickMenuActive: false,
        quickMenuActiveClass: 'bs-quick-menu--open',
        quickMenuPinedClass: 'bs-quick-menu--pined',
        itemActiveClass: 'bs-quick-menu__link--active',
        scrollTopPosition: function() {
            return window.pageYOffset || document.documentElement.scrollTop;
        },
        topPositionToFloat: 0,
        scrollDirection: 0,
        lastScrollTop: 0,
        smoothScrollSteps: 25,
        scrollAnchorGutter: 80,
        anchorSelector: 'section',
        lastSelectedAnchor: null
    };

    var init = function() {
        // Toggle quickMenu
        if ($.toggle) $.toggle.addEventListener('click', toggleQuickMenu);

        // Close quickMenu on click outside
        Array.prototype.forEach.call(document.querySelectorAll('body, html'), function(el) {
            el.addEventListener('click', function(event) {
                if (
                    quickMenuActive() &&
                    !$.quickMenu.contains(event.target) &&
                    !$.toggle.contains(event.target)) {
                    closeQuickMenu();
                    return false;
                }
            });
        });

        // Close header on click outside
        window.addEventListener('scroll', function() {
            // Fixa o menu no topo da viewport
            setPined();

            // Exibe o menu abaixo do header quando este est visvel
            if (!BsHeader.isFloating() || BsHeader.el.classList.contains(BsHeader.headerPinned)) {
                $.floater.style.top = BsHeader.el.offsetHeight + 'px';
            } else {
                $.floater.style.top = 0;
            }

            // Ativa o item de acordo com o scroll
            setActiveItem(getActiveItem());
        });

        // Click menu anchors
        Array.prototype.forEach.call($.items, function(el) {
            var hash = el.getAttribute('href');
            el.addEventListener('click', function(event) {
                // Previne o clique se o hash for uma ncora vlida
                if (validAnchor(hash)) event.preventDefault();
                // Retorna se for invlida (mantm o clique padro)
                else return;

                // Retorna se no existe uma ncora na pgina (ID) referente ao hash do item
                if (!document.querySelector(hash)) return;

                // Chama a funo para rolar a pgina at a ncora
                gotoAnchor(el);
            });
        });
    };

    var toggleQuickMenu = function() {
        if (!quickMenuActive()) openQuickMenu();
        else closeQuickMenu();
    };

    var openQuickMenu = function() {
        $.quickMenu.classList.add(config.quickMenuActiveClass);
    };

    var closeQuickMenu = function() {
        $.quickMenu.classList.remove(config.quickMenuActiveClass);
    };

    var quickMenuActive = function() {
        return $.quickMenu.classList.contains(config.quickMenuActiveClass);
    };

    var gotoAnchor = function(el) {
        var anchor = el.getAttribute('href');
        var anchorElement = document.querySelector(anchor);
        var anchorPosition = anchorElement.offsetTop;
        var interval = 0;
        var scrollDown = function() {
            window.scrollTo(0, config.scrollTopPosition() + config.smoothScrollSteps);
            if (config.scrollTopPosition() > (anchorPosition - config.scrollAnchorGutter)) {
                clearInterval(interval);
            }
        };
        var scrollUp = function() {
            window.scrollTo(0, config.scrollTopPosition() - config.smoothScrollSteps);
            if (config.scrollTopPosition() < (anchorPosition - config.scrollAnchorGutter)) {
                clearInterval(interval);
            }
        };

        // Fecha a lista do menu
        closeQuickMenu();

        // Scrolla at a ncora do item clicado
        // Se a ncora est abaixo da posio atual da pgina
        if (config.scrollTopPosition() < anchorPosition) {
            interval = window.setInterval(scrollDown, 2);
            // Se a ncora est acima da posio atual da pgina
        } else if (config.scrollTopPosition() > anchorPosition) {
            interval = window.setInterval(scrollUp, 2);
        }
    };

    var setActiveItem = function(anchor) {
        // console.log(anchor);

        if (anchor === config.lastSelectedAnchor) return;
        else config.lastSelectedAnchor = anchor;

        var anchorHash = '#' + anchor.getAttribute('id');
        var menuItem = $.list.querySelector('[href="' + anchorHash + '"]');
        var title = menuItem.textContent;

        // debugger;


        // Desativa item ativo atualmente
        if ($.list.querySelector('.' + config.itemActiveClass)) {
            $.list.querySelector('.' + config.itemActiveClass).classList.remove(config.itemActiveClass);
        }

        // Ativa o item de acordo com a posio atual
        menuItem.classList.add(config.itemActiveClass);

        // Altera o texto do boto de toggle com o ttulo do item clicado
        $.toggle.innerText = title.toString();

        // Altera o hash da URL com o hash da ncora clicada
        history.replaceState(undefined, undefined, anchorHash);
    };

    var getActiveItem = function() {
        var positions = getAnchorsPosition();
        var scroll = config.scrollTopPosition();
        var i = 0;
        var length = positions.length;
        var output = 0;

        // Return active element by offsetTop position
        for (; i < length; i += 1) {
            if (scroll >= (positions[i].targetPos - config.scrollAnchorGutter)) {
                output = positions[i].target;
            }
        }

        // Return first item if any is returned from looping above
        if (!output) output = positions[0].target;

        return output;
    };

    var getAnchorsPosition = function() {
        var positions = [];

        // Gera um array com as ncoras e suas respectivas posies
        Array.prototype.forEach.call($.items, function(el, index) {
            var anchor = el.getAttribute('href');
            var anchorElement;
            var anchorPosition;

            if (!validAnchor(anchor)) return;

            anchorElement = document.querySelector(anchor);
            anchorPosition = anchorElement.offsetTop;

            positions[index] = {
                target: anchorElement,
                targetPos: anchorPosition - config.scrollAnchorGutter,
            };
        });

        return positions;
    };

    var setPined = function() {
        config.topPositionToFloat = $.quickMenu.offsetTop - parseFloat($.floater.style.top);
        if (config.scrollTopPosition() > config.topPositionToFloat) {
            $.quickMenu.classList.add(config.quickMenuPinedClass);
        } else {
            $.quickMenu.classList.remove(config.quickMenuPinedClass);
        }
    };

    // https://stackoverflow.com/questions/388996/regex-for-javascript-to-allow-only-alphanumeric/389022#389022
    var validAnchor = function(str) {
        var regex = new RegExp(/^[a-z0-9-_]+/);
        var id = str.substring(1);
        // 1: has # in first position (is an internal anchor)
        return str.indexOf('#') === 0 &&
            // 2: has more than 2 characters (is not an empty # link)
            str.length > 1 &&
            // 3: has an alphanumeric (with dashes or underscores) id
            regex.test(id);
    };

    return {
        init: init,
        getActiveItem: getActiveItem,
        setActiveItem: setActiveItem,
        getAnchorsPosition: getAnchorsPosition,
        validAnchor: validAnchor,
    };
}());

/**
 * Init QuickMenu Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function() {
    if (document.querySelectorAll('.bs-js-quick-menu-anchor').length) {
        BsQuickMenu.init();
    }
});

document.addEventListener('DOMContentLoaded', function () {

    var isIE = /*@cc_on!@*/false || !!document.documentMode;

    if (isIE) {
        if (document.querySelectorAll('.bs-news__meta').length) {
            var news_info = document.getElementsByClassName('bs-media__meta');
                        
            Array.prototype.forEach.call(news_info, function (elem) {
                if (elem.parentNode.nodeName == "ASIDE") {
                    var parent_elem = elem.parentNode;
                    var social_node = parent_elem.getElementsByClassName('bs-social__list');
                    var social_elem;
    
                    Array.prototype.forEach.call(social_node, function (elem) {
                        social_elem = elem
                    });
    
                    setTimeout(function() {
                        parent_elem.removeChild(elem);
                        parent_elem.removeChild(social_elem)
                        parent_elem.appendChild(elem);
                        parent_elem.appendChild(social_elem);
                    },2000);
                }
                
            });
        }
    }
});
/**
 * Overflow Menu
 */
var BsOverflowMenu = (function () {
  // Config
  var config = {
    buttons: {
      trigger: document.querySelectorAll('.bs-js-trigger-overflow-menu'),
    },
    classes: {
      open: 'bs-overflow-menu--open',
      overflowMenu: 'bs-overflow-menu',
    },
  };

  var init = function () {
    // Abre/fecha o Overflow Menu
    if (config.buttons.trigger) {
      Array.prototype.forEach.call(config.buttons.trigger, function (button) {
        button.addEventListener('click', function (e) {
          e.stopPropagation();
          toggleoverflowMenu(button);
        });
      });
    }
  };

  var toggleoverflowMenu = function (button) {
    var isOpen = button.parentNode.querySelector('.' + config.classes.overflowMenu).classList.contains(config.classes.open);

    if (isOpen)closeoverflowMenu(button);
    else openoverflowMenu(button);
  };

  var openoverflowMenu = function (button) {
    closeAlloverflowMenu();
    button.parentNode.querySelector('.' + config.classes.overflowMenu).classList.add(config.classes.open);
  };

  var closeoverflowMenu = function (button) {
    button.parentNode.querySelector('.' + config.classes.overflowMenu).classList.remove(config.classes.open);
  };

  var closeAlloverflowMenu = function () {
    Array.prototype.forEach.call(document.querySelectorAll('.' + config.classes.open), function (overflowMenu) {
      overflowMenu.classList.remove(config.classes.open);
    });
  };

  // Close menu on click outside
  document.querySelector('html').addEventListener('click', function () {
    closeAlloverflowMenu();
  });
  
  // Close menu on press ESC
  document.onkeydown = function(evt) {
    evt = evt || window.event;
    if (evt.keyCode == 27) closeAlloverflowMenu();
  };

  return {
    init: init,
    closeAlloverflowMenu: closeAlloverflowMenu,
  };
}());

/**
 * Init BsOverflowMenu constructor
 * @return {void} BsOverflowMenu.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-overflow-menu').length) {
    BsOverflowMenu.init();
  }
});

var BsSnackProgress = function () {
  // Config List and Select
  var config = {
    el: {
      snack: null,
      progress: null,
      progressText: null,
      progressBar: null,
      progressValue: null,
      progressLink: null,
      progressCancel: null,
      progressButtons: null,
    },
    classes: {
      snack: 'bs-snackbar--progress',
      progress: 'bs-progress',
      progressText: 'bs-progress__text',
      progressBar: 'bs-progress__bar',
      progressValue: 'bs-progress__value',
      progressLink: 'bs-progress__link',
      progressCancel: 'bs-progress__cancel',
      progressButtons: 'bs-progress__actions',
      visible: 'bs-snackbar--visible',
    },
    state: {
      progress: '0%',
      message: 'Baixando',
    },
    events: {
      link: function () {},
      cancel: function () {},
    },
  };

  var init = function () {
    buildSnack();
    buildProgress();
    config.el.snack.appendChild(config.el.progress);
    document.body.appendChild(config.el.snack);
  };

  var buildProgress = function () {
    config.el.progress = document.createElement('div');
    config.el.progressText = document.createElement('span');
    config.el.progressBar = document.createElement('span');
    config.el.progressValue = document.createElement('span');
    config.el.progressButtons = document.createElement('span');
    config.el.progressLink = document.createElement('button');
    config.el.progressCancel = document.createElement('button');

    config.el.progress.classList.add(config.classes.progress);
    config.el.progressText.classList.add(config.classes.progressText);
    config.el.progressBar.classList.add(config.classes.progressBar);
    config.el.progressValue.classList.add(config.classes.progressValue);
    config.el.progressButtons.classList.add(config.classes.progressButtons);
    config.el.progressLink.classList.add(config.classes.progressLink);
    config.el.progressCancel.classList.add(config.classes.progressCancel);

    config.el.progressText.innerHTML = config.state.message;
    config.el.progressValue.innerHTML = config.state.progress;

    config.el.progressLink.type = 'button';

    config.el.progressCancel.type = 'button';
    config.el.progressCancel.title = 'Cancelar';
    config.el.progressCancel.innerHTML = '<i class="icon-nav-fechar"></i>';
    config.el.progressCancel.addEventListener('click', function () {
      setProgress();
      hide(0);
    });

    config.el.progressButtons.appendChild(config.el.progressLink);
    config.el.progressButtons.appendChild(config.el.progressCancel);

    config.el.progress.appendChild(config.el.progressText);
    config.el.progress.appendChild(config.el.progressBar);
    config.el.progress.appendChild(config.el.progressValue);
    config.el.progress.appendChild(config.el.progressButtons);
  };

  var buildSnack = function () {
    config.el.snack = document.createElement('div');
    config.el.snack.className = 'bs-snackbar bs-snackbar--progress bs-snackbar--align-left bs-snackbar--alert';
    config.el.snack.setAttribute('role', 'alert');
    config.el.snack.setAttribute('data-snackbar-id', 'bs-downloads-progress');
  };

  var show = function () {
    if (config.el && config.el.snack) config.el.snack.classList.add(config.classes.visible);
  };

  var hide = function () {
    if (config.el && config.el.snack) config.el.snack.classList.remove(config.classes.visible);
  };

  /**
   * Set a new progress to snackbar
   * @param  {Number|String} progress  a numeric value for progress or a string
   * @param  {String}        message   a text to describe the state of progress
   * @return {Void}
   */
  var setProgress = function (progress, message) {
    // Update if progress is a different number of current in state
    if (typeof progress === 'number' && config.state.progress !== progress) {
      config.state.progress = progress + '%';
      config.el.progressValue.innerHTML = config.state.progress;
      config.el.progressBar.style.width = config.state.progress;
    } else if (!progress) {
      config.el.progressBar.style.width = 0;
      config.el.progressValue.innerHTML = '';
    }

    // Update innerHTML of progressValue if progress is a string
    // It's useful to add a loadings component or custom links in lieu of a
    // numeric value on the right of the snackbar
    if (progress instanceof Element) {
      config.el.progressValue.innerHTML = '';
      config.el.progressValue.appendChild(progress);
      config.el.progressBar.style.width = 0;
    }

    // Update if message is a different string of current in state
    if (typeof message === 'string' && config.state.message !== message) {
      config.state.message = message;
      config.el.progressText.innerHTML = message;
    }
  };

  var addButton = function (iconClass, message, cb) {
    if (
      typeof iconClass !== 'undefined' &&
      typeof message !== 'undefined' &&
      typeof cb === 'function') {
      config.events.link = cb;
      config.el.progressLink.innerHTML = '<i class="' + iconClass + '"></i>';
      config.el.progressLink.title = message;
      config.el.progressLink.addEventListener('click', config.events.link);
      return config.el.progressLink;
    }

    // throw new Error('all arguments are required.');
  };

  var removeButton = function () {
    if (config.el && config.el.progressLink) {
      config.el.progressLink.innerHTML = '';
      config.el.progressLink.removeEventListener('click', config.events.link);
    }
  };

  var onCancel = function (cb) {
    if (typeof cb !== 'function') cb = function () {};
    config.el.progressCancel.addEventListener('click', cb);
  };

  return {
    init: init,
    show: show,
    hide: hide,
    setProgress: setProgress,
    activeButton: addButton,
    disableButton: removeButton,
    onCancel: onCancel,
    elements: config.el,
  };
};


/**
 * Init BsSnackbar constructor
 * @return {void} BsSnackbar.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  // window.progress = new BsSnackProgress()
  // progress.init();
  // progress.show();
});

/**
 * Bs Carousel
 */
var BsCarousel = (function () {

  var config = {
    carouselDefault: document.querySelectorAll('.bs-quick-menu:not(.bs-quick-menu--icon) .bs-js-carousel'),
    carouselBox: document.querySelector('.bs-quick-menu__box'),
    paddingBox: 25,
    overPrev: 'bs-quick-menu--over-prev',
    overNext: 'bs-quick-menu--over-next',
    prevNextButtons: 'bs-quick-menu--active-button',
    prevPrev: document.querySelector('.bs-quick-menu__actions--button-prev'),
    prevNext: document.querySelector('.bs-quick-menu__actions--button-next'),
  }

  var init = function () {
    // aguarda load dos scripts
    debounce(buildMenu());
  };

  var buildMenu = function () {
    Array.prototype.forEach.call(config.carouselDefault, function (el) {

      var item = el.querySelectorAll('.bs-quick-menu__item');
      var flkty;

      // !!- SET DE CONFIGURAO PADRO
      var flickityOptionsDefaults = {
        contain: true,
        prevNextButtons: false,
        cellAlign: 'left',
        groupCells: true,
        pageDots: true,
        draggable: true,
        percentPosition: false,
        watchCSS: true,
        adaptiveHeight: true,
        selectedAttraction: 0.015,
        friction: 0.15,
      };

      // - evita que o flickty adicione uma largura maior para os visiveis
      setTimeout(function () {
        Array.prototype.forEach.call(item, function (elItem) {
          elItem.style.minWidth = elItem.offsetWidth + 'px'; // Fix IE 11 - only work
          elItem.style.width = elItem.offsetWidth + 'px';
        });
      }, 300);

      // remonta a posio dos items e evita quebra
      setTimeout(function () {
        var interval = null
        
        // - Executa e Aplica Set de configuraes
        flkty = new Flickity(el, flickityOptionsDefaults);
        
        window.addEventListener('resize', function () {
          clearTimeout(interval)
          interval = setTimeout(function () {
            Array.prototype.forEach.call(item, function (elItem) { 
              resizeCell(elItem)
            });
            flkty.reloadCells();
          }, 300)
        });
        
        var flickityView = el.querySelector('.flickity-viewport');

        // only apply class relative INIT navitgation
        if (flickityView) {
          var carouselBoxParent = flickityView.parentNode.parentNode;
          carouselBoxParent.classList.add(config.overNext);
  
        }
        
        
        flkty.reloadCells();

      }, 300);
    });
  }

  var resizeCell = function (el) {
    el.style.minWidth = 'initial';
    el.style.width = 'initial';
  };

  return {
    init: init,
  };
}());

/**
 * Init
 */
document.addEventListener('DOMContentLoaded', function () {
  var carouselDefault = document.querySelectorAll('.bs-quick-menu:not(.bs-quick-menu--icon) .bs-js-carousel');
  if (carouselDefault.length) {
    Array.prototype.forEach.call(carouselDefault, function (el) {
      BsCarousel.init(el);
    })
  }
});

/**
 * Bs Carousel Icons
 */
var BsCarouselIcons = (function () {

  var config = {
    carouselIcons: document.querySelectorAll('.bs-quick-menu--icon .bs-js-carousel'),
    carouselBox: document.querySelector('.bs-quick-menu__box'),
    overPrev: 'bs-quick-menu--over-prev',
    overNext: 'bs-quick-menu--over-next',
    boxSlider: '',
    boxViewport: '',
    boxViewportItem: '',
    boxNew: '',
    boxSliderClone: '',
    offSet: '',
    boxItem: '',
    totalReduce: '',
    boxSize: '',
    totalIndex: '',
    calcPerc: '',
    parent: '',
    viewMod: '',
  };


  var init = function () {

    // evita bug de renderizao
    setTimeout (function () {

      window.addEventListener("resize", function() {
        getMenu();
      });

      // return menu default configuration
      getMenu();

    }, 400);


  };

  var getMenu = function () {

    Array.prototype.forEach.call(config.carouselIcons, function (elem) {

      // !!- SET DE CONFIGURAO PADRO
      var flickityOptions = {
        contain: true,
        prevNextButtons: false,
        cellAlign: 'left',
        draggable: true,
      };
      flickityOptionsFalse = {
        contain: true,
        prevNextButtons: false,
        cellAlign: 'left',
        draggable: false,
      };

      var carouselBox = elem.parentNode.closest('.bs-quick-menu__box');

      // the new selector parent
      config.boxNew = elem;
      config.offSet = config.boxNew.offsetWidth;

      // parent items
      config.boxItem = config.boxNew.querySelectorAll('.bs-quick-menu__item');

      config.totalReduce = Array.prototype.reduce.call(config.boxItem, function (i, el) {
        var i = i + el.offsetWidth;
        return i;
      }, 0);

      // init flickty
      var flkty = new Flickity( elem, flickityOptions );

      // if flickity get box slider
      config.boxSlider = elem.querySelector('.flickity-slider');

      config.boxSize = config.offSet;

      Array.prototype.forEach.call(config.boxItem, function (el) {

        // if total items less max box
        if (config.totalReduce < config.boxSize) {
          // debugger
          // calculate width real
          el.style.width = '100%';
          el.style.position = 'initial';

          // apply to parent modifiers
          config.parent = el.parentNode;
          config.parent.style.display = 'flex';
          config.parent.style.transform = '';

          // reinitiate flickity, to resize items with bug
          flkty.destroy();
          // flkty = new Flickity( config.carouselIcons, flickityOptionsFalse);
        } else {
          // debugger
          el.style.width = '';
          el.style.position = 'absolute';
          // apply to parent modifiers
          config.parent = el.parentNode;
          config.parent.style.display = '';
          // class active over effect more items right side
          carouselBox.classList.add(config.overNext);

          // reinitiate flickity, to resize items with bug
          flkty.destroy();
          // debugger
          flkty = new Flickity( elem, flickityOptions);
        }
      });

      flkty.on('select', function () {

        // class add or remove effect over in position initial
        if (!flkty.cells[flkty.selectedIndex - 1]) {

          carouselBox.classList.remove(config.overPrev);
          carouselBox.classList.add(config.overNext);

          // class add or remove effect over in position final
        } else if(!flkty.cells[flkty.cells.length]) {

          carouselBox.classList.add(config.overPrev);

          // class add or remove effect over in middle position to items big than sides
          if (flkty.selectedIndex === (flkty.pageDots.dots.length - 1)) {
            carouselBox.classList.remove(config.overNext);
          } else {
            carouselBox.classList.add(config.overNext);
          }
        }
      });
    });
  };

  return {
    init: init,
  };
}());

/**
 * Init Mural Constructor
 */
document.addEventListener('DOMContentLoaded', function () {
  var carouselIcons = document.querySelectorAll('.bs-quick-menu--icon .bs-js-carousel');
  if (carouselIcons.length) {
    Array.prototype.forEach.call(carouselIcons, function (el) {
      BsCarouselIcons.init(el);
    })
  }
});

/**
 * Bs QuickMenu (anchor)
 *
 * TODO:
 * 1. Esconder (translate:-100%) menu fixo quando passar
 * da ltima seo da pgina (geralmente, sobre o footer) e
 * voltar a mostrar quando subir a pgina novamente;
 *
 * 2. Calcular a velocidade do smooth scroll relativo  posio
 * da seo, para que a animao do scroll leve sempre o
 * mesmo tempo. Ex: levar o mesmo tempo para scrollar da
 * seo 1 para 2 e da 1 para a ltima.
 *
 * 3. Quando o scroll vai de baixo para cima, por conta do Header
 * ficar visvel, o menu acaba ficando sobre o ttulo. Precisa
 * descontar o tamanho do header da posio alvo da ncora.
 */
var BsQuickMenu = (function() {
    // Elements
    var elements = {};
    var $ = elements;
    $.body = document.querySelector('body');
    $.quickMenu = document.querySelector('.bs-js-quick-menu-anchor');

    if (!$.quickMenu) return;

    $.floater = $.quickMenu.querySelector('.bs-quick-menu__wrapper');
    $.list = $.quickMenu.querySelector('.bs-quick-menu__list');
    $.toggle = $.quickMenu.querySelector('.bs-quick-menu__toggle');
    $.items = $.list.querySelectorAll('.bs-quick-menu__link');


    // Config
    var config = {
        quickMenuActive: false,
        quickMenuActiveClass: 'bs-quick-menu--open',
        quickMenuPinedClass: 'bs-quick-menu--pined',
        itemActiveClass: 'bs-quick-menu__link--active',
        scrollTopPosition: function() {
            return window.pageYOffset || document.documentElement.scrollTop;
        },
        topPositionToFloat: 0,
        scrollDirection: 0,
        lastScrollTop: 0,
        smoothScrollSteps: 25,
        scrollAnchorGutter: 80,
        anchorSelector: 'section',
        lastSelectedAnchor: null
    };

    var init = function() {
        // Toggle quickMenu
        if ($.toggle) $.toggle.addEventListener('click', toggleQuickMenu);

        // Close quickMenu on click outside
        Array.prototype.forEach.call(document.querySelectorAll('body, html'), function(el) {
            el.addEventListener('click', function(event) {
                if (
                    quickMenuActive() &&
                    !$.quickMenu.contains(event.target) &&
                    !$.toggle.contains(event.target)) {
                    closeQuickMenu();
                    return false;
                }
            });
        });

        // Close header on click outside
        window.addEventListener('scroll', function() {
            // Fixa o menu no topo da viewport
            setPined();

            // Exibe o menu abaixo do header quando este est visvel
            if (!BsHeader.isFloating() || BsHeader.el.classList.contains(BsHeader.headerPinned)) {
                $.floater.style.top = BsHeader.el.offsetHeight + 'px';
            } else {
                $.floater.style.top = 0;
            }

            // Ativa o item de acordo com o scroll
            setActiveItem(getActiveItem());
        });

        // Click menu anchors
        Array.prototype.forEach.call($.items, function(el) {
            var hash = el.getAttribute('href');
            el.addEventListener('click', function(event) {
                // Previne o clique se o hash for uma ncora vlida
                if (validAnchor(hash)) event.preventDefault();
                // Retorna se for invlida (mantm o clique padro)
                else return;

                // Retorna se no existe uma ncora na pgina (ID) referente ao hash do item
                if (!document.querySelector(hash)) return;

                // Chama a funo para rolar a pgina at a ncora
                gotoAnchor(el);
            });
        });
    };

    var toggleQuickMenu = function() {
        if (!quickMenuActive()) openQuickMenu();
        else closeQuickMenu();
    };

    var openQuickMenu = function() {
        $.quickMenu.classList.add(config.quickMenuActiveClass);
    };

    var closeQuickMenu = function() {
        $.quickMenu.classList.remove(config.quickMenuActiveClass);
    };

    var quickMenuActive = function() {
        return $.quickMenu.classList.contains(config.quickMenuActiveClass);
    };

    var gotoAnchor = function(el) {
        var anchor = el.getAttribute('href');
        var anchorElement = document.querySelector(anchor);
        var anchorPosition = anchorElement.offsetTop;
        var interval = 0;
        var scrollDown = function() {
            window.scrollTo(0, config.scrollTopPosition() + config.smoothScrollSteps);
            if (config.scrollTopPosition() > (anchorPosition - config.scrollAnchorGutter)) {
                clearInterval(interval);
            }
        };
        var scrollUp = function() {
            window.scrollTo(0, config.scrollTopPosition() - config.smoothScrollSteps);
            if (config.scrollTopPosition() < (anchorPosition - config.scrollAnchorGutter)) {
                clearInterval(interval);
            }
        };

        // Fecha a lista do menu
        closeQuickMenu();

        // Scrolla at a ncora do item clicado
        // Se a ncora est abaixo da posio atual da pgina
        if (config.scrollTopPosition() < anchorPosition) {
            interval = window.setInterval(scrollDown, 2);
            // Se a ncora est acima da posio atual da pgina
        } else if (config.scrollTopPosition() > anchorPosition) {
            interval = window.setInterval(scrollUp, 2);
        }
    };

    var setActiveItem = function(anchor) {
        // console.log(anchor);

        if (anchor === config.lastSelectedAnchor) return;
        else config.lastSelectedAnchor = anchor;

        var anchorHash = '#' + anchor.getAttribute('id');
        var menuItem = $.list.querySelector('[href="' + anchorHash + '"]');
        var title = menuItem.textContent;

        // debugger;


        // Desativa item ativo atualmente
        if ($.list.querySelector('.' + config.itemActiveClass)) {
            $.list.querySelector('.' + config.itemActiveClass).classList.remove(config.itemActiveClass);
        }

        // Ativa o item de acordo com a posio atual
        menuItem.classList.add(config.itemActiveClass);

        // Altera o texto do boto de toggle com o ttulo do item clicado
        $.toggle.innerText = title.toString();

        // Altera o hash da URL com o hash da ncora clicada
        history.replaceState(undefined, undefined, anchorHash);
    };

    var getActiveItem = function() {
        var positions = getAnchorsPosition();
        var scroll = config.scrollTopPosition();
        var i = 0;
        var length = positions.length;
        var output = 0;

        // Return active element by offsetTop position
        for (; i < length; i += 1) {
            if (scroll >= (positions[i].targetPos - config.scrollAnchorGutter)) {
                output = positions[i].target;
            }
        }

        // Return first item if any is returned from looping above
        if (!output) output = positions[0].target;

        return output;
    };

    var getAnchorsPosition = function() {
        var positions = [];

        // Gera um array com as ncoras e suas respectivas posies
        Array.prototype.forEach.call($.items, function(el, index) {
            var anchor = el.getAttribute('href');
            var anchorElement;
            var anchorPosition;

            if (!validAnchor(anchor)) return;

            anchorElement = document.querySelector(anchor);
            anchorPosition = anchorElement.offsetTop;

            positions[index] = {
                target: anchorElement,
                targetPos: anchorPosition - config.scrollAnchorGutter,
            };
        });

        return positions;
    };

    var setPined = function() {
        config.topPositionToFloat = $.quickMenu.offsetTop - parseFloat($.floater.style.top);
        if (config.scrollTopPosition() > config.topPositionToFloat) {
            $.quickMenu.classList.add(config.quickMenuPinedClass);
        } else {
            $.quickMenu.classList.remove(config.quickMenuPinedClass);
        }
    };

    // https://stackoverflow.com/questions/388996/regex-for-javascript-to-allow-only-alphanumeric/389022#389022
    var validAnchor = function(str) {
        var regex = new RegExp(/^[a-z0-9-_]+/);
        var id = str.substring(1);
        // 1: has # in first position (is an internal anchor)
        return str.indexOf('#') === 0 &&
            // 2: has more than 2 characters (is not an empty # link)
            str.length > 1 &&
            // 3: has an alphanumeric (with dashes or underscores) id
            regex.test(id);
    };

    return {
        init: init,
        getActiveItem: getActiveItem,
        setActiveItem: setActiveItem,
        getAnchorsPosition: getAnchorsPosition,
        validAnchor: validAnchor,
    };
}());

/**
 * Init QuickMenu Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function() {
    if (document.querySelectorAll('.bs-js-quick-menu-anchor').length) {
        BsQuickMenu.init();
    }
});

/**
 * Menu com Dropdown
 */
var BsMd = (function () {
  // Config
  var config = {
    buttons: {
      back: document.querySelectorAll('.bs-md__back'),
      item: document.querySelectorAll('.bs-md__menu .bs-md__item'),
      triggerMenu: document.querySelectorAll('.bs-js-md-trigger-menu'),
    },
    classes: {
      itemSubmenuOpen: 'bs-md__item--sub-open',
      menuOpen: 'bs-md__menu--open',
      sortable: 'bs-md__menu--sortable',
      subSubmenuOpen: 'bs-md__menu--sub-open',
      triggerMenuActive: 'bs-md__item--active',
    },
    container: document.querySelector('.bs-md'),
    menu: document.querySelectorAll('.bs-md__menu'),
    wrapper: document.querySelector('.bs-md__wrapper'),
    sortable: document.querySelectorAll('.bs-md__menu.bs-md__menu--sortable'),
  };

  var init = function () {
    // var flickityOptionsDefaults = {
    //   contain: true,
    //   prevNextButtons: false,
    //   pageDots: false,
    //   cellAlign: 'left',
    //   groupCells: true,
    //   watchCSS: false,
    // };
    // // - Executa e Aplica Set de configuraes
    // var flkty = new Flickity( config.wrapper, flickityOptionsDefaults );

    // Recalcula o posicionamento do menu
    setTimeout(function () {
      _calcSubmenuPosition();
    }, 500);

    window.addEventListener('resize', function () {
      _calcSubmenuPosition();
    });

    window.addEventListener('scroll', function () {
      _closeAllMenus();
    });

    config.container.addEventListener('scroll', function () {
      _closeAllMenus();
    });

    _initShadow();

    if (config.buttons.triggerMenu) {
      Array.prototype.forEach.call(config.buttons.triggerMenu, function (button) {
        button.addEventListener('click', function (event) {
          event.preventDefault();
          _calcSubmenuPosition();

          var menu = button.querySelector('.bs-md__menu');
          var isMenuOpen = (menu.classList.contains(config.classes.menuOpen)) === true;

          if (isMenuOpen && menu) {
            _closeMenu(menu);
          } else {
            _closeAllMenus();
            _openMenu(menu);
          }
        });
      });
    }

    if (config.buttons.item) {
      Array.prototype.forEach.call(config.buttons.item, function (button) {
        var submenu = button.querySelector('.bs-md__submenu');

        if (submenu) {
          button.addEventListener('click', function (event) {
            event.stopPropagation();
            var parentMenu = button.parentNode;

            parentMenu.classList.add(config.classes.subSubmenuOpen);
            button.classList.add(config.classes.itemSubmenuOpen);
          });
        }
      });
    }

    if (config.buttons.back) {
      Array.prototype.forEach.call(config.buttons.back, function (button) {
        button.addEventListener('click', function (event) {
          event.stopPropagation();
          event.preventDefault();

          var menuItem = getParents(button, config.classes.itemSubmenuOpen, true)[0];
          var menu = getParents(button, config.classes.subSubmenuOpen, true)[0];

          if (menuItem) {
            menuItem.classList.remove(config.classes.itemSubmenuOpen);
            menu.classList.remove(config.classes.subSubmenuOpen);
          }
        });
      });
    }

    if (config.sortable) {
      Array.prototype.forEach.call(config.sortable, function (menu) {
        dragula([menu], {
          moves: function (el, source, handle, sibling) {
            return (!el.classList.contains('bs-md__favorite')) && true;
          },
        });
      });


    }

    // Fecha o menu quando clicar fora dele
    Array.prototype.forEach.call(document.querySelectorAll('body, html'), function (element) {
      element.addEventListener('click', function (event) {
        var parentMenu = getParent(event.target, 'bs-md__wrapper');
        if (!parentMenu) {
          _closeAllMenus();
          return false;
        }
      });
    });
  };

  // Calcula a posio em que o submenu deve abrir
  var _calcSubmenuPosition = function () {
    var menus = config.menu;

    Array.prototype.forEach.call(menus, function (menu) {
      var left = menu.parentNode.getBoundingClientRect().left;
      var top = menu.parentNode.getBoundingClientRect().bottom;

      if (window.innerWidth >= 576) {
        menu.style.left = left + 'px';
      } else {
        // No mobile o menu  100%, ento no deve ser setado a posio left
        menu.style.removeProperty('left');
      }
      menu.style.top = top + 'px';
    });
  };

  var _openMenu = function (menu) {
    menu.parentNode.classList.add(config.classes.triggerMenuActive);
    menu.classList.add(config.classes.menuOpen);
  };

  var _closeMenu = function (menu) {
    menu.parentNode.classList.remove(config.classes.triggerMenuActive);
    menu.classList.remove(config.classes.menuOpen);
  };

  var _closeAllMenus = function () {
    var openedMenus = document.querySelectorAll('.' + config.classes.menuOpen);
    var openedSubmenus = document.querySelectorAll('.' + config.classes.subSubmenuOpen);
    var openedItems = document.querySelectorAll('.' + config.classes.itemSubmenuOpen);

    Array.prototype.forEach.call(openedMenus, function (menu) {
      menu.classList.remove(config.classes.menuOpen);
      menu.parentNode.classList.remove(config.classes.triggerMenuActive);
    });

    Array.prototype.forEach.call(openedSubmenus, function (submenu) {
      submenu.classList.remove(config.classes.subSubmenuOpen);
    });

    Array.prototype.forEach.call(openedItems, function (item) {
      item.classList.remove(config.classes.itemSubmenuOpen);
    });
  };

  var _initShadow = function () {
    var shadowStart = document.querySelector('.bs-md__shadow--start');
    var shadowEnd = document.querySelector('.bs-md__shadow--end');

    /**
     * Define se as sombras devem estar visveis
     * https://markus.oberlehner.net/blog/building-a-responsive-priority-plus-horizontal-scroll-navigation/
    */
    function handleShadowVisibility() {
      var maxScrollStartReached = config.wrapper.scrollLeft <= 0;
      var maxScrollEndReached =
        config.wrapper.scrollLeft >= config.wrapper.scrollWidth - config.wrapper.offsetWidth - 5;

      toggleShadow(shadowStart, maxScrollStartReached);
      toggleShadow(shadowEnd, maxScrollEndReached);
    }

    /**
     * Exibe/oculta as sombras
     * @param {Element} el sombra
     * @param {Boolean} maxScrollReached atingiu o limite do scroll (incio ou fim)
    */
    function toggleShadow(el, maxScrollReached) {
      var shadowIsVisible = el.classList.contains('is-visible');
      var showShadow = !maxScrollReached && !shadowIsVisible;
      var hideShadow = maxScrollReached && shadowIsVisible;

      // Using requestAnimationFrame for optimal scroll performance.
      // https://stackoverflow.com/a/44779316
      if (showShadow) {
        window.requestAnimationFrame(function () { el.classList.add('is-visible'); });
      } else if (hideShadow) {
        window.requestAnimationFrame(function () { el.classList.remove('is-visible'); });
      }
    }

    config.wrapper.addEventListener('scroll', function () {
      handleShadowVisibility();
    });

    handleShadowVisibility();
  };

  return {
    init: init,
  };
}());

/**
 * Init Menu com Dropdown
 * @return {void} BsMd.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-md').length) {
    BsMd.init();
  }
});


/**
 * Radio
 * https://github.com/material-components/material-components-web/tree/master/packages/mdc-snackbar
 */
var BsRadio = (function () {
  // Config
  var buttonRadio = document.querySelector('.bs-js-radio');

  var init = function () {
    buttonRadio.addEventListener('click', openPopUp.bind(this, 'radio.html'));
  };

  var openPopUp = function(url) {
    window.open(url, '_blank', 'height=140,location=yes,width=400,scrollbars=no,status=yes');
  }

  return {
    init: init
  };
}());

/**
 * Init BsRadio constructor
 * @return {void} BsRadio.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-js-radio').length) {
    BsRadio.init();
  }
});

/**
 * Bs Search Empty 404
 *
 */

var BsSearchEmpty = (function () {
  // Config
  var config = {
    tag: document.querySelectorAll('.bs-search-empty__tag'),
    items: [],
    randomItem: '',
  };

  var init = function () {

    Array.prototype.forEach.call(config.tag, function (el) {
      config.items.push(el.textContent);
    });
    random();
  };

  var random = function () {
    randomItem = config.items[Math.floor(Math.random() * config.items.length )]; 

    Array.prototype.forEach.call(config.tag, function (el) {
      var tagContent = el.textContent;

      if (randomItem !== tagContent) {
        el.remove();
      };
    });
  };

  return {
    init: init
  };
}());

/**
 * Init Search Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-search-empty__tag').length) {
    BsSearchEmpty.init();
  }
});

/**
 * Bs Search
 *
 * [TODO]: Refatorar para que os elementos do config referenciem um componente
 * search especfico ao invs de pegar todos os existentes no documento.
 */
var BsSearchForm = (function () {
  // Config
  var config = {
    html: document.querySelectorAll('body, html'),
    header: document.querySelector('.bs-header'),
    search: document.querySelector('.bs-search'),
    searchInput: document.querySelector('.bs-js-search-input'),
    searchOpen: document.querySelector('.bs-js-open-search'),
    searchClose: document.querySelector('.bs-js-close-search'),
    searchToggle: document.querySelector('.bs-js-toggle-search'),
    searchIsOpen: false,
    searchIsOpenClass: 'bs-search--open',
    headerSearchOpenClass: 'bs-header--search-is-open',
  };

  // var $ = config;

  var init = function () {
    // Return if not exists search component
    if (!config.search) return;

    // Open suggestions on search input focus
    if (config.searchInput) {
      config.searchInput.addEventListener('focus', function () {
        // BsSearchSuggestions.open();
      });
    }

    loadSearchSuggestions();

    // Toggle search
    if (config.searchToggle) config.searchToggle.addEventListener('click', toggleSearch);

    // Open search
    if (config.searchOpen) config.searchOpen.addEventListener('click', openSearch);

    // Close search
    if (config.searchClose) config.searchClose.addEventListener('click', closeSearch);

    // Close search on click outside
    Array.prototype.forEach.call(config.html, function (el) {
    // document.querySelectorAll('body, html').forEach(function (el) {
      el.addEventListener('click', function (event) {
        if (
          searchIsOpen() &&
          !config.search.contains(event.target) &&
          !config.searchToggle.contains(event.target)) {
          closeSearch();
          return false;
        }
      });
    });
  };

  var toggleSearch = function () {
    if (!searchIsOpen()) openSearch();
    else closeSearch();
  };

  var openSearch = function () {
    if (config.search) {
      config.search.classList.add(config.searchIsOpenClass);
      config.header.classList.add(config.headerSearchOpenClass);
      BsHeader.setHeaderFloating(true);
      toggleBodyOverflowHidden();
    }
  };

  var closeSearch = function () {
    if (config.search) {
      config.search.classList.remove(config.searchIsOpenClass);
      config.header.classList.remove(config.headerSearchOpenClass);
      toggleBodyOverflowHidden();
    }
  };

  var searchIsOpen = function () {
    if (!config.search) return false;
    return config.search.classList.contains(config.searchIsOpenClass);
  };

  var searchHasFocus = function () {
    return document.activeElement === config.searchInput;
  };

  var loadSearchSuggestions = function () {
    var suggestions = document.querySelectorAll('.bs-js-search-suggestions');
    config.suggestions = [];

    if (suggestions && suggestions.length) {
      Array.prototype.forEach.call(suggestions, function (el) {
        var suggestion = new BsSearchSuggestions(el, {
          contentClasses: [
            'bs-search-suggestions__term',
            'bs-search-suggestions__location',
          ],
          maxItems: 8,
          defaultTitle: 'Mais Buscados',
          defaultList: [
            {
              link: '#!',
              content: [
                'Lorem ipsum dolor sit amet',
                'irure dolor',
              ],
            },
            {
              link: '#!',
              content: [
                'consectetur adipisicing elit',
                'in reprehenderit',
              ],
            },
            {
              link: '#!',
              content: [
                'sed do eiusmod tempor incididunt',
                'voluptate velit',
              ],
            },
            {
              link: '#!',
              content: [
                'ut labore et dolore magna aliqua',
                'esse cillum dolore',
              ],
            },
            {
              link: '#!',
              content: [
                'Ut enim ad minim veniam',
                'eu fugiat nulla',
              ],
            },
            {
              link: '#!',
              content: [
                'quis nostrud exercitation ullamco',
                'excepteur sint occaecat',
              ],
            },
            {
              link: '#!',
              content: [
                'laboris nisi ut aliquip ex ea',
                'cupidatat non proident',
              ],
            },
            {
              link: '#!',
              content: [
                'commodo consequat. Duis aute',
                'qui officia deserunt',
              ],
            },
          ],
          suggestionsList: [
            {
              link: '#!',
              content: [
                'Lorem ipsum dolor sit amet',
                'irure dolor',
              ],
            },
            {
              link: '#!',
              content: [
                'consectetur adipisicing elit',
                'in reprehenderit',
              ],
            },
            {
              link: '#!',
              content: [
                'sed do eiusmod tempor incididunt',
                'voluptate velit',
              ],
            },
            {
              link: '#!',
              content: [
                'ut labore et dolore magna aliqua',
                'esse cillum dolore',
              ],
            },
            {
              link: '#!',
              content: [
                'Ut enim ad minim veniam',
                'eu fugiat nulla',
              ],
            },
            {
              link: '#!',
              content: [
                'quis nostrud exercitation ullamco',
                'excepteur sint occaecat',
              ],
            },
            {
              link: '#!',
              content: [
                'laboris nisi ut aliquip ex ea',
                'cupidatat non proident',
              ],
            },
            {
              link: '#!',
              content: [
                'commodo consequat. Duis aute',
                'qui officia deserunt',
              ],
            },
          ],
        });
        suggestion.init();
        config.suggestions.push(suggestion);
      });
    }
  }

  return {
    init: init,
    toggle: toggleSearch,
    open: openSearch,
    close: closeSearch,
    isOpen: searchIsOpen,
    hasFocus: searchHasFocus,
    isActive: searchIsOpen, // deprecated
  };
}());

/**
 * Init Search Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-search').length) {
    BsSearchForm.init();
  }
});

/**
 * ATIVAR o SEARCH aplicar na section a classe
 * --- bs-help-search -----
 * ADICIONAR MENSAGEM VAZIO dentro de section
 * ---- bs-help-search__search-empty ----
 * ORGANIZAR CD caso utilize
*/

var BsSerachHelp = (function() {

  var init = function() {
    /* Select the input where the keywords will be retrieved */
    var searchbox = document.getElementsByClassName('bs-help-search__input')[0];

    /* To every key pressed and released */
    searchbox.onkeyup = function () {
      /**
      * This will fix a simple problem: When the search input is empty after
      * trying to find a keyword, it selects all the elements and highlight
      */
      var keywords = searchbox.value.trim().length > 0 ? new RegExp(searchbox.value.trim(), "gi") : '';

      /* Define the postTitles where the search will run */
      //- var postTitles = document.getElementsByClassName('post__title');

      var selectList= document.querySelectorAll('.bs-media__item,.bs-accordion__item, bs-media__item');

      Array.prototype.forEach.call(selectList, function (el) {
        var valList = el //- Easier to read
        var attrText = valList.textContent;
        //- var attrTag = valList.getAttribute('data-filter-tag');
        //- var key = attrText.concat(attrTag)
        
        //-  If val atribute data-filter-tag equal key query
        if ((attrText.match(keywords)) && keywords !== '') {
          //- If the element don't have the active class, it will add one
          if (!valList.classList.contains('bs-help-search__highlight')) {
            valList.classList.remove('bs-help-search__remove-highlight');
            valList.classList.add('bs-help-search__highlight');
          }
        }
        //- Remove active and add remove from list 
        else {
          valList.classList.remove('bs-help-search__highlight');
          valList.classList.add('bs-help-search__remove-highlight');

          if (keywords === '') {
            valList.classList.remove('bs-help-search__remove-highlight');
          }
        }
      });

      // Capture all sections on the page
      var searchList = document.querySelectorAll('.bs-help-search');

      Array.prototype.forEach.call(searchList, function (e) {

        // if section belongs search for elements
        var activeFalse = e.getElementsByClassName('bs-help-search__highlight');
        var message = e.querySelector('.bs-help-search__search-empty');

        // if there is no active return while search returns active
        if (activeFalse.length < 1 && keywords !== '') {
          message.classList.add('bs-active');
          //- debugger 
        } else {
          message.classList.remove('bs-active');
        };

      });
    };
  };

  return {
    init: init
  };

})();

/**
 * Init QuickMenu Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function() {
  if (document.querySelectorAll('.bs-help-search').length) {
    BsSerachHelp.init();
  }
});
/**
 * Bs Search Suggestions
 * A list of suggestions terms to show when search input has focus
 *
 * @param  {string} element query of a DOM element
 * @param  {Object} options overwrite default config
 * @return {Function}
 */

var BsSearchSuggestions = function (element, options) {
  // Config
  var elem = element;
  var opt = (typeof options === 'object') ? options : {};
  var defaults = {
    // search input
    search: '.bs-js-search-input',
    // suggestions box
    suggestions: '.bs-js-search-suggestions',
    // suggestions list
    list: '.bs-search-suggestions__list',
    // class to set open suggestions
    suggestionsActiveClass: 'bs-search-suggestions--open',
    // class to add loading gif in list
    suggestionsLoadingClass: 'bs-search-suggestions--loading',
    // class of item
    listTitleClass: 'bs-search-suggestions__title',
    // class of item
    itemClass: 'bs-search-suggestions__item',
    // class to set an item as active, when selected by keyboard arrows up/down
    itemsActiveClass: 'bs-search-suggestions__item--active',
    // class of link
    itemLinkClass: 'bs-search-suggestions__link',
    // class of term
    itemTermClass: 'bs-search-suggestions__term',
    // class of term typed
    itemTermTypedClass: 'bs-search-suggestions__term-typed',
    // class of location
    itemLocationClass: 'bs-search-suggestions__location',
    // contentClasses
    contentClasses: [],
    // maximum limit of items in the list
    maxItems: 0,
    // stores the current active item
    currentActiveItem: '',
    // stores the search input value typed
    // the input value's change during keyboard arrows navigation, but need to
    // back to the value typed previously
    searchTerm: '',
    // set the update function that rebuild list on type
    // by default, uses the updateList() function
    updateList: function (list) {
      return updateList(list);
    },
    // default title
    // displayed when search input has focus but no value
    defaultTitle: '',
    // default list
    // displayed when search input has focus but no value
    defaultList: [],
    // title displayed within dinamic suggestion list
    suggestionsTitle: '',
    // list filtered and displayed during type on search input
    suggestionsList: [],
    onBuildList: function () {
      // console.log('list has builded');
    },
  };
  var config = {};

  var extend = function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  /**
   * Init the component
   * @param  {Object} options options for the content
   */
  var init = function () {
    // Define options
    config = extend({}, defaults, opt);

    window.addEventListener('scroll', function () {
      closeSuggestions();
    });

    // Previne que ao recarregar a pgina traga o valor do input preenchido
    if (detectIE()) {
      var searchInput = document.querySelector(config.search);
      if (searchInput) searchInput.value = '';
    }

    config.body = document.querySelectorAll('body, html');
    config.search = (typeof config.search === 'string') ? document.querySelector(config.search) : config.search;
    config.suggestions = (typeof elem === 'string') ? document.querySelector(elem) : elem;
    config.list = config.suggestions.querySelector(config.list);

    // Return if not exists search component
    if (!config.suggestions || !config.search) return;

    // set function to update list
    setCustomUpdate(config.suggestionsList);

    // Open suggestions
    if (config.search) config.search.addEventListener('focus', openSuggestions);

    // Close suggestions
    // Should close only in click outside
    // if (config.search) config.search.addEventListener('blur', closeSuggestions);

    // Build default list
    buildList();

    // Unselect items on search input blur
    if (config.search) config.search.addEventListener('blur', disableItemActive);

    // Close search on click outside
    Array.prototype.forEach.call(config.body, function (el) {
      el.addEventListener('click', function (event) {
        if (
          suggestionsIsOpen() &&
          !config.suggestions.contains(event.target) &&
          !config.search.contains(event.target)) {
          closeSuggestions();
          return false;
        }
      });
    });

    // On search input keyboard events
    document.addEventListener('keydown', function (event) {
      var keyUp = event.keyCode === 38;
      var keyDown = event.keyCode === 40;
      var keyTab = event.keyCode === 9;
      // var keyEnter = event.keyCode === 13;
      // var keyEsc = event.keyCode === 27;
      var items = config.list.querySelectorAll('.' + config.itemClass);
      var itemActive = getItemActive();
      var itemActiveIndex = (itemActive) ?
        Array.prototype.indexOf.call(items, itemActive) : -1;

      // Run only if search suggestions is open
      if (!suggestionsIsOpen() || !items.length) return;

      // If tab is pressed, Close suggestions on search input blur if focus's not
      // in suggestions's links
      if (keyTab && !searchHasFocus()) closeSuggestions();

      //
      // Select item on keyboard arrow up/down move
      //
      // If arrow up key is pressed
      if (keyUp) {
        event.preventDefault();
        // If has not an item active
        if (itemActiveIndex < 0) {
          // select the last item
          items[items.length - 1].classList.add(config.itemsActiveClass);
          config.search.value = getItemContent(items[items.length - 1]);
        // If has an item active and it's not the first item
        } else if (itemActiveIndex > 0) {
          // select the previous item
          itemActive.classList.remove(config.itemsActiveClass);
          items[itemActiveIndex - 1].classList.add(config.itemsActiveClass);
          config.search.value = getItemContent(items[itemActiveIndex - 1]);
        // If item active is the first item
        } else {
          // unselect item active
          itemActive.classList.remove(config.itemsActiveClass);
          config.search.value = config.searchTerm;
        }

        // Move the caret to the end of input's value
        // By default, browsers usually move the caret to start when arrow up is
        // pressed in a focused input
        config.search.setSelectionRange(config.search.value.length, config.search.value.length);
      // If arrow down key is pressed
      } else if (keyDown) {
        event.preventDefault();
        // If has not an item active
        if (itemActiveIndex < 0) {
          // select the first item
          items[0].classList.add(config.itemsActiveClass);
          config.search.value = getItemContent(items[0]);
        // If has an item active and it's not the last item
        } else if (itemActiveIndex >= 0 && itemActiveIndex < (items.length - 1)) {
          // select the next item
          itemActive.classList.remove(config.itemsActiveClass);
          items[itemActiveIndex + 1].classList.add(config.itemsActiveClass);
          config.search.value = getItemContent(items[itemActiveIndex + 1]);
        // If item active is the last item
        } else {
          // unselect item active
          itemActive.classList.remove(config.itemsActiveClass);
          config.search.value = config.searchTerm;
        }
      }
    });

    // On search input type
    config.search.addEventListener('input', function () {
      // update searchTerm
      config.searchTerm = config.search.value;

      if (!suggestionsIsOpen()) openSuggestions();

      // run custom function to update list
      if (config.searchTerm) {
        config.updateList();
      // run custom function to update list
      } else {
        buildList();
      }
    });
  };

  /**
   * Open Suggestions Box
   */
  var openSuggestions = function () {
    // Previne bug no IE ao carregar a pgina
    if ((config.search === document.activeElement) && (config.suggestions)) {
      config.suggestions.classList.add(config.suggestionsActiveClass);
    }
  };

  /**
   * Close Suggestions Box
   */
  var closeSuggestions = function () {
    if (config.suggestions) config.suggestions.classList.remove(config.suggestionsActiveClass);
  };

  /**
   * Toggle Suggestions Box
   */
  var toggleSuggestions = function () {
    if (!suggestionsIsOpen()) openSuggestions();
    else closeSuggestions();
  };

  /**
   * Check if Suggestions Box is open
   * @return {Boolean} true if open
   */
  var suggestionsIsOpen = function () {
    return config.suggestions.classList.contains(config.suggestionsActiveClass);
  };

  /**
   * Build List
   * Build the list (<ul>/<li>) of suggestions
   *
   * @param  {Array}    list  list of suggestions
   * @param  {String}   title title of the list
   * @param  {Number}   limit limit of suggestions
   * @param  {Function} cb    callback called after list's builded
   */
  var buildList = function (list, title, limit, cb) {
    // Check if list exists and if it's an array
    if (typeof list === 'undefined' || !Array.isArray(list)) {
      // If no list is passed and a default list exists, use default instead
      if (config.defaultList && Array.isArray(config.defaultList)) list = config.defaultList;
      // If no list is passed and there's no default list, throw error
      else list = null;
      // else throw new Error('An array of items is required');
    }

    // Set default limit
    if (typeof limit === 'undefined') limit = config.maxItems;

    // destroy current list to avoid multiple instances
    destroyList();

    // Change title
    setTitle(title);

    // Build list
    if (list) {
      list.some(function (item, index) {
        config.list.appendChild(addItem(item));
        return ++index === limit;
      });
    }

    // Callback
    if (typeof cb === 'function') cb();
    else config.onBuildList(config.suggestions);
  };

  /**
   * Destroy List
   * Remove all child nodes (<li>) from the list (<ul>)
   */
  var destroyList = function () {
    setTitle('');
    if (config.list.firstChild) while (config.list.firstChild) config.list.removeChild(config.list.firstChild);
  };

  /**
   * Update List
   * Destroy, filter and rebuild the suggestions list
   *
   * @param  {Array} list list of suggestions
   */
  var updateList = function (list) {
    // Update suggestions list
    if (Array.isArray(list)) config.suggestionsList = list;

    // destroy current list to avoid multiple instances
    destroyList();

    // add loading
    setLoadingState(true);

    // build
    buildList(filterList(config.suggestionsList, config.searchTerm), '');

    // remove loading
    setLoadingState(false);
  };

  /**
   * Filter List
   * Filter an array of objects to return only those who have the search term
   * in its key value.
   *
   * @param  {Array}  list   list of objects
   * @param  {String} search text to search in list
   * @return {Array}         list of objects who have search string in
   */
  var filterList = function (list, search) {
    return list.filter(function (item) {
      if (typeof item.content === 'string') {
        return indexOfSpecial(item.content, search) > -1;
      } else if (Array.isArray(item.content)) {
        return item.content.some(function (content) {
          return typeof content === 'string' && indexOfSpecial(content, search) > -1;
        });
      }
    });
  };

  /**
   * Set Title
   * @param  {String} title a title to suggestions list
   */
  var setTitle = function (title) {
    var elTitle = config.suggestions.querySelector('.' + config.listTitleClass);
    // Check if title exists and if it's an array
    if (typeof title === 'undefined') {
      // If no title is passed and a default title exists, use default instead
      if (typeof config.defaultTitle === 'string') title = config.defaultTitle;
      // If no title is passed and there's no default title, set title as empty
      else title = '';
    }
    // set title in HTML
    if (elTitle) elTitle.innerText = title;
  };

  /**
   * Custom Update
   * Set a custom function to run on input typing
   *
   * @param  {Function} fn custom function
   */
  var setCustomUpdate = function (fn) {
    if (typeof fn === 'function') {
      // update from dinamic function
      config.updateList = fn;
    }
  };

  /**
   * Default List
   * Set default list of suggestions and title, defined by config.defaultList
   * and config.defaultTitle, respectively.
   *
   * @param  {Array}  list  list of suggestions
   * @param  {String} title a title to suggestions list
   */
  var setDefaultList = function (list, title) {
    if (Array.isArray(list)) config.defaultList = list;
    if (typeof title === 'string') config.defaultTitle = title;
    buildList(config.defaultList, config.defaultTitle);
  };

  /**
   * Add Item
   * Add an item <li> to suggestions list
   *
   * Object:
   *   term: string - the part of text that has the search term
   *   link: string - url to the page of the item
   *   location: string - name of the page of the item
   *
   * @param  {Object} item object with the content of item
   * @return {String} HTML string of the item
   */
  var addItem = function (item) {
    var li = document.createElement('li');
    var anchor;
    var contents;

    if (!item || !item.content.length) return;

    if (typeof item.content === 'string') contents = [item.content];
    else if (Array.isArray(item.content)) contents = item.content;
    else console.error('item content should be a string or an array of strings');

    li.classList.add(config.itemClass);

    if (item.link) {
      anchor = document.createElement('a');
      anchor.href = item.link;
    } else {
      anchor = document.createElement('button');
      anchor.type = 'button';
    }

    anchor.classList.add(config.itemLinkClass);
    li.appendChild(anchor);

    contents.forEach(function (content, index) {
      var span = document.createElement('span');
      var contentHighlighted = replaceTerms(content, config.searchTerm) || '';
      span.innerHTML = contentHighlighted || content;
      span.setAttribute('data-value', content);
      if (config.contentClasses.length) span.classList.add(config.contentClasses[index]);
      if (anchor) anchor.appendChild(span);
      else li.appendChild(span);
    });

    if (!item.link) {
      anchor.addEventListener('click', function () {
        config.search.value = getItemContent(li);
      });
    }

    return li;
  };

  /**
   * Get All Items
   * Get the nodelist with all list item elements
   *
   * @return {NodeList} array with all item elements
   */
  var getAllItems = function () {
    return config.list.querySelectorAll('.' + config.itemClass);
  }

  /**
   * Get ItemContent
   * Get the text content of an list item element
   *
   * @param  {Object} item item element with the content of item
   * @return {String}      the item textContent
   */
  var getItemContent = function (item) {
    var itemTerm;
    if (!item) return;
    itemTerm = item.querySelectorAll('span');
    return itemTerm[0].textContent;
  };

  /**
   * Get current active item
   * Get the current item marked as active during keyboard arrows navigation.
   *
   * @return {Object} DOM Object of the item
   */
  var getItemActive = function () {
    return config.suggestions.querySelector('.' + config.itemsActiveClass);
  };

  /**
   * Disable current active item
   * Disable the current item marked as active during keyboard arrows navigation.
   */
  var disableItemActive = function () {
    var active = getItemActive();
    // unselect item active
    if (active) active.classList.remove(config.itemsActiveClass);
  };

  /**
   * Replace Terms
   * Replace the searchTerm in the term string with custom HTML to make it bold
   *
   * @param  {String} strWhereSearch item term
   * @param  {String} strToFind      search term to replace in item term
   * @return {String}                item term replaced with bold search term
   */
  var replaceTerms = function (strWhereSearch, strToFind) {
    // Array to store strings before join
    var occurrencesString = [];

    // Check if both parameters was passed
    if (typeof strWhereSearch === 'undefined' ||
      typeof strToFind === 'undefined') return;

    /**
     * Loop through parts of strWhereSearch to check if it has strToFind in
     * @param {String} strPart some string where to find out strToFind
     */
    var allIndex = function (strPart) {
      var realString = '';
      var newString = '';
      var idx;
      // check if strPart has strToFind,
      idx = indexOfSpecial(strPart, strToFind);
      if (idx > -1) {
        // store the realString
        realString = strPart.substring(idx, idx + strToFind.length);
        newString = '<b class="' + config.itemTermTypedClass + '">' + realString + '</b>';
        // store the part of the strPart before realString and realString replaced
        // with bold HTML tags
        strBefore = strPart.substring(0, idx + realString.length).replace(realString, newString);
        // store the part of the strPart after realString
        strAfter = strPart.substring(idx + realString.length);
        // push strBefore to the occurrencesString
        occurrencesString.push(strBefore);
        // if strAfter not empty, pass it to allIndex function
        if (strAfter) allIndex(strAfter);
      } else {
        // if strPart has not strToFind in, push it to the end of occurrencesString
        occurrencesString.push(strPart);
      }
    };

    // run allIndex
    allIndex(strWhereSearch);

    // return strWhereSearch replaced strToFind bold
    return occurrencesString.join('');
  };

  /**
   * Set loading state
   * @param  {Boolean} state true to add loading, false to remove loading
   */
  var setLoadingState = function (state) {
    // check parameters
    // if state empty, toogle loading instead set
    if (typeof state === 'undefined') {
      state = !config.suggestions.classList.contains(config.suggestionsLoadingClass);
    }

    // Set state
    if (state === true) {
      config.suggestions.classList.add(config.suggestionsLoadingClass);
    } else if (state === false) {
      config.suggestions.classList.remove(config.suggestionsLoadingClass);
    }
  };

  /**
   * Check if Search Input or any item of suggestions list has focus
   * @return {Boolean} true if search has focus
   */
  var searchHasFocus = function () {
    // all links (<a>) inside list
    var links = config.list.querySelectorAll('a');
    // Check if search Input has focus
    var searchInputHasFocus = config.search === document.activeElement;
    // Check if any item of suggestions list has focus
    var anyLinkHasFocus = Array.prototype.some.call(links, function (link) {
      return link === document.activeElement;
    });
    // return if any of those are true
    return (searchInputHasFocus || anyLinkHasFocus);
  };

  return {
    init: init,
    toggle: toggleSuggestions,
    open: openSuggestions,
    close: closeSuggestions,
    isOpen: suggestionsIsOpen,
    filter: filterList,
    build: buildList,
    destroy: destroyList,
    update: config.updateList,
    custom: setCustomUpdate,
    setLoading: setLoadingState,
    defaultList: config.defaultList,
    setDefaultList: setDefaultList,
    getSerchTerm: config.searchTerm,
    config: config,
  };
};

/**
 * Examples
 */
//
// // Init Search Constructor with default and suggestions lists
// var defaultExample = function () {
//   // document.addEventListener('DOMContentLoaded', function () {
//
//   var sugestoes = document.querySelectorAll('.bs-js-search-suggestions');
//   var instances = [];
//   if (sugestoes && sugestoes.length) {
//     Array.prototype.forEach.call(sugestoes, function (el) {
//       var instance = new BsSearchSuggestions(el, {
//         contentClasses: [
//           'bs-search-suggestions__term',
//           'bs-search-suggestions__location',
//         ],
//         maxItems: 8,
//         defaultTitle: 'Mais Buscados',
//         defaultList: [
//           {
//             content: 'Sem link e sem location',
//           },
//           {
//             link: '#!',
//             content: [
//               'Lorem ipsum dolor sit amet',
//               'irure dolor',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'Lorem ipsum dolor sit amet',
//               'irure dolor',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'consectetur adipisicing elit',
//               'in reprehenderit',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'sed do eiusmod tempor incididunt',
//               'voluptate velit',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'ut labore et dolore magna aliqua',
//               'esse cillum dolore',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'Ut enim ad minim veniam',
//               'eu fugiat nulla',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'quis nostrud exercitation ullamco',
//               'excepteur sint occaecat',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'laboris nisi ut aliquip ex ea',
//               'cupidatat non proident',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'commodo consequat. Duis aute',
//               'qui officia deserunt',
//             ],
//           },
//         ],
//         suggestionsList: [
//           {
//             content: 'Sem link e sem location',
//           },
//           {
//             link: '#!',
//             content: [
//               'Lorem ipsum dolor sit amet',
//               'irure dolor',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'consectetur adipisicing elit',
//               'in reprehenderit',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'sed do eiusmod tempor incididunt',
//               'voluptate velit',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'ut labore et dolore magna aliqua',
//               'esse cillum dolore',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'Ut enim ad minim veniam',
//               'eu fugiat nulla',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'quis nostrud exercitation ullamco',
//               'excepteur sint occaecat',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'laboris nisi ut aliquip ex ea',
//               'cupidatat non proident',
//             ],
//           },
//           {
//             link: '#!',
//             content: [
//               'commodo consequat. Duis aute',
//               'qui officia deserunt',
//             ],
//           },
//         ],
//       });
//       instance.init();
//       instances.push(instance);
//     });
//   }
// };
// defaultExample();
//
// if (document.querySelector('.busca')) {
//   var differentClassesExample = new BsSearchSuggestions('.bs-autocomplete', {
//     search: '.busca',
//     // suggestions: '.bs-autocomplete',
//     // list: '.bs-search-suggestions__list',
//     list: '.bs-search-suggestions__list',
//     suggestionsActiveClass: 'bs-is-open',
//     suggestionsLoadingClass: 'bs-is-loading',
//     itemClass: 'li',
//     itemsActiveClass: 'li--active',
//     itemLinkClass: 'link',
//     itemTermClass: 'term',
//     itemTermTypedClass: 'term-typed',
//     itemLocationClass: 'location',
//     defaultTitle: '',
//     defaultList: [
//       {
//         term: 'Lorem ipsum dolor sit amet',
//         link: '#!',
//         location: 'irure dolor',
//       },
//       {
//         term: 'consectetur adipisicing elit',
//         link: '#!',
//         location: 'in reprehenderit',
//       },
//       {
//         term: 'sed do eiusmod tempor incididunt',
//         link: '#!',
//         location: 'voluptate velit',
//       },
//       {
//         term: 'ut labore et dolore magna aliqua',
//         link: '#!',
//         location: 'esse cillum dolore',
//       },
//       {
//         term: 'Ut enim ad minim veniam',
//         link: '#!',
//         location: 'eu fugiat nulla',
//       },
//       {
//         term: 'quis nostrud exercitation ullamco',
//         link: '#!',
//         location: 'excepteur sint occaecat',
//       },
//       {
//         term: 'laboris nisi ut aliquip ex ea',
//         link: '#!',
//         location: 'cupidatat non proident',
//       },
//       {
//         term: 'commodo consequat. Duis aute',
//         link: '#!',
//         location: 'qui officia deserunt',
//       },
//     ],
//     suggestionsList: [
//       {
//         term: 'Lorem ipsum dolor sit amet',
//         link: '#!',
//         location: 'irure dolor',
//       },
//       {
//         term: 'consectetur adipisicing elit',
//         link: '#!',
//         location: 'in reprehenderit',
//       },
//       {
//         term: 'sed do eiusmod tempor incididunt',
//         link: '#!',
//         location: 'voluptate velit',
//       },
//       {
//         term: 'ut labore et dolore magna aliqua',
//         link: '#!',
//         location: 'esse cillum dolore',
//       },
//       {
//         term: 'Ut enim ad minim veniam',
//         link: '#!',
//         location: 'eu fugiat nulla',
//       },
//       {
//         term: 'quis nostrud exercitation ullamco',
//         link: '#!',
//         location: 'excepteur sint occaecat',
//       },
//       {
//         term: 'laboris nisi ut aliquip ex ea',
//         link: '#!',
//         location: 'cupidatat non proident',
//       },
//       {
//         term: 'commodo consequat. Duis aute',
//         link: '#!',
//         location: 'qui officia deserunt',
//       },
//     ],
//   });
//   differentClassesExample.init();
//   // console.log(differentClassesExample);
// }
//
// // Get external list and update the static list of suggestions
// var ajaxStaticExample = function () {
//   var swPeople = function (people) {
//     people = JSON.parse(people);
//     var list = people.results.map(function (person) {
//       return {
//         term: person.name,
//         url: person.url,
//         location: '',
//       };
//     });
//
//     // rebuild
//     BsSearchSuggestions.update(list);
//     BsSearchSuggestions.setLoading(false);
//   };
//
//   // destroy
//   BsSearchSuggestions.destroy();
//   BsSearchSuggestions.setLoading(true);
//
//   httpGet('https://swapi.co/api/people/?format=json', swPeople.bind());
// };
//
// // updates the default updateList function to call ajax request during input typing
// var ajaxOnTypeExample = function () {
//   BsSearchSuggestions.custom(function () {
//     ajaxStaticExample();
//   });
// };

/**
 * Snackbar
 * https://github.com/material-components/material-components-web/tree/master/packages/mdc-snackbar
 */
var BsSnackbar = (function () {
  // Config
  var config = {
    buttons: {
      trigger: document.querySelectorAll('.bs-js-trigger-snackbar'),
      close: document.querySelector('.bs-js-close-snackbar'),
    },
    classes: {
      alert: 'bs-snackbar--alert',
      visible: 'bs-snackbar--visible',
    },
    snackbars: document.querySelectorAll('.bs-snackbar'),
    timeoutFn: null,
    timeoutTime: 2750,
  };

  var init = function () {
    if (config.buttons.trigger) {
      Array.prototype.forEach.call(config.buttons.trigger, function (button) {
        button.addEventListener('click', function () {
          var snackbarId = button.dataset.snackbarId;
          if (snackbarId) showSnackbar(snackbarId);
        });
      });
    }

    if (config.snackbars) {
      Array.prototype.forEach.call(config.snackbars, function (snackbar) {
        snackbar.addEventListener('mouseover', function () {
          clearTimeout(config.timeoutFn);
        });

        snackbar.addEventListener('mouseleave', function () {
          timeout(snackbar);
        });
      });
    }
  };

  var showSnackbar = function (snackbarId) {
    var snackbar = document.querySelector('.bs-snackbar[data-snackbar-id="' + snackbarId + '"]');
    var isVisible = snackbar.classList.contains(config.classes.visible);

    if (!isVisible && snackbar) {
      snackbar.classList.add(config.classes.visible);
      timeout(snackbar);
    }
  };

  var timeout = function (snackbar) {
    config.timeoutFn = setTimeout(function () {
      hideSnackbar(snackbar);
    }, config.timeoutTime);
  };

  var hideSnackbar = function (snackbar) {
    snackbar.classList.remove(config.classes.visible);
  };

  return {
    init: init,
    show: showSnackbar,
    hide: hideSnackbar,
  };
}());

/**
 * Init BsSnackbar constructor
 * @return {void} BsSnackbar.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-snackbar').length) {
    BsSnackbar.init();
  }
});

var BsShare = (function() {

  // Config List and Select
  var config = {
    shareSocial: document.querySelectorAll('.bs-js-social-share')
  }

  // Start Functions Download
  var init = function() {

    Array.prototype.forEach.call(config.shareSocial, function (el) {
      var buttonSocial = el.querySelector('');
    
      buttonSocial.addEventListener('click', function (e) {
        e.preventDefault(); 
        
        if (buttonSocial.classList.contains('bs-js-link')) {
          var copyLink = document.URL;
          var dummy = document.createElement('textarea');

          // Fix to prevent scroll to bottom. Creating element inside the link button
          dummy.style.height = "1px";
          dummy.style.width = "1px";
          dummy.style.position = "absolute";

          this.appendChild(dummy);
          dummy.value = copyLink;
          dummy.select();
          document.execCommand('copy');
          this.removeChild(dummy);

        } else {
          var socialFacebook = buttonSocial.classList.contains('bs-js-facebook') ? 'https://www.facebook.com/sharer/sharer.php?u=' : '';
          var socialTwitter = buttonSocial.classList.contains('bs-js-twitter') ? 'https://twitter.com/intent/tweet?url=' : '';
          var socialLinkdin = buttonSocial.classList.contains('bs-js-linkdin') ? 'https://www.linkedin.com/shareArticle?mini=true&url=' : '';

          var url = socialFacebook.concat(socialTwitter, socialLinkdin);
          var openWindow = window.open(url + document.URL, 'popup', 'height=450,width=350');

          if (openWindow.focus) openWindow.focus();
          else return false;
        }
      });
    });
  };

  return {
    init: init
  };
}());

/**
* Init Modal Constructor
* @return {void} Header.init();
*/
document.addEventListener('DOMContentLoaded', function() {
  if (document.querySelectorAll('.bs-js-social-share').length) {
    BsShare.init();
  }
});
var BsSticky = (function() {

  var referenceNode = null;
  var cfgNav = {};
  var cfgSize = {};

  // Start Functions Nav
  var init = function(options) {
    var newNodeContainer = document.createElement('div');
    var newNodeChild = document.createElement('div');
    var parentNode = null;

    // Config nav and sizes
    cfgSize = {
      setSizeWindow : 992,
      setMarginTop : 130,
      setParentClass: 'bs-js-aside',
    }
    if (typeof options === 'object') {
      if (options.setSizeWindow) cfgSize.setSizeWindow = options.setSizeWindow
      if (options.setMarginTop) cfgSize.setMarginTop = options.setMarginTop
      if (options.setParentClass) cfgSize.setParentClass = options.setParentClass
    }

    // Get the parent node
    referenceNode = document.querySelector('.bs-js-sticky')
    newNodeContainer.classList.add('bs-sticky')
    if (referenceNode) {
      parentNode = referenceNode.parentNode;
      if (cfgSize.setParentClass && getParent(referenceNode, cfgSize.setParentClass)) {
        parentNode = getParent(referenceNode, cfgSize.setParentClass);
        newNodeChild = parentNode.children[0];
      } else {
        newNodeChild = referenceNode;
      }
      parentNode.insertBefore(newNodeContainer, newNodeChild);
      newNodeContainer.appendChild(newNodeChild);
    }

    if (referenceNode && newNodeContainer) {
      cfgNav = {
        navFix : newNodeChild,
        navFixContainer : newNodeContainer,
      };
      cfgSize.navFixSticky = cfgNav.navFix.offsetTop;
      cfgSize.navFixStickyContainer = cfgNav.navFixContainer.offsetTop;
      cfgSize.navParent = cfgNav.navFix.parentNode;
    }

    resizeHeaderOnScroll();

    // Executa Verificao de tela e retorna funo inicial
    viewportWidth();
    navSizeView();

    // Evento para resize de verificao da viewport ate tamanho preciso
    window.addEventListener('resize', function () {
      setTimeout(function () {
        viewportWidth();
        navSizeView();
      }, 500);
    });
  };

  var viewportWidth = function () {
    cfgSize.viewportWidth = window.innerWidth || document.documentElement.clientWidth;
  }

  var navSizeView = function () {
    viewportWidth();
    if (cfgSize.viewportWidth < cfgSize.setSizeWindow) {
      window.removeEventListener('scroll', resizeHeaderOnScroll);
      cfgNav.navFix.style.cssText = '';
    } else {
      window.addEventListener('scroll', resizeHeaderOnScroll);
      cfgNav.navFix.style.width = cfgSize.navParent.getBoundingClientRect().width + 'px'
      resizeHeaderOnScroll();
    }
  }

  var resizeHeaderOnScroll = function() {

    // Config nav Inside With Scroll
    var cfgInside = {
      // Captura a distancia do topo at o elemento incial da div
      distanceOrigin : (window.pageYOffset ),
      // Captura distancias selecionadas pela funo
      topRectInside : cfgSize.navParent.getBoundingClientRect().top,
      bottomRectInside : cfgSize.navParent.getBoundingClientRect().bottom,
      //  Captura altura do elemento interno no scroll
      navHeightInside : cfgNav.navFix.offsetHeight,
      widthRectInside : cfgSize.navParent.getBoundingClientRect().width,
      // Recebe valor da altura da navegao e diminui por Tamanho da navegao
      setHeader : document.querySelector('.bs-header'),
      setHeaderPin : document.querySelector('.bs-header--pinned')
    };

    // Altura do stick pai
    var cfgRect = {
      heightRectOut : cfgSize.navParent.getBoundingClientRect().height
    }

    // Calculos para dimensionar posio da nav em relao a pagina e ao menu fixo
    var cfgCalc = {
      // Adiciona margem a posio para ficar fixa no rodap do elemento pai
      navHeightContent : cfgRect.heightRectOut - cfgInside.navHeightInside,
      // desconta tamanho do box para iniciar acima do header pin se existir
      navHeightInside : cfgInside.bottomRectInside - cfgInside.navHeightInside,
      distanceRelativeOrigin : (cfgInside.distanceOrigin)
    };

    var downStatic = function() {
      cfgNav.navFix.style.transition = '0s';
      cfgNav.navFix.style.position = 'static';
      cfgNav.navFix.style.top = '30px';
    }
    var downFixed = function() {
      cfgNav.navFix.style.position = 'fixed';
      cfgNav.navFix.style.transition = '.3s';
      cfgNav.navFix.style.top = cfgSize.setMarginTop + 'px';
    }
    var downRelative = function() {
      cfgNav.navFix.style.transition = '0s';
      cfgNav.navFix.style.position = 'relative';
      cfgNav.navFix.style.top = cfgCalc.navHeightContent + 'px';
      cfgNav.navFix.style.transition = null;
    }

    var upStatic = function() {
      cfgNav.navFix.style.transition = '0s';
      cfgNav.navFix.style.position = 'static';
      cfgNav.navFix.style.top = '30px';
    }
    var upFixed = function() {
      cfgNav.navFix.style.position = 'fixed';
      cfgNav.navFix.style.top = cfgSetHeader.headerOrigin + 30 +'px';
    }
    var upRelative = function() {
      cfgNav.navFix.style.transition = '0s';
      cfgNav.navFix.style.position = 'relative';
      cfgNav.navFix.style.top = cfgCalc.navHeightContent + 'px';
    }


    if (cfgInside.setHeader) {
      // Calculos para dimensionar posio da nav em relao a pagina e ao menu fixo
      cfgSetHeader = {
        headerOrigin : (cfgInside.setHeader.offsetHeight)
      }
      // cfgInside.distanceOrigin -= cfgSetHeader.headerOrigin;
      // console.log('distanceOrigin: ', cfgInside.distanceOrigin);
    }

    // recalcula offsetTop bs-js-stick
    cfgSize.navFixSticky = cfgNav.navFix.offsetTop;
    // recalcula offsetTop do filho
    cfgSize.navFixStickyContainer = cfgNav.navFixContainer.offsetTop;
    // Adiciona Tamanho Original da div Pai
    cfgNav.navFix.style.width = cfgInside.widthRectInside + 'px'
    // Atualiza margem a posio para ficar fixa no rodap do elemento pai

    // Se tiver header com pin
    if (cfgInside.setHeaderPin) {
      // Navegao Se final do elemento fixa relativo
      // Enquanto sobe o estatico no topo
      if (cfgCalc.navHeightInside - 30 < (cfgSetHeader.headerOrigin)) {
        // console.log('upRelative()');
        upRelative()
      } else if(((cfgCalc.distanceRelativeOrigin + 30) + cfgSetHeader.headerOrigin) < (cfgSize.navFixStickyContainer )) {
        // console.log('upStatic()');
        upStatic()
      } else {
        // console.log('upFixed()');
        upFixed()
      }

    // Se tiver header sem pin
    } else {
      // Navegao Se final do elemento fixa relativo
      // Quando para no bottom do pai
      if (cfgCalc.navHeightInside < cfgSize.setMarginTop) {
        downRelative()
      }
      //- Altura Relativa do Nav 'se' Maior que 'Altura do Menu'
      // Fixa no top a navegao
      else if(((cfgInside.distanceOrigin + 30) > (cfgSize.navFixStickyContainer))) {
        downFixed()
      }
      // Distancia ate a altura do scroll relativo ao altura fixa do margin top
      // - Enquanto estatico na pagina antes de fixar no topo
      else if(cfgCalc.distanceRelativeOrigin < cfgSize.navFixStickyContainer) {
        downStatic()
      }
    }
  }

  return {
      init: init,
      load: resizeHeaderOnScroll,
  };
}());

/**
* Init Modal Constructor
* @return {void} Header.init();
*/
document.addEventListener('DOMContentLoaded', function() {
  if (document.querySelectorAll('.bs-js-sticky').length) {
    BsSticky.init();

    window.addEventListener('load', function() {
      BsSticky.load();
    });
  }
});

/**
 * Tabela de Resultado de Sorteios
 * Pode expandir linhas para exibir um contedo maior
 *
 */
var BsTableCollapsible = (function () {
  // Config
  var config = {
    table: document.querySelector('.bs-table--collapsible'),
    buttons: {
      trigger: document.querySelectorAll('.bs-js-trigger-collapsible'),
      sort: document.querySelectorAll('.bs-js-sort-collapsible'),
    },
    tableFilterSelect: document.querySelector('.bs-js-filter-table-collapsible-items'),
    tableRows: document.querySelectorAll('.bs-table__row'),
    tableItems: document.querySelectorAll('.bs-js-table-collapsible-item'),
    classes: {
      rowCollapsed: 'bs-table__row--collapsed',
      tableRow: 'bs-table__row',
      rowActive: 'bs-table__row--active',
      tableHasFilter: 'bs-has-filter',
    },
  };

  var init = function () {
    if (config.buttons.trigger) {
      Array.prototype.forEach.call(config.buttons.trigger, function (button) {
        button.addEventListener('click', function () {
          toggleRow(button);
        });
      });
    }

    if (config.table) {
      BsTableSort.init(config.table.querySelector('table'));
    }

    if (config.tableFilterSelect) {
      config.tableFilterSelect.addEventListener('change', function (ev) {
        var id = ev.target.value;
        filterItems(id);
      });
    }
  };

  var filterItems = function (filterId) {
    var activeItem;
    var activeItemRow = '';
    var currentActiveRow = config.table.querySelector('.' + config.classes.rowActive);

    if (typeof filterId !== 'string') return;

    activeItem = config.table.querySelector('.bs-js-table-collapsible-item[data-item-id="' + filterId + '"]');
    activeItemRow = getParent(activeItem, 'bs-table__row');

    if (currentActiveRow) currentActiveRow.classList.remove(config.classes.rowActive);

    if (filterId === '') {
      config.table.classList.remove(config.classes.tableHasFilter);
    } else {
      config.table.classList.add(config.classes.tableHasFilter);
      activeItemRow.classList.add(config.classes.rowActive);
    }
  };


  var toggleRow = function (element) {
    var row = getRow(element);

    if (row && row.classList.contains(config.classes.rowCollapsed)) {
      row.classList.remove(config.classes.rowCollapsed);
    } else if (!row.classList.contains(config.classes.rowCollapsed)) {
      row.classList.add(config.classes.rowCollapsed);
    }
  };

  var getRow = function (element) {
    return getParents(element, config.classes.tableRow)[0];
  };

  return {
    init: init,
  };
}());

/**
 * Init BsTableCollapsible constructor
 * @return {void} BsTableCollapsible.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.bs-table--collapsible')) {
    BsTableCollapsible.init();
  }
});

/**
 * Tabs.js
 * Guias (tabs) organizam e permitem a navegao entre grupos de contedo
 * que esto relacionados e possuem o mesmo nvel de hierarquia.
 *
 * References:
 * - https://www.w3.org/TR/wai-aria-practices/examples/tabs/tabs-1/tabs.html
 * - https://gist.github.com/jonathantneal/435478e415bfe4f54d06
 * - https://codyhouse.co/gem/responsive-tabbed-navigation/
 * - https://uxplanet.org/tabs-for-mobile-ux-design-d4cc4d9410d1
 * - https://www.nngroup.com/articles/tabs-used-right/
 * - https://material.io/design/components/tabs.html#states
 *
 * @return {Object} the module methods
 */
var BsTabs = function () {
  /**
   * Config object
   * @type {Object}
   */
  var config = {};

  /**
   * Set Config
   * @param  {Object} el a DOM element
   * @return {Object}    module's config object
   */
  var setConfig = function (el) {
    return {
      tabs: el,
      list: el.querySelector('.bs-tabs__list'),
      items: el.querySelectorAll('.bs-tabs__link'),
      panel: el.querySelector('.bs-tabs__panel-items'),
      panelContent: el.querySelectorAll('.bs-tabs__content'),
      panelSlider: el.querySelector('.bs-js-panel-slider'),
      arrows: el.querySelector('.bs-tabs__arrows'),
      buttonPrev: el.querySelector('.bs-tabs__arrow-prev'),
      buttonNext: el.querySelector('.bs-tabs__arrow-next'),
      classes: {
        contentActive: 'bs-tabs__content--active',
        tabActive: 'bs-is-active',
      },
      flktyTabs: null,
      flktyPanel: null,
      selectTabOnReady: true,
    };
  };

  /**
   * Init module
   * @param  {Object} elem a DOM element
   */
  var init = function (elem) {
    // return if there's not an element
    if (!elem || typeof elem !== 'object') return;
    // pass elem to set config
    config = setConfig(elem);

    // Remove tab if there's only one
    if (config.items.length < 2) {
      config.tabs.classList.add('bs-tabs--remove-tab');
    } else {
      debounce(buildSlider());
    }
  };

  /**
   * Build Slider
   * Sliders for tabs and content
   */
  var buildSlider = function () {
    // Init a toggleContent
    var contentToggler = new BsToggleContent();

    // Set the tabs slider
    config.flktyTabs = new Flickity(config.list, {
      // add panel asNavFor if it's defined as slider
      asNavFor: config.panelSlider || false,
      cellAlign: 'left',
      adaptiveHeight: true,
      pageDots: false,
      prevNextButtons: false,
      contain: true,
      groupCells: true,
      on: {
        ready: function () {
          reloadFlkty(this, 1000);
          onTabsReady();
        },
      },
    });

    // if panel's defined as slider
    if (config.panelSlider) {
      // Set the panel slider
      config.flktyPanel = new Flickity(config.panelSlider, {
        pageDots: false,
        cellAlign: 'left',
        adaptiveHeight: true,
        prevNextButtons: false,
        accessibility: false,
        on: {
          ready: function () {
            reloadFlkty(this, 1000);
            onTabsReady();
          },
        },
      });
    } else if (config.items && config.panelContent) {
      // set content toggler
      options = {
        buttons: config.items,
        containers: config.panelContent,
        activeButtonClass: config.classes.tabActive,
        activeContainerClass: config.classes.contentActive,
        method: 'click',
      };
      contentToggler.init(options);
    }

    // On Tabs select
    config.flktyTabs.on('select', function () {
      // viewport's width of the tabs container
      var offSet = config.tabs.offsetWidth;

      // sum of the each tab's width
      var totalReduce = Array.prototype.reduce.call(config.items, function (width, el) {
        width += el.offsetWidth;
        return width;
      }, 0);

      var cells = config.flktyTabs.cells;
      var selectedIndex = config.flktyTabs.selectedIndex;

      // if the first group of tabs is selected
      if (!cells[selectedIndex - 1]) {
        // disable previous button on hover
        config.buttonPrev.setAttribute('disabled', 'disabled');
        config.tabs.classList.remove('bs-tabs--over-prev');

        // if viewport offset is less than the sum of each tab's width
        if (offSet < totalReduce) {
          // show arrows
          config.arrows.style.display = 'block';
          // enable next button on hover
          config.buttonNext.removeAttribute('disabled', 'disabled');
          config.tabs.classList.add('bs-tabs--over-next');
        } else {
          // hide arrows
          config.arrows.style.display = 'none';
        }

      // if the group of tabs selected is not the first
      } else if (!cells[cells.length]) {
        // show arrows
        config.arrows.style.display = 'block';
        // enable previous button
        config.buttonPrev.removeAttribute('disabled', 'disabled');
        config.tabs.classList.add('bs-tabs--over-prev');

        // if the last group of tabs is selected
        if (selectedIndex === (config.flktyTabs.slides.length - 1)) {
          // disable previous button
          config.buttonNext.setAttribute('disabled', 'disabled');
          config.tabs.classList.remove('bs-tabs--over-next');
        } else {
          // enable next button
          config.buttonNext.removeAttribute('disabled', 'disabled');
          config.tabs.classList.add('bs-tabs--over-next');
        }
      } else {
        // config.arrows.style.display = 'none';
      }
    });

    config.flktyTabs.resize();

    config.buttonPrev.addEventListener('click', function () {
      config.flktyTabs.previous();
    });
    config.buttonNext.addEventListener('click', function () {
      config.flktyTabs.next();
    });

    // remove pr style default
    config.list.style.display = 'block';
  };

  /**
   * On Tabs Slider's Ready
   * To run when tab slider (flickity) is ready
   */
  var onTabsReady = function () {
    if (config.selectTabOnReady) setTimeout(selectTabOnReady, 100);
  };

  /**
   * Select Tab OnReady
   * Check if there's a hash on URL and if it match an tab ID
   */
  var selectTabOnReady = function () {
    var index = -1;
    var tab = null;
    var hash = getHashAsIdFromUrlString(window.location.hash);
    // check if hash match an element
    if (hash) tab = config.tabs.querySelector(hash);
    // if there's an element, check if it's a tab
    if (tab) index = Array.prototype.indexOf.call(config.items, tab);
    // if it's a tab, select it
    if (index > -1) selectTab(index);
  };

  /**
   * Select Tab
   * @param  {Number} index the index of the tab
   */
  var selectTab = function (index) {
    // if panel is a slider
    if (config.flktyPanel) {
      // select the slide index
      config.flktyPanel.select(index);
    } else {
      // trigger a click on the index tab
      // the click is necessary here to run other events atached to the
      // element, related to BsToggleContent
      config.items[index].click();
    }
  };

  /**
   * Get the Tab Slider Object
   * @return {Object} the flickity object of the tabs
   */
  var getFlktyTabs = function () {
    return config.flktyTabs;
  };

  /**
   * Get the Tabs module
   * @return {Object} the module instance
   */
  var getTabs = function () {
    return bsModule;
  };

  return {
    init: init,
    get: getTabs,
    ready: onTabsReady,
    select: selectTab,
    flktyTabs: getFlktyTabs,
  };
};

/**
 * Init BsTabs constructor
 * @return {void} BsTabs.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  var tabs = document.querySelectorAll('.bs-js-tab--slider');
  if (tabs.length) {
    Array.prototype.forEach.call(tabs, function (el) {
      var tab = new BsTabs();
      tab.init(el);
    });
  }
});

var BsTelecordion = (function () {

  var config = {
    els: document.querySelectorAll('.bs-telecordion'),
    item: document.querySelectorAll('.bs-telecordion__item'),
    box: document.querySelectorAll('.bs-telecordion__box'),
    trigger: document.querySelectorAll('.bs-js-open-telecordion'),
    itemClass: 'bs-telecordion__item',
    boxClass: 'bs-telecordion__box',
    headerClass: 'bs-telecordion__header',
    activeClass: 'is-expanded',
  };

  var init = function () {
    var resizeTimer;

    // Add expand/collapse event
    Array.prototype.forEach.call(config.trigger, function (trigger) {
      var parent = trigger.closest('.' + config.itemClass);
      trigger.addEventListener('click', toggle.bind(null, parent));
      adjustHeight(parent);
    });

    window.addEventListener('resize', function () {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(function () {
        Array.prototype.forEach.call(config.item, function (item) {
          adjustHeight(item);
        });
      }, 250);
    });
  };

  var toggle = function (item) {
    if (isExpanded(item)) collapse(item);
    else expand(item);
  };

  var expand = function (item) {
    item.classList.add(config.activeClass);
    adjustHeight(item);
  };

  var collapse = function (item) {
    item.classList.remove(config.activeClass);
    adjustHeight(item);
  };

  var isExpanded = function (item) {
    return item.classList.contains(config.activeClass);
  };

  var adjustHeight = function (item) {
    var box = item.querySelector('.' + config.boxClass);
    var height = isExpanded(item) ? getItemHeight(item) : getHeaderHeight(item);
    box.style.height = (height > 60 ? height : 60) + 'px';
  };

  var getItemHeight = function (item) {
    var box = item.querySelector('.' + config.boxClass);
    return box.scrollHeight;
  };

  var getHeaderHeight = function (item) {
    var header = item.querySelector('.' + config.headerClass);
    return header.scrollHeight;
  };

  return {
    init: init,
  };
}());

/**
 * Init Modal Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-telecordion').length) {
    BsTelecordion.init();
  }
});

/**
 * BsTimeLine
 * @return Module config
 */
var BsTimeLine = (function () {

  // Config
  var config = {
    timeLine: document.querySelector('.bs-time-line'),
    navSelect: document.querySelector('.bs-time-line__nav'),
    navContent: document.querySelector('.bs-time-line__content'),
    previousButton: document.querySelector('.bs-time-line--prev'),
    nextButton: document.querySelector('.bs-time-line--next'),
  };

  var attr = {
    initialIndex: config.navSelect !== null && config.navSelect.getAttribute('data-initial-index'),
  };


  var init = function () {

    setTimeout(function () {
      // nav items select AND content in as nav for
      var flkty = new Flickity(config.navSelect, {
        asNavFor: config.navContent,
        cellAlign: 'center',
        adaptiveHeight: true,
        initialIndex: attr.initialIndex ? attr.initialIndex : 2,
        prevNextButtons: false,
        // resize: true,
        imagesLoaded: true,
        contain: true
      });

      // nav items content
      var loading = config.timeLine.querySelector('.bs-loading');
      flkty = new Flickity(config.navContent, {
        pageDots: false,
        cellAlign: 'center',
        adaptiveHeight: true,
        prevNextButtons: false,
        initialIndex: attr.initialIndex ? attr.initialIndex : 2,
        on: {
          ready: function () {
            loading.remove();
          },
        },
      });

      flkty.on( 'cellSelect', function() {
        if(!flkty.cells[flkty.selectedIndex - 1]) {
          config.previousButton.setAttribute( 'disabled', 'disabled' );
          config.nextButton.removeAttribute('disabled', 'disabled')
        } else if(!flkty.cells[flkty.selectedIndex + 1]) {
          config.previousButton.removeAttribute('disabled', 'disabled')
          config.nextButton.setAttribute('disabled', 'disabled')
        } else {
          config.previousButton.removeAttribute('disabled', 'disabled')
          config.nextButton.removeAttribute('disabled', 'disabled')
        }
      });

      config.previousButton.addEventListener('click', function() {
        flkty.previous();
      });
      config.nextButton.addEventListener('click', function() {
        flkty.next();
      });
    }, 200);
  };

  return {
    init: init,
  };
}());

/**
 * Init Menu Constructor
 * @return {void} Menu.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.bs-time-line')) {
    BsTimeLine.init();
  }
});

/**
 * Bs Tooltip
 * A custom implementation of tippy.js
 * @link https://atomiks.github.io/tippyjs/themes/
 *
 * @param  {DOMList} elements elements to receive the tooltip
 */
var BsTooltip = function () {
  var init = function (element, options) {
      
    var tippySettings = extend({}, {
      arrow: true,
      theme: 'bs',
      distance: 20,
      trigger: element.classList.contains('bs-js-link') ? 'click' : 'mouseenter',
    }, options)

    if (element) {
      element.setAttribute('data-tippy-content', element.title);
      element.title = '';
      tippy(element, tippySettings);
    }  
  };

  return {
    init: init,
  };
};

/**
 * Init Header Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  var tooltips = document.querySelectorAll('.bs-js--over-tooltip, .bs-js-tooltip, .bs-js-link');

  if (tooltips.length) {
    Array.prototype.forEach.call(tooltips, function (el) {
      var tooltip = new BsTooltip();
      tooltip.init(el);
    });
  }
});


/**
 * Bs TopMenu
 *
 * Reference:
 *
 * [TODO]: Refatorar para que os elementos do config referenciem
 * um topMenu especfico ao invs de pegar todos os existentes no documento.
 */
var BsTopMenu = (function () {

  var config = {
    dropdown: document.querySelectorAll('.bs-js-top-menu'),
    dropdownActiveClass: 'bs-js-has-focus',
  };

  var init = function (){
    var linkMenuToggle = document.querySelector('.bs-js-top-menu .bs-top-menu__link');
    var linkMenuToggleSubitems = document.querySelector('.bs-js-top-menu .bs-top-menu__dropdown');
    var linkMenuToggleSubitemsList = document.querySelectorAll('.bs-top-menu__dropdown .bs-top-menu__link');

    //Apresenta no Enter ou Space os subitens do menu Outros Portais
    linkMenuToggle.addEventListener('keyup', function(e){
      if(e.key === 'Enter' || e.code === 'Enter') {
        linkMenuToggle.classList.toggle('bs-top-menu__rotateItem');
        linkMenuToggleSubitems.classList.toggle("bs-top-menu__display-items");
      }
    });

    //Adiciona parmetro ARIA no link
    linkMenuToggle.addEventListener('keyup', function(e){
        var parameterAriaExpanded = this.getAttribute("aria-expanded");
        var parameterAriaExpanded = parameterAriaExpanded == "false" ? parameterAriaExpanded = "true" : parameterAriaExpanded = "false";
        this.setAttribute("aria-expanded", parameterAriaExpanded);
    });

    //Navega pelos subitens e usando ESC, sai do menu
    for(i=0; i < linkMenuToggleSubitemsList.length; i++){
      linkMenuToggleSubitemsList[i].addEventListener('keydown', function(e){
        if(e.key === "Escape" || e.key === "Esc") {
          linkMenuToggle.classList.toggle('bs-top-menu__rotateItem');
          linkMenuToggleSubitems.classList.toggle("bs-top-menu__display-items");
          linkMenuToggle.focus();
        }
      });
    }

    //Se for ultimo item nevagado, fecha menu
    for(i=0; i < linkMenuToggleSubitemsList.length; i++){
      linkMenuToggleSubitemsList[i].addEventListener('keydown', function(e){
        if(e.key == "Tab"){
          var current_item = document.activeElement;
          var last_item = document.querySelector('ul.bs-top-menu__dropdown');
          var lastUl = last_item.lastElementChild;
          var isLastNode = lastUl.querySelector('ul.bs-top-menu__group-list').lastElementChild;

          if (current_item === isLastNode.querySelector('a')) {
            if ( !e.shiftKey ) {
              linkMenuToggle.classList.toggle('bs-top-menu__rotateItem');
              linkMenuToggleSubitems.classList.toggle("bs-top-menu__display-items");
              linkMenuToggle.focus();
            }
          }
        }
      });
    }

    //Inserir paramtro aria no hover do item
    linkMenuToggle.addEventListener("mouseover", function(){
      var parameterAriaExpanded = this.getAttribute("aria-expanded");
      var parameterAriaExpanded = parameterAriaExpanded == "false" ? parameterAriaExpanded = "true" : parameterAriaExpanded = "false";
      this.setAttribute("aria-expanded", parameterAriaExpanded);
    });
    linkMenuToggle.addEventListener("mouseout", function(){
      var parameterAriaExpanded = this.getAttribute("aria-expanded");
      var parameterAriaExpanded = parameterAriaExpanded == "false" ? parameterAriaExpanded = "true" : parameterAriaExpanded = "false";
      this.setAttribute("aria-expanded", parameterAriaExpanded);
    });

  }

  return {
    init: init,
  };
}());
/**
 * Init TopMenu Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-js-top-menu').length) {
    BsTopMenu.init();
  }
});

/**
 * Bs VoIP App
**/
var voipApp = (function () {

  var init = function () {
    var btn_mute = document.getElementsByClassName("btn-mute-voip")

    for (let i = 0; i < btn_mute.length; i++) {
      btn_mute[i].addEventListener("click", function() {
        this.classList.toggle("mute-on");
      })
    }
  };

  return {
    init: init
  };
}());

/**
 * Init VOIP Constructor
**/
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.bs-voip').length) {
    voipApp.init();
  }
});

identifyNotLoadedImages({ imgSelector: '.bs-media img' });
objectFitImages();
SmoothScroll('a[href*="#"]');

// Firefox 1.0+
var isFirefox = typeof InstallTrigger !== 'undefined';

// Internet Explorer 6-11
var isIE = /*@cc_on!@*/false || !!document.documentMode;

// Edge 20+
var isEdge = !isIE && !!window.StyleMedia;

// Chrome 1 - 79
var isChrome = !!window.chrome && (!!window.chrome.webstore || !!window.chrome.runtime);

// Edge (based on chromium) detection
var isEdgeChromium = isChrome && (navigator.userAgent.indexOf("Edg") != -1);

if (isIE) {
  document.getElementsByTagName('body')[0].classList.add('is-ie-11');
}

// /**
//  * Script especfico para a pgina de Busca de Estacionamento
//  */
// var PiMaps = (function () {
//   var init = function (mapSelector) {
//     var mapElement = document.querySelector(mapSelector);

//     if (mapElement) {
//       var options = {
//         mapHeight: 500,
//         locations: [
//           {
//             id: 0,
//             lat: -25.428183,
//             lng: -49.267073,
//             fn: function () { return scrollTo(0); },
//             infoWindow: {
//               show: false,
//               title: 'Ttulo 1',
//             },
//           },
//           {
//             id: 1,
//             lat: -25.430209,
//             lng: -49.264646,
//             fn: function () { return scrollTo(1); },
//             infoWindow: {
//               show: false,
//               title: 'Ttulo 2',
//             },
//           },
//           {
//             id: 2,
//             lat: -25.431762,
//             lng: -49.270385,
//             fn: function () { return scrollTo(2); },
//             infoWindow: {
//               show: false,
//               title: 'Ttulo 3',
//             },
//           },
//         ],
//         mapOptions: {
//           zoom: 14,
//           center: new google.maps.LatLng(-25.427702, -49.265159),
//           mapTypeId: google.maps.MapTypeId.ROADMAP,
//         },
//       };

//       BsMaps.init(mapElement, options);
//     }
//   };

//   var scrollTo = function (elementId) {
//     var targetAnchor = document.querySelector('[data-scroll-anchor="' + elementId + '"]');

//     if (targetAnchor) {
//       var scroll = new SmoothScroll();
//       var currentActive = targetAnchor.parentNode.querySelector('.bs-is-active');
//       if (currentActive) currentActive.classList.remove('bs-is-active');
//       targetAnchor.classList.add('bs-is-active');
//       scroll.animateScroll(targetAnchor, 0, { speed: 300 });
//     }
//   };

//   return {
//     init: init,
//   };
// }());

// /**
//  * Init PiMaps constructor
//  * @return {void} PiMaps.init();
//  */
// document.addEventListener('DOMContentLoaded', function () {
//   if (document.querySelectorAll('.pi-maps').length) {
//     initGoogleMap(function () {
//       PiMaps.init('.bs-js-map');
//     });
//   }
// });

/**
 * @return Module config
 */
var BsCredenciado = (function () {
  /**
   * Init function
   * @return {Function} Module's scope functions
   */

   var config = {
    setAttr: document.querySelectorAll('.bs-js--type-user input'),
    setPf: document.querySelector('.bs-js--cred-pf'),
    setPj: document.querySelector('.bs-js--cred-pj'),
    setIndicacaoAttr: document.querySelectorAll('.bs-js--type-indicacao input'),
    setIndicacao: document.querySelector('.bs-js--cred-indicacao'),
    setAddress: document.querySelector('.bs-js--cred-address'),
    setAddressItem: document.querySelector('.bs-js--cred-item'),
    setPlus: document.querySelector('.bs-js--cred-plus'),
    checkboxItems : document.querySelector('.bs-js--check'),
    checkboxIndicacaoItems : document.querySelector('.bs-js--check-indicacao'),
    check : '',
    counter: 0,
    counterInd: 0,
    limit : 2,
   };

   if (config.checkboxItems) {
    var selector = {
      checkItem : config.checkboxItems.querySelectorAll('input[type="checkbox"]'),
      checkIndicacaoItem : config.checkboxIndicacaoItems.querySelectorAll('input[type="checkbox"]'),
     };
   };

  var init = function () {

    // clone items form, in click plus
    config.setPlus.addEventListener('click', function(e) {
      var adrresCopy = config.setAddressItem.cloneNode(true);
      var reset = adrresCopy.querySelectorAll('input')

      Array.prototype.forEach.call(reset, function (e) {
        e.value = '';
      });

      config.setAddress.appendChild(adrresCopy);
      config.setPlus.remove();
    });

    Array.prototype.forEach.call(config.setAttr, function (e) {

      e.addEventListener('click', function() {
        var dataFilter = e.getAttribute('data-type');

        if (dataFilter === 'pj') {
          // remove and add requires before filter
          _thisPj();
        } else {
          // remove and add requires before filter
          _thisPf();
        };
      });
    });

    Array.prototype.forEach.call(config.setIndicacaoAttr, function (e) {

      e.addEventListener('click', function() {
        var dataFilter = e.getAttribute('data-type');

        if (dataFilter === 'yes') {
          // remove and add requires before filter
          _thisIndicacao();
        } else {
          // remove and add requires before filter
          _thisRemoveIndicacao();
        };
      });
    });

    Array.prototype.forEach.call(selector.checkItem, function (e) {
      config.buttonItem = e;
      config.buttonItem.addEventListener('click', function (el) {
        config.check = el.target;
        newChecker(config.check);
      });
    });

    Array.prototype.forEach.call(selector.checkIndicacaoItem, function (e) {
      config.buttonItem = e;
      config.buttonItem.addEventListener('click', function (el) {
        config.check = el.target;
        newIndicacaoChecker(config.check);
      });
    });

  };

  var _thisPj = function () {

    config.setPj.style.display = "block";
    config.setPf.style.display = "none";

    var setRequiredPj = config.setPj.querySelectorAll('input');
    Array.prototype.forEach.call(setRequiredPj, function (e) {
      e.required = 'required';
    });
    var setRequiredPf = config.setPf.querySelectorAll('input');
    Array.prototype.forEach.call(setRequiredPf, function (e) {
      e.required = undefined;
    });
  }

  var _thisPf = function () {

    config.setPf.style.display = "block";
    config.setPj.style.display = "none";

    var setRequiredPj = config.setPj.querySelectorAll('input');
    Array.prototype.forEach.call(setRequiredPj, function (e) {
      e.required = undefined;
    });
    var setRequiredPf = config.setPf.querySelectorAll('input');
    Array.prototype.forEach.call(setRequiredPf, function (e) {
      e.required = 'required';
    });
  }

  var _thisIndicacao = function () {

    config.setIndicacao.style.display = "block";

    var setRequiredIndicacao = config.setIndicacao.querySelectorAll('input');
    Array.prototype.forEach.call(setRequiredIndicacao, function (e) {
      e.required = 'required';
    });
  }

  var _thisRemoveIndicacao = function () {

    config.setIndicacao.style.display = "none";

    var setRequiredIndicacao = config.setIndicacao.querySelectorAll('input');
    Array.prototype.forEach.call(setRequiredIndicacao, function (e) {
      e.required = undefined;
    });
  }

  var newChecker = function (e) {

    if (e.checked) config.counter++;
    else config.counter--;

    Array.prototype.forEach.call(selector.checkItem, function (el) {
      if (config.counter === config.limit) { //- 2 limit default
        if (!el.checked) {
          el.disabled = true; // and disable unchecked checkboxes
        };
      } else {
        if (config.counter === config.minSizeLimit) {
          config.buttonItem.disabled = false; // enable unchecked checkboxes
        } else {
          if (!el.checked) {
            el.disabled = false; // enable unchecked checkboxes
          };
        };
      };
    });
  };

  var newIndicacaoChecker = function (e) {

    if (e.checked) config.counterInd++;
    else config.counterInd--;

    Array.prototype.forEach.call(selector.checkIndicacaoItem, function (el) {

      if (config.counterInd === config.limit) { //- 2 limit default
        if (!el.checked) {
          el.disabled = true; // and disable unchecked checkboxes
        };
      } else {
        if (config.counterInd === config.minSizeLimit) {
          config.buttonItem.disabled = false; // enable unchecked checkboxes
        } else {
          if (!el.checked) {
            el.disabled = false; // enable unchecked checkboxes
          };
        };
      };
    });
  };

  return {
    init: init,
  };
}());

/**
 * Init Header Constructor
 * @return {void} Header.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.bs-seja-credenciado')) {
    BsCredenciado.init();
  }
});

/**
 * Formulrio Fale Conosco Sade
 */
document.addEventListener('DOMContentLoaded', function () {

  var toggles = document.querySelectorAll('.bs-js-form-contact-saude-toggle');
  var inputs = document.querySelectorAll('.bs-js-form-contact-saude-target');

  if (toggles.length && inputs.length) {
    Array.prototype.forEach.call(toggles, function (toggle) {
      toggle.addEventListener('change', function () {
        var targetId = toggle.value;
        Array.prototype.forEach.call(inputs, function (input) {
          var inputId = input.getAttribute('data-target');
          var parent = input.closest('.bs-form__control');
          if (inputId === targetId) {
            parent.classList.remove('bs-is-hidden');
            input.required = 'required';
          } else {
            parent.classList.add('bs-is-hidden');
            input.required = '';
          }
        });
      });
    });
  }

  /**
   * Contagem de caracteres nos formulrios: Mensagem*
   */
  var textAreaFaleConosco = [];

  textAreaFaleConosco = [
    document.querySelector('#atend-auto-mensagem'),
    document.querySelector('#atend-residencial-mensagem'),
    document.querySelector('#atend-vida-mensagem'),
    document.querySelector('#atend-previdencia-mensagem'),
    document.querySelector('#atend-saude-mensagem'),
    document.querySelector('#atend-dental-mensagem'),
    document.querySelector('#atend-outros-mensagem')
  ];

  if (textAreaFaleConosco[0] != null) {
    for (i = 0; i < textAreaFaleConosco.length; i++) {
      textAreaFaleConosco[i].addEventListener('input', function(){
        var input_group = this.parentNode;
        var span_value = input_group.querySelector('.bs-form__observation');
        var textTotalLength = this.getAttribute('maxlength');
        var textNumberLength = this.value.length;
        var str_char_remaining = "Limitado em " + (textTotalLength - textNumberLength) + " caracteres";

        span_value.innerHTML = str_char_remaining;
      });
    }
  }

});

/**
 * Formulrio de Leads (Contrate)
 */
document.addEventListener('DOMContentLoaded', function () {
  var contactToggle = document.querySelector('.bs-js-leads-contact-toggle');
  var contactInputs = document.querySelectorAll('.bs-js-leads-contact-target');

  if (contactToggle && contactInputs.length) {
    contactToggle.addEventListener('change', function () {
      var targetId = contactToggle.value;
      Array.prototype.forEach.call(contactInputs, function (input) {
        inputId = input.getAttribute('data-target');
        var parent = input.closest('.bs-form__control');
        if (inputId === targetId) {
          parent.classList.remove('bs-is-hidden');
          input.required = 'required';
        } else {
          parent.classList.add('bs-is-hidden');
          input.required = '';
        }
      });
    });
  }
}); 

/**
 * Form Changer
 */
document.addEventListener('DOMContentLoaded', function () {
  var changers = document.querySelectorAll('[data-changer-target]');
  var formChanger = function (changer) {
    var targetId = changer.value.toLowerCase();
    var targetGroup = changer.getAttribute('data-changer-target');
    var targets = document.querySelectorAll('[data-changer-group="' + targetGroup + '"]');

    Array.prototype.forEach.call(targets, function (item) {
      var itemId = item.getAttribute('data-changer-id').toLowerCase();
      var parent = item.closest('.bs-form__control');
      var childFields = item.querySelectorAll('input, select, textarea');

      if (!parent) {
        // current version
        if (itemId === targetId) {
          item.classList.remove('bs-is-hidden');
          Array.prototype.forEach.call(childFields, function (input) {
            input.required = 'required';
          });
        } else {
          item.classList.add('bs-is-hidden');
          Array.prototype.forEach.call(childFields, function (input) {
            input.required = '';
          });
        }
      // old version
      } else if (itemId === targetId) {
        parent.classList.remove('bs-is-hidden');
        item.required = 'required';
      } else {
        parent.classList.add('bs-is-hidden');
        item.required = '';
      }
    });
  };

  if (changers.length) {
    Array.prototype.forEach.call(changers, function (changer) {
      // formChanger(changer);
      changer.addEventListener('change', formChanger.bind(null, changer));
    });
  }
});

/**
 * Formulrio Ouvidoria
 */
document.addEventListener('DOMContentLoaded', function () {
  var toggles = document.querySelectorAll('.bs-js-form-ouvidoria-sugestao-banco-toggle');
  var inputs = document.querySelectorAll('.bs-js-form-ouvidoria-sugestao-banco-target');

  if (toggles.length && inputs.length) {
    Array.prototype.forEach.call(toggles, function (toggle) {
      toggle.addEventListener('change', function () {
        var targetId = toggle.value;
        Array.prototype.forEach.call(inputs, function (input) {
          var inputId = input.getAttribute('data-target');
          var parent = input.closest('.bs-form__control');
          if (inputId === targetId) {
            parent.classList.remove('bs-is-hidden');
            input.required = 'required';
          } else {
            parent.classList.add('bs-is-hidden');
            input.required = '';
          }
        });
      });
    });
  }
});

/**
 * Formulrio de Consulta de Planos por Referenciado
 */
document.addEventListener('DOMContentLoaded', function () {
  var planosToggle = document.querySelectorAll('.bs-js-planos-credenciado-toggle');
  var planosInputs = document.querySelectorAll('.bs-js-planos-credenciado-target');

  if (planosToggle.length && planosInputs.length) {
    Array.prototype.forEach.call(planosToggle, function (el) {
      el.addEventListener('change', function () {
        var targetId = el.value;

        Array.prototype.forEach.call(planosInputs, function (input) {
          inputId = input.getAttribute('data-target');
          if (inputId === targetId) {
            input.disabled = '';
          } else {
            input.disabled = 'disabled';
          }
        });
      });
    });
  }
});

/**
 * Formulrio Fale Conosco Sade
 */
document.addEventListener('DOMContentLoaded', function () {

  /**
   * Contagem de caracteres nos formulrios: Mensagem*
   */
  var textAreaFaleConosco = [];

  textAreaFaleConosco = [
    document.querySelector('#cadastro-pauta'),
  ];

  if (textAreaFaleConosco[0] != null) {
    for (i = 0; i < textAreaFaleConosco.length; i++) {
      textAreaFaleConosco[i].addEventListener('input', function(){
        var input_group = this.parentNode;
        var span_value = input_group.querySelector('.bs-form__observation');
        var textTotalLength = this.getAttribute('maxlength');
        var textNumberLength = this.value.length;
        var str_char_remaining = "Limitado em " + (textTotalLength - textNumberLength) + " caracteres";

        span_value.innerHTML = str_char_remaining;
      });
    }
  }

});

/**
 * Filtro Lateral do Localizador
 * @component BsSelectFilter.init();
 * @component BsListAccordion.expand();
 */
document.addEventListener('DOMContentLoaded', function () {
  var applyButton = document.querySelector('.bs-js-locator-apply-filter');
  var selectFilters = document.querySelectorAll('.bs-js-select-filter');
  var mobileOpenFilter = document.querySelector('.bs-js-open-filter-mobile');
  var mobileCloseFilter = document.querySelector('.bs-js-close-filter-mobile');
  var overlay = document.querySelector('.bs-overlay');
  var mobileFilterBox = document.querySelector('.bs-js-filter-mobile');
  var locatorFilters = []; // for debug
  var handleFilters = function (filter) {
    var accordionItem = getParent(filter.element(), 'bs-list-description__item');
    var accordionButton = accordionItem.querySelector('.bs-list-description__title');

    var setSelectedItems = function () {
      var span = accordionButton.querySelector('span');
      var spanValue = document.createElement('span');
      var selectedItemsContent = [];
      var selectedItems = filter.selectedItems();

      if (!accordionItem) return;

      if (span) spanValue = span;
      else accordionButton.appendChild(spanValue);

      if (selectedItems.length) {
        selectedItemsContent = selectedItems.map(function (selectedItem) {
          return selectedItem.textContent;
        });
        spanValue.innerText = selectedItemsContent.join(', ');
        accordionButton.classList.add('filter-items-is-selected');
        accordionButton.addEventListener('click', applySelectedItems);
      } else {
        spanValue.remove();
        accordionButton.classList.remove('filter-items-is-selected', 'filter-items-is-applied');
        accordionButton.removeEventListener('click', applySelectedItems);
      }
    };
    var applySelectedItems = function () {
      accordionButton.classList.remove('filter-items-is-selected');
      accordionButton.classList.add('filter-items-is-applied');
      BsListAccordion.collapse(accordionItem);
      accordionButton.addEventListener('click', removeAppliedItems);
    };
    var removeAppliedItems = function () {
      var span = accordionButton.querySelector('span');
      span.remove();
      filter.unselectAllItems();
      accordionButton.classList.remove('filter-items-is-applied');
      BsListAccordion.expand(accordionItem);
      accordionButton.removeEventListener('click', removeAppliedItems);
    };
    var filterList = function () {
      var filterEl = filter.element();
      var list = filterEl.querySelector('ul');
      var filteredItems = filter.filteredItems();

      // if (filteredItems.length) {
      //   filterEl.classList.add('has-filter');
      // } else {
      //   filterEl.classList.remove('has-filter');
      // }

      Array.prototype.forEach.call(list.children, function (item) {
        if (!filteredItems.length || filteredItems.indexOf(item) > -1) {
          item.style.display = '';
        } else {
          item.style.display = 'none';
        }
      });
    };

    filter.on('itemSelect', function (item) {
      setSelectedItems(item);
    });

    filter.on('itemUnselect', function (item) {
      setSelectedItems(item);
    });

    filter.on('itemsApply', function () {
      applySelectedItems();
    });

    filter.on('listFilter', function () {
      filterList()
    });
  };
  var getSelectedFilters = function () {
    return locatorFilters.map(function (filter) {
      return filter.selectedItems();
    });
  };
  var applyFilter = function () {
    // var selected = getSelectedFilters();
    // console.log(selected);
  };
  var clickOutside = function (clickableElements, callback) {
    var isClickable = function (elements, ev) {
      if (!Array.isArray(clickableElements)) elements = [elements];
      return elements.some(function (el) {
        return el.contains(ev.target);
      });
    };

    document.querySelectorAll('body, html').forEach(function (el) {
      el.addEventListener('click', function (event) {
        event.stopPropagation();
        if (!isClickable(clickableElements, event)) {
          callback();
          return false;
        }
      });
    });
  };

  if (applyButton) applyButton.addEventListener('click', applyFilter);

  if (selectFilters) {
    Array.prototype.forEach.call(selectFilters, function (filter) {
      var mustSelectMultiple = (filter.classList.contains('bs-js-select-filter--multiple'));
      var instance;

      instance = new BsSelectFilter();
      instance.init(filter, {
        input: '.bs-js-select-filter__input',
        list: '.bs-js-select-filter__list',
        selectMultiple: mustSelectMultiple,
        autoApply: !mustSelectMultiple,
        applyButtonClass: 'bs-button bs-button--ghost bs-button--primary bs-select-filter__apply',
      });

      handleFilters(instance);

      // for debug
      locatorFilters.push(instance);
    });

    // for debug
    window.locatorFilters = locatorFilters;
  }

  if (mobileOpenFilter && mobileFilterBox) {
    Array.prototype.forEach.call([mobileOpenFilter, mobileCloseFilter], function (button) {
      if (button) {
        button.addEventListener('click', function () {
          if (mobileFilterBox.classList.contains('bs-locator__filter-box--visible')) {
            mobileFilterBox.classList.remove('bs-locator__filter-box--visible');
            overlay.classList.remove('bs-overlay--visible');
          } else {
            mobileFilterBox.classList.add('bs-locator__filter-box--visible');
            overlay.classList.add('bs-overlay--visible');
          }
        });
      }
    });

    clickOutside([mobileFilterBox, mobileOpenFilter, mobileCloseFilter], function () {
      mobileFilterBox.classList.remove('bs-locator__filter-box--visible');
      overlay.classList.remove('bs-overlay--visible');
    });
  }
});

/**
 * Busca de servios
 */
document.addEventListener('DOMContentLoaded', function () {
  var locatorSearch = document.querySelector('.bs-js-locator-search');
  var location;
  var services;
  var search;
  var userLocation = '';
  var getUserLocation = function (callback) {
    if (userLocation) {
      callback(userLocation);
    } else {
      navigator.geolocation.getCurrentPosition(function (data) {
        userLocation = data.coords;
        callback(userLocation);
      });
    }
  };
  var getUserLocationButton = document.querySelector('.bs-js-user-location');

  // search services
  var searchSuggestions;
  var searchSuggestionsList = document.querySelector('.bs-js-service-search-suggestions');

  var searchListExamples = [
    { content: 'Lorem ipsum' },
    { content: 'Consectetur' },
    { content: 'Adipisicing elit' },
    { content: 'Ut labore' },
    { content: 'Magna aliqua' },
  ];

  var searchList = [
    { content: 'Lorem ipsum dolor sit amet' },
    { content: 'consectetur adipisicing elit' },
    { content: 'sed do eiusmod tempor incididunt' },
    { content: 'ut labore et dolore magna aliqua' },
    { content: 'Ut enim ad minim veniam' },
  ];

  if (!locatorSearch) return;

  location = locatorSearch.querySelector('#service-location');
  services = locatorSearch.querySelector('#service-select');
  search = locatorSearch.querySelector('#service-search');

  if (search && searchSuggestionsList) {
    searchSuggestions = new BsSearchSuggestions(searchSuggestionsList, {
      search: search,
      maxItems: 4,
      defaultTitle: 'Exemplos',
      defaultList: searchListExamples,
      suggestionsList: searchList,
    });
    searchSuggestions.init();
  }

  if (getUserLocationButton) {
    getUserLocationButton.addEventListener('click', function () {
      getUserLocation(function (userPos) {
        // console.log(userPos);
      });
    });
  }
});

/**
 * Mostrar Mapa
 */
document.addEventListener('DOMContentLoaded', function () {
  var mapEl = document.querySelector('.bs-js-locator-map');
  var mapButton = document.querySelector('.bs-locator-toggle-map');
  var loadLocatorMap = function () {
    // debugger;
    var element = mapEl;
    var targetEl = document.querySelectorAll('[data-map-anchor]');
    var scrollTo = function (targetAnchor) {
      if (targetAnchor) {
        var scroll = new SmoothScroll();
        var currentActive = targetAnchor.parentNode.querySelector('.bs-is-active');
        if (currentActive) currentActive.classList.remove('bs-is-active');
        targetAnchor.classList.add('bs-is-active');
        scroll.animateScroll(targetAnchor, 0, { speed: 300, offset: 80 });
      }
    };
    var locations = [];
    var options = {
      mapHeight: 500,
      mapOptions: {
        zoom: 14,
        center: new google.maps.LatLng(-25.427702, -49.265159),
        mapTypeId: google.maps.MapTypeId.ROADMAP,
      },
    };

    if (element && targetEl.length) {
      locations = Array.prototype.map.call(targetEl, function (el) {
        var id = el.getAttribute('data-map-anchor');
        var lat = el.getAttribute('data-map-lat');
        var lng = el.getAttribute('data-map-lng');
        return {
          id: id,
          lat: parseFloat(lat),
          lng: parseFloat(lng),
          fn: function () { return scrollTo(el); },
        };
      });
      options.locations = locations;
      BsMaps.init(element, options);
    }
  };

  if (!mapEl) return;

  initGoogleMap(function () {
    loadLocatorMap(mapEl);
  });

  mapButton.addEventListener('change', function (ev) {
    var parent = document.querySelector('.bs-locator__results');
    if (ev.target.checked) parent.classList.add('bs-locator__results--map-active');
    else parent.classList.remove('bs-locator__results--map-active');
  });
});

/**
 * Login Modal
 */
document.addEventListener('DOMContentLoaded', function () {
  var login = document.querySelector('.inst-login');
  var backToProductsList = document.querySelectorAll('.inst-js-login-back-to-main');
  var goToSublist = document.querySelectorAll('.inst-js-login-show-sublist');
  var sublistBoxClass = 'inst-login__box';
  var sublistActiveClass = 'inst-is-active';
  var hasSublistActiveClass = 'inst-login--sub-active';

  if (login && goToSublist.length) {
    Array.prototype.forEach.call(goToSublist, function (anchor) {
      anchor.addEventListener('click', function (ev) {
        var sublist = anchor.parentNode.querySelector('.' + sublistBoxClass);
        var firstButton = sublist.querySelector('.bs-box__link');
        ev.preventDefault();

        if (sublist) {
          sublist.classList.add(sublistActiveClass);
          login.classList.add(hasSublistActiveClass);
          setTimeout(function () {
          	firstButton.focus();
          }, 300);
        }
      });
    });

    if (backToProductsList.length) {
      Array.prototype.forEach.call(backToProductsList, function (anchor) {
        anchor.addEventListener('click', function (ev) {
          var sublist = anchor.closest('.' + sublistBoxClass);
          var sublistParentItem = sublist.closest('.bs-box__item');
          var sublistParentButton = sublistParentItem.querySelector('.bs-box__link');
          ev.preventDefault();

          sublist.classList.remove(sublistActiveClass);
          login.classList.remove(hasSublistActiveClass);
          sublistParentButton.focus();
        });
      });
    }
  }
});

/**
 * Login Modal - Keyboard Accessibility
 */
document.addEventListener('DOMContentLoaded', function () {
  var login = document.querySelector('.inst-login');
  var items;

  if (login) {
    items = login.querySelectorAll('.bs-box__link');
    var buttons = Array.prototype.slice.call(items);
    Array.prototype.forEach.call(items, function (itemButton) {
      itemButton.addEventListener('keydown', function (ev) {
        var key = ev.key;
        var currentButton = itemButton;
        var hasSublist = currentButton.classList.contains('inst-js-login-show-sublist');
        var isSublistBackButton = currentButton.classList.contains('inst-js-login-back-to-main');
        var isSublist = function (btn) {
          return btn.closest('.inst-login__box');
        };
        var activeButtons = buttons.filter(function (el) {
          if (isSublist(currentButton)) {
            return isSublist(el) && isSublist(el) === isSublist(currentButton);
          }
          return el.offsetWidth > 0 && el.offsetHeight > 0;
        });
        var firstButton = activeButtons[0];
        var lastButton = activeButtons[activeButtons.length - 1];
        var prevButton = activeButtons.indexOf(currentButton)
          ? activeButtons[activeButtons.indexOf(currentButton) - 1]
          : lastButton;
        var nextButton = activeButtons.indexOf(currentButton) < activeButtons.length - 1
          ? activeButtons[activeButtons.indexOf(currentButton) + 1]
          : firstButton;

        switch (key) {
          case 'ArrowRight':
          case 'Right': // ie
            if (hasSublist) {
              currentButton.click();
            }
            ev.preventDefault();
            break;
          case 'ArrowLeft':
          case 'Left': // ie
            if (isSublistBackButton) {
              currentButton.click();
            }
            ev.preventDefault();
            break;
          case 'ArrowDown':
          case 'Down': // ie
            nextButton.focus();
            ev.preventDefault();
            break;
          case 'ArrowUp':
          case 'Up': // ie
            prevButton.focus();
            ev.preventDefault();
            break;
          case 'Home':
            firstButton.focus();
            ev.preventDefault();
            break;
          case 'End':
            lastButton.focus();
            ev.preventDefault();
            break;
          default:
        }
      });
    });
  }
});

var pageURL = window.location.href;

if (pageURL.includes('noticias')) {
    if (!pageURL.includes('/noticia/')) {
        window.onunload = function () {
            window.scrollTo(0, 0);
        }
    }
}
var pageURL = window.location.href;

if (pageURL.includes('ouvidoria')) {
  window.onunload = function () {
    //window.scrollTo(0, 0);
    var elemScroll = document.getElementsByClassName("bs-section-header__title");
    elemScroll[0].scrollIntoView();
    window.scrollBy(0, -160);
  }
}

function ready(callbackFunc) {
  if (document.readyState !== 'loading') {
    callbackFunc();
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', callbackFunc);
  } else {
    document.attachEvent('onreadystatechange', function () {
      if (document.readyState === 'complete') {
        callbackFunc();
      }
    });
  }
}

ready(function () {
  var textAreaOuvidoria = [];
  textAreaOuvidoria = [document.querySelector('#ouvidoria-sugestao-mensagem'),
    document.querySelector('#ouvidoria-elogio-mensagem'),
    document.querySelector('#ouvidoria-reclamacao-mensagem'),
    document.querySelector('#ouvidoria-reclamacao-pedido')
  ];

  if (textAreaOuvidoria[0] != null) {
    for (i = 0; i < textAreaOuvidoria.length; i++) {
      textAreaOuvidoria[i].addEventListener('input', function () {
        var input_group = this.parentNode;
        var span_value = input_group.querySelector('.bs-form__observation');
        var textTotalLength = this.getAttribute('maxlength');
        var textNumberLength = this.value.length;
        var str_char_remaining = "Limitado em " + (textTotalLength - textNumberLength) + " caracteres";

        span_value.innerHTML = str_char_remaining
      });
    }
  }
});

/**
 * Script especfico para a pgina de Nossos Aplicativos
 */
var PnNossosApps = (function () {
  var config = {
    // Imagem que ficar flutuando junto com o scroll da pgina
    floatingImage: document.querySelector('.pi-floating-image'),
    // Wrapper do floatingImage, serve para indicar a posio em que a imagem ir
    // parar de flutuar e voltar ao fluxo natural do HTML
    floatingImageWrapper: document.querySelector('.pi-floating-image-wrapper'),
    classes: {
      relative: 'pi-floating-image--relative',
      scrollingDown: 'pi-floating-image--scrolling-down',
      scrollingUp: 'pi-floating-image--scrolling-up',
    },
    // Distncia em pixels da propriedade 'top' usada no CSS
    topOffset: document.querySelector('.pi-floating-image'),
  };

  var init = function () {
    if (config.floatingImage && config.floatingImageWrapper) {
      floatImage();
    }
  };

  var floatImage = function () {
    // Armazena a ltima posio do scroll da tela
    var lastScrollTop = 0;
    var topOffset = (config.topOffset) && parseInt(config.topOffset.dataset.topOffset, 10);

    rects = rect(config.floatingImage, config.floatingImageWrapper);
    var imgTop = rects.image.top;
    var wrapperTop = rects.wrapper.top;

    // verifica posio inicial, para evitar exibio desnecessria em outra posio da tela
    if (Math.abs(imgTop) >= Math.abs(wrapperTop)) {
      config.floatingImage.classList.remove(config.classes.scrollingDown);
      config.floatingImage.classList.add(config.classes.relative);
    }

    window.addEventListener('scroll', function () {
      // Posio atual do scroll
      var currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
      var rects = rect(config.floatingImage, config.floatingImageWrapper);

      // Scroll down
      if (currentScrollTop > lastScrollTop) {
        if (currentScrollTop > topOffset) {
          config.floatingImage.classList.add(config.classes.scrollingDown);
          // Verifica se o topo da imagem colidiu com o topo do wrapper
          // Neste caso, a imagem est na posio em que deve permanecer (position relative)
          if (rects.image.top >= rects.wrapper.top) {
            config.floatingImage.classList.remove(config.classes.scrollingDown);
            config.floatingImage.classList.add(config.classes.relative);
          }
        }
      } else if (
        // Se o scroll chegar ao topo
        (currentScrollTop === 0) ||
        (
          (currentScrollTop < topOffset) &&
          (config.floatingImage.classList.contains(config.classes.scrollingDown))
        )
      ) {
        config.floatingImage.classList.remove(config.classes.scrollingUp);
        config.floatingImage.classList.remove(config.classes.scrollingDown);
        config.floatingImage.classList.remove(config.classes.relative);
      } else if ((rects.image.bottom >= (currentScrollTop + topOffset)) && (currentScrollTop > topOffset) && (rects.image.top >= rects.wrapper.top)) {
        // Caso contrrio, o usurio estiver dando Scroll Up e
        // se o topo da imagem for maior que a posio
        // atual do (posio atual do scroll - top offset)
        config.floatingImage.classList.remove(config.classes.relative);
        config.floatingImage.classList.add(config.classes.scrollingUp);
      }
      // Mobile ou scrolling negativo
      lastScrollTop = currentScrollTop <= 0 ? 0 : currentScrollTop;
    }, false);
  };

  // Obtm os limites dos elementos para podermos identificar se a imagem 'colide' com o wrapper
  var rect = function (image, wrapper) {
    var imageRect = image.getBoundingClientRect();
    var wrapperRect = wrapper.getBoundingClientRect();

    var rectElements = {
      image: {
        bottom: imageRect.bottom,
        left: imageRect.left,
        right: imageRect.right,
        top: imageRect.top,
      },
      wrapper: {
        bottom: wrapperRect.bottom,
        left: wrapperRect.left,
        right: wrapperRect.right,
        top: wrapperRect.top,
      },
    };

    return rectElements;
  };

  return {
    init: init,
  };
}());

/**
 * Init PnNossosApps constructor
 * @return {void} PnNossosApps.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.pi-nossos-apps').length) {
    PnNossosApps.init();
  }
});

/**
 * Tabs
 * Guias (tabs) organizam e permitem a navegao entre grupos de contedo
 * que esto relacionados e possuem o mesmo nvel de hierarquia.
 */
var PiTelefones = (function () {
  // Config
  var config = {
    buttons: document.querySelectorAll('.pi-telefones__filter .bs-media__box'),
    classes: {
      contentActive: 'pi-telefones__content--active',
      buttonActive: 'bs-media__box--active',
    },
    content: document.querySelectorAll('.pi-telefones__content'),
    scroll: new SmoothScroll(),
  };

  var init = function () {
    if (config.buttons && config.content) {
      var contentToggler = new BsToggleContent();
      var options = {
        buttons: config.buttons,
        buttonFirst: config.buttons[0],
        containers: config.content,
        activeButtonClass: config.classes.buttonActive,
        activeContainerClass: config.classes.contentActive,
        method: 'click',
        scrollToContent: true,
      };

      contentToggler.init(options);
    }

    if (config.buttons) {
      var first = options.buttonFirst;
      first.classList.add(config.classes.buttonActive);

      Array.prototype.forEach.call(config.buttons, function (button) {
        button.addEventListener('click', function (el) {
          _toggleActive(button);
        });
      });
    }
  };

  var _toggleActive = function (button) {
    _removeActiveClass();

    if (button.classList.contains(config.classes.buttonActive)) {
      button.classList.remove(config.classes.buttonActive);
    } else {
      button.classList.add(config.classes.buttonActive);
    }
  };

  var _removeActiveClass = function () {
    Array.prototype.forEach.call(config.buttons, function (button) {
      button.classList.remove(config.classes.buttonActive);
    });
  };

  return {
    init: init,
  };
}());

/**
 * Init PiTelefones constructor
 * @return {void} PiTelefones.init();
 */
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelectorAll('.pi-telefones').length) {
    PiTelefones.init();
  }
});

/**
 * Formulrio de Relao de Planos
 */
document.addEventListener('DOMContentLoaded', function () {
  var formPlanos = document.querySelector('.bs-js-form-planos');
  var formSelects = [];
  var resetSelects = function (selects) {
    Array.prototype.forEach.call(selects, function (select) {
      var options = select.querySelectorAll('option');
      options[0].selected = 'selected';
    });
  };

  if (formPlanos) {
    formSelects = formPlanos.querySelectorAll('select');
  }

  Array.prototype.forEach.call(formSelects, function (select) {
    select.addEventListener('change', function () {
      var selectsToReset = Array.prototype.filter.call(formSelects, function (el) {
        return el !== select;
      });
      resetSelects(selectsToReset);
    });
  });
});

/**
 * Modal/Tabela de seleo de planos
 */
document.addEventListener('DOMContentLoaded', function () {
  var input = document.querySelector('.bs-js-selecione-plano-input');
  var modal = document.querySelector('#modal-selecione-plano');
  var planSelector = document.querySelectorAll('.bs-js-selecione-plano');

  if (planSelector.length) {
    Array.prototype.forEach.call(planSelector, function (selector) {
      selector.addEventListener('click', function () {
        var selectorName = selector.getAttribute('data-plano');
        input.value = selectorName;
        BsModal.close(modal);
      });
    });
  }
});

/**
 * BsSelectFilter
 * @return {Object} methods
 */
var BsSelectFilter = function () {
  var config = {};

  var setConfig = function (options) {
    var defaults = {
      input: 'input',
      list: 'ul',
      apply: '',
      listOfTerms: [],
      items: [],
      selectedItems: [],
      filteredItems: [],
      selectMultiple: false,
      autoApply: false,
      showApplyButton: false,
      applyButtonClass: 'bs-select-filter__apply',
      applyButtonActiveClass: 'bs-select-filter__apply--active',
      itemSelect: function () {},
      itemUnselect: function () {},
      itemsApply: function () {},
      listFilter: function () {},
    };

    if (typeof options !== 'object') options = {};
    return extend({}, defaults, options);
  };

  var extend = function (target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];

      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }

    return target;
  };

  var init = function (el, options) {
    var selectFilter = el;

    config = setConfig(options);
    if (!selectFilter) return;

    config.input = selectFilter.querySelector(config.input);
    config.list = selectFilter.querySelector(config.list);
    config.list.classList.add('bs-select-filter__list');
    config.selectFilter = selectFilter;

    if (config.showApplyButton) createApplyButton();

    buildItems(config.list, {
      itemClass: 'bs-select-filter__item',
      itemLinkClass: 'bs-select-filter__link',
    });

    config.input.addEventListener('input', function (event) {
      config.searchTerm = event.target.value;
      filterList();
    });
  };

  var setItemsEvent = function (items) {
    Array.prototype.forEach.call(items, function (item) {
      item.addEventListener('click', function () {
        if (!isSelectedItem(item)) {
          selectItem(item);
          if (!config.selectMultiple && config.autoApply) {
            applyItems([item]);
          } else {
            toggleApplyButton(true);
          }
        } else {
          unselectItem(item);
          if (config.selectMultiple && !config.selectedItems.length) {
            toggleApplyButton(false);
          }
        }
      });
    });
  };

  var buildItems = function (listElement, options) {
    var items = [
      {
        link: '#!',
        content: 'Lorem ipsum',
      },
      {
        link: '#!',
        content: 'Lorem ipsum dolor',
      },
      {
        link: '#!',
        content: 'Lorem ipsum dolor sit amet consectetur',
      },
      {
        link: '#!',
        content: 'Adipisicing elit',
      },
      {
        link: '#!',
        content: 'Sed do eiusmod tempor',
      },
      {
        link: '#!',
        content: 'Incididunt ut labore',
      },
      {
        link: '#!',
        content: 'Ut enim ad minim veniam',
      },
      {
        link: '#!',
        content: 'Aliquip ex ea commodo',
      },
      {
        link: '#!',
        content: 'Quis nostrud exercitation ullamco',
      },
      {
        link: '#!',
        content: 'Laboris nisi ut',
      },
      {
        link: '#!',
        content: 'Et dolore magna aliqua',
      },
      {
        link: '#!',
        content: 'Consequat',
      },
      {
        link: '#!',
        content: 'Duis aute irure dolor',
      },
      {
        link: '#!',
        content: 'In reprehenderit',
      },
      {
        link: '#!',
        content: 'In voluptate velit',
      },
      {
        link: '#!',
        content: 'Esse cillum',
      },
      {
        link: '#!',
        content: 'Dolore eu fugiat nulla pariatur',
      },
      {
        link: '#!',
        content: 'Excepteur sint',
      },
    ];
    var settings = extend({
      itemClass: '',
      itemLinkClass: '',
    }, options);

    items.forEach(function (item, index) {
      var li = document.createElement('li');
      var contentElement = li;
      var anchor;

      li.classList.add(settings.itemClass);

      if (item.link) {
        anchor = document.createElement('a');
        anchor.classList.add(settings.itemLinkClass);
        anchor.href = item.link;
        contentElement = anchor;
        li.appendChild(anchor);
      }

      contentElement.innerText = item.content;
      listElement.appendChild(li);
      items[index].element = li;
    });
    config.listOfTerms = items;
    config.items = config.listOfTerms.map(function (item) {
      return item.element;
    });

    setItemsEvent(config.items);
  };

  var filterList = function (list) {
    var filtered = [];
    list = config.items;

    config.filteredItems = [];

    list.forEach(function (item) {
      var span = document.createElement('span');
      var element;
      var content;
      var contentHighlighted;

      if (!(item instanceof Element)) throw Error('item must be a valid DOM element');

      // TODO: test to get by class, not tag
      // TODO: add statement if there's no anchor some child
      if (item.children.length && item.children[0].tagName === 'A') element = item.children[0];

      content = element.textContent;
      contentHighlighted = highlightTerms(content, config.searchTerm) || '';

      span.innerHTML = contentHighlighted;
      span.setAttribute('data-value', content);
      element.innerHTML = '';
      element.appendChild(span);

      if (contentHighlighted !== content) {
        config.filteredItems.push(item);
      }
    });

    config.listFilter(config.filteredItems);
  };

  // To be external
  var setHighlightedItem = function (item) {

  };

  var selectItem = function (item) {
    config.selectedItems.push(item);
    item.classList.add('bs-select-filter__item--selected');
    config.itemSelect(item);
  };

  var unselectItem = function (item) {
    var index = config.selectedItems.indexOf(item);
    if (index > -1) config.selectedItems.splice(index, 1);
    item.classList.remove('bs-select-filter__item--selected');
    config.itemUnselect(item);
  };

  var unselectAllItems = function () {
    var items = config.selectedItems.map(function (item) {
      return item;
    });
    items.forEach(unselectItem);
    toggleApplyButton(false);
  };

  var isSelectedItem = function (item) {
    return item.classList.contains('bs-select-filter__item--selected');
  };

  var toggleApplyButton = function (show) {
    if (!config.apply) return;
    // show/hide
    if (typeof show === 'boolean') {
      // show
      if (show) config.apply.classList.add(config.applyButtonActiveClass);
      // hide
      else config.apply.classList.remove(config.applyButtonActiveClass);
    // toggle
    } else if (typeof show === 'undefined') {
      // hide
      if (config.apply.classList.contains(config.applyButtonActiveClass)) {
        config.apply.classList.remove(config.applyButtonActiveClass);
      // show
      } else {
        config.apply.classList.add(config.applyButtonActiveClass);
      }
    }
  };

  var createApplyButton = function () {
    var div = document.createElement('div');
    var button = document.createElement('button');
    button.setAttribute('type', 'button');
    button.className = config.applyButtonClass;
    button.innerText = 'Aplicar';
    button.addEventListener('click', function () {
      applyItems(config.selectedItems);
    });
    config.apply = button;
    div.appendChild(button);
    config.list.parentNode.insertBefore(div, config.list.nextSibling);
  };

  var applyItems = function (items) {
    config.itemsApply(items);
  };

  var getFilter = function () {
    return config.selectFilter;
  };

  var getItems = function () {
    return config.items;
  };

  var getSelectedItems = function () {
    return config.selectedItems;
  };

  var getFilteredItems = function () {
    return config.filteredItems;
  };

  var on = function (ev, cb) {
    if (typeof ev !== 'string' || typeof cb !== 'function') return;
    if (config[ev]) config[ev] = cb;
  };

  // var addItem = function (item) {
  //   var li = document.createElement('li');
  //   var anchor;
  //   var contents;
  //
  //   if (!item || !item.content.length) return;
  //
  //   if (typeof item.content === 'string') contents = [item.content];
  //   else if (Array.isArray(item.content)) contents = item.content;
  //   else console.error('item content should be a string or an array of strings');
  //
  //   li.classList.add(config.itemClass);
  //
  //   if (item.link) {
  //     anchor = document.createElement('a');
  //     anchor.classList.add(config.itemLinkClass);
  //     anchor.href = item.link;
  //     li.appendChild(anchor);
  //   }
  //
  //   contents.forEach(function (content, index) {
  //     var span = document.createElement('span');
  //     var contentHighlighted = highlightTerm(content, config.searchTerm) || '';
  //     span.innerHTML = contentHighlighted || content;
  //     span.setAttribute('data-value', content);
  //     if (config.contentClasses.length) span.classList.add(config.contentClasses[index]);
  //     if (anchor) anchor.appendChild(span);
  //     else li.appendChild(span);
  //   });
  //
  //   return li;
  // };

  var highlightTerms = function (str, term) {
    // Array to store strings before join
    var occurrencesString = [];

    // Check if both parameters was passed
    if (typeof str === 'undefined' ||
      typeof term === 'undefined') return;

    /**
     * Loop through parts of str to check if it has term in
     * @param {String} strPart some string where to find out term
     */
    var allIndex = function (strPart) {
      var realString = '';
      var newString = '';
      var idx;
      // check if strPart has term,
      idx = indexOfSpecial(strPart, term);
      if (idx > -1) {
        // store the realString
        realString = strPart.substring(idx, idx + term.length);
        newString = '<b>' + realString + '</b>';
        // store the part of the strPart before realString and realString replaced
        // with bold HTML tags
        strBefore = strPart.substring(0, idx + realString.length).replace(realString, newString);
        // store the part of the strPart after realString
        strAfter = strPart.substring(idx + realString.length);
        // push strBefore to the occurrencesString
        occurrencesString.push(strBefore);
        // if strAfter not empty, pass it to allIndex function
        if (strAfter) allIndex(strAfter);
      } else {
        // if strPart has not term in, push it to the end of occurrencesString
        occurrencesString.push(strPart);
      }
    };

    // run allIndex
    allIndex(str);

    // return str replaced term bold
    return occurrencesString.join('');
  };

  return {
    init: init,
    element: getFilter,
    on: on,
    selectItem: selectItem,
    unselectItem: unselectItem,
    unselectAllItems: unselectAllItems,
    applyItems: applyItems,
    filterList: filterList,
    // highlight: setHighlightedItem,
    items: getItems,
    selectedItems: getSelectedItems,
    filteredItems: getFilteredItems,
  };
};

/**
 * Filtro Lateral do Localizador
 * @component BsSelectFilter.init();
 * @component BsListAccordion.expand();
 */
document.addEventListener('DOMContentLoaded', function () {
  var expandTableRowButtons = document.querySelectorAll('.bs-js-expand-table-row');
  Array.prototype.forEach.call(expandTableRowButtons, function (button) {
    button.addEventListener('click', function (ev) {
      var parentRow = button.closest('tr');
      if (parentRow.classList.contains('bs-is-active')) {
        parentRow.classList.remove('bs-is-active');
      } else {
        parentRow.classList.add('bs-is-active');
      }
    })
  })
});

document.addEventListener('DOMContentLoaded', function () {
  var fixedOnScroll = document.querySelectorAll('.bs-js-scroll-fixed');
  if (!fixedOnScroll.length) return;

  Array.prototype.forEach.call(fixedOnScroll, function (elem) {
    window.addEventListener('scroll', function () {
      var padding = 15;
      var header = document.querySelector('.bs-header');
      var headerHeight = header.offsetHeight;
      var headerIsFloating = header.classList.contains('bs-header--floating');
      var headerIsPinned = header.classList.contains('bs-header--pinned');
      var elParentTop = elem.parentNode.offsetTop;
      var elTopPosition = 0;
      var scrollTop = (window.pageYOffset || document.documentElement.scrollTop);
      var parentSection = elem.closest('.bs-section');

      if (scrollTop > elParentTop && headerIsPinned) {
        // scrollTop += headerHeight;
      }

      if (scrollTop > elParentTop) {
        if (headerIsFloating && headerIsPinned) {
          elTopPosition = padding + headerHeight + 'px';
        } else if (headerIsFloating && scrollTop > elParentTop) {
          elTopPosition = padding + 0 + 'px';
        } else {
          elTopPosition = 0;
        }
      } else {
        elTopPosition = 0;
      }

      if (scrollTop > elParentTop) {
        elem.style.top = elTopPosition;
        elem.style.right = (window.innerWidth - elem.parentNode.getBoundingClientRect().right) + 'px';
        elem.classList.add('bs-is-fixed');

        if (scrollTop < parentSection.offsetHeight) {
          elem.classList.add('bs-is-floating');
        } else {
          elem.style.top = 0;
          elem.style.right = 0;
          elem.classList.remove('bs-is-floating');
        }
      } else {
        elem.style.top = elTopPosition;
        elem.style.right = '';
        elem.classList.remove('bs-is-floating');
        elem.classList.remove('bs-is-fixed');
      }
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vbWVudC5taW4uanMiLCJhY2NvcmRpb25qcy5taW4uanMiLCJDaGFydC5taW4uanMiLCJjbG9zZXN0LnBvbHlmaWxsLmpzIiwiZHJhZ3VsYS5taW4uanMiLCJlczYtcHJvbWlzZS5hdXRvLm1pbi5qcyIsImVzNi1wcm9taXNlLm1pbi5qcyIsIkZpbGVTYXZlci5taW4uanMiLCJmbGlja2l0eS5wa2dkLm1pbi5qcyIsImltYXNrLmpzIiwiaXNvdG9wZS5wa2dkLm1pbi5qcyIsImpzemlwLm1pbi5qcyIsImxncGQubWluLmpzIiwibGlnaHRwaWNrLmpzIiwib2ZpLm1pbi5qcyIsInBhY2tlcnktbW9kZS5wa2dkLm1pbi5qcyIsInBpY3R1cmVmaWxsLm1pbi5qcyIsInBpa2FkYXkuanMiLCJzY3JvbGxyZXZlYWwubWluLmpzIiwic2hhdmUubWluLmpzIiwic2ltcGxlLW1hc2stbW9uZXktLWVkaXRlZC5qcyIsInNtb290aC1zY3JvbGwubWluLmpzIiwidGFibGVzb3J0Lm1pbi5qcyIsInRpcHB5LmFsbC5taW4uanMiLCJhY3RpdmF0aW9uQ29kZVZhbGlkYXRlLmpzIiwiYmFja1RvVG9wLmpzIiwiQnJvd3NlclVwZGF0ZS5qcyIsIkJzRml4UG9ydGFsSFRNTC5qcyIsImJzSGVscGVycy5qcyIsIkNvbnRlbnRDaGFuZ2VyLmpzIiwiRHJvcGRvd24uanMiLCJleHBhbmRDb250ZW50LmpzIiwiZm9jdXNBY2Vzc2liaWxpdHlQb2x5ZmlsbC5qcyIsIkZvcm1zLmpzIiwiZm9ybVN0ZXBzLmpzIiwiZm9ybVZhbGlkYXRlLmpzIiwiaW1hZ2VQYXJhbGxheC5qcyIsIklucHV0TWFza3MuanMiLCJtYXBzLmpzIiwib2JqZWN0LXZhbHVlcy5wb2x5ZmlsbC5qcyIsInBvbHlmaWxsLmpzIiwic2hpZnRTZWxlY3RNdWx0aXBsZUNoZWNrYm94ZXMuanMiLCJzdHJpbmcuaW5jbHVkZXMucG9sbHlmaWxsLmpzIiwiVGFibGVTb3J0LmpzIiwiVGV4dEVsbGlwc2lzLmpzIiwidGV4dFR5cGUuanMiLCJ0b2dnbGVDb250ZW50LmpzIiwiVG9nZ2xlSW5wdXRQYXNzd29yZFZhbHVlLmpzIiwiWVRQbGF5ZXJzLmpzIiwiQWJhTmF2LmpzIiwiQWNjZXNzaWJpbGl0eS5qcyIsIkFjY29yZGlvbi5qcyIsIkFjZXNzb1JhcGlkby5qcyIsIkF1ZGlvLmpzIiwiQXVkaW9CdXR0b25zLmpzIiwiYmFubmVyVG9wby5qcyIsIkJveERyb3Bkb3duLmpzIiwiQm94TGlua3MuanMiLCJCb3hMaXN0Rm9uZVJlZmFjdG9yZWQuanMiLCJCb3hMaXN0UmVmYWN0b3JlZC5qcyIsIkNhcmRGbGlwLmpzIiwiQ2Fycm91c2VsUHJvZHV0b3MuanMiLCJDb21wYXJlLmpzIiwiQ29udGV4dE1lbnUuanMiLCJEYXRlUGljay5qcyIsIkRpYWxQYWQuanMiLCJEcm9wZG93bk1lbnUuanMiLCJGYXFSZWZhY3RvcmVkLmpzIiwiRmFxVm9pcC5qcyIsIkZpbHRlci5qcyIsIkZvb3Rlci5qcyIsIkZvb3RlclJlZmFjdG9yZWQuanMiLCJHYWxsZXJ5LmpzIiwiR3JpZC5qcyIsIkhlYWRlci1vbGQuanMiLCJIZWFkZXIuanMiLCJoZWFkZXJSZWZhY3RvcmVkLmpzIiwiSWNvbk1lZGlhUmVmYWN0b3JlZC5qcyIsImxncGQuanMiLCJsaXN0QWNjb3JkaW9uLmpzIiwibGlzdERvd25sb2FkLmpzIiwiTG9naW5WaWRhLmpzIiwiTWFwLmpzIiwiTWVkaWEuanMiLCJNZWRpYVJlZmFjdG9yZWQuanMiLCJNZW51LmpzIiwiTWVudURyb3Bkb3duLmpzIiwiTW9kYWwuanMiLCJNb2RhbEFsZXJ0LmpzIiwiTW9kYWxGaWx0ZXJMaXN0LmpzIiwiTW9zYWljby5qcyIsIk11cmFsLmpzIiwiTXVyYWxSZWZhY3RvcmVkLmpzIiwiTmF2LmpzIiwiTmV3c01ldGEuanMiLCJPdmVyZmxvd01lbnUuanMiLCJQcm9ncmVzcy5qcyIsIlF1aWNrQWNlc3MuanMiLCJRdWlja0FjZXNzSWNvbi1kZXByZWNhdGVkLmpzIiwicXVpY2tNZW51LmpzIiwiUXVpY2tNZW51RHJvcERvd24tZGVwcmVjYXRlZC5qcyIsIlJhZGlvLmpzIiwiU2VhcmNoRW1wdHkuanMiLCJzZWFyY2hGb3JtLmpzIiwiU2VhcmNoSGVscC5qcyIsInNlYXJjaFN1Z2dlc3Rpb25zLmpzIiwiU25hY2tiYXIuanMiLCJTb2NpYWxTaGFyZS5qcyIsIlN0aWNreU5hdi5qcyIsIlRhYmxlQ29sbGFwc2libGUuanMiLCJUYWJzLmpzIiwiVGVsZWNvcmRpb24uanMiLCJUaW1lTGluZS5qcyIsIlRvb2x0aXAuanMiLCJUb3BNZW51LmpzIiwidm9pcEFwcC5qcyIsInNjcmlwdHMuanMiLCJicm93c2VyLWNoZWNrZWQuanMiLCJlc3RhY2lvbmFtZW50b3MuanMiLCJmb3JtLWNyZWRlbmNpYWRvLmpzIiwiZm9ybS1mYWxlLWNvbm9zY28uanMiLCJmb3JtLWxlYWRzLmpzIiwiZm9ybS1vdXZpZG9yaWEuanMiLCJmb3JtLXBsYW5vcy1wb3ItY3JlZGVuY2lhZG8uanMiLCJmb3JtLXNhbGEtaW1wcmVuc2EuanMiLCJsb2NhbGl6YWRvci5qcyIsImxvZ2luLmpzIiwibm90aWNpYXMuanMiLCJvdXZpZG9yaWEuanMiLCJwaS1ub3Nzb3MtYXBwcy5qcyIsInBpLXRlbGVmb25lcy5qcyIsInNhdWRlLXBsYW5vcy5qcyIsInNlbGVjaW9uZS1wbGFub3MuanMiLCJzZWxlY3RGaWx0ZXIuanMiLCJ0YWJlbG9yZGVvbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2ZBO0FDQUE7QUFDQTtBQ0RBO0FBQ0E7QUNEQTtBQUNBO0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3d0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2RBO0FBQ0E7QUFDQTtBQ0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcnZDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMXNDQTtBQUNBO0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsUEE7QUFDQTtBQUNBO0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDWEE7QUFDQTtBQUNBO0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNySEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzlEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcGhCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzlGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2hQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0VEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDekZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1VkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDckVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pLQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQy9YQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3pqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3RIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNoRUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQy9OQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDekxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNoSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0tBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDOUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNyOUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDL3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6VkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2ZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbE9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdlVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN4SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNoREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDN0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNuUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDNU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDOUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQy9DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdlBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1M0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDOUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM1FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzlGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDNUJBO0FBQ0E7QUFDQTtBQUNBO0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNqRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDekVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcFNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDL0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNsQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QWxCbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoic2NyaXB0cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIiFmdW5jdGlvbihlLHQpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPXQoKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKHQpOmUubW9tZW50PXQoKX0odGhpcyxmdW5jdGlvbigpe1widXNlIHN0cmljdFwiO3ZhciBlLGk7ZnVuY3Rpb24gYygpe3JldHVybiBlLmFwcGx5KG51bGwsYXJndW1lbnRzKX1mdW5jdGlvbiBvKGUpe3JldHVybiBlIGluc3RhbmNlb2YgQXJyYXl8fFwiW29iamVjdCBBcnJheV1cIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKX1mdW5jdGlvbiB1KGUpe3JldHVybiBudWxsIT1lJiZcIltvYmplY3QgT2JqZWN0XVwiPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpfWZ1bmN0aW9uIGwoZSl7cmV0dXJuIHZvaWQgMD09PWV9ZnVuY3Rpb24gZChlKXtyZXR1cm5cIm51bWJlclwiPT10eXBlb2YgZXx8XCJbb2JqZWN0IE51bWJlcl1cIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKX1mdW5jdGlvbiBoKGUpe3JldHVybiBlIGluc3RhbmNlb2YgRGF0ZXx8XCJbb2JqZWN0IERhdGVdXCI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZSl9ZnVuY3Rpb24gZihlLHQpe3ZhciBuLHM9W107Zm9yKG49MDtuPGUubGVuZ3RoOysrbilzLnB1c2godChlW25dLG4pKTtyZXR1cm4gc31mdW5jdGlvbiBtKGUsdCl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpfWZ1bmN0aW9uIF8oZSx0KXtmb3IodmFyIG4gaW4gdCltKHQsbikmJihlW25dPXRbbl0pO3JldHVybiBtKHQsXCJ0b1N0cmluZ1wiKSYmKGUudG9TdHJpbmc9dC50b1N0cmluZyksbSh0LFwidmFsdWVPZlwiKSYmKGUudmFsdWVPZj10LnZhbHVlT2YpLGV9ZnVuY3Rpb24geShlLHQsbixzKXtyZXR1cm4gT3QoZSx0LG4scywhMCkudXRjKCl9ZnVuY3Rpb24gZyhlKXtyZXR1cm4gbnVsbD09ZS5fcGYmJihlLl9wZj17ZW1wdHk6ITEsdW51c2VkVG9rZW5zOltdLHVudXNlZElucHV0OltdLG92ZXJmbG93Oi0yLGNoYXJzTGVmdE92ZXI6MCxudWxsSW5wdXQ6ITEsaW52YWxpZE1vbnRoOm51bGwsaW52YWxpZEZvcm1hdDohMSx1c2VySW52YWxpZGF0ZWQ6ITEsaXNvOiExLHBhcnNlZERhdGVQYXJ0czpbXSxtZXJpZGllbTpudWxsLHJmYzI4MjI6ITEsd2Vla2RheU1pc21hdGNoOiExfSksZS5fcGZ9ZnVuY3Rpb24gcChlKXtpZihudWxsPT1lLl9pc1ZhbGlkKXt2YXIgdD1nKGUpLG49aS5jYWxsKHQucGFyc2VkRGF0ZVBhcnRzLGZ1bmN0aW9uKGUpe3JldHVybiBudWxsIT1lfSkscz0haXNOYU4oZS5fZC5nZXRUaW1lKCkpJiZ0Lm92ZXJmbG93PDAmJiF0LmVtcHR5JiYhdC5pbnZhbGlkTW9udGgmJiF0LmludmFsaWRXZWVrZGF5JiYhdC53ZWVrZGF5TWlzbWF0Y2gmJiF0Lm51bGxJbnB1dCYmIXQuaW52YWxpZEZvcm1hdCYmIXQudXNlckludmFsaWRhdGVkJiYoIXQubWVyaWRpZW18fHQubWVyaWRpZW0mJm4pO2lmKGUuX3N0cmljdCYmKHM9cyYmMD09PXQuY2hhcnNMZWZ0T3ZlciYmMD09PXQudW51c2VkVG9rZW5zLmxlbmd0aCYmdm9pZCAwPT09dC5iaWdIb3VyKSxudWxsIT1PYmplY3QuaXNGcm96ZW4mJk9iamVjdC5pc0Zyb3plbihlKSlyZXR1cm4gcztlLl9pc1ZhbGlkPXN9cmV0dXJuIGUuX2lzVmFsaWR9ZnVuY3Rpb24gdihlKXt2YXIgdD15KE5hTik7cmV0dXJuIG51bGwhPWU/XyhnKHQpLGUpOmcodCkudXNlckludmFsaWRhdGVkPSEwLHR9aT1BcnJheS5wcm90b3R5cGUuc29tZT9BcnJheS5wcm90b3R5cGUuc29tZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9T2JqZWN0KHRoaXMpLG49dC5sZW5ndGg+Pj4wLHM9MDtzPG47cysrKWlmKHMgaW4gdCYmZS5jYWxsKHRoaXMsdFtzXSxzLHQpKXJldHVybiEwO3JldHVybiExfTt2YXIgcj1jLm1vbWVudFByb3BlcnRpZXM9W107ZnVuY3Rpb24gdyhlLHQpe3ZhciBuLHMsaTtpZihsKHQuX2lzQU1vbWVudE9iamVjdCl8fChlLl9pc0FNb21lbnRPYmplY3Q9dC5faXNBTW9tZW50T2JqZWN0KSxsKHQuX2kpfHwoZS5faT10Ll9pKSxsKHQuX2YpfHwoZS5fZj10Ll9mKSxsKHQuX2wpfHwoZS5fbD10Ll9sKSxsKHQuX3N0cmljdCl8fChlLl9zdHJpY3Q9dC5fc3RyaWN0KSxsKHQuX3R6bSl8fChlLl90em09dC5fdHptKSxsKHQuX2lzVVRDKXx8KGUuX2lzVVRDPXQuX2lzVVRDKSxsKHQuX29mZnNldCl8fChlLl9vZmZzZXQ9dC5fb2Zmc2V0KSxsKHQuX3BmKXx8KGUuX3BmPWcodCkpLGwodC5fbG9jYWxlKXx8KGUuX2xvY2FsZT10Ll9sb2NhbGUpLDA8ci5sZW5ndGgpZm9yKG49MDtuPHIubGVuZ3RoO24rKylsKGk9dFtzPXJbbl1dKXx8KGVbc109aSk7cmV0dXJuIGV9dmFyIHQ9ITE7ZnVuY3Rpb24gTShlKXt3KHRoaXMsZSksdGhpcy5fZD1uZXcgRGF0ZShudWxsIT1lLl9kP2UuX2QuZ2V0VGltZSgpOk5hTiksdGhpcy5pc1ZhbGlkKCl8fCh0aGlzLl9kPW5ldyBEYXRlKE5hTikpLCExPT09dCYmKHQ9ITAsYy51cGRhdGVPZmZzZXQodGhpcyksdD0hMSl9ZnVuY3Rpb24gUyhlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIE18fG51bGwhPWUmJm51bGwhPWUuX2lzQU1vbWVudE9iamVjdH1mdW5jdGlvbiBEKGUpe3JldHVybiBlPDA/TWF0aC5jZWlsKGUpfHwwOk1hdGguZmxvb3IoZSl9ZnVuY3Rpb24gayhlKXt2YXIgdD0rZSxuPTA7cmV0dXJuIDAhPT10JiZpc0Zpbml0ZSh0KSYmKG49RCh0KSksbn1mdW5jdGlvbiBhKGUsdCxuKXt2YXIgcyxpPU1hdGgubWluKGUubGVuZ3RoLHQubGVuZ3RoKSxyPU1hdGguYWJzKGUubGVuZ3RoLXQubGVuZ3RoKSxhPTA7Zm9yKHM9MDtzPGk7cysrKShuJiZlW3NdIT09dFtzXXx8IW4mJmsoZVtzXSkhPT1rKHRbc10pKSYmYSsrO3JldHVybiBhK3J9ZnVuY3Rpb24gWShlKXshMT09PWMuc3VwcHJlc3NEZXByZWNhdGlvbldhcm5pbmdzJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgY29uc29sZSYmY29uc29sZS53YXJuJiZjb25zb2xlLndhcm4oXCJEZXByZWNhdGlvbiB3YXJuaW5nOiBcIitlKX1mdW5jdGlvbiBuKGkscil7dmFyIGE9ITA7cmV0dXJuIF8oZnVuY3Rpb24oKXtpZihudWxsIT1jLmRlcHJlY2F0aW9uSGFuZGxlciYmYy5kZXByZWNhdGlvbkhhbmRsZXIobnVsbCxpKSxhKXtmb3IodmFyIGUsdD1bXSxuPTA7bjxhcmd1bWVudHMubGVuZ3RoO24rKyl7aWYoZT1cIlwiLFwib2JqZWN0XCI9PXR5cGVvZiBhcmd1bWVudHNbbl0pe2Zvcih2YXIgcyBpbiBlKz1cIlxcbltcIituK1wiXSBcIixhcmd1bWVudHNbMF0pZSs9cytcIjogXCIrYXJndW1lbnRzWzBdW3NdK1wiLCBcIjtlPWUuc2xpY2UoMCwtMil9ZWxzZSBlPWFyZ3VtZW50c1tuXTt0LnB1c2goZSl9WShpK1wiXFxuQXJndW1lbnRzOiBcIitBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0KS5qb2luKFwiXCIpK1wiXFxuXCIrKG5ldyBFcnJvcikuc3RhY2spLGE9ITF9cmV0dXJuIHIuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxyKX12YXIgcyxPPXt9O2Z1bmN0aW9uIFQoZSx0KXtudWxsIT1jLmRlcHJlY2F0aW9uSGFuZGxlciYmYy5kZXByZWNhdGlvbkhhbmRsZXIoZSx0KSxPW2VdfHwoWSh0KSxPW2VdPSEwKX1mdW5jdGlvbiB4KGUpe3JldHVybiBlIGluc3RhbmNlb2YgRnVuY3Rpb258fFwiW29iamVjdCBGdW5jdGlvbl1cIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKX1mdW5jdGlvbiBiKGUsdCl7dmFyIG4scz1fKHt9LGUpO2ZvcihuIGluIHQpbSh0LG4pJiYodShlW25dKSYmdSh0W25dKT8oc1tuXT17fSxfKHNbbl0sZVtuXSksXyhzW25dLHRbbl0pKTpudWxsIT10W25dP3Nbbl09dFtuXTpkZWxldGUgc1tuXSk7Zm9yKG4gaW4gZSltKGUsbikmJiFtKHQsbikmJnUoZVtuXSkmJihzW25dPV8oe30sc1tuXSkpO3JldHVybiBzfWZ1bmN0aW9uIFAoZSl7bnVsbCE9ZSYmdGhpcy5zZXQoZSl9Yy5zdXBwcmVzc0RlcHJlY2F0aW9uV2FybmluZ3M9ITEsYy5kZXByZWNhdGlvbkhhbmRsZXI9bnVsbCxzPU9iamVjdC5rZXlzP09iamVjdC5rZXlzOmZ1bmN0aW9uKGUpe3ZhciB0LG49W107Zm9yKHQgaW4gZSltKGUsdCkmJm4ucHVzaCh0KTtyZXR1cm4gbn07dmFyIFc9e307ZnVuY3Rpb24gSChlLHQpe3ZhciBuPWUudG9Mb3dlckNhc2UoKTtXW25dPVdbbitcInNcIl09V1t0XT1lfWZ1bmN0aW9uIFIoZSl7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGU/V1tlXXx8V1tlLnRvTG93ZXJDYXNlKCldOnZvaWQgMH1mdW5jdGlvbiBDKGUpe3ZhciB0LG4scz17fTtmb3IobiBpbiBlKW0oZSxuKSYmKHQ9UihuKSkmJihzW3RdPWVbbl0pO3JldHVybiBzfXZhciBGPXt9O2Z1bmN0aW9uIEwoZSx0KXtGW2VdPXR9ZnVuY3Rpb24gVShlLHQsbil7dmFyIHM9XCJcIitNYXRoLmFicyhlKSxpPXQtcy5sZW5ndGg7cmV0dXJuKDA8PWU/bj9cIitcIjpcIlwiOlwiLVwiKStNYXRoLnBvdygxMCxNYXRoLm1heCgwLGkpKS50b1N0cmluZygpLnN1YnN0cigxKStzfXZhciBOPS8oXFxbW15cXFtdKlxcXSl8KFxcXFwpPyhbSGhdbW0oc3MpP3xNb3xNTT9NP00/fERvfERERG98REQ/RD9EP3xkZGQ/ZD98ZG8/fHdbb3x3XT98V1tvfFddP3xRbz98WVlZWVlZfFlZWVlZfFlZWVl8WVl8Z2coZ2dnPyk/fEdHKEdHRz8pP3xlfEV8YXxBfGhoP3xISD98a2s/fG1tP3xzcz98U3sxLDl9fHh8WHx6ej98Wlo/fC4pL2csRz0vKFxcW1teXFxbXSpcXF0pfChcXFxcKT8oTFRTfExUfExMP0w/TD98bHsxLDR9KS9nLFY9e30sRT17fTtmdW5jdGlvbiBJKGUsdCxuLHMpe3ZhciBpPXM7XCJzdHJpbmdcIj09dHlwZW9mIHMmJihpPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbc10oKX0pLGUmJihFW2VdPWkpLHQmJihFW3RbMF1dPWZ1bmN0aW9uKCl7cmV0dXJuIFUoaS5hcHBseSh0aGlzLGFyZ3VtZW50cyksdFsxXSx0WzJdKX0pLG4mJihFW25dPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLm9yZGluYWwoaS5hcHBseSh0aGlzLGFyZ3VtZW50cyksZSl9KX1mdW5jdGlvbiBBKGUsdCl7cmV0dXJuIGUuaXNWYWxpZCgpPyh0PWoodCxlLmxvY2FsZURhdGEoKSksVlt0XT1WW3RdfHxmdW5jdGlvbihzKXt2YXIgZSxpLHQscj1zLm1hdGNoKE4pO2ZvcihlPTAsaT1yLmxlbmd0aDtlPGk7ZSsrKUVbcltlXV0/cltlXT1FW3JbZV1dOnJbZV09KHQ9cltlXSkubWF0Y2goL1xcW1tcXHNcXFNdLyk/dC5yZXBsYWNlKC9eXFxbfFxcXSQvZyxcIlwiKTp0LnJlcGxhY2UoL1xcXFwvZyxcIlwiKTtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHQsbj1cIlwiO2Zvcih0PTA7dDxpO3QrKyluKz14KHJbdF0pP3JbdF0uY2FsbChlLHMpOnJbdF07cmV0dXJuIG59fSh0KSxWW3RdKGUpKTplLmxvY2FsZURhdGEoKS5pbnZhbGlkRGF0ZSgpfWZ1bmN0aW9uIGooZSx0KXt2YXIgbj01O2Z1bmN0aW9uIHMoZSl7cmV0dXJuIHQubG9uZ0RhdGVGb3JtYXQoZSl8fGV9Zm9yKEcubGFzdEluZGV4PTA7MDw9biYmRy50ZXN0KGUpOyllPWUucmVwbGFjZShHLHMpLEcubGFzdEluZGV4PTAsbi09MTtyZXR1cm4gZX12YXIgWj0vXFxkLyx6PS9cXGRcXGQvLCQ9L1xcZHszfS8scT0vXFxkezR9LyxKPS9bKy1dP1xcZHs2fS8sQj0vXFxkXFxkPy8sUT0vXFxkXFxkXFxkXFxkPy8sWD0vXFxkXFxkXFxkXFxkXFxkXFxkPy8sSz0vXFxkezEsM30vLGVlPS9cXGR7MSw0fS8sdGU9L1srLV0/XFxkezEsNn0vLG5lPS9cXGQrLyxzZT0vWystXT9cXGQrLyxpZT0vWnxbKy1dXFxkXFxkOj9cXGRcXGQvZ2kscmU9L1p8WystXVxcZFxcZCg/Ojo/XFxkXFxkKT8vZ2ksYWU9L1swLTldezAsMjU2fVsnYS16XFx1MDBBMC1cXHUwNUZGXFx1MDcwMC1cXHVEN0ZGXFx1RjkwMC1cXHVGRENGXFx1RkRGMC1cXHVGRjA3XFx1RkYxMC1cXHVGRkVGXXsxLDI1Nn18W1xcdTA2MDAtXFx1MDZGRlxcL117MSwyNTZ9KFxccyo/W1xcdTA2MDAtXFx1MDZGRl17MSwyNTZ9KXsxLDJ9L2ksb2U9e307ZnVuY3Rpb24gdWUoZSxuLHMpe29lW2VdPXgobik/bjpmdW5jdGlvbihlLHQpe3JldHVybiBlJiZzP3M6bn19ZnVuY3Rpb24gbGUoZSx0KXtyZXR1cm4gbShvZSxlKT9vZVtlXSh0Ll9zdHJpY3QsdC5fbG9jYWxlKTpuZXcgUmVnRXhwKGRlKGUucmVwbGFjZShcIlxcXFxcIixcIlwiKS5yZXBsYWNlKC9cXFxcKFxcWyl8XFxcXChcXF0pfFxcWyhbXlxcXVxcW10qKVxcXXxcXFxcKC4pL2csZnVuY3Rpb24oZSx0LG4scyxpKXtyZXR1cm4gdHx8bnx8c3x8aX0pKSl9ZnVuY3Rpb24gZGUoZSl7cmV0dXJuIGUucmVwbGFjZSgvWy1cXC9cXFxcXiQqKz8uKCl8W1xcXXt9XS9nLFwiXFxcXCQmXCIpfXZhciBoZT17fTtmdW5jdGlvbiBjZShlLG4pe3ZhciB0LHM9bjtmb3IoXCJzdHJpbmdcIj09dHlwZW9mIGUmJihlPVtlXSksZChuKSYmKHM9ZnVuY3Rpb24oZSx0KXt0W25dPWsoZSl9KSx0PTA7dDxlLmxlbmd0aDt0KyspaGVbZVt0XV09c31mdW5jdGlvbiBmZShlLGkpe2NlKGUsZnVuY3Rpb24oZSx0LG4scyl7bi5fdz1uLl93fHx7fSxpKGUsbi5fdyxuLHMpfSl9dmFyIG1lPTAsX2U9MSx5ZT0yLGdlPTMscGU9NCx2ZT01LHdlPTYsTWU9NyxTZT04O2Z1bmN0aW9uIERlKGUpe3JldHVybiBrZShlKT8zNjY6MzY1fWZ1bmN0aW9uIGtlKGUpe3JldHVybiBlJTQ9PTAmJmUlMTAwIT0wfHxlJTQwMD09MH1JKFwiWVwiLDAsMCxmdW5jdGlvbigpe3ZhciBlPXRoaXMueWVhcigpO3JldHVybiBlPD05OTk5P1wiXCIrZTpcIitcIitlfSksSSgwLFtcIllZXCIsMl0sMCxmdW5jdGlvbigpe3JldHVybiB0aGlzLnllYXIoKSUxMDB9KSxJKDAsW1wiWVlZWVwiLDRdLDAsXCJ5ZWFyXCIpLEkoMCxbXCJZWVlZWVwiLDVdLDAsXCJ5ZWFyXCIpLEkoMCxbXCJZWVlZWVlcIiw2LCEwXSwwLFwieWVhclwiKSxIKFwieWVhclwiLFwieVwiKSxMKFwieWVhclwiLDEpLHVlKFwiWVwiLHNlKSx1ZShcIllZXCIsQix6KSx1ZShcIllZWVlcIixlZSxxKSx1ZShcIllZWVlZXCIsdGUsSiksdWUoXCJZWVlZWVlcIix0ZSxKKSxjZShbXCJZWVlZWVwiLFwiWVlZWVlZXCJdLG1lKSxjZShcIllZWVlcIixmdW5jdGlvbihlLHQpe3RbbWVdPTI9PT1lLmxlbmd0aD9jLnBhcnNlVHdvRGlnaXRZZWFyKGUpOmsoZSl9KSxjZShcIllZXCIsZnVuY3Rpb24oZSx0KXt0W21lXT1jLnBhcnNlVHdvRGlnaXRZZWFyKGUpfSksY2UoXCJZXCIsZnVuY3Rpb24oZSx0KXt0W21lXT1wYXJzZUludChlLDEwKX0pLGMucGFyc2VUd29EaWdpdFllYXI9ZnVuY3Rpb24oZSl7cmV0dXJuIGsoZSkrKDY4PGsoZSk/MTkwMDoyZTMpfTt2YXIgWWUsT2U9VGUoXCJGdWxsWWVhclwiLCEwKTtmdW5jdGlvbiBUZSh0LG4pe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZT8oYmUodGhpcyx0LGUpLGMudXBkYXRlT2Zmc2V0KHRoaXMsbiksdGhpcyk6eGUodGhpcyx0KX19ZnVuY3Rpb24geGUoZSx0KXtyZXR1cm4gZS5pc1ZhbGlkKCk/ZS5fZFtcImdldFwiKyhlLl9pc1VUQz9cIlVUQ1wiOlwiXCIpK3RdKCk6TmFOfWZ1bmN0aW9uIGJlKGUsdCxuKXtlLmlzVmFsaWQoKSYmIWlzTmFOKG4pJiYoXCJGdWxsWWVhclwiPT09dCYma2UoZS55ZWFyKCkpJiYxPT09ZS5tb250aCgpJiYyOT09PWUuZGF0ZSgpP2UuX2RbXCJzZXRcIisoZS5faXNVVEM/XCJVVENcIjpcIlwiKSt0XShuLGUubW9udGgoKSxQZShuLGUubW9udGgoKSkpOmUuX2RbXCJzZXRcIisoZS5faXNVVEM/XCJVVENcIjpcIlwiKSt0XShuKSl9ZnVuY3Rpb24gUGUoZSx0KXtpZihpc05hTihlKXx8aXNOYU4odCkpcmV0dXJuIE5hTjt2YXIgbixzPSh0JShuPTEyKStuKSVuO3JldHVybiBlKz0odC1zKS8xMiwxPT09cz9rZShlKT8yOToyODozMS1zJTclMn1ZZT1BcnJheS5wcm90b3R5cGUuaW5kZXhPZj9BcnJheS5wcm90b3R5cGUuaW5kZXhPZjpmdW5jdGlvbihlKXt2YXIgdDtmb3IodD0wO3Q8dGhpcy5sZW5ndGg7Kyt0KWlmKHRoaXNbdF09PT1lKXJldHVybiB0O3JldHVybi0xfSxJKFwiTVwiLFtcIk1NXCIsMl0sXCJNb1wiLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubW9udGgoKSsxfSksSShcIk1NTVwiLDAsMCxmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkubW9udGhzU2hvcnQodGhpcyxlKX0pLEkoXCJNTU1NXCIsMCwwLGZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS5tb250aHModGhpcyxlKX0pLEgoXCJtb250aFwiLFwiTVwiKSxMKFwibW9udGhcIiw4KSx1ZShcIk1cIixCKSx1ZShcIk1NXCIsQix6KSx1ZShcIk1NTVwiLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQubW9udGhzU2hvcnRSZWdleChlKX0pLHVlKFwiTU1NTVwiLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQubW9udGhzUmVnZXgoZSl9KSxjZShbXCJNXCIsXCJNTVwiXSxmdW5jdGlvbihlLHQpe3RbX2VdPWsoZSktMX0pLGNlKFtcIk1NTVwiLFwiTU1NTVwiXSxmdW5jdGlvbihlLHQsbixzKXt2YXIgaT1uLl9sb2NhbGUubW9udGhzUGFyc2UoZSxzLG4uX3N0cmljdCk7bnVsbCE9aT90W19lXT1pOmcobikuaW52YWxpZE1vbnRoPWV9KTt2YXIgV2U9L0Rbb0RdPyhcXFtbXlxcW1xcXV0qXFxdfFxccykrTU1NTT8vLEhlPVwiSmFudWFyeV9GZWJydWFyeV9NYXJjaF9BcHJpbF9NYXlfSnVuZV9KdWx5X0F1Z3VzdF9TZXB0ZW1iZXJfT2N0b2Jlcl9Ob3ZlbWJlcl9EZWNlbWJlclwiLnNwbGl0KFwiX1wiKTt2YXIgUmU9XCJKYW5fRmViX01hcl9BcHJfTWF5X0p1bl9KdWxfQXVnX1NlcF9PY3RfTm92X0RlY1wiLnNwbGl0KFwiX1wiKTtmdW5jdGlvbiBDZShlLHQpe3ZhciBuO2lmKCFlLmlzVmFsaWQoKSlyZXR1cm4gZTtpZihcInN0cmluZ1wiPT10eXBlb2YgdClpZigvXlxcZCskLy50ZXN0KHQpKXQ9ayh0KTtlbHNlIGlmKCFkKHQ9ZS5sb2NhbGVEYXRhKCkubW9udGhzUGFyc2UodCkpKXJldHVybiBlO3JldHVybiBuPU1hdGgubWluKGUuZGF0ZSgpLFBlKGUueWVhcigpLHQpKSxlLl9kW1wic2V0XCIrKGUuX2lzVVRDP1wiVVRDXCI6XCJcIikrXCJNb250aFwiXSh0LG4pLGV9ZnVuY3Rpb24gRmUoZSl7cmV0dXJuIG51bGwhPWU/KENlKHRoaXMsZSksYy51cGRhdGVPZmZzZXQodGhpcywhMCksdGhpcyk6eGUodGhpcyxcIk1vbnRoXCIpfXZhciBMZT1hZTt2YXIgVWU9YWU7ZnVuY3Rpb24gTmUoKXtmdW5jdGlvbiBlKGUsdCl7cmV0dXJuIHQubGVuZ3RoLWUubGVuZ3RofXZhciB0LG4scz1bXSxpPVtdLHI9W107Zm9yKHQ9MDt0PDEyO3QrKyluPXkoWzJlMyx0XSkscy5wdXNoKHRoaXMubW9udGhzU2hvcnQobixcIlwiKSksaS5wdXNoKHRoaXMubW9udGhzKG4sXCJcIikpLHIucHVzaCh0aGlzLm1vbnRocyhuLFwiXCIpKSxyLnB1c2godGhpcy5tb250aHNTaG9ydChuLFwiXCIpKTtmb3Iocy5zb3J0KGUpLGkuc29ydChlKSxyLnNvcnQoZSksdD0wO3Q8MTI7dCsrKXNbdF09ZGUoc1t0XSksaVt0XT1kZShpW3RdKTtmb3IodD0wO3Q8MjQ7dCsrKXJbdF09ZGUoclt0XSk7dGhpcy5fbW9udGhzUmVnZXg9bmV3IFJlZ0V4cChcIl4oXCIrci5qb2luKFwifFwiKStcIilcIixcImlcIiksdGhpcy5fbW9udGhzU2hvcnRSZWdleD10aGlzLl9tb250aHNSZWdleCx0aGlzLl9tb250aHNTdHJpY3RSZWdleD1uZXcgUmVnRXhwKFwiXihcIitpLmpvaW4oXCJ8XCIpK1wiKVwiLFwiaVwiKSx0aGlzLl9tb250aHNTaG9ydFN0cmljdFJlZ2V4PW5ldyBSZWdFeHAoXCJeKFwiK3Muam9pbihcInxcIikrXCIpXCIsXCJpXCIpfWZ1bmN0aW9uIEdlKGUpe3ZhciB0PW5ldyBEYXRlKERhdGUuVVRDLmFwcGx5KG51bGwsYXJndW1lbnRzKSk7cmV0dXJuIGU8MTAwJiYwPD1lJiZpc0Zpbml0ZSh0LmdldFVUQ0Z1bGxZZWFyKCkpJiZ0LnNldFVUQ0Z1bGxZZWFyKGUpLHR9ZnVuY3Rpb24gVmUoZSx0LG4pe3ZhciBzPTcrdC1uO3JldHVybi0oKDcrR2UoZSwwLHMpLmdldFVUQ0RheSgpLXQpJTcpK3MtMX1mdW5jdGlvbiBFZShlLHQsbixzLGkpe3ZhciByLGEsbz0xKzcqKHQtMSkrKDcrbi1zKSU3K1ZlKGUscyxpKTtyZXR1cm4gbzw9MD9hPURlKHI9ZS0xKStvOm8+RGUoZSk/KHI9ZSsxLGE9by1EZShlKSk6KHI9ZSxhPW8pLHt5ZWFyOnIsZGF5T2ZZZWFyOmF9fWZ1bmN0aW9uIEllKGUsdCxuKXt2YXIgcyxpLHI9VmUoZS55ZWFyKCksdCxuKSxhPU1hdGguZmxvb3IoKGUuZGF5T2ZZZWFyKCktci0xKS83KSsxO3JldHVybiBhPDE/cz1hK0FlKGk9ZS55ZWFyKCktMSx0LG4pOmE+QWUoZS55ZWFyKCksdCxuKT8ocz1hLUFlKGUueWVhcigpLHQsbiksaT1lLnllYXIoKSsxKTooaT1lLnllYXIoKSxzPWEpLHt3ZWVrOnMseWVhcjppfX1mdW5jdGlvbiBBZShlLHQsbil7dmFyIHM9VmUoZSx0LG4pLGk9VmUoZSsxLHQsbik7cmV0dXJuKERlKGUpLXMraSkvN31JKFwid1wiLFtcInd3XCIsMl0sXCJ3b1wiLFwid2Vla1wiKSxJKFwiV1wiLFtcIldXXCIsMl0sXCJXb1wiLFwiaXNvV2Vla1wiKSxIKFwid2Vla1wiLFwid1wiKSxIKFwiaXNvV2Vla1wiLFwiV1wiKSxMKFwid2Vla1wiLDUpLEwoXCJpc29XZWVrXCIsNSksdWUoXCJ3XCIsQiksdWUoXCJ3d1wiLEIseiksdWUoXCJXXCIsQiksdWUoXCJXV1wiLEIseiksZmUoW1wid1wiLFwid3dcIixcIldcIixcIldXXCJdLGZ1bmN0aW9uKGUsdCxuLHMpe3Rbcy5zdWJzdHIoMCwxKV09ayhlKX0pO0koXCJkXCIsMCxcImRvXCIsXCJkYXlcIiksSShcImRkXCIsMCwwLGZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS53ZWVrZGF5c01pbih0aGlzLGUpfSksSShcImRkZFwiLDAsMCxmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkud2Vla2RheXNTaG9ydCh0aGlzLGUpfSksSShcImRkZGRcIiwwLDAsZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLndlZWtkYXlzKHRoaXMsZSl9KSxJKFwiZVwiLDAsMCxcIndlZWtkYXlcIiksSShcIkVcIiwwLDAsXCJpc29XZWVrZGF5XCIpLEgoXCJkYXlcIixcImRcIiksSChcIndlZWtkYXlcIixcImVcIiksSChcImlzb1dlZWtkYXlcIixcIkVcIiksTChcImRheVwiLDExKSxMKFwid2Vla2RheVwiLDExKSxMKFwiaXNvV2Vla2RheVwiLDExKSx1ZShcImRcIixCKSx1ZShcImVcIixCKSx1ZShcIkVcIixCKSx1ZShcImRkXCIsZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC53ZWVrZGF5c01pblJlZ2V4KGUpfSksdWUoXCJkZGRcIixmdW5jdGlvbihlLHQpe3JldHVybiB0LndlZWtkYXlzU2hvcnRSZWdleChlKX0pLHVlKFwiZGRkZFwiLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQud2Vla2RheXNSZWdleChlKX0pLGZlKFtcImRkXCIsXCJkZGRcIixcImRkZGRcIl0sZnVuY3Rpb24oZSx0LG4scyl7dmFyIGk9bi5fbG9jYWxlLndlZWtkYXlzUGFyc2UoZSxzLG4uX3N0cmljdCk7bnVsbCE9aT90LmQ9aTpnKG4pLmludmFsaWRXZWVrZGF5PWV9KSxmZShbXCJkXCIsXCJlXCIsXCJFXCJdLGZ1bmN0aW9uKGUsdCxuLHMpe3Rbc109ayhlKX0pO3ZhciBqZT1cIlN1bmRheV9Nb25kYXlfVHVlc2RheV9XZWRuZXNkYXlfVGh1cnNkYXlfRnJpZGF5X1NhdHVyZGF5XCIuc3BsaXQoXCJfXCIpO3ZhciBaZT1cIlN1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdFwiLnNwbGl0KFwiX1wiKTt2YXIgemU9XCJTdV9Nb19UdV9XZV9UaF9Gcl9TYVwiLnNwbGl0KFwiX1wiKTt2YXIgJGU9YWU7dmFyIHFlPWFlO3ZhciBKZT1hZTtmdW5jdGlvbiBCZSgpe2Z1bmN0aW9uIGUoZSx0KXtyZXR1cm4gdC5sZW5ndGgtZS5sZW5ndGh9dmFyIHQsbixzLGkscixhPVtdLG89W10sdT1bXSxsPVtdO2Zvcih0PTA7dDw3O3QrKyluPXkoWzJlMywxXSkuZGF5KHQpLHM9dGhpcy53ZWVrZGF5c01pbihuLFwiXCIpLGk9dGhpcy53ZWVrZGF5c1Nob3J0KG4sXCJcIikscj10aGlzLndlZWtkYXlzKG4sXCJcIiksYS5wdXNoKHMpLG8ucHVzaChpKSx1LnB1c2gociksbC5wdXNoKHMpLGwucHVzaChpKSxsLnB1c2gocik7Zm9yKGEuc29ydChlKSxvLnNvcnQoZSksdS5zb3J0KGUpLGwuc29ydChlKSx0PTA7dDw3O3QrKylvW3RdPWRlKG9bdF0pLHVbdF09ZGUodVt0XSksbFt0XT1kZShsW3RdKTt0aGlzLl93ZWVrZGF5c1JlZ2V4PW5ldyBSZWdFeHAoXCJeKFwiK2wuam9pbihcInxcIikrXCIpXCIsXCJpXCIpLHRoaXMuX3dlZWtkYXlzU2hvcnRSZWdleD10aGlzLl93ZWVrZGF5c1JlZ2V4LHRoaXMuX3dlZWtkYXlzTWluUmVnZXg9dGhpcy5fd2Vla2RheXNSZWdleCx0aGlzLl93ZWVrZGF5c1N0cmljdFJlZ2V4PW5ldyBSZWdFeHAoXCJeKFwiK3Uuam9pbihcInxcIikrXCIpXCIsXCJpXCIpLHRoaXMuX3dlZWtkYXlzU2hvcnRTdHJpY3RSZWdleD1uZXcgUmVnRXhwKFwiXihcIitvLmpvaW4oXCJ8XCIpK1wiKVwiLFwiaVwiKSx0aGlzLl93ZWVrZGF5c01pblN0cmljdFJlZ2V4PW5ldyBSZWdFeHAoXCJeKFwiK2Euam9pbihcInxcIikrXCIpXCIsXCJpXCIpfWZ1bmN0aW9uIFFlKCl7cmV0dXJuIHRoaXMuaG91cnMoKSUxMnx8MTJ9ZnVuY3Rpb24gWGUoZSx0KXtJKGUsMCwwLGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLm1lcmlkaWVtKHRoaXMuaG91cnMoKSx0aGlzLm1pbnV0ZXMoKSx0KX0pfWZ1bmN0aW9uIEtlKGUsdCl7cmV0dXJuIHQuX21lcmlkaWVtUGFyc2V9SShcIkhcIixbXCJISFwiLDJdLDAsXCJob3VyXCIpLEkoXCJoXCIsW1wiaGhcIiwyXSwwLFFlKSxJKFwia1wiLFtcImtrXCIsMl0sMCxmdW5jdGlvbigpe3JldHVybiB0aGlzLmhvdXJzKCl8fDI0fSksSShcImhtbVwiLDAsMCxmdW5jdGlvbigpe3JldHVyblwiXCIrUWUuYXBwbHkodGhpcykrVSh0aGlzLm1pbnV0ZXMoKSwyKX0pLEkoXCJobW1zc1wiLDAsMCxmdW5jdGlvbigpe3JldHVyblwiXCIrUWUuYXBwbHkodGhpcykrVSh0aGlzLm1pbnV0ZXMoKSwyKStVKHRoaXMuc2Vjb25kcygpLDIpfSksSShcIkhtbVwiLDAsMCxmdW5jdGlvbigpe3JldHVyblwiXCIrdGhpcy5ob3VycygpK1UodGhpcy5taW51dGVzKCksMil9KSxJKFwiSG1tc3NcIiwwLDAsZnVuY3Rpb24oKXtyZXR1cm5cIlwiK3RoaXMuaG91cnMoKStVKHRoaXMubWludXRlcygpLDIpK1UodGhpcy5zZWNvbmRzKCksMil9KSxYZShcImFcIiwhMCksWGUoXCJBXCIsITEpLEgoXCJob3VyXCIsXCJoXCIpLEwoXCJob3VyXCIsMTMpLHVlKFwiYVwiLEtlKSx1ZShcIkFcIixLZSksdWUoXCJIXCIsQiksdWUoXCJoXCIsQiksdWUoXCJrXCIsQiksdWUoXCJISFwiLEIseiksdWUoXCJoaFwiLEIseiksdWUoXCJra1wiLEIseiksdWUoXCJobW1cIixRKSx1ZShcImhtbXNzXCIsWCksdWUoXCJIbW1cIixRKSx1ZShcIkhtbXNzXCIsWCksY2UoW1wiSFwiLFwiSEhcIl0sZ2UpLGNlKFtcImtcIixcImtrXCJdLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcz1rKGUpO3RbZ2VdPTI0PT09cz8wOnN9KSxjZShbXCJhXCIsXCJBXCJdLGZ1bmN0aW9uKGUsdCxuKXtuLl9pc1BtPW4uX2xvY2FsZS5pc1BNKGUpLG4uX21lcmlkaWVtPWV9KSxjZShbXCJoXCIsXCJoaFwiXSxmdW5jdGlvbihlLHQsbil7dFtnZV09ayhlKSxnKG4pLmJpZ0hvdXI9ITB9KSxjZShcImhtbVwiLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcz1lLmxlbmd0aC0yO3RbZ2VdPWsoZS5zdWJzdHIoMCxzKSksdFtwZV09ayhlLnN1YnN0cihzKSksZyhuKS5iaWdIb3VyPSEwfSksY2UoXCJobW1zc1wiLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcz1lLmxlbmd0aC00LGk9ZS5sZW5ndGgtMjt0W2dlXT1rKGUuc3Vic3RyKDAscykpLHRbcGVdPWsoZS5zdWJzdHIocywyKSksdFt2ZV09ayhlLnN1YnN0cihpKSksZyhuKS5iaWdIb3VyPSEwfSksY2UoXCJIbW1cIixmdW5jdGlvbihlLHQsbil7dmFyIHM9ZS5sZW5ndGgtMjt0W2dlXT1rKGUuc3Vic3RyKDAscykpLHRbcGVdPWsoZS5zdWJzdHIocykpfSksY2UoXCJIbW1zc1wiLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcz1lLmxlbmd0aC00LGk9ZS5sZW5ndGgtMjt0W2dlXT1rKGUuc3Vic3RyKDAscykpLHRbcGVdPWsoZS5zdWJzdHIocywyKSksdFt2ZV09ayhlLnN1YnN0cihpKSl9KTt2YXIgZXQsdHQ9VGUoXCJIb3Vyc1wiLCEwKSxudD17Y2FsZW5kYXI6e3NhbWVEYXk6XCJbVG9kYXkgYXRdIExUXCIsbmV4dERheTpcIltUb21vcnJvdyBhdF0gTFRcIixuZXh0V2VlazpcImRkZGQgW2F0XSBMVFwiLGxhc3REYXk6XCJbWWVzdGVyZGF5IGF0XSBMVFwiLGxhc3RXZWVrOlwiW0xhc3RdIGRkZGQgW2F0XSBMVFwiLHNhbWVFbHNlOlwiTFwifSxsb25nRGF0ZUZvcm1hdDp7TFRTOlwiaDptbTpzcyBBXCIsTFQ6XCJoOm1tIEFcIixMOlwiTU0vREQvWVlZWVwiLExMOlwiTU1NTSBELCBZWVlZXCIsTExMOlwiTU1NTSBELCBZWVlZIGg6bW0gQVwiLExMTEw6XCJkZGRkLCBNTU1NIEQsIFlZWVkgaDptbSBBXCJ9LGludmFsaWREYXRlOlwiSW52YWxpZCBkYXRlXCIsb3JkaW5hbDpcIiVkXCIsZGF5T2ZNb250aE9yZGluYWxQYXJzZTovXFxkezEsMn0vLHJlbGF0aXZlVGltZTp7ZnV0dXJlOlwiaW4gJXNcIixwYXN0OlwiJXMgYWdvXCIsczpcImEgZmV3IHNlY29uZHNcIixzczpcIiVkIHNlY29uZHNcIixtOlwiYSBtaW51dGVcIixtbTpcIiVkIG1pbnV0ZXNcIixoOlwiYW4gaG91clwiLGhoOlwiJWQgaG91cnNcIixkOlwiYSBkYXlcIixkZDpcIiVkIGRheXNcIixNOlwiYSBtb250aFwiLE1NOlwiJWQgbW9udGhzXCIseTpcImEgeWVhclwiLHl5OlwiJWQgeWVhcnNcIn0sbW9udGhzOkhlLG1vbnRoc1Nob3J0OlJlLHdlZWs6e2RvdzowLGRveTo2fSx3ZWVrZGF5czpqZSx3ZWVrZGF5c01pbjp6ZSx3ZWVrZGF5c1Nob3J0OlplLG1lcmlkaWVtUGFyc2U6L1thcF1cXC4/bT9cXC4/L2l9LHN0PXt9LGl0PXt9O2Z1bmN0aW9uIHJ0KGUpe3JldHVybiBlP2UudG9Mb3dlckNhc2UoKS5yZXBsYWNlKFwiX1wiLFwiLVwiKTplfWZ1bmN0aW9uIGF0KGUpe3ZhciB0PW51bGw7aWYoIXN0W2VdJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlJiZtb2R1bGUmJm1vZHVsZS5leHBvcnRzKXRyeXt0PWV0Ll9hYmJyLHJlcXVpcmUoXCIuL2xvY2FsZS9cIitlKSxvdCh0KX1jYXRjaChlKXt9cmV0dXJuIHN0W2VdfWZ1bmN0aW9uIG90KGUsdCl7dmFyIG47cmV0dXJuIGUmJigobj1sKHQpP2x0KGUpOnV0KGUsdCkpP2V0PW46XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGNvbnNvbGUmJmNvbnNvbGUud2FybiYmY29uc29sZS53YXJuKFwiTG9jYWxlIFwiK2UrXCIgbm90IGZvdW5kLiBEaWQgeW91IGZvcmdldCB0byBsb2FkIGl0P1wiKSksZXQuX2FiYnJ9ZnVuY3Rpb24gdXQoZSx0KXtpZihudWxsIT09dCl7dmFyIG4scz1udDtpZih0LmFiYnI9ZSxudWxsIT1zdFtlXSlUKFwiZGVmaW5lTG9jYWxlT3ZlcnJpZGVcIixcInVzZSBtb21lbnQudXBkYXRlTG9jYWxlKGxvY2FsZU5hbWUsIGNvbmZpZykgdG8gY2hhbmdlIGFuIGV4aXN0aW5nIGxvY2FsZS4gbW9tZW50LmRlZmluZUxvY2FsZShsb2NhbGVOYW1lLCBjb25maWcpIHNob3VsZCBvbmx5IGJlIHVzZWQgZm9yIGNyZWF0aW5nIGEgbmV3IGxvY2FsZSBTZWUgaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9kZWZpbmUtbG9jYWxlLyBmb3IgbW9yZSBpbmZvLlwiKSxzPXN0W2VdLl9jb25maWc7ZWxzZSBpZihudWxsIT10LnBhcmVudExvY2FsZSlpZihudWxsIT1zdFt0LnBhcmVudExvY2FsZV0pcz1zdFt0LnBhcmVudExvY2FsZV0uX2NvbmZpZztlbHNle2lmKG51bGw9PShuPWF0KHQucGFyZW50TG9jYWxlKSkpcmV0dXJuIGl0W3QucGFyZW50TG9jYWxlXXx8KGl0W3QucGFyZW50TG9jYWxlXT1bXSksaXRbdC5wYXJlbnRMb2NhbGVdLnB1c2goe25hbWU6ZSxjb25maWc6dH0pLG51bGw7cz1uLl9jb25maWd9cmV0dXJuIHN0W2VdPW5ldyBQKGIocyx0KSksaXRbZV0mJml0W2VdLmZvckVhY2goZnVuY3Rpb24oZSl7dXQoZS5uYW1lLGUuY29uZmlnKX0pLG90KGUpLHN0W2VdfXJldHVybiBkZWxldGUgc3RbZV0sbnVsbH1mdW5jdGlvbiBsdChlKXt2YXIgdDtpZihlJiZlLl9sb2NhbGUmJmUuX2xvY2FsZS5fYWJiciYmKGU9ZS5fbG9jYWxlLl9hYmJyKSwhZSlyZXR1cm4gZXQ7aWYoIW8oZSkpe2lmKHQ9YXQoZSkpcmV0dXJuIHQ7ZT1bZV19cmV0dXJuIGZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxuLHMsaSxyPTA7cjxlLmxlbmd0aDspe2Zvcih0PShpPXJ0KGVbcl0pLnNwbGl0KFwiLVwiKSkubGVuZ3RoLG49KG49cnQoZVtyKzFdKSk/bi5zcGxpdChcIi1cIik6bnVsbDswPHQ7KXtpZihzPWF0KGkuc2xpY2UoMCx0KS5qb2luKFwiLVwiKSkpcmV0dXJuIHM7aWYobiYmbi5sZW5ndGg+PXQmJmEoaSxuLCEwKT49dC0xKWJyZWFrO3QtLX1yKyt9cmV0dXJuIGV0fShlKX1mdW5jdGlvbiBkdChlKXt2YXIgdCxuPWUuX2E7cmV0dXJuIG4mJi0yPT09ZyhlKS5vdmVyZmxvdyYmKHQ9bltfZV08MHx8MTE8bltfZV0/X2U6blt5ZV08MXx8blt5ZV0+UGUoblttZV0sbltfZV0pP3llOm5bZ2VdPDB8fDI0PG5bZ2VdfHwyND09PW5bZ2VdJiYoMCE9PW5bcGVdfHwwIT09blt2ZV18fDAhPT1uW3dlXSk/Z2U6bltwZV08MHx8NTk8bltwZV0/cGU6blt2ZV08MHx8NTk8blt2ZV0/dmU6blt3ZV08MHx8OTk5PG5bd2VdP3dlOi0xLGcoZSkuX292ZXJmbG93RGF5T2ZZZWFyJiYodDxtZXx8eWU8dCkmJih0PXllKSxnKGUpLl9vdmVyZmxvd1dlZWtzJiYtMT09PXQmJih0PU1lKSxnKGUpLl9vdmVyZmxvd1dlZWtkYXkmJi0xPT09dCYmKHQ9U2UpLGcoZSkub3ZlcmZsb3c9dCksZX1mdW5jdGlvbiBodChlLHQsbil7cmV0dXJuIG51bGwhPWU/ZTpudWxsIT10P3Q6bn1mdW5jdGlvbiBjdChlKXt2YXIgdCxuLHMsaSxyLGE9W107aWYoIWUuX2Qpe3ZhciBvLHU7Zm9yKG89ZSx1PW5ldyBEYXRlKGMubm93KCkpLHM9by5fdXNlVVRDP1t1LmdldFVUQ0Z1bGxZZWFyKCksdS5nZXRVVENNb250aCgpLHUuZ2V0VVRDRGF0ZSgpXTpbdS5nZXRGdWxsWWVhcigpLHUuZ2V0TW9udGgoKSx1LmdldERhdGUoKV0sZS5fdyYmbnVsbD09ZS5fYVt5ZV0mJm51bGw9PWUuX2FbX2VdJiZmdW5jdGlvbihlKXt2YXIgdCxuLHMsaSxyLGEsbyx1O2lmKG51bGwhPSh0PWUuX3cpLkdHfHxudWxsIT10Lld8fG51bGwhPXQuRSlyPTEsYT00LG49aHQodC5HRyxlLl9hW21lXSxJZShUdCgpLDEsNCkueWVhcikscz1odCh0LlcsMSksKChpPWh0KHQuRSwxKSk8MXx8NzxpKSYmKHU9ITApO2Vsc2V7cj1lLl9sb2NhbGUuX3dlZWsuZG93LGE9ZS5fbG9jYWxlLl93ZWVrLmRveTt2YXIgbD1JZShUdCgpLHIsYSk7bj1odCh0LmdnLGUuX2FbbWVdLGwueWVhcikscz1odCh0LncsbC53ZWVrKSxudWxsIT10LmQ/KChpPXQuZCk8MHx8NjxpKSYmKHU9ITApOm51bGwhPXQuZT8oaT10LmUrciwodC5lPDB8fDY8dC5lKSYmKHU9ITApKTppPXJ9czwxfHxzPkFlKG4scixhKT9nKGUpLl9vdmVyZmxvd1dlZWtzPSEwOm51bGwhPXU/ZyhlKS5fb3ZlcmZsb3dXZWVrZGF5PSEwOihvPUVlKG4scyxpLHIsYSksZS5fYVttZV09by55ZWFyLGUuX2RheU9mWWVhcj1vLmRheU9mWWVhcil9KGUpLG51bGwhPWUuX2RheU9mWWVhciYmKHI9aHQoZS5fYVttZV0sc1ttZV0pLChlLl9kYXlPZlllYXI+RGUocil8fDA9PT1lLl9kYXlPZlllYXIpJiYoZyhlKS5fb3ZlcmZsb3dEYXlPZlllYXI9ITApLG49R2UociwwLGUuX2RheU9mWWVhciksZS5fYVtfZV09bi5nZXRVVENNb250aCgpLGUuX2FbeWVdPW4uZ2V0VVRDRGF0ZSgpKSx0PTA7dDwzJiZudWxsPT1lLl9hW3RdOysrdCllLl9hW3RdPWFbdF09c1t0XTtmb3IoO3Q8Nzt0KyspZS5fYVt0XT1hW3RdPW51bGw9PWUuX2FbdF0/Mj09PXQ/MTowOmUuX2FbdF07MjQ9PT1lLl9hW2dlXSYmMD09PWUuX2FbcGVdJiYwPT09ZS5fYVt2ZV0mJjA9PT1lLl9hW3dlXSYmKGUuX25leHREYXk9ITAsZS5fYVtnZV09MCksZS5fZD0oZS5fdXNlVVRDP0dlOmZ1bmN0aW9uKGUsdCxuLHMsaSxyLGEpe3ZhciBvPW5ldyBEYXRlKGUsdCxuLHMsaSxyLGEpO3JldHVybiBlPDEwMCYmMDw9ZSYmaXNGaW5pdGUoby5nZXRGdWxsWWVhcigpKSYmby5zZXRGdWxsWWVhcihlKSxvfSkuYXBwbHkobnVsbCxhKSxpPWUuX3VzZVVUQz9lLl9kLmdldFVUQ0RheSgpOmUuX2QuZ2V0RGF5KCksbnVsbCE9ZS5fdHptJiZlLl9kLnNldFVUQ01pbnV0ZXMoZS5fZC5nZXRVVENNaW51dGVzKCktZS5fdHptKSxlLl9uZXh0RGF5JiYoZS5fYVtnZV09MjQpLGUuX3cmJnZvaWQgMCE9PWUuX3cuZCYmZS5fdy5kIT09aSYmKGcoZSkud2Vla2RheU1pc21hdGNoPSEwKX19dmFyIGZ0PS9eXFxzKigoPzpbKy1dXFxkezZ9fFxcZHs0fSktKD86XFxkXFxkLVxcZFxcZHxXXFxkXFxkLVxcZHxXXFxkXFxkfFxcZFxcZFxcZHxcXGRcXGQpKSg/OihUfCApKFxcZFxcZCg/OjpcXGRcXGQoPzo6XFxkXFxkKD86Wy4sXVxcZCspPyk/KT8pKFtcXCtcXC1dXFxkXFxkKD86Oj9cXGRcXGQpP3xcXHMqWik/KT8kLyxtdD0vXlxccyooKD86WystXVxcZHs2fXxcXGR7NH0pKD86XFxkXFxkXFxkXFxkfFdcXGRcXGRcXGR8V1xcZFxcZHxcXGRcXGRcXGR8XFxkXFxkKSkoPzooVHwgKShcXGRcXGQoPzpcXGRcXGQoPzpcXGRcXGQoPzpbLixdXFxkKyk/KT8pPykoW1xcK1xcLV1cXGRcXGQoPzo6P1xcZFxcZCk/fFxccypaKT8pPyQvLF90PS9afFsrLV1cXGRcXGQoPzo6P1xcZFxcZCk/Lyx5dD1bW1wiWVlZWVlZLU1NLUREXCIsL1srLV1cXGR7Nn0tXFxkXFxkLVxcZFxcZC9dLFtcIllZWVktTU0tRERcIiwvXFxkezR9LVxcZFxcZC1cXGRcXGQvXSxbXCJHR0dHLVtXXVdXLUVcIiwvXFxkezR9LVdcXGRcXGQtXFxkL10sW1wiR0dHRy1bV11XV1wiLC9cXGR7NH0tV1xcZFxcZC8sITFdLFtcIllZWVktREREXCIsL1xcZHs0fS1cXGR7M30vXSxbXCJZWVlZLU1NXCIsL1xcZHs0fS1cXGRcXGQvLCExXSxbXCJZWVlZWVlNTUREXCIsL1srLV1cXGR7MTB9L10sW1wiWVlZWU1NRERcIiwvXFxkezh9L10sW1wiR0dHR1tXXVdXRVwiLC9cXGR7NH1XXFxkezN9L10sW1wiR0dHR1tXXVdXXCIsL1xcZHs0fVdcXGR7Mn0vLCExXSxbXCJZWVlZREREXCIsL1xcZHs3fS9dXSxndD1bW1wiSEg6bW06c3MuU1NTU1wiLC9cXGRcXGQ6XFxkXFxkOlxcZFxcZFxcLlxcZCsvXSxbXCJISDptbTpzcyxTU1NTXCIsL1xcZFxcZDpcXGRcXGQ6XFxkXFxkLFxcZCsvXSxbXCJISDptbTpzc1wiLC9cXGRcXGQ6XFxkXFxkOlxcZFxcZC9dLFtcIkhIOm1tXCIsL1xcZFxcZDpcXGRcXGQvXSxbXCJISG1tc3MuU1NTU1wiLC9cXGRcXGRcXGRcXGRcXGRcXGRcXC5cXGQrL10sW1wiSEhtbXNzLFNTU1NcIiwvXFxkXFxkXFxkXFxkXFxkXFxkLFxcZCsvXSxbXCJISG1tc3NcIiwvXFxkXFxkXFxkXFxkXFxkXFxkL10sW1wiSEhtbVwiLC9cXGRcXGRcXGRcXGQvXSxbXCJISFwiLC9cXGRcXGQvXV0scHQ9L15cXC8/RGF0ZVxcKChcXC0/XFxkKykvaTtmdW5jdGlvbiB2dChlKXt2YXIgdCxuLHMsaSxyLGEsbz1lLl9pLHU9ZnQuZXhlYyhvKXx8bXQuZXhlYyhvKTtpZih1KXtmb3IoZyhlKS5pc289ITAsdD0wLG49eXQubGVuZ3RoO3Q8bjt0KyspaWYoeXRbdF1bMV0uZXhlYyh1WzFdKSl7aT15dFt0XVswXSxzPSExIT09eXRbdF1bMl07YnJlYWt9aWYobnVsbD09aSlyZXR1cm4gdm9pZChlLl9pc1ZhbGlkPSExKTtpZih1WzNdKXtmb3IodD0wLG49Z3QubGVuZ3RoO3Q8bjt0KyspaWYoZ3RbdF1bMV0uZXhlYyh1WzNdKSl7cj0odVsyXXx8XCIgXCIpK2d0W3RdWzBdO2JyZWFrfWlmKG51bGw9PXIpcmV0dXJuIHZvaWQoZS5faXNWYWxpZD0hMSl9aWYoIXMmJm51bGwhPXIpcmV0dXJuIHZvaWQoZS5faXNWYWxpZD0hMSk7aWYodVs0XSl7aWYoIV90LmV4ZWModVs0XSkpcmV0dXJuIHZvaWQoZS5faXNWYWxpZD0hMSk7YT1cIlpcIn1lLl9mPWkrKHJ8fFwiXCIpKyhhfHxcIlwiKSxrdChlKX1lbHNlIGUuX2lzVmFsaWQ9ITF9dmFyIHd0PS9eKD86KE1vbnxUdWV8V2VkfFRodXxGcml8U2F0fFN1biksP1xccyk/KFxcZHsxLDJ9KVxccyhKYW58RmVifE1hcnxBcHJ8TWF5fEp1bnxKdWx8QXVnfFNlcHxPY3R8Tm92fERlYylcXHMoXFxkezIsNH0pXFxzKFxcZFxcZCk6KFxcZFxcZCkoPzo6KFxcZFxcZCkpP1xccyg/OihVVHxHTVR8W0VDTVBdW1NEXVQpfChbWnpdKXwoWystXVxcZHs0fSkpJC87ZnVuY3Rpb24gTXQoZSx0LG4scyxpLHIpe3ZhciBhPVtmdW5jdGlvbihlKXt2YXIgdD1wYXJzZUludChlLDEwKTt7aWYodDw9NDkpcmV0dXJuIDJlMyt0O2lmKHQ8PTk5OSlyZXR1cm4gMTkwMCt0fXJldHVybiB0fShlKSxSZS5pbmRleE9mKHQpLHBhcnNlSW50KG4sMTApLHBhcnNlSW50KHMsMTApLHBhcnNlSW50KGksMTApXTtyZXR1cm4gciYmYS5wdXNoKHBhcnNlSW50KHIsMTApKSxhfXZhciBTdD17VVQ6MCxHTVQ6MCxFRFQ6LTI0MCxFU1Q6LTMwMCxDRFQ6LTMwMCxDU1Q6LTM2MCxNRFQ6LTM2MCxNU1Q6LTQyMCxQRFQ6LTQyMCxQU1Q6LTQ4MH07ZnVuY3Rpb24gRHQoZSl7dmFyIHQsbixzLGk9d3QuZXhlYyhlLl9pLnJlcGxhY2UoL1xcKFteKV0qXFwpfFtcXG5cXHRdL2csXCIgXCIpLnJlcGxhY2UoLyhcXHNcXHMrKS9nLFwiIFwiKS50cmltKCkpO2lmKGkpe3ZhciByPU10KGlbNF0saVszXSxpWzJdLGlbNV0saVs2XSxpWzddKTtpZih0PWlbMV0sbj1yLHM9ZSx0JiZaZS5pbmRleE9mKHQpIT09bmV3IERhdGUoblswXSxuWzFdLG5bMl0pLmdldERheSgpJiYoZyhzKS53ZWVrZGF5TWlzbWF0Y2g9ITAsIShzLl9pc1ZhbGlkPSExKSkpcmV0dXJuO2UuX2E9cixlLl90em09ZnVuY3Rpb24oZSx0LG4pe2lmKGUpcmV0dXJuIFN0W2VdO2lmKHQpcmV0dXJuIDA7dmFyIHM9cGFyc2VJbnQobiwxMCksaT1zJTEwMDtyZXR1cm4ocy1pKS8xMDAqNjAraX0oaVs4XSxpWzldLGlbMTBdKSxlLl9kPUdlLmFwcGx5KG51bGwsZS5fYSksZS5fZC5zZXRVVENNaW51dGVzKGUuX2QuZ2V0VVRDTWludXRlcygpLWUuX3R6bSksZyhlKS5yZmMyODIyPSEwfWVsc2UgZS5faXNWYWxpZD0hMX1mdW5jdGlvbiBrdChlKXtpZihlLl9mIT09Yy5JU09fODYwMSlpZihlLl9mIT09Yy5SRkNfMjgyMil7ZS5fYT1bXSxnKGUpLmVtcHR5PSEwO3ZhciB0LG4scyxpLHIsYSxvLHUsbD1cIlwiK2UuX2ksZD1sLmxlbmd0aCxoPTA7Zm9yKHM9aihlLl9mLGUuX2xvY2FsZSkubWF0Y2goTil8fFtdLHQ9MDt0PHMubGVuZ3RoO3QrKylpPXNbdF0sKG49KGwubWF0Y2gobGUoaSxlKSl8fFtdKVswXSkmJigwPChyPWwuc3Vic3RyKDAsbC5pbmRleE9mKG4pKSkubGVuZ3RoJiZnKGUpLnVudXNlZElucHV0LnB1c2gociksbD1sLnNsaWNlKGwuaW5kZXhPZihuKStuLmxlbmd0aCksaCs9bi5sZW5ndGgpLEVbaV0/KG4/ZyhlKS5lbXB0eT0hMTpnKGUpLnVudXNlZFRva2Vucy5wdXNoKGkpLGE9aSx1PWUsbnVsbCE9KG89bikmJm0oaGUsYSkmJmhlW2FdKG8sdS5fYSx1LGEpKTplLl9zdHJpY3QmJiFuJiZnKGUpLnVudXNlZFRva2Vucy5wdXNoKGkpO2coZSkuY2hhcnNMZWZ0T3Zlcj1kLWgsMDxsLmxlbmd0aCYmZyhlKS51bnVzZWRJbnB1dC5wdXNoKGwpLGUuX2FbZ2VdPD0xMiYmITA9PT1nKGUpLmJpZ0hvdXImJjA8ZS5fYVtnZV0mJihnKGUpLmJpZ0hvdXI9dm9pZCAwKSxnKGUpLnBhcnNlZERhdGVQYXJ0cz1lLl9hLnNsaWNlKDApLGcoZSkubWVyaWRpZW09ZS5fbWVyaWRpZW0sZS5fYVtnZV09ZnVuY3Rpb24oZSx0LG4pe3ZhciBzO2lmKG51bGw9PW4pcmV0dXJuIHQ7cmV0dXJuIG51bGwhPWUubWVyaWRpZW1Ib3VyP2UubWVyaWRpZW1Ib3VyKHQsbik6KG51bGwhPWUuaXNQTSYmKChzPWUuaXNQTShuKSkmJnQ8MTImJih0Kz0xMiksc3x8MTIhPT10fHwodD0wKSksdCl9KGUuX2xvY2FsZSxlLl9hW2dlXSxlLl9tZXJpZGllbSksY3QoZSksZHQoZSl9ZWxzZSBEdChlKTtlbHNlIHZ0KGUpfWZ1bmN0aW9uIFl0KGUpe3ZhciB0LG4scyxpLHI9ZS5faSxhPWUuX2Y7cmV0dXJuIGUuX2xvY2FsZT1lLl9sb2NhbGV8fGx0KGUuX2wpLG51bGw9PT1yfHx2b2lkIDA9PT1hJiZcIlwiPT09cj92KHtudWxsSW5wdXQ6ITB9KTooXCJzdHJpbmdcIj09dHlwZW9mIHImJihlLl9pPXI9ZS5fbG9jYWxlLnByZXBhcnNlKHIpKSxTKHIpP25ldyBNKGR0KHIpKTooaChyKT9lLl9kPXI6byhhKT9mdW5jdGlvbihlKXt2YXIgdCxuLHMsaSxyO2lmKDA9PT1lLl9mLmxlbmd0aClyZXR1cm4gZyhlKS5pbnZhbGlkRm9ybWF0PSEwLGUuX2Q9bmV3IERhdGUoTmFOKTtmb3IoaT0wO2k8ZS5fZi5sZW5ndGg7aSsrKXI9MCx0PXcoe30sZSksbnVsbCE9ZS5fdXNlVVRDJiYodC5fdXNlVVRDPWUuX3VzZVVUQyksdC5fZj1lLl9mW2ldLGt0KHQpLHAodCkmJihyKz1nKHQpLmNoYXJzTGVmdE92ZXIscis9MTAqZyh0KS51bnVzZWRUb2tlbnMubGVuZ3RoLGcodCkuc2NvcmU9ciwobnVsbD09c3x8cjxzKSYmKHM9cixuPXQpKTtfKGUsbnx8dCl9KGUpOmE/a3QoZSk6bChuPSh0PWUpLl9pKT90Ll9kPW5ldyBEYXRlKGMubm93KCkpOmgobik/dC5fZD1uZXcgRGF0ZShuLnZhbHVlT2YoKSk6XCJzdHJpbmdcIj09dHlwZW9mIG4/KHM9dCxudWxsPT09KGk9cHQuZXhlYyhzLl9pKSk/KHZ0KHMpLCExPT09cy5faXNWYWxpZCYmKGRlbGV0ZSBzLl9pc1ZhbGlkLER0KHMpLCExPT09cy5faXNWYWxpZCYmKGRlbGV0ZSBzLl9pc1ZhbGlkLGMuY3JlYXRlRnJvbUlucHV0RmFsbGJhY2socykpKSk6cy5fZD1uZXcgRGF0ZSgraVsxXSkpOm8obik/KHQuX2E9ZihuLnNsaWNlKDApLGZ1bmN0aW9uKGUpe3JldHVybiBwYXJzZUludChlLDEwKX0pLGN0KHQpKTp1KG4pP2Z1bmN0aW9uKGUpe2lmKCFlLl9kKXt2YXIgdD1DKGUuX2kpO2UuX2E9ZihbdC55ZWFyLHQubW9udGgsdC5kYXl8fHQuZGF0ZSx0LmhvdXIsdC5taW51dGUsdC5zZWNvbmQsdC5taWxsaXNlY29uZF0sZnVuY3Rpb24oZSl7cmV0dXJuIGUmJnBhcnNlSW50KGUsMTApfSksY3QoZSl9fSh0KTpkKG4pP3QuX2Q9bmV3IERhdGUobik6Yy5jcmVhdGVGcm9tSW5wdXRGYWxsYmFjayh0KSxwKGUpfHwoZS5fZD1udWxsKSxlKSl9ZnVuY3Rpb24gT3QoZSx0LG4scyxpKXt2YXIgcixhPXt9O3JldHVybiEwIT09biYmITEhPT1ufHwocz1uLG49dm9pZCAwKSwodShlKSYmZnVuY3Rpb24oZSl7aWYoT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMpcmV0dXJuIDA9PT1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhlKS5sZW5ndGg7dmFyIHQ7Zm9yKHQgaW4gZSlpZihlLmhhc093blByb3BlcnR5KHQpKXJldHVybiExO3JldHVybiEwfShlKXx8byhlKSYmMD09PWUubGVuZ3RoKSYmKGU9dm9pZCAwKSxhLl9pc0FNb21lbnRPYmplY3Q9ITAsYS5fdXNlVVRDPWEuX2lzVVRDPWksYS5fbD1uLGEuX2k9ZSxhLl9mPXQsYS5fc3RyaWN0PXMsKHI9bmV3IE0oZHQoWXQoYSkpKSkuX25leHREYXkmJihyLmFkZCgxLFwiZFwiKSxyLl9uZXh0RGF5PXZvaWQgMCkscn1mdW5jdGlvbiBUdChlLHQsbixzKXtyZXR1cm4gT3QoZSx0LG4scywhMSl9Yy5jcmVhdGVGcm9tSW5wdXRGYWxsYmFjaz1uKFwidmFsdWUgcHJvdmlkZWQgaXMgbm90IGluIGEgcmVjb2duaXplZCBSRkMyODIyIG9yIElTTyBmb3JtYXQuIG1vbWVudCBjb25zdHJ1Y3Rpb24gZmFsbHMgYmFjayB0byBqcyBEYXRlKCksIHdoaWNoIGlzIG5vdCByZWxpYWJsZSBhY3Jvc3MgYWxsIGJyb3dzZXJzIGFuZCB2ZXJzaW9ucy4gTm9uIFJGQzI4MjIvSVNPIGRhdGUgZm9ybWF0cyBhcmUgZGlzY291cmFnZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBhbiB1cGNvbWluZyBtYWpvciByZWxlYXNlLiBQbGVhc2UgcmVmZXIgdG8gaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9qcy1kYXRlLyBmb3IgbW9yZSBpbmZvLlwiLGZ1bmN0aW9uKGUpe2UuX2Q9bmV3IERhdGUoZS5faSsoZS5fdXNlVVRDP1wiIFVUQ1wiOlwiXCIpKX0pLGMuSVNPXzg2MDE9ZnVuY3Rpb24oKXt9LGMuUkZDXzI4MjI9ZnVuY3Rpb24oKXt9O3ZhciB4dD1uKFwibW9tZW50KCkubWluIGlzIGRlcHJlY2F0ZWQsIHVzZSBtb21lbnQubWF4IGluc3RlYWQuIGh0dHA6Ly9tb21lbnRqcy5jb20vZ3VpZGVzLyMvd2FybmluZ3MvbWluLW1heC9cIixmdW5jdGlvbigpe3ZhciBlPVR0LmFwcGx5KG51bGwsYXJndW1lbnRzKTtyZXR1cm4gdGhpcy5pc1ZhbGlkKCkmJmUuaXNWYWxpZCgpP2U8dGhpcz90aGlzOmU6digpfSksYnQ9bihcIm1vbWVudCgpLm1heCBpcyBkZXByZWNhdGVkLCB1c2UgbW9tZW50Lm1pbiBpbnN0ZWFkLiBodHRwOi8vbW9tZW50anMuY29tL2d1aWRlcy8jL3dhcm5pbmdzL21pbi1tYXgvXCIsZnVuY3Rpb24oKXt2YXIgZT1UdC5hcHBseShudWxsLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXMuaXNWYWxpZCgpJiZlLmlzVmFsaWQoKT90aGlzPGU/dGhpczplOnYoKX0pO2Z1bmN0aW9uIFB0KGUsdCl7dmFyIG4scztpZigxPT09dC5sZW5ndGgmJm8odFswXSkmJih0PXRbMF0pLCF0Lmxlbmd0aClyZXR1cm4gVHQoKTtmb3Iobj10WzBdLHM9MTtzPHQubGVuZ3RoOysrcyl0W3NdLmlzVmFsaWQoKSYmIXRbc11bZV0obil8fChuPXRbc10pO3JldHVybiBufXZhciBXdD1bXCJ5ZWFyXCIsXCJxdWFydGVyXCIsXCJtb250aFwiLFwid2Vla1wiLFwiZGF5XCIsXCJob3VyXCIsXCJtaW51dGVcIixcInNlY29uZFwiLFwibWlsbGlzZWNvbmRcIl07ZnVuY3Rpb24gSHQoZSl7dmFyIHQ9QyhlKSxuPXQueWVhcnx8MCxzPXQucXVhcnRlcnx8MCxpPXQubW9udGh8fDAscj10LndlZWt8fDAsYT10LmRheXx8MCxvPXQuaG91cnx8MCx1PXQubWludXRlfHwwLGw9dC5zZWNvbmR8fDAsZD10Lm1pbGxpc2Vjb25kfHwwO3RoaXMuX2lzVmFsaWQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0IGluIGUpaWYoLTE9PT1ZZS5jYWxsKFd0LHQpfHxudWxsIT1lW3RdJiZpc05hTihlW3RdKSlyZXR1cm4hMTtmb3IodmFyIG49ITEscz0wO3M8V3QubGVuZ3RoOysrcylpZihlW1d0W3NdXSl7aWYobilyZXR1cm4hMTtwYXJzZUZsb2F0KGVbV3Rbc11dKSE9PWsoZVtXdFtzXV0pJiYobj0hMCl9cmV0dXJuITB9KHQpLHRoaXMuX21pbGxpc2Vjb25kcz0rZCsxZTMqbCs2ZTQqdSsxZTMqbyo2MCo2MCx0aGlzLl9kYXlzPSthKzcqcix0aGlzLl9tb250aHM9K2krMypzKzEyKm4sdGhpcy5fZGF0YT17fSx0aGlzLl9sb2NhbGU9bHQoKSx0aGlzLl9idWJibGUoKX1mdW5jdGlvbiBSdChlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIEh0fWZ1bmN0aW9uIEN0KGUpe3JldHVybiBlPDA/LTEqTWF0aC5yb3VuZCgtMSplKTpNYXRoLnJvdW5kKGUpfWZ1bmN0aW9uIEZ0KGUsbil7SShlLDAsMCxmdW5jdGlvbigpe3ZhciBlPXRoaXMudXRjT2Zmc2V0KCksdD1cIitcIjtyZXR1cm4gZTwwJiYoZT0tZSx0PVwiLVwiKSx0K1Uofn4oZS82MCksMikrbitVKH5+ZSU2MCwyKX0pfUZ0KFwiWlwiLFwiOlwiKSxGdChcIlpaXCIsXCJcIiksdWUoXCJaXCIscmUpLHVlKFwiWlpcIixyZSksY2UoW1wiWlwiLFwiWlpcIl0sZnVuY3Rpb24oZSx0LG4pe24uX3VzZVVUQz0hMCxuLl90em09VXQocmUsZSl9KTt2YXIgTHQ9LyhbXFwrXFwtXXxcXGRcXGQpL2dpO2Z1bmN0aW9uIFV0KGUsdCl7dmFyIG49KHR8fFwiXCIpLm1hdGNoKGUpO2lmKG51bGw9PT1uKXJldHVybiBudWxsO3ZhciBzPSgobltuLmxlbmd0aC0xXXx8W10pK1wiXCIpLm1hdGNoKEx0KXx8W1wiLVwiLDAsMF0saT02MCpzWzFdK2soc1syXSk7cmV0dXJuIDA9PT1pPzA6XCIrXCI9PT1zWzBdP2k6LWl9ZnVuY3Rpb24gTnQoZSx0KXt2YXIgbixzO3JldHVybiB0Ll9pc1VUQz8obj10LmNsb25lKCkscz0oUyhlKXx8aChlKT9lLnZhbHVlT2YoKTpUdChlKS52YWx1ZU9mKCkpLW4udmFsdWVPZigpLG4uX2Quc2V0VGltZShuLl9kLnZhbHVlT2YoKStzKSxjLnVwZGF0ZU9mZnNldChuLCExKSxuKTpUdChlKS5sb2NhbCgpfWZ1bmN0aW9uIEd0KGUpe3JldHVybiAxNSotTWF0aC5yb3VuZChlLl9kLmdldFRpbWV6b25lT2Zmc2V0KCkvMTUpfWZ1bmN0aW9uIFZ0KCl7cmV0dXJuISF0aGlzLmlzVmFsaWQoKSYmKHRoaXMuX2lzVVRDJiYwPT09dGhpcy5fb2Zmc2V0KX1jLnVwZGF0ZU9mZnNldD1mdW5jdGlvbigpe307dmFyIEV0PS9eKFxcLXxcXCspPyg/OihcXGQqKVsuIF0pPyhcXGQrKVxcOihcXGQrKSg/OlxcOihcXGQrKShcXC5cXGQqKT8pPyQvLEl0PS9eKC18XFwrKT9QKD86KFstK10/WzAtOSwuXSopWSk/KD86KFstK10/WzAtOSwuXSopTSk/KD86KFstK10/WzAtOSwuXSopVyk/KD86KFstK10/WzAtOSwuXSopRCk/KD86VCg/OihbLStdP1swLTksLl0qKUgpPyg/OihbLStdP1swLTksLl0qKU0pPyg/OihbLStdP1swLTksLl0qKVMpPyk/JC87ZnVuY3Rpb24gQXQoZSx0KXt2YXIgbixzLGkscj1lLGE9bnVsbDtyZXR1cm4gUnQoZSk/cj17bXM6ZS5fbWlsbGlzZWNvbmRzLGQ6ZS5fZGF5cyxNOmUuX21vbnRoc306ZChlKT8ocj17fSx0P3JbdF09ZTpyLm1pbGxpc2Vjb25kcz1lKTooYT1FdC5leGVjKGUpKT8obj1cIi1cIj09PWFbMV0/LTE6MSxyPXt5OjAsZDprKGFbeWVdKSpuLGg6ayhhW2dlXSkqbixtOmsoYVtwZV0pKm4sczprKGFbdmVdKSpuLG1zOmsoQ3QoMWUzKmFbd2VdKSkqbn0pOihhPUl0LmV4ZWMoZSkpPyhuPVwiLVwiPT09YVsxXT8tMTooYVsxXSwxKSxyPXt5Omp0KGFbMl0sbiksTTpqdChhWzNdLG4pLHc6anQoYVs0XSxuKSxkOmp0KGFbNV0sbiksaDpqdChhWzZdLG4pLG06anQoYVs3XSxuKSxzOmp0KGFbOF0sbil9KTpudWxsPT1yP3I9e306XCJvYmplY3RcIj09dHlwZW9mIHImJihcImZyb21cImluIHJ8fFwidG9cImluIHIpJiYoaT1mdW5jdGlvbihlLHQpe3ZhciBuO2lmKCFlLmlzVmFsaWQoKXx8IXQuaXNWYWxpZCgpKXJldHVybnttaWxsaXNlY29uZHM6MCxtb250aHM6MH07dD1OdCh0LGUpLGUuaXNCZWZvcmUodCk/bj1adChlLHQpOigobj1adCh0LGUpKS5taWxsaXNlY29uZHM9LW4ubWlsbGlzZWNvbmRzLG4ubW9udGhzPS1uLm1vbnRocyk7cmV0dXJuIG59KFR0KHIuZnJvbSksVHQoci50bykpLChyPXt9KS5tcz1pLm1pbGxpc2Vjb25kcyxyLk09aS5tb250aHMpLHM9bmV3IEh0KHIpLFJ0KGUpJiZtKGUsXCJfbG9jYWxlXCIpJiYocy5fbG9jYWxlPWUuX2xvY2FsZSksc31mdW5jdGlvbiBqdChlLHQpe3ZhciBuPWUmJnBhcnNlRmxvYXQoZS5yZXBsYWNlKFwiLFwiLFwiLlwiKSk7cmV0dXJuKGlzTmFOKG4pPzA6bikqdH1mdW5jdGlvbiBadChlLHQpe3ZhciBuPXttaWxsaXNlY29uZHM6MCxtb250aHM6MH07cmV0dXJuIG4ubW9udGhzPXQubW9udGgoKS1lLm1vbnRoKCkrMTIqKHQueWVhcigpLWUueWVhcigpKSxlLmNsb25lKCkuYWRkKG4ubW9udGhzLFwiTVwiKS5pc0FmdGVyKHQpJiYtLW4ubW9udGhzLG4ubWlsbGlzZWNvbmRzPSt0LStlLmNsb25lKCkuYWRkKG4ubW9udGhzLFwiTVwiKSxufWZ1bmN0aW9uIHp0KHMsaSl7cmV0dXJuIGZ1bmN0aW9uKGUsdCl7dmFyIG47cmV0dXJuIG51bGw9PT10fHxpc05hTigrdCl8fChUKGksXCJtb21lbnQoKS5cIitpK1wiKHBlcmlvZCwgbnVtYmVyKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIG1vbWVudCgpLlwiK2krXCIobnVtYmVyLCBwZXJpb2QpLiBTZWUgaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9hZGQtaW52ZXJ0ZWQtcGFyYW0vIGZvciBtb3JlIGluZm8uXCIpLG49ZSxlPXQsdD1uKSwkdCh0aGlzLEF0KGU9XCJzdHJpbmdcIj09dHlwZW9mIGU/K2U6ZSx0KSxzKSx0aGlzfX1mdW5jdGlvbiAkdChlLHQsbixzKXt2YXIgaT10Ll9taWxsaXNlY29uZHMscj1DdCh0Ll9kYXlzKSxhPUN0KHQuX21vbnRocyk7ZS5pc1ZhbGlkKCkmJihzPW51bGw9PXN8fHMsYSYmQ2UoZSx4ZShlLFwiTW9udGhcIikrYSpuKSxyJiZiZShlLFwiRGF0ZVwiLHhlKGUsXCJEYXRlXCIpK3IqbiksaSYmZS5fZC5zZXRUaW1lKGUuX2QudmFsdWVPZigpK2kqbikscyYmYy51cGRhdGVPZmZzZXQoZSxyfHxhKSl9QXQuZm49SHQucHJvdG90eXBlLEF0LmludmFsaWQ9ZnVuY3Rpb24oKXtyZXR1cm4gQXQoTmFOKX07dmFyIHF0PXp0KDEsXCJhZGRcIiksSnQ9enQoLTEsXCJzdWJ0cmFjdFwiKTtmdW5jdGlvbiBCdChlLHQpe3ZhciBuPTEyKih0LnllYXIoKS1lLnllYXIoKSkrKHQubW9udGgoKS1lLm1vbnRoKCkpLHM9ZS5jbG9uZSgpLmFkZChuLFwibW9udGhzXCIpO3JldHVybi0obisodC1zPDA/KHQtcykvKHMtZS5jbG9uZSgpLmFkZChuLTEsXCJtb250aHNcIikpOih0LXMpLyhlLmNsb25lKCkuYWRkKG4rMSxcIm1vbnRoc1wiKS1zKSkpfHwwfWZ1bmN0aW9uIFF0KGUpe3ZhciB0O3JldHVybiB2b2lkIDA9PT1lP3RoaXMuX2xvY2FsZS5fYWJicjoobnVsbCE9KHQ9bHQoZSkpJiYodGhpcy5fbG9jYWxlPXQpLHRoaXMpfWMuZGVmYXVsdEZvcm1hdD1cIllZWVktTU0tRERUSEg6bW06c3NaXCIsYy5kZWZhdWx0Rm9ybWF0VXRjPVwiWVlZWS1NTS1ERFRISDptbTpzc1taXVwiO3ZhciBYdD1uKFwibW9tZW50KCkubGFuZygpIGlzIGRlcHJlY2F0ZWQuIEluc3RlYWQsIHVzZSBtb21lbnQoKS5sb2NhbGVEYXRhKCkgdG8gZ2V0IHRoZSBsYW5ndWFnZSBjb25maWd1cmF0aW9uLiBVc2UgbW9tZW50KCkubG9jYWxlKCkgdG8gY2hhbmdlIGxhbmd1YWdlcy5cIixmdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZT90aGlzLmxvY2FsZURhdGEoKTp0aGlzLmxvY2FsZShlKX0pO2Z1bmN0aW9uIEt0KCl7cmV0dXJuIHRoaXMuX2xvY2FsZX1mdW5jdGlvbiBlbihlLHQpe0koMCxbZSxlLmxlbmd0aF0sMCx0KX1mdW5jdGlvbiB0bihlLHQsbixzLGkpe3ZhciByO3JldHVybiBudWxsPT1lP0llKHRoaXMscyxpKS55ZWFyOigocj1BZShlLHMsaSkpPHQmJih0PXIpLGZ1bmN0aW9uKGUsdCxuLHMsaSl7dmFyIHI9RWUoZSx0LG4scyxpKSxhPUdlKHIueWVhciwwLHIuZGF5T2ZZZWFyKTtyZXR1cm4gdGhpcy55ZWFyKGEuZ2V0VVRDRnVsbFllYXIoKSksdGhpcy5tb250aChhLmdldFVUQ01vbnRoKCkpLHRoaXMuZGF0ZShhLmdldFVUQ0RhdGUoKSksdGhpc30uY2FsbCh0aGlzLGUsdCxuLHMsaSkpfUkoMCxbXCJnZ1wiLDJdLDAsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53ZWVrWWVhcigpJTEwMH0pLEkoMCxbXCJHR1wiLDJdLDAsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc29XZWVrWWVhcigpJTEwMH0pLGVuKFwiZ2dnZ1wiLFwid2Vla1llYXJcIiksZW4oXCJnZ2dnZ1wiLFwid2Vla1llYXJcIiksZW4oXCJHR0dHXCIsXCJpc29XZWVrWWVhclwiKSxlbihcIkdHR0dHXCIsXCJpc29XZWVrWWVhclwiKSxIKFwid2Vla1llYXJcIixcImdnXCIpLEgoXCJpc29XZWVrWWVhclwiLFwiR0dcIiksTChcIndlZWtZZWFyXCIsMSksTChcImlzb1dlZWtZZWFyXCIsMSksdWUoXCJHXCIsc2UpLHVlKFwiZ1wiLHNlKSx1ZShcIkdHXCIsQix6KSx1ZShcImdnXCIsQix6KSx1ZShcIkdHR0dcIixlZSxxKSx1ZShcImdnZ2dcIixlZSxxKSx1ZShcIkdHR0dHXCIsdGUsSiksdWUoXCJnZ2dnZ1wiLHRlLEopLGZlKFtcImdnZ2dcIixcImdnZ2dnXCIsXCJHR0dHXCIsXCJHR0dHR1wiXSxmdW5jdGlvbihlLHQsbixzKXt0W3Muc3Vic3RyKDAsMildPWsoZSl9KSxmZShbXCJnZ1wiLFwiR0dcIl0sZnVuY3Rpb24oZSx0LG4scyl7dFtzXT1jLnBhcnNlVHdvRGlnaXRZZWFyKGUpfSksSShcIlFcIiwwLFwiUW9cIixcInF1YXJ0ZXJcIiksSChcInF1YXJ0ZXJcIixcIlFcIiksTChcInF1YXJ0ZXJcIiw3KSx1ZShcIlFcIixaKSxjZShcIlFcIixmdW5jdGlvbihlLHQpe3RbX2VdPTMqKGsoZSktMSl9KSxJKFwiRFwiLFtcIkREXCIsMl0sXCJEb1wiLFwiZGF0ZVwiKSxIKFwiZGF0ZVwiLFwiRFwiKSxMKFwiZGF0ZVwiLDkpLHVlKFwiRFwiLEIpLHVlKFwiRERcIixCLHopLHVlKFwiRG9cIixmdW5jdGlvbihlLHQpe3JldHVybiBlP3QuX2RheU9mTW9udGhPcmRpbmFsUGFyc2V8fHQuX29yZGluYWxQYXJzZTp0Ll9kYXlPZk1vbnRoT3JkaW5hbFBhcnNlTGVuaWVudH0pLGNlKFtcIkRcIixcIkREXCJdLHllKSxjZShcIkRvXCIsZnVuY3Rpb24oZSx0KXt0W3llXT1rKGUubWF0Y2goQilbMF0pfSk7dmFyIG5uPVRlKFwiRGF0ZVwiLCEwKTtJKFwiREREXCIsW1wiRERERFwiLDNdLFwiREREb1wiLFwiZGF5T2ZZZWFyXCIpLEgoXCJkYXlPZlllYXJcIixcIkRERFwiKSxMKFwiZGF5T2ZZZWFyXCIsNCksdWUoXCJERERcIixLKSx1ZShcIkRERERcIiwkKSxjZShbXCJERERcIixcIkRERERcIl0sZnVuY3Rpb24oZSx0LG4pe24uX2RheU9mWWVhcj1rKGUpfSksSShcIm1cIixbXCJtbVwiLDJdLDAsXCJtaW51dGVcIiksSChcIm1pbnV0ZVwiLFwibVwiKSxMKFwibWludXRlXCIsMTQpLHVlKFwibVwiLEIpLHVlKFwibW1cIixCLHopLGNlKFtcIm1cIixcIm1tXCJdLHBlKTt2YXIgc249VGUoXCJNaW51dGVzXCIsITEpO0koXCJzXCIsW1wic3NcIiwyXSwwLFwic2Vjb25kXCIpLEgoXCJzZWNvbmRcIixcInNcIiksTChcInNlY29uZFwiLDE1KSx1ZShcInNcIixCKSx1ZShcInNzXCIsQix6KSxjZShbXCJzXCIsXCJzc1wiXSx2ZSk7dmFyIHJuLGFuPVRlKFwiU2Vjb25kc1wiLCExKTtmb3IoSShcIlNcIiwwLDAsZnVuY3Rpb24oKXtyZXR1cm5+fih0aGlzLm1pbGxpc2Vjb25kKCkvMTAwKX0pLEkoMCxbXCJTU1wiLDJdLDAsZnVuY3Rpb24oKXtyZXR1cm5+fih0aGlzLm1pbGxpc2Vjb25kKCkvMTApfSksSSgwLFtcIlNTU1wiLDNdLDAsXCJtaWxsaXNlY29uZFwiKSxJKDAsW1wiU1NTU1wiLDRdLDAsZnVuY3Rpb24oKXtyZXR1cm4gMTAqdGhpcy5taWxsaXNlY29uZCgpfSksSSgwLFtcIlNTU1NTXCIsNV0sMCxmdW5jdGlvbigpe3JldHVybiAxMDAqdGhpcy5taWxsaXNlY29uZCgpfSksSSgwLFtcIlNTU1NTU1wiLDZdLDAsZnVuY3Rpb24oKXtyZXR1cm4gMWUzKnRoaXMubWlsbGlzZWNvbmQoKX0pLEkoMCxbXCJTU1NTU1NTXCIsN10sMCxmdW5jdGlvbigpe3JldHVybiAxZTQqdGhpcy5taWxsaXNlY29uZCgpfSksSSgwLFtcIlNTU1NTU1NTXCIsOF0sMCxmdW5jdGlvbigpe3JldHVybiAxZTUqdGhpcy5taWxsaXNlY29uZCgpfSksSSgwLFtcIlNTU1NTU1NTU1wiLDldLDAsZnVuY3Rpb24oKXtyZXR1cm4gMWU2KnRoaXMubWlsbGlzZWNvbmQoKX0pLEgoXCJtaWxsaXNlY29uZFwiLFwibXNcIiksTChcIm1pbGxpc2Vjb25kXCIsMTYpLHVlKFwiU1wiLEssWiksdWUoXCJTU1wiLEsseiksdWUoXCJTU1NcIixLLCQpLHJuPVwiU1NTU1wiO3JuLmxlbmd0aDw9OTtybis9XCJTXCIpdWUocm4sbmUpO2Z1bmN0aW9uIG9uKGUsdCl7dFt3ZV09aygxZTMqKFwiMC5cIitlKSl9Zm9yKHJuPVwiU1wiO3JuLmxlbmd0aDw9OTtybis9XCJTXCIpY2Uocm4sb24pO3ZhciB1bj1UZShcIk1pbGxpc2Vjb25kc1wiLCExKTtJKFwielwiLDAsMCxcInpvbmVBYmJyXCIpLEkoXCJ6elwiLDAsMCxcInpvbmVOYW1lXCIpO3ZhciBsbj1NLnByb3RvdHlwZTtmdW5jdGlvbiBkbihlKXtyZXR1cm4gZX1sbi5hZGQ9cXQsbG4uY2FsZW5kYXI9ZnVuY3Rpb24oZSx0KXt2YXIgbj1lfHxUdCgpLHM9TnQobix0aGlzKS5zdGFydE9mKFwiZGF5XCIpLGk9Yy5jYWxlbmRhckZvcm1hdCh0aGlzLHMpfHxcInNhbWVFbHNlXCIscj10JiYoeCh0W2ldKT90W2ldLmNhbGwodGhpcyxuKTp0W2ldKTtyZXR1cm4gdGhpcy5mb3JtYXQocnx8dGhpcy5sb2NhbGVEYXRhKCkuY2FsZW5kYXIoaSx0aGlzLFR0KG4pKSl9LGxuLmNsb25lPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBNKHRoaXMpfSxsbi5kaWZmPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcyxpLHI7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiBOYU47aWYoIShzPU50KGUsdGhpcykpLmlzVmFsaWQoKSlyZXR1cm4gTmFOO3N3aXRjaChpPTZlNCoocy51dGNPZmZzZXQoKS10aGlzLnV0Y09mZnNldCgpKSx0PVIodCkpe2Nhc2VcInllYXJcIjpyPUJ0KHRoaXMscykvMTI7YnJlYWs7Y2FzZVwibW9udGhcIjpyPUJ0KHRoaXMscyk7YnJlYWs7Y2FzZVwicXVhcnRlclwiOnI9QnQodGhpcyxzKS8zO2JyZWFrO2Nhc2VcInNlY29uZFwiOnI9KHRoaXMtcykvMWUzO2JyZWFrO2Nhc2VcIm1pbnV0ZVwiOnI9KHRoaXMtcykvNmU0O2JyZWFrO2Nhc2VcImhvdXJcIjpyPSh0aGlzLXMpLzM2ZTU7YnJlYWs7Y2FzZVwiZGF5XCI6cj0odGhpcy1zLWkpLzg2NGU1O2JyZWFrO2Nhc2VcIndlZWtcIjpyPSh0aGlzLXMtaSkvNjA0OGU1O2JyZWFrO2RlZmF1bHQ6cj10aGlzLXN9cmV0dXJuIG4/cjpEKHIpfSxsbi5lbmRPZj1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09KGU9UihlKSl8fFwibWlsbGlzZWNvbmRcIj09PWU/dGhpczooXCJkYXRlXCI9PT1lJiYoZT1cImRheVwiKSx0aGlzLnN0YXJ0T2YoZSkuYWRkKDEsXCJpc29XZWVrXCI9PT1lP1wid2Vla1wiOmUpLnN1YnRyYWN0KDEsXCJtc1wiKSl9LGxuLmZvcm1hdD1mdW5jdGlvbihlKXtlfHwoZT10aGlzLmlzVXRjKCk/Yy5kZWZhdWx0Rm9ybWF0VXRjOmMuZGVmYXVsdEZvcm1hdCk7dmFyIHQ9QSh0aGlzLGUpO3JldHVybiB0aGlzLmxvY2FsZURhdGEoKS5wb3N0Zm9ybWF0KHQpfSxsbi5mcm9tPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuaXNWYWxpZCgpJiYoUyhlKSYmZS5pc1ZhbGlkKCl8fFR0KGUpLmlzVmFsaWQoKSk/QXQoe3RvOnRoaXMsZnJvbTplfSkubG9jYWxlKHRoaXMubG9jYWxlKCkpLmh1bWFuaXplKCF0KTp0aGlzLmxvY2FsZURhdGEoKS5pbnZhbGlkRGF0ZSgpfSxsbi5mcm9tTm93PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmZyb20oVHQoKSxlKX0sbG4udG89ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5pc1ZhbGlkKCkmJihTKGUpJiZlLmlzVmFsaWQoKXx8VHQoZSkuaXNWYWxpZCgpKT9BdCh7ZnJvbTp0aGlzLHRvOmV9KS5sb2NhbGUodGhpcy5sb2NhbGUoKSkuaHVtYW5pemUoIXQpOnRoaXMubG9jYWxlRGF0YSgpLmludmFsaWREYXRlKCl9LGxuLnRvTm93PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnRvKFR0KCksZSl9LGxuLmdldD1mdW5jdGlvbihlKXtyZXR1cm4geCh0aGlzW2U9UihlKV0pP3RoaXNbZV0oKTp0aGlzfSxsbi5pbnZhbGlkQXQ9ZnVuY3Rpb24oKXtyZXR1cm4gZyh0aGlzKS5vdmVyZmxvd30sbG4uaXNBZnRlcj1mdW5jdGlvbihlLHQpe3ZhciBuPVMoZSk/ZTpUdChlKTtyZXR1cm4hKCF0aGlzLmlzVmFsaWQoKXx8IW4uaXNWYWxpZCgpKSYmKFwibWlsbGlzZWNvbmRcIj09PSh0PVIobCh0KT9cIm1pbGxpc2Vjb25kXCI6dCkpP3RoaXMudmFsdWVPZigpPm4udmFsdWVPZigpOm4udmFsdWVPZigpPHRoaXMuY2xvbmUoKS5zdGFydE9mKHQpLnZhbHVlT2YoKSl9LGxuLmlzQmVmb3JlPWZ1bmN0aW9uKGUsdCl7dmFyIG49UyhlKT9lOlR0KGUpO3JldHVybiEoIXRoaXMuaXNWYWxpZCgpfHwhbi5pc1ZhbGlkKCkpJiYoXCJtaWxsaXNlY29uZFwiPT09KHQ9UihsKHQpP1wibWlsbGlzZWNvbmRcIjp0KSk/dGhpcy52YWx1ZU9mKCk8bi52YWx1ZU9mKCk6dGhpcy5jbG9uZSgpLmVuZE9mKHQpLnZhbHVlT2YoKTxuLnZhbHVlT2YoKSl9LGxuLmlzQmV0d2Vlbj1mdW5jdGlvbihlLHQsbixzKXtyZXR1cm4oXCIoXCI9PT0ocz1zfHxcIigpXCIpWzBdP3RoaXMuaXNBZnRlcihlLG4pOiF0aGlzLmlzQmVmb3JlKGUsbikpJiYoXCIpXCI9PT1zWzFdP3RoaXMuaXNCZWZvcmUodCxuKTohdGhpcy5pc0FmdGVyKHQsbikpfSxsbi5pc1NhbWU9ZnVuY3Rpb24oZSx0KXt2YXIgbixzPVMoZSk/ZTpUdChlKTtyZXR1cm4hKCF0aGlzLmlzVmFsaWQoKXx8IXMuaXNWYWxpZCgpKSYmKFwibWlsbGlzZWNvbmRcIj09PSh0PVIodHx8XCJtaWxsaXNlY29uZFwiKSk/dGhpcy52YWx1ZU9mKCk9PT1zLnZhbHVlT2YoKToobj1zLnZhbHVlT2YoKSx0aGlzLmNsb25lKCkuc3RhcnRPZih0KS52YWx1ZU9mKCk8PW4mJm48PXRoaXMuY2xvbmUoKS5lbmRPZih0KS52YWx1ZU9mKCkpKX0sbG4uaXNTYW1lT3JBZnRlcj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmlzU2FtZShlLHQpfHx0aGlzLmlzQWZ0ZXIoZSx0KX0sbG4uaXNTYW1lT3JCZWZvcmU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5pc1NhbWUoZSx0KXx8dGhpcy5pc0JlZm9yZShlLHQpfSxsbi5pc1ZhbGlkPWZ1bmN0aW9uKCl7cmV0dXJuIHAodGhpcyl9LGxuLmxhbmc9WHQsbG4ubG9jYWxlPVF0LGxuLmxvY2FsZURhdGE9S3QsbG4ubWF4PWJ0LGxuLm1pbj14dCxsbi5wYXJzaW5nRmxhZ3M9ZnVuY3Rpb24oKXtyZXR1cm4gXyh7fSxnKHRoaXMpKX0sbG4uc2V0PWZ1bmN0aW9uKGUsdCl7aWYoXCJvYmplY3RcIj09dHlwZW9mIGUpZm9yKHZhciBuPWZ1bmN0aW9uKGUpe3ZhciB0PVtdO2Zvcih2YXIgbiBpbiBlKXQucHVzaCh7dW5pdDpuLHByaW9yaXR5OkZbbl19KTtyZXR1cm4gdC5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUucHJpb3JpdHktdC5wcmlvcml0eX0pLHR9KGU9QyhlKSkscz0wO3M8bi5sZW5ndGg7cysrKXRoaXNbbltzXS51bml0XShlW25bc10udW5pdF0pO2Vsc2UgaWYoeCh0aGlzW2U9UihlKV0pKXJldHVybiB0aGlzW2VdKHQpO3JldHVybiB0aGlzfSxsbi5zdGFydE9mPWZ1bmN0aW9uKGUpe3N3aXRjaChlPVIoZSkpe2Nhc2VcInllYXJcIjp0aGlzLm1vbnRoKDApO2Nhc2VcInF1YXJ0ZXJcIjpjYXNlXCJtb250aFwiOnRoaXMuZGF0ZSgxKTtjYXNlXCJ3ZWVrXCI6Y2FzZVwiaXNvV2Vla1wiOmNhc2VcImRheVwiOmNhc2VcImRhdGVcIjp0aGlzLmhvdXJzKDApO2Nhc2VcImhvdXJcIjp0aGlzLm1pbnV0ZXMoMCk7Y2FzZVwibWludXRlXCI6dGhpcy5zZWNvbmRzKDApO2Nhc2VcInNlY29uZFwiOnRoaXMubWlsbGlzZWNvbmRzKDApfXJldHVyblwid2Vla1wiPT09ZSYmdGhpcy53ZWVrZGF5KDApLFwiaXNvV2Vla1wiPT09ZSYmdGhpcy5pc29XZWVrZGF5KDEpLFwicXVhcnRlclwiPT09ZSYmdGhpcy5tb250aCgzKk1hdGguZmxvb3IodGhpcy5tb250aCgpLzMpKSx0aGlzfSxsbi5zdWJ0cmFjdD1KdCxsbi50b0FycmF5PWZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm5bZS55ZWFyKCksZS5tb250aCgpLGUuZGF0ZSgpLGUuaG91cigpLGUubWludXRlKCksZS5zZWNvbmQoKSxlLm1pbGxpc2Vjb25kKCldfSxsbi50b09iamVjdD1mdW5jdGlvbigpe3ZhciBlPXRoaXM7cmV0dXJue3llYXJzOmUueWVhcigpLG1vbnRoczplLm1vbnRoKCksZGF0ZTplLmRhdGUoKSxob3VyczplLmhvdXJzKCksbWludXRlczplLm1pbnV0ZXMoKSxzZWNvbmRzOmUuc2Vjb25kcygpLG1pbGxpc2Vjb25kczplLm1pbGxpc2Vjb25kcygpfX0sbG4udG9EYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBEYXRlKHRoaXMudmFsdWVPZigpKX0sbG4udG9JU09TdHJpbmc9ZnVuY3Rpb24oZSl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiBudWxsO3ZhciB0PSEwIT09ZSxuPXQ/dGhpcy5jbG9uZSgpLnV0YygpOnRoaXM7cmV0dXJuIG4ueWVhcigpPDB8fDk5OTk8bi55ZWFyKCk/QShuLHQ/XCJZWVlZWVktTU0tRERbVF1ISDptbTpzcy5TU1NbWl1cIjpcIllZWVlZWS1NTS1ERFtUXUhIOm1tOnNzLlNTU1pcIik6eChEYXRlLnByb3RvdHlwZS50b0lTT1N0cmluZyk/dD90aGlzLnRvRGF0ZSgpLnRvSVNPU3RyaW5nKCk6bmV3IERhdGUodGhpcy52YWx1ZU9mKCkrNjAqdGhpcy51dGNPZmZzZXQoKSoxZTMpLnRvSVNPU3RyaW5nKCkucmVwbGFjZShcIlpcIixBKG4sXCJaXCIpKTpBKG4sdD9cIllZWVktTU0tRERbVF1ISDptbTpzcy5TU1NbWl1cIjpcIllZWVktTU0tRERbVF1ISDptbTpzcy5TU1NaXCIpfSxsbi5pbnNwZWN0PWZ1bmN0aW9uKCl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVyblwibW9tZW50LmludmFsaWQoLyogXCIrdGhpcy5faStcIiAqLylcIjt2YXIgZT1cIm1vbWVudFwiLHQ9XCJcIjt0aGlzLmlzTG9jYWwoKXx8KGU9MD09PXRoaXMudXRjT2Zmc2V0KCk/XCJtb21lbnQudXRjXCI6XCJtb21lbnQucGFyc2Vab25lXCIsdD1cIlpcIik7dmFyIG49XCJbXCIrZSsnKFwiXScscz0wPD10aGlzLnllYXIoKSYmdGhpcy55ZWFyKCk8PTk5OTk/XCJZWVlZXCI6XCJZWVlZWVlcIixpPXQrJ1tcIildJztyZXR1cm4gdGhpcy5mb3JtYXQobitzK1wiLU1NLUREW1RdSEg6bW06c3MuU1NTXCIraSl9LGxuLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzVmFsaWQoKT90aGlzLnRvSVNPU3RyaW5nKCk6bnVsbH0sbG4udG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbG9uZSgpLmxvY2FsZShcImVuXCIpLmZvcm1hdChcImRkZCBNTU0gREQgWVlZWSBISDptbTpzcyBbR01UXVpaXCIpfSxsbi51bml4PWZ1bmN0aW9uKCl7cmV0dXJuIE1hdGguZmxvb3IodGhpcy52YWx1ZU9mKCkvMWUzKX0sbG4udmFsdWVPZj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9kLnZhbHVlT2YoKS02ZTQqKHRoaXMuX29mZnNldHx8MCl9LGxuLmNyZWF0aW9uRGF0YT1mdW5jdGlvbigpe3JldHVybntpbnB1dDp0aGlzLl9pLGZvcm1hdDp0aGlzLl9mLGxvY2FsZTp0aGlzLl9sb2NhbGUsaXNVVEM6dGhpcy5faXNVVEMsc3RyaWN0OnRoaXMuX3N0cmljdH19LGxuLnllYXI9T2UsbG4uaXNMZWFwWWVhcj1mdW5jdGlvbigpe3JldHVybiBrZSh0aGlzLnllYXIoKSl9LGxuLndlZWtZZWFyPWZ1bmN0aW9uKGUpe3JldHVybiB0bi5jYWxsKHRoaXMsZSx0aGlzLndlZWsoKSx0aGlzLndlZWtkYXkoKSx0aGlzLmxvY2FsZURhdGEoKS5fd2Vlay5kb3csdGhpcy5sb2NhbGVEYXRhKCkuX3dlZWsuZG95KX0sbG4uaXNvV2Vla1llYXI9ZnVuY3Rpb24oZSl7cmV0dXJuIHRuLmNhbGwodGhpcyxlLHRoaXMuaXNvV2VlaygpLHRoaXMuaXNvV2Vla2RheSgpLDEsNCl9LGxuLnF1YXJ0ZXI9bG4ucXVhcnRlcnM9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWU/TWF0aC5jZWlsKCh0aGlzLm1vbnRoKCkrMSkvMyk6dGhpcy5tb250aCgzKihlLTEpK3RoaXMubW9udGgoKSUzKX0sbG4ubW9udGg9RmUsbG4uZGF5c0luTW9udGg9ZnVuY3Rpb24oKXtyZXR1cm4gUGUodGhpcy55ZWFyKCksdGhpcy5tb250aCgpKX0sbG4ud2Vlaz1sbi53ZWVrcz1mdW5jdGlvbihlKXt2YXIgdD10aGlzLmxvY2FsZURhdGEoKS53ZWVrKHRoaXMpO3JldHVybiBudWxsPT1lP3Q6dGhpcy5hZGQoNyooZS10KSxcImRcIil9LGxuLmlzb1dlZWs9bG4uaXNvV2Vla3M9ZnVuY3Rpb24oZSl7dmFyIHQ9SWUodGhpcywxLDQpLndlZWs7cmV0dXJuIG51bGw9PWU/dDp0aGlzLmFkZCg3KihlLXQpLFwiZFwiKX0sbG4ud2Vla3NJblllYXI9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmxvY2FsZURhdGEoKS5fd2VlaztyZXR1cm4gQWUodGhpcy55ZWFyKCksZS5kb3csZS5kb3kpfSxsbi5pc29XZWVrc0luWWVhcj1mdW5jdGlvbigpe3JldHVybiBBZSh0aGlzLnllYXIoKSwxLDQpfSxsbi5kYXRlPW5uLGxuLmRheT1sbi5kYXlzPWZ1bmN0aW9uKGUpe2lmKCF0aGlzLmlzVmFsaWQoKSlyZXR1cm4gbnVsbCE9ZT90aGlzOk5hTjt2YXIgdCxuLHM9dGhpcy5faXNVVEM/dGhpcy5fZC5nZXRVVENEYXkoKTp0aGlzLl9kLmdldERheSgpO3JldHVybiBudWxsIT1lPyh0PWUsbj10aGlzLmxvY2FsZURhdGEoKSxlPVwic3RyaW5nXCIhPXR5cGVvZiB0P3Q6aXNOYU4odCk/XCJudW1iZXJcIj09dHlwZW9mKHQ9bi53ZWVrZGF5c1BhcnNlKHQpKT90Om51bGw6cGFyc2VJbnQodCwxMCksdGhpcy5hZGQoZS1zLFwiZFwiKSk6c30sbG4ud2Vla2RheT1mdW5jdGlvbihlKXtpZighdGhpcy5pc1ZhbGlkKCkpcmV0dXJuIG51bGwhPWU/dGhpczpOYU47dmFyIHQ9KHRoaXMuZGF5KCkrNy10aGlzLmxvY2FsZURhdGEoKS5fd2Vlay5kb3cpJTc7cmV0dXJuIG51bGw9PWU/dDp0aGlzLmFkZChlLXQsXCJkXCIpfSxsbi5pc29XZWVrZGF5PWZ1bmN0aW9uKGUpe2lmKCF0aGlzLmlzVmFsaWQoKSlyZXR1cm4gbnVsbCE9ZT90aGlzOk5hTjtpZihudWxsIT1lKXt2YXIgdD0obj1lLHM9dGhpcy5sb2NhbGVEYXRhKCksXCJzdHJpbmdcIj09dHlwZW9mIG4/cy53ZWVrZGF5c1BhcnNlKG4pJTd8fDc6aXNOYU4obik/bnVsbDpuKTtyZXR1cm4gdGhpcy5kYXkodGhpcy5kYXkoKSU3P3Q6dC03KX1yZXR1cm4gdGhpcy5kYXkoKXx8Nzt2YXIgbixzfSxsbi5kYXlPZlllYXI9ZnVuY3Rpb24oZSl7dmFyIHQ9TWF0aC5yb3VuZCgodGhpcy5jbG9uZSgpLnN0YXJ0T2YoXCJkYXlcIiktdGhpcy5jbG9uZSgpLnN0YXJ0T2YoXCJ5ZWFyXCIpKS84NjRlNSkrMTtyZXR1cm4gbnVsbD09ZT90OnRoaXMuYWRkKGUtdCxcImRcIil9LGxuLmhvdXI9bG4uaG91cnM9dHQsbG4ubWludXRlPWxuLm1pbnV0ZXM9c24sbG4uc2Vjb25kPWxuLnNlY29uZHM9YW4sbG4ubWlsbGlzZWNvbmQ9bG4ubWlsbGlzZWNvbmRzPXVuLGxuLnV0Y09mZnNldD1mdW5jdGlvbihlLHQsbil7dmFyIHMsaT10aGlzLl9vZmZzZXR8fDA7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiBudWxsIT1lP3RoaXM6TmFOO2lmKG51bGwhPWUpe2lmKFwic3RyaW5nXCI9PXR5cGVvZiBlKXtpZihudWxsPT09KGU9VXQocmUsZSkpKXJldHVybiB0aGlzfWVsc2UgTWF0aC5hYnMoZSk8MTYmJiFuJiYoZSo9NjApO3JldHVybiF0aGlzLl9pc1VUQyYmdCYmKHM9R3QodGhpcykpLHRoaXMuX29mZnNldD1lLHRoaXMuX2lzVVRDPSEwLG51bGwhPXMmJnRoaXMuYWRkKHMsXCJtXCIpLGkhPT1lJiYoIXR8fHRoaXMuX2NoYW5nZUluUHJvZ3Jlc3M/JHQodGhpcyxBdChlLWksXCJtXCIpLDEsITEpOnRoaXMuX2NoYW5nZUluUHJvZ3Jlc3N8fCh0aGlzLl9jaGFuZ2VJblByb2dyZXNzPSEwLGMudXBkYXRlT2Zmc2V0KHRoaXMsITApLHRoaXMuX2NoYW5nZUluUHJvZ3Jlc3M9bnVsbCkpLHRoaXN9cmV0dXJuIHRoaXMuX2lzVVRDP2k6R3QodGhpcyl9LGxuLnV0Yz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy51dGNPZmZzZXQoMCxlKX0sbG4ubG9jYWw9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2lzVVRDJiYodGhpcy51dGNPZmZzZXQoMCxlKSx0aGlzLl9pc1VUQz0hMSxlJiZ0aGlzLnN1YnRyYWN0KEd0KHRoaXMpLFwibVwiKSksdGhpc30sbG4ucGFyc2Vab25lPWZ1bmN0aW9uKCl7aWYobnVsbCE9dGhpcy5fdHptKXRoaXMudXRjT2Zmc2V0KHRoaXMuX3R6bSwhMSwhMCk7ZWxzZSBpZihcInN0cmluZ1wiPT10eXBlb2YgdGhpcy5faSl7dmFyIGU9VXQoaWUsdGhpcy5faSk7bnVsbCE9ZT90aGlzLnV0Y09mZnNldChlKTp0aGlzLnV0Y09mZnNldCgwLCEwKX1yZXR1cm4gdGhpc30sbG4uaGFzQWxpZ25lZEhvdXJPZmZzZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuISF0aGlzLmlzVmFsaWQoKSYmKGU9ZT9UdChlKS51dGNPZmZzZXQoKTowLCh0aGlzLnV0Y09mZnNldCgpLWUpJTYwPT0wKX0sbG4uaXNEU1Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51dGNPZmZzZXQoKT50aGlzLmNsb25lKCkubW9udGgoMCkudXRjT2Zmc2V0KCl8fHRoaXMudXRjT2Zmc2V0KCk+dGhpcy5jbG9uZSgpLm1vbnRoKDUpLnV0Y09mZnNldCgpfSxsbi5pc0xvY2FsPWZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLmlzVmFsaWQoKSYmIXRoaXMuX2lzVVRDfSxsbi5pc1V0Y09mZnNldD1mdW5jdGlvbigpe3JldHVybiEhdGhpcy5pc1ZhbGlkKCkmJnRoaXMuX2lzVVRDfSxsbi5pc1V0Yz1WdCxsbi5pc1VUQz1WdCxsbi56b25lQWJicj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9pc1VUQz9cIlVUQ1wiOlwiXCJ9LGxuLnpvbmVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzVVRDP1wiQ29vcmRpbmF0ZWQgVW5pdmVyc2FsIFRpbWVcIjpcIlwifSxsbi5kYXRlcz1uKFwiZGF0ZXMgYWNjZXNzb3IgaXMgZGVwcmVjYXRlZC4gVXNlIGRhdGUgaW5zdGVhZC5cIixubiksbG4ubW9udGhzPW4oXCJtb250aHMgYWNjZXNzb3IgaXMgZGVwcmVjYXRlZC4gVXNlIG1vbnRoIGluc3RlYWRcIixGZSksbG4ueWVhcnM9bihcInllYXJzIGFjY2Vzc29yIGlzIGRlcHJlY2F0ZWQuIFVzZSB5ZWFyIGluc3RlYWRcIixPZSksbG4uem9uZT1uKFwibW9tZW50KCkuem9uZSBpcyBkZXByZWNhdGVkLCB1c2UgbW9tZW50KCkudXRjT2Zmc2V0IGluc3RlYWQuIGh0dHA6Ly9tb21lbnRqcy5jb20vZ3VpZGVzLyMvd2FybmluZ3Mvem9uZS9cIixmdW5jdGlvbihlLHQpe3JldHVybiBudWxsIT1lPyhcInN0cmluZ1wiIT10eXBlb2YgZSYmKGU9LWUpLHRoaXMudXRjT2Zmc2V0KGUsdCksdGhpcyk6LXRoaXMudXRjT2Zmc2V0KCl9KSxsbi5pc0RTVFNoaWZ0ZWQ9bihcImlzRFNUU2hpZnRlZCBpcyBkZXByZWNhdGVkLiBTZWUgaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9kc3Qtc2hpZnRlZC8gZm9yIG1vcmUgaW5mb3JtYXRpb25cIixmdW5jdGlvbigpe2lmKCFsKHRoaXMuX2lzRFNUU2hpZnRlZCkpcmV0dXJuIHRoaXMuX2lzRFNUU2hpZnRlZDt2YXIgZT17fTtpZih3KGUsdGhpcyksKGU9WXQoZSkpLl9hKXt2YXIgdD1lLl9pc1VUQz95KGUuX2EpOlR0KGUuX2EpO3RoaXMuX2lzRFNUU2hpZnRlZD10aGlzLmlzVmFsaWQoKSYmMDxhKGUuX2EsdC50b0FycmF5KCkpfWVsc2UgdGhpcy5faXNEU1RTaGlmdGVkPSExO3JldHVybiB0aGlzLl9pc0RTVFNoaWZ0ZWR9KTt2YXIgaG49UC5wcm90b3R5cGU7ZnVuY3Rpb24gY24oZSx0LG4scyl7dmFyIGk9bHQoKSxyPXkoKS5zZXQocyx0KTtyZXR1cm4gaVtuXShyLGUpfWZ1bmN0aW9uIGZuKGUsdCxuKXtpZihkKGUpJiYodD1lLGU9dm9pZCAwKSxlPWV8fFwiXCIsbnVsbCE9dClyZXR1cm4gY24oZSx0LG4sXCJtb250aFwiKTt2YXIgcyxpPVtdO2ZvcihzPTA7czwxMjtzKyspaVtzXT1jbihlLHMsbixcIm1vbnRoXCIpO3JldHVybiBpfWZ1bmN0aW9uIG1uKGUsdCxuLHMpe1wiYm9vbGVhblwiPT10eXBlb2YgZT9kKHQpJiYobj10LHQ9dm9pZCAwKToodD1lLGU9ITEsZChuPXQpJiYobj10LHQ9dm9pZCAwKSksdD10fHxcIlwiO3ZhciBpLHI9bHQoKSxhPWU/ci5fd2Vlay5kb3c6MDtpZihudWxsIT1uKXJldHVybiBjbih0LChuK2EpJTcscyxcImRheVwiKTt2YXIgbz1bXTtmb3IoaT0wO2k8NztpKyspb1tpXT1jbih0LChpK2EpJTcscyxcImRheVwiKTtyZXR1cm4gb31obi5jYWxlbmRhcj1mdW5jdGlvbihlLHQsbil7dmFyIHM9dGhpcy5fY2FsZW5kYXJbZV18fHRoaXMuX2NhbGVuZGFyLnNhbWVFbHNlO3JldHVybiB4KHMpP3MuY2FsbCh0LG4pOnN9LGhuLmxvbmdEYXRlRm9ybWF0PWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuX2xvbmdEYXRlRm9ybWF0W2VdLG49dGhpcy5fbG9uZ0RhdGVGb3JtYXRbZS50b1VwcGVyQ2FzZSgpXTtyZXR1cm4gdHx8IW4/dDoodGhpcy5fbG9uZ0RhdGVGb3JtYXRbZV09bi5yZXBsYWNlKC9NTU1NfE1NfEREfGRkZGQvZyxmdW5jdGlvbihlKXtyZXR1cm4gZS5zbGljZSgxKX0pLHRoaXMuX2xvbmdEYXRlRm9ybWF0W2VdKX0saG4uaW52YWxpZERhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faW52YWxpZERhdGV9LGhuLm9yZGluYWw9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX29yZGluYWwucmVwbGFjZShcIiVkXCIsZSl9LGhuLnByZXBhcnNlPWRuLGhuLnBvc3Rmb3JtYXQ9ZG4saG4ucmVsYXRpdmVUaW1lPWZ1bmN0aW9uKGUsdCxuLHMpe3ZhciBpPXRoaXMuX3JlbGF0aXZlVGltZVtuXTtyZXR1cm4geChpKT9pKGUsdCxuLHMpOmkucmVwbGFjZSgvJWQvaSxlKX0saG4ucGFzdEZ1dHVyZT1mdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMuX3JlbGF0aXZlVGltZVswPGU/XCJmdXR1cmVcIjpcInBhc3RcIl07cmV0dXJuIHgobik/bih0KTpuLnJlcGxhY2UoLyVzL2ksdCl9LGhuLnNldD1mdW5jdGlvbihlKXt2YXIgdCxuO2ZvcihuIGluIGUpeCh0PWVbbl0pP3RoaXNbbl09dDp0aGlzW1wiX1wiK25dPXQ7dGhpcy5fY29uZmlnPWUsdGhpcy5fZGF5T2ZNb250aE9yZGluYWxQYXJzZUxlbmllbnQ9bmV3IFJlZ0V4cCgodGhpcy5fZGF5T2ZNb250aE9yZGluYWxQYXJzZS5zb3VyY2V8fHRoaXMuX29yZGluYWxQYXJzZS5zb3VyY2UpK1wifFwiKy9cXGR7MSwyfS8uc291cmNlKX0saG4ubW9udGhzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU/byh0aGlzLl9tb250aHMpP3RoaXMuX21vbnRoc1tlLm1vbnRoKCldOnRoaXMuX21vbnRoc1sodGhpcy5fbW9udGhzLmlzRm9ybWF0fHxXZSkudGVzdCh0KT9cImZvcm1hdFwiOlwic3RhbmRhbG9uZVwiXVtlLm1vbnRoKCldOm8odGhpcy5fbW9udGhzKT90aGlzLl9tb250aHM6dGhpcy5fbW9udGhzLnN0YW5kYWxvbmV9LGhuLm1vbnRoc1Nob3J0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU/byh0aGlzLl9tb250aHNTaG9ydCk/dGhpcy5fbW9udGhzU2hvcnRbZS5tb250aCgpXTp0aGlzLl9tb250aHNTaG9ydFtXZS50ZXN0KHQpP1wiZm9ybWF0XCI6XCJzdGFuZGFsb25lXCJdW2UubW9udGgoKV06byh0aGlzLl9tb250aHNTaG9ydCk/dGhpcy5fbW9udGhzU2hvcnQ6dGhpcy5fbW9udGhzU2hvcnQuc3RhbmRhbG9uZX0saG4ubW9udGhzUGFyc2U9ZnVuY3Rpb24oZSx0LG4pe3ZhciBzLGkscjtpZih0aGlzLl9tb250aHNQYXJzZUV4YWN0KXJldHVybiBmdW5jdGlvbihlLHQsbil7dmFyIHMsaSxyLGE9ZS50b0xvY2FsZUxvd2VyQ2FzZSgpO2lmKCF0aGlzLl9tb250aHNQYXJzZSlmb3IodGhpcy5fbW9udGhzUGFyc2U9W10sdGhpcy5fbG9uZ01vbnRoc1BhcnNlPVtdLHRoaXMuX3Nob3J0TW9udGhzUGFyc2U9W10scz0wO3M8MTI7KytzKXI9eShbMmUzLHNdKSx0aGlzLl9zaG9ydE1vbnRoc1BhcnNlW3NdPXRoaXMubW9udGhzU2hvcnQocixcIlwiKS50b0xvY2FsZUxvd2VyQ2FzZSgpLHRoaXMuX2xvbmdNb250aHNQYXJzZVtzXT10aGlzLm1vbnRocyhyLFwiXCIpLnRvTG9jYWxlTG93ZXJDYXNlKCk7cmV0dXJuIG4/XCJNTU1cIj09PXQ/LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3Nob3J0TW9udGhzUGFyc2UsYSkpP2k6bnVsbDotMSE9PShpPVllLmNhbGwodGhpcy5fbG9uZ01vbnRoc1BhcnNlLGEpKT9pOm51bGw6XCJNTU1cIj09PXQ/LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3Nob3J0TW9udGhzUGFyc2UsYSkpP2k6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX2xvbmdNb250aHNQYXJzZSxhKSk/aTpudWxsOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9sb25nTW9udGhzUGFyc2UsYSkpP2k6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3Nob3J0TW9udGhzUGFyc2UsYSkpP2k6bnVsbH0uY2FsbCh0aGlzLGUsdCxuKTtmb3IodGhpcy5fbW9udGhzUGFyc2V8fCh0aGlzLl9tb250aHNQYXJzZT1bXSx0aGlzLl9sb25nTW9udGhzUGFyc2U9W10sdGhpcy5fc2hvcnRNb250aHNQYXJzZT1bXSkscz0wO3M8MTI7cysrKXtpZihpPXkoWzJlMyxzXSksbiYmIXRoaXMuX2xvbmdNb250aHNQYXJzZVtzXSYmKHRoaXMuX2xvbmdNb250aHNQYXJzZVtzXT1uZXcgUmVnRXhwKFwiXlwiK3RoaXMubW9udGhzKGksXCJcIikucmVwbGFjZShcIi5cIixcIlwiKStcIiRcIixcImlcIiksdGhpcy5fc2hvcnRNb250aHNQYXJzZVtzXT1uZXcgUmVnRXhwKFwiXlwiK3RoaXMubW9udGhzU2hvcnQoaSxcIlwiKS5yZXBsYWNlKFwiLlwiLFwiXCIpK1wiJFwiLFwiaVwiKSksbnx8dGhpcy5fbW9udGhzUGFyc2Vbc118fChyPVwiXlwiK3RoaXMubW9udGhzKGksXCJcIikrXCJ8XlwiK3RoaXMubW9udGhzU2hvcnQoaSxcIlwiKSx0aGlzLl9tb250aHNQYXJzZVtzXT1uZXcgUmVnRXhwKHIucmVwbGFjZShcIi5cIixcIlwiKSxcImlcIikpLG4mJlwiTU1NTVwiPT09dCYmdGhpcy5fbG9uZ01vbnRoc1BhcnNlW3NdLnRlc3QoZSkpcmV0dXJuIHM7aWYobiYmXCJNTU1cIj09PXQmJnRoaXMuX3Nob3J0TW9udGhzUGFyc2Vbc10udGVzdChlKSlyZXR1cm4gcztpZighbiYmdGhpcy5fbW9udGhzUGFyc2Vbc10udGVzdChlKSlyZXR1cm4gc319LGhuLm1vbnRoc1JlZ2V4PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9tb250aHNQYXJzZUV4YWN0PyhtKHRoaXMsXCJfbW9udGhzUmVnZXhcIil8fE5lLmNhbGwodGhpcyksZT90aGlzLl9tb250aHNTdHJpY3RSZWdleDp0aGlzLl9tb250aHNSZWdleCk6KG0odGhpcyxcIl9tb250aHNSZWdleFwiKXx8KHRoaXMuX21vbnRoc1JlZ2V4PVVlKSx0aGlzLl9tb250aHNTdHJpY3RSZWdleCYmZT90aGlzLl9tb250aHNTdHJpY3RSZWdleDp0aGlzLl9tb250aHNSZWdleCl9LGhuLm1vbnRoc1Nob3J0UmVnZXg9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX21vbnRoc1BhcnNlRXhhY3Q/KG0odGhpcyxcIl9tb250aHNSZWdleFwiKXx8TmUuY2FsbCh0aGlzKSxlP3RoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXg6dGhpcy5fbW9udGhzU2hvcnRSZWdleCk6KG0odGhpcyxcIl9tb250aHNTaG9ydFJlZ2V4XCIpfHwodGhpcy5fbW9udGhzU2hvcnRSZWdleD1MZSksdGhpcy5fbW9udGhzU2hvcnRTdHJpY3RSZWdleCYmZT90aGlzLl9tb250aHNTaG9ydFN0cmljdFJlZ2V4OnRoaXMuX21vbnRoc1Nob3J0UmVnZXgpfSxobi53ZWVrPWZ1bmN0aW9uKGUpe3JldHVybiBJZShlLHRoaXMuX3dlZWsuZG93LHRoaXMuX3dlZWsuZG95KS53ZWVrfSxobi5maXJzdERheU9mWWVhcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLl93ZWVrLmRveX0saG4uZmlyc3REYXlPZldlZWs9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fd2Vlay5kb3d9LGhuLndlZWtkYXlzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU/byh0aGlzLl93ZWVrZGF5cyk/dGhpcy5fd2Vla2RheXNbZS5kYXkoKV06dGhpcy5fd2Vla2RheXNbdGhpcy5fd2Vla2RheXMuaXNGb3JtYXQudGVzdCh0KT9cImZvcm1hdFwiOlwic3RhbmRhbG9uZVwiXVtlLmRheSgpXTpvKHRoaXMuX3dlZWtkYXlzKT90aGlzLl93ZWVrZGF5czp0aGlzLl93ZWVrZGF5cy5zdGFuZGFsb25lfSxobi53ZWVrZGF5c01pbj1mdW5jdGlvbihlKXtyZXR1cm4gZT90aGlzLl93ZWVrZGF5c01pbltlLmRheSgpXTp0aGlzLl93ZWVrZGF5c01pbn0saG4ud2Vla2RheXNTaG9ydD1mdW5jdGlvbihlKXtyZXR1cm4gZT90aGlzLl93ZWVrZGF5c1Nob3J0W2UuZGF5KCldOnRoaXMuX3dlZWtkYXlzU2hvcnR9LGhuLndlZWtkYXlzUGFyc2U9ZnVuY3Rpb24oZSx0LG4pe3ZhciBzLGkscjtpZih0aGlzLl93ZWVrZGF5c1BhcnNlRXhhY3QpcmV0dXJuIGZ1bmN0aW9uKGUsdCxuKXt2YXIgcyxpLHIsYT1lLnRvTG9jYWxlTG93ZXJDYXNlKCk7aWYoIXRoaXMuX3dlZWtkYXlzUGFyc2UpZm9yKHRoaXMuX3dlZWtkYXlzUGFyc2U9W10sdGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlPVtdLHRoaXMuX21pbldlZWtkYXlzUGFyc2U9W10scz0wO3M8NzsrK3Mpcj15KFsyZTMsMV0pLmRheShzKSx0aGlzLl9taW5XZWVrZGF5c1BhcnNlW3NdPXRoaXMud2Vla2RheXNNaW4ocixcIlwiKS50b0xvY2FsZUxvd2VyQ2FzZSgpLHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZVtzXT10aGlzLndlZWtkYXlzU2hvcnQocixcIlwiKS50b0xvY2FsZUxvd2VyQ2FzZSgpLHRoaXMuX3dlZWtkYXlzUGFyc2Vbc109dGhpcy53ZWVrZGF5cyhyLFwiXCIpLnRvTG9jYWxlTG93ZXJDYXNlKCk7cmV0dXJuIG4/XCJkZGRkXCI9PT10Py0xIT09KGk9WWUuY2FsbCh0aGlzLl93ZWVrZGF5c1BhcnNlLGEpKT9pOm51bGw6XCJkZGRcIj09PXQ/LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZSxhKSk/aTpudWxsOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9taW5XZWVrZGF5c1BhcnNlLGEpKT9pOm51bGw6XCJkZGRkXCI9PT10Py0xIT09KGk9WWUuY2FsbCh0aGlzLl93ZWVrZGF5c1BhcnNlLGEpKT9pOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2UsYSkpP2k6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX21pbldlZWtkYXlzUGFyc2UsYSkpP2k6bnVsbDpcImRkZFwiPT09dD8tMSE9PShpPVllLmNhbGwodGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlLGEpKT9pOi0xIT09KGk9WWUuY2FsbCh0aGlzLl93ZWVrZGF5c1BhcnNlLGEpKT9pOi0xIT09KGk9WWUuY2FsbCh0aGlzLl9taW5XZWVrZGF5c1BhcnNlLGEpKT9pOm51bGw6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX21pbldlZWtkYXlzUGFyc2UsYSkpP2k6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3dlZWtkYXlzUGFyc2UsYSkpP2k6LTEhPT0oaT1ZZS5jYWxsKHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZSxhKSk/aTpudWxsfS5jYWxsKHRoaXMsZSx0LG4pO2Zvcih0aGlzLl93ZWVrZGF5c1BhcnNlfHwodGhpcy5fd2Vla2RheXNQYXJzZT1bXSx0aGlzLl9taW5XZWVrZGF5c1BhcnNlPVtdLHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZT1bXSx0aGlzLl9mdWxsV2Vla2RheXNQYXJzZT1bXSkscz0wO3M8NztzKyspe2lmKGk9eShbMmUzLDFdKS5kYXkocyksbiYmIXRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlW3NdJiYodGhpcy5fZnVsbFdlZWtkYXlzUGFyc2Vbc109bmV3IFJlZ0V4cChcIl5cIit0aGlzLndlZWtkYXlzKGksXCJcIikucmVwbGFjZShcIi5cIixcIi4/XCIpK1wiJFwiLFwiaVwiKSx0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2Vbc109bmV3IFJlZ0V4cChcIl5cIit0aGlzLndlZWtkYXlzU2hvcnQoaSxcIlwiKS5yZXBsYWNlKFwiLlwiLFwiLj9cIikrXCIkXCIsXCJpXCIpLHRoaXMuX21pbldlZWtkYXlzUGFyc2Vbc109bmV3IFJlZ0V4cChcIl5cIit0aGlzLndlZWtkYXlzTWluKGksXCJcIikucmVwbGFjZShcIi5cIixcIi4/XCIpK1wiJFwiLFwiaVwiKSksdGhpcy5fd2Vla2RheXNQYXJzZVtzXXx8KHI9XCJeXCIrdGhpcy53ZWVrZGF5cyhpLFwiXCIpK1wifF5cIit0aGlzLndlZWtkYXlzU2hvcnQoaSxcIlwiKStcInxeXCIrdGhpcy53ZWVrZGF5c01pbihpLFwiXCIpLHRoaXMuX3dlZWtkYXlzUGFyc2Vbc109bmV3IFJlZ0V4cChyLnJlcGxhY2UoXCIuXCIsXCJcIiksXCJpXCIpKSxuJiZcImRkZGRcIj09PXQmJnRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlW3NdLnRlc3QoZSkpcmV0dXJuIHM7aWYobiYmXCJkZGRcIj09PXQmJnRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZVtzXS50ZXN0KGUpKXJldHVybiBzO2lmKG4mJlwiZGRcIj09PXQmJnRoaXMuX21pbldlZWtkYXlzUGFyc2Vbc10udGVzdChlKSlyZXR1cm4gcztpZighbiYmdGhpcy5fd2Vla2RheXNQYXJzZVtzXS50ZXN0KGUpKXJldHVybiBzfX0saG4ud2Vla2RheXNSZWdleD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fd2Vla2RheXNQYXJzZUV4YWN0PyhtKHRoaXMsXCJfd2Vla2RheXNSZWdleFwiKXx8QmUuY2FsbCh0aGlzKSxlP3RoaXMuX3dlZWtkYXlzU3RyaWN0UmVnZXg6dGhpcy5fd2Vla2RheXNSZWdleCk6KG0odGhpcyxcIl93ZWVrZGF5c1JlZ2V4XCIpfHwodGhpcy5fd2Vla2RheXNSZWdleD0kZSksdGhpcy5fd2Vla2RheXNTdHJpY3RSZWdleCYmZT90aGlzLl93ZWVrZGF5c1N0cmljdFJlZ2V4OnRoaXMuX3dlZWtkYXlzUmVnZXgpfSxobi53ZWVrZGF5c1Nob3J0UmVnZXg9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3dlZWtkYXlzUGFyc2VFeGFjdD8obSh0aGlzLFwiX3dlZWtkYXlzUmVnZXhcIil8fEJlLmNhbGwodGhpcyksZT90aGlzLl93ZWVrZGF5c1Nob3J0U3RyaWN0UmVnZXg6dGhpcy5fd2Vla2RheXNTaG9ydFJlZ2V4KToobSh0aGlzLFwiX3dlZWtkYXlzU2hvcnRSZWdleFwiKXx8KHRoaXMuX3dlZWtkYXlzU2hvcnRSZWdleD1xZSksdGhpcy5fd2Vla2RheXNTaG9ydFN0cmljdFJlZ2V4JiZlP3RoaXMuX3dlZWtkYXlzU2hvcnRTdHJpY3RSZWdleDp0aGlzLl93ZWVrZGF5c1Nob3J0UmVnZXgpfSxobi53ZWVrZGF5c01pblJlZ2V4PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl93ZWVrZGF5c1BhcnNlRXhhY3Q/KG0odGhpcyxcIl93ZWVrZGF5c1JlZ2V4XCIpfHxCZS5jYWxsKHRoaXMpLGU/dGhpcy5fd2Vla2RheXNNaW5TdHJpY3RSZWdleDp0aGlzLl93ZWVrZGF5c01pblJlZ2V4KToobSh0aGlzLFwiX3dlZWtkYXlzTWluUmVnZXhcIil8fCh0aGlzLl93ZWVrZGF5c01pblJlZ2V4PUplKSx0aGlzLl93ZWVrZGF5c01pblN0cmljdFJlZ2V4JiZlP3RoaXMuX3dlZWtkYXlzTWluU3RyaWN0UmVnZXg6dGhpcy5fd2Vla2RheXNNaW5SZWdleCl9LGhuLmlzUE09ZnVuY3Rpb24oZSl7cmV0dXJuXCJwXCI9PT0oZStcIlwiKS50b0xvd2VyQ2FzZSgpLmNoYXJBdCgwKX0saG4ubWVyaWRpZW09ZnVuY3Rpb24oZSx0LG4pe3JldHVybiAxMTxlP24/XCJwbVwiOlwiUE1cIjpuP1wiYW1cIjpcIkFNXCJ9LG90KFwiZW5cIix7ZGF5T2ZNb250aE9yZGluYWxQYXJzZTovXFxkezEsMn0odGh8c3R8bmR8cmQpLyxvcmRpbmFsOmZ1bmN0aW9uKGUpe3ZhciB0PWUlMTA7cmV0dXJuIGUrKDE9PT1rKGUlMTAwLzEwKT9cInRoXCI6MT09PXQ/XCJzdFwiOjI9PT10P1wibmRcIjozPT09dD9cInJkXCI6XCJ0aFwiKX19KSxjLmxhbmc9bihcIm1vbWVudC5sYW5nIGlzIGRlcHJlY2F0ZWQuIFVzZSBtb21lbnQubG9jYWxlIGluc3RlYWQuXCIsb3QpLGMubGFuZ0RhdGE9bihcIm1vbWVudC5sYW5nRGF0YSBpcyBkZXByZWNhdGVkLiBVc2UgbW9tZW50LmxvY2FsZURhdGEgaW5zdGVhZC5cIixsdCk7dmFyIF9uPU1hdGguYWJzO2Z1bmN0aW9uIHluKGUsdCxuLHMpe3ZhciBpPUF0KHQsbik7cmV0dXJuIGUuX21pbGxpc2Vjb25kcys9cyppLl9taWxsaXNlY29uZHMsZS5fZGF5cys9cyppLl9kYXlzLGUuX21vbnRocys9cyppLl9tb250aHMsZS5fYnViYmxlKCl9ZnVuY3Rpb24gZ24oZSl7cmV0dXJuIGU8MD9NYXRoLmZsb29yKGUpOk1hdGguY2VpbChlKX1mdW5jdGlvbiBwbihlKXtyZXR1cm4gNDgwMCplLzE0NjA5N31mdW5jdGlvbiB2bihlKXtyZXR1cm4gMTQ2MDk3KmUvNDgwMH1mdW5jdGlvbiB3bihlKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hcyhlKX19dmFyIE1uPXduKFwibXNcIiksU249d24oXCJzXCIpLERuPXduKFwibVwiKSxrbj13bihcImhcIiksWW49d24oXCJkXCIpLE9uPXduKFwid1wiKSxUbj13bihcIk1cIikseG49d24oXCJ5XCIpO2Z1bmN0aW9uIGJuKGUpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiB0aGlzLmlzVmFsaWQoKT90aGlzLl9kYXRhW2VdOk5hTn19dmFyIFBuPWJuKFwibWlsbGlzZWNvbmRzXCIpLFduPWJuKFwic2Vjb25kc1wiKSxIbj1ibihcIm1pbnV0ZXNcIiksUm49Ym4oXCJob3Vyc1wiKSxDbj1ibihcImRheXNcIiksRm49Ym4oXCJtb250aHNcIiksTG49Ym4oXCJ5ZWFyc1wiKTt2YXIgVW49TWF0aC5yb3VuZCxObj17c3M6NDQsczo0NSxtOjQ1LGg6MjIsZDoyNixNOjExfTt2YXIgR249TWF0aC5hYnM7ZnVuY3Rpb24gVm4oZSl7cmV0dXJuKDA8ZSktKGU8MCl8fCtlfWZ1bmN0aW9uIEVuKCl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiB0aGlzLmxvY2FsZURhdGEoKS5pbnZhbGlkRGF0ZSgpO3ZhciBlLHQsbj1Hbih0aGlzLl9taWxsaXNlY29uZHMpLzFlMyxzPUduKHRoaXMuX2RheXMpLGk9R24odGhpcy5fbW9udGhzKTt0PUQoKGU9RChuLzYwKSkvNjApLG4lPTYwLGUlPTYwO3ZhciByPUQoaS8xMiksYT1pJT0xMixvPXMsdT10LGw9ZSxkPW4/bi50b0ZpeGVkKDMpLnJlcGxhY2UoL1xcLj8wKyQvLFwiXCIpOlwiXCIsaD10aGlzLmFzU2Vjb25kcygpO2lmKCFoKXJldHVyblwiUDBEXCI7dmFyIGM9aDwwP1wiLVwiOlwiXCIsZj1Wbih0aGlzLl9tb250aHMpIT09Vm4oaCk/XCItXCI6XCJcIixtPVZuKHRoaXMuX2RheXMpIT09Vm4oaCk/XCItXCI6XCJcIixfPVZuKHRoaXMuX21pbGxpc2Vjb25kcykhPT1WbihoKT9cIi1cIjpcIlwiO3JldHVybiBjK1wiUFwiKyhyP2YrcitcIllcIjpcIlwiKSsoYT9mK2ErXCJNXCI6XCJcIikrKG8/bStvK1wiRFwiOlwiXCIpKyh1fHxsfHxkP1wiVFwiOlwiXCIpKyh1P18rdStcIkhcIjpcIlwiKSsobD9fK2wrXCJNXCI6XCJcIikrKGQ/XytkK1wiU1wiOlwiXCIpfXZhciBJbj1IdC5wcm90b3R5cGU7cmV0dXJuIEluLmlzVmFsaWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faXNWYWxpZH0sSW4uYWJzPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fZGF0YTtyZXR1cm4gdGhpcy5fbWlsbGlzZWNvbmRzPV9uKHRoaXMuX21pbGxpc2Vjb25kcyksdGhpcy5fZGF5cz1fbih0aGlzLl9kYXlzKSx0aGlzLl9tb250aHM9X24odGhpcy5fbW9udGhzKSxlLm1pbGxpc2Vjb25kcz1fbihlLm1pbGxpc2Vjb25kcyksZS5zZWNvbmRzPV9uKGUuc2Vjb25kcyksZS5taW51dGVzPV9uKGUubWludXRlcyksZS5ob3Vycz1fbihlLmhvdXJzKSxlLm1vbnRocz1fbihlLm1vbnRocyksZS55ZWFycz1fbihlLnllYXJzKSx0aGlzfSxJbi5hZGQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4geW4odGhpcyxlLHQsMSl9LEluLnN1YnRyYWN0PWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHluKHRoaXMsZSx0LC0xKX0sSW4uYXM9ZnVuY3Rpb24oZSl7aWYoIXRoaXMuaXNWYWxpZCgpKXJldHVybiBOYU47dmFyIHQsbixzPXRoaXMuX21pbGxpc2Vjb25kcztpZihcIm1vbnRoXCI9PT0oZT1SKGUpKXx8XCJ5ZWFyXCI9PT1lKXJldHVybiB0PXRoaXMuX2RheXMrcy84NjRlNSxuPXRoaXMuX21vbnRocytwbih0KSxcIm1vbnRoXCI9PT1lP246bi8xMjtzd2l0Y2godD10aGlzLl9kYXlzK01hdGgucm91bmQodm4odGhpcy5fbW9udGhzKSksZSl7Y2FzZVwid2Vla1wiOnJldHVybiB0Lzcrcy82MDQ4ZTU7Y2FzZVwiZGF5XCI6cmV0dXJuIHQrcy84NjRlNTtjYXNlXCJob3VyXCI6cmV0dXJuIDI0KnQrcy8zNmU1O2Nhc2VcIm1pbnV0ZVwiOnJldHVybiAxNDQwKnQrcy82ZTQ7Y2FzZVwic2Vjb25kXCI6cmV0dXJuIDg2NDAwKnQrcy8xZTM7Y2FzZVwibWlsbGlzZWNvbmRcIjpyZXR1cm4gTWF0aC5mbG9vcig4NjRlNSp0KStzO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKFwiVW5rbm93biB1bml0IFwiK2UpfX0sSW4uYXNNaWxsaXNlY29uZHM9TW4sSW4uYXNTZWNvbmRzPVNuLEluLmFzTWludXRlcz1EbixJbi5hc0hvdXJzPWtuLEluLmFzRGF5cz1ZbixJbi5hc1dlZWtzPU9uLEluLmFzTW9udGhzPVRuLEluLmFzWWVhcnM9eG4sSW4udmFsdWVPZj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlzVmFsaWQoKT90aGlzLl9taWxsaXNlY29uZHMrODY0ZTUqdGhpcy5fZGF5cyt0aGlzLl9tb250aHMlMTIqMjU5MmU2KzMxNTM2ZTYqayh0aGlzLl9tb250aHMvMTIpOk5hTn0sSW4uX2J1YmJsZT1mdW5jdGlvbigpe3ZhciBlLHQsbixzLGkscj10aGlzLl9taWxsaXNlY29uZHMsYT10aGlzLl9kYXlzLG89dGhpcy5fbW9udGhzLHU9dGhpcy5fZGF0YTtyZXR1cm4gMDw9ciYmMDw9YSYmMDw9b3x8cjw9MCYmYTw9MCYmbzw9MHx8KHIrPTg2NGU1KmduKHZuKG8pK2EpLG89YT0wKSx1Lm1pbGxpc2Vjb25kcz1yJTFlMyxlPUQoci8xZTMpLHUuc2Vjb25kcz1lJTYwLHQ9RChlLzYwKSx1Lm1pbnV0ZXM9dCU2MCxuPUQodC82MCksdS5ob3Vycz1uJTI0LG8rPWk9RChwbihhKz1EKG4vMjQpKSksYS09Z24odm4oaSkpLHM9RChvLzEyKSxvJT0xMix1LmRheXM9YSx1Lm1vbnRocz1vLHUueWVhcnM9cyx0aGlzfSxJbi5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBBdCh0aGlzKX0sSW4uZ2V0PWZ1bmN0aW9uKGUpe3JldHVybiBlPVIoZSksdGhpcy5pc1ZhbGlkKCk/dGhpc1tlK1wic1wiXSgpOk5hTn0sSW4ubWlsbGlzZWNvbmRzPVBuLEluLnNlY29uZHM9V24sSW4ubWludXRlcz1IbixJbi5ob3Vycz1SbixJbi5kYXlzPUNuLEluLndlZWtzPWZ1bmN0aW9uKCl7cmV0dXJuIEQodGhpcy5kYXlzKCkvNyl9LEluLm1vbnRocz1GbixJbi55ZWFycz1MbixJbi5odW1hbml6ZT1mdW5jdGlvbihlKXtpZighdGhpcy5pc1ZhbGlkKCkpcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLmludmFsaWREYXRlKCk7dmFyIHQsbixzLGkscixhLG8sdSxsLGQsaCxjPXRoaXMubG9jYWxlRGF0YSgpLGY9KG49IWUscz1jLGk9QXQodD10aGlzKS5hYnMoKSxyPVVuKGkuYXMoXCJzXCIpKSxhPVVuKGkuYXMoXCJtXCIpKSxvPVVuKGkuYXMoXCJoXCIpKSx1PVVuKGkuYXMoXCJkXCIpKSxsPVVuKGkuYXMoXCJNXCIpKSxkPVVuKGkuYXMoXCJ5XCIpKSwoaD1yPD1Obi5zcyYmW1wic1wiLHJdfHxyPE5uLnMmJltcInNzXCIscl18fGE8PTEmJltcIm1cIl18fGE8Tm4ubSYmW1wibW1cIixhXXx8bzw9MSYmW1wiaFwiXXx8bzxObi5oJiZbXCJoaFwiLG9dfHx1PD0xJiZbXCJkXCJdfHx1PE5uLmQmJltcImRkXCIsdV18fGw8PTEmJltcIk1cIl18fGw8Tm4uTSYmW1wiTU1cIixsXXx8ZDw9MSYmW1wieVwiXXx8W1wieXlcIixkXSlbMl09bixoWzNdPTA8K3QsaFs0XT1zLGZ1bmN0aW9uKGUsdCxuLHMsaSl7cmV0dXJuIGkucmVsYXRpdmVUaW1lKHR8fDEsISFuLGUscyl9LmFwcGx5KG51bGwsaCkpO3JldHVybiBlJiYoZj1jLnBhc3RGdXR1cmUoK3RoaXMsZikpLGMucG9zdGZvcm1hdChmKX0sSW4udG9JU09TdHJpbmc9RW4sSW4udG9TdHJpbmc9RW4sSW4udG9KU09OPUVuLEluLmxvY2FsZT1RdCxJbi5sb2NhbGVEYXRhPUt0LEluLnRvSXNvU3RyaW5nPW4oXCJ0b0lzb1N0cmluZygpIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgdG9JU09TdHJpbmcoKSBpbnN0ZWFkIChub3RpY2UgdGhlIGNhcGl0YWxzKVwiLEVuKSxJbi5sYW5nPVh0LEkoXCJYXCIsMCwwLFwidW5peFwiKSxJKFwieFwiLDAsMCxcInZhbHVlT2ZcIiksdWUoXCJ4XCIsc2UpLHVlKFwiWFwiLC9bKy1dP1xcZCsoXFwuXFxkezEsM30pPy8pLGNlKFwiWFwiLGZ1bmN0aW9uKGUsdCxuKXtuLl9kPW5ldyBEYXRlKDFlMypwYXJzZUZsb2F0KGUsMTApKX0pLGNlKFwieFwiLGZ1bmN0aW9uKGUsdCxuKXtuLl9kPW5ldyBEYXRlKGsoZSkpfSksYy52ZXJzaW9uPVwiMi4yMi4xXCIsZT1UdCxjLmZuPWxuLGMubWluPWZ1bmN0aW9uKCl7cmV0dXJuIFB0KFwiaXNCZWZvcmVcIixbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywwKSl9LGMubWF4PWZ1bmN0aW9uKCl7cmV0dXJuIFB0KFwiaXNBZnRlclwiLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApKX0sYy5ub3c9ZnVuY3Rpb24oKXtyZXR1cm4gRGF0ZS5ub3c/RGF0ZS5ub3coKTorbmV3IERhdGV9LGMudXRjPXksYy51bml4PWZ1bmN0aW9uKGUpe3JldHVybiBUdCgxZTMqZSl9LGMubW9udGhzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGZuKGUsdCxcIm1vbnRoc1wiKX0sYy5pc0RhdGU9aCxjLmxvY2FsZT1vdCxjLmludmFsaWQ9dixjLmR1cmF0aW9uPUF0LGMuaXNNb21lbnQ9UyxjLndlZWtkYXlzPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbW4oZSx0LG4sXCJ3ZWVrZGF5c1wiKX0sYy5wYXJzZVpvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gVHQuYXBwbHkobnVsbCxhcmd1bWVudHMpLnBhcnNlWm9uZSgpfSxjLmxvY2FsZURhdGE9bHQsYy5pc0R1cmF0aW9uPVJ0LGMubW9udGhzU2hvcnQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZm4oZSx0LFwibW9udGhzU2hvcnRcIil9LGMud2Vla2RheXNNaW49ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBtbihlLHQsbixcIndlZWtkYXlzTWluXCIpfSxjLmRlZmluZUxvY2FsZT11dCxjLnVwZGF0ZUxvY2FsZT1mdW5jdGlvbihlLHQpe2lmKG51bGwhPXQpe3ZhciBuLHMsaT1udDtudWxsIT0ocz1hdChlKSkmJihpPXMuX2NvbmZpZyksKG49bmV3IFAodD1iKGksdCkpKS5wYXJlbnRMb2NhbGU9c3RbZV0sc3RbZV09bixvdChlKX1lbHNlIG51bGwhPXN0W2VdJiYobnVsbCE9c3RbZV0ucGFyZW50TG9jYWxlP3N0W2VdPXN0W2VdLnBhcmVudExvY2FsZTpudWxsIT1zdFtlXSYmZGVsZXRlIHN0W2VdKTtyZXR1cm4gc3RbZV19LGMubG9jYWxlcz1mdW5jdGlvbigpe3JldHVybiBzKHN0KX0sYy53ZWVrZGF5c1Nob3J0PWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbW4oZSx0LG4sXCJ3ZWVrZGF5c1Nob3J0XCIpfSxjLm5vcm1hbGl6ZVVuaXRzPVIsYy5yZWxhdGl2ZVRpbWVSb3VuZGluZz1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZT9VbjpcImZ1bmN0aW9uXCI9PXR5cGVvZiBlJiYoVW49ZSwhMCl9LGMucmVsYXRpdmVUaW1lVGhyZXNob2xkPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMCE9PU5uW2VdJiYodm9pZCAwPT09dD9ObltlXTooTm5bZV09dCxcInNcIj09PWUmJihObi5zcz10LTEpLCEwKSl9LGMuY2FsZW5kYXJGb3JtYXQ9ZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmRpZmYodCxcImRheXNcIiwhMCk7cmV0dXJuIG48LTY/XCJzYW1lRWxzZVwiOm48LTE/XCJsYXN0V2Vla1wiOm48MD9cImxhc3REYXlcIjpuPDE/XCJzYW1lRGF5XCI6bjwyP1wibmV4dERheVwiOm48Nz9cIm5leHRXZWVrXCI6XCJzYW1lRWxzZVwifSxjLnByb3RvdHlwZT1sbixjLkhUTUw1X0ZNVD17REFURVRJTUVfTE9DQUw6XCJZWVlZLU1NLUREVEhIOm1tXCIsREFURVRJTUVfTE9DQUxfU0VDT05EUzpcIllZWVktTU0tRERUSEg6bW06c3NcIixEQVRFVElNRV9MT0NBTF9NUzpcIllZWVktTU0tRERUSEg6bW06c3MuU1NTXCIsREFURTpcIllZWVktTU0tRERcIixUSU1FOlwiSEg6bW1cIixUSU1FX1NFQ09ORFM6XCJISDptbTpzc1wiLFRJTUVfTVM6XCJISDptbTpzcy5TU1NcIixXRUVLOlwiWVlZWS1bV11XV1wiLE1PTlRIOlwiWVlZWS1NTVwifSxjfSk7IiwiIWZ1bmN0aW9uKG4pe2Z1bmN0aW9uIHQocil7aWYoZVtyXSlyZXR1cm4gZVtyXS5leHBvcnRzO3ZhciBvPWVbcl09e2k6cixsOiExLGV4cG9ydHM6e319O3JldHVybiBuW3JdLmNhbGwoby5leHBvcnRzLG8sby5leHBvcnRzLHQpLG8ubD0hMCxvLmV4cG9ydHN9dmFyIGU9e307dC5tPW4sdC5jPWUsdC5pPWZ1bmN0aW9uKG4pe3JldHVybiBufSx0LmQ9ZnVuY3Rpb24obixlLHIpe3QubyhuLGUpfHxPYmplY3QuZGVmaW5lUHJvcGVydHkobixlLHtjb25maWd1cmFibGU6ITEsZW51bWVyYWJsZTohMCxnZXQ6cn0pfSx0Lm49ZnVuY3Rpb24obil7dmFyIGU9biYmbi5fX2VzTW9kdWxlP2Z1bmN0aW9uKCl7cmV0dXJuIG4uZGVmYXVsdH06ZnVuY3Rpb24oKXtyZXR1cm4gbn07cmV0dXJuIHQuZChlLFwiYVwiLGUpLGV9LHQubz1mdW5jdGlvbihuLHQpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobix0KX0sdC5wPVwiXCIsdCh0LnM9NCl9KFtmdW5jdGlvbihuLHQsZSl7XCJ1c2Ugc3RyaWN0XCI7IWZ1bmN0aW9uKG4pe2Z1bmN0aW9uIHQobil7dmFyIHQ9bnx8XCJ0aGUtYWNjb3JkaW9uXCI7bnVsbCE9PShpPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjXCIrdCkpJiYoYT1pLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYWNjb3JkaW9uLXBhbmVsXCIpLGEubGVuZ3RoPjAmJmUoKSl9ZnVuY3Rpb24gZSgpe2Y9dSgpLGEuZm9yRWFjaChmdW5jdGlvbihuKXtuLnF1ZXJ5U2VsZWN0b3IoXCJhXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLHIpfSl9ZnVuY3Rpb24gcihuKXtuLnByZXZlbnREZWZhdWx0KCk7dmFyIHQ9bi5jdXJyZW50VGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtmIT09dCYmKGMoKSxvKHQpKX1mdW5jdGlvbiBvKG4pe24uY2xhc3NMaXN0LmFkZChsKSxmPW59ZnVuY3Rpb24gYygpe2lmKHZvaWQgMD09PWYpcmV0dXJuIHRoaXM7Zi5jbGFzc0xpc3QucmVtb3ZlKGwpfWZ1bmN0aW9uIHUoKXtmb3IodmFyIG49MDtuPGEubGVuZ3RoO24rKylpZihhW25dLmNsYXNzTGlzdC5jb250YWlucyhsKSlyZXR1cm4gYVtuXX12YXIgaT1udWxsLGw9XCJpcy1hY3RpdmVcIixhPW51bGwsZj1udWxsO24uQWNjb3JkaW9uSlM9dH0od2luZG93KX0sLCwsZnVuY3Rpb24obix0LGUpe24uZXhwb3J0cz1lKDApfV0pOyIsIi8qIVxuICogQ2hhcnQuanNcbiAqIGh0dHA6Ly9jaGFydGpzLm9yZy9cbiAqIFZlcnNpb246IDIuNy4zXG4gKlxuICogQ29weXJpZ2h0IDIwMTggQ2hhcnQuanMgQ29udHJpYnV0b3JzXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9jaGFydGpzL0NoYXJ0LmpzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWRcbiAqL1xuIWZ1bmN0aW9uKHQpe2lmKFwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlKW1vZHVsZS5leHBvcnRzPXQoKTtlbHNlIGlmKFwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoW10sdCk7ZWxzZXsoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGdsb2JhbD9nbG9iYWw6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHNlbGY/c2VsZjp0aGlzKS5DaGFydD10KCl9fShmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbiBvKHIscyxsKXtmdW5jdGlvbiB1KGUsdCl7aWYoIXNbZV0pe2lmKCFyW2VdKXt2YXIgaT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCF0JiZpKXJldHVybiBpKGUsITApO2lmKGQpcmV0dXJuIGQoZSwhMCk7dmFyIG49bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitlK1wiJ1wiKTt0aHJvdyBuLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsbn12YXIgYT1zW2VdPXtleHBvcnRzOnt9fTtyW2VdWzBdLmNhbGwoYS5leHBvcnRzLGZ1bmN0aW9uKHQpe3JldHVybiB1KHJbZV1bMV1bdF18fHQpfSxhLGEuZXhwb3J0cyxvLHIscyxsKX1yZXR1cm4gc1tlXS5leHBvcnRzfWZvcih2YXIgZD1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLHQ9MDt0PGwubGVuZ3RoO3QrKyl1KGxbdF0pO3JldHVybiB1fSh7MTpbZnVuY3Rpb24odCxlLGkpe30se31dLDI6W2Z1bmN0aW9uKHQsZSxpKXt2YXIgbz10KDYpO2Z1bmN0aW9uIG4odCl7aWYodCl7dmFyIGU9WzAsMCwwXSxpPTEsbj10Lm1hdGNoKC9eIyhbYS1mQS1GMC05XXszfSkkL2kpO2lmKG4pe249blsxXTtmb3IodmFyIGE9MDthPGUubGVuZ3RoO2ErKyllW2FdPXBhcnNlSW50KG5bYV0rblthXSwxNil9ZWxzZSBpZihuPXQubWF0Y2goL14jKFthLWZBLUYwLTldezZ9KSQvaSkpe249blsxXTtmb3IoYT0wO2E8ZS5sZW5ndGg7YSsrKWVbYV09cGFyc2VJbnQobi5zbGljZSgyKmEsMiphKzIpLDE2KX1lbHNlIGlmKG49dC5tYXRjaCgvXnJnYmE/XFwoXFxzKihbKy1dP1xcZCspXFxzKixcXHMqKFsrLV0/XFxkKylcXHMqLFxccyooWystXT9cXGQrKVxccyooPzosXFxzKihbKy1dP1tcXGRcXC5dKylcXHMqKT9cXCkkL2kpKXtmb3IoYT0wO2E8ZS5sZW5ndGg7YSsrKWVbYV09cGFyc2VJbnQoblthKzFdKTtpPXBhcnNlRmxvYXQobls0XSl9ZWxzZSBpZihuPXQubWF0Y2goL15yZ2JhP1xcKFxccyooWystXT9bXFxkXFwuXSspXFwlXFxzKixcXHMqKFsrLV0/W1xcZFxcLl0rKVxcJVxccyosXFxzKihbKy1dP1tcXGRcXC5dKylcXCVcXHMqKD86LFxccyooWystXT9bXFxkXFwuXSspXFxzKik/XFwpJC9pKSl7Zm9yKGE9MDthPGUubGVuZ3RoO2ErKyllW2FdPU1hdGgucm91bmQoMi41NSpwYXJzZUZsb2F0KG5bYSsxXSkpO2k9cGFyc2VGbG9hdChuWzRdKX1lbHNlIGlmKG49dC5tYXRjaCgvKFxcdyspLykpe2lmKFwidHJhbnNwYXJlbnRcIj09blsxXSlyZXR1cm5bMCwwLDAsMF07aWYoIShlPW9bblsxXV0pKXJldHVybn1mb3IoYT0wO2E8ZS5sZW5ndGg7YSsrKWVbYV09ZChlW2FdLDAsMjU1KTtyZXR1cm4gaT1pfHwwPT1pP2QoaSwwLDEpOjEsZVszXT1pLGV9fWZ1bmN0aW9uIGEodCl7aWYodCl7dmFyIGU9dC5tYXRjaCgvXmhzbGE/XFwoXFxzKihbKy1dP1xcZCspKD86ZGVnKT9cXHMqLFxccyooWystXT9bXFxkXFwuXSspJVxccyosXFxzKihbKy1dP1tcXGRcXC5dKyklXFxzKig/OixcXHMqKFsrLV0/W1xcZFxcLl0rKVxccyopP1xcKS8pO2lmKGUpe3ZhciBpPXBhcnNlRmxvYXQoZVs0XSk7cmV0dXJuW2QocGFyc2VJbnQoZVsxXSksMCwzNjApLGQocGFyc2VGbG9hdChlWzJdKSwwLDEwMCksZChwYXJzZUZsb2F0KGVbM10pLDAsMTAwKSxkKGlzTmFOKGkpPzE6aSwwLDEpXX19fWZ1bmN0aW9uIHIodCl7aWYodCl7dmFyIGU9dC5tYXRjaCgvXmh3YlxcKFxccyooWystXT9cXGQrKSg/OmRlZyk/XFxzKixcXHMqKFsrLV0/W1xcZFxcLl0rKSVcXHMqLFxccyooWystXT9bXFxkXFwuXSspJVxccyooPzosXFxzKihbKy1dP1tcXGRcXC5dKylcXHMqKT9cXCkvKTtpZihlKXt2YXIgaT1wYXJzZUZsb2F0KGVbNF0pO3JldHVybltkKHBhcnNlSW50KGVbMV0pLDAsMzYwKSxkKHBhcnNlRmxvYXQoZVsyXSksMCwxMDApLGQocGFyc2VGbG9hdChlWzNdKSwwLDEwMCksZChpc05hTihpKT8xOmksMCwxKV19fX1mdW5jdGlvbiBzKHQsZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPXZvaWQgMCE9PXRbM10/dFszXToxKSxcInJnYmEoXCIrdFswXStcIiwgXCIrdFsxXStcIiwgXCIrdFsyXStcIiwgXCIrZStcIilcIn1mdW5jdGlvbiBsKHQsZSl7cmV0dXJuXCJyZ2JhKFwiK01hdGgucm91bmQodFswXS8yNTUqMTAwKStcIiUsIFwiK01hdGgucm91bmQodFsxXS8yNTUqMTAwKStcIiUsIFwiK01hdGgucm91bmQodFsyXS8yNTUqMTAwKStcIiUsIFwiKyhlfHx0WzNdfHwxKStcIilcIn1mdW5jdGlvbiB1KHQsZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPXZvaWQgMCE9PXRbM10/dFszXToxKSxcImhzbGEoXCIrdFswXStcIiwgXCIrdFsxXStcIiUsIFwiK3RbMl0rXCIlLCBcIitlK1wiKVwifWZ1bmN0aW9uIGQodCxlLGkpe3JldHVybiBNYXRoLm1pbihNYXRoLm1heChlLHQpLGkpfWZ1bmN0aW9uIGModCl7dmFyIGU9dC50b1N0cmluZygxNikudG9VcHBlckNhc2UoKTtyZXR1cm4gZS5sZW5ndGg8Mj9cIjBcIitlOmV9ZS5leHBvcnRzPXtnZXRSZ2JhOm4sZ2V0SHNsYTphLGdldFJnYjpmdW5jdGlvbih0KXt2YXIgZT1uKHQpO3JldHVybiBlJiZlLnNsaWNlKDAsMyl9LGdldEhzbDpmdW5jdGlvbih0KXt2YXIgZT1hKHQpO3JldHVybiBlJiZlLnNsaWNlKDAsMyl9LGdldEh3YjpyLGdldEFscGhhOmZ1bmN0aW9uKHQpe3ZhciBlPW4odCk7e2lmKGUpcmV0dXJuIGVbM107aWYoZT1hKHQpKXJldHVybiBlWzNdO2lmKGU9cih0KSlyZXR1cm4gZVszXX19LGhleFN0cmluZzpmdW5jdGlvbih0KXtyZXR1cm5cIiNcIitjKHRbMF0pK2ModFsxXSkrYyh0WzJdKX0scmdiU3RyaW5nOmZ1bmN0aW9uKHQsZSl7aWYoZTwxfHx0WzNdJiZ0WzNdPDEpcmV0dXJuIHModCxlKTtyZXR1cm5cInJnYihcIit0WzBdK1wiLCBcIit0WzFdK1wiLCBcIit0WzJdK1wiKVwifSxyZ2JhU3RyaW5nOnMscGVyY2VudFN0cmluZzpmdW5jdGlvbih0LGUpe2lmKGU8MXx8dFszXSYmdFszXTwxKXJldHVybiBsKHQsZSk7dmFyIGk9TWF0aC5yb3VuZCh0WzBdLzI1NSoxMDApLG49TWF0aC5yb3VuZCh0WzFdLzI1NSoxMDApLGE9TWF0aC5yb3VuZCh0WzJdLzI1NSoxMDApO3JldHVyblwicmdiKFwiK2krXCIlLCBcIituK1wiJSwgXCIrYStcIiUpXCJ9LHBlcmNlbnRhU3RyaW5nOmwsaHNsU3RyaW5nOmZ1bmN0aW9uKHQsZSl7aWYoZTwxfHx0WzNdJiZ0WzNdPDEpcmV0dXJuIHUodCxlKTtyZXR1cm5cImhzbChcIit0WzBdK1wiLCBcIit0WzFdK1wiJSwgXCIrdFsyXStcIiUpXCJ9LGhzbGFTdHJpbmc6dSxod2JTdHJpbmc6ZnVuY3Rpb24odCxlKXt2b2lkIDA9PT1lJiYoZT12b2lkIDAhPT10WzNdP3RbM106MSk7cmV0dXJuXCJod2IoXCIrdFswXStcIiwgXCIrdFsxXStcIiUsIFwiK3RbMl0rXCIlXCIrKHZvaWQgMCE9PWUmJjEhPT1lP1wiLCBcIitlOlwiXCIpK1wiKVwifSxrZXl3b3JkOmZ1bmN0aW9uKHQpe3JldHVybiBoW3Quc2xpY2UoMCwzKV19fTt2YXIgaD17fTtmb3IodmFyIGYgaW4gbyloW29bZl1dPWZ9LHs2OjZ9XSwzOltmdW5jdGlvbih0LGUsaSl7dmFyIGQ9dCg1KSxuPXQoMikscj1mdW5jdGlvbih0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIHI/dDp0aGlzIGluc3RhbmNlb2Ygcj8odGhpcy52YWxpZD0hMSx0aGlzLnZhbHVlcz17cmdiOlswLDAsMF0saHNsOlswLDAsMF0saHN2OlswLDAsMF0saHdiOlswLDAsMF0sY215azpbMCwwLDAsMF0sYWxwaGE6MX0sdm9pZChcInN0cmluZ1wiPT10eXBlb2YgdD8oZT1uLmdldFJnYmEodCkpP3RoaXMuc2V0VmFsdWVzKFwicmdiXCIsZSk6KGU9bi5nZXRIc2xhKHQpKT90aGlzLnNldFZhbHVlcyhcImhzbFwiLGUpOihlPW4uZ2V0SHdiKHQpKSYmdGhpcy5zZXRWYWx1ZXMoXCJod2JcIixlKTpcIm9iamVjdFwiPT10eXBlb2YgdCYmKHZvaWQgMCE9PShlPXQpLnJ8fHZvaWQgMCE9PWUucmVkP3RoaXMuc2V0VmFsdWVzKFwicmdiXCIsZSk6dm9pZCAwIT09ZS5sfHx2b2lkIDAhPT1lLmxpZ2h0bmVzcz90aGlzLnNldFZhbHVlcyhcImhzbFwiLGUpOnZvaWQgMCE9PWUudnx8dm9pZCAwIT09ZS52YWx1ZT90aGlzLnNldFZhbHVlcyhcImhzdlwiLGUpOnZvaWQgMCE9PWUud3x8dm9pZCAwIT09ZS53aGl0ZW5lc3M/dGhpcy5zZXRWYWx1ZXMoXCJod2JcIixlKTp2b2lkIDA9PT1lLmMmJnZvaWQgMD09PWUuY3lhbnx8dGhpcy5zZXRWYWx1ZXMoXCJjbXlrXCIsZSkpKSk6bmV3IHIodCk7dmFyIGV9O3IucHJvdG90eXBlPXtpc1ZhbGlkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsaWR9LHJnYjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNldFNwYWNlKFwicmdiXCIsYXJndW1lbnRzKX0saHNsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0U3BhY2UoXCJoc2xcIixhcmd1bWVudHMpfSxoc3Y6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zZXRTcGFjZShcImhzdlwiLGFyZ3VtZW50cyl9LGh3YjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNldFNwYWNlKFwiaHdiXCIsYXJndW1lbnRzKX0sY215azpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNldFNwYWNlKFwiY215a1wiLGFyZ3VtZW50cyl9LHJnYkFycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWVzLnJnYn0saHNsQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52YWx1ZXMuaHNsfSxoc3ZBcnJheTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnZhbHVlcy5oc3Z9LGh3YkFycmF5OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy52YWx1ZXM7cmV0dXJuIDEhPT10LmFscGhhP3QuaHdiLmNvbmNhdChbdC5hbHBoYV0pOnQuaHdifSxjbXlrQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52YWx1ZXMuY215a30scmdiYUFycmF5OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy52YWx1ZXM7cmV0dXJuIHQucmdiLmNvbmNhdChbdC5hbHBoYV0pfSxoc2xhQXJyYXk6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnZhbHVlcztyZXR1cm4gdC5oc2wuY29uY2F0KFt0LmFscGhhXSl9LGFscGhhOmZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10P3RoaXMudmFsdWVzLmFscGhhOih0aGlzLnNldFZhbHVlcyhcImFscGhhXCIsdCksdGhpcyl9LHJlZDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zZXRDaGFubmVsKFwicmdiXCIsMCx0KX0sZ3JlZW46ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0Q2hhbm5lbChcInJnYlwiLDEsdCl9LGJsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0Q2hhbm5lbChcInJnYlwiLDIsdCl9LGh1ZTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmKHQ9KHQlPTM2MCk8MD8zNjArdDp0KSx0aGlzLnNldENoYW5uZWwoXCJoc2xcIiwwLHQpfSxzYXR1cmF0aW9uOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNldENoYW5uZWwoXCJoc2xcIiwxLHQpfSxsaWdodG5lc3M6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0Q2hhbm5lbChcImhzbFwiLDIsdCl9LHNhdHVyYXRpb252OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNldENoYW5uZWwoXCJoc3ZcIiwxLHQpfSx3aGl0ZW5lc3M6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0Q2hhbm5lbChcImh3YlwiLDEsdCl9LGJsYWNrbmVzczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zZXRDaGFubmVsKFwiaHdiXCIsMix0KX0sdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0Q2hhbm5lbChcImhzdlwiLDIsdCl9LGN5YW46ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0Q2hhbm5lbChcImNteWtcIiwwLHQpfSxtYWdlbnRhOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNldENoYW5uZWwoXCJjbXlrXCIsMSx0KX0seWVsbG93OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnNldENoYW5uZWwoXCJjbXlrXCIsMix0KX0sYmxhY2s6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc2V0Q2hhbm5lbChcImNteWtcIiwzLHQpfSxoZXhTdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gbi5oZXhTdHJpbmcodGhpcy52YWx1ZXMucmdiKX0scmdiU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuIG4ucmdiU3RyaW5nKHRoaXMudmFsdWVzLnJnYix0aGlzLnZhbHVlcy5hbHBoYSl9LHJnYmFTdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gbi5yZ2JhU3RyaW5nKHRoaXMudmFsdWVzLnJnYix0aGlzLnZhbHVlcy5hbHBoYSl9LHBlcmNlbnRTdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gbi5wZXJjZW50U3RyaW5nKHRoaXMudmFsdWVzLnJnYix0aGlzLnZhbHVlcy5hbHBoYSl9LGhzbFN0cmluZzpmdW5jdGlvbigpe3JldHVybiBuLmhzbFN0cmluZyh0aGlzLnZhbHVlcy5oc2wsdGhpcy52YWx1ZXMuYWxwaGEpfSxoc2xhU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuIG4uaHNsYVN0cmluZyh0aGlzLnZhbHVlcy5oc2wsdGhpcy52YWx1ZXMuYWxwaGEpfSxod2JTdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gbi5od2JTdHJpbmcodGhpcy52YWx1ZXMuaHdiLHRoaXMudmFsdWVzLmFscGhhKX0sa2V5d29yZDpmdW5jdGlvbigpe3JldHVybiBuLmtleXdvcmQodGhpcy52YWx1ZXMucmdiLHRoaXMudmFsdWVzLmFscGhhKX0scmdiTnVtYmVyOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy52YWx1ZXMucmdiO3JldHVybiB0WzBdPDwxNnx0WzFdPDw4fHRbMl19LGx1bWlub3NpdHk6ZnVuY3Rpb24oKXtmb3IodmFyIHQ9dGhpcy52YWx1ZXMucmdiLGU9W10saT0wO2k8dC5sZW5ndGg7aSsrKXt2YXIgbj10W2ldLzI1NTtlW2ldPW48PS4wMzkyOD9uLzEyLjkyOk1hdGgucG93KChuKy4wNTUpLzEuMDU1LDIuNCl9cmV0dXJuLjIxMjYqZVswXSsuNzE1MiplWzFdKy4wNzIyKmVbMl19LGNvbnRyYXN0OmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMubHVtaW5vc2l0eSgpLGk9dC5sdW1pbm9zaXR5KCk7cmV0dXJuIGk8ZT8oZSsuMDUpLyhpKy4wNSk6KGkrLjA1KS8oZSsuMDUpfSxsZXZlbDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmNvbnRyYXN0KHQpO3JldHVybiA3LjE8PWU/XCJBQUFcIjo0LjU8PWU/XCJBQVwiOlwiXCJ9LGRhcms6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnZhbHVlcy5yZ2I7cmV0dXJuKDI5OSp0WzBdKzU4Nyp0WzFdKzExNCp0WzJdKS8xZTM8MTI4fSxsaWdodDpmdW5jdGlvbigpe3JldHVybiF0aGlzLmRhcmsoKX0sbmVnYXRlOmZ1bmN0aW9uKCl7Zm9yKHZhciB0PVtdLGU9MDtlPDM7ZSsrKXRbZV09MjU1LXRoaXMudmFsdWVzLnJnYltlXTtyZXR1cm4gdGhpcy5zZXRWYWx1ZXMoXCJyZ2JcIix0KSx0aGlzfSxsaWdodGVuOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMudmFsdWVzLmhzbDtyZXR1cm4gZVsyXSs9ZVsyXSp0LHRoaXMuc2V0VmFsdWVzKFwiaHNsXCIsZSksdGhpc30sZGFya2VuOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMudmFsdWVzLmhzbDtyZXR1cm4gZVsyXS09ZVsyXSp0LHRoaXMuc2V0VmFsdWVzKFwiaHNsXCIsZSksdGhpc30sc2F0dXJhdGU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy52YWx1ZXMuaHNsO3JldHVybiBlWzFdKz1lWzFdKnQsdGhpcy5zZXRWYWx1ZXMoXCJoc2xcIixlKSx0aGlzfSxkZXNhdHVyYXRlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMudmFsdWVzLmhzbDtyZXR1cm4gZVsxXS09ZVsxXSp0LHRoaXMuc2V0VmFsdWVzKFwiaHNsXCIsZSksdGhpc30sd2hpdGVuOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMudmFsdWVzLmh3YjtyZXR1cm4gZVsxXSs9ZVsxXSp0LHRoaXMuc2V0VmFsdWVzKFwiaHdiXCIsZSksdGhpc30sYmxhY2tlbjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnZhbHVlcy5od2I7cmV0dXJuIGVbMl0rPWVbMl0qdCx0aGlzLnNldFZhbHVlcyhcImh3YlwiLGUpLHRoaXN9LGdyZXlzY2FsZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMudmFsdWVzLnJnYixlPS4zKnRbMF0rLjU5KnRbMV0rLjExKnRbMl07cmV0dXJuIHRoaXMuc2V0VmFsdWVzKFwicmdiXCIsW2UsZSxlXSksdGhpc30sY2xlYXJlcjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnZhbHVlcy5hbHBoYTtyZXR1cm4gdGhpcy5zZXRWYWx1ZXMoXCJhbHBoYVwiLGUtZSp0KSx0aGlzfSxvcGFxdWVyOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMudmFsdWVzLmFscGhhO3JldHVybiB0aGlzLnNldFZhbHVlcyhcImFscGhhXCIsZStlKnQpLHRoaXN9LHJvdGF0ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnZhbHVlcy5oc2wsaT0oZVswXSt0KSUzNjA7cmV0dXJuIGVbMF09aTwwPzM2MCtpOmksdGhpcy5zZXRWYWx1ZXMoXCJoc2xcIixlKSx0aGlzfSxtaXg6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLG49dCxhPXZvaWQgMD09PWU/LjU6ZSxvPTIqYS0xLHI9aS5hbHBoYSgpLW4uYWxwaGEoKSxzPSgobypyPT0tMT9vOihvK3IpLygxK28qcikpKzEpLzIsbD0xLXM7cmV0dXJuIHRoaXMucmdiKHMqaS5yZWQoKStsKm4ucmVkKCkscyppLmdyZWVuKCkrbCpuLmdyZWVuKCkscyppLmJsdWUoKStsKm4uYmx1ZSgpKS5hbHBoYShpLmFscGhhKCkqYStuLmFscGhhKCkqKDEtYSkpfSx0b0pTT046ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZ2IoKX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgdCxlLGk9bmV3IHIsbj10aGlzLnZhbHVlcyxhPWkudmFsdWVzO2Zvcih2YXIgbyBpbiBuKW4uaGFzT3duUHJvcGVydHkobykmJih0PW5bb10sXCJbb2JqZWN0IEFycmF5XVwiPT09KGU9e30udG9TdHJpbmcuY2FsbCh0KSk/YVtvXT10LnNsaWNlKDApOlwiW29iamVjdCBOdW1iZXJdXCI9PT1lP2Fbb109dDpjb25zb2xlLmVycm9yKFwidW5leHBlY3RlZCBjb2xvciB2YWx1ZTpcIix0KSk7cmV0dXJuIGl9fSxyLnByb3RvdHlwZS5zcGFjZXM9e3JnYjpbXCJyZWRcIixcImdyZWVuXCIsXCJibHVlXCJdLGhzbDpbXCJodWVcIixcInNhdHVyYXRpb25cIixcImxpZ2h0bmVzc1wiXSxoc3Y6W1wiaHVlXCIsXCJzYXR1cmF0aW9uXCIsXCJ2YWx1ZVwiXSxod2I6W1wiaHVlXCIsXCJ3aGl0ZW5lc3NcIixcImJsYWNrbmVzc1wiXSxjbXlrOltcImN5YW5cIixcIm1hZ2VudGFcIixcInllbGxvd1wiLFwiYmxhY2tcIl19LHIucHJvdG90eXBlLm1heGVzPXtyZ2I6WzI1NSwyNTUsMjU1XSxoc2w6WzM2MCwxMDAsMTAwXSxoc3Y6WzM2MCwxMDAsMTAwXSxod2I6WzM2MCwxMDAsMTAwXSxjbXlrOlsxMDAsMTAwLDEwMCwxMDBdfSxyLnByb3RvdHlwZS5nZXRWYWx1ZXM9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXRoaXMudmFsdWVzLGk9e30sbj0wO248dC5sZW5ndGg7bisrKWlbdC5jaGFyQXQobildPWVbdF1bbl07cmV0dXJuIDEhPT1lLmFscGhhJiYoaS5hPWUuYWxwaGEpLGl9LHIucHJvdG90eXBlLnNldFZhbHVlcz1mdW5jdGlvbih0LGUpe3ZhciBpLG4sYT10aGlzLnZhbHVlcyxvPXRoaXMuc3BhY2VzLHI9dGhpcy5tYXhlcyxzPTE7aWYodGhpcy52YWxpZD0hMCxcImFscGhhXCI9PT10KXM9ZTtlbHNlIGlmKGUubGVuZ3RoKWFbdF09ZS5zbGljZSgwLHQubGVuZ3RoKSxzPWVbdC5sZW5ndGhdO2Vsc2UgaWYodm9pZCAwIT09ZVt0LmNoYXJBdCgwKV0pe2ZvcihpPTA7aTx0Lmxlbmd0aDtpKyspYVt0XVtpXT1lW3QuY2hhckF0KGkpXTtzPWUuYX1lbHNlIGlmKHZvaWQgMCE9PWVbb1t0XVswXV0pe3ZhciBsPW9bdF07Zm9yKGk9MDtpPHQubGVuZ3RoO2krKylhW3RdW2ldPWVbbFtpXV07cz1lLmFscGhhfWlmKGEuYWxwaGE9TWF0aC5tYXgoMCxNYXRoLm1pbigxLHZvaWQgMD09PXM/YS5hbHBoYTpzKSksXCJhbHBoYVwiPT09dClyZXR1cm4hMTtmb3IoaT0wO2k8dC5sZW5ndGg7aSsrKW49TWF0aC5tYXgoMCxNYXRoLm1pbihyW3RdW2ldLGFbdF1baV0pKSxhW3RdW2ldPU1hdGgucm91bmQobik7Zm9yKHZhciB1IGluIG8pdSE9PXQmJihhW3VdPWRbdF1bdV0oYVt0XSkpO3JldHVybiEwfSxyLnByb3RvdHlwZS5zZXRTcGFjZT1mdW5jdGlvbih0LGUpe3ZhciBpPWVbMF07cmV0dXJuIHZvaWQgMD09PWk/dGhpcy5nZXRWYWx1ZXModCk6KFwibnVtYmVyXCI9PXR5cGVvZiBpJiYoaT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChlKSksdGhpcy5zZXRWYWx1ZXModCxpKSx0aGlzKX0sci5wcm90b3R5cGUuc2V0Q2hhbm5lbD1mdW5jdGlvbih0LGUsaSl7dmFyIG49dGhpcy52YWx1ZXNbdF07cmV0dXJuIHZvaWQgMD09PWk/bltlXTooaT09PW5bZV18fChuW2VdPWksdGhpcy5zZXRWYWx1ZXModCxuKSksdGhpcyl9LFwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJih3aW5kb3cuQ29sb3I9ciksZS5leHBvcnRzPXJ9LHsyOjIsNTo1fV0sNDpbZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIGEodCl7dmFyIGUsaSxuPXRbMF0vMjU1LGE9dFsxXS8yNTUsbz10WzJdLzI1NSxyPU1hdGgubWluKG4sYSxvKSxzPU1hdGgubWF4KG4sYSxvKSxsPXMtcjtyZXR1cm4gcz09cj9lPTA6bj09cz9lPShhLW8pL2w6YT09cz9lPTIrKG8tbikvbDpvPT1zJiYoZT00KyhuLWEpL2wpLChlPU1hdGgubWluKDYwKmUsMzYwKSk8MCYmKGUrPTM2MCksaT0ocitzKS8yLFtlLDEwMCoocz09cj8wOmk8PS41P2wvKHMrcik6bC8oMi1zLXIpKSwxMDAqaV19ZnVuY3Rpb24gbih0KXt2YXIgZSxpLG49dFswXSxhPXRbMV0sbz10WzJdLHI9TWF0aC5taW4obixhLG8pLHM9TWF0aC5tYXgobixhLG8pLGw9cy1yO3JldHVybiBpPTA9PXM/MDpsL3MqMWUzLzEwLHM9PXI/ZT0wOm49PXM/ZT0oYS1vKS9sOmE9PXM/ZT0yKyhvLW4pL2w6bz09cyYmKGU9NCsobi1hKS9sKSwoZT1NYXRoLm1pbig2MCplLDM2MCkpPDAmJihlKz0zNjApLFtlLGkscy8yNTUqMWUzLzEwXX1mdW5jdGlvbiBvKHQpe3ZhciBlPXRbMF0saT10WzFdLG49dFsyXTtyZXR1cm5bYSh0KVswXSwxMDAqKDEvMjU1Kk1hdGgubWluKGUsTWF0aC5taW4oaSxuKSkpLDEwMCoobj0xLTEvMjU1Kk1hdGgubWF4KGUsTWF0aC5tYXgoaSxuKSkpXX1mdW5jdGlvbiBzKHQpe3ZhciBlLGk9dFswXS8yNTUsbj10WzFdLzI1NSxhPXRbMl0vMjU1O3JldHVyblsxMDAqKCgxLWktKGU9TWF0aC5taW4oMS1pLDEtbiwxLWEpKSkvKDEtZSl8fDApLDEwMCooKDEtbi1lKS8oMS1lKXx8MCksMTAwKigoMS1hLWUpLygxLWUpfHwwKSwxMDAqZV19ZnVuY3Rpb24gbCh0KXtyZXR1cm4gU1tKU09OLnN0cmluZ2lmeSh0KV19ZnVuY3Rpb24gdSh0KXt2YXIgZT10WzBdLzI1NSxpPXRbMV0vMjU1LG49dFsyXS8yNTU7cmV0dXJuWzEwMCooLjQxMjQqKGU9LjA0MDQ1PGU/TWF0aC5wb3coKGUrLjA1NSkvMS4wNTUsMi40KTplLzEyLjkyKSsuMzU3NiooaT0uMDQwNDU8aT9NYXRoLnBvdygoaSsuMDU1KS8xLjA1NSwyLjQpOmkvMTIuOTIpKy4xODA1KihuPS4wNDA0NTxuP01hdGgucG93KChuKy4wNTUpLzEuMDU1LDIuNCk6bi8xMi45MikpLDEwMCooLjIxMjYqZSsuNzE1MippKy4wNzIyKm4pLDEwMCooLjAxOTMqZSsuMTE5MippKy45NTA1Km4pXX1mdW5jdGlvbiBkKHQpe3ZhciBlPXUodCksaT1lWzBdLG49ZVsxXSxhPWVbMl07cmV0dXJuIG4vPTEwMCxhLz0xMDguODgzLGk9LjAwODg1NjwoaS89OTUuMDQ3KT9NYXRoLnBvdyhpLDEvMyk6Ny43ODcqaSsxNi8xMTYsWzExNioobj0uMDA4ODU2PG4/TWF0aC5wb3cobiwxLzMpOjcuNzg3Km4rMTYvMTE2KS0xNiw1MDAqKGktbiksMjAwKihuLShhPS4wMDg4NTY8YT9NYXRoLnBvdyhhLDEvMyk6Ny43ODcqYSsxNi8xMTYpKV19ZnVuY3Rpb24gYyh0KXt2YXIgZSxpLG4sYSxvLHI9dFswXS8zNjAscz10WzFdLzEwMCxsPXRbMl0vMTAwO2lmKDA9PXMpcmV0dXJuW289MjU1KmwsbyxvXTtlPTIqbC0oaT1sPC41P2wqKDErcyk6bCtzLWwqcyksYT1bMCwwLDBdO2Zvcih2YXIgdT0wO3U8Mzt1KyspKG49cisxLzMqLSh1LTEpKTwwJiZuKyssMTxuJiZuLS0sbz02Km48MT9lKzYqKGktZSkqbjoyKm48MT9pOjMqbjwyP2UrKGktZSkqKDIvMy1uKSo2OmUsYVt1XT0yNTUqbztyZXR1cm4gYX1mdW5jdGlvbiBoKHQpe3ZhciBlPXRbMF0vNjAsaT10WzFdLzEwMCxuPXRbMl0vMTAwLGE9TWF0aC5mbG9vcihlKSU2LG89ZS1NYXRoLmZsb29yKGUpLHI9MjU1Km4qKDEtaSkscz0yNTUqbiooMS1pKm8pLGw9MjU1Km4qKDEtaSooMS1vKSk7bio9MjU1O3N3aXRjaChhKXtjYXNlIDA6cmV0dXJuW24sbCxyXTtjYXNlIDE6cmV0dXJuW3MsbixyXTtjYXNlIDI6cmV0dXJuW3IsbixsXTtjYXNlIDM6cmV0dXJuW3IscyxuXTtjYXNlIDQ6cmV0dXJuW2wscixuXTtjYXNlIDU6cmV0dXJuW24scixzXX19ZnVuY3Rpb24gZih0KXt2YXIgZSxpLG4sYSxvPXRbMF0vMzYwLHM9dFsxXS8xMDAsbD10WzJdLzEwMCx1PXMrbDtzd2l0Y2goMTx1JiYocy89dSxsLz11KSxuPTYqby0oZT1NYXRoLmZsb29yKDYqbykpLDAhPSgxJmUpJiYobj0xLW4pLGE9cytuKigoaT0xLWwpLXMpLGUpe2RlZmF1bHQ6Y2FzZSA2OmNhc2UgMDpyPWksZz1hLGI9czticmVhaztjYXNlIDE6cj1hLGc9aSxiPXM7YnJlYWs7Y2FzZSAyOnI9cyxnPWksYj1hO2JyZWFrO2Nhc2UgMzpyPXMsZz1hLGI9aTticmVhaztjYXNlIDQ6cj1hLGc9cyxiPWk7YnJlYWs7Y2FzZSA1OnI9aSxnPXMsYj1hfXJldHVyblsyNTUqciwyNTUqZywyNTUqYl19ZnVuY3Rpb24gcCh0KXt2YXIgZT10WzBdLzEwMCxpPXRbMV0vMTAwLG49dFsyXS8xMDAsYT10WzNdLzEwMDtyZXR1cm5bMjU1KigxLU1hdGgubWluKDEsZSooMS1hKSthKSksMjU1KigxLU1hdGgubWluKDEsaSooMS1hKSthKSksMjU1KigxLU1hdGgubWluKDEsbiooMS1hKSthKSldfWZ1bmN0aW9uIG0odCl7dmFyIGUsaSxuLGE9dFswXS8xMDAsbz10WzFdLzEwMCxyPXRbMl0vMTAwO3JldHVybiBpPS0uOTY4OSphKzEuODc1OCpvKy4wNDE1KnIsbj0uMDU1NyphKy0uMjA0Km8rMS4wNTcqcixlPS4wMDMxMzA4PChlPTMuMjQwNiphKy0xLjUzNzIqbystLjQ5ODYqcik/MS4wNTUqTWF0aC5wb3coZSwxLzIuNCktLjA1NTplKj0xMi45MixpPS4wMDMxMzA4PGk/MS4wNTUqTWF0aC5wb3coaSwxLzIuNCktLjA1NTppKj0xMi45MixuPS4wMDMxMzA4PG4/MS4wNTUqTWF0aC5wb3cobiwxLzIuNCktLjA1NTpuKj0xMi45MixbMjU1KihlPU1hdGgubWluKE1hdGgubWF4KDAsZSksMSkpLDI1NSooaT1NYXRoLm1pbihNYXRoLm1heCgwLGkpLDEpKSwyNTUqKG49TWF0aC5taW4oTWF0aC5tYXgoMCxuKSwxKSldfWZ1bmN0aW9uIHYodCl7dmFyIGU9dFswXSxpPXRbMV0sbj10WzJdO3JldHVybiBpLz0xMDAsbi89MTA4Ljg4MyxlPS4wMDg4NTY8KGUvPTk1LjA0Nyk/TWF0aC5wb3coZSwxLzMpOjcuNzg3KmUrMTYvMTE2LFsxMTYqKGk9LjAwODg1NjxpP01hdGgucG93KGksMS8zKTo3Ljc4NyppKzE2LzExNiktMTYsNTAwKihlLWkpLDIwMCooaS0obj0uMDA4ODU2PG4/TWF0aC5wb3cobiwxLzMpOjcuNzg3Km4rMTYvMTE2KSldfWZ1bmN0aW9uIHgodCl7dmFyIGUsaSxuLGEsbz10WzBdLHI9dFsxXSxzPXRbMl07cmV0dXJuIGE9bzw9OD8oaT0xMDAqby85MDMuMykvMTAwKjcuNzg3KzE2LzExNjooaT0xMDAqTWF0aC5wb3coKG8rMTYpLzExNiwzKSxNYXRoLnBvdyhpLzEwMCwxLzMpKSxbZT1lLzk1LjA0Nzw9LjAwODg1Nj9lPTk1LjA0Nyooci81MDArYS0xNi8xMTYpLzcuNzg3Ojk1LjA0NypNYXRoLnBvdyhyLzUwMCthLDMpLGksbj1uLzEwOC44ODM8PS4wMDg4NTk/bj0xMDguODgzKihhLXMvMjAwLTE2LzExNikvNy43ODc6MTA4Ljg4MypNYXRoLnBvdyhhLXMvMjAwLDMpXX1mdW5jdGlvbiB5KHQpe3ZhciBlLGk9dFswXSxuPXRbMV0sYT10WzJdO3JldHVybihlPTM2MCpNYXRoLmF0YW4yKGEsbikvMi9NYXRoLlBJKTwwJiYoZSs9MzYwKSxbaSxNYXRoLnNxcnQobipuK2EqYSksZV19ZnVuY3Rpb24gayh0KXtyZXR1cm4gbSh4KHQpKX1mdW5jdGlvbiBNKHQpe3ZhciBlLGk9dFswXSxuPXRbMV07cmV0dXJuIGU9dFsyXS8zNjAqMipNYXRoLlBJLFtpLG4qTWF0aC5jb3MoZSksbipNYXRoLnNpbihlKV19ZnVuY3Rpb24gdyh0KXtyZXR1cm4gQ1t0XX1lLmV4cG9ydHM9e3JnYjJoc2w6YSxyZ2IyaHN2Om4scmdiMmh3YjpvLHJnYjJjbXlrOnMscmdiMmtleXdvcmQ6bCxyZ2IyeHl6OnUscmdiMmxhYjpkLHJnYjJsY2g6ZnVuY3Rpb24odCl7cmV0dXJuIHkoZCh0KSl9LGhzbDJyZ2I6Yyxoc2wyaHN2OmZ1bmN0aW9uKHQpe3ZhciBlPXRbMF0saT10WzFdLzEwMCxuPXRbMl0vMTAwO3JldHVybiAwIT09bj9bZSwxMDAqKDIqKGkqPShuKj0yKTw9MT9uOjItbikvKG4raSkpLDEwMCooKG4raSkvMildOlswLDAsMF19LGhzbDJod2I6ZnVuY3Rpb24odCl7cmV0dXJuIG8oYyh0KSl9LGhzbDJjbXlrOmZ1bmN0aW9uKHQpe3JldHVybiBzKGModCkpfSxoc2wya2V5d29yZDpmdW5jdGlvbih0KXtyZXR1cm4gbChjKHQpKX0saHN2MnJnYjpoLGhzdjJoc2w6ZnVuY3Rpb24odCl7dmFyIGUsaSxuPXRbMF0sYT10WzFdLzEwMCxvPXRbMl0vMTAwO3JldHVybiBlPWEqbyxbbiwxMDAqKGU9KGUvPShpPSgyLWEpKm8pPD0xP2k6Mi1pKXx8MCksMTAwKihpLz0yKV19LGhzdjJod2I6ZnVuY3Rpb24odCl7cmV0dXJuIG8oaCh0KSl9LGhzdjJjbXlrOmZ1bmN0aW9uKHQpe3JldHVybiBzKGgodCkpfSxoc3Yya2V5d29yZDpmdW5jdGlvbih0KXtyZXR1cm4gbChoKHQpKX0saHdiMnJnYjpmLGh3YjJoc2w6ZnVuY3Rpb24odCl7cmV0dXJuIGEoZih0KSl9LGh3YjJoc3Y6ZnVuY3Rpb24odCl7cmV0dXJuIG4oZih0KSl9LGh3YjJjbXlrOmZ1bmN0aW9uKHQpe3JldHVybiBzKGYodCkpfSxod2Iya2V5d29yZDpmdW5jdGlvbih0KXtyZXR1cm4gbChmKHQpKX0sY215azJyZ2I6cCxjbXlrMmhzbDpmdW5jdGlvbih0KXtyZXR1cm4gYShwKHQpKX0sY215azJoc3Y6ZnVuY3Rpb24odCl7cmV0dXJuIG4ocCh0KSl9LGNteWsyaHdiOmZ1bmN0aW9uKHQpe3JldHVybiBvKHAodCkpfSxjbXlrMmtleXdvcmQ6ZnVuY3Rpb24odCl7cmV0dXJuIGwocCh0KSl9LGtleXdvcmQycmdiOncsa2V5d29yZDJoc2w6ZnVuY3Rpb24odCl7cmV0dXJuIGEodyh0KSl9LGtleXdvcmQyaHN2OmZ1bmN0aW9uKHQpe3JldHVybiBuKHcodCkpfSxrZXl3b3JkMmh3YjpmdW5jdGlvbih0KXtyZXR1cm4gbyh3KHQpKX0sa2V5d29yZDJjbXlrOmZ1bmN0aW9uKHQpe3JldHVybiBzKHcodCkpfSxrZXl3b3JkMmxhYjpmdW5jdGlvbih0KXtyZXR1cm4gZCh3KHQpKX0sa2V5d29yZDJ4eXo6ZnVuY3Rpb24odCl7cmV0dXJuIHUodyh0KSl9LHh5ejJyZ2I6bSx4eXoybGFiOnYseHl6MmxjaDpmdW5jdGlvbih0KXtyZXR1cm4geSh2KHQpKX0sbGFiMnh5ejp4LGxhYjJyZ2I6ayxsYWIybGNoOnksbGNoMmxhYjpNLGxjaDJ4eXo6ZnVuY3Rpb24odCl7cmV0dXJuIHgoTSh0KSl9LGxjaDJyZ2I6ZnVuY3Rpb24odCl7cmV0dXJuIGsoTSh0KSl9fTt2YXIgQz17YWxpY2VibHVlOlsyNDAsMjQ4LDI1NV0sYW50aXF1ZXdoaXRlOlsyNTAsMjM1LDIxNV0sYXF1YTpbMCwyNTUsMjU1XSxhcXVhbWFyaW5lOlsxMjcsMjU1LDIxMl0sYXp1cmU6WzI0MCwyNTUsMjU1XSxiZWlnZTpbMjQ1LDI0NSwyMjBdLGJpc3F1ZTpbMjU1LDIyOCwxOTZdLGJsYWNrOlswLDAsMF0sYmxhbmNoZWRhbG1vbmQ6WzI1NSwyMzUsMjA1XSxibHVlOlswLDAsMjU1XSxibHVldmlvbGV0OlsxMzgsNDMsMjI2XSxicm93bjpbMTY1LDQyLDQyXSxidXJseXdvb2Q6WzIyMiwxODQsMTM1XSxjYWRldGJsdWU6Wzk1LDE1OCwxNjBdLGNoYXJ0cmV1c2U6WzEyNywyNTUsMF0sY2hvY29sYXRlOlsyMTAsMTA1LDMwXSxjb3JhbDpbMjU1LDEyNyw4MF0sY29ybmZsb3dlcmJsdWU6WzEwMCwxNDksMjM3XSxjb3Juc2lsazpbMjU1LDI0OCwyMjBdLGNyaW1zb246WzIyMCwyMCw2MF0sY3lhbjpbMCwyNTUsMjU1XSxkYXJrYmx1ZTpbMCwwLDEzOV0sZGFya2N5YW46WzAsMTM5LDEzOV0sZGFya2dvbGRlbnJvZDpbMTg0LDEzNCwxMV0sZGFya2dyYXk6WzE2OSwxNjksMTY5XSxkYXJrZ3JlZW46WzAsMTAwLDBdLGRhcmtncmV5OlsxNjksMTY5LDE2OV0sZGFya2toYWtpOlsxODksMTgzLDEwN10sZGFya21hZ2VudGE6WzEzOSwwLDEzOV0sZGFya29saXZlZ3JlZW46Wzg1LDEwNyw0N10sZGFya29yYW5nZTpbMjU1LDE0MCwwXSxkYXJrb3JjaGlkOlsxNTMsNTAsMjA0XSxkYXJrcmVkOlsxMzksMCwwXSxkYXJrc2FsbW9uOlsyMzMsMTUwLDEyMl0sZGFya3NlYWdyZWVuOlsxNDMsMTg4LDE0M10sZGFya3NsYXRlYmx1ZTpbNzIsNjEsMTM5XSxkYXJrc2xhdGVncmF5Ols0Nyw3OSw3OV0sZGFya3NsYXRlZ3JleTpbNDcsNzksNzldLGRhcmt0dXJxdW9pc2U6WzAsMjA2LDIwOV0sZGFya3Zpb2xldDpbMTQ4LDAsMjExXSxkZWVwcGluazpbMjU1LDIwLDE0N10sZGVlcHNreWJsdWU6WzAsMTkxLDI1NV0sZGltZ3JheTpbMTA1LDEwNSwxMDVdLGRpbWdyZXk6WzEwNSwxMDUsMTA1XSxkb2RnZXJibHVlOlszMCwxNDQsMjU1XSxmaXJlYnJpY2s6WzE3OCwzNCwzNF0sZmxvcmFsd2hpdGU6WzI1NSwyNTAsMjQwXSxmb3Jlc3RncmVlbjpbMzQsMTM5LDM0XSxmdWNoc2lhOlsyNTUsMCwyNTVdLGdhaW5zYm9ybzpbMjIwLDIyMCwyMjBdLGdob3N0d2hpdGU6WzI0OCwyNDgsMjU1XSxnb2xkOlsyNTUsMjE1LDBdLGdvbGRlbnJvZDpbMjE4LDE2NSwzMl0sZ3JheTpbMTI4LDEyOCwxMjhdLGdyZWVuOlswLDEyOCwwXSxncmVlbnllbGxvdzpbMTczLDI1NSw0N10sZ3JleTpbMTI4LDEyOCwxMjhdLGhvbmV5ZGV3OlsyNDAsMjU1LDI0MF0saG90cGluazpbMjU1LDEwNSwxODBdLGluZGlhbnJlZDpbMjA1LDkyLDkyXSxpbmRpZ286Wzc1LDAsMTMwXSxpdm9yeTpbMjU1LDI1NSwyNDBdLGtoYWtpOlsyNDAsMjMwLDE0MF0sbGF2ZW5kZXI6WzIzMCwyMzAsMjUwXSxsYXZlbmRlcmJsdXNoOlsyNTUsMjQwLDI0NV0sbGF3bmdyZWVuOlsxMjQsMjUyLDBdLGxlbW9uY2hpZmZvbjpbMjU1LDI1MCwyMDVdLGxpZ2h0Ymx1ZTpbMTczLDIxNiwyMzBdLGxpZ2h0Y29yYWw6WzI0MCwxMjgsMTI4XSxsaWdodGN5YW46WzIyNCwyNTUsMjU1XSxsaWdodGdvbGRlbnJvZHllbGxvdzpbMjUwLDI1MCwyMTBdLGxpZ2h0Z3JheTpbMjExLDIxMSwyMTFdLGxpZ2h0Z3JlZW46WzE0NCwyMzgsMTQ0XSxsaWdodGdyZXk6WzIxMSwyMTEsMjExXSxsaWdodHBpbms6WzI1NSwxODIsMTkzXSxsaWdodHNhbG1vbjpbMjU1LDE2MCwxMjJdLGxpZ2h0c2VhZ3JlZW46WzMyLDE3OCwxNzBdLGxpZ2h0c2t5Ymx1ZTpbMTM1LDIwNiwyNTBdLGxpZ2h0c2xhdGVncmF5OlsxMTksMTM2LDE1M10sbGlnaHRzbGF0ZWdyZXk6WzExOSwxMzYsMTUzXSxsaWdodHN0ZWVsYmx1ZTpbMTc2LDE5NiwyMjJdLGxpZ2h0eWVsbG93OlsyNTUsMjU1LDIyNF0sbGltZTpbMCwyNTUsMF0sbGltZWdyZWVuOls1MCwyMDUsNTBdLGxpbmVuOlsyNTAsMjQwLDIzMF0sbWFnZW50YTpbMjU1LDAsMjU1XSxtYXJvb246WzEyOCwwLDBdLG1lZGl1bWFxdWFtYXJpbmU6WzEwMiwyMDUsMTcwXSxtZWRpdW1ibHVlOlswLDAsMjA1XSxtZWRpdW1vcmNoaWQ6WzE4Niw4NSwyMTFdLG1lZGl1bXB1cnBsZTpbMTQ3LDExMiwyMTldLG1lZGl1bXNlYWdyZWVuOls2MCwxNzksMTEzXSxtZWRpdW1zbGF0ZWJsdWU6WzEyMywxMDQsMjM4XSxtZWRpdW1zcHJpbmdncmVlbjpbMCwyNTAsMTU0XSxtZWRpdW10dXJxdW9pc2U6WzcyLDIwOSwyMDRdLG1lZGl1bXZpb2xldHJlZDpbMTk5LDIxLDEzM10sbWlkbmlnaHRibHVlOlsyNSwyNSwxMTJdLG1pbnRjcmVhbTpbMjQ1LDI1NSwyNTBdLG1pc3R5cm9zZTpbMjU1LDIyOCwyMjVdLG1vY2Nhc2luOlsyNTUsMjI4LDE4MV0sbmF2YWpvd2hpdGU6WzI1NSwyMjIsMTczXSxuYXZ5OlswLDAsMTI4XSxvbGRsYWNlOlsyNTMsMjQ1LDIzMF0sb2xpdmU6WzEyOCwxMjgsMF0sb2xpdmVkcmFiOlsxMDcsMTQyLDM1XSxvcmFuZ2U6WzI1NSwxNjUsMF0sb3JhbmdlcmVkOlsyNTUsNjksMF0sb3JjaGlkOlsyMTgsMTEyLDIxNF0scGFsZWdvbGRlbnJvZDpbMjM4LDIzMiwxNzBdLHBhbGVncmVlbjpbMTUyLDI1MSwxNTJdLHBhbGV0dXJxdW9pc2U6WzE3NSwyMzgsMjM4XSxwYWxldmlvbGV0cmVkOlsyMTksMTEyLDE0N10scGFwYXlhd2hpcDpbMjU1LDIzOSwyMTNdLHBlYWNocHVmZjpbMjU1LDIxOCwxODVdLHBlcnU6WzIwNSwxMzMsNjNdLHBpbms6WzI1NSwxOTIsMjAzXSxwbHVtOlsyMjEsMTYwLDIyMV0scG93ZGVyYmx1ZTpbMTc2LDIyNCwyMzBdLHB1cnBsZTpbMTI4LDAsMTI4XSxyZWJlY2NhcHVycGxlOlsxMDIsNTEsMTUzXSxyZWQ6WzI1NSwwLDBdLHJvc3licm93bjpbMTg4LDE0MywxNDNdLHJveWFsYmx1ZTpbNjUsMTA1LDIyNV0sc2FkZGxlYnJvd246WzEzOSw2OSwxOV0sc2FsbW9uOlsyNTAsMTI4LDExNF0sc2FuZHlicm93bjpbMjQ0LDE2NCw5Nl0sc2VhZ3JlZW46WzQ2LDEzOSw4N10sc2Vhc2hlbGw6WzI1NSwyNDUsMjM4XSxzaWVubmE6WzE2MCw4Miw0NV0sc2lsdmVyOlsxOTIsMTkyLDE5Ml0sc2t5Ymx1ZTpbMTM1LDIwNiwyMzVdLHNsYXRlYmx1ZTpbMTA2LDkwLDIwNV0sc2xhdGVncmF5OlsxMTIsMTI4LDE0NF0sc2xhdGVncmV5OlsxMTIsMTI4LDE0NF0sc25vdzpbMjU1LDI1MCwyNTBdLHNwcmluZ2dyZWVuOlswLDI1NSwxMjddLHN0ZWVsYmx1ZTpbNzAsMTMwLDE4MF0sdGFuOlsyMTAsMTgwLDE0MF0sdGVhbDpbMCwxMjgsMTI4XSx0aGlzdGxlOlsyMTYsMTkxLDIxNl0sdG9tYXRvOlsyNTUsOTksNzFdLHR1cnF1b2lzZTpbNjQsMjI0LDIwOF0sdmlvbGV0OlsyMzgsMTMwLDIzOF0sd2hlYXQ6WzI0NSwyMjIsMTc5XSx3aGl0ZTpbMjU1LDI1NSwyNTVdLHdoaXRlc21va2U6WzI0NSwyNDUsMjQ1XSx5ZWxsb3c6WzI1NSwyNTUsMF0seWVsbG93Z3JlZW46WzE1NCwyMDUsNTBdfSxTPXt9O2Zvcih2YXIgXyBpbiBDKVNbSlNPTi5zdHJpbmdpZnkoQ1tfXSldPV99LHt9XSw1OltmdW5jdGlvbih0LGUsaSl7dmFyIGE9dCg0KSxvPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB1fTtmb3IodmFyIG4gaW4gYSl7b1tuK1wiUmF3XCJdPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm5cIm51bWJlclwiPT10eXBlb2YgdCYmKHQ9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKSksYVtlXSh0KX19KG4pO3ZhciByPS8oXFx3KykyKFxcdyspLy5leGVjKG4pLHM9clsxXSxsPXJbMl07KG9bc109b1tzXXx8e30pW2xdPW9bbl09ZnVuY3Rpb24obil7cmV0dXJuIGZ1bmN0aW9uKHQpe1wibnVtYmVyXCI9PXR5cGVvZiB0JiYodD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpKTt2YXIgZT1hW25dKHQpO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBlfHx2b2lkIDA9PT1lKXJldHVybiBlO2Zvcih2YXIgaT0wO2k8ZS5sZW5ndGg7aSsrKWVbaV09TWF0aC5yb3VuZChlW2ldKTtyZXR1cm4gZX19KG4pfXZhciB1PWZ1bmN0aW9uKCl7dGhpcy5jb252cz17fX07dS5wcm90b3R5cGUucm91dGVTcGFjZT1mdW5jdGlvbih0LGUpe3ZhciBpPWVbMF07cmV0dXJuIHZvaWQgMD09PWk/dGhpcy5nZXRWYWx1ZXModCk6KFwibnVtYmVyXCI9PXR5cGVvZiBpJiYoaT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChlKSksdGhpcy5zZXRWYWx1ZXModCxpKSl9LHUucHJvdG90eXBlLnNldFZhbHVlcz1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnNwYWNlPXQsdGhpcy5jb252cz17fSx0aGlzLmNvbnZzW3RdPWUsdGhpc30sdS5wcm90b3R5cGUuZ2V0VmFsdWVzPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuY29udnNbdF07aWYoIWUpe3ZhciBpPXRoaXMuc3BhY2Usbj10aGlzLmNvbnZzW2ldO2U9b1tpXVt0XShuKSx0aGlzLmNvbnZzW3RdPWV9cmV0dXJuIGV9LFtcInJnYlwiLFwiaHNsXCIsXCJoc3ZcIixcImNteWtcIixcImtleXdvcmRcIl0uZm9yRWFjaChmdW5jdGlvbihlKXt1LnByb3RvdHlwZVtlXT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5yb3V0ZVNwYWNlKGUsYXJndW1lbnRzKX19KSxlLmV4cG9ydHM9b30sezQ6NH1dLDY6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtlLmV4cG9ydHM9e2FsaWNlYmx1ZTpbMjQwLDI0OCwyNTVdLGFudGlxdWV3aGl0ZTpbMjUwLDIzNSwyMTVdLGFxdWE6WzAsMjU1LDI1NV0sYXF1YW1hcmluZTpbMTI3LDI1NSwyMTJdLGF6dXJlOlsyNDAsMjU1LDI1NV0sYmVpZ2U6WzI0NSwyNDUsMjIwXSxiaXNxdWU6WzI1NSwyMjgsMTk2XSxibGFjazpbMCwwLDBdLGJsYW5jaGVkYWxtb25kOlsyNTUsMjM1LDIwNV0sYmx1ZTpbMCwwLDI1NV0sYmx1ZXZpb2xldDpbMTM4LDQzLDIyNl0sYnJvd246WzE2NSw0Miw0Ml0sYnVybHl3b29kOlsyMjIsMTg0LDEzNV0sY2FkZXRibHVlOls5NSwxNTgsMTYwXSxjaGFydHJldXNlOlsxMjcsMjU1LDBdLGNob2NvbGF0ZTpbMjEwLDEwNSwzMF0sY29yYWw6WzI1NSwxMjcsODBdLGNvcm5mbG93ZXJibHVlOlsxMDAsMTQ5LDIzN10sY29ybnNpbGs6WzI1NSwyNDgsMjIwXSxjcmltc29uOlsyMjAsMjAsNjBdLGN5YW46WzAsMjU1LDI1NV0sZGFya2JsdWU6WzAsMCwxMzldLGRhcmtjeWFuOlswLDEzOSwxMzldLGRhcmtnb2xkZW5yb2Q6WzE4NCwxMzQsMTFdLGRhcmtncmF5OlsxNjksMTY5LDE2OV0sZGFya2dyZWVuOlswLDEwMCwwXSxkYXJrZ3JleTpbMTY5LDE2OSwxNjldLGRhcmtraGFraTpbMTg5LDE4MywxMDddLGRhcmttYWdlbnRhOlsxMzksMCwxMzldLGRhcmtvbGl2ZWdyZWVuOls4NSwxMDcsNDddLGRhcmtvcmFuZ2U6WzI1NSwxNDAsMF0sZGFya29yY2hpZDpbMTUzLDUwLDIwNF0sZGFya3JlZDpbMTM5LDAsMF0sZGFya3NhbG1vbjpbMjMzLDE1MCwxMjJdLGRhcmtzZWFncmVlbjpbMTQzLDE4OCwxNDNdLGRhcmtzbGF0ZWJsdWU6WzcyLDYxLDEzOV0sZGFya3NsYXRlZ3JheTpbNDcsNzksNzldLGRhcmtzbGF0ZWdyZXk6WzQ3LDc5LDc5XSxkYXJrdHVycXVvaXNlOlswLDIwNiwyMDldLGRhcmt2aW9sZXQ6WzE0OCwwLDIxMV0sZGVlcHBpbms6WzI1NSwyMCwxNDddLGRlZXBza3libHVlOlswLDE5MSwyNTVdLGRpbWdyYXk6WzEwNSwxMDUsMTA1XSxkaW1ncmV5OlsxMDUsMTA1LDEwNV0sZG9kZ2VyYmx1ZTpbMzAsMTQ0LDI1NV0sZmlyZWJyaWNrOlsxNzgsMzQsMzRdLGZsb3JhbHdoaXRlOlsyNTUsMjUwLDI0MF0sZm9yZXN0Z3JlZW46WzM0LDEzOSwzNF0sZnVjaHNpYTpbMjU1LDAsMjU1XSxnYWluc2Jvcm86WzIyMCwyMjAsMjIwXSxnaG9zdHdoaXRlOlsyNDgsMjQ4LDI1NV0sZ29sZDpbMjU1LDIxNSwwXSxnb2xkZW5yb2Q6WzIxOCwxNjUsMzJdLGdyYXk6WzEyOCwxMjgsMTI4XSxncmVlbjpbMCwxMjgsMF0sZ3JlZW55ZWxsb3c6WzE3MywyNTUsNDddLGdyZXk6WzEyOCwxMjgsMTI4XSxob25leWRldzpbMjQwLDI1NSwyNDBdLGhvdHBpbms6WzI1NSwxMDUsMTgwXSxpbmRpYW5yZWQ6WzIwNSw5Miw5Ml0saW5kaWdvOls3NSwwLDEzMF0saXZvcnk6WzI1NSwyNTUsMjQwXSxraGFraTpbMjQwLDIzMCwxNDBdLGxhdmVuZGVyOlsyMzAsMjMwLDI1MF0sbGF2ZW5kZXJibHVzaDpbMjU1LDI0MCwyNDVdLGxhd25ncmVlbjpbMTI0LDI1MiwwXSxsZW1vbmNoaWZmb246WzI1NSwyNTAsMjA1XSxsaWdodGJsdWU6WzE3MywyMTYsMjMwXSxsaWdodGNvcmFsOlsyNDAsMTI4LDEyOF0sbGlnaHRjeWFuOlsyMjQsMjU1LDI1NV0sbGlnaHRnb2xkZW5yb2R5ZWxsb3c6WzI1MCwyNTAsMjEwXSxsaWdodGdyYXk6WzIxMSwyMTEsMjExXSxsaWdodGdyZWVuOlsxNDQsMjM4LDE0NF0sbGlnaHRncmV5OlsyMTEsMjExLDIxMV0sbGlnaHRwaW5rOlsyNTUsMTgyLDE5M10sbGlnaHRzYWxtb246WzI1NSwxNjAsMTIyXSxsaWdodHNlYWdyZWVuOlszMiwxNzgsMTcwXSxsaWdodHNreWJsdWU6WzEzNSwyMDYsMjUwXSxsaWdodHNsYXRlZ3JheTpbMTE5LDEzNiwxNTNdLGxpZ2h0c2xhdGVncmV5OlsxMTksMTM2LDE1M10sbGlnaHRzdGVlbGJsdWU6WzE3NiwxOTYsMjIyXSxsaWdodHllbGxvdzpbMjU1LDI1NSwyMjRdLGxpbWU6WzAsMjU1LDBdLGxpbWVncmVlbjpbNTAsMjA1LDUwXSxsaW5lbjpbMjUwLDI0MCwyMzBdLG1hZ2VudGE6WzI1NSwwLDI1NV0sbWFyb29uOlsxMjgsMCwwXSxtZWRpdW1hcXVhbWFyaW5lOlsxMDIsMjA1LDE3MF0sbWVkaXVtYmx1ZTpbMCwwLDIwNV0sbWVkaXVtb3JjaGlkOlsxODYsODUsMjExXSxtZWRpdW1wdXJwbGU6WzE0NywxMTIsMjE5XSxtZWRpdW1zZWFncmVlbjpbNjAsMTc5LDExM10sbWVkaXVtc2xhdGVibHVlOlsxMjMsMTA0LDIzOF0sbWVkaXVtc3ByaW5nZ3JlZW46WzAsMjUwLDE1NF0sbWVkaXVtdHVycXVvaXNlOls3MiwyMDksMjA0XSxtZWRpdW12aW9sZXRyZWQ6WzE5OSwyMSwxMzNdLG1pZG5pZ2h0Ymx1ZTpbMjUsMjUsMTEyXSxtaW50Y3JlYW06WzI0NSwyNTUsMjUwXSxtaXN0eXJvc2U6WzI1NSwyMjgsMjI1XSxtb2NjYXNpbjpbMjU1LDIyOCwxODFdLG5hdmFqb3doaXRlOlsyNTUsMjIyLDE3M10sbmF2eTpbMCwwLDEyOF0sb2xkbGFjZTpbMjUzLDI0NSwyMzBdLG9saXZlOlsxMjgsMTI4LDBdLG9saXZlZHJhYjpbMTA3LDE0MiwzNV0sb3JhbmdlOlsyNTUsMTY1LDBdLG9yYW5nZXJlZDpbMjU1LDY5LDBdLG9yY2hpZDpbMjE4LDExMiwyMTRdLHBhbGVnb2xkZW5yb2Q6WzIzOCwyMzIsMTcwXSxwYWxlZ3JlZW46WzE1MiwyNTEsMTUyXSxwYWxldHVycXVvaXNlOlsxNzUsMjM4LDIzOF0scGFsZXZpb2xldHJlZDpbMjE5LDExMiwxNDddLHBhcGF5YXdoaXA6WzI1NSwyMzksMjEzXSxwZWFjaHB1ZmY6WzI1NSwyMTgsMTg1XSxwZXJ1OlsyMDUsMTMzLDYzXSxwaW5rOlsyNTUsMTkyLDIwM10scGx1bTpbMjIxLDE2MCwyMjFdLHBvd2RlcmJsdWU6WzE3NiwyMjQsMjMwXSxwdXJwbGU6WzEyOCwwLDEyOF0scmViZWNjYXB1cnBsZTpbMTAyLDUxLDE1M10scmVkOlsyNTUsMCwwXSxyb3N5YnJvd246WzE4OCwxNDMsMTQzXSxyb3lhbGJsdWU6WzY1LDEwNSwyMjVdLHNhZGRsZWJyb3duOlsxMzksNjksMTldLHNhbG1vbjpbMjUwLDEyOCwxMTRdLHNhbmR5YnJvd246WzI0NCwxNjQsOTZdLHNlYWdyZWVuOls0NiwxMzksODddLHNlYXNoZWxsOlsyNTUsMjQ1LDIzOF0sc2llbm5hOlsxNjAsODIsNDVdLHNpbHZlcjpbMTkyLDE5MiwxOTJdLHNreWJsdWU6WzEzNSwyMDYsMjM1XSxzbGF0ZWJsdWU6WzEwNiw5MCwyMDVdLHNsYXRlZ3JheTpbMTEyLDEyOCwxNDRdLHNsYXRlZ3JleTpbMTEyLDEyOCwxNDRdLHNub3c6WzI1NSwyNTAsMjUwXSxzcHJpbmdncmVlbjpbMCwyNTUsMTI3XSxzdGVlbGJsdWU6WzcwLDEzMCwxODBdLHRhbjpbMjEwLDE4MCwxNDBdLHRlYWw6WzAsMTI4LDEyOF0sdGhpc3RsZTpbMjE2LDE5MSwyMTZdLHRvbWF0bzpbMjU1LDk5LDcxXSx0dXJxdW9pc2U6WzY0LDIyNCwyMDhdLHZpb2xldDpbMjM4LDEzMCwyMzhdLHdoZWF0OlsyNDUsMjIyLDE3OV0sd2hpdGU6WzI1NSwyNTUsMjU1XSx3aGl0ZXNtb2tlOlsyNDUsMjQ1LDI0NV0seWVsbG93OlsyNTUsMjU1LDBdLHllbGxvd2dyZWVuOlsxNTQsMjA1LDUwXX19LHt9XSw3OltmdW5jdGlvbih0LGUsaSl7dmFyIG49dCgzMCkoKTtuLmhlbHBlcnM9dCg0NiksdCgyOCkobiksbi5BbmltYXRpb249dCgyMiksbi5hbmltYXRpb25TZXJ2aWNlPXQoMjMpLG4uZGVmYXVsdHM9dCgyNiksbi5FbGVtZW50PXQoMjcpLG4uZWxlbWVudHM9dCg0MSksbi5JbnRlcmFjdGlvbj10KDI5KSxuLmxheW91dHM9dCgzMSksbi5wbGF0Zm9ybT10KDQ5KSxuLnBsdWdpbnM9dCgzMiksbi5TY2FsZT10KDMzKSxuLnNjYWxlU2VydmljZT10KDM0KSxuLlRpY2tzPXQoMzUpLG4uVG9vbHRpcD10KDM2KSx0KDI0KShuKSx0KDI1KShuKSx0KDU2KShuKSx0KDU0KShuKSx0KDU1KShuKSx0KDU3KShuKSx0KDU4KShuKSx0KDU5KShuKSx0KDE1KShuKSx0KDE2KShuKSx0KDE3KShuKSx0KDE4KShuKSx0KDE5KShuKSx0KDIwKShuKSx0KDIxKShuKSx0KDgpKG4pLHQoOSkobiksdCgxMCkobiksdCgxMSkobiksdCgxMikobiksdCgxMykobiksdCgxNCkobik7dmFyIGE9dCg1MCk7Zm9yKHZhciBvIGluIGEpYS5oYXNPd25Qcm9wZXJ0eShvKSYmbi5wbHVnaW5zLnJlZ2lzdGVyKGFbb10pO24ucGxhdGZvcm0uaW5pdGlhbGl6ZSgpLGUuZXhwb3J0cz1uLFwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJih3aW5kb3cuQ2hhcnQ9biksbi5MZWdlbmQ9YS5sZWdlbmQuX2VsZW1lbnQsbi5UaXRsZT1hLnRpdGxlLl9lbGVtZW50LG4ucGx1Z2luU2VydmljZT1uLnBsdWdpbnMsbi5QbHVnaW5CYXNlPW4uRWxlbWVudC5leHRlbmQoe30pLG4uY2FudmFzSGVscGVycz1uLmhlbHBlcnMuY2FudmFzLG4ubGF5b3V0U2VydmljZT1uLmxheW91dHN9LHsxMDoxMCwxMToxMSwxMjoxMiwxMzoxMywxNDoxNCwxNToxNSwxNjoxNiwxNzoxNywxODoxOCwxOToxOSwyMDoyMCwyMToyMSwyMjoyMiwyMzoyMywyNDoyNCwyNToyNSwyNjoyNiwyNzoyNywyODoyOCwyOToyOSwzMDozMCwzMTozMSwzMjozMiwzMzozMywzNDozNCwzNTozNSwzNjozNiw0MTo0MSw0Njo0Niw0OTo0OSw1MDo1MCw1NDo1NCw1NTo1NSw1Njo1Niw1Nzo1Nyw1ODo1OCw1OTo1OSw4OjgsOTo5fV0sODpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2UuZXhwb3J0cz1mdW5jdGlvbihpKXtpLkJhcj1mdW5jdGlvbih0LGUpe3JldHVybiBlLnR5cGU9XCJiYXJcIixuZXcgaSh0LGUpfX19LHt9XSw5OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7ZS5leHBvcnRzPWZ1bmN0aW9uKGkpe2kuQnViYmxlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUudHlwZT1cImJ1YmJsZVwiLG5ldyBpKHQsZSl9fX0se31dLDEwOltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7ZS5leHBvcnRzPWZ1bmN0aW9uKGkpe2kuRG91Z2hudXQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS50eXBlPVwiZG91Z2hudXRcIixuZXcgaSh0LGUpfX19LHt9XSwxMTpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2UuZXhwb3J0cz1mdW5jdGlvbihpKXtpLkxpbmU9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS50eXBlPVwibGluZVwiLG5ldyBpKHQsZSl9fX0se31dLDEyOltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7ZS5leHBvcnRzPWZ1bmN0aW9uKGkpe2kuUG9sYXJBcmVhPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUudHlwZT1cInBvbGFyQXJlYVwiLG5ldyBpKHQsZSl9fX0se31dLDEzOltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7ZS5leHBvcnRzPWZ1bmN0aW9uKGkpe2kuUmFkYXI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS50eXBlPVwicmFkYXJcIixuZXcgaSh0LGUpfX19LHt9XSwxNDpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2UuZXhwb3J0cz1mdW5jdGlvbihpKXtpLlNjYXR0ZXI9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS50eXBlPVwic2NhdHRlclwiLG5ldyBpKHQsZSl9fX0se31dLDE1OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49dCgyNiksYT10KDQxKSxTPXQoNDYpO24uX3NldChcImJhclwiLHtob3Zlcjp7bW9kZTpcImxhYmVsXCJ9LHNjYWxlczp7eEF4ZXM6W3t0eXBlOlwiY2F0ZWdvcnlcIixjYXRlZ29yeVBlcmNlbnRhZ2U6LjgsYmFyUGVyY2VudGFnZTouOSxvZmZzZXQ6ITAsZ3JpZExpbmVzOntvZmZzZXRHcmlkTGluZXM6ITB9fV0seUF4ZXM6W3t0eXBlOlwibGluZWFyXCJ9XX19KSxuLl9zZXQoXCJob3Jpem9udGFsQmFyXCIse2hvdmVyOnttb2RlOlwiaW5kZXhcIixheGlzOlwieVwifSxzY2FsZXM6e3hBeGVzOlt7dHlwZTpcImxpbmVhclwiLHBvc2l0aW9uOlwiYm90dG9tXCJ9XSx5QXhlczpbe3Bvc2l0aW9uOlwibGVmdFwiLHR5cGU6XCJjYXRlZ29yeVwiLGNhdGVnb3J5UGVyY2VudGFnZTouOCxiYXJQZXJjZW50YWdlOi45LG9mZnNldDohMCxncmlkTGluZXM6e29mZnNldEdyaWRMaW5lczohMH19XX0sZWxlbWVudHM6e3JlY3RhbmdsZTp7Ym9yZGVyU2tpcHBlZDpcImxlZnRcIn19LHRvb2x0aXBzOntjYWxsYmFja3M6e3RpdGxlOmZ1bmN0aW9uKHQsZSl7dmFyIGk9XCJcIjtyZXR1cm4gMDx0Lmxlbmd0aCYmKHRbMF0ueUxhYmVsP2k9dFswXS55TGFiZWw6MDxlLmxhYmVscy5sZW5ndGgmJnRbMF0uaW5kZXg8ZS5sYWJlbHMubGVuZ3RoJiYoaT1lLmxhYmVsc1t0WzBdLmluZGV4XSkpLGl9LGxhYmVsOmZ1bmN0aW9uKHQsZSl7cmV0dXJuKGUuZGF0YXNldHNbdC5kYXRhc2V0SW5kZXhdLmxhYmVsfHxcIlwiKStcIjogXCIrdC54TGFiZWx9fSxtb2RlOlwiaW5kZXhcIixheGlzOlwieVwifX0pLGUuZXhwb3J0cz1mdW5jdGlvbihlKXtlLmNvbnRyb2xsZXJzLmJhcj1lLkRhdGFzZXRDb250cm9sbGVyLmV4dGVuZCh7ZGF0YUVsZW1lbnRUeXBlOmEuUmVjdGFuZ2xlLGluaXRpYWxpemU6ZnVuY3Rpb24oKXt2YXIgdDtlLkRhdGFzZXRDb250cm9sbGVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKSwodD10aGlzLmdldE1ldGEoKSkuc3RhY2s9dGhpcy5nZXREYXRhc2V0KCkuc3RhY2ssdC5iYXI9ITB9LHVwZGF0ZTpmdW5jdGlvbih0KXt2YXIgZSxpLG49dGhpcy5nZXRNZXRhKCkuZGF0YTtmb3IodGhpcy5fcnVsZXI9dGhpcy5nZXRSdWxlcigpLGU9MCxpPW4ubGVuZ3RoO2U8aTsrK2UpdGhpcy51cGRhdGVFbGVtZW50KG5bZV0sZSx0KX0sdXBkYXRlRWxlbWVudDpmdW5jdGlvbih0LGUsaSl7dmFyIG49dGhpcyxhPW4uY2hhcnQsbz1uLmdldE1ldGEoKSxyPW4uZ2V0RGF0YXNldCgpLHM9dC5jdXN0b218fHt9LGw9YS5vcHRpb25zLmVsZW1lbnRzLnJlY3RhbmdsZTt0Ll94U2NhbGU9bi5nZXRTY2FsZUZvcklkKG8ueEF4aXNJRCksdC5feVNjYWxlPW4uZ2V0U2NhbGVGb3JJZChvLnlBeGlzSUQpLHQuX2RhdGFzZXRJbmRleD1uLmluZGV4LHQuX2luZGV4PWUsdC5fbW9kZWw9e2RhdGFzZXRMYWJlbDpyLmxhYmVsLGxhYmVsOmEuZGF0YS5sYWJlbHNbZV0sYm9yZGVyU2tpcHBlZDpzLmJvcmRlclNraXBwZWQ/cy5ib3JkZXJTa2lwcGVkOmwuYm9yZGVyU2tpcHBlZCxiYWNrZ3JvdW5kQ29sb3I6cy5iYWNrZ3JvdW5kQ29sb3I/cy5iYWNrZ3JvdW5kQ29sb3I6Uy52YWx1ZUF0SW5kZXhPckRlZmF1bHQoci5iYWNrZ3JvdW5kQ29sb3IsZSxsLmJhY2tncm91bmRDb2xvciksYm9yZGVyQ29sb3I6cy5ib3JkZXJDb2xvcj9zLmJvcmRlckNvbG9yOlMudmFsdWVBdEluZGV4T3JEZWZhdWx0KHIuYm9yZGVyQ29sb3IsZSxsLmJvcmRlckNvbG9yKSxib3JkZXJXaWR0aDpzLmJvcmRlcldpZHRoP3MuYm9yZGVyV2lkdGg6Uy52YWx1ZUF0SW5kZXhPckRlZmF1bHQoci5ib3JkZXJXaWR0aCxlLGwuYm9yZGVyV2lkdGgpfSxuLnVwZGF0ZUVsZW1lbnRHZW9tZXRyeSh0LGUsaSksdC5waXZvdCgpfSx1cGRhdGVFbGVtZW50R2VvbWV0cnk6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMsYT10Ll9tb2RlbCxvPW4uZ2V0VmFsdWVTY2FsZSgpLHI9by5nZXRCYXNlUGl4ZWwoKSxzPW8uaXNIb3Jpem9udGFsKCksbD1uLl9ydWxlcnx8bi5nZXRSdWxlcigpLHU9bi5jYWxjdWxhdGVCYXJWYWx1ZVBpeGVscyhuLmluZGV4LGUpLGQ9bi5jYWxjdWxhdGVCYXJJbmRleFBpeGVscyhuLmluZGV4LGUsbCk7YS5ob3Jpem9udGFsPXMsYS5iYXNlPWk/cjp1LmJhc2UsYS54PXM/aT9yOnUuaGVhZDpkLmNlbnRlcixhLnk9cz9kLmNlbnRlcjppP3I6dS5oZWFkLGEuaGVpZ2h0PXM/ZC5zaXplOnZvaWQgMCxhLndpZHRoPXM/dm9pZCAwOmQuc2l6ZX0sZ2V0VmFsdWVTY2FsZUlkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0TWV0YSgpLnlBeGlzSUR9LGdldEluZGV4U2NhbGVJZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldE1ldGEoKS54QXhpc0lEfSxnZXRWYWx1ZVNjYWxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0U2NhbGVGb3JJZCh0aGlzLmdldFZhbHVlU2NhbGVJZCgpKX0sZ2V0SW5kZXhTY2FsZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNjYWxlRm9ySWQodGhpcy5nZXRJbmRleFNjYWxlSWQoKSl9LF9nZXRTdGFja3M6ZnVuY3Rpb24odCl7dmFyIGUsaSxuPXRoaXMuY2hhcnQsYT10aGlzLmdldEluZGV4U2NhbGUoKS5vcHRpb25zLnN0YWNrZWQsbz12b2lkIDA9PT10P24uZGF0YS5kYXRhc2V0cy5sZW5ndGg6dCsxLHI9W107Zm9yKGU9MDtlPG87KytlKShpPW4uZ2V0RGF0YXNldE1ldGEoZSkpLmJhciYmbi5pc0RhdGFzZXRWaXNpYmxlKGUpJiYoITE9PT1hfHwhMD09PWEmJi0xPT09ci5pbmRleE9mKGkuc3RhY2spfHx2b2lkIDA9PT1hJiYodm9pZCAwPT09aS5zdGFja3x8LTE9PT1yLmluZGV4T2YoaS5zdGFjaykpKSYmci5wdXNoKGkuc3RhY2spO3JldHVybiByfSxnZXRTdGFja0NvdW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldFN0YWNrcygpLmxlbmd0aH0sZ2V0U3RhY2tJbmRleDpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX2dldFN0YWNrcyh0KSxuPXZvaWQgMCE9PWU/aS5pbmRleE9mKGUpOi0xO3JldHVybi0xPT09bj9pLmxlbmd0aC0xOm59LGdldFJ1bGVyOmZ1bmN0aW9uKCl7dmFyIHQsZSxpPXRoaXMuZ2V0SW5kZXhTY2FsZSgpLG49dGhpcy5nZXRTdGFja0NvdW50KCksYT10aGlzLmluZGV4LG89aS5pc0hvcml6b250YWwoKSxyPW8/aS5sZWZ0OmkudG9wLHM9cisobz9pLndpZHRoOmkuaGVpZ2h0KSxsPVtdO2Zvcih0PTAsZT10aGlzLmdldE1ldGEoKS5kYXRhLmxlbmd0aDt0PGU7Kyt0KWwucHVzaChpLmdldFBpeGVsRm9yVmFsdWUobnVsbCx0LGEpKTtyZXR1cm57bWluOlMuaXNOdWxsT3JVbmRlZihpLm9wdGlvbnMuYmFyVGhpY2tuZXNzKT9mdW5jdGlvbih0LGUpe3ZhciBpLG4sYSxvLHI9dC5pc0hvcml6b250YWwoKT90LndpZHRoOnQuaGVpZ2h0LHM9dC5nZXRUaWNrcygpO2ZvcihhPTEsbz1lLmxlbmd0aDthPG87KythKXI9TWF0aC5taW4ocixlW2FdLWVbYS0xXSk7Zm9yKGE9MCxvPXMubGVuZ3RoO2E8bzsrK2Epbj10LmdldFBpeGVsRm9yVGljayhhKSxyPTA8YT9NYXRoLm1pbihyLG4taSk6cixpPW47cmV0dXJuIHJ9KGksbCk6LTEscGl4ZWxzOmwsc3RhcnQ6cixlbmQ6cyxzdGFja0NvdW50Om4sc2NhbGU6aX19LGNhbGN1bGF0ZUJhclZhbHVlUGl4ZWxzOmZ1bmN0aW9uKHQsZSl7dmFyIGksbixhLG8scixzLGw9dGhpcy5jaGFydCx1PXRoaXMuZ2V0TWV0YSgpLGQ9dGhpcy5nZXRWYWx1ZVNjYWxlKCksYz1sLmRhdGEuZGF0YXNldHMsaD1kLmdldFJpZ2h0VmFsdWUoY1t0XS5kYXRhW2VdKSxmPWQub3B0aW9ucy5zdGFja2VkLGc9dS5zdGFjayxwPTA7aWYoZnx8dm9pZCAwPT09ZiYmdm9pZCAwIT09Zylmb3IoaT0wO2k8dDsrK2kpKG49bC5nZXREYXRhc2V0TWV0YShpKSkuYmFyJiZuLnN0YWNrPT09ZyYmbi5jb250cm9sbGVyLmdldFZhbHVlU2NhbGVJZCgpPT09ZC5pZCYmbC5pc0RhdGFzZXRWaXNpYmxlKGkpJiYoYT1kLmdldFJpZ2h0VmFsdWUoY1tpXS5kYXRhW2VdKSwoaDwwJiZhPDB8fDA8PWgmJjA8YSkmJihwKz1hKSk7cmV0dXJuIG89ZC5nZXRQaXhlbEZvclZhbHVlKHApLHtzaXplOnM9KChyPWQuZ2V0UGl4ZWxGb3JWYWx1ZShwK2gpKS1vKS8yLGJhc2U6byxoZWFkOnIsY2VudGVyOnIrcy8yfX0sY2FsY3VsYXRlQmFySW5kZXhQaXhlbHM6ZnVuY3Rpb24odCxlLGkpe3ZhciBuLGEsbyxyLHMsbCx1LGQsYyxoLGYsZyxwLG0sdixiLHgseT1pLnNjYWxlLm9wdGlvbnMsaz1cImZsZXhcIj09PXkuYmFyVGhpY2tuZXNzPyhjPWUsZj15LHA9KGg9aSkucGl4ZWxzLG09cFtjXSx2PTA8Yz9wW2MtMV06bnVsbCxiPWM8cC5sZW5ndGgtMT9wW2MrMV06bnVsbCx4PWYuY2F0ZWdvcnlQZXJjZW50YWdlLG51bGw9PT12JiYodj1tLShudWxsPT09Yj9oLmVuZC1tOmItbSkpLG51bGw9PT1iJiYoYj1tK20tdiksZz1tLShtLXYpLzIqeCx7Y2h1bms6KGItdikvMip4L2guc3RhY2tDb3VudCxyYXRpbzpmLmJhclBlcmNlbnRhZ2Usc3RhcnQ6Z30pOihuPWUsYT1pLGw9KG89eSkuYmFyVGhpY2tuZXNzLHU9YS5zdGFja0NvdW50LGQ9YS5waXhlbHNbbl0scz1TLmlzTnVsbE9yVW5kZWYobCk/KHI9YS5taW4qby5jYXRlZ29yeVBlcmNlbnRhZ2Usby5iYXJQZXJjZW50YWdlKToocj1sKnUsMSkse2NodW5rOnIvdSxyYXRpbzpzLHN0YXJ0OmQtci8yfSksTT10aGlzLmdldFN0YWNrSW5kZXgodCx0aGlzLmdldE1ldGEoKS5zdGFjayksdz1rLnN0YXJ0K2suY2h1bmsqTStrLmNodW5rLzIsQz1NYXRoLm1pbihTLnZhbHVlT3JEZWZhdWx0KHkubWF4QmFyVGhpY2tuZXNzLDEvMCksay5jaHVuayprLnJhdGlvKTtyZXR1cm57YmFzZTp3LUMvMixoZWFkOncrQy8yLGNlbnRlcjp3LHNpemU6Q319LGRyYXc6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNoYXJ0LGU9dGhpcy5nZXRWYWx1ZVNjYWxlKCksaT10aGlzLmdldE1ldGEoKS5kYXRhLG49dGhpcy5nZXREYXRhc2V0KCksYT1pLmxlbmd0aCxvPTA7Zm9yKFMuY2FudmFzLmNsaXBBcmVhKHQuY3R4LHQuY2hhcnRBcmVhKTtvPGE7KytvKWlzTmFOKGUuZ2V0UmlnaHRWYWx1ZShuLmRhdGFbb10pKXx8aVtvXS5kcmF3KCk7Uy5jYW52YXMudW5jbGlwQXJlYSh0LmN0eCl9fSksZS5jb250cm9sbGVycy5ob3Jpem9udGFsQmFyPWUuY29udHJvbGxlcnMuYmFyLmV4dGVuZCh7Z2V0VmFsdWVTY2FsZUlkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ2V0TWV0YSgpLnhBeGlzSUR9LGdldEluZGV4U2NhbGVJZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldE1ldGEoKS55QXhpc0lEfX0pfX0sezI2OjI2LDQxOjQxLDQ2OjQ2fV0sMTY6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjt2YXIgbj10KDI2KSxhPXQoNDEpLGc9dCg0Nik7bi5fc2V0KFwiYnViYmxlXCIse2hvdmVyOnttb2RlOlwic2luZ2xlXCJ9LHNjYWxlczp7eEF4ZXM6W3t0eXBlOlwibGluZWFyXCIscG9zaXRpb246XCJib3R0b21cIixpZDpcIngtYXhpcy0wXCJ9XSx5QXhlczpbe3R5cGU6XCJsaW5lYXJcIixwb3NpdGlvbjpcImxlZnRcIixpZDpcInktYXhpcy0wXCJ9XX0sdG9vbHRpcHM6e2NhbGxiYWNrczp7dGl0bGU6ZnVuY3Rpb24oKXtyZXR1cm5cIlwifSxsYWJlbDpmdW5jdGlvbih0LGUpe3ZhciBpPWUuZGF0YXNldHNbdC5kYXRhc2V0SW5kZXhdLmxhYmVsfHxcIlwiLG49ZS5kYXRhc2V0c1t0LmRhdGFzZXRJbmRleF0uZGF0YVt0LmluZGV4XTtyZXR1cm4gaStcIjogKFwiK3QueExhYmVsK1wiLCBcIit0LnlMYWJlbCtcIiwgXCIrbi5yK1wiKVwifX19fSksZS5leHBvcnRzPWZ1bmN0aW9uKHQpe3QuY29udHJvbGxlcnMuYnViYmxlPXQuRGF0YXNldENvbnRyb2xsZXIuZXh0ZW5kKHtkYXRhRWxlbWVudFR5cGU6YS5Qb2ludCx1cGRhdGU6ZnVuY3Rpb24oaSl7dmFyIG49dGhpcyx0PW4uZ2V0TWV0YSgpLmRhdGE7Zy5lYWNoKHQsZnVuY3Rpb24odCxlKXtuLnVwZGF0ZUVsZW1lbnQodCxlLGkpfSl9LHVwZGF0ZUVsZW1lbnQ6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMsYT1uLmdldE1ldGEoKSxvPXQuY3VzdG9tfHx7fSxyPW4uZ2V0U2NhbGVGb3JJZChhLnhBeGlzSUQpLHM9bi5nZXRTY2FsZUZvcklkKGEueUF4aXNJRCksbD1uLl9yZXNvbHZlRWxlbWVudE9wdGlvbnModCxlKSx1PW4uZ2V0RGF0YXNldCgpLmRhdGFbZV0sZD1uLmluZGV4LGM9aT9yLmdldFBpeGVsRm9yRGVjaW1hbCguNSk6ci5nZXRQaXhlbEZvclZhbHVlKFwib2JqZWN0XCI9PXR5cGVvZiB1P3U6TmFOLGUsZCksaD1pP3MuZ2V0QmFzZVBpeGVsKCk6cy5nZXRQaXhlbEZvclZhbHVlKHUsZSxkKTt0Ll94U2NhbGU9cix0Ll95U2NhbGU9cyx0Ll9vcHRpb25zPWwsdC5fZGF0YXNldEluZGV4PWQsdC5faW5kZXg9ZSx0Ll9tb2RlbD17YmFja2dyb3VuZENvbG9yOmwuYmFja2dyb3VuZENvbG9yLGJvcmRlckNvbG9yOmwuYm9yZGVyQ29sb3IsYm9yZGVyV2lkdGg6bC5ib3JkZXJXaWR0aCxoaXRSYWRpdXM6bC5oaXRSYWRpdXMscG9pbnRTdHlsZTpsLnBvaW50U3R5bGUscm90YXRpb246bC5yb3RhdGlvbixyYWRpdXM6aT8wOmwucmFkaXVzLHNraXA6by5za2lwfHxpc05hTihjKXx8aXNOYU4oaCkseDpjLHk6aH0sdC5waXZvdCgpfSxzZXRIb3ZlclN0eWxlOmZ1bmN0aW9uKHQpe3ZhciBlPXQuX21vZGVsLGk9dC5fb3B0aW9uczt0LiRwcmV2aW91c1N0eWxlPXtiYWNrZ3JvdW5kQ29sb3I6ZS5iYWNrZ3JvdW5kQ29sb3IsYm9yZGVyQ29sb3I6ZS5ib3JkZXJDb2xvcixib3JkZXJXaWR0aDplLmJvcmRlcldpZHRoLHJhZGl1czplLnJhZGl1c30sZS5iYWNrZ3JvdW5kQ29sb3I9Zy52YWx1ZU9yRGVmYXVsdChpLmhvdmVyQmFja2dyb3VuZENvbG9yLGcuZ2V0SG92ZXJDb2xvcihpLmJhY2tncm91bmRDb2xvcikpLGUuYm9yZGVyQ29sb3I9Zy52YWx1ZU9yRGVmYXVsdChpLmhvdmVyQm9yZGVyQ29sb3IsZy5nZXRIb3ZlckNvbG9yKGkuYm9yZGVyQ29sb3IpKSxlLmJvcmRlcldpZHRoPWcudmFsdWVPckRlZmF1bHQoaS5ob3ZlckJvcmRlcldpZHRoLGkuYm9yZGVyV2lkdGgpLGUucmFkaXVzPWkucmFkaXVzK2kuaG92ZXJSYWRpdXN9LF9yZXNvbHZlRWxlbWVudE9wdGlvbnM6ZnVuY3Rpb24odCxlKXt2YXIgaSxuLGEsbz10aGlzLmNoYXJ0LHI9by5kYXRhLmRhdGFzZXRzW3RoaXMuaW5kZXhdLHM9dC5jdXN0b218fHt9LGw9by5vcHRpb25zLmVsZW1lbnRzLnBvaW50LHU9Zy5vcHRpb25zLnJlc29sdmUsZD1yLmRhdGFbZV0sYz17fSxoPXtjaGFydDpvLGRhdGFJbmRleDplLGRhdGFzZXQ6cixkYXRhc2V0SW5kZXg6dGhpcy5pbmRleH0sZj1bXCJiYWNrZ3JvdW5kQ29sb3JcIixcImJvcmRlckNvbG9yXCIsXCJib3JkZXJXaWR0aFwiLFwiaG92ZXJCYWNrZ3JvdW5kQ29sb3JcIixcImhvdmVyQm9yZGVyQ29sb3JcIixcImhvdmVyQm9yZGVyV2lkdGhcIixcImhvdmVyUmFkaXVzXCIsXCJoaXRSYWRpdXNcIixcInBvaW50U3R5bGVcIixcInJvdGF0aW9uXCJdO2ZvcihpPTAsbj1mLmxlbmd0aDtpPG47KytpKWNbYT1mW2ldXT11KFtzW2FdLHJbYV0sbFthXV0saCxlKTtyZXR1cm4gYy5yYWRpdXM9dShbcy5yYWRpdXMsZD9kLnI6dm9pZCAwLHIucmFkaXVzLGwucmFkaXVzXSxoLGUpLGN9fSl9fSx7MjY6MjYsNDE6NDEsNDY6NDZ9XSwxNzpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBuPXQoMjYpLGE9dCg0MSksQT10KDQ2KTtuLl9zZXQoXCJkb3VnaG51dFwiLHthbmltYXRpb246e2FuaW1hdGVSb3RhdGU6ITAsYW5pbWF0ZVNjYWxlOiExfSxob3Zlcjp7bW9kZTpcInNpbmdsZVwifSxsZWdlbmRDYWxsYmFjazpmdW5jdGlvbih0KXt2YXIgZT1bXTtlLnB1c2goJzx1bCBjbGFzcz1cIicrdC5pZCsnLWxlZ2VuZFwiPicpO3ZhciBpPXQuZGF0YSxuPWkuZGF0YXNldHMsYT1pLmxhYmVscztpZihuLmxlbmd0aClmb3IodmFyIG89MDtvPG5bMF0uZGF0YS5sZW5ndGg7KytvKWUucHVzaCgnPGxpPjxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjonK25bMF0uYmFja2dyb3VuZENvbG9yW29dKydcIj48L3NwYW4+JyksYVtvXSYmZS5wdXNoKGFbb10pLGUucHVzaChcIjwvbGk+XCIpO3JldHVybiBlLnB1c2goXCI8L3VsPlwiKSxlLmpvaW4oXCJcIil9LGxlZ2VuZDp7bGFiZWxzOntnZW5lcmF0ZUxhYmVsczpmdW5jdGlvbihsKXt2YXIgdT1sLmRhdGE7cmV0dXJuIHUubGFiZWxzLmxlbmd0aCYmdS5kYXRhc2V0cy5sZW5ndGg/dS5sYWJlbHMubWFwKGZ1bmN0aW9uKHQsZSl7dmFyIGk9bC5nZXREYXRhc2V0TWV0YSgwKSxuPXUuZGF0YXNldHNbMF0sYT1pLmRhdGFbZV0sbz1hJiZhLmN1c3RvbXx8e30scj1BLnZhbHVlQXRJbmRleE9yRGVmYXVsdCxzPWwub3B0aW9ucy5lbGVtZW50cy5hcmM7cmV0dXJue3RleHQ6dCxmaWxsU3R5bGU6by5iYWNrZ3JvdW5kQ29sb3I/by5iYWNrZ3JvdW5kQ29sb3I6cihuLmJhY2tncm91bmRDb2xvcixlLHMuYmFja2dyb3VuZENvbG9yKSxzdHJva2VTdHlsZTpvLmJvcmRlckNvbG9yP28uYm9yZGVyQ29sb3I6cihuLmJvcmRlckNvbG9yLGUscy5ib3JkZXJDb2xvciksbGluZVdpZHRoOm8uYm9yZGVyV2lkdGg/by5ib3JkZXJXaWR0aDpyKG4uYm9yZGVyV2lkdGgsZSxzLmJvcmRlcldpZHRoKSxoaWRkZW46aXNOYU4obi5kYXRhW2VdKXx8aS5kYXRhW2VdLmhpZGRlbixpbmRleDplfX0pOltdfX0sb25DbGljazpmdW5jdGlvbih0LGUpe3ZhciBpLG4sYSxvPWUuaW5kZXgscj10aGlzLmNoYXJ0O2ZvcihpPTAsbj0oci5kYXRhLmRhdGFzZXRzfHxbXSkubGVuZ3RoO2k8bjsrK2kpKGE9ci5nZXREYXRhc2V0TWV0YShpKSkuZGF0YVtvXSYmKGEuZGF0YVtvXS5oaWRkZW49IWEuZGF0YVtvXS5oaWRkZW4pO3IudXBkYXRlKCl9fSxjdXRvdXRQZXJjZW50YWdlOjUwLHJvdGF0aW9uOi0uNSpNYXRoLlBJLGNpcmN1bWZlcmVuY2U6MipNYXRoLlBJLHRvb2x0aXBzOntjYWxsYmFja3M6e3RpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuXCJcIn0sbGFiZWw6ZnVuY3Rpb24odCxlKXt2YXIgaT1lLmxhYmVsc1t0LmluZGV4XSxuPVwiOiBcIitlLmRhdGFzZXRzW3QuZGF0YXNldEluZGV4XS5kYXRhW3QuaW5kZXhdO3JldHVybiBBLmlzQXJyYXkoaSk/KGk9aS5zbGljZSgpKVswXSs9bjppKz1uLGl9fX19KSxuLl9zZXQoXCJwaWVcIixBLmNsb25lKG4uZG91Z2hudXQpKSxuLl9zZXQoXCJwaWVcIix7Y3V0b3V0UGVyY2VudGFnZTowfSksZS5leHBvcnRzPWZ1bmN0aW9uKHQpe3QuY29udHJvbGxlcnMuZG91Z2hudXQ9dC5jb250cm9sbGVycy5waWU9dC5EYXRhc2V0Q29udHJvbGxlci5leHRlbmQoe2RhdGFFbGVtZW50VHlwZTphLkFyYyxsaW5rU2NhbGVzOkEubm9vcCxnZXRSaW5nSW5kZXg6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT0wO2k8dDsrK2kpdGhpcy5jaGFydC5pc0RhdGFzZXRWaXNpYmxlKGkpJiYrK2U7cmV0dXJuIGV9LHVwZGF0ZTpmdW5jdGlvbihpKXt2YXIgbj10aGlzLHQ9bi5jaGFydCxlPXQuY2hhcnRBcmVhLGE9dC5vcHRpb25zLG89YS5lbGVtZW50cy5hcmMscj1lLnJpZ2h0LWUubGVmdC1vLmJvcmRlcldpZHRoLHM9ZS5ib3R0b20tZS50b3Atby5ib3JkZXJXaWR0aCxsPU1hdGgubWluKHIscyksdT17eDowLHk6MH0sZD1uLmdldE1ldGEoKSxjPWEuY3V0b3V0UGVyY2VudGFnZSxoPWEuY2lyY3VtZmVyZW5jZTtpZihoPDIqTWF0aC5QSSl7dmFyIGY9YS5yb3RhdGlvbiUoMipNYXRoLlBJKSxnPShmKz0yKk1hdGguUEkqKGY+PU1hdGguUEk/LTE6ZjwtTWF0aC5QST8xOjApKStoLHA9TWF0aC5jb3MoZiksbT1NYXRoLnNpbihmKSx2PU1hdGguY29zKGcpLGI9TWF0aC5zaW4oZykseD1mPD0wJiYwPD1nfHxmPD0yKk1hdGguUEkmJjIqTWF0aC5QSTw9Zyx5PWY8PS41Kk1hdGguUEkmJi41Kk1hdGguUEk8PWd8fGY8PTIuNSpNYXRoLlBJJiYyLjUqTWF0aC5QSTw9ZyxrPWY8PS1NYXRoLlBJJiYtTWF0aC5QSTw9Z3x8Zjw9TWF0aC5QSSYmTWF0aC5QSTw9ZyxNPWY8PS41Ki1NYXRoLlBJJiYuNSotTWF0aC5QSTw9Z3x8Zjw9MS41Kk1hdGguUEkmJjEuNSpNYXRoLlBJPD1nLHc9Yy8xMDAsQz1rPy0xOk1hdGgubWluKHAqKHA8MD8xOncpLHYqKHY8MD8xOncpKSxTPU0/LTE6TWF0aC5taW4obSoobTwwPzE6dyksYiooYjwwPzE6dykpLF89eD8xOk1hdGgubWF4KHAqKDA8cD8xOncpLHYqKDA8dj8xOncpKSxEPXk/MTpNYXRoLm1heChtKigwPG0/MTp3KSxiKigwPGI/MTp3KSksUD0uNSooXy1DKSxJPS41KihELVMpO2w9TWF0aC5taW4oci9QLHMvSSksdT17eDotLjUqKF8rQykseTotLjUqKEQrUyl9fXQuYm9yZGVyV2lkdGg9bi5nZXRNYXhCb3JkZXJXaWR0aChkLmRhdGEpLHQub3V0ZXJSYWRpdXM9TWF0aC5tYXgoKGwtdC5ib3JkZXJXaWR0aCkvMiwwKSx0LmlubmVyUmFkaXVzPU1hdGgubWF4KGM/dC5vdXRlclJhZGl1cy8xMDAqYzowLDApLHQucmFkaXVzTGVuZ3RoPSh0Lm91dGVyUmFkaXVzLXQuaW5uZXJSYWRpdXMpL3QuZ2V0VmlzaWJsZURhdGFzZXRDb3VudCgpLHQub2Zmc2V0WD11LngqdC5vdXRlclJhZGl1cyx0Lm9mZnNldFk9dS55KnQub3V0ZXJSYWRpdXMsZC50b3RhbD1uLmNhbGN1bGF0ZVRvdGFsKCksbi5vdXRlclJhZGl1cz10Lm91dGVyUmFkaXVzLXQucmFkaXVzTGVuZ3RoKm4uZ2V0UmluZ0luZGV4KG4uaW5kZXgpLG4uaW5uZXJSYWRpdXM9TWF0aC5tYXgobi5vdXRlclJhZGl1cy10LnJhZGl1c0xlbmd0aCwwKSxBLmVhY2goZC5kYXRhLGZ1bmN0aW9uKHQsZSl7bi51cGRhdGVFbGVtZW50KHQsZSxpKX0pfSx1cGRhdGVFbGVtZW50OmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10aGlzLGE9bi5jaGFydCxvPWEuY2hhcnRBcmVhLHI9YS5vcHRpb25zLHM9ci5hbmltYXRpb24sbD0oby5sZWZ0K28ucmlnaHQpLzIsdT0oby50b3Arby5ib3R0b20pLzIsZD1yLnJvdGF0aW9uLGM9ci5yb3RhdGlvbixoPW4uZ2V0RGF0YXNldCgpLGY9aSYmcy5hbmltYXRlUm90YXRlPzA6dC5oaWRkZW4/MDpuLmNhbGN1bGF0ZUNpcmN1bWZlcmVuY2UoaC5kYXRhW2VdKSooci5jaXJjdW1mZXJlbmNlLygyKk1hdGguUEkpKSxnPWkmJnMuYW5pbWF0ZVNjYWxlPzA6bi5pbm5lclJhZGl1cyxwPWkmJnMuYW5pbWF0ZVNjYWxlPzA6bi5vdXRlclJhZGl1cyxtPUEudmFsdWVBdEluZGV4T3JEZWZhdWx0O0EuZXh0ZW5kKHQse19kYXRhc2V0SW5kZXg6bi5pbmRleCxfaW5kZXg6ZSxfbW9kZWw6e3g6bCthLm9mZnNldFgseTp1K2Eub2Zmc2V0WSxzdGFydEFuZ2xlOmQsZW5kQW5nbGU6YyxjaXJjdW1mZXJlbmNlOmYsb3V0ZXJSYWRpdXM6cCxpbm5lclJhZGl1czpnLGxhYmVsOm0oaC5sYWJlbCxlLGEuZGF0YS5sYWJlbHNbZV0pfX0pO3ZhciB2PXQuX21vZGVsLGI9dC5jdXN0b218fHt9LHg9QS52YWx1ZUF0SW5kZXhPckRlZmF1bHQseT10aGlzLmNoYXJ0Lm9wdGlvbnMuZWxlbWVudHMuYXJjO3YuYmFja2dyb3VuZENvbG9yPWIuYmFja2dyb3VuZENvbG9yP2IuYmFja2dyb3VuZENvbG9yOngoaC5iYWNrZ3JvdW5kQ29sb3IsZSx5LmJhY2tncm91bmRDb2xvciksdi5ib3JkZXJDb2xvcj1iLmJvcmRlckNvbG9yP2IuYm9yZGVyQ29sb3I6eChoLmJvcmRlckNvbG9yLGUseS5ib3JkZXJDb2xvciksdi5ib3JkZXJXaWR0aD1iLmJvcmRlcldpZHRoP2IuYm9yZGVyV2lkdGg6eChoLmJvcmRlcldpZHRoLGUseS5ib3JkZXJXaWR0aCksaSYmcy5hbmltYXRlUm90YXRlfHwodi5zdGFydEFuZ2xlPTA9PT1lP3Iucm90YXRpb246bi5nZXRNZXRhKCkuZGF0YVtlLTFdLl9tb2RlbC5lbmRBbmdsZSx2LmVuZEFuZ2xlPXYuc3RhcnRBbmdsZSt2LmNpcmN1bWZlcmVuY2UpLHQucGl2b3QoKX0sY2FsY3VsYXRlVG90YWw6ZnVuY3Rpb24oKXt2YXIgaSxuPXRoaXMuZ2V0RGF0YXNldCgpLHQ9dGhpcy5nZXRNZXRhKCksYT0wO3JldHVybiBBLmVhY2godC5kYXRhLGZ1bmN0aW9uKHQsZSl7aT1uLmRhdGFbZV0saXNOYU4oaSl8fHQuaGlkZGVufHwoYSs9TWF0aC5hYnMoaSkpfSksYX0sY2FsY3VsYXRlQ2lyY3VtZmVyZW5jZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldE1ldGEoKS50b3RhbDtyZXR1cm4gMDxlJiYhaXNOYU4odCk/MipNYXRoLlBJKihNYXRoLmFicyh0KS9lKTowfSxnZXRNYXhCb3JkZXJXaWR0aDpmdW5jdGlvbih0KXtmb3IodmFyIGUsaSxuPTAsYT10aGlzLmluZGV4LG89dC5sZW5ndGgscj0wO3I8bztyKyspbj0obj1uPChlPXRbcl0uX21vZGVsP3Rbcl0uX21vZGVsLmJvcmRlcldpZHRoOjApP2U6bik8KGk9dFtyXS5fY2hhcnQ/dFtyXS5fY2hhcnQuY29uZmlnLmRhdGEuZGF0YXNldHNbYV0uaG92ZXJCb3JkZXJXaWR0aDowKT9pOm47cmV0dXJuIG59fSl9fSx7MjY6MjYsNDE6NDEsNDY6NDZ9XSwxODpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBuPXQoMjYpLGE9dCg0MSksZz10KDQ2KTtuLl9zZXQoXCJsaW5lXCIse3Nob3dMaW5lczohMCxzcGFuR2FwczohMSxob3Zlcjp7bW9kZTpcImxhYmVsXCJ9LHNjYWxlczp7eEF4ZXM6W3t0eXBlOlwiY2F0ZWdvcnlcIixpZDpcIngtYXhpcy0wXCJ9XSx5QXhlczpbe3R5cGU6XCJsaW5lYXJcIixpZDpcInktYXhpcy0wXCJ9XX19KSxlLmV4cG9ydHM9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZih0LGUpe3JldHVybiBnLnZhbHVlT3JEZWZhdWx0KHQuc2hvd0xpbmUsZS5zaG93TGluZXMpfXQuY29udHJvbGxlcnMubGluZT10LkRhdGFzZXRDb250cm9sbGVyLmV4dGVuZCh7ZGF0YXNldEVsZW1lbnRUeXBlOmEuTGluZSxkYXRhRWxlbWVudFR5cGU6YS5Qb2ludCx1cGRhdGU6ZnVuY3Rpb24odCl7dmFyIGUsaSxuLGE9dGhpcyxvPWEuZ2V0TWV0YSgpLHI9by5kYXRhc2V0LHM9by5kYXRhfHxbXSxsPWEuY2hhcnQub3B0aW9ucyx1PWwuZWxlbWVudHMubGluZSxkPWEuZ2V0U2NhbGVGb3JJZChvLnlBeGlzSUQpLGM9YS5nZXREYXRhc2V0KCksaD1mKGMsbCk7Zm9yKGgmJihuPXIuY3VzdG9tfHx7fSx2b2lkIDAhPT1jLnRlbnNpb24mJnZvaWQgMD09PWMubGluZVRlbnNpb24mJihjLmxpbmVUZW5zaW9uPWMudGVuc2lvbiksci5fc2NhbGU9ZCxyLl9kYXRhc2V0SW5kZXg9YS5pbmRleCxyLl9jaGlsZHJlbj1zLHIuX21vZGVsPXtzcGFuR2FwczpjLnNwYW5HYXBzP2Muc3BhbkdhcHM6bC5zcGFuR2Fwcyx0ZW5zaW9uOm4udGVuc2lvbj9uLnRlbnNpb246Zy52YWx1ZU9yRGVmYXVsdChjLmxpbmVUZW5zaW9uLHUudGVuc2lvbiksYmFja2dyb3VuZENvbG9yOm4uYmFja2dyb3VuZENvbG9yP24uYmFja2dyb3VuZENvbG9yOmMuYmFja2dyb3VuZENvbG9yfHx1LmJhY2tncm91bmRDb2xvcixib3JkZXJXaWR0aDpuLmJvcmRlcldpZHRoP24uYm9yZGVyV2lkdGg6Yy5ib3JkZXJXaWR0aHx8dS5ib3JkZXJXaWR0aCxib3JkZXJDb2xvcjpuLmJvcmRlckNvbG9yP24uYm9yZGVyQ29sb3I6Yy5ib3JkZXJDb2xvcnx8dS5ib3JkZXJDb2xvcixib3JkZXJDYXBTdHlsZTpuLmJvcmRlckNhcFN0eWxlP24uYm9yZGVyQ2FwU3R5bGU6Yy5ib3JkZXJDYXBTdHlsZXx8dS5ib3JkZXJDYXBTdHlsZSxib3JkZXJEYXNoOm4uYm9yZGVyRGFzaD9uLmJvcmRlckRhc2g6Yy5ib3JkZXJEYXNofHx1LmJvcmRlckRhc2gsYm9yZGVyRGFzaE9mZnNldDpuLmJvcmRlckRhc2hPZmZzZXQ/bi5ib3JkZXJEYXNoT2Zmc2V0OmMuYm9yZGVyRGFzaE9mZnNldHx8dS5ib3JkZXJEYXNoT2Zmc2V0LGJvcmRlckpvaW5TdHlsZTpuLmJvcmRlckpvaW5TdHlsZT9uLmJvcmRlckpvaW5TdHlsZTpjLmJvcmRlckpvaW5TdHlsZXx8dS5ib3JkZXJKb2luU3R5bGUsZmlsbDpuLmZpbGw/bi5maWxsOnZvaWQgMCE9PWMuZmlsbD9jLmZpbGw6dS5maWxsLHN0ZXBwZWRMaW5lOm4uc3RlcHBlZExpbmU/bi5zdGVwcGVkTGluZTpnLnZhbHVlT3JEZWZhdWx0KGMuc3RlcHBlZExpbmUsdS5zdGVwcGVkKSxjdWJpY0ludGVycG9sYXRpb25Nb2RlOm4uY3ViaWNJbnRlcnBvbGF0aW9uTW9kZT9uLmN1YmljSW50ZXJwb2xhdGlvbk1vZGU6Zy52YWx1ZU9yRGVmYXVsdChjLmN1YmljSW50ZXJwb2xhdGlvbk1vZGUsdS5jdWJpY0ludGVycG9sYXRpb25Nb2RlKX0sci5waXZvdCgpKSxlPTAsaT1zLmxlbmd0aDtlPGk7KytlKWEudXBkYXRlRWxlbWVudChzW2VdLGUsdCk7Zm9yKGgmJjAhPT1yLl9tb2RlbC50ZW5zaW9uJiZhLnVwZGF0ZUJlemllckNvbnRyb2xQb2ludHMoKSxlPTAsaT1zLmxlbmd0aDtlPGk7KytlKXNbZV0ucGl2b3QoKX0sZ2V0UG9pbnRCYWNrZ3JvdW5kQ29sb3I6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmNoYXJ0Lm9wdGlvbnMuZWxlbWVudHMucG9pbnQuYmFja2dyb3VuZENvbG9yLG49dGhpcy5nZXREYXRhc2V0KCksYT10LmN1c3RvbXx8e307cmV0dXJuIGEuYmFja2dyb3VuZENvbG9yP2k9YS5iYWNrZ3JvdW5kQ29sb3I6bi5wb2ludEJhY2tncm91bmRDb2xvcj9pPWcudmFsdWVBdEluZGV4T3JEZWZhdWx0KG4ucG9pbnRCYWNrZ3JvdW5kQ29sb3IsZSxpKTpuLmJhY2tncm91bmRDb2xvciYmKGk9bi5iYWNrZ3JvdW5kQ29sb3IpLGl9LGdldFBvaW50Qm9yZGVyQ29sb3I6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmNoYXJ0Lm9wdGlvbnMuZWxlbWVudHMucG9pbnQuYm9yZGVyQ29sb3Isbj10aGlzLmdldERhdGFzZXQoKSxhPXQuY3VzdG9tfHx7fTtyZXR1cm4gYS5ib3JkZXJDb2xvcj9pPWEuYm9yZGVyQ29sb3I6bi5wb2ludEJvcmRlckNvbG9yP2k9Zy52YWx1ZUF0SW5kZXhPckRlZmF1bHQobi5wb2ludEJvcmRlckNvbG9yLGUsaSk6bi5ib3JkZXJDb2xvciYmKGk9bi5ib3JkZXJDb2xvciksaX0sZ2V0UG9pbnRCb3JkZXJXaWR0aDpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuY2hhcnQub3B0aW9ucy5lbGVtZW50cy5wb2ludC5ib3JkZXJXaWR0aCxuPXRoaXMuZ2V0RGF0YXNldCgpLGE9dC5jdXN0b218fHt9O3JldHVybiBpc05hTihhLmJvcmRlcldpZHRoKT8haXNOYU4obi5wb2ludEJvcmRlcldpZHRoKXx8Zy5pc0FycmF5KG4ucG9pbnRCb3JkZXJXaWR0aCk/aT1nLnZhbHVlQXRJbmRleE9yRGVmYXVsdChuLnBvaW50Qm9yZGVyV2lkdGgsZSxpKTppc05hTihuLmJvcmRlcldpZHRoKXx8KGk9bi5ib3JkZXJXaWR0aCk6aT1hLmJvcmRlcldpZHRoLGl9LGdldFBvaW50Um90YXRpb246ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmNoYXJ0Lm9wdGlvbnMuZWxlbWVudHMucG9pbnQucm90YXRpb24sbj10aGlzLmdldERhdGFzZXQoKSxhPXQuY3VzdG9tfHx7fTtyZXR1cm4gaXNOYU4oYS5yb3RhdGlvbik/aXNOYU4obi5wb2ludFJvdGF0aW9uKSYmIWcuaXNBcnJheShuLnBvaW50Um90YXRpb24pfHwoaT1nLnZhbHVlQXRJbmRleE9yRGVmYXVsdChuLnBvaW50Um90YXRpb24sZSxpKSk6aT1hLnJvdGF0aW9uLGl9LHVwZGF0ZUVsZW1lbnQ6ZnVuY3Rpb24odCxlLGkpe3ZhciBuLGEsbz10aGlzLHI9by5nZXRNZXRhKCkscz10LmN1c3RvbXx8e30sbD1vLmdldERhdGFzZXQoKSx1PW8uaW5kZXgsZD1sLmRhdGFbZV0sYz1vLmdldFNjYWxlRm9ySWQoci55QXhpc0lEKSxoPW8uZ2V0U2NhbGVGb3JJZChyLnhBeGlzSUQpLGY9by5jaGFydC5vcHRpb25zLmVsZW1lbnRzLnBvaW50O3ZvaWQgMCE9PWwucmFkaXVzJiZ2b2lkIDA9PT1sLnBvaW50UmFkaXVzJiYobC5wb2ludFJhZGl1cz1sLnJhZGl1cyksdm9pZCAwIT09bC5oaXRSYWRpdXMmJnZvaWQgMD09PWwucG9pbnRIaXRSYWRpdXMmJihsLnBvaW50SGl0UmFkaXVzPWwuaGl0UmFkaXVzKSxuPWguZ2V0UGl4ZWxGb3JWYWx1ZShcIm9iamVjdFwiPT10eXBlb2YgZD9kOk5hTixlLHUpLGE9aT9jLmdldEJhc2VQaXhlbCgpOm8uY2FsY3VsYXRlUG9pbnRZKGQsZSx1KSx0Ll94U2NhbGU9aCx0Ll95U2NhbGU9Yyx0Ll9kYXRhc2V0SW5kZXg9dSx0Ll9pbmRleD1lLHQuX21vZGVsPXt4Om4seTphLHNraXA6cy5za2lwfHxpc05hTihuKXx8aXNOYU4oYSkscmFkaXVzOnMucmFkaXVzfHxnLnZhbHVlQXRJbmRleE9yRGVmYXVsdChsLnBvaW50UmFkaXVzLGUsZi5yYWRpdXMpLHBvaW50U3R5bGU6cy5wb2ludFN0eWxlfHxnLnZhbHVlQXRJbmRleE9yRGVmYXVsdChsLnBvaW50U3R5bGUsZSxmLnBvaW50U3R5bGUpLHJvdGF0aW9uOm8uZ2V0UG9pbnRSb3RhdGlvbih0LGUpLGJhY2tncm91bmRDb2xvcjpvLmdldFBvaW50QmFja2dyb3VuZENvbG9yKHQsZSksYm9yZGVyQ29sb3I6by5nZXRQb2ludEJvcmRlckNvbG9yKHQsZSksYm9yZGVyV2lkdGg6by5nZXRQb2ludEJvcmRlcldpZHRoKHQsZSksdGVuc2lvbjpyLmRhdGFzZXQuX21vZGVsP3IuZGF0YXNldC5fbW9kZWwudGVuc2lvbjowLHN0ZXBwZWRMaW5lOiEhci5kYXRhc2V0Ll9tb2RlbCYmci5kYXRhc2V0Ll9tb2RlbC5zdGVwcGVkTGluZSxoaXRSYWRpdXM6cy5oaXRSYWRpdXN8fGcudmFsdWVBdEluZGV4T3JEZWZhdWx0KGwucG9pbnRIaXRSYWRpdXMsZSxmLmhpdFJhZGl1cyl9fSxjYWxjdWxhdGVQb2ludFk6ZnVuY3Rpb24odCxlLGkpe3ZhciBuLGEsbyxyPXRoaXMuY2hhcnQscz10aGlzLmdldE1ldGEoKSxsPXRoaXMuZ2V0U2NhbGVGb3JJZChzLnlBeGlzSUQpLHU9MCxkPTA7aWYobC5vcHRpb25zLnN0YWNrZWQpe2ZvcihuPTA7bjxpO24rKylpZihhPXIuZGF0YS5kYXRhc2V0c1tuXSxcImxpbmVcIj09PShvPXIuZ2V0RGF0YXNldE1ldGEobikpLnR5cGUmJm8ueUF4aXNJRD09PWwuaWQmJnIuaXNEYXRhc2V0VmlzaWJsZShuKSl7dmFyIGM9TnVtYmVyKGwuZ2V0UmlnaHRWYWx1ZShhLmRhdGFbZV0pKTtjPDA/ZCs9Y3x8MDp1Kz1jfHwwfXZhciBoPU51bWJlcihsLmdldFJpZ2h0VmFsdWUodCkpO3JldHVybiBoPDA/bC5nZXRQaXhlbEZvclZhbHVlKGQraCk6bC5nZXRQaXhlbEZvclZhbHVlKHUraCl9cmV0dXJuIGwuZ2V0UGl4ZWxGb3JWYWx1ZSh0KX0sdXBkYXRlQmV6aWVyQ29udHJvbFBvaW50czpmdW5jdGlvbigpe3ZhciB0LGUsaSxuLGE9dGhpcy5nZXRNZXRhKCksbz10aGlzLmNoYXJ0LmNoYXJ0QXJlYSxyPWEuZGF0YXx8W107ZnVuY3Rpb24gcyh0LGUsaSl7cmV0dXJuIE1hdGgubWF4KE1hdGgubWluKHQsaSksZSl9aWYoYS5kYXRhc2V0Ll9tb2RlbC5zcGFuR2FwcyYmKHI9ci5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIXQuX21vZGVsLnNraXB9KSksXCJtb25vdG9uZVwiPT09YS5kYXRhc2V0Ll9tb2RlbC5jdWJpY0ludGVycG9sYXRpb25Nb2RlKWcuc3BsaW5lQ3VydmVNb25vdG9uZShyKTtlbHNlIGZvcih0PTAsZT1yLmxlbmd0aDt0PGU7Kyt0KWk9clt0XS5fbW9kZWwsbj1nLnNwbGluZUN1cnZlKGcucHJldmlvdXNJdGVtKHIsdCkuX21vZGVsLGksZy5uZXh0SXRlbShyLHQpLl9tb2RlbCxhLmRhdGFzZXQuX21vZGVsLnRlbnNpb24pLGkuY29udHJvbFBvaW50UHJldmlvdXNYPW4ucHJldmlvdXMueCxpLmNvbnRyb2xQb2ludFByZXZpb3VzWT1uLnByZXZpb3VzLnksaS5jb250cm9sUG9pbnROZXh0WD1uLm5leHQueCxpLmNvbnRyb2xQb2ludE5leHRZPW4ubmV4dC55O2lmKHRoaXMuY2hhcnQub3B0aW9ucy5lbGVtZW50cy5saW5lLmNhcEJlemllclBvaW50cylmb3IodD0wLGU9ci5sZW5ndGg7dDxlOysrdCkoaT1yW3RdLl9tb2RlbCkuY29udHJvbFBvaW50UHJldmlvdXNYPXMoaS5jb250cm9sUG9pbnRQcmV2aW91c1gsby5sZWZ0LG8ucmlnaHQpLGkuY29udHJvbFBvaW50UHJldmlvdXNZPXMoaS5jb250cm9sUG9pbnRQcmV2aW91c1ksby50b3Asby5ib3R0b20pLGkuY29udHJvbFBvaW50TmV4dFg9cyhpLmNvbnRyb2xQb2ludE5leHRYLG8ubGVmdCxvLnJpZ2h0KSxpLmNvbnRyb2xQb2ludE5leHRZPXMoaS5jb250cm9sUG9pbnROZXh0WSxvLnRvcCxvLmJvdHRvbSl9LGRyYXc6ZnVuY3Rpb24oKXt2YXIgdCxlPXRoaXMuY2hhcnQsaT10aGlzLmdldE1ldGEoKSxuPWkuZGF0YXx8W10sYT1lLmNoYXJ0QXJlYSxvPW4ubGVuZ3RoLHI9MDtmb3IoZih0aGlzLmdldERhdGFzZXQoKSxlLm9wdGlvbnMpJiYodD0oaS5kYXRhc2V0Ll9tb2RlbC5ib3JkZXJXaWR0aHx8MCkvMixnLmNhbnZhcy5jbGlwQXJlYShlLmN0eCx7bGVmdDphLmxlZnQscmlnaHQ6YS5yaWdodCx0b3A6YS50b3AtdCxib3R0b206YS5ib3R0b20rdH0pLGkuZGF0YXNldC5kcmF3KCksZy5jYW52YXMudW5jbGlwQXJlYShlLmN0eCkpO3I8bzsrK3IpbltyXS5kcmF3KGEpfSxzZXRIb3ZlclN0eWxlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuY2hhcnQuZGF0YS5kYXRhc2V0c1t0Ll9kYXRhc2V0SW5kZXhdLGk9dC5faW5kZXgsbj10LmN1c3RvbXx8e30sYT10Ll9tb2RlbDt0LiRwcmV2aW91c1N0eWxlPXtiYWNrZ3JvdW5kQ29sb3I6YS5iYWNrZ3JvdW5kQ29sb3IsYm9yZGVyQ29sb3I6YS5ib3JkZXJDb2xvcixib3JkZXJXaWR0aDphLmJvcmRlcldpZHRoLHJhZGl1czphLnJhZGl1c30sYS5iYWNrZ3JvdW5kQ29sb3I9bi5ob3ZlckJhY2tncm91bmRDb2xvcnx8Zy52YWx1ZUF0SW5kZXhPckRlZmF1bHQoZS5wb2ludEhvdmVyQmFja2dyb3VuZENvbG9yLGksZy5nZXRIb3ZlckNvbG9yKGEuYmFja2dyb3VuZENvbG9yKSksYS5ib3JkZXJDb2xvcj1uLmhvdmVyQm9yZGVyQ29sb3J8fGcudmFsdWVBdEluZGV4T3JEZWZhdWx0KGUucG9pbnRIb3ZlckJvcmRlckNvbG9yLGksZy5nZXRIb3ZlckNvbG9yKGEuYm9yZGVyQ29sb3IpKSxhLmJvcmRlcldpZHRoPW4uaG92ZXJCb3JkZXJXaWR0aHx8Zy52YWx1ZUF0SW5kZXhPckRlZmF1bHQoZS5wb2ludEhvdmVyQm9yZGVyV2lkdGgsaSxhLmJvcmRlcldpZHRoKSxhLnJhZGl1cz1uLmhvdmVyUmFkaXVzfHxnLnZhbHVlQXRJbmRleE9yRGVmYXVsdChlLnBvaW50SG92ZXJSYWRpdXMsaSx0aGlzLmNoYXJ0Lm9wdGlvbnMuZWxlbWVudHMucG9pbnQuaG92ZXJSYWRpdXMpfX0pfX0sezI2OjI2LDQxOjQxLDQ2OjQ2fV0sMTk6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjt2YXIgbj10KDI2KSxhPXQoNDEpLGs9dCg0Nik7bi5fc2V0KFwicG9sYXJBcmVhXCIse3NjYWxlOnt0eXBlOlwicmFkaWFsTGluZWFyXCIsYW5nbGVMaW5lczp7ZGlzcGxheTohMX0sZ3JpZExpbmVzOntjaXJjdWxhcjohMH0scG9pbnRMYWJlbHM6e2Rpc3BsYXk6ITF9LHRpY2tzOntiZWdpbkF0WmVybzohMH19LGFuaW1hdGlvbjp7YW5pbWF0ZVJvdGF0ZTohMCxhbmltYXRlU2NhbGU6ITB9LHN0YXJ0QW5nbGU6LS41Kk1hdGguUEksbGVnZW5kQ2FsbGJhY2s6ZnVuY3Rpb24odCl7dmFyIGU9W107ZS5wdXNoKCc8dWwgY2xhc3M9XCInK3QuaWQrJy1sZWdlbmRcIj4nKTt2YXIgaT10LmRhdGEsbj1pLmRhdGFzZXRzLGE9aS5sYWJlbHM7aWYobi5sZW5ndGgpZm9yKHZhciBvPTA7bzxuWzBdLmRhdGEubGVuZ3RoOysrbyllLnB1c2goJzxsaT48c3BhbiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6JytuWzBdLmJhY2tncm91bmRDb2xvcltvXSsnXCI+PC9zcGFuPicpLGFbb10mJmUucHVzaChhW29dKSxlLnB1c2goXCI8L2xpPlwiKTtyZXR1cm4gZS5wdXNoKFwiPC91bD5cIiksZS5qb2luKFwiXCIpfSxsZWdlbmQ6e2xhYmVsczp7Z2VuZXJhdGVMYWJlbHM6ZnVuY3Rpb24ocyl7dmFyIGw9cy5kYXRhO3JldHVybiBsLmxhYmVscy5sZW5ndGgmJmwuZGF0YXNldHMubGVuZ3RoP2wubGFiZWxzLm1hcChmdW5jdGlvbih0LGUpe3ZhciBpPXMuZ2V0RGF0YXNldE1ldGEoMCksbj1sLmRhdGFzZXRzWzBdLGE9aS5kYXRhW2VdLmN1c3RvbXx8e30sbz1rLnZhbHVlQXRJbmRleE9yRGVmYXVsdCxyPXMub3B0aW9ucy5lbGVtZW50cy5hcmM7cmV0dXJue3RleHQ6dCxmaWxsU3R5bGU6YS5iYWNrZ3JvdW5kQ29sb3I/YS5iYWNrZ3JvdW5kQ29sb3I6byhuLmJhY2tncm91bmRDb2xvcixlLHIuYmFja2dyb3VuZENvbG9yKSxzdHJva2VTdHlsZTphLmJvcmRlckNvbG9yP2EuYm9yZGVyQ29sb3I6byhuLmJvcmRlckNvbG9yLGUsci5ib3JkZXJDb2xvciksbGluZVdpZHRoOmEuYm9yZGVyV2lkdGg/YS5ib3JkZXJXaWR0aDpvKG4uYm9yZGVyV2lkdGgsZSxyLmJvcmRlcldpZHRoKSxoaWRkZW46aXNOYU4obi5kYXRhW2VdKXx8aS5kYXRhW2VdLmhpZGRlbixpbmRleDplfX0pOltdfX0sb25DbGljazpmdW5jdGlvbih0LGUpe3ZhciBpLG4sYSxvPWUuaW5kZXgscj10aGlzLmNoYXJ0O2ZvcihpPTAsbj0oci5kYXRhLmRhdGFzZXRzfHxbXSkubGVuZ3RoO2k8bjsrK2kpKGE9ci5nZXREYXRhc2V0TWV0YShpKSkuZGF0YVtvXS5oaWRkZW49IWEuZGF0YVtvXS5oaWRkZW47ci51cGRhdGUoKX19LHRvb2x0aXBzOntjYWxsYmFja3M6e3RpdGxlOmZ1bmN0aW9uKCl7cmV0dXJuXCJcIn0sbGFiZWw6ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5sYWJlbHNbdC5pbmRleF0rXCI6IFwiK3QueUxhYmVsfX19fSksZS5leHBvcnRzPWZ1bmN0aW9uKHQpe3QuY29udHJvbGxlcnMucG9sYXJBcmVhPXQuRGF0YXNldENvbnRyb2xsZXIuZXh0ZW5kKHtkYXRhRWxlbWVudFR5cGU6YS5BcmMsbGlua1NjYWxlczprLm5vb3AsdXBkYXRlOmZ1bmN0aW9uKGkpe3ZhciB0LGUsbixhPXRoaXMsbz1hLmdldERhdGFzZXQoKSxyPWEuZ2V0TWV0YSgpLHM9YS5jaGFydC5vcHRpb25zLnN0YXJ0QW5nbGV8fDAsbD1hLl9zdGFydHM9W10sdT1hLl9hbmdsZXM9W107Zm9yKGEuX3VwZGF0ZVJhZGl1cygpLHIuY291bnQ9YS5jb3VudFZpc2libGVFbGVtZW50cygpLHQ9MCxlPW8uZGF0YS5sZW5ndGg7dDxlO3QrKylsW3RdPXMsbj1hLl9jb21wdXRlQW5nbGUodCkscys9dVt0XT1uO2suZWFjaChyLmRhdGEsZnVuY3Rpb24odCxlKXthLnVwZGF0ZUVsZW1lbnQodCxlLGkpfSl9LF91cGRhdGVSYWRpdXM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLGU9dC5jaGFydCxpPWUuY2hhcnRBcmVhLG49ZS5vcHRpb25zLGE9bi5lbGVtZW50cy5hcmMsbz1NYXRoLm1pbihpLnJpZ2h0LWkubGVmdCxpLmJvdHRvbS1pLnRvcCk7ZS5vdXRlclJhZGl1cz1NYXRoLm1heCgoby1hLmJvcmRlcldpZHRoLzIpLzIsMCksZS5pbm5lclJhZGl1cz1NYXRoLm1heChuLmN1dG91dFBlcmNlbnRhZ2U/ZS5vdXRlclJhZGl1cy8xMDAqbi5jdXRvdXRQZXJjZW50YWdlOjEsMCksZS5yYWRpdXNMZW5ndGg9KGUub3V0ZXJSYWRpdXMtZS5pbm5lclJhZGl1cykvZS5nZXRWaXNpYmxlRGF0YXNldENvdW50KCksdC5vdXRlclJhZGl1cz1lLm91dGVyUmFkaXVzLWUucmFkaXVzTGVuZ3RoKnQuaW5kZXgsdC5pbm5lclJhZGl1cz10Lm91dGVyUmFkaXVzLWUucmFkaXVzTGVuZ3RofSx1cGRhdGVFbGVtZW50OmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10aGlzLGE9bi5jaGFydCxvPW4uZ2V0RGF0YXNldCgpLHI9YS5vcHRpb25zLHM9ci5hbmltYXRpb24sbD1hLnNjYWxlLHU9YS5kYXRhLmxhYmVscyxkPWwueENlbnRlcixjPWwueUNlbnRlcixoPXIuc3RhcnRBbmdsZSxmPXQuaGlkZGVuPzA6bC5nZXREaXN0YW5jZUZyb21DZW50ZXJGb3JWYWx1ZShvLmRhdGFbZV0pLGc9bi5fc3RhcnRzW2VdLHA9ZysodC5oaWRkZW4/MDpuLl9hbmdsZXNbZV0pLG09cy5hbmltYXRlU2NhbGU/MDpsLmdldERpc3RhbmNlRnJvbUNlbnRlckZvclZhbHVlKG8uZGF0YVtlXSk7ay5leHRlbmQodCx7X2RhdGFzZXRJbmRleDpuLmluZGV4LF9pbmRleDplLF9zY2FsZTpsLF9tb2RlbDp7eDpkLHk6Yyxpbm5lclJhZGl1czowLG91dGVyUmFkaXVzOmk/bTpmLHN0YXJ0QW5nbGU6aSYmcy5hbmltYXRlUm90YXRlP2g6ZyxlbmRBbmdsZTppJiZzLmFuaW1hdGVSb3RhdGU/aDpwLGxhYmVsOmsudmFsdWVBdEluZGV4T3JEZWZhdWx0KHUsZSx1W2VdKX19KTt2YXIgdj10aGlzLmNoYXJ0Lm9wdGlvbnMuZWxlbWVudHMuYXJjLGI9dC5jdXN0b218fHt9LHg9ay52YWx1ZUF0SW5kZXhPckRlZmF1bHQseT10Ll9tb2RlbDt5LmJhY2tncm91bmRDb2xvcj1iLmJhY2tncm91bmRDb2xvcj9iLmJhY2tncm91bmRDb2xvcjp4KG8uYmFja2dyb3VuZENvbG9yLGUsdi5iYWNrZ3JvdW5kQ29sb3IpLHkuYm9yZGVyQ29sb3I9Yi5ib3JkZXJDb2xvcj9iLmJvcmRlckNvbG9yOngoby5ib3JkZXJDb2xvcixlLHYuYm9yZGVyQ29sb3IpLHkuYm9yZGVyV2lkdGg9Yi5ib3JkZXJXaWR0aD9iLmJvcmRlcldpZHRoOngoby5ib3JkZXJXaWR0aCxlLHYuYm9yZGVyV2lkdGgpLHQucGl2b3QoKX0sY291bnRWaXNpYmxlRWxlbWVudHM6ZnVuY3Rpb24oKXt2YXIgaT10aGlzLmdldERhdGFzZXQoKSx0PXRoaXMuZ2V0TWV0YSgpLG49MDtyZXR1cm4gay5lYWNoKHQuZGF0YSxmdW5jdGlvbih0LGUpe2lzTmFOKGkuZGF0YVtlXSl8fHQuaGlkZGVufHxuKyt9KSxufSxfY29tcHV0ZUFuZ2xlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMsaT10aGlzLmdldE1ldGEoKS5jb3VudCxuPWUuZ2V0RGF0YXNldCgpLGE9ZS5nZXRNZXRhKCk7aWYoaXNOYU4obi5kYXRhW3RdKXx8YS5kYXRhW3RdLmhpZGRlbilyZXR1cm4gMDt2YXIgbz17Y2hhcnQ6ZS5jaGFydCxkYXRhSW5kZXg6dCxkYXRhc2V0Om4sZGF0YXNldEluZGV4OmUuaW5kZXh9O3JldHVybiBrLm9wdGlvbnMucmVzb2x2ZShbZS5jaGFydC5vcHRpb25zLmVsZW1lbnRzLmFyYy5hbmdsZSwyKk1hdGguUEkvaV0sbyx0KX19KX19LHsyNjoyNiw0MTo0MSw0Njo0Nn1dLDIwOltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49dCgyNiksYT10KDQxKSx1PXQoNDYpO24uX3NldChcInJhZGFyXCIse3NjYWxlOnt0eXBlOlwicmFkaWFsTGluZWFyXCJ9LGVsZW1lbnRzOntsaW5lOnt0ZW5zaW9uOjB9fX0pLGUuZXhwb3J0cz1mdW5jdGlvbih0KXt0LmNvbnRyb2xsZXJzLnJhZGFyPXQuRGF0YXNldENvbnRyb2xsZXIuZXh0ZW5kKHtkYXRhc2V0RWxlbWVudFR5cGU6YS5MaW5lLGRhdGFFbGVtZW50VHlwZTphLlBvaW50LGxpbmtTY2FsZXM6dS5ub29wLHVwZGF0ZTpmdW5jdGlvbihpKXt2YXIgbj10aGlzLHQ9bi5nZXRNZXRhKCksZT10LmRhdGFzZXQsYT10LmRhdGEsbz1lLmN1c3RvbXx8e30scj1uLmdldERhdGFzZXQoKSxzPW4uY2hhcnQub3B0aW9ucy5lbGVtZW50cy5saW5lLGw9bi5jaGFydC5zY2FsZTt2b2lkIDAhPT1yLnRlbnNpb24mJnZvaWQgMD09PXIubGluZVRlbnNpb24mJihyLmxpbmVUZW5zaW9uPXIudGVuc2lvbiksdS5leHRlbmQodC5kYXRhc2V0LHtfZGF0YXNldEluZGV4Om4uaW5kZXgsX3NjYWxlOmwsX2NoaWxkcmVuOmEsX2xvb3A6ITAsX21vZGVsOnt0ZW5zaW9uOm8udGVuc2lvbj9vLnRlbnNpb246dS52YWx1ZU9yRGVmYXVsdChyLmxpbmVUZW5zaW9uLHMudGVuc2lvbiksYmFja2dyb3VuZENvbG9yOm8uYmFja2dyb3VuZENvbG9yP28uYmFja2dyb3VuZENvbG9yOnIuYmFja2dyb3VuZENvbG9yfHxzLmJhY2tncm91bmRDb2xvcixib3JkZXJXaWR0aDpvLmJvcmRlcldpZHRoP28uYm9yZGVyV2lkdGg6ci5ib3JkZXJXaWR0aHx8cy5ib3JkZXJXaWR0aCxib3JkZXJDb2xvcjpvLmJvcmRlckNvbG9yP28uYm9yZGVyQ29sb3I6ci5ib3JkZXJDb2xvcnx8cy5ib3JkZXJDb2xvcixmaWxsOm8uZmlsbD9vLmZpbGw6dm9pZCAwIT09ci5maWxsP3IuZmlsbDpzLmZpbGwsYm9yZGVyQ2FwU3R5bGU6by5ib3JkZXJDYXBTdHlsZT9vLmJvcmRlckNhcFN0eWxlOnIuYm9yZGVyQ2FwU3R5bGV8fHMuYm9yZGVyQ2FwU3R5bGUsYm9yZGVyRGFzaDpvLmJvcmRlckRhc2g/by5ib3JkZXJEYXNoOnIuYm9yZGVyRGFzaHx8cy5ib3JkZXJEYXNoLGJvcmRlckRhc2hPZmZzZXQ6by5ib3JkZXJEYXNoT2Zmc2V0P28uYm9yZGVyRGFzaE9mZnNldDpyLmJvcmRlckRhc2hPZmZzZXR8fHMuYm9yZGVyRGFzaE9mZnNldCxib3JkZXJKb2luU3R5bGU6by5ib3JkZXJKb2luU3R5bGU/by5ib3JkZXJKb2luU3R5bGU6ci5ib3JkZXJKb2luU3R5bGV8fHMuYm9yZGVySm9pblN0eWxlfX0pLHQuZGF0YXNldC5waXZvdCgpLHUuZWFjaChhLGZ1bmN0aW9uKHQsZSl7bi51cGRhdGVFbGVtZW50KHQsZSxpKX0sbiksbi51cGRhdGVCZXppZXJDb250cm9sUG9pbnRzKCl9LHVwZGF0ZUVsZW1lbnQ6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMsYT10LmN1c3RvbXx8e30sbz1uLmdldERhdGFzZXQoKSxyPW4uY2hhcnQuc2NhbGUscz1uLmNoYXJ0Lm9wdGlvbnMuZWxlbWVudHMucG9pbnQsbD1yLmdldFBvaW50UG9zaXRpb25Gb3JWYWx1ZShlLG8uZGF0YVtlXSk7dm9pZCAwIT09by5yYWRpdXMmJnZvaWQgMD09PW8ucG9pbnRSYWRpdXMmJihvLnBvaW50UmFkaXVzPW8ucmFkaXVzKSx2b2lkIDAhPT1vLmhpdFJhZGl1cyYmdm9pZCAwPT09by5wb2ludEhpdFJhZGl1cyYmKG8ucG9pbnRIaXRSYWRpdXM9by5oaXRSYWRpdXMpLHUuZXh0ZW5kKHQse19kYXRhc2V0SW5kZXg6bi5pbmRleCxfaW5kZXg6ZSxfc2NhbGU6cixfbW9kZWw6e3g6aT9yLnhDZW50ZXI6bC54LHk6aT9yLnlDZW50ZXI6bC55LHRlbnNpb246YS50ZW5zaW9uP2EudGVuc2lvbjp1LnZhbHVlT3JEZWZhdWx0KG8ubGluZVRlbnNpb24sbi5jaGFydC5vcHRpb25zLmVsZW1lbnRzLmxpbmUudGVuc2lvbikscmFkaXVzOmEucmFkaXVzP2EucmFkaXVzOnUudmFsdWVBdEluZGV4T3JEZWZhdWx0KG8ucG9pbnRSYWRpdXMsZSxzLnJhZGl1cyksYmFja2dyb3VuZENvbG9yOmEuYmFja2dyb3VuZENvbG9yP2EuYmFja2dyb3VuZENvbG9yOnUudmFsdWVBdEluZGV4T3JEZWZhdWx0KG8ucG9pbnRCYWNrZ3JvdW5kQ29sb3IsZSxzLmJhY2tncm91bmRDb2xvciksYm9yZGVyQ29sb3I6YS5ib3JkZXJDb2xvcj9hLmJvcmRlckNvbG9yOnUudmFsdWVBdEluZGV4T3JEZWZhdWx0KG8ucG9pbnRCb3JkZXJDb2xvcixlLHMuYm9yZGVyQ29sb3IpLGJvcmRlcldpZHRoOmEuYm9yZGVyV2lkdGg/YS5ib3JkZXJXaWR0aDp1LnZhbHVlQXRJbmRleE9yRGVmYXVsdChvLnBvaW50Qm9yZGVyV2lkdGgsZSxzLmJvcmRlcldpZHRoKSxwb2ludFN0eWxlOmEucG9pbnRTdHlsZT9hLnBvaW50U3R5bGU6dS52YWx1ZUF0SW5kZXhPckRlZmF1bHQoby5wb2ludFN0eWxlLGUscy5wb2ludFN0eWxlKSxyb3RhdGlvbjphLnJvdGF0aW9uP2Eucm90YXRpb246dS52YWx1ZUF0SW5kZXhPckRlZmF1bHQoby5wb2ludFJvdGF0aW9uLGUscy5yb3RhdGlvbiksaGl0UmFkaXVzOmEuaGl0UmFkaXVzP2EuaGl0UmFkaXVzOnUudmFsdWVBdEluZGV4T3JEZWZhdWx0KG8ucG9pbnRIaXRSYWRpdXMsZSxzLmhpdFJhZGl1cyl9fSksdC5fbW9kZWwuc2tpcD1hLnNraXA/YS5za2lwOmlzTmFOKHQuX21vZGVsLngpfHxpc05hTih0Ll9tb2RlbC55KX0sdXBkYXRlQmV6aWVyQ29udHJvbFBvaW50czpmdW5jdGlvbigpe3ZhciBhPXRoaXMuY2hhcnQuY2hhcnRBcmVhLG89dGhpcy5nZXRNZXRhKCk7dS5lYWNoKG8uZGF0YSxmdW5jdGlvbih0LGUpe3ZhciBpPXQuX21vZGVsLG49dS5zcGxpbmVDdXJ2ZSh1LnByZXZpb3VzSXRlbShvLmRhdGEsZSwhMCkuX21vZGVsLGksdS5uZXh0SXRlbShvLmRhdGEsZSwhMCkuX21vZGVsLGkudGVuc2lvbik7aS5jb250cm9sUG9pbnRQcmV2aW91c1g9TWF0aC5tYXgoTWF0aC5taW4obi5wcmV2aW91cy54LGEucmlnaHQpLGEubGVmdCksaS5jb250cm9sUG9pbnRQcmV2aW91c1k9TWF0aC5tYXgoTWF0aC5taW4obi5wcmV2aW91cy55LGEuYm90dG9tKSxhLnRvcCksaS5jb250cm9sUG9pbnROZXh0WD1NYXRoLm1heChNYXRoLm1pbihuLm5leHQueCxhLnJpZ2h0KSxhLmxlZnQpLGkuY29udHJvbFBvaW50TmV4dFk9TWF0aC5tYXgoTWF0aC5taW4obi5uZXh0LnksYS5ib3R0b20pLGEudG9wKSx0LnBpdm90KCl9KX0sc2V0SG92ZXJTdHlsZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmNoYXJ0LmRhdGEuZGF0YXNldHNbdC5fZGF0YXNldEluZGV4XSxpPXQuY3VzdG9tfHx7fSxuPXQuX2luZGV4LGE9dC5fbW9kZWw7dC4kcHJldmlvdXNTdHlsZT17YmFja2dyb3VuZENvbG9yOmEuYmFja2dyb3VuZENvbG9yLGJvcmRlckNvbG9yOmEuYm9yZGVyQ29sb3IsYm9yZGVyV2lkdGg6YS5ib3JkZXJXaWR0aCxyYWRpdXM6YS5yYWRpdXN9LGEucmFkaXVzPWkuaG92ZXJSYWRpdXM/aS5ob3ZlclJhZGl1czp1LnZhbHVlQXRJbmRleE9yRGVmYXVsdChlLnBvaW50SG92ZXJSYWRpdXMsbix0aGlzLmNoYXJ0Lm9wdGlvbnMuZWxlbWVudHMucG9pbnQuaG92ZXJSYWRpdXMpLGEuYmFja2dyb3VuZENvbG9yPWkuaG92ZXJCYWNrZ3JvdW5kQ29sb3I/aS5ob3ZlckJhY2tncm91bmRDb2xvcjp1LnZhbHVlQXRJbmRleE9yRGVmYXVsdChlLnBvaW50SG92ZXJCYWNrZ3JvdW5kQ29sb3Isbix1LmdldEhvdmVyQ29sb3IoYS5iYWNrZ3JvdW5kQ29sb3IpKSxhLmJvcmRlckNvbG9yPWkuaG92ZXJCb3JkZXJDb2xvcj9pLmhvdmVyQm9yZGVyQ29sb3I6dS52YWx1ZUF0SW5kZXhPckRlZmF1bHQoZS5wb2ludEhvdmVyQm9yZGVyQ29sb3Isbix1LmdldEhvdmVyQ29sb3IoYS5ib3JkZXJDb2xvcikpLGEuYm9yZGVyV2lkdGg9aS5ob3ZlckJvcmRlcldpZHRoP2kuaG92ZXJCb3JkZXJXaWR0aDp1LnZhbHVlQXRJbmRleE9yRGVmYXVsdChlLnBvaW50SG92ZXJCb3JkZXJXaWR0aCxuLGEuYm9yZGVyV2lkdGgpfX0pfX0sezI2OjI2LDQxOjQxLDQ2OjQ2fV0sMjE6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjt0KDI2KS5fc2V0KFwic2NhdHRlclwiLHtob3Zlcjp7bW9kZTpcInNpbmdsZVwifSxzY2FsZXM6e3hBeGVzOlt7aWQ6XCJ4LWF4aXMtMVwiLHR5cGU6XCJsaW5lYXJcIixwb3NpdGlvbjpcImJvdHRvbVwifV0seUF4ZXM6W3tpZDpcInktYXhpcy0xXCIsdHlwZTpcImxpbmVhclwiLHBvc2l0aW9uOlwibGVmdFwifV19LHNob3dMaW5lczohMSx0b29sdGlwczp7Y2FsbGJhY2tzOnt0aXRsZTpmdW5jdGlvbigpe3JldHVyblwiXCJ9LGxhYmVsOmZ1bmN0aW9uKHQpe3JldHVyblwiKFwiK3QueExhYmVsK1wiLCBcIit0LnlMYWJlbCtcIilcIn19fX0pLGUuZXhwb3J0cz1mdW5jdGlvbih0KXt0LmNvbnRyb2xsZXJzLnNjYXR0ZXI9dC5jb250cm9sbGVycy5saW5lfX0sezI2OjI2fV0sMjI6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjt2YXIgbj10KDI3KTtpPWUuZXhwb3J0cz1uLmV4dGVuZCh7Y2hhcnQ6bnVsbCxjdXJyZW50U3RlcDowLG51bVN0ZXBzOjYwLGVhc2luZzpcIlwiLHJlbmRlcjpudWxsLG9uQW5pbWF0aW9uUHJvZ3Jlc3M6bnVsbCxvbkFuaW1hdGlvbkNvbXBsZXRlOm51bGx9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkoaS5wcm90b3R5cGUsXCJhbmltYXRpb25PYmplY3RcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGkucHJvdG90eXBlLFwiY2hhcnRJbnN0YW5jZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jaGFydH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuY2hhcnQ9dH19KX0sezI3OjI3fV0sMjM6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjt2YXIgbj10KDI2KSxvPXQoNDYpO24uX3NldChcImdsb2JhbFwiLHthbmltYXRpb246e2R1cmF0aW9uOjFlMyxlYXNpbmc6XCJlYXNlT3V0UXVhcnRcIixvblByb2dyZXNzOm8ubm9vcCxvbkNvbXBsZXRlOm8ubm9vcH19KSxlLmV4cG9ydHM9e2ZyYW1lRHVyYXRpb246MTcsYW5pbWF0aW9uczpbXSxkcm9wRnJhbWVzOjAscmVxdWVzdDpudWxsLGFkZEFuaW1hdGlvbjpmdW5jdGlvbih0LGUsaSxuKXt2YXIgYSxvLHI9dGhpcy5hbmltYXRpb25zO2ZvcihlLmNoYXJ0PXQsbnx8KHQuYW5pbWF0aW5nPSEwKSxhPTAsbz1yLmxlbmd0aDthPG87KythKWlmKHJbYV0uY2hhcnQ9PT10KXJldHVybiB2b2lkKHJbYV09ZSk7ci5wdXNoKGUpLDE9PT1yLmxlbmd0aCYmdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKX0sY2FuY2VsQW5pbWF0aW9uOmZ1bmN0aW9uKGUpe3ZhciB0PW8uZmluZEluZGV4KHRoaXMuYW5pbWF0aW9ucyxmdW5jdGlvbih0KXtyZXR1cm4gdC5jaGFydD09PWV9KTstMSE9PXQmJih0aGlzLmFuaW1hdGlvbnMuc3BsaWNlKHQsMSksZS5hbmltYXRpbmc9ITEpfSxyZXF1ZXN0QW5pbWF0aW9uRnJhbWU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzO251bGw9PT10LnJlcXVlc3QmJih0LnJlcXVlc3Q9by5yZXF1ZXN0QW5pbUZyYW1lLmNhbGwod2luZG93LGZ1bmN0aW9uKCl7dC5yZXF1ZXN0PW51bGwsdC5zdGFydERpZ2VzdCgpfSkpfSxzdGFydERpZ2VzdDpmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT1EYXRlLm5vdygpLGk9MDsxPHQuZHJvcEZyYW1lcyYmKGk9TWF0aC5mbG9vcih0LmRyb3BGcmFtZXMpLHQuZHJvcEZyYW1lcz10LmRyb3BGcmFtZXMlMSksdC5hZHZhbmNlKDEraSk7dmFyIG49RGF0ZS5ub3coKTt0LmRyb3BGcmFtZXMrPShuLWUpL3QuZnJhbWVEdXJhdGlvbiwwPHQuYW5pbWF0aW9ucy5sZW5ndGgmJnQucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCl9LGFkdmFuY2U6ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGksbj10aGlzLmFuaW1hdGlvbnMsYT0wO2E8bi5sZW5ndGg7KWk9KGU9blthXSkuY2hhcnQsZS5jdXJyZW50U3RlcD0oZS5jdXJyZW50U3RlcHx8MCkrdCxlLmN1cnJlbnRTdGVwPU1hdGgubWluKGUuY3VycmVudFN0ZXAsZS5udW1TdGVwcyksby5jYWxsYmFjayhlLnJlbmRlcixbaSxlXSxpKSxvLmNhbGxiYWNrKGUub25BbmltYXRpb25Qcm9ncmVzcyxbZV0saSksZS5jdXJyZW50U3RlcD49ZS5udW1TdGVwcz8oby5jYWxsYmFjayhlLm9uQW5pbWF0aW9uQ29tcGxldGUsW2VdLGkpLGkuYW5pbWF0aW5nPSExLG4uc3BsaWNlKGEsMSkpOisrYX19fSx7MjY6MjYsNDY6NDZ9XSwyNDpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBzPXQoMjIpLGw9dCgyMyksYz10KDI2KSxoPXQoNDYpLGE9dCgyOSksbz10KDMxKSxmPXQoNDkpLGc9dCgzMikscD10KDM0KSxuPXQoMzYpO2UuZXhwb3J0cz1mdW5jdGlvbih1KXtmdW5jdGlvbiBkKHQpe3JldHVyblwidG9wXCI9PT10fHxcImJvdHRvbVwiPT09dH11LnR5cGVzPXt9LHUuaW5zdGFuY2VzPXt9LHUuY29udHJvbGxlcnM9e30saC5leHRlbmQodS5wcm90b3R5cGUse2NvbnN0cnVjdDpmdW5jdGlvbih0LGUpe3ZhciBpLG4sYT10aGlzOyhuPShpPShpPWUpfHx7fSkuZGF0YT1pLmRhdGF8fHt9KS5kYXRhc2V0cz1uLmRhdGFzZXRzfHxbXSxuLmxhYmVscz1uLmxhYmVsc3x8W10saS5vcHRpb25zPWguY29uZmlnTWVyZ2UoYy5nbG9iYWwsY1tpLnR5cGVdLGkub3B0aW9uc3x8e30pLGU9aTt2YXIgbz1mLmFjcXVpcmVDb250ZXh0KHQsZSkscj1vJiZvLmNhbnZhcyxzPXImJnIuaGVpZ2h0LGw9ciYmci53aWR0aDthLmlkPWgudWlkKCksYS5jdHg9byxhLmNhbnZhcz1yLGEuY29uZmlnPWUsYS53aWR0aD1sLGEuaGVpZ2h0PXMsYS5hc3BlY3RSYXRpbz1zP2wvczpudWxsLGEub3B0aW9ucz1lLm9wdGlvbnMsYS5fYnVmZmVyZWRSZW5kZXI9ITEsKGEuY2hhcnQ9YSkuY29udHJvbGxlcj1hLHUuaW5zdGFuY2VzW2EuaWRdPWEsT2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJkYXRhXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBhLmNvbmZpZy5kYXRhfSxzZXQ6ZnVuY3Rpb24odCl7YS5jb25maWcuZGF0YT10fX0pLG8mJnI/KGEuaW5pdGlhbGl6ZSgpLGEudXBkYXRlKCkpOmNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gY3JlYXRlIGNoYXJ0OiBjYW4ndCBhY3F1aXJlIGNvbnRleHQgZnJvbSB0aGUgZ2l2ZW4gaXRlbVwiKX0saW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXM7cmV0dXJuIGcubm90aWZ5KHQsXCJiZWZvcmVJbml0XCIpLGgucmV0aW5hU2NhbGUodCx0Lm9wdGlvbnMuZGV2aWNlUGl4ZWxSYXRpbyksdC5iaW5kRXZlbnRzKCksdC5vcHRpb25zLnJlc3BvbnNpdmUmJnQucmVzaXplKCEwKSx0LmVuc3VyZVNjYWxlc0hhdmVJRHMoKSx0LmJ1aWxkT3JVcGRhdGVTY2FsZXMoKSx0LmluaXRUb29sVGlwKCksZy5ub3RpZnkodCxcImFmdGVySW5pdFwiKSx0fSxjbGVhcjpmdW5jdGlvbigpe3JldHVybiBoLmNhbnZhcy5jbGVhcih0aGlzKSx0aGlzfSxzdG9wOmZ1bmN0aW9uKCl7cmV0dXJuIGwuY2FuY2VsQW5pbWF0aW9uKHRoaXMpLHRoaXN9LHJlc2l6ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLGk9ZS5vcHRpb25zLG49ZS5jYW52YXMsYT1pLm1haW50YWluQXNwZWN0UmF0aW8mJmUuYXNwZWN0UmF0aW98fG51bGwsbz1NYXRoLm1heCgwLE1hdGguZmxvb3IoaC5nZXRNYXhpbXVtV2lkdGgobikpKSxyPU1hdGgubWF4KDAsTWF0aC5mbG9vcihhP28vYTpoLmdldE1heGltdW1IZWlnaHQobikpKTtpZigoZS53aWR0aCE9PW98fGUuaGVpZ2h0IT09cikmJihuLndpZHRoPWUud2lkdGg9byxuLmhlaWdodD1lLmhlaWdodD1yLG4uc3R5bGUud2lkdGg9bytcInB4XCIsbi5zdHlsZS5oZWlnaHQ9citcInB4XCIsaC5yZXRpbmFTY2FsZShlLGkuZGV2aWNlUGl4ZWxSYXRpbyksIXQpKXt2YXIgcz17d2lkdGg6byxoZWlnaHQ6cn07Zy5ub3RpZnkoZSxcInJlc2l6ZVwiLFtzXSksZS5vcHRpb25zLm9uUmVzaXplJiZlLm9wdGlvbnMub25SZXNpemUoZSxzKSxlLnN0b3AoKSxlLnVwZGF0ZSh7ZHVyYXRpb246ZS5vcHRpb25zLnJlc3BvbnNpdmVBbmltYXRpb25EdXJhdGlvbn0pfX0sZW5zdXJlU2NhbGVzSGF2ZUlEczpmdW5jdGlvbigpe3ZhciB0PXRoaXMub3B0aW9ucyxlPXQuc2NhbGVzfHx7fSxpPXQuc2NhbGU7aC5lYWNoKGUueEF4ZXMsZnVuY3Rpb24odCxlKXt0LmlkPXQuaWR8fFwieC1heGlzLVwiK2V9KSxoLmVhY2goZS55QXhlcyxmdW5jdGlvbih0LGUpe3QuaWQ9dC5pZHx8XCJ5LWF4aXMtXCIrZX0pLGkmJihpLmlkPWkuaWR8fFwic2NhbGVcIil9LGJ1aWxkT3JVcGRhdGVTY2FsZXM6ZnVuY3Rpb24oKXt2YXIgcj10aGlzLHQ9ci5vcHRpb25zLHM9ci5zY2FsZXN8fHt9LGU9W10sbD1PYmplY3Qua2V5cyhzKS5yZWR1Y2UoZnVuY3Rpb24odCxlKXtyZXR1cm4gdFtlXT0hMSx0fSx7fSk7dC5zY2FsZXMmJihlPWUuY29uY2F0KCh0LnNjYWxlcy54QXhlc3x8W10pLm1hcChmdW5jdGlvbih0KXtyZXR1cm57b3B0aW9uczp0LGR0eXBlOlwiY2F0ZWdvcnlcIixkcG9zaXRpb246XCJib3R0b21cIn19KSwodC5zY2FsZXMueUF4ZXN8fFtdKS5tYXAoZnVuY3Rpb24odCl7cmV0dXJue29wdGlvbnM6dCxkdHlwZTpcImxpbmVhclwiLGRwb3NpdGlvbjpcImxlZnRcIn19KSkpLHQuc2NhbGUmJmUucHVzaCh7b3B0aW9uczp0LnNjYWxlLGR0eXBlOlwicmFkaWFsTGluZWFyXCIsaXNEZWZhdWx0OiEwLGRwb3NpdGlvbjpcImNoYXJ0QXJlYVwifSksaC5lYWNoKGUsZnVuY3Rpb24odCl7dmFyIGU9dC5vcHRpb25zLGk9ZS5pZCxuPWgudmFsdWVPckRlZmF1bHQoZS50eXBlLHQuZHR5cGUpO2QoZS5wb3NpdGlvbikhPT1kKHQuZHBvc2l0aW9uKSYmKGUucG9zaXRpb249dC5kcG9zaXRpb24pLGxbaV09ITA7dmFyIGE9bnVsbDtpZihpIGluIHMmJnNbaV0udHlwZT09PW4pKGE9c1tpXSkub3B0aW9ucz1lLGEuY3R4PXIuY3R4LGEuY2hhcnQ9cjtlbHNle3ZhciBvPXAuZ2V0U2NhbGVDb25zdHJ1Y3RvcihuKTtpZighbylyZXR1cm47YT1uZXcgbyh7aWQ6aSx0eXBlOm4sb3B0aW9uczplLGN0eDpyLmN0eCxjaGFydDpyfSksc1thLmlkXT1hfWEubWVyZ2VUaWNrc09wdGlvbnMoKSx0LmlzRGVmYXVsdCYmKHIuc2NhbGU9YSl9KSxoLmVhY2gobCxmdW5jdGlvbih0LGUpe3R8fGRlbGV0ZSBzW2VdfSksci5zY2FsZXM9cyxwLmFkZFNjYWxlc1RvTGF5b3V0KHRoaXMpfSxidWlsZE9yVXBkYXRlQ29udHJvbGxlcnM6ZnVuY3Rpb24oKXt2YXIgbz10aGlzLHI9W10scz1bXTtyZXR1cm4gaC5lYWNoKG8uZGF0YS5kYXRhc2V0cyxmdW5jdGlvbih0LGUpe3ZhciBpPW8uZ2V0RGF0YXNldE1ldGEoZSksbj10LnR5cGV8fG8uY29uZmlnLnR5cGU7aWYoaS50eXBlJiZpLnR5cGUhPT1uJiYoby5kZXN0cm95RGF0YXNldE1ldGEoZSksaT1vLmdldERhdGFzZXRNZXRhKGUpKSxpLnR5cGU9bixyLnB1c2goaS50eXBlKSxpLmNvbnRyb2xsZXIpaS5jb250cm9sbGVyLnVwZGF0ZUluZGV4KGUpLGkuY29udHJvbGxlci5saW5rU2NhbGVzKCk7ZWxzZXt2YXIgYT11LmNvbnRyb2xsZXJzW2kudHlwZV07aWYodm9pZCAwPT09YSl0aHJvdyBuZXcgRXJyb3IoJ1wiJytpLnR5cGUrJ1wiIGlzIG5vdCBhIGNoYXJ0IHR5cGUuJyk7aS5jb250cm9sbGVyPW5ldyBhKG8sZSkscy5wdXNoKGkuY29udHJvbGxlcil9fSxvKSxzfSxyZXNldEVsZW1lbnRzOmZ1bmN0aW9uKCl7dmFyIGk9dGhpcztoLmVhY2goaS5kYXRhLmRhdGFzZXRzLGZ1bmN0aW9uKHQsZSl7aS5nZXREYXRhc2V0TWV0YShlKS5jb250cm9sbGVyLnJlc2V0KCl9LGkpfSxyZXNldDpmdW5jdGlvbigpe3RoaXMucmVzZXRFbGVtZW50cygpLHRoaXMudG9vbHRpcC5pbml0aWFsaXplKCl9LHVwZGF0ZTpmdW5jdGlvbih0KXt2YXIgZSxpLG49dGhpcztpZih0JiZcIm9iamVjdFwiPT10eXBlb2YgdHx8KHQ9e2R1cmF0aW9uOnQsbGF6eTphcmd1bWVudHNbMV19KSxpPShlPW4pLm9wdGlvbnMsaC5lYWNoKGUuc2NhbGVzLGZ1bmN0aW9uKHQpe28ucmVtb3ZlQm94KGUsdCl9KSxpPWguY29uZmlnTWVyZ2UodS5kZWZhdWx0cy5nbG9iYWwsdS5kZWZhdWx0c1tlLmNvbmZpZy50eXBlXSxpKSxlLm9wdGlvbnM9ZS5jb25maWcub3B0aW9ucz1pLGUuZW5zdXJlU2NhbGVzSGF2ZUlEcygpLGUuYnVpbGRPclVwZGF0ZVNjYWxlcygpLGUudG9vbHRpcC5fb3B0aW9ucz1pLnRvb2x0aXBzLGUudG9vbHRpcC5pbml0aWFsaXplKCksZy5faW52YWxpZGF0ZShuKSwhMSE9PWcubm90aWZ5KG4sXCJiZWZvcmVVcGRhdGVcIikpe24udG9vbHRpcC5fZGF0YT1uLmRhdGE7dmFyIGE9bi5idWlsZE9yVXBkYXRlQ29udHJvbGxlcnMoKTtoLmVhY2gobi5kYXRhLmRhdGFzZXRzLGZ1bmN0aW9uKHQsZSl7bi5nZXREYXRhc2V0TWV0YShlKS5jb250cm9sbGVyLmJ1aWxkT3JVcGRhdGVFbGVtZW50cygpfSxuKSxuLnVwZGF0ZUxheW91dCgpLG4ub3B0aW9ucy5hbmltYXRpb24mJm4ub3B0aW9ucy5hbmltYXRpb24uZHVyYXRpb24mJmguZWFjaChhLGZ1bmN0aW9uKHQpe3QucmVzZXQoKX0pLG4udXBkYXRlRGF0YXNldHMoKSxuLnRvb2x0aXAuaW5pdGlhbGl6ZSgpLG4ubGFzdEFjdGl2ZT1bXSxnLm5vdGlmeShuLFwiYWZ0ZXJVcGRhdGVcIiksbi5fYnVmZmVyZWRSZW5kZXI/bi5fYnVmZmVyZWRSZXF1ZXN0PXtkdXJhdGlvbjp0LmR1cmF0aW9uLGVhc2luZzp0LmVhc2luZyxsYXp5OnQubGF6eX06bi5yZW5kZXIodCl9fSx1cGRhdGVMYXlvdXQ6ZnVuY3Rpb24oKXshMSE9PWcubm90aWZ5KHRoaXMsXCJiZWZvcmVMYXlvdXRcIikmJihvLnVwZGF0ZSh0aGlzLHRoaXMud2lkdGgsdGhpcy5oZWlnaHQpLGcubm90aWZ5KHRoaXMsXCJhZnRlclNjYWxlVXBkYXRlXCIpLGcubm90aWZ5KHRoaXMsXCJhZnRlckxheW91dFwiKSl9LHVwZGF0ZURhdGFzZXRzOmZ1bmN0aW9uKCl7aWYoITEhPT1nLm5vdGlmeSh0aGlzLFwiYmVmb3JlRGF0YXNldHNVcGRhdGVcIikpe2Zvcih2YXIgdD0wLGU9dGhpcy5kYXRhLmRhdGFzZXRzLmxlbmd0aDt0PGU7Kyt0KXRoaXMudXBkYXRlRGF0YXNldCh0KTtnLm5vdGlmeSh0aGlzLFwiYWZ0ZXJEYXRhc2V0c1VwZGF0ZVwiKX19LHVwZGF0ZURhdGFzZXQ6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXREYXRhc2V0TWV0YSh0KSxpPXttZXRhOmUsaW5kZXg6dH07ITEhPT1nLm5vdGlmeSh0aGlzLFwiYmVmb3JlRGF0YXNldFVwZGF0ZVwiLFtpXSkmJihlLmNvbnRyb2xsZXIudXBkYXRlKCksZy5ub3RpZnkodGhpcyxcImFmdGVyRGF0YXNldFVwZGF0ZVwiLFtpXSkpfSxyZW5kZXI6ZnVuY3Rpb24odCl7dmFyIGU9dGhpczt0JiZcIm9iamVjdFwiPT10eXBlb2YgdHx8KHQ9e2R1cmF0aW9uOnQsbGF6eTphcmd1bWVudHNbMV19KTt2YXIgaT10LmR1cmF0aW9uLG49dC5sYXp5O2lmKCExIT09Zy5ub3RpZnkoZSxcImJlZm9yZVJlbmRlclwiKSl7dmFyIGE9ZS5vcHRpb25zLmFuaW1hdGlvbixvPWZ1bmN0aW9uKHQpe2cubm90aWZ5KGUsXCJhZnRlclJlbmRlclwiKSxoLmNhbGxiYWNrKGEmJmEub25Db21wbGV0ZSxbdF0sZSl9O2lmKGEmJih2b2lkIDAhPT1pJiYwIT09aXx8dm9pZCAwPT09aSYmMCE9PWEuZHVyYXRpb24pKXt2YXIgcj1uZXcgcyh7bnVtU3RlcHM6KGl8fGEuZHVyYXRpb24pLzE2LjY2LGVhc2luZzp0LmVhc2luZ3x8YS5lYXNpbmcscmVuZGVyOmZ1bmN0aW9uKHQsZSl7dmFyIGk9aC5lYXNpbmcuZWZmZWN0c1tlLmVhc2luZ10sbj1lLmN1cnJlbnRTdGVwLGE9bi9lLm51bVN0ZXBzO3QuZHJhdyhpKGEpLGEsbil9LG9uQW5pbWF0aW9uUHJvZ3Jlc3M6YS5vblByb2dyZXNzLG9uQW5pbWF0aW9uQ29tcGxldGU6b30pO2wuYWRkQW5pbWF0aW9uKGUscixpLG4pfWVsc2UgZS5kcmF3KCksbyhuZXcgcyh7bnVtU3RlcHM6MCxjaGFydDplfSkpO3JldHVybiBlfX0sZHJhdzpmdW5jdGlvbih0KXt2YXIgZT10aGlzO2UuY2xlYXIoKSxoLmlzTnVsbE9yVW5kZWYodCkmJih0PTEpLGUudHJhbnNpdGlvbih0KSxlLndpZHRoPD0wfHxlLmhlaWdodDw9MHx8ITEhPT1nLm5vdGlmeShlLFwiYmVmb3JlRHJhd1wiLFt0XSkmJihoLmVhY2goZS5ib3hlcyxmdW5jdGlvbih0KXt0LmRyYXcoZS5jaGFydEFyZWEpfSxlKSxlLnNjYWxlJiZlLnNjYWxlLmRyYXcoKSxlLmRyYXdEYXRhc2V0cyh0KSxlLl9kcmF3VG9vbHRpcCh0KSxnLm5vdGlmeShlLFwiYWZ0ZXJEcmF3XCIsW3RdKSl9LHRyYW5zaXRpb246ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTAsaT0odGhpcy5kYXRhLmRhdGFzZXRzfHxbXSkubGVuZ3RoO2U8aTsrK2UpdGhpcy5pc0RhdGFzZXRWaXNpYmxlKGUpJiZ0aGlzLmdldERhdGFzZXRNZXRhKGUpLmNvbnRyb2xsZXIudHJhbnNpdGlvbih0KTt0aGlzLnRvb2x0aXAudHJhbnNpdGlvbih0KX0sZHJhd0RhdGFzZXRzOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXM7aWYoITEhPT1nLm5vdGlmeShlLFwiYmVmb3JlRGF0YXNldHNEcmF3XCIsW3RdKSl7Zm9yKHZhciBpPShlLmRhdGEuZGF0YXNldHN8fFtdKS5sZW5ndGgtMTswPD1pOy0taSllLmlzRGF0YXNldFZpc2libGUoaSkmJmUuZHJhd0RhdGFzZXQoaSx0KTtnLm5vdGlmeShlLFwiYWZ0ZXJEYXRhc2V0c0RyYXdcIixbdF0pfX0sZHJhd0RhdGFzZXQ6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldERhdGFzZXRNZXRhKHQpLG49e21ldGE6aSxpbmRleDp0LGVhc2luZ1ZhbHVlOmV9OyExIT09Zy5ub3RpZnkodGhpcyxcImJlZm9yZURhdGFzZXREcmF3XCIsW25dKSYmKGkuY29udHJvbGxlci5kcmF3KGUpLGcubm90aWZ5KHRoaXMsXCJhZnRlckRhdGFzZXREcmF3XCIsW25dKSl9LF9kcmF3VG9vbHRpcDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnRvb2x0aXAsaT17dG9vbHRpcDplLGVhc2luZ1ZhbHVlOnR9OyExIT09Zy5ub3RpZnkodGhpcyxcImJlZm9yZVRvb2x0aXBEcmF3XCIsW2ldKSYmKGUuZHJhdygpLGcubm90aWZ5KHRoaXMsXCJhZnRlclRvb2x0aXBEcmF3XCIsW2ldKSl9LGdldEVsZW1lbnRBdEV2ZW50OmZ1bmN0aW9uKHQpe3JldHVybiBhLm1vZGVzLnNpbmdsZSh0aGlzLHQpfSxnZXRFbGVtZW50c0F0RXZlbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIGEubW9kZXMubGFiZWwodGhpcyx0LHtpbnRlcnNlY3Q6ITB9KX0sZ2V0RWxlbWVudHNBdFhBeGlzOmZ1bmN0aW9uKHQpe3JldHVybiBhLm1vZGVzW1wieC1heGlzXCJdKHRoaXMsdCx7aW50ZXJzZWN0OiEwfSl9LGdldEVsZW1lbnRzQXRFdmVudEZvck1vZGU6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPWEubW9kZXNbZV07cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2Ygbj9uKHRoaXMsdCxpKTpbXX0sZ2V0RGF0YXNldEF0RXZlbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIGEubW9kZXMuZGF0YXNldCh0aGlzLHQse2ludGVyc2VjdDohMH0pfSxnZXREYXRhc2V0TWV0YTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmRhdGEuZGF0YXNldHNbdF07ZS5fbWV0YXx8KGUuX21ldGE9e30pO3ZhciBpPWUuX21ldGFbdGhpcy5pZF07cmV0dXJuIGl8fChpPWUuX21ldGFbdGhpcy5pZF09e3R5cGU6bnVsbCxkYXRhOltdLGRhdGFzZXQ6bnVsbCxjb250cm9sbGVyOm51bGwsaGlkZGVuOm51bGwseEF4aXNJRDpudWxsLHlBeGlzSUQ6bnVsbH0pLGl9LGdldFZpc2libGVEYXRhc2V0Q291bnQ6ZnVuY3Rpb24oKXtmb3IodmFyIHQ9MCxlPTAsaT10aGlzLmRhdGEuZGF0YXNldHMubGVuZ3RoO2U8aTsrK2UpdGhpcy5pc0RhdGFzZXRWaXNpYmxlKGUpJiZ0Kys7cmV0dXJuIHR9LGlzRGF0YXNldFZpc2libGU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXREYXRhc2V0TWV0YSh0KTtyZXR1cm5cImJvb2xlYW5cIj09dHlwZW9mIGUuaGlkZGVuPyFlLmhpZGRlbjohdGhpcy5kYXRhLmRhdGFzZXRzW3RdLmhpZGRlbn0sZ2VuZXJhdGVMZWdlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcHRpb25zLmxlZ2VuZENhbGxiYWNrKHRoaXMpfSxkZXN0cm95RGF0YXNldE1ldGE6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5pZCxpPXRoaXMuZGF0YS5kYXRhc2V0c1t0XSxuPWkuX21ldGEmJmkuX21ldGFbZV07biYmKG4uY29udHJvbGxlci5kZXN0cm95KCksZGVsZXRlIGkuX21ldGFbZV0pfSxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIHQsZSxpPXRoaXMsbj1pLmNhbnZhcztmb3IoaS5zdG9wKCksdD0wLGU9aS5kYXRhLmRhdGFzZXRzLmxlbmd0aDt0PGU7Kyt0KWkuZGVzdHJveURhdGFzZXRNZXRhKHQpO24mJihpLnVuYmluZEV2ZW50cygpLGguY2FudmFzLmNsZWFyKGkpLGYucmVsZWFzZUNvbnRleHQoaS5jdHgpLGkuY2FudmFzPW51bGwsaS5jdHg9bnVsbCksZy5ub3RpZnkoaSxcImRlc3Ryb3lcIiksZGVsZXRlIHUuaW5zdGFuY2VzW2kuaWRdfSx0b0Jhc2U2NEltYWdlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2FudmFzLnRvRGF0YVVSTC5hcHBseSh0aGlzLmNhbnZhcyxhcmd1bWVudHMpfSxpbml0VG9vbFRpcDpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dC50b29sdGlwPW5ldyBuKHtfY2hhcnQ6dCxfY2hhcnRJbnN0YW5jZTp0LF9kYXRhOnQuZGF0YSxfb3B0aW9uczp0Lm9wdGlvbnMudG9vbHRpcHN9LHQpfSxiaW5kRXZlbnRzOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyxpPWUuX2xpc3RlbmVycz17fSxuPWZ1bmN0aW9uKCl7ZS5ldmVudEhhbmRsZXIuYXBwbHkoZSxhcmd1bWVudHMpfTtoLmVhY2goZS5vcHRpb25zLmV2ZW50cyxmdW5jdGlvbih0KXtmLmFkZEV2ZW50TGlzdGVuZXIoZSx0LG4pLGlbdF09bn0pLGUub3B0aW9ucy5yZXNwb25zaXZlJiYobj1mdW5jdGlvbigpe2UucmVzaXplKCl9LGYuYWRkRXZlbnRMaXN0ZW5lcihlLFwicmVzaXplXCIsbiksaS5yZXNpemU9bil9LHVuYmluZEV2ZW50czpmdW5jdGlvbigpe3ZhciBpPXRoaXMsdD1pLl9saXN0ZW5lcnM7dCYmKGRlbGV0ZSBpLl9saXN0ZW5lcnMsaC5lYWNoKHQsZnVuY3Rpb24odCxlKXtmLnJlbW92ZUV2ZW50TGlzdGVuZXIoaSxlLHQpfSkpfSx1cGRhdGVIb3ZlclN0eWxlOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbixhLG8scj1pP1wic2V0SG92ZXJTdHlsZVwiOlwicmVtb3ZlSG92ZXJTdHlsZVwiO2ZvcihhPTAsbz10Lmxlbmd0aDthPG87KythKShuPXRbYV0pJiZ0aGlzLmdldERhdGFzZXRNZXRhKG4uX2RhdGFzZXRJbmRleCkuY29udHJvbGxlcltyXShuKX0sZXZlbnRIYW5kbGVyOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMsaT1lLnRvb2x0aXA7aWYoITEhPT1nLm5vdGlmeShlLFwiYmVmb3JlRXZlbnRcIixbdF0pKXtlLl9idWZmZXJlZFJlbmRlcj0hMCxlLl9idWZmZXJlZFJlcXVlc3Q9bnVsbDt2YXIgbj1lLmhhbmRsZUV2ZW50KHQpO2kmJihuPWkuX3N0YXJ0P2kuaGFuZGxlRXZlbnQodCk6bnxpLmhhbmRsZUV2ZW50KHQpKSxnLm5vdGlmeShlLFwiYWZ0ZXJFdmVudFwiLFt0XSk7dmFyIGE9ZS5fYnVmZmVyZWRSZXF1ZXN0O3JldHVybiBhP2UucmVuZGVyKGEpOm4mJiFlLmFuaW1hdGluZyYmKGUuc3RvcCgpLGUucmVuZGVyKHtkdXJhdGlvbjplLm9wdGlvbnMuaG92ZXIuYW5pbWF0aW9uRHVyYXRpb24sbGF6eTohMH0pKSxlLl9idWZmZXJlZFJlbmRlcj0hMSxlLl9idWZmZXJlZFJlcXVlc3Q9bnVsbCxlfX0saGFuZGxlRXZlbnQ6ZnVuY3Rpb24odCl7dmFyIGUsaT10aGlzLG49aS5vcHRpb25zfHx7fSxhPW4uaG92ZXI7cmV0dXJuIGkubGFzdEFjdGl2ZT1pLmxhc3RBY3RpdmV8fFtdLFwibW91c2VvdXRcIj09PXQudHlwZT9pLmFjdGl2ZT1bXTppLmFjdGl2ZT1pLmdldEVsZW1lbnRzQXRFdmVudEZvck1vZGUodCxhLm1vZGUsYSksaC5jYWxsYmFjayhuLm9uSG92ZXJ8fG4uaG92ZXIub25Ib3ZlcixbdC5uYXRpdmUsaS5hY3RpdmVdLGkpLFwibW91c2V1cFwiIT09dC50eXBlJiZcImNsaWNrXCIhPT10LnR5cGV8fG4ub25DbGljayYmbi5vbkNsaWNrLmNhbGwoaSx0Lm5hdGl2ZSxpLmFjdGl2ZSksaS5sYXN0QWN0aXZlLmxlbmd0aCYmaS51cGRhdGVIb3ZlclN0eWxlKGkubGFzdEFjdGl2ZSxhLm1vZGUsITEpLGkuYWN0aXZlLmxlbmd0aCYmYS5tb2RlJiZpLnVwZGF0ZUhvdmVyU3R5bGUoaS5hY3RpdmUsYS5tb2RlLCEwKSxlPSFoLmFycmF5RXF1YWxzKGkuYWN0aXZlLGkubGFzdEFjdGl2ZSksaS5sYXN0QWN0aXZlPWkuYWN0aXZlLGV9fSksdS5Db250cm9sbGVyPXV9fSx7MjI6MjIsMjM6MjMsMjY6MjYsMjk6MjksMzE6MzEsMzI6MzIsMzQ6MzQsMzY6MzYsNDY6NDYsNDk6NDl9XSwyNTpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBzPXQoNDYpO2UuZXhwb3J0cz1mdW5jdGlvbih0KXt2YXIgbz1bXCJwdXNoXCIsXCJwb3BcIixcInNoaWZ0XCIsXCJzcGxpY2VcIixcInVuc2hpZnRcIl07ZnVuY3Rpb24gcihlLHQpe3ZhciBpPWUuX2NoYXJ0anM7aWYoaSl7dmFyIG49aS5saXN0ZW5lcnMsYT1uLmluZGV4T2YodCk7LTEhPT1hJiZuLnNwbGljZShhLDEpLDA8bi5sZW5ndGh8fChvLmZvckVhY2goZnVuY3Rpb24odCl7ZGVsZXRlIGVbdF19KSxkZWxldGUgZS5fY2hhcnRqcyl9fXQuRGF0YXNldENvbnRyb2xsZXI9ZnVuY3Rpb24odCxlKXt0aGlzLmluaXRpYWxpemUodCxlKX0scy5leHRlbmQodC5EYXRhc2V0Q29udHJvbGxlci5wcm90b3R5cGUse2RhdGFzZXRFbGVtZW50VHlwZTpudWxsLGRhdGFFbGVtZW50VHlwZTpudWxsLGluaXRpYWxpemU6ZnVuY3Rpb24odCxlKXt0aGlzLmNoYXJ0PXQsdGhpcy5pbmRleD1lLHRoaXMubGlua1NjYWxlcygpLHRoaXMuYWRkRWxlbWVudHMoKX0sdXBkYXRlSW5kZXg6ZnVuY3Rpb24odCl7dGhpcy5pbmRleD10fSxsaW5rU2NhbGVzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxlPXQuZ2V0TWV0YSgpLGk9dC5nZXREYXRhc2V0KCk7bnVsbCE9PWUueEF4aXNJRCYmZS54QXhpc0lEIGluIHQuY2hhcnQuc2NhbGVzfHwoZS54QXhpc0lEPWkueEF4aXNJRHx8dC5jaGFydC5vcHRpb25zLnNjYWxlcy54QXhlc1swXS5pZCksbnVsbCE9PWUueUF4aXNJRCYmZS55QXhpc0lEIGluIHQuY2hhcnQuc2NhbGVzfHwoZS55QXhpc0lEPWkueUF4aXNJRHx8dC5jaGFydC5vcHRpb25zLnNjYWxlcy55QXhlc1swXS5pZCl9LGdldERhdGFzZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jaGFydC5kYXRhLmRhdGFzZXRzW3RoaXMuaW5kZXhdfSxnZXRNZXRhOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2hhcnQuZ2V0RGF0YXNldE1ldGEodGhpcy5pbmRleCl9LGdldFNjYWxlRm9ySWQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY2hhcnQuc2NhbGVzW3RdfSxyZXNldDpmdW5jdGlvbigpe3RoaXMudXBkYXRlKCEwKX0sZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuX2RhdGEmJnIodGhpcy5fZGF0YSx0aGlzKX0sY3JlYXRlTWV0YURhdGFzZXQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmRhdGFzZXRFbGVtZW50VHlwZTtyZXR1cm4gdCYmbmV3IHQoe19jaGFydDp0aGlzLmNoYXJ0LF9kYXRhc2V0SW5kZXg6dGhpcy5pbmRleH0pfSxjcmVhdGVNZXRhRGF0YTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmRhdGFFbGVtZW50VHlwZTtyZXR1cm4gZSYmbmV3IGUoe19jaGFydDp0aGlzLmNoYXJ0LF9kYXRhc2V0SW5kZXg6dGhpcy5pbmRleCxfaW5kZXg6dH0pfSxhZGRFbGVtZW50czpmdW5jdGlvbigpe3ZhciB0LGUsaT10aGlzLmdldE1ldGEoKSxuPXRoaXMuZ2V0RGF0YXNldCgpLmRhdGF8fFtdLGE9aS5kYXRhO2Zvcih0PTAsZT1uLmxlbmd0aDt0PGU7Kyt0KWFbdF09YVt0XXx8dGhpcy5jcmVhdGVNZXRhRGF0YSh0KTtpLmRhdGFzZXQ9aS5kYXRhc2V0fHx0aGlzLmNyZWF0ZU1ldGFEYXRhc2V0KCl9LGFkZEVsZW1lbnRBbmRSZXNldDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmNyZWF0ZU1ldGFEYXRhKHQpO3RoaXMuZ2V0TWV0YSgpLmRhdGEuc3BsaWNlKHQsMCxlKSx0aGlzLnVwZGF0ZUVsZW1lbnQoZSx0LCEwKX0sYnVpbGRPclVwZGF0ZUVsZW1lbnRzOmZ1bmN0aW9uKCl7dmFyIGEsdCxlPXRoaXMsaT1lLmdldERhdGFzZXQoKSxuPWkuZGF0YXx8KGkuZGF0YT1bXSk7ZS5fZGF0YSE9PW4mJihlLl9kYXRhJiZyKGUuX2RhdGEsZSksdD1lLChhPW4pLl9jaGFydGpzP2EuX2NoYXJ0anMubGlzdGVuZXJzLnB1c2godCk6KE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLFwiX2NoYXJ0anNcIix7Y29uZmlndXJhYmxlOiEwLGVudW1lcmFibGU6ITEsdmFsdWU6e2xpc3RlbmVyczpbdF19fSksby5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBpPVwib25EYXRhXCIrdC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpLG49YVt0XTtPYmplY3QuZGVmaW5lUHJvcGVydHkoYSx0LHtjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMSx2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyksdD1uLmFwcGx5KHRoaXMsZSk7cmV0dXJuIHMuZWFjaChhLl9jaGFydGpzLmxpc3RlbmVycyxmdW5jdGlvbih0KXtcImZ1bmN0aW9uXCI9PXR5cGVvZiB0W2ldJiZ0W2ldLmFwcGx5KHQsZSl9KSx0fX0pfSkpLGUuX2RhdGE9biksZS5yZXN5bmNFbGVtZW50cygpfSx1cGRhdGU6cy5ub29wLHRyYW5zaXRpb246ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXRoaXMuZ2V0TWV0YSgpLGk9ZS5kYXRhfHxbXSxuPWkubGVuZ3RoLGE9MDthPG47KythKWlbYV0udHJhbnNpdGlvbih0KTtlLmRhdGFzZXQmJmUuZGF0YXNldC50cmFuc2l0aW9uKHQpfSxkcmF3OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5nZXRNZXRhKCksZT10LmRhdGF8fFtdLGk9ZS5sZW5ndGgsbj0wO2Zvcih0LmRhdGFzZXQmJnQuZGF0YXNldC5kcmF3KCk7bjxpOysrbillW25dLmRyYXcoKX0scmVtb3ZlSG92ZXJTdHlsZTpmdW5jdGlvbih0KXtzLm1lcmdlKHQuX21vZGVsLHQuJHByZXZpb3VzU3R5bGV8fHt9KSxkZWxldGUgdC4kcHJldmlvdXNTdHlsZX0sc2V0SG92ZXJTdHlsZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmNoYXJ0LmRhdGEuZGF0YXNldHNbdC5fZGF0YXNldEluZGV4XSxpPXQuX2luZGV4LG49dC5jdXN0b218fHt9LGE9cy52YWx1ZUF0SW5kZXhPckRlZmF1bHQsbz1zLmdldEhvdmVyQ29sb3Iscj10Ll9tb2RlbDt0LiRwcmV2aW91c1N0eWxlPXtiYWNrZ3JvdW5kQ29sb3I6ci5iYWNrZ3JvdW5kQ29sb3IsYm9yZGVyQ29sb3I6ci5ib3JkZXJDb2xvcixib3JkZXJXaWR0aDpyLmJvcmRlcldpZHRofSxyLmJhY2tncm91bmRDb2xvcj1uLmhvdmVyQmFja2dyb3VuZENvbG9yP24uaG92ZXJCYWNrZ3JvdW5kQ29sb3I6YShlLmhvdmVyQmFja2dyb3VuZENvbG9yLGksbyhyLmJhY2tncm91bmRDb2xvcikpLHIuYm9yZGVyQ29sb3I9bi5ob3ZlckJvcmRlckNvbG9yP24uaG92ZXJCb3JkZXJDb2xvcjphKGUuaG92ZXJCb3JkZXJDb2xvcixpLG8oci5ib3JkZXJDb2xvcikpLHIuYm9yZGVyV2lkdGg9bi5ob3ZlckJvcmRlcldpZHRoP24uaG92ZXJCb3JkZXJXaWR0aDphKGUuaG92ZXJCb3JkZXJXaWR0aCxpLHIuYm9yZGVyV2lkdGgpfSxyZXN5bmNFbGVtZW50czpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0TWV0YSgpLGU9dGhpcy5nZXREYXRhc2V0KCkuZGF0YSxpPXQuZGF0YS5sZW5ndGgsbj1lLmxlbmd0aDtuPGk/dC5kYXRhLnNwbGljZShuLGktbik6aTxuJiZ0aGlzLmluc2VydEVsZW1lbnRzKGksbi1pKX0saW5zZXJ0RWxlbWVudHM6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9MDtpPGU7KytpKXRoaXMuYWRkRWxlbWVudEFuZFJlc2V0KHQraSl9LG9uRGF0YVB1c2g6ZnVuY3Rpb24oKXt0aGlzLmluc2VydEVsZW1lbnRzKHRoaXMuZ2V0RGF0YXNldCgpLmRhdGEubGVuZ3RoLTEsYXJndW1lbnRzLmxlbmd0aCl9LG9uRGF0YVBvcDpmdW5jdGlvbigpe3RoaXMuZ2V0TWV0YSgpLmRhdGEucG9wKCl9LG9uRGF0YVNoaWZ0OmZ1bmN0aW9uKCl7dGhpcy5nZXRNZXRhKCkuZGF0YS5zaGlmdCgpfSxvbkRhdGFTcGxpY2U6ZnVuY3Rpb24odCxlKXt0aGlzLmdldE1ldGEoKS5kYXRhLnNwbGljZSh0LGUpLHRoaXMuaW5zZXJ0RWxlbWVudHModCxhcmd1bWVudHMubGVuZ3RoLTIpfSxvbkRhdGFVbnNoaWZ0OmZ1bmN0aW9uKCl7dGhpcy5pbnNlcnRFbGVtZW50cygwLGFyZ3VtZW50cy5sZW5ndGgpfX0pLHQuRGF0YXNldENvbnRyb2xsZXIuZXh0ZW5kPXMuaW5oZXJpdHN9fSx7NDY6NDZ9XSwyNjpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBuPXQoNDYpO2UuZXhwb3J0cz17X3NldDpmdW5jdGlvbih0LGUpe3JldHVybiBuLm1lcmdlKHRoaXNbdF18fCh0aGlzW3RdPXt9KSxlKX19fSx7NDY6NDZ9XSwyNzpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBnPXQoMyksbj10KDQ2KTt2YXIgYT1mdW5jdGlvbih0KXtuLmV4dGVuZCh0aGlzLHQpLHRoaXMuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O24uZXh0ZW5kKGEucHJvdG90eXBlLHtpbml0aWFsaXplOmZ1bmN0aW9uKCl7dGhpcy5oaWRkZW49ITF9LHBpdm90OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztyZXR1cm4gdC5fdmlld3x8KHQuX3ZpZXc9bi5jbG9uZSh0Ll9tb2RlbCkpLHQuX3N0YXJ0PXt9LHR9LHRyYW5zaXRpb246ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxpPWUuX21vZGVsLG49ZS5fc3RhcnQsYT1lLl92aWV3O3JldHVybiBpJiYxIT09dD8oYXx8KGE9ZS5fdmlldz17fSksbnx8KG49ZS5fc3RhcnQ9e30pLGZ1bmN0aW9uKHQsZSxpLG4pe3ZhciBhLG8scixzLGwsdSxkLGMsaCxmPU9iamVjdC5rZXlzKGkpO2ZvcihhPTAsbz1mLmxlbmd0aDthPG87KythKWlmKHU9aVtyPWZbYV1dLGUuaGFzT3duUHJvcGVydHkocil8fChlW3JdPXUpLChzPWVbcl0pIT09dSYmXCJfXCIhPT1yWzBdKXtpZih0Lmhhc093blByb3BlcnR5KHIpfHwodFtyXT1zKSwoZD10eXBlb2YgdSk9PXR5cGVvZihsPXRbcl0pKWlmKFwic3RyaW5nXCI9PT1kKXtpZigoYz1nKGwpKS52YWxpZCYmKGg9Zyh1KSkudmFsaWQpe2Vbcl09aC5taXgoYyxuKS5yZ2JTdHJpbmcoKTtjb250aW51ZX19ZWxzZSBpZihcIm51bWJlclwiPT09ZCYmaXNGaW5pdGUobCkmJmlzRmluaXRlKHUpKXtlW3JdPWwrKHUtbCkqbjtjb250aW51ZX1lW3JdPXV9fShuLGEsaSx0KSk6KGUuX3ZpZXc9aSxlLl9zdGFydD1udWxsKSxlfSx0b29sdGlwUG9zaXRpb246ZnVuY3Rpb24oKXtyZXR1cm57eDp0aGlzLl9tb2RlbC54LHk6dGhpcy5fbW9kZWwueX19LGhhc1ZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIG4uaXNOdW1iZXIodGhpcy5fbW9kZWwueCkmJm4uaXNOdW1iZXIodGhpcy5fbW9kZWwueSl9fSksYS5leHRlbmQ9bi5pbmhlcml0cyxlLmV4cG9ydHM9YX0sezM6Myw0Njo0Nn1dLDI4OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49dCgzKSxhPXQoMjYpLGc9dCg0NiksbD10KDM0KTtlLmV4cG9ydHM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBkKHQsZSxpKXt2YXIgbjtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgdD8obj1wYXJzZUludCh0LDEwKSwtMSE9PXQuaW5kZXhPZihcIiVcIikmJihuPW4vMTAwKmUucGFyZW50Tm9kZVtpXSkpOm49dCxufWZ1bmN0aW9uIGModCl7cmV0dXJuIG51bGwhPXQmJlwibm9uZVwiIT09dH1mdW5jdGlvbiBlKHQsZSxpKXt2YXIgbj1kb2N1bWVudC5kZWZhdWx0VmlldyxhPWcuX2dldFBhcmVudE5vZGUodCksbz1uLmdldENvbXB1dGVkU3R5bGUodClbZV0scj1uLmdldENvbXB1dGVkU3R5bGUoYSlbZV0scz1jKG8pLGw9YyhyKSx1PU51bWJlci5QT1NJVElWRV9JTkZJTklUWTtyZXR1cm4gc3x8bD9NYXRoLm1pbihzP2Qobyx0LGkpOnUsbD9kKHIsYSxpKTp1KTpcIm5vbmVcIn1nLmNvbmZpZ01lcmdlPWZ1bmN0aW9uKCl7cmV0dXJuIGcubWVyZ2UoZy5jbG9uZShhcmd1bWVudHNbMF0pLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLHttZXJnZXI6ZnVuY3Rpb24odCxlLGksbil7dmFyIGE9ZVt0XXx8e30sbz1pW3RdO1wic2NhbGVzXCI9PT10P2VbdF09Zy5zY2FsZU1lcmdlKGEsbyk6XCJzY2FsZVwiPT09dD9lW3RdPWcubWVyZ2UoYSxbbC5nZXRTY2FsZURlZmF1bHRzKG8udHlwZSksb10pOmcuX21lcmdlcih0LGUsaSxuKX19KX0sZy5zY2FsZU1lcmdlPWZ1bmN0aW9uKCl7cmV0dXJuIGcubWVyZ2UoZy5jbG9uZShhcmd1bWVudHNbMF0pLFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLHttZXJnZXI6ZnVuY3Rpb24odCxlLGksbil7aWYoXCJ4QXhlc1wiPT09dHx8XCJ5QXhlc1wiPT09dCl7dmFyIGEsbyxyLHM9aVt0XS5sZW5ndGg7Zm9yKGVbdF18fChlW3RdPVtdKSxhPTA7YTxzOysrYSlyPWlbdF1bYV0sbz1nLnZhbHVlT3JEZWZhdWx0KHIudHlwZSxcInhBeGVzXCI9PT10P1wiY2F0ZWdvcnlcIjpcImxpbmVhclwiKSxhPj1lW3RdLmxlbmd0aCYmZVt0XS5wdXNoKHt9KSwhZVt0XVthXS50eXBlfHxyLnR5cGUmJnIudHlwZSE9PWVbdF1bYV0udHlwZT9nLm1lcmdlKGVbdF1bYV0sW2wuZ2V0U2NhbGVEZWZhdWx0cyhvKSxyXSk6Zy5tZXJnZShlW3RdW2FdLHIpfWVsc2UgZy5fbWVyZ2VyKHQsZSxpLG4pfX0pfSxnLndoZXJlPWZ1bmN0aW9uKHQsZSl7aWYoZy5pc0FycmF5KHQpJiZBcnJheS5wcm90b3R5cGUuZmlsdGVyKXJldHVybiB0LmZpbHRlcihlKTt2YXIgaT1bXTtyZXR1cm4gZy5lYWNoKHQsZnVuY3Rpb24odCl7ZSh0KSYmaS5wdXNoKHQpfSksaX0sZy5maW5kSW5kZXg9QXJyYXkucHJvdG90eXBlLmZpbmRJbmRleD9mdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQuZmluZEluZGV4KGUsaSl9OmZ1bmN0aW9uKHQsZSxpKXtpPXZvaWQgMD09PWk/dDppO2Zvcih2YXIgbj0wLGE9dC5sZW5ndGg7bjxhOysrbilpZihlLmNhbGwoaSx0W25dLG4sdCkpcmV0dXJuIG47cmV0dXJuLTF9LGcuZmluZE5leHRXaGVyZT1mdW5jdGlvbih0LGUsaSl7Zy5pc051bGxPclVuZGVmKGkpJiYoaT0tMSk7Zm9yKHZhciBuPWkrMTtuPHQubGVuZ3RoO24rKyl7dmFyIGE9dFtuXTtpZihlKGEpKXJldHVybiBhfX0sZy5maW5kUHJldmlvdXNXaGVyZT1mdW5jdGlvbih0LGUsaSl7Zy5pc051bGxPclVuZGVmKGkpJiYoaT10Lmxlbmd0aCk7Zm9yKHZhciBuPWktMTswPD1uO24tLSl7dmFyIGE9dFtuXTtpZihlKGEpKXJldHVybiBhfX0sZy5pc051bWJlcj1mdW5jdGlvbih0KXtyZXR1cm4haXNOYU4ocGFyc2VGbG9hdCh0KSkmJmlzRmluaXRlKHQpfSxnLmFsbW9zdEVxdWFscz1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIE1hdGguYWJzKHQtZSk8aX0sZy5hbG1vc3RXaG9sZT1mdW5jdGlvbih0LGUpe3ZhciBpPU1hdGgucm91bmQodCk7cmV0dXJuIGktZTx0JiZ0PGkrZX0sZy5tYXg9ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVkdWNlKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIGlzTmFOKGUpP3Q6TWF0aC5tYXgodCxlKX0sTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZKX0sZy5taW49ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVkdWNlKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIGlzTmFOKGUpP3Q6TWF0aC5taW4odCxlKX0sTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKX0sZy5zaWduPU1hdGguc2lnbj9mdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5zaWduKHQpfTpmdW5jdGlvbih0KXtyZXR1cm4gMD09PSh0PSt0KXx8aXNOYU4odCk/dDowPHQ/MTotMX0sZy5sb2cxMD1NYXRoLmxvZzEwP2Z1bmN0aW9uKHQpe3JldHVybiBNYXRoLmxvZzEwKHQpfTpmdW5jdGlvbih0KXt2YXIgZT1NYXRoLmxvZyh0KSpNYXRoLkxPRzEwRSxpPU1hdGgucm91bmQoZSk7cmV0dXJuIHQ9PT1NYXRoLnBvdygxMCxpKT9pOmV9LGcudG9SYWRpYW5zPWZ1bmN0aW9uKHQpe3JldHVybiB0KihNYXRoLlBJLzE4MCl9LGcudG9EZWdyZWVzPWZ1bmN0aW9uKHQpe3JldHVybiB0KigxODAvTWF0aC5QSSl9LGcuZ2V0QW5nbGVGcm9tUG9pbnQ9ZnVuY3Rpb24odCxlKXt2YXIgaT1lLngtdC54LG49ZS55LXQueSxhPU1hdGguc3FydChpKmkrbipuKSxvPU1hdGguYXRhbjIobixpKTtyZXR1cm4gbzwtLjUqTWF0aC5QSSYmKG8rPTIqTWF0aC5QSSkse2FuZ2xlOm8sZGlzdGFuY2U6YX19LGcuZGlzdGFuY2VCZXR3ZWVuUG9pbnRzPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIE1hdGguc3FydChNYXRoLnBvdyhlLngtdC54LDIpK01hdGgucG93KGUueS10LnksMikpfSxnLmFsaWFzUGl4ZWw9ZnVuY3Rpb24odCl7cmV0dXJuIHQlMj09MD8wOi41fSxnLnNwbGluZUN1cnZlPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciBhPXQuc2tpcD9lOnQsbz1lLHI9aS5za2lwP2U6aSxzPU1hdGguc3FydChNYXRoLnBvdyhvLngtYS54LDIpK01hdGgucG93KG8ueS1hLnksMikpLGw9TWF0aC5zcXJ0KE1hdGgucG93KHIueC1vLngsMikrTWF0aC5wb3coci55LW8ueSwyKSksdT1zLyhzK2wpLGQ9bC8ocytsKSxjPW4qKHU9aXNOYU4odSk/MDp1KSxoPW4qKGQ9aXNOYU4oZCk/MDpkKTtyZXR1cm57cHJldmlvdXM6e3g6by54LWMqKHIueC1hLngpLHk6by55LWMqKHIueS1hLnkpfSxuZXh0Ont4Om8ueCtoKihyLngtYS54KSx5Om8ueStoKihyLnktYS55KX19fSxnLkVQU0lMT049TnVtYmVyLkVQU0lMT058fDFlLTE0LGcuc3BsaW5lQ3VydmVNb25vdG9uZT1mdW5jdGlvbih0KXt2YXIgZSxpLG4sYSxvLHIscyxsLHUsZD0odHx8W10pLm1hcChmdW5jdGlvbih0KXtyZXR1cm57bW9kZWw6dC5fbW9kZWwsZGVsdGFLOjAsbUs6MH19KSxjPWQubGVuZ3RoO2ZvcihlPTA7ZTxjOysrZSlpZighKG49ZFtlXSkubW9kZWwuc2tpcCl7aWYoaT0wPGU/ZFtlLTFdOm51bGwsKGE9ZTxjLTE/ZFtlKzFdOm51bGwpJiYhYS5tb2RlbC5za2lwKXt2YXIgaD1hLm1vZGVsLngtbi5tb2RlbC54O24uZGVsdGFLPTAhPT1oPyhhLm1vZGVsLnktbi5tb2RlbC55KS9oOjB9IWl8fGkubW9kZWwuc2tpcD9uLm1LPW4uZGVsdGFLOiFhfHxhLm1vZGVsLnNraXA/bi5tSz1pLmRlbHRhSzp0aGlzLnNpZ24oaS5kZWx0YUspIT09dGhpcy5zaWduKG4uZGVsdGFLKT9uLm1LPTA6bi5tSz0oaS5kZWx0YUsrbi5kZWx0YUspLzJ9Zm9yKGU9MDtlPGMtMTsrK2Upbj1kW2VdLGE9ZFtlKzFdLG4ubW9kZWwuc2tpcHx8YS5tb2RlbC5za2lwfHwoZy5hbG1vc3RFcXVhbHMobi5kZWx0YUssMCx0aGlzLkVQU0lMT04pP24ubUs9YS5tSz0wOihvPW4ubUsvbi5kZWx0YUsscj1hLm1LL24uZGVsdGFLLChsPU1hdGgucG93KG8sMikrTWF0aC5wb3cociwyKSk8PTl8fChzPTMvTWF0aC5zcXJ0KGwpLG4ubUs9bypzKm4uZGVsdGFLLGEubUs9cipzKm4uZGVsdGFLKSkpO2ZvcihlPTA7ZTxjOysrZSkobj1kW2VdKS5tb2RlbC5za2lwfHwoaT0wPGU/ZFtlLTFdOm51bGwsYT1lPGMtMT9kW2UrMV06bnVsbCxpJiYhaS5tb2RlbC5za2lwJiYodT0obi5tb2RlbC54LWkubW9kZWwueCkvMyxuLm1vZGVsLmNvbnRyb2xQb2ludFByZXZpb3VzWD1uLm1vZGVsLngtdSxuLm1vZGVsLmNvbnRyb2xQb2ludFByZXZpb3VzWT1uLm1vZGVsLnktdSpuLm1LKSxhJiYhYS5tb2RlbC5za2lwJiYodT0oYS5tb2RlbC54LW4ubW9kZWwueCkvMyxuLm1vZGVsLmNvbnRyb2xQb2ludE5leHRYPW4ubW9kZWwueCt1LG4ubW9kZWwuY29udHJvbFBvaW50TmV4dFk9bi5tb2RlbC55K3Uqbi5tSykpfSxnLm5leHRJdGVtPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gaT9lPj10Lmxlbmd0aC0xP3RbMF06dFtlKzFdOmU+PXQubGVuZ3RoLTE/dFt0Lmxlbmd0aC0xXTp0W2UrMV19LGcucHJldmlvdXNJdGVtPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gaT9lPD0wP3RbdC5sZW5ndGgtMV06dFtlLTFdOmU8PTA/dFswXTp0W2UtMV19LGcubmljZU51bT1mdW5jdGlvbih0LGUpe3ZhciBpPU1hdGguZmxvb3IoZy5sb2cxMCh0KSksbj10L01hdGgucG93KDEwLGkpO3JldHVybihlP248MS41PzE6bjwzPzI6bjw3PzU6MTA6bjw9MT8xOm48PTI/MjpuPD01PzU6MTApKk1hdGgucG93KDEwLGkpfSxnLnJlcXVlc3RBbmltRnJhbWU9XCJ1bmRlZmluZWRcIj09dHlwZW9mIHdpbmRvdz9mdW5jdGlvbih0KXt0KCl9OndpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fHdpbmRvdy5vUmVxdWVzdEFuaW1hdGlvbkZyYW1lfHx3aW5kb3cubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZ1bmN0aW9uKHQpe3JldHVybiB3aW5kb3cuc2V0VGltZW91dCh0LDFlMy82MCl9LGcuZ2V0UmVsYXRpdmVQb3NpdGlvbj1mdW5jdGlvbih0LGUpe3ZhciBpLG4sYT10Lm9yaWdpbmFsRXZlbnR8fHQsbz10LnRhcmdldHx8dC5zcmNFbGVtZW50LHI9by5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxzPWEudG91Y2hlcztuPXMmJjA8cy5sZW5ndGg/KGk9c1swXS5jbGllbnRYLHNbMF0uY2xpZW50WSk6KGk9YS5jbGllbnRYLGEuY2xpZW50WSk7dmFyIGw9cGFyc2VGbG9hdChnLmdldFN0eWxlKG8sXCJwYWRkaW5nLWxlZnRcIikpLHU9cGFyc2VGbG9hdChnLmdldFN0eWxlKG8sXCJwYWRkaW5nLXRvcFwiKSksZD1wYXJzZUZsb2F0KGcuZ2V0U3R5bGUobyxcInBhZGRpbmctcmlnaHRcIikpLGM9cGFyc2VGbG9hdChnLmdldFN0eWxlKG8sXCJwYWRkaW5nLWJvdHRvbVwiKSksaD1yLnJpZ2h0LXIubGVmdC1sLWQsZj1yLmJvdHRvbS1yLnRvcC11LWM7cmV0dXJue3g6aT1NYXRoLnJvdW5kKChpLXIubGVmdC1sKS9oKm8ud2lkdGgvZS5jdXJyZW50RGV2aWNlUGl4ZWxSYXRpbykseTpuPU1hdGgucm91bmQoKG4tci50b3AtdSkvZipvLmhlaWdodC9lLmN1cnJlbnREZXZpY2VQaXhlbFJhdGlvKX19LGcuZ2V0Q29uc3RyYWludFdpZHRoPWZ1bmN0aW9uKHQpe3JldHVybiBlKHQsXCJtYXgtd2lkdGhcIixcImNsaWVudFdpZHRoXCIpfSxnLmdldENvbnN0cmFpbnRIZWlnaHQ9ZnVuY3Rpb24odCl7cmV0dXJuIGUodCxcIm1heC1oZWlnaHRcIixcImNsaWVudEhlaWdodFwiKX0sZy5fY2FsY3VsYXRlUGFkZGluZz1mdW5jdGlvbih0LGUsaSl7cmV0dXJuLTE8KGU9Zy5nZXRTdHlsZSh0LGUpKS5pbmRleE9mKFwiJVwiKT9pL3BhcnNlSW50KGUsMTApOnBhcnNlSW50KGUsMTApfSxnLl9nZXRQYXJlbnROb2RlPWZ1bmN0aW9uKHQpe3ZhciBlPXQucGFyZW50Tm9kZTtyZXR1cm4gZSYmZS5ob3N0JiYoZT1lLmhvc3QpLGV9LGcuZ2V0TWF4aW11bVdpZHRoPWZ1bmN0aW9uKHQpe3ZhciBlPWcuX2dldFBhcmVudE5vZGUodCk7aWYoIWUpcmV0dXJuIHQuY2xpZW50V2lkdGg7dmFyIGk9ZS5jbGllbnRXaWR0aCxuPWktZy5fY2FsY3VsYXRlUGFkZGluZyhlLFwicGFkZGluZy1sZWZ0XCIsaSktZy5fY2FsY3VsYXRlUGFkZGluZyhlLFwicGFkZGluZy1yaWdodFwiLGkpLGE9Zy5nZXRDb25zdHJhaW50V2lkdGgodCk7cmV0dXJuIGlzTmFOKGEpP246TWF0aC5taW4obixhKX0sZy5nZXRNYXhpbXVtSGVpZ2h0PWZ1bmN0aW9uKHQpe3ZhciBlPWcuX2dldFBhcmVudE5vZGUodCk7aWYoIWUpcmV0dXJuIHQuY2xpZW50SGVpZ2h0O3ZhciBpPWUuY2xpZW50SGVpZ2h0LG49aS1nLl9jYWxjdWxhdGVQYWRkaW5nKGUsXCJwYWRkaW5nLXRvcFwiLGkpLWcuX2NhbGN1bGF0ZVBhZGRpbmcoZSxcInBhZGRpbmctYm90dG9tXCIsaSksYT1nLmdldENvbnN0cmFpbnRIZWlnaHQodCk7cmV0dXJuIGlzTmFOKGEpP246TWF0aC5taW4obixhKX0sZy5nZXRTdHlsZT1mdW5jdGlvbih0LGUpe3JldHVybiB0LmN1cnJlbnRTdHlsZT90LmN1cnJlbnRTdHlsZVtlXTpkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKHQsbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZShlKX0sZy5yZXRpbmFTY2FsZT1mdW5jdGlvbih0LGUpe3ZhciBpPXQuY3VycmVudERldmljZVBpeGVsUmF0aW89ZXx8XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdyYmd2luZG93LmRldmljZVBpeGVsUmF0aW98fDE7aWYoMSE9PWkpe3ZhciBuPXQuY2FudmFzLGE9dC5oZWlnaHQsbz10LndpZHRoO24uaGVpZ2h0PWEqaSxuLndpZHRoPW8qaSx0LmN0eC5zY2FsZShpLGkpLG4uc3R5bGUuaGVpZ2h0fHxuLnN0eWxlLndpZHRofHwobi5zdHlsZS5oZWlnaHQ9YStcInB4XCIsbi5zdHlsZS53aWR0aD1vK1wicHhcIil9fSxnLmZvbnRTdHJpbmc9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBlK1wiIFwiK3QrXCJweCBcIitpfSxnLmxvbmdlc3RUZXh0PWZ1bmN0aW9uKGUsdCxpLG4pe3ZhciBhPShuPW58fHt9KS5kYXRhPW4uZGF0YXx8e30sbz1uLmdhcmJhZ2VDb2xsZWN0PW4uZ2FyYmFnZUNvbGxlY3R8fFtdO24uZm9udCE9PXQmJihhPW4uZGF0YT17fSxvPW4uZ2FyYmFnZUNvbGxlY3Q9W10sbi5mb250PXQpLGUuZm9udD10O3ZhciByPTA7Zy5lYWNoKGksZnVuY3Rpb24odCl7bnVsbCE9dCYmITAhPT1nLmlzQXJyYXkodCk/cj1nLm1lYXN1cmVUZXh0KGUsYSxvLHIsdCk6Zy5pc0FycmF5KHQpJiZnLmVhY2godCxmdW5jdGlvbih0KXtudWxsPT10fHxnLmlzQXJyYXkodCl8fChyPWcubWVhc3VyZVRleHQoZSxhLG8scix0KSl9KX0pO3ZhciBzPW8ubGVuZ3RoLzI7aWYocz5pLmxlbmd0aCl7Zm9yKHZhciBsPTA7bDxzO2wrKylkZWxldGUgYVtvW2xdXTtvLnNwbGljZSgwLHMpfXJldHVybiByfSxnLm1lYXN1cmVUZXh0PWZ1bmN0aW9uKHQsZSxpLG4sYSl7dmFyIG89ZVthXTtyZXR1cm4gb3x8KG89ZVthXT10Lm1lYXN1cmVUZXh0KGEpLndpZHRoLGkucHVzaChhKSksbjxvJiYobj1vKSxufSxnLm51bWJlck9mTGFiZWxMaW5lcz1mdW5jdGlvbih0KXt2YXIgZT0xO3JldHVybiBnLmVhY2godCxmdW5jdGlvbih0KXtnLmlzQXJyYXkodCkmJnQubGVuZ3RoPmUmJihlPXQubGVuZ3RoKX0pLGV9LGcuY29sb3I9bj9mdW5jdGlvbih0KXtyZXR1cm4gdCBpbnN0YW5jZW9mIENhbnZhc0dyYWRpZW50JiYodD1hLmdsb2JhbC5kZWZhdWx0Q29sb3IpLG4odCl9OmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLmVycm9yKFwiQ29sb3IuanMgbm90IGZvdW5kIVwiKSx0fSxnLmdldEhvdmVyQ29sb3I9ZnVuY3Rpb24odCl7cmV0dXJuIHQgaW5zdGFuY2VvZiBDYW52YXNQYXR0ZXJuP3Q6Zy5jb2xvcih0KS5zYXR1cmF0ZSguNSkuZGFya2VuKC4xKS5yZ2JTdHJpbmcoKX19fSx7MjY6MjYsMzozLDM0OjM0LDQ2OjQ2fV0sMjk6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjt2YXIgbj10KDQ2KTtmdW5jdGlvbiBzKHQsZSl7cmV0dXJuIHQubmF0aXZlP3t4OnQueCx5OnQueX06bi5nZXRSZWxhdGl2ZVBvc2l0aW9uKHQsZSl9ZnVuY3Rpb24gbCh0LGUpe3ZhciBpLG4sYSxvLHI7Zm9yKG49MCxvPXQuZGF0YS5kYXRhc2V0cy5sZW5ndGg7bjxvOysrbilpZih0LmlzRGF0YXNldFZpc2libGUobikpZm9yKGE9MCxyPShpPXQuZ2V0RGF0YXNldE1ldGEobikpLmRhdGEubGVuZ3RoO2E8cjsrK2Epe3ZhciBzPWkuZGF0YVthXTtzLl92aWV3LnNraXB8fGUocyl9fWZ1bmN0aW9uIHUodCxlKXt2YXIgaT1bXTtyZXR1cm4gbCh0LGZ1bmN0aW9uKHQpe3QuaW5SYW5nZShlLngsZS55KSYmaS5wdXNoKHQpfSksaX1mdW5jdGlvbiBkKHQsbixhLG8pe3ZhciByPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSxzPVtdO3JldHVybiBsKHQsZnVuY3Rpb24odCl7aWYoIWF8fHQuaW5SYW5nZShuLngsbi55KSl7dmFyIGU9dC5nZXRDZW50ZXJQb2ludCgpLGk9byhuLGUpO2k8cj8ocz1bdF0scj1pKTppPT09ciYmcy5wdXNoKHQpfX0pLHN9ZnVuY3Rpb24gYyh0KXt2YXIgYT0tMSE9PXQuaW5kZXhPZihcInhcIiksbz0tMSE9PXQuaW5kZXhPZihcInlcIik7cmV0dXJuIGZ1bmN0aW9uKHQsZSl7dmFyIGk9YT9NYXRoLmFicyh0LngtZS54KTowLG49bz9NYXRoLmFicyh0LnktZS55KTowO3JldHVybiBNYXRoLnNxcnQoTWF0aC5wb3coaSwyKStNYXRoLnBvdyhuLDIpKX19ZnVuY3Rpb24gYShuLHQsZSl7dmFyIGk9cyh0LG4pO2UuYXhpcz1lLmF4aXN8fFwieFwiO3ZhciBhPWMoZS5heGlzKSxvPWUuaW50ZXJzZWN0P3UobixpKTpkKG4saSwhMSxhKSxyPVtdO3JldHVybiBvLmxlbmd0aD8obi5kYXRhLmRhdGFzZXRzLmZvckVhY2goZnVuY3Rpb24odCxlKXtpZihuLmlzRGF0YXNldFZpc2libGUoZSkpe3ZhciBpPW4uZ2V0RGF0YXNldE1ldGEoZSkuZGF0YVtvWzBdLl9pbmRleF07aSYmIWkuX3ZpZXcuc2tpcCYmci5wdXNoKGkpfX0pLHIpOltdfWUuZXhwb3J0cz17bW9kZXM6e3NpbmdsZTpmdW5jdGlvbih0LGUpe3ZhciBpPXMoZSx0KSxuPVtdO3JldHVybiBsKHQsZnVuY3Rpb24odCl7aWYodC5pblJhbmdlKGkueCxpLnkpKXJldHVybiBuLnB1c2godCksbn0pLG4uc2xpY2UoMCwxKX0sbGFiZWw6YSxpbmRleDphLGRhdGFzZXQ6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXMoZSx0KTtpLmF4aXM9aS5heGlzfHxcInh5XCI7dmFyIGE9YyhpLmF4aXMpLG89aS5pbnRlcnNlY3Q/dSh0LG4pOmQodCxuLCExLGEpO3JldHVybiAwPG8ubGVuZ3RoJiYobz10LmdldERhdGFzZXRNZXRhKG9bMF0uX2RhdGFzZXRJbmRleCkuZGF0YSksb30sXCJ4LWF4aXNcIjpmdW5jdGlvbih0LGUpe3JldHVybiBhKHQsZSx7aW50ZXJzZWN0OiExfSl9LHBvaW50OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHUodCxzKGUsdCkpfSxuZWFyZXN0OmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1zKGUsdCk7aS5heGlzPWkuYXhpc3x8XCJ4eVwiO3ZhciBhPWMoaS5heGlzKSxvPWQodCxuLGkuaW50ZXJzZWN0LGEpO3JldHVybiAxPG8ubGVuZ3RoJiZvLnNvcnQoZnVuY3Rpb24odCxlKXt2YXIgaT10LmdldEFyZWEoKS1lLmdldEFyZWEoKTtyZXR1cm4gMD09PWkmJihpPXQuX2RhdGFzZXRJbmRleC1lLl9kYXRhc2V0SW5kZXgpLGl9KSxvLnNsaWNlKDAsMSl9LHg6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXMoZSx0KSxhPVtdLG89ITE7cmV0dXJuIGwodCxmdW5jdGlvbih0KXt0LmluWFJhbmdlKG4ueCkmJmEucHVzaCh0KSx0LmluUmFuZ2Uobi54LG4ueSkmJihvPSEwKX0pLGkuaW50ZXJzZWN0JiYhbyYmKGE9W10pLGF9LHk6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXMoZSx0KSxhPVtdLG89ITE7cmV0dXJuIGwodCxmdW5jdGlvbih0KXt0LmluWVJhbmdlKG4ueSkmJmEucHVzaCh0KSx0LmluUmFuZ2Uobi54LG4ueSkmJihvPSEwKX0pLGkuaW50ZXJzZWN0JiYhbyYmKGE9W10pLGF9fX19LHs0Njo0Nn1dLDMwOltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dCgyNikuX3NldChcImdsb2JhbFwiLHtyZXNwb25zaXZlOiEwLHJlc3BvbnNpdmVBbmltYXRpb25EdXJhdGlvbjowLG1haW50YWluQXNwZWN0UmF0aW86ITAsZXZlbnRzOltcIm1vdXNlbW92ZVwiLFwibW91c2VvdXRcIixcImNsaWNrXCIsXCJ0b3VjaHN0YXJ0XCIsXCJ0b3VjaG1vdmVcIl0saG92ZXI6e29uSG92ZXI6bnVsbCxtb2RlOlwibmVhcmVzdFwiLGludGVyc2VjdDohMCxhbmltYXRpb25EdXJhdGlvbjo0MDB9LG9uQ2xpY2s6bnVsbCxkZWZhdWx0Q29sb3I6XCJyZ2JhKDAsMCwwLDAuMSlcIixkZWZhdWx0Rm9udENvbG9yOlwiIzY2NlwiLGRlZmF1bHRGb250RmFtaWx5OlwiJ0hlbHZldGljYSBOZXVlJywgJ0hlbHZldGljYScsICdBcmlhbCcsIHNhbnMtc2VyaWZcIixkZWZhdWx0Rm9udFNpemU6MTIsZGVmYXVsdEZvbnRTdHlsZTpcIm5vcm1hbFwiLHNob3dMaW5lczohMCxlbGVtZW50czp7fSxsYXlvdXQ6e3BhZGRpbmc6e3RvcDowLHJpZ2h0OjAsYm90dG9tOjAsbGVmdDowfX19KSxlLmV4cG9ydHM9ZnVuY3Rpb24oKXt2YXIgdD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmNvbnN0cnVjdCh0LGUpLHRoaXN9O3JldHVybiB0LkNoYXJ0PXR9fSx7MjY6MjZ9XSwzMTpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBCPXQoNDYpO2Z1bmN0aW9uIFcodCxlKXtyZXR1cm4gQi53aGVyZSh0LGZ1bmN0aW9uKHQpe3JldHVybiB0LnBvc2l0aW9uPT09ZX0pfWZ1bmN0aW9uIFYodCxhKXt0LmZvckVhY2goZnVuY3Rpb24odCxlKXtyZXR1cm4gdC5fdG1wSW5kZXhfPWUsdH0pLHQuc29ydChmdW5jdGlvbih0LGUpe3ZhciBpPWE/ZTp0LG49YT90OmU7cmV0dXJuIGkud2VpZ2h0PT09bi53ZWlnaHQ/aS5fdG1wSW5kZXhfLW4uX3RtcEluZGV4XzppLndlaWdodC1uLndlaWdodH0pLHQuZm9yRWFjaChmdW5jdGlvbih0KXtkZWxldGUgdC5fdG1wSW5kZXhffSl9ZS5leHBvcnRzPXtkZWZhdWx0czp7fSxhZGRCb3g6ZnVuY3Rpb24odCxlKXt0LmJveGVzfHwodC5ib3hlcz1bXSksZS5mdWxsV2lkdGg9ZS5mdWxsV2lkdGh8fCExLGUucG9zaXRpb249ZS5wb3NpdGlvbnx8XCJ0b3BcIixlLndlaWdodD1lLndlaWdodHx8MCx0LmJveGVzLnB1c2goZSl9LHJlbW92ZUJveDpmdW5jdGlvbih0LGUpe3ZhciBpPXQuYm94ZXM/dC5ib3hlcy5pbmRleE9mKGUpOi0xOy0xIT09aSYmdC5ib3hlcy5zcGxpY2UoaSwxKX0sY29uZmlndXJlOmZ1bmN0aW9uKHQsZSxpKXtmb3IodmFyIG4sYT1bXCJmdWxsV2lkdGhcIixcInBvc2l0aW9uXCIsXCJ3ZWlnaHRcIl0sbz1hLmxlbmd0aCxyPTA7cjxvOysrciluPWFbcl0saS5oYXNPd25Qcm9wZXJ0eShuKSYmKGVbbl09aVtuXSl9LHVwZGF0ZTpmdW5jdGlvbihlLGksdCl7aWYoZSl7dmFyIG49ZS5vcHRpb25zLmxheW91dHx8e30sYT1CLm9wdGlvbnMudG9QYWRkaW5nKG4ucGFkZGluZyksbz1hLmxlZnQscj1hLnJpZ2h0LHM9YS50b3AsbD1hLmJvdHRvbSx1PVcoZS5ib3hlcyxcImxlZnRcIiksZD1XKGUuYm94ZXMsXCJyaWdodFwiKSxjPVcoZS5ib3hlcyxcInRvcFwiKSxoPVcoZS5ib3hlcyxcImJvdHRvbVwiKSxmPVcoZS5ib3hlcyxcImNoYXJ0QXJlYVwiKTtWKHUsITApLFYoZCwhMSksVihjLCEwKSxWKGgsITEpO3ZhciBnPWktby1yLHA9dC1zLWwsbT1wLzIsdj0oaS1nLzIpLyh1Lmxlbmd0aCtkLmxlbmd0aCksYj0odC1tKS8oYy5sZW5ndGgraC5sZW5ndGgpLHg9Zyx5PXAsaz1bXTtCLmVhY2godS5jb25jYXQoZCxjLGgpLGZ1bmN0aW9uKHQpe3ZhciBlLGk9dC5pc0hvcml6b250YWwoKTtpPyhlPXQudXBkYXRlKHQuZnVsbFdpZHRoP2c6eCxiKSx5LT1lLmhlaWdodCk6KGU9dC51cGRhdGUodix5KSx4LT1lLndpZHRoKSxrLnB1c2goe2hvcml6b250YWw6aSxtaW5TaXplOmUsYm94OnR9KX0pO3ZhciBNPTAsdz0wLEM9MCxTPTA7Qi5lYWNoKGMuY29uY2F0KGgpLGZ1bmN0aW9uKHQpe2lmKHQuZ2V0UGFkZGluZyl7dmFyIGU9dC5nZXRQYWRkaW5nKCk7TT1NYXRoLm1heChNLGUubGVmdCksdz1NYXRoLm1heCh3LGUucmlnaHQpfX0pLEIuZWFjaCh1LmNvbmNhdChkKSxmdW5jdGlvbih0KXtpZih0LmdldFBhZGRpbmcpe3ZhciBlPXQuZ2V0UGFkZGluZygpO0M9TWF0aC5tYXgoQyxlLnRvcCksUz1NYXRoLm1heChTLGUuYm90dG9tKX19KTt2YXIgXz1vLEQ9cixQPXMsST1sO0IuZWFjaCh1LmNvbmNhdChkKSx6KSxCLmVhY2godSxmdW5jdGlvbih0KXtfKz10LndpZHRofSksQi5lYWNoKGQsZnVuY3Rpb24odCl7RCs9dC53aWR0aH0pLEIuZWFjaChjLmNvbmNhdChoKSx6KSxCLmVhY2goYyxmdW5jdGlvbih0KXtQKz10LmhlaWdodH0pLEIuZWFjaChoLGZ1bmN0aW9uKHQpe0krPXQuaGVpZ2h0fSksQi5lYWNoKHUuY29uY2F0KGQpLGZ1bmN0aW9uKGUpe3ZhciB0PUIuZmluZE5leHRXaGVyZShrLGZ1bmN0aW9uKHQpe3JldHVybiB0LmJveD09PWV9KSxpPXtsZWZ0OjAscmlnaHQ6MCx0b3A6UCxib3R0b206SX07dCYmZS51cGRhdGUodC5taW5TaXplLndpZHRoLHksaSl9KSxfPW8sRD1yLFA9cyxJPWwsQi5lYWNoKHUsZnVuY3Rpb24odCl7Xys9dC53aWR0aH0pLEIuZWFjaChkLGZ1bmN0aW9uKHQpe0QrPXQud2lkdGh9KSxCLmVhY2goYyxmdW5jdGlvbih0KXtQKz10LmhlaWdodH0pLEIuZWFjaChoLGZ1bmN0aW9uKHQpe0krPXQuaGVpZ2h0fSk7dmFyIEE9TWF0aC5tYXgoTS1fLDApO18rPUEsRCs9TWF0aC5tYXgody1ELDApO3ZhciBUPU1hdGgubWF4KEMtUCwwKTtQKz1ULEkrPU1hdGgubWF4KFMtSSwwKTt2YXIgRj10LVAtSSxPPWktXy1EO089PT14JiZGPT09eXx8KEIuZWFjaCh1LGZ1bmN0aW9uKHQpe3QuaGVpZ2h0PUZ9KSxCLmVhY2goZCxmdW5jdGlvbih0KXt0LmhlaWdodD1GfSksQi5lYWNoKGMsZnVuY3Rpb24odCl7dC5mdWxsV2lkdGh8fCh0LndpZHRoPU8pfSksQi5lYWNoKGgsZnVuY3Rpb24odCl7dC5mdWxsV2lkdGh8fCh0LndpZHRoPU8pfSkseT1GLHg9Tyk7dmFyIFI9bytBLEw9cytUO0IuZWFjaCh1LmNvbmNhdChjKSxOKSxSKz14LEwrPXksQi5lYWNoKGQsTiksQi5lYWNoKGgsTiksZS5jaGFydEFyZWE9e2xlZnQ6Xyx0b3A6UCxyaWdodDpfK3gsYm90dG9tOlAreX0sQi5lYWNoKGYsZnVuY3Rpb24odCl7dC5sZWZ0PWUuY2hhcnRBcmVhLmxlZnQsdC50b3A9ZS5jaGFydEFyZWEudG9wLHQucmlnaHQ9ZS5jaGFydEFyZWEucmlnaHQsdC5ib3R0b209ZS5jaGFydEFyZWEuYm90dG9tLHQudXBkYXRlKHgseSl9KX1mdW5jdGlvbiB6KGUpe3ZhciB0PUIuZmluZE5leHRXaGVyZShrLGZ1bmN0aW9uKHQpe3JldHVybiB0LmJveD09PWV9KTtpZih0KWlmKGUuaXNIb3Jpem9udGFsKCkpe3ZhciBpPXtsZWZ0Ok1hdGgubWF4KF8sTSkscmlnaHQ6TWF0aC5tYXgoRCx3KSx0b3A6MCxib3R0b206MH07ZS51cGRhdGUoZS5mdWxsV2lkdGg/Zzp4LHAvMixpKX1lbHNlIGUudXBkYXRlKHQubWluU2l6ZS53aWR0aCx5KX1mdW5jdGlvbiBOKHQpe3QuaXNIb3Jpem9udGFsKCk/KHQubGVmdD10LmZ1bGxXaWR0aD9vOl8sdC5yaWdodD10LmZ1bGxXaWR0aD9pLXI6Xyt4LHQudG9wPUwsdC5ib3R0b209TCt0LmhlaWdodCxMPXQuYm90dG9tKToodC5sZWZ0PVIsdC5yaWdodD1SK3Qud2lkdGgsdC50b3A9UCx0LmJvdHRvbT1QK3ksUj10LnJpZ2h0KX19fX0sezQ2OjQ2fV0sMzI6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjt2YXIgcj10KDI2KSxzPXQoNDYpO3IuX3NldChcImdsb2JhbFwiLHtwbHVnaW5zOnt9fSksZS5leHBvcnRzPXtfcGx1Z2luczpbXSxfY2FjaGVJZDowLHJlZ2lzdGVyOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX3BsdWdpbnM7W10uY29uY2F0KHQpLmZvckVhY2goZnVuY3Rpb24odCl7LTE9PT1lLmluZGV4T2YodCkmJmUucHVzaCh0KX0pLHRoaXMuX2NhY2hlSWQrK30sdW5yZWdpc3RlcjpmdW5jdGlvbih0KXt2YXIgaT10aGlzLl9wbHVnaW5zO1tdLmNvbmNhdCh0KS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlPWkuaW5kZXhPZih0KTstMSE9PWUmJmkuc3BsaWNlKGUsMSl9KSx0aGlzLl9jYWNoZUlkKyt9LGNsZWFyOmZ1bmN0aW9uKCl7dGhpcy5fcGx1Z2lucz1bXSx0aGlzLl9jYWNoZUlkKyt9LGNvdW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BsdWdpbnMubGVuZ3RofSxnZXRBbGw6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGx1Z2luc30sbm90aWZ5OmZ1bmN0aW9uKHQsZSxpKXt2YXIgbixhLG8scixzLGw9dGhpcy5kZXNjcmlwdG9ycyh0KSx1PWwubGVuZ3RoO2ZvcihuPTA7bjx1OysrbilpZihcImZ1bmN0aW9uXCI9PXR5cGVvZihzPShvPShhPWxbbl0pLnBsdWdpbilbZV0pJiYoKHI9W3RdLmNvbmNhdChpfHxbXSkpLnB1c2goYS5vcHRpb25zKSwhMT09PXMuYXBwbHkobyxyKSkpcmV0dXJuITE7cmV0dXJuITB9LGRlc2NyaXB0b3JzOmZ1bmN0aW9uKHQpe3ZhciBlPXQuJHBsdWdpbnN8fCh0LiRwbHVnaW5zPXt9KTtpZihlLmlkPT09dGhpcy5fY2FjaGVJZClyZXR1cm4gZS5kZXNjcmlwdG9yczt2YXIgbj1bXSxhPVtdLGk9dCYmdC5jb25maWd8fHt9LG89aS5vcHRpb25zJiZpLm9wdGlvbnMucGx1Z2luc3x8e307cmV0dXJuIHRoaXMuX3BsdWdpbnMuY29uY2F0KGkucGx1Z2luc3x8W10pLmZvckVhY2goZnVuY3Rpb24odCl7aWYoLTE9PT1uLmluZGV4T2YodCkpe3ZhciBlPXQuaWQsaT1vW2VdOyExIT09aSYmKCEwPT09aSYmKGk9cy5jbG9uZShyLmdsb2JhbC5wbHVnaW5zW2VdKSksbi5wdXNoKHQpLGEucHVzaCh7cGx1Z2luOnQsb3B0aW9uczppfHx7fX0pKX19KSxlLmRlc2NyaXB0b3JzPWEsZS5pZD10aGlzLl9jYWNoZUlkLGF9LF9pbnZhbGlkYXRlOmZ1bmN0aW9uKHQpe2RlbGV0ZSB0LiRwbHVnaW5zfX19LHsyNjoyNiw0Njo0Nn1dLDMzOltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIHk9dCgyNiksbj10KDI3KSxIPXQoNDYpLGE9dCgzNSk7ZnVuY3Rpb24gayh0KXt2YXIgZSxpLG49W107Zm9yKGU9MCxpPXQubGVuZ3RoO2U8aTsrK2Upbi5wdXNoKHRbZV0ubGFiZWwpO3JldHVybiBufWZ1bmN0aW9uIGoodCxlLGkpe3ZhciBuPXQuZ2V0UGl4ZWxGb3JUaWNrKGUpO3JldHVybiBpJiYobi09MD09PWU/KHQuZ2V0UGl4ZWxGb3JUaWNrKDEpLW4pLzI6KG4tdC5nZXRQaXhlbEZvclRpY2soZS0xKSkvMiksbn1mdW5jdGlvbiBNKHQsZSxpKXtyZXR1cm4gSC5pc0FycmF5KGUpP0gubG9uZ2VzdFRleHQodCxpLGUpOnQubWVhc3VyZVRleHQoZSkud2lkdGh9ZnVuY3Rpb24gdyh0KXt2YXIgZT1ILnZhbHVlT3JEZWZhdWx0LGk9eS5nbG9iYWwsbj1lKHQuZm9udFNpemUsaS5kZWZhdWx0Rm9udFNpemUpLGE9ZSh0LmZvbnRTdHlsZSxpLmRlZmF1bHRGb250U3R5bGUpLG89ZSh0LmZvbnRGYW1pbHksaS5kZWZhdWx0Rm9udEZhbWlseSk7cmV0dXJue3NpemU6bixzdHlsZTphLGZhbWlseTpvLGZvbnQ6SC5mb250U3RyaW5nKG4sYSxvKX19ZnVuY3Rpb24gQyh0KXtyZXR1cm4gSC5vcHRpb25zLnRvTGluZUhlaWdodChILnZhbHVlT3JEZWZhdWx0KHQubGluZUhlaWdodCwxLjIpLEgudmFsdWVPckRlZmF1bHQodC5mb250U2l6ZSx5Lmdsb2JhbC5kZWZhdWx0Rm9udFNpemUpKX15Ll9zZXQoXCJzY2FsZVwiLHtkaXNwbGF5OiEwLHBvc2l0aW9uOlwibGVmdFwiLG9mZnNldDohMSxncmlkTGluZXM6e2Rpc3BsYXk6ITAsY29sb3I6XCJyZ2JhKDAsIDAsIDAsIDAuMSlcIixsaW5lV2lkdGg6MSxkcmF3Qm9yZGVyOiEwLGRyYXdPbkNoYXJ0QXJlYTohMCxkcmF3VGlja3M6ITAsdGlja01hcmtMZW5ndGg6MTAsemVyb0xpbmVXaWR0aDoxLHplcm9MaW5lQ29sb3I6XCJyZ2JhKDAsMCwwLDAuMjUpXCIsemVyb0xpbmVCb3JkZXJEYXNoOltdLHplcm9MaW5lQm9yZGVyRGFzaE9mZnNldDowLG9mZnNldEdyaWRMaW5lczohMSxib3JkZXJEYXNoOltdLGJvcmRlckRhc2hPZmZzZXQ6MH0sc2NhbGVMYWJlbDp7ZGlzcGxheTohMSxsYWJlbFN0cmluZzpcIlwiLGxpbmVIZWlnaHQ6MS4yLHBhZGRpbmc6e3RvcDo0LGJvdHRvbTo0fX0sdGlja3M6e2JlZ2luQXRaZXJvOiExLG1pblJvdGF0aW9uOjAsbWF4Um90YXRpb246NTAsbWlycm9yOiExLHBhZGRpbmc6MCxyZXZlcnNlOiExLGRpc3BsYXk6ITAsYXV0b1NraXA6ITAsYXV0b1NraXBQYWRkaW5nOjAsbGFiZWxPZmZzZXQ6MCxjYWxsYmFjazphLmZvcm1hdHRlcnMudmFsdWVzLG1pbm9yOnt9LG1ham9yOnt9fX0pLGUuZXhwb3J0cz1uLmV4dGVuZCh7Z2V0UGFkZGluZzpmdW5jdGlvbigpe3JldHVybntsZWZ0OnRoaXMucGFkZGluZ0xlZnR8fDAsdG9wOnRoaXMucGFkZGluZ1RvcHx8MCxyaWdodDp0aGlzLnBhZGRpbmdSaWdodHx8MCxib3R0b206dGhpcy5wYWRkaW5nQm90dG9tfHwwfX0sZ2V0VGlja3M6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdGlja3N9LG1lcmdlVGlja3NPcHRpb25zOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5vcHRpb25zLnRpY2tzO2Zvcih2YXIgZSBpbiExPT09dC5taW5vciYmKHQubWlub3I9e2Rpc3BsYXk6ITF9KSwhMT09PXQubWFqb3ImJih0Lm1ham9yPXtkaXNwbGF5OiExfSksdClcIm1ham9yXCIhPT1lJiZcIm1pbm9yXCIhPT1lJiYodm9pZCAwPT09dC5taW5vcltlXSYmKHQubWlub3JbZV09dFtlXSksdm9pZCAwPT09dC5tYWpvcltlXSYmKHQubWFqb3JbZV09dFtlXSkpfSxiZWZvcmVVcGRhdGU6ZnVuY3Rpb24oKXtILmNhbGxiYWNrKHRoaXMub3B0aW9ucy5iZWZvcmVVcGRhdGUsW3RoaXNdKX0sdXBkYXRlOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbixhLG8scixzLGwsdT10aGlzO2Zvcih1LmJlZm9yZVVwZGF0ZSgpLHUubWF4V2lkdGg9dCx1Lm1heEhlaWdodD1lLHUubWFyZ2lucz1ILmV4dGVuZCh7bGVmdDowLHJpZ2h0OjAsdG9wOjAsYm90dG9tOjB9LGkpLHUubG9uZ2VzdFRleHRDYWNoZT11Lmxvbmdlc3RUZXh0Q2FjaGV8fHt9LHUuYmVmb3JlU2V0RGltZW5zaW9ucygpLHUuc2V0RGltZW5zaW9ucygpLHUuYWZ0ZXJTZXREaW1lbnNpb25zKCksdS5iZWZvcmVEYXRhTGltaXRzKCksdS5kZXRlcm1pbmVEYXRhTGltaXRzKCksdS5hZnRlckRhdGFMaW1pdHMoKSx1LmJlZm9yZUJ1aWxkVGlja3MoKSxzPXUuYnVpbGRUaWNrcygpfHxbXSx1LmFmdGVyQnVpbGRUaWNrcygpLHUuYmVmb3JlVGlja1RvTGFiZWxDb252ZXJzaW9uKCksbz11LmNvbnZlcnRUaWNrc1RvTGFiZWxzKHMpfHx1LnRpY2tzLHUuYWZ0ZXJUaWNrVG9MYWJlbENvbnZlcnNpb24oKSxuPTAsYT0odS50aWNrcz1vKS5sZW5ndGg7bjxhOysrbilyPW9bbl0sKGw9c1tuXSk/bC5sYWJlbD1yOnMucHVzaChsPXtsYWJlbDpyLG1ham9yOiExfSk7cmV0dXJuIHUuX3RpY2tzPXMsdS5iZWZvcmVDYWxjdWxhdGVUaWNrUm90YXRpb24oKSx1LmNhbGN1bGF0ZVRpY2tSb3RhdGlvbigpLHUuYWZ0ZXJDYWxjdWxhdGVUaWNrUm90YXRpb24oKSx1LmJlZm9yZUZpdCgpLHUuZml0KCksdS5hZnRlckZpdCgpLHUuYWZ0ZXJVcGRhdGUoKSx1Lm1pblNpemV9LGFmdGVyVXBkYXRlOmZ1bmN0aW9uKCl7SC5jYWxsYmFjayh0aGlzLm9wdGlvbnMuYWZ0ZXJVcGRhdGUsW3RoaXNdKX0sYmVmb3JlU2V0RGltZW5zaW9uczpmdW5jdGlvbigpe0guY2FsbGJhY2sodGhpcy5vcHRpb25zLmJlZm9yZVNldERpbWVuc2lvbnMsW3RoaXNdKX0sc2V0RGltZW5zaW9uczpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dC5pc0hvcml6b250YWwoKT8odC53aWR0aD10Lm1heFdpZHRoLHQubGVmdD0wLHQucmlnaHQ9dC53aWR0aCk6KHQuaGVpZ2h0PXQubWF4SGVpZ2h0LHQudG9wPTAsdC5ib3R0b209dC5oZWlnaHQpLHQucGFkZGluZ0xlZnQ9MCx0LnBhZGRpbmdUb3A9MCx0LnBhZGRpbmdSaWdodD0wLHQucGFkZGluZ0JvdHRvbT0wfSxhZnRlclNldERpbWVuc2lvbnM6ZnVuY3Rpb24oKXtILmNhbGxiYWNrKHRoaXMub3B0aW9ucy5hZnRlclNldERpbWVuc2lvbnMsW3RoaXNdKX0sYmVmb3JlRGF0YUxpbWl0czpmdW5jdGlvbigpe0guY2FsbGJhY2sodGhpcy5vcHRpb25zLmJlZm9yZURhdGFMaW1pdHMsW3RoaXNdKX0sZGV0ZXJtaW5lRGF0YUxpbWl0czpILm5vb3AsYWZ0ZXJEYXRhTGltaXRzOmZ1bmN0aW9uKCl7SC5jYWxsYmFjayh0aGlzLm9wdGlvbnMuYWZ0ZXJEYXRhTGltaXRzLFt0aGlzXSl9LGJlZm9yZUJ1aWxkVGlja3M6ZnVuY3Rpb24oKXtILmNhbGxiYWNrKHRoaXMub3B0aW9ucy5iZWZvcmVCdWlsZFRpY2tzLFt0aGlzXSl9LGJ1aWxkVGlja3M6SC5ub29wLGFmdGVyQnVpbGRUaWNrczpmdW5jdGlvbigpe0guY2FsbGJhY2sodGhpcy5vcHRpb25zLmFmdGVyQnVpbGRUaWNrcyxbdGhpc10pfSxiZWZvcmVUaWNrVG9MYWJlbENvbnZlcnNpb246ZnVuY3Rpb24oKXtILmNhbGxiYWNrKHRoaXMub3B0aW9ucy5iZWZvcmVUaWNrVG9MYWJlbENvbnZlcnNpb24sW3RoaXNdKX0sY29udmVydFRpY2tzVG9MYWJlbHM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMudGlja3M7dGhpcy50aWNrcz10aGlzLnRpY2tzLm1hcCh0LnVzZXJDYWxsYmFja3x8dC5jYWxsYmFjayx0aGlzKX0sYWZ0ZXJUaWNrVG9MYWJlbENvbnZlcnNpb246ZnVuY3Rpb24oKXtILmNhbGxiYWNrKHRoaXMub3B0aW9ucy5hZnRlclRpY2tUb0xhYmVsQ29udmVyc2lvbixbdGhpc10pfSxiZWZvcmVDYWxjdWxhdGVUaWNrUm90YXRpb246ZnVuY3Rpb24oKXtILmNhbGxiYWNrKHRoaXMub3B0aW9ucy5iZWZvcmVDYWxjdWxhdGVUaWNrUm90YXRpb24sW3RoaXNdKX0sY2FsY3VsYXRlVGlja1JvdGF0aW9uOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxlPXQuY3R4LGk9dC5vcHRpb25zLnRpY2tzLG49ayh0Ll90aWNrcyksYT13KGkpO2UuZm9udD1hLmZvbnQ7dmFyIG89aS5taW5Sb3RhdGlvbnx8MDtpZihuLmxlbmd0aCYmdC5vcHRpb25zLmRpc3BsYXkmJnQuaXNIb3Jpem9udGFsKCkpZm9yKHZhciByLHM9SC5sb25nZXN0VGV4dChlLGEuZm9udCxuLHQubG9uZ2VzdFRleHRDYWNoZSksbD1zLHU9dC5nZXRQaXhlbEZvclRpY2soMSktdC5nZXRQaXhlbEZvclRpY2soMCktNjt1PGwmJm88aS5tYXhSb3RhdGlvbjspe3ZhciBkPUgudG9SYWRpYW5zKG8pO2lmKHI9TWF0aC5jb3MoZCksTWF0aC5zaW4oZCkqcz50Lm1heEhlaWdodCl7by0tO2JyZWFrfW8rKyxsPXIqc310LmxhYmVsUm90YXRpb249b30sYWZ0ZXJDYWxjdWxhdGVUaWNrUm90YXRpb246ZnVuY3Rpb24oKXtILmNhbGxiYWNrKHRoaXMub3B0aW9ucy5hZnRlckNhbGN1bGF0ZVRpY2tSb3RhdGlvbixbdGhpc10pfSxiZWZvcmVGaXQ6ZnVuY3Rpb24oKXtILmNhbGxiYWNrKHRoaXMub3B0aW9ucy5iZWZvcmVGaXQsW3RoaXNdKX0sZml0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxlPXQubWluU2l6ZT17d2lkdGg6MCxoZWlnaHQ6MH0saT1rKHQuX3RpY2tzKSxuPXQub3B0aW9ucyxhPW4udGlja3Msbz1uLnNjYWxlTGFiZWwscj1uLmdyaWRMaW5lcyxzPW4uZGlzcGxheSxsPXQuaXNIb3Jpem9udGFsKCksdT13KGEpLGQ9bi5ncmlkTGluZXMudGlja01hcmtMZW5ndGg7aWYoZS53aWR0aD1sP3QuaXNGdWxsV2lkdGgoKT90Lm1heFdpZHRoLXQubWFyZ2lucy5sZWZ0LXQubWFyZ2lucy5yaWdodDp0Lm1heFdpZHRoOnMmJnIuZHJhd1RpY2tzP2Q6MCxlLmhlaWdodD1sP3MmJnIuZHJhd1RpY2tzP2Q6MDp0Lm1heEhlaWdodCxvLmRpc3BsYXkmJnMpe3ZhciBjPUMobykrSC5vcHRpb25zLnRvUGFkZGluZyhvLnBhZGRpbmcpLmhlaWdodDtsP2UuaGVpZ2h0Kz1jOmUud2lkdGgrPWN9aWYoYS5kaXNwbGF5JiZzKXt2YXIgaD1ILmxvbmdlc3RUZXh0KHQuY3R4LHUuZm9udCxpLHQubG9uZ2VzdFRleHRDYWNoZSksZj1ILm51bWJlck9mTGFiZWxMaW5lcyhpKSxnPS41KnUuc2l6ZSxwPXQub3B0aW9ucy50aWNrcy5wYWRkaW5nO2lmKGwpe3QubG9uZ2VzdExhYmVsV2lkdGg9aDt2YXIgbT1ILnRvUmFkaWFucyh0LmxhYmVsUm90YXRpb24pLHY9TWF0aC5jb3MobSksYj1NYXRoLnNpbihtKSpoK3Uuc2l6ZSpmK2cqKGYtMSkrZztlLmhlaWdodD1NYXRoLm1pbih0Lm1heEhlaWdodCxlLmhlaWdodCtiK3ApLHQuY3R4LmZvbnQ9dS5mb250O3ZhciB4PU0odC5jdHgsaVswXSx1LmZvbnQpLHk9TSh0LmN0eCxpW2kubGVuZ3RoLTFdLHUuZm9udCk7MCE9PXQubGFiZWxSb3RhdGlvbj8odC5wYWRkaW5nTGVmdD1cImJvdHRvbVwiPT09bi5wb3NpdGlvbj92KngrMzp2KmcrMyx0LnBhZGRpbmdSaWdodD1cImJvdHRvbVwiPT09bi5wb3NpdGlvbj92KmcrMzp2KnkrMyk6KHQucGFkZGluZ0xlZnQ9eC8yKzMsdC5wYWRkaW5nUmlnaHQ9eS8yKzMpfWVsc2UgYS5taXJyb3I/aD0wOmgrPXArZyxlLndpZHRoPU1hdGgubWluKHQubWF4V2lkdGgsZS53aWR0aCtoKSx0LnBhZGRpbmdUb3A9dS5zaXplLzIsdC5wYWRkaW5nQm90dG9tPXUuc2l6ZS8yfXQuaGFuZGxlTWFyZ2lucygpLHQud2lkdGg9ZS53aWR0aCx0LmhlaWdodD1lLmhlaWdodH0saGFuZGxlTWFyZ2luczpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dC5tYXJnaW5zJiYodC5wYWRkaW5nTGVmdD1NYXRoLm1heCh0LnBhZGRpbmdMZWZ0LXQubWFyZ2lucy5sZWZ0LDApLHQucGFkZGluZ1RvcD1NYXRoLm1heCh0LnBhZGRpbmdUb3AtdC5tYXJnaW5zLnRvcCwwKSx0LnBhZGRpbmdSaWdodD1NYXRoLm1heCh0LnBhZGRpbmdSaWdodC10Lm1hcmdpbnMucmlnaHQsMCksdC5wYWRkaW5nQm90dG9tPU1hdGgubWF4KHQucGFkZGluZ0JvdHRvbS10Lm1hcmdpbnMuYm90dG9tLDApKX0sYWZ0ZXJGaXQ6ZnVuY3Rpb24oKXtILmNhbGxiYWNrKHRoaXMub3B0aW9ucy5hZnRlckZpdCxbdGhpc10pfSxpc0hvcml6b250YWw6ZnVuY3Rpb24oKXtyZXR1cm5cInRvcFwiPT09dGhpcy5vcHRpb25zLnBvc2l0aW9ufHxcImJvdHRvbVwiPT09dGhpcy5vcHRpb25zLnBvc2l0aW9ufSxpc0Z1bGxXaWR0aDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMuZnVsbFdpZHRofSxnZXRSaWdodFZhbHVlOmZ1bmN0aW9uKHQpe2lmKEguaXNOdWxsT3JVbmRlZih0KSlyZXR1cm4gTmFOO2lmKFwibnVtYmVyXCI9PXR5cGVvZiB0JiYhaXNGaW5pdGUodCkpcmV0dXJuIE5hTjtpZih0KWlmKHRoaXMuaXNIb3Jpem9udGFsKCkpe2lmKHZvaWQgMCE9PXQueClyZXR1cm4gdGhpcy5nZXRSaWdodFZhbHVlKHQueCl9ZWxzZSBpZih2b2lkIDAhPT10LnkpcmV0dXJuIHRoaXMuZ2V0UmlnaHRWYWx1ZSh0LnkpO3JldHVybiB0fSxnZXRMYWJlbEZvckluZGV4Okgubm9vcCxnZXRQaXhlbEZvclZhbHVlOkgubm9vcCxnZXRWYWx1ZUZvclBpeGVsOkgubm9vcCxnZXRQaXhlbEZvclRpY2s6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxpPWUub3B0aW9ucy5vZmZzZXQ7aWYoZS5pc0hvcml6b250YWwoKSl7dmFyIG49KGUud2lkdGgtKGUucGFkZGluZ0xlZnQrZS5wYWRkaW5nUmlnaHQpKS9NYXRoLm1heChlLl90aWNrcy5sZW5ndGgtKGk/MDoxKSwxKSxhPW4qdCtlLnBhZGRpbmdMZWZ0O2kmJihhKz1uLzIpO3ZhciBvPWUubGVmdCtNYXRoLnJvdW5kKGEpO3JldHVybiBvKz1lLmlzRnVsbFdpZHRoKCk/ZS5tYXJnaW5zLmxlZnQ6MH12YXIgcj1lLmhlaWdodC0oZS5wYWRkaW5nVG9wK2UucGFkZGluZ0JvdHRvbSk7cmV0dXJuIGUudG9wK3QqKHIvKGUuX3RpY2tzLmxlbmd0aC0xKSl9LGdldFBpeGVsRm9yRGVjaW1hbDpmdW5jdGlvbih0KXt2YXIgZT10aGlzO2lmKGUuaXNIb3Jpem9udGFsKCkpe3ZhciBpPShlLndpZHRoLShlLnBhZGRpbmdMZWZ0K2UucGFkZGluZ1JpZ2h0KSkqdCtlLnBhZGRpbmdMZWZ0LG49ZS5sZWZ0K01hdGgucm91bmQoaSk7cmV0dXJuIG4rPWUuaXNGdWxsV2lkdGgoKT9lLm1hcmdpbnMubGVmdDowfXJldHVybiBlLnRvcCt0KmUuaGVpZ2h0fSxnZXRCYXNlUGl4ZWw6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRQaXhlbEZvclZhbHVlKHRoaXMuZ2V0QmFzZVZhbHVlKCkpfSxnZXRCYXNlVmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm1pbixlPXRoaXMubWF4O3JldHVybiB0aGlzLmJlZ2luQXRaZXJvPzA6dDwwJiZlPDA/ZTowPHQmJjA8ZT90OjB9LF9hdXRvU2tpcDpmdW5jdGlvbih0KXt2YXIgZSxpLG4sYSxvPXRoaXMscj1vLmlzSG9yaXpvbnRhbCgpLHM9by5vcHRpb25zLnRpY2tzLm1pbm9yLGw9dC5sZW5ndGgsdT1ILnRvUmFkaWFucyhvLmxhYmVsUm90YXRpb24pLGQ9TWF0aC5jb3ModSksYz1vLmxvbmdlc3RMYWJlbFdpZHRoKmQsaD1bXTtmb3Iocy5tYXhUaWNrc0xpbWl0JiYoYT1zLm1heFRpY2tzTGltaXQpLHImJihlPSExLChjK3MuYXV0b1NraXBQYWRkaW5nKSpsPm8ud2lkdGgtKG8ucGFkZGluZ0xlZnQrby5wYWRkaW5nUmlnaHQpJiYoZT0xK01hdGguZmxvb3IoKGMrcy5hdXRvU2tpcFBhZGRpbmcpKmwvKG8ud2lkdGgtKG8ucGFkZGluZ0xlZnQrby5wYWRkaW5nUmlnaHQpKSkpLGEmJmE8bCYmKGU9TWF0aC5tYXgoZSxNYXRoLmZsb29yKGwvYSkpKSksaT0wO2k8bDtpKyspbj10W2ldLCgxPGUmJjA8aSVlfHxpJWU9PTAmJmw8PWkrZSkmJmkhPT1sLTEmJmRlbGV0ZSBuLmxhYmVsLGgucHVzaChuKTtyZXR1cm4gaH0sZHJhdzpmdW5jdGlvbihTKXt2YXIgXz10aGlzLEQ9Xy5vcHRpb25zO2lmKEQuZGlzcGxheSl7dmFyIHI9Xy5jdHgsUD15Lmdsb2JhbCxJPUQudGlja3MubWlub3IsdD1ELnRpY2tzLm1ham9yfHxJLEE9RC5ncmlkTGluZXMsZT1ELnNjYWxlTGFiZWwsVD0wIT09Xy5sYWJlbFJvdGF0aW9uLEY9Xy5pc0hvcml6b250YWwoKSxPPUkuYXV0b1NraXA/Xy5fYXV0b1NraXAoXy5nZXRUaWNrcygpKTpfLmdldFRpY2tzKCkscz1ILnZhbHVlT3JEZWZhdWx0KEkuZm9udENvbG9yLFAuZGVmYXVsdEZvbnRDb2xvciksbD13KEkpLHU9SC52YWx1ZU9yRGVmYXVsdCh0LmZvbnRDb2xvcixQLmRlZmF1bHRGb250Q29sb3IpLGQ9dyh0KSxSPUEuZHJhd1RpY2tzP0EudGlja01hcmtMZW5ndGg6MCxpPUgudmFsdWVPckRlZmF1bHQoZS5mb250Q29sb3IsUC5kZWZhdWx0Rm9udENvbG9yKSxuPXcoZSksYT1ILm9wdGlvbnMudG9QYWRkaW5nKGUucGFkZGluZyksTD1ILnRvUmFkaWFucyhfLmxhYmVsUm90YXRpb24pLHo9W10sTj1fLm9wdGlvbnMuZ3JpZExpbmVzLmxpbmVXaWR0aCxCPVwicmlnaHRcIj09PUQucG9zaXRpb24/Xy5sZWZ0Ol8ucmlnaHQtTi1SLFc9XCJyaWdodFwiPT09RC5wb3NpdGlvbj9fLmxlZnQrUjpfLnJpZ2h0LFY9XCJib3R0b21cIj09PUQucG9zaXRpb24/Xy50b3ArTjpfLmJvdHRvbS1SLU4sRT1cImJvdHRvbVwiPT09RC5wb3NpdGlvbj9fLnRvcCtOK1I6Xy5ib3R0b20rTjtpZihILmVhY2goTyxmdW5jdGlvbih0LGUpe2lmKCFILmlzTnVsbE9yVW5kZWYodC5sYWJlbCkpe3ZhciBpLG4sYSxvLHIscyxsLHUsZCxjLGgsZixnLHAsbT10LmxhYmVsO289ZT09PV8uemVyb0xpbmVJbmRleCYmRC5vZmZzZXQ9PT1BLm9mZnNldEdyaWRMaW5lcz8oaT1BLnplcm9MaW5lV2lkdGgsbj1BLnplcm9MaW5lQ29sb3IsYT1BLnplcm9MaW5lQm9yZGVyRGFzaCxBLnplcm9MaW5lQm9yZGVyRGFzaE9mZnNldCk6KGk9SC52YWx1ZUF0SW5kZXhPckRlZmF1bHQoQS5saW5lV2lkdGgsZSksbj1ILnZhbHVlQXRJbmRleE9yRGVmYXVsdChBLmNvbG9yLGUpLGE9SC52YWx1ZU9yRGVmYXVsdChBLmJvcmRlckRhc2gsUC5ib3JkZXJEYXNoKSxILnZhbHVlT3JEZWZhdWx0KEEuYm9yZGVyRGFzaE9mZnNldCxQLmJvcmRlckRhc2hPZmZzZXQpKTt2YXIgdj1cIm1pZGRsZVwiLGI9XCJtaWRkbGVcIix4PUkucGFkZGluZztpZihGKXt2YXIgeT1SK3g7cD1cImJvdHRvbVwiPT09RC5wb3NpdGlvbj8oYj1UP1wibWlkZGxlXCI6XCJ0b3BcIix2PVQ/XCJyaWdodFwiOlwiY2VudGVyXCIsXy50b3AreSk6KGI9VD9cIm1pZGRsZVwiOlwiYm90dG9tXCIsdj1UP1wibGVmdFwiOlwiY2VudGVyXCIsXy5ib3R0b20teSk7dmFyIGs9aihfLGUsQS5vZmZzZXRHcmlkTGluZXMmJjE8Ty5sZW5ndGgpO2s8Xy5sZWZ0JiYobj1cInJnYmEoMCwwLDAsMClcIiksays9SC5hbGlhc1BpeGVsKGkpLGc9Xy5nZXRQaXhlbEZvclRpY2soZSkrSS5sYWJlbE9mZnNldCxyPWw9ZD1oPWsscz1WLHU9RSxjPVMudG9wLGY9Uy5ib3R0b20rTn1lbHNle3ZhciBNLHc9XCJsZWZ0XCI9PT1ELnBvc2l0aW9uO009SS5taXJyb3I/KHY9dz9cImxlZnRcIjpcInJpZ2h0XCIseCk6KHY9dz9cInJpZ2h0XCI6XCJsZWZ0XCIsUit4KSxnPXc/Xy5yaWdodC1NOl8ubGVmdCtNO3ZhciBDPWooXyxlLEEub2Zmc2V0R3JpZExpbmVzJiYxPE8ubGVuZ3RoKTtDPF8udG9wJiYobj1cInJnYmEoMCwwLDAsMClcIiksQys9SC5hbGlhc1BpeGVsKGkpLHA9Xy5nZXRQaXhlbEZvclRpY2soZSkrSS5sYWJlbE9mZnNldCxyPUIsbD1XLGQ9Uy5sZWZ0LGg9Uy5yaWdodCtOLHM9dT1jPWY9Q316LnB1c2goe3R4MTpyLHR5MTpzLHR4MjpsLHR5Mjp1LHgxOmQseTE6Yyx4MjpoLHkyOmYsbGFiZWxYOmcsbGFiZWxZOnAsZ2xXaWR0aDppLGdsQ29sb3I6bixnbEJvcmRlckRhc2g6YSxnbEJvcmRlckRhc2hPZmZzZXQ6byxyb3RhdGlvbjotMSpMLGxhYmVsOm0sbWFqb3I6dC5tYWpvcix0ZXh0QmFzZWxpbmU6Yix0ZXh0QWxpZ246dn0pfX0pLEguZWFjaCh6LGZ1bmN0aW9uKHQpe2lmKEEuZGlzcGxheSYmKHIuc2F2ZSgpLHIubGluZVdpZHRoPXQuZ2xXaWR0aCxyLnN0cm9rZVN0eWxlPXQuZ2xDb2xvcixyLnNldExpbmVEYXNoJiYoci5zZXRMaW5lRGFzaCh0LmdsQm9yZGVyRGFzaCksci5saW5lRGFzaE9mZnNldD10LmdsQm9yZGVyRGFzaE9mZnNldCksci5iZWdpblBhdGgoKSxBLmRyYXdUaWNrcyYmKHIubW92ZVRvKHQudHgxLHQudHkxKSxyLmxpbmVUbyh0LnR4Mix0LnR5MikpLEEuZHJhd09uQ2hhcnRBcmVhJiYoci5tb3ZlVG8odC54MSx0LnkxKSxyLmxpbmVUbyh0LngyLHQueTIpKSxyLnN0cm9rZSgpLHIucmVzdG9yZSgpKSxJLmRpc3BsYXkpe3Iuc2F2ZSgpLHIudHJhbnNsYXRlKHQubGFiZWxYLHQubGFiZWxZKSxyLnJvdGF0ZSh0LnJvdGF0aW9uKSxyLmZvbnQ9dC5tYWpvcj9kLmZvbnQ6bC5mb250LHIuZmlsbFN0eWxlPXQubWFqb3I/dTpzLHIudGV4dEJhc2VsaW5lPXQudGV4dEJhc2VsaW5lLHIudGV4dEFsaWduPXQudGV4dEFsaWduO3ZhciBlPXQubGFiZWw7aWYoSC5pc0FycmF5KGUpKWZvcih2YXIgaT1lLmxlbmd0aCxuPTEuNSpsLnNpemUsYT1fLmlzSG9yaXpvbnRhbCgpPzA6LW4qKGktMSkvMixvPTA7bzxpOysrbylyLmZpbGxUZXh0KFwiXCIrZVtvXSwwLGEpLGErPW47ZWxzZSByLmZpbGxUZXh0KGUsMCwwKTtyLnJlc3RvcmUoKX19KSxlLmRpc3BsYXkpe3ZhciBvLGMsaD0wLGY9QyhlKS8yO2lmKEYpbz1fLmxlZnQrKF8ucmlnaHQtXy5sZWZ0KS8yLGM9XCJib3R0b21cIj09PUQucG9zaXRpb24/Xy5ib3R0b20tZi1hLmJvdHRvbTpfLnRvcCtmK2EudG9wO2Vsc2V7dmFyIGc9XCJsZWZ0XCI9PT1ELnBvc2l0aW9uO289Zz9fLmxlZnQrZithLnRvcDpfLnJpZ2h0LWYtYS50b3AsYz1fLnRvcCsoXy5ib3R0b20tXy50b3ApLzIsaD1nPy0uNSpNYXRoLlBJOi41Kk1hdGguUEl9ci5zYXZlKCksci50cmFuc2xhdGUobyxjKSxyLnJvdGF0ZShoKSxyLnRleHRBbGlnbj1cImNlbnRlclwiLHIudGV4dEJhc2VsaW5lPVwibWlkZGxlXCIsci5maWxsU3R5bGU9aSxyLmZvbnQ9bi5mb250LHIuZmlsbFRleHQoZS5sYWJlbFN0cmluZywwLDApLHIucmVzdG9yZSgpfWlmKEEuZHJhd0JvcmRlcil7ci5saW5lV2lkdGg9SC52YWx1ZUF0SW5kZXhPckRlZmF1bHQoQS5saW5lV2lkdGgsMCksci5zdHJva2VTdHlsZT1ILnZhbHVlQXRJbmRleE9yRGVmYXVsdChBLmNvbG9yLDApO3ZhciBwPV8ubGVmdCxtPV8ucmlnaHQrTix2PV8udG9wLGI9Xy5ib3R0b20rTix4PUguYWxpYXNQaXhlbChyLmxpbmVXaWR0aCk7Rj8odj1iPVwidG9wXCI9PT1ELnBvc2l0aW9uP18uYm90dG9tOl8udG9wLHYrPXgsYis9eCk6KHA9bT1cImxlZnRcIj09PUQucG9zaXRpb24/Xy5yaWdodDpfLmxlZnQscCs9eCxtKz14KSxyLmJlZ2luUGF0aCgpLHIubW92ZVRvKHAsdiksci5saW5lVG8obSxiKSxyLnN0cm9rZSgpfX19fSl9LHsyNjoyNiwyNzoyNywzNTozNSw0Njo0Nn1dLDM0OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49dCgyNiksYT10KDQ2KSxvPXQoMzEpO2UuZXhwb3J0cz17Y29uc3RydWN0b3JzOnt9LGRlZmF1bHRzOnt9LHJlZ2lzdGVyU2NhbGVUeXBlOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLmNvbnN0cnVjdG9yc1t0XT1lLHRoaXMuZGVmYXVsdHNbdF09YS5jbG9uZShpKX0sZ2V0U2NhbGVDb25zdHJ1Y3RvcjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb25zdHJ1Y3RvcnMuaGFzT3duUHJvcGVydHkodCk/dGhpcy5jb25zdHJ1Y3RvcnNbdF06dm9pZCAwfSxnZXRTY2FsZURlZmF1bHRzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRlZmF1bHRzLmhhc093blByb3BlcnR5KHQpP2EubWVyZ2Uoe30sW24uc2NhbGUsdGhpcy5kZWZhdWx0c1t0XV0pOnt9fSx1cGRhdGVTY2FsZURlZmF1bHRzOmZ1bmN0aW9uKHQsZSl7dGhpcy5kZWZhdWx0cy5oYXNPd25Qcm9wZXJ0eSh0KSYmKHRoaXMuZGVmYXVsdHNbdF09YS5leHRlbmQodGhpcy5kZWZhdWx0c1t0XSxlKSl9LGFkZFNjYWxlc1RvTGF5b3V0OmZ1bmN0aW9uKGUpe2EuZWFjaChlLnNjYWxlcyxmdW5jdGlvbih0KXt0LmZ1bGxXaWR0aD10Lm9wdGlvbnMuZnVsbFdpZHRoLHQucG9zaXRpb249dC5vcHRpb25zLnBvc2l0aW9uLHQud2VpZ2h0PXQub3B0aW9ucy53ZWlnaHQsby5hZGRCb3goZSx0KX0pfX19LHsyNjoyNiwzMTozMSw0Njo0Nn1dLDM1OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGw9dCg0Nik7ZS5leHBvcnRzPXtmb3JtYXR0ZXJzOnt2YWx1ZXM6ZnVuY3Rpb24odCl7cmV0dXJuIGwuaXNBcnJheSh0KT90OlwiXCIrdH0sbGluZWFyOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj0zPGkubGVuZ3RoP2lbMl0taVsxXTppWzFdLWlbMF07MTxNYXRoLmFicyhuKSYmdCE9PU1hdGguZmxvb3IodCkmJihuPXQtTWF0aC5mbG9vcih0KSk7dmFyIGE9bC5sb2cxMChNYXRoLmFicyhuKSksbz1cIlwiO2lmKDAhPT10KWlmKE1hdGgubWF4KE1hdGguYWJzKGlbMF0pLE1hdGguYWJzKGlbaS5sZW5ndGgtMV0pKTwxZS00KXt2YXIgcj1sLmxvZzEwKE1hdGguYWJzKHQpKTtvPXQudG9FeHBvbmVudGlhbChNYXRoLmZsb29yKHIpLU1hdGguZmxvb3IoYSkpfWVsc2V7dmFyIHM9LTEqTWF0aC5mbG9vcihhKTtzPU1hdGgubWF4KE1hdGgubWluKHMsMjApLDApLG89dC50b0ZpeGVkKHMpfWVsc2Ugbz1cIjBcIjtyZXR1cm4gb30sbG9nYXJpdGhtaWM6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXQvTWF0aC5wb3coMTAsTWF0aC5mbG9vcihsLmxvZzEwKHQpKSk7cmV0dXJuIDA9PT10P1wiMFwiOjE9PT1ufHwyPT09bnx8NT09PW58fDA9PT1lfHxlPT09aS5sZW5ndGgtMT90LnRvRXhwb25lbnRpYWwoKTpcIlwifX19fSx7NDY6NDZ9XSwzNjpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBuPXQoMjYpLGE9dCgyNyksUj10KDQ2KTtuLl9zZXQoXCJnbG9iYWxcIix7dG9vbHRpcHM6e2VuYWJsZWQ6ITAsY3VzdG9tOm51bGwsbW9kZTpcIm5lYXJlc3RcIixwb3NpdGlvbjpcImF2ZXJhZ2VcIixpbnRlcnNlY3Q6ITAsYmFja2dyb3VuZENvbG9yOlwicmdiYSgwLDAsMCwwLjgpXCIsdGl0bGVGb250U3R5bGU6XCJib2xkXCIsdGl0bGVTcGFjaW5nOjIsdGl0bGVNYXJnaW5Cb3R0b206Nix0aXRsZUZvbnRDb2xvcjpcIiNmZmZcIix0aXRsZUFsaWduOlwibGVmdFwiLGJvZHlTcGFjaW5nOjIsYm9keUZvbnRDb2xvcjpcIiNmZmZcIixib2R5QWxpZ246XCJsZWZ0XCIsZm9vdGVyRm9udFN0eWxlOlwiYm9sZFwiLGZvb3RlclNwYWNpbmc6Mixmb290ZXJNYXJnaW5Ub3A6Nixmb290ZXJGb250Q29sb3I6XCIjZmZmXCIsZm9vdGVyQWxpZ246XCJsZWZ0XCIseVBhZGRpbmc6Nix4UGFkZGluZzo2LGNhcmV0UGFkZGluZzoyLGNhcmV0U2l6ZTo1LGNvcm5lclJhZGl1czo2LG11bHRpS2V5QmFja2dyb3VuZDpcIiNmZmZcIixkaXNwbGF5Q29sb3JzOiEwLGJvcmRlckNvbG9yOlwicmdiYSgwLDAsMCwwKVwiLGJvcmRlcldpZHRoOjAsY2FsbGJhY2tzOntiZWZvcmVUaXRsZTpSLm5vb3AsdGl0bGU6ZnVuY3Rpb24odCxlKXt2YXIgaT1cIlwiLG49ZS5sYWJlbHMsYT1uP24ubGVuZ3RoOjA7aWYoMDx0Lmxlbmd0aCl7dmFyIG89dFswXTtvLnhMYWJlbD9pPW8ueExhYmVsOjA8YSYmby5pbmRleDxhJiYoaT1uW28uaW5kZXhdKX1yZXR1cm4gaX0sYWZ0ZXJUaXRsZTpSLm5vb3AsYmVmb3JlQm9keTpSLm5vb3AsYmVmb3JlTGFiZWw6Ui5ub29wLGxhYmVsOmZ1bmN0aW9uKHQsZSl7dmFyIGk9ZS5kYXRhc2V0c1t0LmRhdGFzZXRJbmRleF0ubGFiZWx8fFwiXCI7cmV0dXJuIGkmJihpKz1cIjogXCIpLGkrPXQueUxhYmVsfSxsYWJlbENvbG9yOmZ1bmN0aW9uKHQsZSl7dmFyIGk9ZS5nZXREYXRhc2V0TWV0YSh0LmRhdGFzZXRJbmRleCkuZGF0YVt0LmluZGV4XS5fdmlldztyZXR1cm57Ym9yZGVyQ29sb3I6aS5ib3JkZXJDb2xvcixiYWNrZ3JvdW5kQ29sb3I6aS5iYWNrZ3JvdW5kQ29sb3J9fSxsYWJlbFRleHRDb2xvcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vcHRpb25zLmJvZHlGb250Q29sb3J9LGFmdGVyTGFiZWw6Ui5ub29wLGFmdGVyQm9keTpSLm5vb3AsYmVmb3JlRm9vdGVyOlIubm9vcCxmb290ZXI6Ui5ub29wLGFmdGVyRm9vdGVyOlIubm9vcH19fSk7dmFyIEw9e2F2ZXJhZ2U6ZnVuY3Rpb24odCl7aWYoIXQubGVuZ3RoKXJldHVybiExO3ZhciBlLGksbj0wLGE9MCxvPTA7Zm9yKGU9MCxpPXQubGVuZ3RoO2U8aTsrK2Upe3ZhciByPXRbZV07aWYociYmci5oYXNWYWx1ZSgpKXt2YXIgcz1yLnRvb2x0aXBQb3NpdGlvbigpO24rPXMueCxhKz1zLnksKytvfX1yZXR1cm57eDpNYXRoLnJvdW5kKG4vbykseTpNYXRoLnJvdW5kKGEvbyl9fSxuZWFyZXN0OmZ1bmN0aW9uKHQsZSl7dmFyIGksbixhLG89ZS54LHI9ZS55LHM9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZO2ZvcihpPTAsbj10Lmxlbmd0aDtpPG47KytpKXt2YXIgbD10W2ldO2lmKGwmJmwuaGFzVmFsdWUoKSl7dmFyIHU9bC5nZXRDZW50ZXJQb2ludCgpLGQ9Ui5kaXN0YW5jZUJldHdlZW5Qb2ludHMoZSx1KTtkPHMmJihzPWQsYT1sKX19aWYoYSl7dmFyIGM9YS50b29sdGlwUG9zaXRpb24oKTtvPWMueCxyPWMueX1yZXR1cm57eDpvLHk6cn19fTtmdW5jdGlvbiBoKHQsZSl7dmFyIGk9Ui5jb2xvcih0KTtyZXR1cm4gaS5hbHBoYShlKmkuYWxwaGEoKSkucmdiYVN0cmluZygpfWZ1bmN0aW9uIHIodCxlKXtyZXR1cm4gZSYmKFIuaXNBcnJheShlKT9BcnJheS5wcm90b3R5cGUucHVzaC5hcHBseSh0LGUpOnQucHVzaChlKSksdH1mdW5jdGlvbiBzKHQpe3JldHVybihcInN0cmluZ1wiPT10eXBlb2YgdHx8dCBpbnN0YW5jZW9mIFN0cmluZykmJi0xPHQuaW5kZXhPZihcIlxcblwiKT90LnNwbGl0KFwiXFxuXCIpOnR9ZnVuY3Rpb24geih0KXt2YXIgZT1uLmdsb2JhbCxpPVIudmFsdWVPckRlZmF1bHQ7cmV0dXJue3hQYWRkaW5nOnQueFBhZGRpbmcseVBhZGRpbmc6dC55UGFkZGluZyx4QWxpZ246dC54QWxpZ24seUFsaWduOnQueUFsaWduLGJvZHlGb250Q29sb3I6dC5ib2R5Rm9udENvbG9yLF9ib2R5Rm9udEZhbWlseTppKHQuYm9keUZvbnRGYW1pbHksZS5kZWZhdWx0Rm9udEZhbWlseSksX2JvZHlGb250U3R5bGU6aSh0LmJvZHlGb250U3R5bGUsZS5kZWZhdWx0Rm9udFN0eWxlKSxfYm9keUFsaWduOnQuYm9keUFsaWduLGJvZHlGb250U2l6ZTppKHQuYm9keUZvbnRTaXplLGUuZGVmYXVsdEZvbnRTaXplKSxib2R5U3BhY2luZzp0LmJvZHlTcGFjaW5nLHRpdGxlRm9udENvbG9yOnQudGl0bGVGb250Q29sb3IsX3RpdGxlRm9udEZhbWlseTppKHQudGl0bGVGb250RmFtaWx5LGUuZGVmYXVsdEZvbnRGYW1pbHkpLF90aXRsZUZvbnRTdHlsZTppKHQudGl0bGVGb250U3R5bGUsZS5kZWZhdWx0Rm9udFN0eWxlKSx0aXRsZUZvbnRTaXplOmkodC50aXRsZUZvbnRTaXplLGUuZGVmYXVsdEZvbnRTaXplKSxfdGl0bGVBbGlnbjp0LnRpdGxlQWxpZ24sdGl0bGVTcGFjaW5nOnQudGl0bGVTcGFjaW5nLHRpdGxlTWFyZ2luQm90dG9tOnQudGl0bGVNYXJnaW5Cb3R0b20sZm9vdGVyRm9udENvbG9yOnQuZm9vdGVyRm9udENvbG9yLF9mb290ZXJGb250RmFtaWx5OmkodC5mb290ZXJGb250RmFtaWx5LGUuZGVmYXVsdEZvbnRGYW1pbHkpLF9mb290ZXJGb250U3R5bGU6aSh0LmZvb3RlckZvbnRTdHlsZSxlLmRlZmF1bHRGb250U3R5bGUpLGZvb3RlckZvbnRTaXplOmkodC5mb290ZXJGb250U2l6ZSxlLmRlZmF1bHRGb250U2l6ZSksX2Zvb3RlckFsaWduOnQuZm9vdGVyQWxpZ24sZm9vdGVyU3BhY2luZzp0LmZvb3RlclNwYWNpbmcsZm9vdGVyTWFyZ2luVG9wOnQuZm9vdGVyTWFyZ2luVG9wLGNhcmV0U2l6ZTp0LmNhcmV0U2l6ZSxjb3JuZXJSYWRpdXM6dC5jb3JuZXJSYWRpdXMsYmFja2dyb3VuZENvbG9yOnQuYmFja2dyb3VuZENvbG9yLG9wYWNpdHk6MCxsZWdlbmRDb2xvckJhY2tncm91bmQ6dC5tdWx0aUtleUJhY2tncm91bmQsZGlzcGxheUNvbG9yczp0LmRpc3BsYXlDb2xvcnMsYm9yZGVyQ29sb3I6dC5ib3JkZXJDb2xvcixib3JkZXJXaWR0aDp0LmJvcmRlcldpZHRofX1mdW5jdGlvbiBvKHQpe3JldHVybiByKFtdLHModCkpfShlLmV4cG9ydHM9YS5leHRlbmQoe2luaXRpYWxpemU6ZnVuY3Rpb24oKXt0aGlzLl9tb2RlbD16KHRoaXMuX29wdGlvbnMpLHRoaXMuX2xhc3RBY3RpdmU9W119LGdldFRpdGxlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fb3B0aW9ucy5jYWxsYmFja3MsZT10LmJlZm9yZVRpdGxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxpPXQudGl0bGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLG49dC5hZnRlclRpdGxlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxhPVtdO3JldHVybiBhPXIoYT1yKGE9cihhLHMoZSkpLHMoaSkpLHMobikpfSxnZXRCZWZvcmVCb2R5OmZ1bmN0aW9uKCl7cmV0dXJuIG8odGhpcy5fb3B0aW9ucy5jYWxsYmFja3MuYmVmb3JlQm9keS5hcHBseSh0aGlzLGFyZ3VtZW50cykpfSxnZXRCb2R5OmZ1bmN0aW9uKHQsaSl7dmFyIG49dGhpcyxhPW4uX29wdGlvbnMuY2FsbGJhY2tzLG89W107cmV0dXJuIFIuZWFjaCh0LGZ1bmN0aW9uKHQpe3ZhciBlPXtiZWZvcmU6W10sbGluZXM6W10sYWZ0ZXI6W119O3IoZS5iZWZvcmUscyhhLmJlZm9yZUxhYmVsLmNhbGwobix0LGkpKSkscihlLmxpbmVzLGEubGFiZWwuY2FsbChuLHQsaSkpLHIoZS5hZnRlcixzKGEuYWZ0ZXJMYWJlbC5jYWxsKG4sdCxpKSkpLG8ucHVzaChlKX0pLG99LGdldEFmdGVyQm9keTpmdW5jdGlvbigpe3JldHVybiBvKHRoaXMuX29wdGlvbnMuY2FsbGJhY2tzLmFmdGVyQm9keS5hcHBseSh0aGlzLGFyZ3VtZW50cykpfSxnZXRGb290ZXI6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9vcHRpb25zLmNhbGxiYWNrcyxlPXQuYmVmb3JlRm9vdGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxpPXQuZm9vdGVyLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxuPXQuYWZ0ZXJGb290ZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGE9W107cmV0dXJuIGE9cihhPXIoYT1yKGEscyhlKSkscyhpKSkscyhuKSl9LHVwZGF0ZTpmdW5jdGlvbih0KXt2YXIgZSxpLG4sYSxvLHIscyxsLHUsZCxjLGgsZixnLHAsbSx2LGIseCx5LGs9dGhpcyxNPWsuX29wdGlvbnMsdz1rLl9tb2RlbCxDPWsuX21vZGVsPXooTSksUz1rLl9hY3RpdmUsXz1rLl9kYXRhLEQ9e3hBbGlnbjp3LnhBbGlnbix5QWxpZ246dy55QWxpZ259LFA9e3g6dy54LHk6dy55fSxJPXt3aWR0aDp3LndpZHRoLGhlaWdodDp3LmhlaWdodH0sQT17eDp3LmNhcmV0WCx5OncuY2FyZXRZfTtpZihTLmxlbmd0aCl7Qy5vcGFjaXR5PTE7dmFyIFQ9W10sRj1bXTtBPUxbTS5wb3NpdGlvbl0uY2FsbChrLFMsay5fZXZlbnRQb3NpdGlvbik7dmFyIE89W107Zm9yKGU9MCxpPVMubGVuZ3RoO2U8aTsrK2UpTy5wdXNoKChtPVNbZV0sYj12PXZvaWQgMCx2PW0uX3hTY2FsZSxiPW0uX3lTY2FsZXx8bS5fc2NhbGUseD1tLl9pbmRleCx5PW0uX2RhdGFzZXRJbmRleCx7eExhYmVsOnY/di5nZXRMYWJlbEZvckluZGV4KHgseSk6XCJcIix5TGFiZWw6Yj9iLmdldExhYmVsRm9ySW5kZXgoeCx5KTpcIlwiLGluZGV4OngsZGF0YXNldEluZGV4OnkseDptLl9tb2RlbC54LHk6bS5fbW9kZWwueX0pKTtNLmZpbHRlciYmKE89Ty5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIE0uZmlsdGVyKHQsXyl9KSksTS5pdGVtU29ydCYmKE89Ty5zb3J0KGZ1bmN0aW9uKHQsZSl7cmV0dXJuIE0uaXRlbVNvcnQodCxlLF8pfSkpLFIuZWFjaChPLGZ1bmN0aW9uKHQpe1QucHVzaChNLmNhbGxiYWNrcy5sYWJlbENvbG9yLmNhbGwoayx0LGsuX2NoYXJ0KSksRi5wdXNoKE0uY2FsbGJhY2tzLmxhYmVsVGV4dENvbG9yLmNhbGwoayx0LGsuX2NoYXJ0KSl9KSxDLnRpdGxlPWsuZ2V0VGl0bGUoTyxfKSxDLmJlZm9yZUJvZHk9ay5nZXRCZWZvcmVCb2R5KE8sXyksQy5ib2R5PWsuZ2V0Qm9keShPLF8pLEMuYWZ0ZXJCb2R5PWsuZ2V0QWZ0ZXJCb2R5KE8sXyksQy5mb290ZXI9ay5nZXRGb290ZXIoTyxfKSxDLng9TWF0aC5yb3VuZChBLngpLEMueT1NYXRoLnJvdW5kKEEueSksQy5jYXJldFBhZGRpbmc9TS5jYXJldFBhZGRpbmcsQy5sYWJlbENvbG9ycz1ULEMubGFiZWxUZXh0Q29sb3JzPUYsQy5kYXRhUG9pbnRzPU8sRD1mdW5jdGlvbih0LGUpe3ZhciBpLG4sYSxvLHIscz10Ll9tb2RlbCxsPXQuX2NoYXJ0LHU9dC5fY2hhcnQuY2hhcnRBcmVhLGQ9XCJjZW50ZXJcIixjPVwiY2VudGVyXCI7cy55PGUuaGVpZ2h0P2M9XCJ0b3BcIjpzLnk+bC5oZWlnaHQtZS5oZWlnaHQmJihjPVwiYm90dG9tXCIpO3ZhciBoPSh1LmxlZnQrdS5yaWdodCkvMixmPSh1LnRvcCt1LmJvdHRvbSkvMjtuPVwiY2VudGVyXCI9PT1jPyhpPWZ1bmN0aW9uKHQpe3JldHVybiB0PD1ofSxmdW5jdGlvbih0KXtyZXR1cm4gaDx0fSk6KGk9ZnVuY3Rpb24odCl7cmV0dXJuIHQ8PWUud2lkdGgvMn0sZnVuY3Rpb24odCl7cmV0dXJuIHQ+PWwud2lkdGgtZS53aWR0aC8yfSksYT1mdW5jdGlvbih0KXtyZXR1cm4gdCtlLndpZHRoK3MuY2FyZXRTaXplK3MuY2FyZXRQYWRkaW5nPmwud2lkdGh9LG89ZnVuY3Rpb24odCl7cmV0dXJuIHQtZS53aWR0aC1zLmNhcmV0U2l6ZS1zLmNhcmV0UGFkZGluZzwwfSxyPWZ1bmN0aW9uKHQpe3JldHVybiB0PD1mP1widG9wXCI6XCJib3R0b21cIn0saShzLngpPyhkPVwibGVmdFwiLGEocy54KSYmKGQ9XCJjZW50ZXJcIixjPXIocy55KSkpOm4ocy54KSYmKGQ9XCJyaWdodFwiLG8ocy54KSYmKGQ9XCJjZW50ZXJcIixjPXIocy55KSkpO3ZhciBnPXQuX29wdGlvbnM7cmV0dXJue3hBbGlnbjpnLnhBbGlnbj9nLnhBbGlnbjpkLHlBbGlnbjpnLnlBbGlnbj9nLnlBbGlnbjpjfX0odGhpcyxJPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5fY2hhcnQuY3R4LG49MiplLnlQYWRkaW5nLGE9MCxvPWUuYm9keSxyPW8ucmVkdWNlKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQrZS5iZWZvcmUubGVuZ3RoK2UubGluZXMubGVuZ3RoK2UuYWZ0ZXIubGVuZ3RofSwwKTtyKz1lLmJlZm9yZUJvZHkubGVuZ3RoK2UuYWZ0ZXJCb2R5Lmxlbmd0aDt2YXIgcz1lLnRpdGxlLmxlbmd0aCxsPWUuZm9vdGVyLmxlbmd0aCx1PWUudGl0bGVGb250U2l6ZSxkPWUuYm9keUZvbnRTaXplLGM9ZS5mb290ZXJGb250U2l6ZTtuKz1zKnUsbis9cz8ocy0xKSplLnRpdGxlU3BhY2luZzowLG4rPXM/ZS50aXRsZU1hcmdpbkJvdHRvbTowLG4rPXIqZCxuKz1yPyhyLTEpKmUuYm9keVNwYWNpbmc6MCxuKz1sP2UuZm9vdGVyTWFyZ2luVG9wOjAsbis9bCpjLG4rPWw/KGwtMSkqZS5mb290ZXJTcGFjaW5nOjA7dmFyIGg9MCxmPWZ1bmN0aW9uKHQpe2E9TWF0aC5tYXgoYSxpLm1lYXN1cmVUZXh0KHQpLndpZHRoK2gpfTtyZXR1cm4gaS5mb250PVIuZm9udFN0cmluZyh1LGUuX3RpdGxlRm9udFN0eWxlLGUuX3RpdGxlRm9udEZhbWlseSksUi5lYWNoKGUudGl0bGUsZiksaS5mb250PVIuZm9udFN0cmluZyhkLGUuX2JvZHlGb250U3R5bGUsZS5fYm9keUZvbnRGYW1pbHkpLFIuZWFjaChlLmJlZm9yZUJvZHkuY29uY2F0KGUuYWZ0ZXJCb2R5KSxmKSxoPWUuZGlzcGxheUNvbG9ycz9kKzI6MCxSLmVhY2gobyxmdW5jdGlvbih0KXtSLmVhY2godC5iZWZvcmUsZiksUi5lYWNoKHQubGluZXMsZiksUi5lYWNoKHQuYWZ0ZXIsZil9KSxoPTAsaS5mb250PVIuZm9udFN0cmluZyhjLGUuX2Zvb3RlckZvbnRTdHlsZSxlLl9mb290ZXJGb250RmFtaWx5KSxSLmVhY2goZS5mb290ZXIsZikse3dpZHRoOmErPTIqZS54UGFkZGluZyxoZWlnaHQ6bn19KHRoaXMsQykpLG49QyxhPUksbz1ELHI9ay5fY2hhcnQscz1uLngsbD1uLnksdT1uLmNhcmV0U2l6ZSxkPW4uY2FyZXRQYWRkaW5nLGM9bi5jb3JuZXJSYWRpdXMsaD1vLnhBbGlnbixmPW8ueUFsaWduLGc9dStkLHA9YytkLFwicmlnaHRcIj09PWg/cy09YS53aWR0aDpcImNlbnRlclwiPT09aCYmKChzLT1hLndpZHRoLzIpK2Eud2lkdGg+ci53aWR0aCYmKHM9ci53aWR0aC1hLndpZHRoKSxzPDAmJihzPTApKSxcInRvcFwiPT09Zj9sKz1nOmwtPVwiYm90dG9tXCI9PT1mP2EuaGVpZ2h0K2c6YS5oZWlnaHQvMixcImNlbnRlclwiPT09Zj9cImxlZnRcIj09PWg/cys9ZzpcInJpZ2h0XCI9PT1oJiYocy09Zyk6XCJsZWZ0XCI9PT1oP3MtPXA6XCJyaWdodFwiPT09aCYmKHMrPXApLFA9e3g6cyx5Omx9fWVsc2UgQy5vcGFjaXR5PTA7cmV0dXJuIEMueEFsaWduPUQueEFsaWduLEMueUFsaWduPUQueUFsaWduLEMueD1QLngsQy55PVAueSxDLndpZHRoPUkud2lkdGgsQy5oZWlnaHQ9SS5oZWlnaHQsQy5jYXJldFg9QS54LEMuY2FyZXRZPUEueSxrLl9tb2RlbD1DLHQmJk0uY3VzdG9tJiZNLmN1c3RvbS5jYWxsKGssQyksa30sZHJhd0NhcmV0OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fY2hhcnQuY3R4LG49dGhpcy5fdmlldyxhPXRoaXMuZ2V0Q2FyZXRQb3NpdGlvbih0LGUsbik7aS5saW5lVG8oYS54MSxhLnkxKSxpLmxpbmVUbyhhLngyLGEueTIpLGkubGluZVRvKGEueDMsYS55Myl9LGdldENhcmV0UG9zaXRpb246ZnVuY3Rpb24odCxlLGkpe3ZhciBuLGEsbyxyLHMsbCx1PWkuY2FyZXRTaXplLGQ9aS5jb3JuZXJSYWRpdXMsYz1pLnhBbGlnbixoPWkueUFsaWduLGY9dC54LGc9dC55LHA9ZS53aWR0aCxtPWUuaGVpZ2h0O2lmKFwiY2VudGVyXCI9PT1oKXM9ZyttLzIsbD1cImxlZnRcIj09PWM/KGE9KG49ZiktdSxvPW4scj1zK3Uscy11KTooYT0obj1mK3ApK3Usbz1uLHI9cy11LHMrdSk7ZWxzZSBpZihvPShuPVwibGVmdFwiPT09Yz8oYT1mK2QrdSktdTpcInJpZ2h0XCI9PT1jPyhhPWYrcC1kLXUpLXU6KGE9aS5jYXJldFgpLXUsYSt1KSxcInRvcFwiPT09aClzPShyPWcpLXUsbD1yO2Vsc2V7cz0ocj1nK20pK3UsbD1yO3ZhciB2PW87bz1uLG49dn1yZXR1cm57eDE6bix4MjphLHgzOm8seTE6cix5MjpzLHkzOmx9fSxkcmF3VGl0bGU6ZnVuY3Rpb24odCxlLGksbil7dmFyIGE9ZS50aXRsZTtpZihhLmxlbmd0aCl7aS50ZXh0QWxpZ249ZS5fdGl0bGVBbGlnbixpLnRleHRCYXNlbGluZT1cInRvcFwiO3ZhciBvLHIscz1lLnRpdGxlRm9udFNpemUsbD1lLnRpdGxlU3BhY2luZztmb3IoaS5maWxsU3R5bGU9aChlLnRpdGxlRm9udENvbG9yLG4pLGkuZm9udD1SLmZvbnRTdHJpbmcocyxlLl90aXRsZUZvbnRTdHlsZSxlLl90aXRsZUZvbnRGYW1pbHkpLG89MCxyPWEubGVuZ3RoO288cjsrK28paS5maWxsVGV4dChhW29dLHQueCx0LnkpLHQueSs9cytsLG8rMT09PWEubGVuZ3RoJiYodC55Kz1lLnRpdGxlTWFyZ2luQm90dG9tLWwpfX0sZHJhd0JvZHk6ZnVuY3Rpb24obixhLG8scil7dmFyIHM9YS5ib2R5Rm9udFNpemUsZT1hLmJvZHlTcGFjaW5nLHQ9YS5ib2R5O28udGV4dEFsaWduPWEuX2JvZHlBbGlnbixvLnRleHRCYXNlbGluZT1cInRvcFwiLG8uZm9udD1SLmZvbnRTdHJpbmcocyxhLl9ib2R5Rm9udFN0eWxlLGEuX2JvZHlGb250RmFtaWx5KTt2YXIgaT0wLGw9ZnVuY3Rpb24odCl7by5maWxsVGV4dCh0LG4ueCtpLG4ueSksbi55Kz1zK2V9O28uZmlsbFN0eWxlPWgoYS5ib2R5Rm9udENvbG9yLHIpLFIuZWFjaChhLmJlZm9yZUJvZHksbCk7dmFyIHU9YS5kaXNwbGF5Q29sb3JzO2k9dT9zKzI6MCxSLmVhY2godCxmdW5jdGlvbih0LGUpe3ZhciBpPWgoYS5sYWJlbFRleHRDb2xvcnNbZV0scik7by5maWxsU3R5bGU9aSxSLmVhY2godC5iZWZvcmUsbCksUi5lYWNoKHQubGluZXMsZnVuY3Rpb24odCl7dSYmKG8uZmlsbFN0eWxlPWgoYS5sZWdlbmRDb2xvckJhY2tncm91bmQsciksby5maWxsUmVjdChuLngsbi55LHMscyksby5saW5lV2lkdGg9MSxvLnN0cm9rZVN0eWxlPWgoYS5sYWJlbENvbG9yc1tlXS5ib3JkZXJDb2xvcixyKSxvLnN0cm9rZVJlY3Qobi54LG4ueSxzLHMpLG8uZmlsbFN0eWxlPWgoYS5sYWJlbENvbG9yc1tlXS5iYWNrZ3JvdW5kQ29sb3Isciksby5maWxsUmVjdChuLngrMSxuLnkrMSxzLTIscy0yKSxvLmZpbGxTdHlsZT1pKSxsKHQpfSksUi5lYWNoKHQuYWZ0ZXIsbCl9KSxpPTAsUi5lYWNoKGEuYWZ0ZXJCb2R5LGwpLG4ueS09ZX0sZHJhd0Zvb3RlcjpmdW5jdGlvbihlLGksbix0KXt2YXIgYT1pLmZvb3RlcjthLmxlbmd0aCYmKGUueSs9aS5mb290ZXJNYXJnaW5Ub3Asbi50ZXh0QWxpZ249aS5fZm9vdGVyQWxpZ24sbi50ZXh0QmFzZWxpbmU9XCJ0b3BcIixuLmZpbGxTdHlsZT1oKGkuZm9vdGVyRm9udENvbG9yLHQpLG4uZm9udD1SLmZvbnRTdHJpbmcoaS5mb290ZXJGb250U2l6ZSxpLl9mb290ZXJGb250U3R5bGUsaS5fZm9vdGVyRm9udEZhbWlseSksUi5lYWNoKGEsZnVuY3Rpb24odCl7bi5maWxsVGV4dCh0LGUueCxlLnkpLGUueSs9aS5mb290ZXJGb250U2l6ZStpLmZvb3RlclNwYWNpbmd9KSl9LGRyYXdCYWNrZ3JvdW5kOmZ1bmN0aW9uKHQsZSxpLG4sYSl7aS5maWxsU3R5bGU9aChlLmJhY2tncm91bmRDb2xvcixhKSxpLnN0cm9rZVN0eWxlPWgoZS5ib3JkZXJDb2xvcixhKSxpLmxpbmVXaWR0aD1lLmJvcmRlcldpZHRoO3ZhciBvPWUueEFsaWduLHI9ZS55QWxpZ24scz10LngsbD10LnksdT1uLndpZHRoLGQ9bi5oZWlnaHQsYz1lLmNvcm5lclJhZGl1cztpLmJlZ2luUGF0aCgpLGkubW92ZVRvKHMrYyxsKSxcInRvcFwiPT09ciYmdGhpcy5kcmF3Q2FyZXQodCxuKSxpLmxpbmVUbyhzK3UtYyxsKSxpLnF1YWRyYXRpY0N1cnZlVG8ocyt1LGwscyt1LGwrYyksXCJjZW50ZXJcIj09PXImJlwicmlnaHRcIj09PW8mJnRoaXMuZHJhd0NhcmV0KHQsbiksaS5saW5lVG8ocyt1LGwrZC1jKSxpLnF1YWRyYXRpY0N1cnZlVG8ocyt1LGwrZCxzK3UtYyxsK2QpLFwiYm90dG9tXCI9PT1yJiZ0aGlzLmRyYXdDYXJldCh0LG4pLGkubGluZVRvKHMrYyxsK2QpLGkucXVhZHJhdGljQ3VydmVUbyhzLGwrZCxzLGwrZC1jKSxcImNlbnRlclwiPT09ciYmXCJsZWZ0XCI9PT1vJiZ0aGlzLmRyYXdDYXJldCh0LG4pLGkubGluZVRvKHMsbCtjKSxpLnF1YWRyYXRpY0N1cnZlVG8ocyxsLHMrYyxsKSxpLmNsb3NlUGF0aCgpLGkuZmlsbCgpLDA8ZS5ib3JkZXJXaWR0aCYmaS5zdHJva2UoKX0sZHJhdzpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2NoYXJ0LmN0eCxlPXRoaXMuX3ZpZXc7aWYoMCE9PWUub3BhY2l0eSl7dmFyIGk9e3dpZHRoOmUud2lkdGgsaGVpZ2h0OmUuaGVpZ2h0fSxuPXt4OmUueCx5OmUueX0sYT1NYXRoLmFicyhlLm9wYWNpdHk8LjAwMSk/MDplLm9wYWNpdHksbz1lLnRpdGxlLmxlbmd0aHx8ZS5iZWZvcmVCb2R5Lmxlbmd0aHx8ZS5ib2R5Lmxlbmd0aHx8ZS5hZnRlckJvZHkubGVuZ3RofHxlLmZvb3Rlci5sZW5ndGg7dGhpcy5fb3B0aW9ucy5lbmFibGVkJiZvJiYodGhpcy5kcmF3QmFja2dyb3VuZChuLGUsdCxpLGEpLG4ueCs9ZS54UGFkZGluZyxuLnkrPWUueVBhZGRpbmcsdGhpcy5kcmF3VGl0bGUobixlLHQsYSksdGhpcy5kcmF3Qm9keShuLGUsdCxhKSx0aGlzLmRyYXdGb290ZXIobixlLHQsYSkpfX0saGFuZGxlRXZlbnQ6ZnVuY3Rpb24odCl7dmFyIGUsaT10aGlzLG49aS5fb3B0aW9ucztyZXR1cm4gaS5fbGFzdEFjdGl2ZT1pLl9sYXN0QWN0aXZlfHxbXSxcIm1vdXNlb3V0XCI9PT10LnR5cGU/aS5fYWN0aXZlPVtdOmkuX2FjdGl2ZT1pLl9jaGFydC5nZXRFbGVtZW50c0F0RXZlbnRGb3JNb2RlKHQsbi5tb2RlLG4pLChlPSFSLmFycmF5RXF1YWxzKGkuX2FjdGl2ZSxpLl9sYXN0QWN0aXZlKSkmJihpLl9sYXN0QWN0aXZlPWkuX2FjdGl2ZSwobi5lbmFibGVkfHxuLmN1c3RvbSkmJihpLl9ldmVudFBvc2l0aW9uPXt4OnQueCx5OnQueX0saS51cGRhdGUoITApLGkucGl2b3QoKSkpLGV9fSkpLnBvc2l0aW9uZXJzPUx9LHsyNjoyNiwyNzoyNyw0Njo0Nn1dLDM3OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49dCgyNiksYT10KDI3KSxkPXQoNDYpO24uX3NldChcImdsb2JhbFwiLHtlbGVtZW50czp7YXJjOntiYWNrZ3JvdW5kQ29sb3I6bi5nbG9iYWwuZGVmYXVsdENvbG9yLGJvcmRlckNvbG9yOlwiI2ZmZlwiLGJvcmRlcldpZHRoOjJ9fX0pLGUuZXhwb3J0cz1hLmV4dGVuZCh7aW5MYWJlbFJhbmdlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX3ZpZXc7cmV0dXJuISFlJiZNYXRoLnBvdyh0LWUueCwyKTxNYXRoLnBvdyhlLnJhZGl1cytlLmhvdmVyUmFkaXVzLDIpfSxpblJhbmdlOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fdmlldztpZihpKXtmb3IodmFyIG49ZC5nZXRBbmdsZUZyb21Qb2ludChpLHt4OnQseTplfSksYT1uLmFuZ2xlLG89bi5kaXN0YW5jZSxyPWkuc3RhcnRBbmdsZSxzPWkuZW5kQW5nbGU7czxyOylzKz0yKk1hdGguUEk7Zm9yKDtzPGE7KWEtPTIqTWF0aC5QSTtmb3IoO2E8cjspYSs9MipNYXRoLlBJO3ZhciBsPXI8PWEmJmE8PXMsdT1vPj1pLmlubmVyUmFkaXVzJiZvPD1pLm91dGVyUmFkaXVzO3JldHVybiBsJiZ1fXJldHVybiExfSxnZXRDZW50ZXJQb2ludDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX3ZpZXcsZT0odC5zdGFydEFuZ2xlK3QuZW5kQW5nbGUpLzIsaT0odC5pbm5lclJhZGl1cyt0Lm91dGVyUmFkaXVzKS8yO3JldHVybnt4OnQueCtNYXRoLmNvcyhlKSppLHk6dC55K01hdGguc2luKGUpKml9fSxnZXRBcmVhOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fdmlldztyZXR1cm4gTWF0aC5QSSooKHQuZW5kQW5nbGUtdC5zdGFydEFuZ2xlKS8oMipNYXRoLlBJKSkqKE1hdGgucG93KHQub3V0ZXJSYWRpdXMsMiktTWF0aC5wb3codC5pbm5lclJhZGl1cywyKSl9LHRvb2x0aXBQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX3ZpZXcsZT10LnN0YXJ0QW5nbGUrKHQuZW5kQW5nbGUtdC5zdGFydEFuZ2xlKS8yLGk9KHQub3V0ZXJSYWRpdXMtdC5pbm5lclJhZGl1cykvMit0LmlubmVyUmFkaXVzO3JldHVybnt4OnQueCtNYXRoLmNvcyhlKSppLHk6dC55K01hdGguc2luKGUpKml9fSxkcmF3OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fY2hhcnQuY3R4LGU9dGhpcy5fdmlldyxpPWUuc3RhcnRBbmdsZSxuPWUuZW5kQW5nbGU7dC5iZWdpblBhdGgoKSx0LmFyYyhlLngsZS55LGUub3V0ZXJSYWRpdXMsaSxuKSx0LmFyYyhlLngsZS55LGUuaW5uZXJSYWRpdXMsbixpLCEwKSx0LmNsb3NlUGF0aCgpLHQuc3Ryb2tlU3R5bGU9ZS5ib3JkZXJDb2xvcix0LmxpbmVXaWR0aD1lLmJvcmRlcldpZHRoLHQuZmlsbFN0eWxlPWUuYmFja2dyb3VuZENvbG9yLHQuZmlsbCgpLHQubGluZUpvaW49XCJiZXZlbFwiLGUuYm9yZGVyV2lkdGgmJnQuc3Ryb2tlKCl9fSl9LHsyNjoyNiwyNzoyNyw0Njo0Nn1dLDM4OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49dCgyNiksYT10KDI3KSxkPXQoNDYpLGM9bi5nbG9iYWw7bi5fc2V0KFwiZ2xvYmFsXCIse2VsZW1lbnRzOntsaW5lOnt0ZW5zaW9uOi40LGJhY2tncm91bmRDb2xvcjpjLmRlZmF1bHRDb2xvcixib3JkZXJXaWR0aDozLGJvcmRlckNvbG9yOmMuZGVmYXVsdENvbG9yLGJvcmRlckNhcFN0eWxlOlwiYnV0dFwiLGJvcmRlckRhc2g6W10sYm9yZGVyRGFzaE9mZnNldDowLGJvcmRlckpvaW5TdHlsZTpcIm1pdGVyXCIsY2FwQmV6aWVyUG9pbnRzOiEwLGZpbGw6ITB9fX0pLGUuZXhwb3J0cz1hLmV4dGVuZCh7ZHJhdzpmdW5jdGlvbigpe3ZhciB0LGUsaSxuLGE9dGhpcy5fdmlldyxvPXRoaXMuX2NoYXJ0LmN0eCxyPWEuc3BhbkdhcHMscz10aGlzLl9jaGlsZHJlbi5zbGljZSgpLGw9Yy5lbGVtZW50cy5saW5lLHU9LTE7Zm9yKHRoaXMuX2xvb3AmJnMubGVuZ3RoJiZzLnB1c2goc1swXSksby5zYXZlKCksby5saW5lQ2FwPWEuYm9yZGVyQ2FwU3R5bGV8fGwuYm9yZGVyQ2FwU3R5bGUsby5zZXRMaW5lRGFzaCYmby5zZXRMaW5lRGFzaChhLmJvcmRlckRhc2h8fGwuYm9yZGVyRGFzaCksby5saW5lRGFzaE9mZnNldD1hLmJvcmRlckRhc2hPZmZzZXR8fGwuYm9yZGVyRGFzaE9mZnNldCxvLmxpbmVKb2luPWEuYm9yZGVySm9pblN0eWxlfHxsLmJvcmRlckpvaW5TdHlsZSxvLmxpbmVXaWR0aD1hLmJvcmRlcldpZHRofHxsLmJvcmRlcldpZHRoLG8uc3Ryb2tlU3R5bGU9YS5ib3JkZXJDb2xvcnx8Yy5kZWZhdWx0Q29sb3Isby5iZWdpblBhdGgoKSx1PS0xLHQ9MDt0PHMubGVuZ3RoOysrdCllPXNbdF0saT1kLnByZXZpb3VzSXRlbShzLHQpLG49ZS5fdmlldywwPT09dD9uLnNraXB8fChvLm1vdmVUbyhuLngsbi55KSx1PXQpOihpPS0xPT09dT9pOnNbdV0sbi5za2lwfHwodSE9PXQtMSYmIXJ8fC0xPT09dT9vLm1vdmVUbyhuLngsbi55KTpkLmNhbnZhcy5saW5lVG8obyxpLl92aWV3LGUuX3ZpZXcpLHU9dCkpO28uc3Ryb2tlKCksby5yZXN0b3JlKCl9fSl9LHsyNjoyNiwyNzoyNyw0Njo0Nn1dLDM5OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIHU9dCgyNiksbj10KDI3KSxkPXQoNDYpLGM9dS5nbG9iYWwuZGVmYXVsdENvbG9yO2Z1bmN0aW9uIGEodCl7dmFyIGU9dGhpcy5fdmlldztyZXR1cm4hIWUmJk1hdGguYWJzKHQtZS54KTxlLnJhZGl1cytlLmhpdFJhZGl1c311Ll9zZXQoXCJnbG9iYWxcIix7ZWxlbWVudHM6e3BvaW50OntyYWRpdXM6Myxwb2ludFN0eWxlOlwiY2lyY2xlXCIsYmFja2dyb3VuZENvbG9yOmMsYm9yZGVyQ29sb3I6Yyxib3JkZXJXaWR0aDoxLGhpdFJhZGl1czoxLGhvdmVyUmFkaXVzOjQsaG92ZXJCb3JkZXJXaWR0aDoxfX19KSxlLmV4cG9ydHM9bi5leHRlbmQoe2luUmFuZ2U6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLl92aWV3O3JldHVybiEhaSYmTWF0aC5wb3codC1pLngsMikrTWF0aC5wb3coZS1pLnksMik8TWF0aC5wb3coaS5oaXRSYWRpdXMraS5yYWRpdXMsMil9LGluTGFiZWxSYW5nZTphLGluWFJhbmdlOmEsaW5ZUmFuZ2U6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fdmlldztyZXR1cm4hIWUmJk1hdGguYWJzKHQtZS55KTxlLnJhZGl1cytlLmhpdFJhZGl1c30sZ2V0Q2VudGVyUG9pbnQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl92aWV3O3JldHVybnt4OnQueCx5OnQueX19LGdldEFyZWE6ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5QSSpNYXRoLnBvdyh0aGlzLl92aWV3LnJhZGl1cywyKX0sdG9vbHRpcFBvc2l0aW9uOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fdmlldztyZXR1cm57eDp0LngseTp0LnkscGFkZGluZzp0LnJhZGl1cyt0LmJvcmRlcldpZHRofX0sZHJhdzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl92aWV3LGk9dGhpcy5fbW9kZWwsbj10aGlzLl9jaGFydC5jdHgsYT1lLnBvaW50U3R5bGUsbz1lLnJvdGF0aW9uLHI9ZS5yYWRpdXMscz1lLngsbD1lLnk7ZS5za2lwfHwodm9pZCAwPT09dHx8aS54Pj10LmxlZnQmJjEuMDEqdC5yaWdodD49aS54JiZpLnk+PXQudG9wJiYxLjAxKnQuYm90dG9tPj1pLnkpJiYobi5zdHJva2VTdHlsZT1lLmJvcmRlckNvbG9yfHxjLG4ubGluZVdpZHRoPWQudmFsdWVPckRlZmF1bHQoZS5ib3JkZXJXaWR0aCx1Lmdsb2JhbC5lbGVtZW50cy5wb2ludC5ib3JkZXJXaWR0aCksbi5maWxsU3R5bGU9ZS5iYWNrZ3JvdW5kQ29sb3J8fGMsZC5jYW52YXMuZHJhd1BvaW50KG4sYSxyLHMsbCxvKSl9fSl9LHsyNjoyNiwyNzoyNyw0Njo0Nn1dLDQwOltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49dCgyNiksYT10KDI3KTtmdW5jdGlvbiBsKHQpe3JldHVybiB2b2lkIDAhPT10Ll92aWV3LndpZHRofWZ1bmN0aW9uIG8odCl7dmFyIGUsaSxuLGEsbz10Ll92aWV3O2lmKGwodCkpe3ZhciByPW8ud2lkdGgvMjtlPW8ueC1yLGk9by54K3Isbj1NYXRoLm1pbihvLnksby5iYXNlKSxhPU1hdGgubWF4KG8ueSxvLmJhc2UpfWVsc2V7dmFyIHM9by5oZWlnaHQvMjtlPU1hdGgubWluKG8ueCxvLmJhc2UpLGk9TWF0aC5tYXgoby54LG8uYmFzZSksbj1vLnktcyxhPW8ueStzfXJldHVybntsZWZ0OmUsdG9wOm4scmlnaHQ6aSxib3R0b206YX19bi5fc2V0KFwiZ2xvYmFsXCIse2VsZW1lbnRzOntyZWN0YW5nbGU6e2JhY2tncm91bmRDb2xvcjpuLmdsb2JhbC5kZWZhdWx0Q29sb3IsYm9yZGVyQ29sb3I6bi5nbG9iYWwuZGVmYXVsdENvbG9yLGJvcmRlclNraXBwZWQ6XCJib3R0b21cIixib3JkZXJXaWR0aDowfX19KSxlLmV4cG9ydHM9YS5leHRlbmQoe2RyYXc6ZnVuY3Rpb24oKXt2YXIgdCxlLGksbixhLG8scixzPXRoaXMuX2NoYXJ0LmN0eCxsPXRoaXMuX3ZpZXcsdT1sLmJvcmRlcldpZHRoO2lmKHI9bC5ob3Jpem9udGFsPyh0PWwuYmFzZSxlPWwueCxpPWwueS1sLmhlaWdodC8yLG49bC55K2wuaGVpZ2h0LzIsYT10PGU/MTotMSxvPTEsbC5ib3JkZXJTa2lwcGVkfHxcImxlZnRcIik6KHQ9bC54LWwud2lkdGgvMixlPWwueCtsLndpZHRoLzIsYT0xLG89KGk9bC55KTwobj1sLmJhc2UpPzE6LTEsbC5ib3JkZXJTa2lwcGVkfHxcImJvdHRvbVwiKSx1KXt2YXIgZD1NYXRoLm1pbihNYXRoLmFicyh0LWUpLE1hdGguYWJzKGktbikpLGM9KHU9ZDx1P2Q6dSkvMixoPXQrKFwibGVmdFwiIT09cj9jKmE6MCksZj1lKyhcInJpZ2h0XCIhPT1yPy1jKmE6MCksZz1pKyhcInRvcFwiIT09cj9jKm86MCkscD1uKyhcImJvdHRvbVwiIT09cj8tYypvOjApO2ghPT1mJiYoaT1nLG49cCksZyE9PXAmJih0PWgsZT1mKX1zLmJlZ2luUGF0aCgpLHMuZmlsbFN0eWxlPWwuYmFja2dyb3VuZENvbG9yLHMuc3Ryb2tlU3R5bGU9bC5ib3JkZXJDb2xvcixzLmxpbmVXaWR0aD11O3ZhciBtPVtbdCxuXSxbdCxpXSxbZSxpXSxbZSxuXV0sdj1bXCJib3R0b21cIixcImxlZnRcIixcInRvcFwiLFwicmlnaHRcIl0uaW5kZXhPZihyLDApO2Z1bmN0aW9uIGIodCl7cmV0dXJuIG1bKHYrdCklNF19LTE9PT12JiYodj0wKTt2YXIgeD1iKDApO3MubW92ZVRvKHhbMF0seFsxXSk7Zm9yKHZhciB5PTE7eTw0O3krKyl4PWIoeSkscy5saW5lVG8oeFswXSx4WzFdKTtzLmZpbGwoKSx1JiZzLnN0cm9rZSgpfSxoZWlnaHQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl92aWV3O3JldHVybiB0LmJhc2UtdC55fSxpblJhbmdlOmZ1bmN0aW9uKHQsZSl7dmFyIGk9ITE7aWYodGhpcy5fdmlldyl7dmFyIG49byh0aGlzKTtpPXQ+PW4ubGVmdCYmdDw9bi5yaWdodCYmZT49bi50b3AmJmU8PW4uYm90dG9tfXJldHVybiBpfSxpbkxhYmVsUmFuZ2U6ZnVuY3Rpb24odCxlKXtpZighdGhpcy5fdmlldylyZXR1cm4hMTt2YXIgaT1vKHRoaXMpO3JldHVybiBsKHRoaXMpP3Q+PWkubGVmdCYmdDw9aS5yaWdodDplPj1pLnRvcCYmZTw9aS5ib3R0b219LGluWFJhbmdlOmZ1bmN0aW9uKHQpe3ZhciBlPW8odGhpcyk7cmV0dXJuIHQ+PWUubGVmdCYmdDw9ZS5yaWdodH0saW5ZUmFuZ2U6ZnVuY3Rpb24odCl7dmFyIGU9byh0aGlzKTtyZXR1cm4gdD49ZS50b3AmJnQ8PWUuYm90dG9tfSxnZXRDZW50ZXJQb2ludDpmdW5jdGlvbigpe3ZhciB0LGUsaT10aGlzLl92aWV3O3JldHVybiBlPWwodGhpcyk/KHQ9aS54LChpLnkraS5iYXNlKS8yKToodD0oaS54K2kuYmFzZSkvMixpLnkpLHt4OnQseTplfX0sZ2V0QXJlYTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX3ZpZXc7cmV0dXJuIHQud2lkdGgqTWF0aC5hYnModC55LXQuYmFzZSl9LHRvb2x0aXBQb3NpdGlvbjpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX3ZpZXc7cmV0dXJue3g6dC54LHk6dC55fX19KX0sezI2OjI2LDI3OjI3fV0sNDE6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtlLmV4cG9ydHM9e30sZS5leHBvcnRzLkFyYz10KDM3KSxlLmV4cG9ydHMuTGluZT10KDM4KSxlLmV4cG9ydHMuUG9pbnQ9dCgzOSksZS5leHBvcnRzLlJlY3RhbmdsZT10KDQwKX0sezM3OjM3LDM4OjM4LDM5OjM5LDQwOjQwfV0sNDI6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjt2YXIgbj10KDQzKTtpPWUuZXhwb3J0cz17Y2xlYXI6ZnVuY3Rpb24odCl7dC5jdHguY2xlYXJSZWN0KDAsMCx0LndpZHRoLHQuaGVpZ2h0KX0scm91bmRlZFJlY3Q6ZnVuY3Rpb24odCxlLGksbixhLG8pe2lmKG8pe3ZhciByPU1hdGgubWluKG8sYS8yLTFlLTcsbi8yLTFlLTcpO3QubW92ZVRvKGUrcixpKSx0LmxpbmVUbyhlK24tcixpKSx0LmFyY1RvKGUrbixpLGUrbixpK3IsciksdC5saW5lVG8oZStuLGkrYS1yKSx0LmFyY1RvKGUrbixpK2EsZStuLXIsaSthLHIpLHQubGluZVRvKGUrcixpK2EpLHQuYXJjVG8oZSxpK2EsZSxpK2EtcixyKSx0LmxpbmVUbyhlLGkrciksdC5hcmNUbyhlLGksZStyLGksciksdC5jbG9zZVBhdGgoKSx0Lm1vdmVUbyhlLGkpfWVsc2UgdC5yZWN0KGUsaSxuLGEpfSxkcmF3UG9pbnQ6ZnVuY3Rpb24odCxlLGksbixhLG8pe3ZhciByLHMsbCx1LGQsYztpZihvPW98fDAsIWV8fFwib2JqZWN0XCIhPXR5cGVvZiBlfHxcIltvYmplY3QgSFRNTEltYWdlRWxlbWVudF1cIiE9PShyPWUudG9TdHJpbmcoKSkmJlwiW29iamVjdCBIVE1MQ2FudmFzRWxlbWVudF1cIiE9PXIpe2lmKCEoaXNOYU4oaSl8fGk8PTApKXtzd2l0Y2godC5zYXZlKCksdC50cmFuc2xhdGUobixhKSx0LnJvdGF0ZShvKk1hdGguUEkvMTgwKSx0LmJlZ2luUGF0aCgpLGUpe2RlZmF1bHQ6dC5hcmMoMCwwLGksMCwyKk1hdGguUEkpLHQuY2xvc2VQYXRoKCk7YnJlYWs7Y2FzZVwidHJpYW5nbGVcIjpkPShzPTMqaS9NYXRoLnNxcnQoMykpKk1hdGguc3FydCgzKS8yLHQubW92ZVRvKC1zLzIsZC8zKSx0LmxpbmVUbyhzLzIsZC8zKSx0LmxpbmVUbygwLC0yKmQvMyksdC5jbG9zZVBhdGgoKTticmVhaztjYXNlXCJyZWN0XCI6Yz0xL01hdGguU1FSVDIqaSx0LnJlY3QoLWMsLWMsMipjLDIqYyk7YnJlYWs7Y2FzZVwicmVjdFJvdW5kZWRcIjp2YXIgaD1pL01hdGguU1FSVDIsZj0taCxnPS1oLHA9TWF0aC5TUVJUMippO3RoaXMucm91bmRlZFJlY3QodCxmLGcscCxwLC40MjUqaSk7YnJlYWs7Y2FzZVwicmVjdFJvdFwiOmM9MS9NYXRoLlNRUlQyKmksdC5tb3ZlVG8oLWMsMCksdC5saW5lVG8oMCxjKSx0LmxpbmVUbyhjLDApLHQubGluZVRvKDAsLWMpLHQuY2xvc2VQYXRoKCk7YnJlYWs7Y2FzZVwiY3Jvc3NcIjp0Lm1vdmVUbygwLGkpLHQubGluZVRvKDAsLWkpLHQubW92ZVRvKC1pLDApLHQubGluZVRvKGksMCk7YnJlYWs7Y2FzZVwiY3Jvc3NSb3RcIjpsPU1hdGguY29zKE1hdGguUEkvNCkqaSx1PU1hdGguc2luKE1hdGguUEkvNCkqaSx0Lm1vdmVUbygtbCwtdSksdC5saW5lVG8obCx1KSx0Lm1vdmVUbygtbCx1KSx0LmxpbmVUbyhsLC11KTticmVhaztjYXNlXCJzdGFyXCI6dC5tb3ZlVG8oMCxpKSx0LmxpbmVUbygwLC1pKSx0Lm1vdmVUbygtaSwwKSx0LmxpbmVUbyhpLDApLGw9TWF0aC5jb3MoTWF0aC5QSS80KSppLHU9TWF0aC5zaW4oTWF0aC5QSS80KSppLHQubW92ZVRvKC1sLC11KSx0LmxpbmVUbyhsLHUpLHQubW92ZVRvKC1sLHUpLHQubGluZVRvKGwsLXUpO2JyZWFrO2Nhc2VcImxpbmVcIjp0Lm1vdmVUbygtaSwwKSx0LmxpbmVUbyhpLDApO2JyZWFrO2Nhc2VcImRhc2hcIjp0Lm1vdmVUbygwLDApLHQubGluZVRvKGksMCl9dC5maWxsKCksdC5zdHJva2UoKSx0LnJlc3RvcmUoKX19ZWxzZSB0LmRyYXdJbWFnZShlLG4tZS53aWR0aC8yLGEtZS5oZWlnaHQvMixlLndpZHRoLGUuaGVpZ2h0KX0sY2xpcEFyZWE6ZnVuY3Rpb24odCxlKXt0LnNhdmUoKSx0LmJlZ2luUGF0aCgpLHQucmVjdChlLmxlZnQsZS50b3AsZS5yaWdodC1lLmxlZnQsZS5ib3R0b20tZS50b3ApLHQuY2xpcCgpfSx1bmNsaXBBcmVhOmZ1bmN0aW9uKHQpe3QucmVzdG9yZSgpfSxsaW5lVG86ZnVuY3Rpb24odCxlLGksbil7aWYoaS5zdGVwcGVkTGluZSlyZXR1cm5cImFmdGVyXCI9PT1pLnN0ZXBwZWRMaW5lJiYhbnx8XCJhZnRlclwiIT09aS5zdGVwcGVkTGluZSYmbj90LmxpbmVUbyhlLngsaS55KTp0LmxpbmVUbyhpLngsZS55KSx2b2lkIHQubGluZVRvKGkueCxpLnkpO2kudGVuc2lvbj90LmJlemllckN1cnZlVG8obj9lLmNvbnRyb2xQb2ludFByZXZpb3VzWDplLmNvbnRyb2xQb2ludE5leHRYLG4/ZS5jb250cm9sUG9pbnRQcmV2aW91c1k6ZS5jb250cm9sUG9pbnROZXh0WSxuP2kuY29udHJvbFBvaW50TmV4dFg6aS5jb250cm9sUG9pbnRQcmV2aW91c1gsbj9pLmNvbnRyb2xQb2ludE5leHRZOmkuY29udHJvbFBvaW50UHJldmlvdXNZLGkueCxpLnkpOnQubGluZVRvKGkueCxpLnkpfX07bi5jbGVhcj1pLmNsZWFyLG4uZHJhd1JvdW5kZWRSZWN0YW5nbGU9ZnVuY3Rpb24odCl7dC5iZWdpblBhdGgoKSxpLnJvdW5kZWRSZWN0LmFwcGx5KGksYXJndW1lbnRzKX19LHs0Mzo0M31dLDQzOltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIG4sZD17bm9vcDpmdW5jdGlvbigpe30sdWlkOihuPTAsZnVuY3Rpb24oKXtyZXR1cm4gbisrfSksaXNOdWxsT3JVbmRlZjpmdW5jdGlvbih0KXtyZXR1cm4gbnVsbD09dH0saXNBcnJheTpBcnJheS5pc0FycmF5P0FycmF5LmlzQXJyYXk6ZnVuY3Rpb24odCl7cmV0dXJuXCJbb2JqZWN0IEFycmF5XVwiPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSxpc09iamVjdDpmdW5jdGlvbih0KXtyZXR1cm4gbnVsbCE9PXQmJlwiW29iamVjdCBPYmplY3RdXCI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9LHZhbHVlT3JEZWZhdWx0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHZvaWQgMD09PXQ/ZTp0fSx2YWx1ZUF0SW5kZXhPckRlZmF1bHQ6ZnVuY3Rpb24odCxlLGkpe3JldHVybiBkLnZhbHVlT3JEZWZhdWx0KGQuaXNBcnJheSh0KT90W2VdOnQsaSl9LGNhbGxiYWNrOmZ1bmN0aW9uKHQsZSxpKXtpZih0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0LmNhbGwpcmV0dXJuIHQuYXBwbHkoaSxlKX0sZWFjaDpmdW5jdGlvbih0LGUsaSxuKXt2YXIgYSxvLHI7aWYoZC5pc0FycmF5KHQpKWlmKG89dC5sZW5ndGgsbilmb3IoYT1vLTE7MDw9YTthLS0pZS5jYWxsKGksdFthXSxhKTtlbHNlIGZvcihhPTA7YTxvO2ErKyllLmNhbGwoaSx0W2FdLGEpO2Vsc2UgaWYoZC5pc09iamVjdCh0KSlmb3Iobz0ocj1PYmplY3Qua2V5cyh0KSkubGVuZ3RoLGE9MDthPG87YSsrKWUuY2FsbChpLHRbclthXV0sclthXSl9LGFycmF5RXF1YWxzOmZ1bmN0aW9uKHQsZSl7dmFyIGksbixhLG87aWYoIXR8fCFlfHx0Lmxlbmd0aCE9PWUubGVuZ3RoKXJldHVybiExO2ZvcihpPTAsbj10Lmxlbmd0aDtpPG47KytpKWlmKGE9dFtpXSxvPWVbaV0sYSBpbnN0YW5jZW9mIEFycmF5JiZvIGluc3RhbmNlb2YgQXJyYXkpe2lmKCFkLmFycmF5RXF1YWxzKGEsbykpcmV0dXJuITF9ZWxzZSBpZihhIT09bylyZXR1cm4hMTtyZXR1cm4hMH0sY2xvbmU6ZnVuY3Rpb24odCl7aWYoZC5pc0FycmF5KHQpKXJldHVybiB0Lm1hcChkLmNsb25lKTtpZihkLmlzT2JqZWN0KHQpKXtmb3IodmFyIGU9e30saT1PYmplY3Qua2V5cyh0KSxuPWkubGVuZ3RoLGE9MDthPG47KythKWVbaVthXV09ZC5jbG9uZSh0W2lbYV1dKTtyZXR1cm4gZX1yZXR1cm4gdH0sX21lcmdlcjpmdW5jdGlvbih0LGUsaSxuKXt2YXIgYT1lW3RdLG89aVt0XTtkLmlzT2JqZWN0KGEpJiZkLmlzT2JqZWN0KG8pP2QubWVyZ2UoYSxvLG4pOmVbdF09ZC5jbG9uZShvKX0sX21lcmdlcklmOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1lW3RdLGE9aVt0XTtkLmlzT2JqZWN0KG4pJiZkLmlzT2JqZWN0KGEpP2QubWVyZ2VJZihuLGEpOmUuaGFzT3duUHJvcGVydHkodCl8fChlW3RdPWQuY2xvbmUoYSkpfSxtZXJnZTpmdW5jdGlvbih0LGUsaSl7dmFyIG4sYSxvLHIscyxsPWQuaXNBcnJheShlKT9lOltlXSx1PWwubGVuZ3RoO2lmKCFkLmlzT2JqZWN0KHQpKXJldHVybiB0O2ZvcihuPShpPWl8fHt9KS5tZXJnZXJ8fGQuX21lcmdlcixhPTA7YTx1OysrYSlpZihlPWxbYV0sZC5pc09iamVjdChlKSlmb3Iocz0wLHI9KG89T2JqZWN0LmtleXMoZSkpLmxlbmd0aDtzPHI7KytzKW4ob1tzXSx0LGUsaSk7cmV0dXJuIHR9LG1lcmdlSWY6ZnVuY3Rpb24odCxlKXtyZXR1cm4gZC5tZXJnZSh0LGUse21lcmdlcjpkLl9tZXJnZXJJZn0pfSxleHRlbmQ6ZnVuY3Rpb24oaSl7Zm9yKHZhciB0PWZ1bmN0aW9uKHQsZSl7aVtlXT10fSxlPTEsbj1hcmd1bWVudHMubGVuZ3RoO2U8bjsrK2UpZC5lYWNoKGFyZ3VtZW50c1tlXSx0KTtyZXR1cm4gaX0saW5oZXJpdHM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxpPXQmJnQuaGFzT3duUHJvcGVydHkoXCJjb25zdHJ1Y3RvclwiKT90LmNvbnN0cnVjdG9yOmZ1bmN0aW9uKCl7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxuPWZ1bmN0aW9uKCl7dGhpcy5jb25zdHJ1Y3Rvcj1pfTtyZXR1cm4gbi5wcm90b3R5cGU9ZS5wcm90b3R5cGUsaS5wcm90b3R5cGU9bmV3IG4saS5leHRlbmQ9ZC5pbmhlcml0cyx0JiZkLmV4dGVuZChpLnByb3RvdHlwZSx0KSxpLl9fc3VwZXJfXz1lLnByb3RvdHlwZSxpfX07KGUuZXhwb3J0cz1kKS5jYWxsQ2FsbGJhY2s9ZC5jYWxsYmFjayxkLmluZGV4T2Y9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKHQsZSxpKX0sZC5nZXRWYWx1ZU9yRGVmYXVsdD1kLnZhbHVlT3JEZWZhdWx0LGQuZ2V0VmFsdWVBdEluZGV4T3JEZWZhdWx0PWQudmFsdWVBdEluZGV4T3JEZWZhdWx0fSx7fV0sNDQ6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjt2YXIgbj10KDQzKSxhPXtsaW5lYXI6ZnVuY3Rpb24odCl7cmV0dXJuIHR9LGVhc2VJblF1YWQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQqdH0sZWFzZU91dFF1YWQ6ZnVuY3Rpb24odCl7cmV0dXJuLXQqKHQtMil9LGVhc2VJbk91dFF1YWQ6ZnVuY3Rpb24odCl7cmV0dXJuKHQvPS41KTwxPy41KnQqdDotLjUqKC0tdCoodC0yKS0xKX0sZWFzZUluQ3ViaWM6ZnVuY3Rpb24odCl7cmV0dXJuIHQqdCp0fSxlYXNlT3V0Q3ViaWM6ZnVuY3Rpb24odCl7cmV0dXJuKHQtPTEpKnQqdCsxfSxlYXNlSW5PdXRDdWJpYzpmdW5jdGlvbih0KXtyZXR1cm4odC89LjUpPDE/LjUqdCp0KnQ6LjUqKCh0LT0yKSp0KnQrMil9LGVhc2VJblF1YXJ0OmZ1bmN0aW9uKHQpe3JldHVybiB0KnQqdCp0fSxlYXNlT3V0UXVhcnQ6ZnVuY3Rpb24odCl7cmV0dXJuLSgodC09MSkqdCp0KnQtMSl9LGVhc2VJbk91dFF1YXJ0OmZ1bmN0aW9uKHQpe3JldHVybih0Lz0uNSk8MT8uNSp0KnQqdCp0Oi0uNSooKHQtPTIpKnQqdCp0LTIpfSxlYXNlSW5RdWludDpmdW5jdGlvbih0KXtyZXR1cm4gdCp0KnQqdCp0fSxlYXNlT3V0UXVpbnQ6ZnVuY3Rpb24odCl7cmV0dXJuKHQtPTEpKnQqdCp0KnQrMX0sZWFzZUluT3V0UXVpbnQ6ZnVuY3Rpb24odCl7cmV0dXJuKHQvPS41KTwxPy41KnQqdCp0KnQqdDouNSooKHQtPTIpKnQqdCp0KnQrMil9LGVhc2VJblNpbmU6ZnVuY3Rpb24odCl7cmV0dXJuIDEtTWF0aC5jb3ModCooTWF0aC5QSS8yKSl9LGVhc2VPdXRTaW5lOmZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLnNpbih0KihNYXRoLlBJLzIpKX0sZWFzZUluT3V0U2luZTpmdW5jdGlvbih0KXtyZXR1cm4tLjUqKE1hdGguY29zKE1hdGguUEkqdCktMSl9LGVhc2VJbkV4cG86ZnVuY3Rpb24odCl7cmV0dXJuIDA9PT10PzA6TWF0aC5wb3coMiwxMCoodC0xKSl9LGVhc2VPdXRFeHBvOmZ1bmN0aW9uKHQpe3JldHVybiAxPT09dD8xOjEtTWF0aC5wb3coMiwtMTAqdCl9LGVhc2VJbk91dEV4cG86ZnVuY3Rpb24odCl7cmV0dXJuIDA9PT10PzA6MT09PXQ/MToodC89LjUpPDE/LjUqTWF0aC5wb3coMiwxMCoodC0xKSk6LjUqKDItTWF0aC5wb3coMiwtMTAqLS10KSl9LGVhc2VJbkNpcmM6ZnVuY3Rpb24odCl7cmV0dXJuIDE8PXQ/dDotKE1hdGguc3FydCgxLXQqdCktMSl9LGVhc2VPdXRDaXJjOmZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLnNxcnQoMS0odC09MSkqdCl9LGVhc2VJbk91dENpcmM6ZnVuY3Rpb24odCl7cmV0dXJuKHQvPS41KTwxPy0uNSooTWF0aC5zcXJ0KDEtdCp0KS0xKTouNSooTWF0aC5zcXJ0KDEtKHQtPTIpKnQpKzEpfSxlYXNlSW5FbGFzdGljOmZ1bmN0aW9uKHQpe3ZhciBlPTEuNzAxNTgsaT0wLG49MTtyZXR1cm4gMD09PXQ/MDoxPT09dD8xOihpfHwoaT0uMyksZT1uPDE/KG49MSxpLzQpOmkvKDIqTWF0aC5QSSkqTWF0aC5hc2luKDEvbiksLW4qTWF0aC5wb3coMiwxMCoodC09MSkpKk1hdGguc2luKCh0LWUpKigyKk1hdGguUEkpL2kpKX0sZWFzZU91dEVsYXN0aWM6ZnVuY3Rpb24odCl7dmFyIGU9MS43MDE1OCxpPTAsbj0xO3JldHVybiAwPT09dD8wOjE9PT10PzE6KGl8fChpPS4zKSxlPW48MT8obj0xLGkvNCk6aS8oMipNYXRoLlBJKSpNYXRoLmFzaW4oMS9uKSxuKk1hdGgucG93KDIsLTEwKnQpKk1hdGguc2luKCh0LWUpKigyKk1hdGguUEkpL2kpKzEpfSxlYXNlSW5PdXRFbGFzdGljOmZ1bmN0aW9uKHQpe3ZhciBlPTEuNzAxNTgsaT0wLG49MTtyZXR1cm4gMD09PXQ/MDoyPT0odC89LjUpPzE6KGl8fChpPS40NSksZT1uPDE/KG49MSxpLzQpOmkvKDIqTWF0aC5QSSkqTWF0aC5hc2luKDEvbiksdDwxP24qTWF0aC5wb3coMiwxMCoodC09MSkpKk1hdGguc2luKCh0LWUpKigyKk1hdGguUEkpL2kpKi0uNTpuKk1hdGgucG93KDIsLTEwKih0LT0xKSkqTWF0aC5zaW4oKHQtZSkqKDIqTWF0aC5QSSkvaSkqLjUrMSl9LGVhc2VJbkJhY2s6ZnVuY3Rpb24odCl7cmV0dXJuIHQqdCooMi43MDE1OCp0LTEuNzAxNTgpfSxlYXNlT3V0QmFjazpmdW5jdGlvbih0KXtyZXR1cm4odC09MSkqdCooMi43MDE1OCp0KzEuNzAxNTgpKzF9LGVhc2VJbk91dEJhY2s6ZnVuY3Rpb24odCl7dmFyIGU9MS43MDE1ODtyZXR1cm4odC89LjUpPDE/dCp0KigoMSsoZSo9MS41MjUpKSp0LWUpKi41Oi41KigodC09MikqdCooKDErKGUqPTEuNTI1KSkqdCtlKSsyKX0sZWFzZUluQm91bmNlOmZ1bmN0aW9uKHQpe3JldHVybiAxLWEuZWFzZU91dEJvdW5jZSgxLXQpfSxlYXNlT3V0Qm91bmNlOmZ1bmN0aW9uKHQpe3JldHVybiB0PDEvMi43NT83LjU2MjUqdCp0OnQ8Mi8yLjc1PzcuNTYyNSoodC09MS41LzIuNzUpKnQrLjc1OnQ8Mi41LzIuNzU/Ny41NjI1Kih0LT0yLjI1LzIuNzUpKnQrLjkzNzU6Ny41NjI1Kih0LT0yLjYyNS8yLjc1KSp0Ky45ODQzNzV9LGVhc2VJbk91dEJvdW5jZTpmdW5jdGlvbih0KXtyZXR1cm4gdDwuNT8uNSphLmVhc2VJbkJvdW5jZSgyKnQpOi41KmEuZWFzZU91dEJvdW5jZSgyKnQtMSkrLjV9fTtlLmV4cG9ydHM9e2VmZmVjdHM6YX0sbi5lYXNpbmdFZmZlY3RzPWF9LHs0Mzo0M31dLDQ1OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIHI9dCg0Myk7ZS5leHBvcnRzPXt0b0xpbmVIZWlnaHQ6ZnVuY3Rpb24odCxlKXt2YXIgaT0oXCJcIit0KS5tYXRjaCgvXihub3JtYWx8KFxcZCsoPzpcXC5cXGQrKT8pKHB4fGVtfCUpPykkLyk7aWYoIWl8fFwibm9ybWFsXCI9PT1pWzFdKXJldHVybiAxLjIqZTtzd2l0Y2godD0raVsyXSxpWzNdKXtjYXNlXCJweFwiOnJldHVybiB0O2Nhc2VcIiVcIjp0Lz0xMDB9cmV0dXJuIGUqdH0sdG9QYWRkaW5nOmZ1bmN0aW9uKHQpe3ZhciBlLGksbixhO3JldHVybiByLmlzT2JqZWN0KHQpPyhlPSt0LnRvcHx8MCxpPSt0LnJpZ2h0fHwwLG49K3QuYm90dG9tfHwwLGE9K3QubGVmdHx8MCk6ZT1pPW49YT0rdHx8MCx7dG9wOmUscmlnaHQ6aSxib3R0b206bixsZWZ0OmEsaGVpZ2h0OmUrbix3aWR0aDphK2l9fSxyZXNvbHZlOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbixhLG87Zm9yKG49MCxhPXQubGVuZ3RoO248YTsrK24paWYodm9pZCAwIT09KG89dFtuXSkmJih2b2lkIDAhPT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBvJiYobz1vKGUpKSx2b2lkIDAhPT1pJiZyLmlzQXJyYXkobykmJihvPW9baV0pLHZvaWQgMCE9PW8pKXJldHVybiBvfX19LHs0Mzo0M31dLDQ2OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7ZS5leHBvcnRzPXQoNDMpLGUuZXhwb3J0cy5lYXNpbmc9dCg0NCksZS5leHBvcnRzLmNhbnZhcz10KDQyKSxlLmV4cG9ydHMub3B0aW9ucz10KDQ1KX0sezQyOjQyLDQzOjQzLDQ0OjQ0LDQ1OjQ1fV0sNDc6W2Z1bmN0aW9uKHQsZSxpKXtlLmV4cG9ydHM9e2FjcXVpcmVDb250ZXh0OmZ1bmN0aW9uKHQpe3JldHVybiB0JiZ0LmNhbnZhcyYmKHQ9dC5jYW52YXMpLHQmJnQuZ2V0Q29udGV4dChcIjJkXCIpfHxudWxsfX19LHt9XSw0ODpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBmPXQoNDYpLGc9XCIkY2hhcnRqc1wiLHA9XCJjaGFydGpzLVwiLG09cCtcInJlbmRlci1tb25pdG9yXCIsdj1wK1wicmVuZGVyLWFuaW1hdGlvblwiLGI9W1wiYW5pbWF0aW9uc3RhcnRcIixcIndlYmtpdEFuaW1hdGlvblN0YXJ0XCJdLHM9e3RvdWNoc3RhcnQ6XCJtb3VzZWRvd25cIix0b3VjaG1vdmU6XCJtb3VzZW1vdmVcIix0b3VjaGVuZDpcIm1vdXNldXBcIixwb2ludGVyZW50ZXI6XCJtb3VzZWVudGVyXCIscG9pbnRlcmRvd246XCJtb3VzZWRvd25cIixwb2ludGVybW92ZTpcIm1vdXNlbW92ZVwiLHBvaW50ZXJ1cDpcIm1vdXNldXBcIixwb2ludGVybGVhdmU6XCJtb3VzZW91dFwiLHBvaW50ZXJvdXQ6XCJtb3VzZW91dFwifTtmdW5jdGlvbiBsKHQsZSl7dmFyIGk9Zi5nZXRTdHlsZSh0LGUpLG49aSYmaS5tYXRjaCgvXihcXGQrKShcXC5cXGQrKT9weCQvKTtyZXR1cm4gbj9OdW1iZXIoblsxXSk6dm9pZCAwfXZhciBuPSEhZnVuY3Rpb24oKXt2YXIgdD0hMTt0cnl7dmFyIGU9T2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LFwicGFzc2l2ZVwiLHtnZXQ6ZnVuY3Rpb24oKXt0PSEwfX0pO3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiZVwiLG51bGwsZSl9Y2F0Y2godCl7fXJldHVybiB0fSgpJiZ7cGFzc2l2ZTohMH07ZnVuY3Rpb24geCh0LGUsaSl7dC5hZGRFdmVudExpc3RlbmVyKGUsaSxuKX1mdW5jdGlvbiByKHQsZSxpKXt0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZSxpLG4pfWZ1bmN0aW9uIHkodCxlLGksbixhKXtyZXR1cm57dHlwZTp0LGNoYXJ0OmUsbmF0aXZlOmF8fG51bGwseDp2b2lkIDAhPT1pP2k6bnVsbCx5OnZvaWQgMCE9PW4/bjpudWxsfX1mdW5jdGlvbiBhKGUsdCxpKXt2YXIgbixhLG8scixzLGwsdSxkLGM9ZVtnXXx8KGVbZ109e30pLGg9Yy5yZXNpemVyPWZ1bmN0aW9uKHQpe3ZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksaT1wK1wic2l6ZS1tb25pdG9yXCIsbj1cInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MDt0b3A6MDtyaWdodDowO2JvdHRvbTowO292ZXJmbG93OmhpZGRlbjtwb2ludGVyLWV2ZW50czpub25lO3Zpc2liaWxpdHk6aGlkZGVuO3otaW5kZXg6LTE7XCI7ZS5zdHlsZS5jc3NUZXh0PW4sZS5jbGFzc05hbWU9aSxlLmlubmVySFRNTD0nPGRpdiBjbGFzcz1cIicraSsnLWV4cGFuZFwiIHN0eWxlPVwiJytuKydcIj48ZGl2IHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MTAwMDAwMHB4O2hlaWdodDoxMDAwMDAwcHg7bGVmdDowO3RvcDowXCI+PC9kaXY+PC9kaXY+PGRpdiBjbGFzcz1cIicraSsnLXNocmlua1wiIHN0eWxlPVwiJytuKydcIj48ZGl2IHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MjAwJTtoZWlnaHQ6MjAwJTtsZWZ0OjA7IHRvcDowXCI+PC9kaXY+PC9kaXY+Jzt2YXIgYT1lLmNoaWxkTm9kZXNbMF0sbz1lLmNoaWxkTm9kZXNbMV07ZS5fcmVzZXQ9ZnVuY3Rpb24oKXthLnNjcm9sbExlZnQ9MWU2LGEuc2Nyb2xsVG9wPTFlNixvLnNjcm9sbExlZnQ9MWU2LG8uc2Nyb2xsVG9wPTFlNn07dmFyIHI9ZnVuY3Rpb24oKXtlLl9yZXNldCgpLHQoKX07cmV0dXJuIHgoYSxcInNjcm9sbFwiLHIuYmluZChhLFwiZXhwYW5kXCIpKSx4KG8sXCJzY3JvbGxcIixyLmJpbmQobyxcInNocmlua1wiKSksZX0oKG89IShuPWZ1bmN0aW9uKCl7aWYoYy5yZXNpemVyKXJldHVybiB0KHkoXCJyZXNpemVcIixpKSl9KSxyPVtdLGZ1bmN0aW9uKCl7cj1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLGE9YXx8dGhpcyxvfHwobz0hMCxmLnJlcXVlc3RBbmltRnJhbWUuY2FsbCh3aW5kb3csZnVuY3Rpb24oKXtvPSExLG4uYXBwbHkoYSxyKX0pKX0pKTtsPWZ1bmN0aW9uKCl7aWYoYy5yZXNpemVyKXt2YXIgdD1lLnBhcmVudE5vZGU7dCYmdCE9PWgucGFyZW50Tm9kZSYmdC5pbnNlcnRCZWZvcmUoaCx0LmZpcnN0Q2hpbGQpLGguX3Jlc2V0KCl9fSx1PShzPWUpW2ddfHwoc1tnXT17fSksZD11LnJlbmRlclByb3h5PWZ1bmN0aW9uKHQpe3QuYW5pbWF0aW9uTmFtZT09PXYmJmwoKX0sZi5lYWNoKGIsZnVuY3Rpb24odCl7eChzLHQsZCl9KSx1LnJlZmxvdz0hIXMub2Zmc2V0UGFyZW50LHMuY2xhc3NMaXN0LmFkZChtKX1mdW5jdGlvbiBvKHQpe3ZhciBlLGksbixhPXRbZ118fHt9LG89YS5yZXNpemVyO2RlbGV0ZSBhLnJlc2l6ZXIsaT0oZT10KVtnXXx8e30sKG49aS5yZW5kZXJQcm94eSkmJihmLmVhY2goYixmdW5jdGlvbih0KXtyKGUsdCxuKX0pLGRlbGV0ZSBpLnJlbmRlclByb3h5KSxlLmNsYXNzTGlzdC5yZW1vdmUobSksbyYmby5wYXJlbnROb2RlJiZvLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobyl9ZS5leHBvcnRzPXtfZW5hYmxlZDpcInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93JiZcInVuZGVmaW5lZFwiIT10eXBlb2YgZG9jdW1lbnQsaW5pdGlhbGl6ZTpmdW5jdGlvbigpe3ZhciB0LGUsaSxuPVwiZnJvbXtvcGFjaXR5OjAuOTl9dG97b3BhY2l0eToxfVwiO2U9XCJALXdlYmtpdC1rZXlmcmFtZXMgXCIrditcIntcIituK1wifUBrZXlmcmFtZXMgXCIrditcIntcIituK1wifS5cIittK1wiey13ZWJraXQtYW5pbWF0aW9uOlwiK3YrXCIgMC4wMDFzO2FuaW1hdGlvbjpcIit2K1wiIDAuMDAxczt9XCIsaT0odD10aGlzKS5fc3R5bGV8fGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKSx0Ll9zdHlsZXx8KGU9XCIvKiBDaGFydC5qcyAqL1xcblwiK2UsKHQuX3N0eWxlPWkpLnNldEF0dHJpYnV0ZShcInR5cGVcIixcInRleHQvY3NzXCIpLGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXS5hcHBlbmRDaGlsZChpKSksaS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShlKSl9LGFjcXVpcmVDb250ZXh0OmZ1bmN0aW9uKHQsZSl7XCJzdHJpbmdcIj09dHlwZW9mIHQ/dD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0KTp0Lmxlbmd0aCYmKHQ9dFswXSksdCYmdC5jYW52YXMmJih0PXQuY2FudmFzKTt2YXIgaT10JiZ0LmdldENvbnRleHQmJnQuZ2V0Q29udGV4dChcIjJkXCIpO3JldHVybiBpJiZpLmNhbnZhcz09PXQ/KGZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5zdHlsZSxuPXQuZ2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIpLGE9dC5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKTtpZih0W2ddPXtpbml0aWFsOntoZWlnaHQ6bix3aWR0aDphLHN0eWxlOntkaXNwbGF5OmkuZGlzcGxheSxoZWlnaHQ6aS5oZWlnaHQsd2lkdGg6aS53aWR0aH19fSxpLmRpc3BsYXk9aS5kaXNwbGF5fHxcImJsb2NrXCIsbnVsbD09PWF8fFwiXCI9PT1hKXt2YXIgbz1sKHQsXCJ3aWR0aFwiKTt2b2lkIDAhPT1vJiYodC53aWR0aD1vKX1pZihudWxsPT09bnx8XCJcIj09PW4paWYoXCJcIj09PXQuc3R5bGUuaGVpZ2h0KXQuaGVpZ2h0PXQud2lkdGgvKGUub3B0aW9ucy5hc3BlY3RSYXRpb3x8Mik7ZWxzZXt2YXIgcj1sKHQsXCJoZWlnaHRcIik7dm9pZCAwIT09byYmKHQuaGVpZ2h0PXIpfX0odCxlKSxpKTpudWxsfSxyZWxlYXNlQ29udGV4dDpmdW5jdGlvbih0KXt2YXIgaT10LmNhbnZhcztpZihpW2ddKXt2YXIgbj1pW2ddLmluaXRpYWw7W1wiaGVpZ2h0XCIsXCJ3aWR0aFwiXS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBlPW5bdF07Zi5pc051bGxPclVuZGVmKGUpP2kucmVtb3ZlQXR0cmlidXRlKHQpOmkuc2V0QXR0cmlidXRlKHQsZSl9KSxmLmVhY2gobi5zdHlsZXx8e30sZnVuY3Rpb24odCxlKXtpLnN0eWxlW2VdPXR9KSxpLndpZHRoPWkud2lkdGgsZGVsZXRlIGlbZ119fSxhZGRFdmVudExpc3RlbmVyOmZ1bmN0aW9uKG8sdCxyKXt2YXIgZT1vLmNhbnZhcztpZihcInJlc2l6ZVwiIT09dCl7dmFyIGk9cltnXXx8KHJbZ109e30pO3goZSx0LChpLnByb3hpZXN8fChpLnByb3hpZXM9e30pKVtvLmlkK1wiX1wiK3RdPWZ1bmN0aW9uKHQpe3ZhciBlLGksbixhO3IoKGk9byxuPXNbKGU9dCkudHlwZV18fGUudHlwZSxhPWYuZ2V0UmVsYXRpdmVQb3NpdGlvbihlLGkpLHkobixpLGEueCxhLnksZSkpKX0pfWVsc2UgYShlLHIsbyl9LHJlbW92ZUV2ZW50TGlzdGVuZXI6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXQuY2FudmFzO2lmKFwicmVzaXplXCIhPT1lKXt2YXIgYT0oKGlbZ118fHt9KS5wcm94aWVzfHx7fSlbdC5pZCtcIl9cIitlXTthJiZyKG4sZSxhKX1lbHNlIG8obil9fSxmLmFkZEV2ZW50PXgsZi5yZW1vdmVFdmVudD1yfSx7NDY6NDZ9XSw0OTpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBuPXQoNDYpLGE9dCg0Nyksbz10KDQ4KSxyPW8uX2VuYWJsZWQ/bzphO2UuZXhwb3J0cz1uLmV4dGVuZCh7aW5pdGlhbGl6ZTpmdW5jdGlvbigpe30sYWNxdWlyZUNvbnRleHQ6ZnVuY3Rpb24oKXt9LHJlbGVhc2VDb250ZXh0OmZ1bmN0aW9uKCl7fSxhZGRFdmVudExpc3RlbmVyOmZ1bmN0aW9uKCl7fSxyZW1vdmVFdmVudExpc3RlbmVyOmZ1bmN0aW9uKCl7fX0scil9LHs0Njo0Niw0Nzo0Nyw0ODo0OH1dLDUwOltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7ZS5leHBvcnRzPXt9LGUuZXhwb3J0cy5maWxsZXI9dCg1MSksZS5leHBvcnRzLmxlZ2VuZD10KDUyKSxlLmV4cG9ydHMudGl0bGU9dCg1Myl9LHs1MTo1MSw1Mjo1Miw1Mzo1M31dLDUxOltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIHU9dCgyNiksaD10KDQxKSxkPXQoNDYpO3UuX3NldChcImdsb2JhbFwiLHtwbHVnaW5zOntmaWxsZXI6e3Byb3BhZ2F0ZTohMH19fSk7dmFyIGY9e2RhdGFzZXQ6ZnVuY3Rpb24odCl7dmFyIGU9dC5maWxsLGk9dC5jaGFydCxuPWkuZ2V0RGF0YXNldE1ldGEoZSksYT1uJiZpLmlzRGF0YXNldFZpc2libGUoZSkmJm4uZGF0YXNldC5fY2hpbGRyZW58fFtdLG89YS5sZW5ndGh8fDA7cmV0dXJuIG8/ZnVuY3Rpb24odCxlKXtyZXR1cm4gZTxvJiZhW2VdLl92aWV3fHxudWxsfTpudWxsfSxib3VuZGFyeTpmdW5jdGlvbih0KXt2YXIgZT10LmJvdW5kYXJ5LGk9ZT9lLng6bnVsbCxuPWU/ZS55Om51bGw7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybnt4Om51bGw9PT1pP3QueDppLHk6bnVsbD09PW4/dC55Om59fX19O2Z1bmN0aW9uIGcodCxlLGkpe3ZhciBuLGE9dC5fbW9kZWx8fHt9LG89YS5maWxsO2lmKHZvaWQgMD09PW8mJihvPSEhYS5iYWNrZ3JvdW5kQ29sb3IpLCExPT09b3x8bnVsbD09PW8pcmV0dXJuITE7aWYoITA9PT1vKXJldHVyblwib3JpZ2luXCI7aWYobj1wYXJzZUZsb2F0KG8sMTApLGlzRmluaXRlKG4pJiZNYXRoLmZsb29yKG4pPT09bilyZXR1cm5cIi1cIiE9PW9bMF0mJlwiK1wiIT09b1swXXx8KG49ZStuKSwhKG49PT1lfHxuPDB8fGk8PW4pJiZuO3N3aXRjaChvKXtjYXNlXCJib3R0b21cIjpyZXR1cm5cInN0YXJ0XCI7Y2FzZVwidG9wXCI6cmV0dXJuXCJlbmRcIjtjYXNlXCJ6ZXJvXCI6cmV0dXJuXCJvcmlnaW5cIjtjYXNlXCJvcmlnaW5cIjpjYXNlXCJzdGFydFwiOmNhc2VcImVuZFwiOnJldHVybiBvO2RlZmF1bHQ6cmV0dXJuITF9fWZ1bmN0aW9uIHAodCl7dmFyIGUsaT10LmVsLl9tb2RlbHx8e30sbj10LmVsLl9zY2FsZXx8e30sYT10LmZpbGwsbz1udWxsO2lmKGlzRmluaXRlKGEpKXJldHVybiBudWxsO2lmKFwic3RhcnRcIj09PWE/bz12b2lkIDA9PT1pLnNjYWxlQm90dG9tP24uYm90dG9tOmkuc2NhbGVCb3R0b206XCJlbmRcIj09PWE/bz12b2lkIDA9PT1pLnNjYWxlVG9wP24udG9wOmkuc2NhbGVUb3A6dm9pZCAwIT09aS5zY2FsZVplcm8/bz1pLnNjYWxlWmVybzpuLmdldEJhc2VQb3NpdGlvbj9vPW4uZ2V0QmFzZVBvc2l0aW9uKCk6bi5nZXRCYXNlUGl4ZWwmJihvPW4uZ2V0QmFzZVBpeGVsKCkpLG51bGwhPW8pe2lmKHZvaWQgMCE9PW8ueCYmdm9pZCAwIT09by55KXJldHVybiBvO2lmKFwibnVtYmVyXCI9PXR5cGVvZiBvJiZpc0Zpbml0ZShvKSlyZXR1cm57eDooZT1uLmlzSG9yaXpvbnRhbCgpKT9vOm51bGwseTplP251bGw6b319cmV0dXJuIG51bGx9ZnVuY3Rpb24gbSh0LGUsaSl7dmFyIG4sYT10W2VdLmZpbGwsbz1bZV07aWYoIWkpcmV0dXJuIGE7Zm9yKDshMSE9PWEmJi0xPT09by5pbmRleE9mKGEpOyl7aWYoIWlzRmluaXRlKGEpKXJldHVybiBhO2lmKCEobj10W2FdKSlyZXR1cm4hMTtpZihuLnZpc2libGUpcmV0dXJuIGE7by5wdXNoKGEpLGE9bi5maWxsfXJldHVybiExfWZ1bmN0aW9uIHgodCl7cmV0dXJuIHQmJiF0LnNraXB9ZnVuY3Rpb24geSh0LGUsaSxuLGEpe3ZhciBvO2lmKG4mJmEpe2Zvcih0Lm1vdmVUbyhlWzBdLngsZVswXS55KSxvPTE7bzxuOysrbylkLmNhbnZhcy5saW5lVG8odCxlW28tMV0sZVtvXSk7Zm9yKHQubGluZVRvKGlbYS0xXS54LGlbYS0xXS55KSxvPWEtMTswPG87LS1vKWQuY2FudmFzLmxpbmVUbyh0LGlbb10saVtvLTFdLCEwKX19ZS5leHBvcnRzPXtpZDpcImZpbGxlclwiLGFmdGVyRGF0YXNldHNVcGRhdGU6ZnVuY3Rpb24odCxlKXt2YXIgaSxuLGEsbyxyLHMsbCx1PSh0LmRhdGEuZGF0YXNldHN8fFtdKS5sZW5ndGgsZD1lLnByb3BhZ2F0ZSxjPVtdO2ZvcihuPTA7bjx1OysrbilvPW51bGwsKGE9KGk9dC5nZXREYXRhc2V0TWV0YShuKSkuZGF0YXNldCkmJmEuX21vZGVsJiZhIGluc3RhbmNlb2YgaC5MaW5lJiYobz17dmlzaWJsZTp0LmlzRGF0YXNldFZpc2libGUobiksZmlsbDpnKGEsbix1KSxjaGFydDp0LGVsOmF9KSxpLiRmaWxsZXI9byxjLnB1c2gobyk7Zm9yKG49MDtuPHU7KytuKShvPWNbbl0pJiYoby5maWxsPW0oYyxuLGQpLG8uYm91bmRhcnk9cChvKSxvLm1hcHBlcj0obD12b2lkIDAscz0ocj1vKS5maWxsLCEobD1cImRhdGFzZXRcIik9PT1zP251bGw6KGlzRmluaXRlKHMpfHwobD1cImJvdW5kYXJ5XCIpLGZbbF0ocikpKSl9LGJlZm9yZURhdGFzZXREcmF3OmZ1bmN0aW9uKHQsZSl7dmFyIGk9ZS5tZXRhLiRmaWxsZXI7aWYoaSl7dmFyIG49dC5jdHgsYT1pLmVsLG89YS5fdmlldyxyPWEuX2NoaWxkcmVufHxbXSxzPWkubWFwcGVyLGw9by5iYWNrZ3JvdW5kQ29sb3J8fHUuZ2xvYmFsLmRlZmF1bHRDb2xvcjtzJiZsJiZyLmxlbmd0aCYmKGQuY2FudmFzLmNsaXBBcmVhKG4sdC5jaGFydEFyZWEpLGZ1bmN0aW9uKHQsZSxpLG4sYSxvKXt2YXIgcixzLGwsdSxkLGMsaCxmPWUubGVuZ3RoLGc9bi5zcGFuR2FwcyxwPVtdLG09W10sdj0wLGI9MDtmb3IodC5iZWdpblBhdGgoKSxyPTAscz1mKyEhbztyPHM7KytyKWQ9aSh1PWVbbD1yJWZdLl92aWV3LGwsbiksYz14KHUpLGg9eChkKSxjJiZoPyh2PXAucHVzaCh1KSxiPW0ucHVzaChkKSk6diYmYiYmKGc/KGMmJnAucHVzaCh1KSxoJiZtLnB1c2goZCkpOih5KHQscCxtLHYsYiksdj1iPTAscD1bXSxtPVtdKSk7eSh0LHAsbSx2LGIpLHQuY2xvc2VQYXRoKCksdC5maWxsU3R5bGU9YSx0LmZpbGwoKX0obixyLHMsbyxsLGEuX2xvb3ApLGQuY2FudmFzLnVuY2xpcEFyZWEobikpfX19fSx7MjY6MjYsNDE6NDEsNDY6NDZ9XSw1MjpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBfPXQoMjYpLG49dCgyNyksRD10KDQ2KSxhPXQoMzEpLG89RC5ub29wO2Z1bmN0aW9uIFAodCxlKXtyZXR1cm4gdC51c2VQb2ludFN0eWxlP2UqTWF0aC5TUVJUMjp0LmJveFdpZHRofV8uX3NldChcImdsb2JhbFwiLHtsZWdlbmQ6e2Rpc3BsYXk6ITAscG9zaXRpb246XCJ0b3BcIixmdWxsV2lkdGg6ITAscmV2ZXJzZTohMSx3ZWlnaHQ6MWUzLG9uQ2xpY2s6ZnVuY3Rpb24odCxlKXt2YXIgaT1lLmRhdGFzZXRJbmRleCxuPXRoaXMuY2hhcnQsYT1uLmdldERhdGFzZXRNZXRhKGkpO2EuaGlkZGVuPW51bGw9PT1hLmhpZGRlbj8hbi5kYXRhLmRhdGFzZXRzW2ldLmhpZGRlbjpudWxsLG4udXBkYXRlKCl9LG9uSG92ZXI6bnVsbCxsYWJlbHM6e2JveFdpZHRoOjQwLHBhZGRpbmc6MTAsZ2VuZXJhdGVMYWJlbHM6ZnVuY3Rpb24oaSl7dmFyIHQ9aS5kYXRhO3JldHVybiBELmlzQXJyYXkodC5kYXRhc2V0cyk/dC5kYXRhc2V0cy5tYXAoZnVuY3Rpb24odCxlKXtyZXR1cm57dGV4dDp0LmxhYmVsLGZpbGxTdHlsZTpELmlzQXJyYXkodC5iYWNrZ3JvdW5kQ29sb3IpP3QuYmFja2dyb3VuZENvbG9yWzBdOnQuYmFja2dyb3VuZENvbG9yLGhpZGRlbjohaS5pc0RhdGFzZXRWaXNpYmxlKGUpLGxpbmVDYXA6dC5ib3JkZXJDYXBTdHlsZSxsaW5lRGFzaDp0LmJvcmRlckRhc2gsbGluZURhc2hPZmZzZXQ6dC5ib3JkZXJEYXNoT2Zmc2V0LGxpbmVKb2luOnQuYm9yZGVySm9pblN0eWxlLGxpbmVXaWR0aDp0LmJvcmRlcldpZHRoLHN0cm9rZVN0eWxlOnQuYm9yZGVyQ29sb3IscG9pbnRTdHlsZTp0LnBvaW50U3R5bGUsZGF0YXNldEluZGV4OmV9fSx0aGlzKTpbXX19fSxsZWdlbmRDYWxsYmFjazpmdW5jdGlvbih0KXt2YXIgZT1bXTtlLnB1c2goJzx1bCBjbGFzcz1cIicrdC5pZCsnLWxlZ2VuZFwiPicpO2Zvcih2YXIgaT0wO2k8dC5kYXRhLmRhdGFzZXRzLmxlbmd0aDtpKyspZS5wdXNoKCc8bGk+PHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOicrdC5kYXRhLmRhdGFzZXRzW2ldLmJhY2tncm91bmRDb2xvcisnXCI+PC9zcGFuPicpLHQuZGF0YS5kYXRhc2V0c1tpXS5sYWJlbCYmZS5wdXNoKHQuZGF0YS5kYXRhc2V0c1tpXS5sYWJlbCksZS5wdXNoKFwiPC9saT5cIik7cmV0dXJuIGUucHVzaChcIjwvdWw+XCIpLGUuam9pbihcIlwiKX19KTt2YXIgcj1uLmV4dGVuZCh7aW5pdGlhbGl6ZTpmdW5jdGlvbih0KXtELmV4dGVuZCh0aGlzLHQpLHRoaXMubGVnZW5kSGl0Qm94ZXM9W10sdGhpcy5kb3VnaG51dE1vZGU9ITF9LGJlZm9yZVVwZGF0ZTpvLHVwZGF0ZTpmdW5jdGlvbih0LGUsaSl7dmFyIG49dGhpcztyZXR1cm4gbi5iZWZvcmVVcGRhdGUoKSxuLm1heFdpZHRoPXQsbi5tYXhIZWlnaHQ9ZSxuLm1hcmdpbnM9aSxuLmJlZm9yZVNldERpbWVuc2lvbnMoKSxuLnNldERpbWVuc2lvbnMoKSxuLmFmdGVyU2V0RGltZW5zaW9ucygpLG4uYmVmb3JlQnVpbGRMYWJlbHMoKSxuLmJ1aWxkTGFiZWxzKCksbi5hZnRlckJ1aWxkTGFiZWxzKCksbi5iZWZvcmVGaXQoKSxuLmZpdCgpLG4uYWZ0ZXJGaXQoKSxuLmFmdGVyVXBkYXRlKCksbi5taW5TaXplfSxhZnRlclVwZGF0ZTpvLGJlZm9yZVNldERpbWVuc2lvbnM6byxzZXREaW1lbnNpb25zOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpczt0LmlzSG9yaXpvbnRhbCgpPyh0LndpZHRoPXQubWF4V2lkdGgsdC5sZWZ0PTAsdC5yaWdodD10LndpZHRoKToodC5oZWlnaHQ9dC5tYXhIZWlnaHQsdC50b3A9MCx0LmJvdHRvbT10LmhlaWdodCksdC5wYWRkaW5nTGVmdD0wLHQucGFkZGluZ1RvcD0wLHQucGFkZGluZ1JpZ2h0PTAsdC5wYWRkaW5nQm90dG9tPTAsdC5taW5TaXplPXt3aWR0aDowLGhlaWdodDowfX0sYWZ0ZXJTZXREaW1lbnNpb25zOm8sYmVmb3JlQnVpbGRMYWJlbHM6byxidWlsZExhYmVsczpmdW5jdGlvbigpe3ZhciBlPXRoaXMsaT1lLm9wdGlvbnMubGFiZWxzfHx7fSx0PUQuY2FsbGJhY2soaS5nZW5lcmF0ZUxhYmVscyxbZS5jaGFydF0sZSl8fFtdO2kuZmlsdGVyJiYodD10LmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm4gaS5maWx0ZXIodCxlLmNoYXJ0LmRhdGEpfSkpLGUub3B0aW9ucy5yZXZlcnNlJiZ0LnJldmVyc2UoKSxlLmxlZ2VuZEl0ZW1zPXR9LGFmdGVyQnVpbGRMYWJlbHM6byxiZWZvcmVGaXQ6byxmaXQ6ZnVuY3Rpb24oKXt2YXIgbj10aGlzLHQ9bi5vcHRpb25zLGE9dC5sYWJlbHMsZT10LmRpc3BsYXksbz1uLmN0eCxpPV8uZ2xvYmFsLHI9RC52YWx1ZU9yRGVmYXVsdCxzPXIoYS5mb250U2l6ZSxpLmRlZmF1bHRGb250U2l6ZSksbD1yKGEuZm9udFN0eWxlLGkuZGVmYXVsdEZvbnRTdHlsZSksdT1yKGEuZm9udEZhbWlseSxpLmRlZmF1bHRGb250RmFtaWx5KSxkPUQuZm9udFN0cmluZyhzLGwsdSksYz1uLmxlZ2VuZEhpdEJveGVzPVtdLGg9bi5taW5TaXplLGY9bi5pc0hvcml6b250YWwoKTtpZihoLmhlaWdodD1mPyhoLndpZHRoPW4ubWF4V2lkdGgsZT8xMDowKTooaC53aWR0aD1lPzEwOjAsbi5tYXhIZWlnaHQpLGUpaWYoby5mb250PWQsZil7dmFyIGc9bi5saW5lV2lkdGhzPVswXSxwPW4ubGVnZW5kSXRlbXMubGVuZ3RoP3MrYS5wYWRkaW5nOjA7by50ZXh0QWxpZ249XCJsZWZ0XCIsby50ZXh0QmFzZWxpbmU9XCJ0b3BcIixELmVhY2gobi5sZWdlbmRJdGVtcyxmdW5jdGlvbih0LGUpe3ZhciBpPVAoYSxzKStzLzIrby5tZWFzdXJlVGV4dCh0LnRleHQpLndpZHRoO2dbZy5sZW5ndGgtMV0raSthLnBhZGRpbmc+PW4ud2lkdGgmJihwKz1zK2EucGFkZGluZyxnW2cubGVuZ3RoXT1uLmxlZnQpLGNbZV09e2xlZnQ6MCx0b3A6MCx3aWR0aDppLGhlaWdodDpzfSxnW2cubGVuZ3RoLTFdKz1pK2EucGFkZGluZ30pLGguaGVpZ2h0Kz1wfWVsc2V7dmFyIG09YS5wYWRkaW5nLHY9bi5jb2x1bW5XaWR0aHM9W10sYj1hLnBhZGRpbmcseD0wLHk9MCxrPXMrbTtELmVhY2gobi5sZWdlbmRJdGVtcyxmdW5jdGlvbih0LGUpe3ZhciBpPVAoYSxzKStzLzIrby5tZWFzdXJlVGV4dCh0LnRleHQpLndpZHRoO3kraz5oLmhlaWdodCYmKGIrPXgrYS5wYWRkaW5nLHYucHVzaCh4KSx5PXg9MCkseD1NYXRoLm1heCh4LGkpLHkrPWssY1tlXT17bGVmdDowLHRvcDowLHdpZHRoOmksaGVpZ2h0OnN9fSksYis9eCx2LnB1c2goeCksaC53aWR0aCs9Yn1uLndpZHRoPWgud2lkdGgsbi5oZWlnaHQ9aC5oZWlnaHR9LGFmdGVyRml0Om8saXNIb3Jpem9udGFsOmZ1bmN0aW9uKCl7cmV0dXJuXCJ0b3BcIj09PXRoaXMub3B0aW9ucy5wb3NpdGlvbnx8XCJib3R0b21cIj09PXRoaXMub3B0aW9ucy5wb3NpdGlvbn0sZHJhdzpmdW5jdGlvbigpe3ZhciBjPXRoaXMsaD1jLm9wdGlvbnMsZj1oLmxhYmVscyxnPV8uZ2xvYmFsLHA9Zy5lbGVtZW50cy5saW5lLG09Yy53aWR0aCx2PWMubGluZVdpZHRocztpZihoLmRpc3BsYXkpe3ZhciBiLHg9Yy5jdHgseT1ELnZhbHVlT3JEZWZhdWx0LHQ9eShmLmZvbnRDb2xvcixnLmRlZmF1bHRGb250Q29sb3IpLGs9eShmLmZvbnRTaXplLGcuZGVmYXVsdEZvbnRTaXplKSxlPXkoZi5mb250U3R5bGUsZy5kZWZhdWx0Rm9udFN0eWxlKSxpPXkoZi5mb250RmFtaWx5LGcuZGVmYXVsdEZvbnRGYW1pbHkpLG49RC5mb250U3RyaW5nKGssZSxpKTt4LnRleHRBbGlnbj1cImxlZnRcIix4LnRleHRCYXNlbGluZT1cIm1pZGRsZVwiLHgubGluZVdpZHRoPS41LHguc3Ryb2tlU3R5bGU9dCx4LmZpbGxTdHlsZT10LHguZm9udD1uO3ZhciBNPVAoZixrKSx3PWMubGVnZW5kSGl0Qm94ZXMsQz1jLmlzSG9yaXpvbnRhbCgpO2I9Qz97eDpjLmxlZnQrKG0tdlswXSkvMix5OmMudG9wK2YucGFkZGluZyxsaW5lOjB9Ont4OmMubGVmdCtmLnBhZGRpbmcseTpjLnRvcCtmLnBhZGRpbmcsbGluZTowfTt2YXIgUz1rK2YucGFkZGluZztELmVhY2goYy5sZWdlbmRJdGVtcyxmdW5jdGlvbih0LGUpe3ZhciBpLG4sYSxvLHIscz14Lm1lYXN1cmVUZXh0KHQudGV4dCkud2lkdGgsbD1NK2svMitzLHU9Yi54LGQ9Yi55O0M/bTw9dStsJiYoZD1iLnkrPVMsYi5saW5lKyssdT1iLng9Yy5sZWZ0KyhtLXZbYi5saW5lXSkvMik6ZCtTPmMuYm90dG9tJiYodT1iLng9dStjLmNvbHVtbldpZHRoc1tiLmxpbmVdK2YucGFkZGluZyxkPWIueT1jLnRvcCtmLnBhZGRpbmcsYi5saW5lKyspLGZ1bmN0aW9uKHQsZSxpKXtpZighKGlzTmFOKE0pfHxNPD0wKSl7eC5zYXZlKCkseC5maWxsU3R5bGU9eShpLmZpbGxTdHlsZSxnLmRlZmF1bHRDb2xvcikseC5saW5lQ2FwPXkoaS5saW5lQ2FwLHAuYm9yZGVyQ2FwU3R5bGUpLHgubGluZURhc2hPZmZzZXQ9eShpLmxpbmVEYXNoT2Zmc2V0LHAuYm9yZGVyRGFzaE9mZnNldCkseC5saW5lSm9pbj15KGkubGluZUpvaW4scC5ib3JkZXJKb2luU3R5bGUpLHgubGluZVdpZHRoPXkoaS5saW5lV2lkdGgscC5ib3JkZXJXaWR0aCkseC5zdHJva2VTdHlsZT15KGkuc3Ryb2tlU3R5bGUsZy5kZWZhdWx0Q29sb3IpO3ZhciBuPTA9PT15KGkubGluZVdpZHRoLHAuYm9yZGVyV2lkdGgpO2lmKHguc2V0TGluZURhc2gmJnguc2V0TGluZURhc2goeShpLmxpbmVEYXNoLHAuYm9yZGVyRGFzaCkpLGgubGFiZWxzJiZoLmxhYmVscy51c2VQb2ludFN0eWxlKXt2YXIgYT1rKk1hdGguU1FSVDIvMixvPWEvTWF0aC5TUVJUMixyPXQrbyxzPWUrbztELmNhbnZhcy5kcmF3UG9pbnQoeCxpLnBvaW50U3R5bGUsYSxyLHMpfWVsc2Ugbnx8eC5zdHJva2VSZWN0KHQsZSxNLGspLHguZmlsbFJlY3QodCxlLE0sayk7eC5yZXN0b3JlKCl9fSh1LGQsdCksd1tlXS5sZWZ0PXUsd1tlXS50b3A9ZCxpPXQsbj1zLG89TSsoYT1rLzIpK3Uscj1kK2EseC5maWxsVGV4dChpLnRleHQsbyxyKSxpLmhpZGRlbiYmKHguYmVnaW5QYXRoKCkseC5saW5lV2lkdGg9Mix4Lm1vdmVUbyhvLHIpLHgubGluZVRvKG8rbixyKSx4LnN0cm9rZSgpKSxDP2IueCs9bCtmLnBhZGRpbmc6Yi55Kz1TfSl9fSxoYW5kbGVFdmVudDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLGk9ZS5vcHRpb25zLG49XCJtb3VzZXVwXCI9PT10LnR5cGU/XCJjbGlja1wiOnQudHlwZSxhPSExO2lmKFwibW91c2Vtb3ZlXCI9PT1uKXtpZighaS5vbkhvdmVyKXJldHVybn1lbHNle2lmKFwiY2xpY2tcIiE9PW4pcmV0dXJuO2lmKCFpLm9uQ2xpY2spcmV0dXJufXZhciBvPXQueCxyPXQueTtpZihvPj1lLmxlZnQmJm88PWUucmlnaHQmJnI+PWUudG9wJiZyPD1lLmJvdHRvbSlmb3IodmFyIHM9ZS5sZWdlbmRIaXRCb3hlcyxsPTA7bDxzLmxlbmd0aDsrK2wpe3ZhciB1PXNbbF07aWYobz49dS5sZWZ0JiZvPD11LmxlZnQrdS53aWR0aCYmcj49dS50b3AmJnI8PXUudG9wK3UuaGVpZ2h0KXtpZihcImNsaWNrXCI9PT1uKXtpLm9uQ2xpY2suY2FsbChlLHQubmF0aXZlLGUubGVnZW5kSXRlbXNbbF0pLGE9ITA7YnJlYWt9aWYoXCJtb3VzZW1vdmVcIj09PW4pe2kub25Ib3Zlci5jYWxsKGUsdC5uYXRpdmUsZS5sZWdlbmRJdGVtc1tsXSksYT0hMDticmVha319fXJldHVybiBhfX0pO2Z1bmN0aW9uIHModCxlKXt2YXIgaT1uZXcgcih7Y3R4OnQuY3R4LG9wdGlvbnM6ZSxjaGFydDp0fSk7YS5jb25maWd1cmUodCxpLGUpLGEuYWRkQm94KHQsaSksdC5sZWdlbmQ9aX1lLmV4cG9ydHM9e2lkOlwibGVnZW5kXCIsX2VsZW1lbnQ6cixiZWZvcmVJbml0OmZ1bmN0aW9uKHQpe3ZhciBlPXQub3B0aW9ucy5sZWdlbmQ7ZSYmcyh0LGUpfSxiZWZvcmVVcGRhdGU6ZnVuY3Rpb24odCl7dmFyIGU9dC5vcHRpb25zLmxlZ2VuZCxpPXQubGVnZW5kO2U/KEQubWVyZ2VJZihlLF8uZ2xvYmFsLmxlZ2VuZCksaT8oYS5jb25maWd1cmUodCxpLGUpLGkub3B0aW9ucz1lKTpzKHQsZSkpOmkmJihhLnJlbW92ZUJveCh0LGkpLGRlbGV0ZSB0LmxlZ2VuZCl9LGFmdGVyRXZlbnQ6ZnVuY3Rpb24odCxlKXt2YXIgaT10LmxlZ2VuZDtpJiZpLmhhbmRsZUV2ZW50KGUpfX19LHsyNjoyNiwyNzoyNywzMTozMSw0Njo0Nn1dLDUzOltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIE09dCgyNiksbj10KDI3KSx3PXQoNDYpLGE9dCgzMSksbz13Lm5vb3A7TS5fc2V0KFwiZ2xvYmFsXCIse3RpdGxlOntkaXNwbGF5OiExLGZvbnRTdHlsZTpcImJvbGRcIixmdWxsV2lkdGg6ITAsbGluZUhlaWdodDoxLjIscGFkZGluZzoxMCxwb3NpdGlvbjpcInRvcFwiLHRleHQ6XCJcIix3ZWlnaHQ6MmUzfX0pO3ZhciByPW4uZXh0ZW5kKHtpbml0aWFsaXplOmZ1bmN0aW9uKHQpe3cuZXh0ZW5kKHRoaXMsdCksdGhpcy5sZWdlbmRIaXRCb3hlcz1bXX0sYmVmb3JlVXBkYXRlOm8sdXBkYXRlOmZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10aGlzO3JldHVybiBuLmJlZm9yZVVwZGF0ZSgpLG4ubWF4V2lkdGg9dCxuLm1heEhlaWdodD1lLG4ubWFyZ2lucz1pLG4uYmVmb3JlU2V0RGltZW5zaW9ucygpLG4uc2V0RGltZW5zaW9ucygpLG4uYWZ0ZXJTZXREaW1lbnNpb25zKCksbi5iZWZvcmVCdWlsZExhYmVscygpLG4uYnVpbGRMYWJlbHMoKSxuLmFmdGVyQnVpbGRMYWJlbHMoKSxuLmJlZm9yZUZpdCgpLG4uZml0KCksbi5hZnRlckZpdCgpLG4uYWZ0ZXJVcGRhdGUoKSxuLm1pblNpemV9LGFmdGVyVXBkYXRlOm8sYmVmb3JlU2V0RGltZW5zaW9uczpvLHNldERpbWVuc2lvbnM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzO3QuaXNIb3Jpem9udGFsKCk/KHQud2lkdGg9dC5tYXhXaWR0aCx0LmxlZnQ9MCx0LnJpZ2h0PXQud2lkdGgpOih0LmhlaWdodD10Lm1heEhlaWdodCx0LnRvcD0wLHQuYm90dG9tPXQuaGVpZ2h0KSx0LnBhZGRpbmdMZWZ0PTAsdC5wYWRkaW5nVG9wPTAsdC5wYWRkaW5nUmlnaHQ9MCx0LnBhZGRpbmdCb3R0b209MCx0Lm1pblNpemU9e3dpZHRoOjAsaGVpZ2h0OjB9fSxhZnRlclNldERpbWVuc2lvbnM6byxiZWZvcmVCdWlsZExhYmVsczpvLGJ1aWxkTGFiZWxzOm8sYWZ0ZXJCdWlsZExhYmVsczpvLGJlZm9yZUZpdDpvLGZpdDpmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT13LnZhbHVlT3JEZWZhdWx0LGk9dC5vcHRpb25zLG49aS5kaXNwbGF5LGE9ZShpLmZvbnRTaXplLE0uZ2xvYmFsLmRlZmF1bHRGb250U2l6ZSksbz10Lm1pblNpemUscj13LmlzQXJyYXkoaS50ZXh0KT9pLnRleHQubGVuZ3RoOjEscz13Lm9wdGlvbnMudG9MaW5lSGVpZ2h0KGkubGluZUhlaWdodCxhKSxsPW4/cipzKzIqaS5wYWRkaW5nOjA7dC5pc0hvcml6b250YWwoKT8oby53aWR0aD10Lm1heFdpZHRoLG8uaGVpZ2h0PWwpOihvLndpZHRoPWwsby5oZWlnaHQ9dC5tYXhIZWlnaHQpLHQud2lkdGg9by53aWR0aCx0LmhlaWdodD1vLmhlaWdodH0sYWZ0ZXJGaXQ6byxpc0hvcml6b250YWw6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMucG9zaXRpb247cmV0dXJuXCJ0b3BcIj09PXR8fFwiYm90dG9tXCI9PT10fSxkcmF3OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxlPXQuY3R4LGk9dy52YWx1ZU9yRGVmYXVsdCxuPXQub3B0aW9ucyxhPU0uZ2xvYmFsO2lmKG4uZGlzcGxheSl7dmFyIG8scixzLGw9aShuLmZvbnRTaXplLGEuZGVmYXVsdEZvbnRTaXplKSx1PWkobi5mb250U3R5bGUsYS5kZWZhdWx0Rm9udFN0eWxlKSxkPWkobi5mb250RmFtaWx5LGEuZGVmYXVsdEZvbnRGYW1pbHkpLGM9dy5mb250U3RyaW5nKGwsdSxkKSxoPXcub3B0aW9ucy50b0xpbmVIZWlnaHQobi5saW5lSGVpZ2h0LGwpLGY9aC8yK24ucGFkZGluZyxnPTAscD10LnRvcCxtPXQubGVmdCx2PXQuYm90dG9tLGI9dC5yaWdodDtlLmZpbGxTdHlsZT1pKG4uZm9udENvbG9yLGEuZGVmYXVsdEZvbnRDb2xvciksZS5mb250PWMsdC5pc0hvcml6b250YWwoKT8ocj1tKyhiLW0pLzIscz1wK2Ysbz1iLW0pOihyPVwibGVmdFwiPT09bi5wb3NpdGlvbj9tK2Y6Yi1mLHM9cCsodi1wKS8yLG89di1wLGc9TWF0aC5QSSooXCJsZWZ0XCI9PT1uLnBvc2l0aW9uPy0uNTouNSkpLGUuc2F2ZSgpLGUudHJhbnNsYXRlKHIscyksZS5yb3RhdGUoZyksZS50ZXh0QWxpZ249XCJjZW50ZXJcIixlLnRleHRCYXNlbGluZT1cIm1pZGRsZVwiO3ZhciB4PW4udGV4dDtpZih3LmlzQXJyYXkoeCkpZm9yKHZhciB5PTAsaz0wO2s8eC5sZW5ndGg7KytrKWUuZmlsbFRleHQoeFtrXSwwLHksbykseSs9aDtlbHNlIGUuZmlsbFRleHQoeCwwLDAsbyk7ZS5yZXN0b3JlKCl9fX0pO2Z1bmN0aW9uIHModCxlKXt2YXIgaT1uZXcgcih7Y3R4OnQuY3R4LG9wdGlvbnM6ZSxjaGFydDp0fSk7YS5jb25maWd1cmUodCxpLGUpLGEuYWRkQm94KHQsaSksdC50aXRsZUJsb2NrPWl9ZS5leHBvcnRzPXtpZDpcInRpdGxlXCIsX2VsZW1lbnQ6cixiZWZvcmVJbml0OmZ1bmN0aW9uKHQpe3ZhciBlPXQub3B0aW9ucy50aXRsZTtlJiZzKHQsZSl9LGJlZm9yZVVwZGF0ZTpmdW5jdGlvbih0KXt2YXIgZT10Lm9wdGlvbnMudGl0bGUsaT10LnRpdGxlQmxvY2s7ZT8ody5tZXJnZUlmKGUsTS5nbG9iYWwudGl0bGUpLGk/KGEuY29uZmlndXJlKHQsaSxlKSxpLm9wdGlvbnM9ZSk6cyh0LGUpKTppJiYoYS5yZW1vdmVCb3godCxpKSxkZWxldGUgdC50aXRsZUJsb2NrKX19fSx7MjY6MjYsMjc6MjcsMzE6MzEsNDY6NDZ9XSw1NDpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBuPXQoMzMpLGE9dCgzNCk7ZS5leHBvcnRzPWZ1bmN0aW9uKCl7dmFyIHQ9bi5leHRlbmQoe2dldExhYmVsczpmdW5jdGlvbigpe3ZhciB0PXRoaXMuY2hhcnQuZGF0YTtyZXR1cm4gdGhpcy5vcHRpb25zLmxhYmVsc3x8KHRoaXMuaXNIb3Jpem9udGFsKCk/dC54TGFiZWxzOnQueUxhYmVscyl8fHQubGFiZWxzfSxkZXRlcm1pbmVEYXRhTGltaXRzOmZ1bmN0aW9uKCl7dmFyIHQsZT10aGlzLGk9ZS5nZXRMYWJlbHMoKTtlLm1pbkluZGV4PTAsZS5tYXhJbmRleD1pLmxlbmd0aC0xLHZvaWQgMCE9PWUub3B0aW9ucy50aWNrcy5taW4mJih0PWkuaW5kZXhPZihlLm9wdGlvbnMudGlja3MubWluKSxlLm1pbkluZGV4PS0xIT09dD90OmUubWluSW5kZXgpLHZvaWQgMCE9PWUub3B0aW9ucy50aWNrcy5tYXgmJih0PWkuaW5kZXhPZihlLm9wdGlvbnMudGlja3MubWF4KSxlLm1heEluZGV4PS0xIT09dD90OmUubWF4SW5kZXgpLGUubWluPWlbZS5taW5JbmRleF0sZS5tYXg9aVtlLm1heEluZGV4XX0sYnVpbGRUaWNrczpmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT10LmdldExhYmVscygpO3QudGlja3M9MD09PXQubWluSW5kZXgmJnQubWF4SW5kZXg9PT1lLmxlbmd0aC0xP2U6ZS5zbGljZSh0Lm1pbkluZGV4LHQubWF4SW5kZXgrMSl9LGdldExhYmVsRm9ySW5kZXg6ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLG49aS5jaGFydC5kYXRhLGE9aS5pc0hvcml6b250YWwoKTtyZXR1cm4gbi55TGFiZWxzJiYhYT9pLmdldFJpZ2h0VmFsdWUobi5kYXRhc2V0c1tlXS5kYXRhW3RdKTppLnRpY2tzW3QtaS5taW5JbmRleF19LGdldFBpeGVsRm9yVmFsdWU6ZnVuY3Rpb24odCxlKXt2YXIgaSxuPXRoaXMsYT1uLm9wdGlvbnMub2Zmc2V0LG89TWF0aC5tYXgobi5tYXhJbmRleCsxLW4ubWluSW5kZXgtKGE/MDoxKSwxKTtpZihudWxsIT10JiYoaT1uLmlzSG9yaXpvbnRhbCgpP3QueDp0LnkpLHZvaWQgMCE9PWl8fHZvaWQgMCE9PXQmJmlzTmFOKGUpKXt0PWl8fHQ7dmFyIHI9bi5nZXRMYWJlbHMoKS5pbmRleE9mKHQpO2U9LTEhPT1yP3I6ZX1pZihuLmlzSG9yaXpvbnRhbCgpKXt2YXIgcz1uLndpZHRoL28sbD1zKihlLW4ubWluSW5kZXgpO3JldHVybiBhJiYobCs9cy8yKSxuLmxlZnQrTWF0aC5yb3VuZChsKX12YXIgdT1uLmhlaWdodC9vLGQ9dSooZS1uLm1pbkluZGV4KTtyZXR1cm4gYSYmKGQrPXUvMiksbi50b3ArTWF0aC5yb3VuZChkKX0sZ2V0UGl4ZWxGb3JUaWNrOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdldFBpeGVsRm9yVmFsdWUodGhpcy50aWNrc1t0XSx0K3RoaXMubWluSW5kZXgsbnVsbCl9LGdldFZhbHVlRm9yUGl4ZWw6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxpPWUub3B0aW9ucy5vZmZzZXQsbj1NYXRoLm1heChlLl90aWNrcy5sZW5ndGgtKGk/MDoxKSwxKSxhPWUuaXNIb3Jpem9udGFsKCksbz0oYT9lLndpZHRoOmUuaGVpZ2h0KS9uO3JldHVybiB0LT1hP2UubGVmdDplLnRvcCxpJiYodC09by8yKSwodDw9MD8wOk1hdGgucm91bmQodC9vKSkrZS5taW5JbmRleH0sZ2V0QmFzZVBpeGVsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYm90dG9tfX0pO2EucmVnaXN0ZXJTY2FsZVR5cGUoXCJjYXRlZ29yeVwiLHQse3Bvc2l0aW9uOlwiYm90dG9tXCJ9KX19LHszMzozMywzNDozNH1dLDU1OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIG49dCgyNiksYz10KDQ2KSxhPXQoMzQpLG89dCgzNSk7ZS5leHBvcnRzPWZ1bmN0aW9uKHQpe3ZhciBlPXtwb3NpdGlvbjpcImxlZnRcIix0aWNrczp7Y2FsbGJhY2s6by5mb3JtYXR0ZXJzLmxpbmVhcn19LGk9dC5MaW5lYXJTY2FsZUJhc2UuZXh0ZW5kKHtkZXRlcm1pbmVEYXRhTGltaXRzOmZ1bmN0aW9uKCl7dmFyIHI9dGhpcyxzPXIub3B0aW9ucyxsPXIuY2hhcnQsdD1sLmRhdGEuZGF0YXNldHMsZT1yLmlzSG9yaXpvbnRhbCgpO2Z1bmN0aW9uIHUodCl7cmV0dXJuIGU/dC54QXhpc0lEPT09ci5pZDp0LnlBeGlzSUQ9PT1yLmlkfXIubWluPW51bGwsci5tYXg9bnVsbDt2YXIgbj1zLnN0YWNrZWQ7aWYodm9pZCAwPT09biYmYy5lYWNoKHQsZnVuY3Rpb24odCxlKXtpZighbil7dmFyIGk9bC5nZXREYXRhc2V0TWV0YShlKTtsLmlzRGF0YXNldFZpc2libGUoZSkmJnUoaSkmJnZvaWQgMCE9PWkuc3RhY2smJihuPSEwKX19KSxzLnN0YWNrZWR8fG4pe3ZhciBkPXt9O2MuZWFjaCh0LGZ1bmN0aW9uKHQsZSl7dmFyIG49bC5nZXREYXRhc2V0TWV0YShlKSxpPVtuLnR5cGUsdm9pZCAwPT09cy5zdGFja2VkJiZ2b2lkIDA9PT1uLnN0YWNrP2U6XCJcIixuLnN0YWNrXS5qb2luKFwiLlwiKTt2b2lkIDA9PT1kW2ldJiYoZFtpXT17cG9zaXRpdmVWYWx1ZXM6W10sbmVnYXRpdmVWYWx1ZXM6W119KTt2YXIgYT1kW2ldLnBvc2l0aXZlVmFsdWVzLG89ZFtpXS5uZWdhdGl2ZVZhbHVlcztsLmlzRGF0YXNldFZpc2libGUoZSkmJnUobikmJmMuZWFjaCh0LmRhdGEsZnVuY3Rpb24odCxlKXt2YXIgaT0rci5nZXRSaWdodFZhbHVlKHQpO2lzTmFOKGkpfHxuLmRhdGFbZV0uaGlkZGVufHwoYVtlXT1hW2VdfHwwLG9bZV09b1tlXXx8MCxzLnJlbGF0aXZlUG9pbnRzP2FbZV09MTAwOmk8MD9vW2VdKz1pOmFbZV0rPWkpfSl9KSxjLmVhY2goZCxmdW5jdGlvbih0KXt2YXIgZT10LnBvc2l0aXZlVmFsdWVzLmNvbmNhdCh0Lm5lZ2F0aXZlVmFsdWVzKSxpPWMubWluKGUpLG49Yy5tYXgoZSk7ci5taW49bnVsbD09PXIubWluP2k6TWF0aC5taW4oci5taW4saSksci5tYXg9bnVsbD09PXIubWF4P246TWF0aC5tYXgoci5tYXgsbil9KX1lbHNlIGMuZWFjaCh0LGZ1bmN0aW9uKHQsZSl7dmFyIG49bC5nZXREYXRhc2V0TWV0YShlKTtsLmlzRGF0YXNldFZpc2libGUoZSkmJnUobikmJmMuZWFjaCh0LmRhdGEsZnVuY3Rpb24odCxlKXt2YXIgaT0rci5nZXRSaWdodFZhbHVlKHQpO2lzTmFOKGkpfHxuLmRhdGFbZV0uaGlkZGVufHwobnVsbD09PXIubWluP3IubWluPWk6aTxyLm1pbiYmKHIubWluPWkpLG51bGw9PT1yLm1heD9yLm1heD1pOmk+ci5tYXgmJihyLm1heD1pKSl9KX0pO3IubWluPWlzRmluaXRlKHIubWluKSYmIWlzTmFOKHIubWluKT9yLm1pbjowLHIubWF4PWlzRmluaXRlKHIubWF4KSYmIWlzTmFOKHIubWF4KT9yLm1heDoxLHRoaXMuaGFuZGxlVGlja1JhbmdlT3B0aW9ucygpfSxnZXRUaWNrTGltaXQ6ZnVuY3Rpb24oKXt2YXIgdCxlPXRoaXMub3B0aW9ucy50aWNrcztpZih0aGlzLmlzSG9yaXpvbnRhbCgpKXQ9TWF0aC5taW4oZS5tYXhUaWNrc0xpbWl0P2UubWF4VGlja3NMaW1pdDoxMSxNYXRoLmNlaWwodGhpcy53aWR0aC81MCkpO2Vsc2V7dmFyIGk9Yy52YWx1ZU9yRGVmYXVsdChlLmZvbnRTaXplLG4uZ2xvYmFsLmRlZmF1bHRGb250U2l6ZSk7dD1NYXRoLm1pbihlLm1heFRpY2tzTGltaXQ/ZS5tYXhUaWNrc0xpbWl0OjExLE1hdGguY2VpbCh0aGlzLmhlaWdodC8oMippKSkpfXJldHVybiB0fSxoYW5kbGVEaXJlY3Rpb25hbENoYW5nZXM6ZnVuY3Rpb24oKXt0aGlzLmlzSG9yaXpvbnRhbCgpfHx0aGlzLnRpY2tzLnJldmVyc2UoKX0sZ2V0TGFiZWxGb3JJbmRleDpmdW5jdGlvbih0LGUpe3JldHVybit0aGlzLmdldFJpZ2h0VmFsdWUodGhpcy5jaGFydC5kYXRhLmRhdGFzZXRzW2VdLmRhdGFbdF0pfSxnZXRQaXhlbEZvclZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMsaT1lLnN0YXJ0LG49K2UuZ2V0UmlnaHRWYWx1ZSh0KSxhPWUuZW5kLWk7cmV0dXJuIGUuaXNIb3Jpem9udGFsKCk/ZS5sZWZ0K2Uud2lkdGgvYSoobi1pKTplLmJvdHRvbS1lLmhlaWdodC9hKihuLWkpfSxnZXRWYWx1ZUZvclBpeGVsOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMsaT1lLmlzSG9yaXpvbnRhbCgpLG49aT9lLndpZHRoOmUuaGVpZ2h0LGE9KGk/dC1lLmxlZnQ6ZS5ib3R0b20tdCkvbjtyZXR1cm4gZS5zdGFydCsoZS5lbmQtZS5zdGFydCkqYX0sZ2V0UGl4ZWxGb3JUaWNrOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdldFBpeGVsRm9yVmFsdWUodGhpcy50aWNrc0FzTnVtYmVyc1t0XSl9fSk7YS5yZWdpc3RlclNjYWxlVHlwZShcImxpbmVhclwiLGksZSl9fSx7MjY6MjYsMzQ6MzQsMzU6MzUsNDY6NDZ9XSw1NjpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBjPXQoNDYpLG49dCgzMyk7ZS5leHBvcnRzPWZ1bmN0aW9uKHQpe3ZhciBlPWMubm9vcDt0LkxpbmVhclNjYWxlQmFzZT1uLmV4dGVuZCh7Z2V0UmlnaHRWYWx1ZTpmdW5jdGlvbih0KXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgdD8rdDpuLnByb3RvdHlwZS5nZXRSaWdodFZhbHVlLmNhbGwodGhpcyx0KX0saGFuZGxlVGlja1JhbmdlT3B0aW9uczpmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT10Lm9wdGlvbnMudGlja3M7aWYoZS5iZWdpbkF0WmVybyl7dmFyIGk9Yy5zaWduKHQubWluKSxuPWMuc2lnbih0Lm1heCk7aTwwJiZuPDA/dC5tYXg9MDowPGkmJjA8biYmKHQubWluPTApfXZhciBhPXZvaWQgMCE9PWUubWlufHx2b2lkIDAhPT1lLnN1Z2dlc3RlZE1pbixvPXZvaWQgMCE9PWUubWF4fHx2b2lkIDAhPT1lLnN1Z2dlc3RlZE1heDt2b2lkIDAhPT1lLm1pbj90Lm1pbj1lLm1pbjp2b2lkIDAhPT1lLnN1Z2dlc3RlZE1pbiYmKG51bGw9PT10Lm1pbj90Lm1pbj1lLnN1Z2dlc3RlZE1pbjp0Lm1pbj1NYXRoLm1pbih0Lm1pbixlLnN1Z2dlc3RlZE1pbikpLHZvaWQgMCE9PWUubWF4P3QubWF4PWUubWF4OnZvaWQgMCE9PWUuc3VnZ2VzdGVkTWF4JiYobnVsbD09PXQubWF4P3QubWF4PWUuc3VnZ2VzdGVkTWF4OnQubWF4PU1hdGgubWF4KHQubWF4LGUuc3VnZ2VzdGVkTWF4KSksYSE9PW8mJnQubWluPj10Lm1heCYmKGE/dC5tYXg9dC5taW4rMTp0Lm1pbj10Lm1heC0xKSx0Lm1pbj09PXQubWF4JiYodC5tYXgrKyxlLmJlZ2luQXRaZXJvfHx0Lm1pbi0tKX0sZ2V0VGlja0xpbWl0OmUsaGFuZGxlRGlyZWN0aW9uYWxDaGFuZ2VzOmUsYnVpbGRUaWNrczpmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT10Lm9wdGlvbnMudGlja3MsaT10LmdldFRpY2tMaW1pdCgpLG49e21heFRpY2tzOmk9TWF0aC5tYXgoMixpKSxtaW46ZS5taW4sbWF4OmUubWF4LHByZWNpc2lvbjplLnByZWNpc2lvbixzdGVwU2l6ZTpjLnZhbHVlT3JEZWZhdWx0KGUuZml4ZWRTdGVwU2l6ZSxlLnN0ZXBTaXplKX0sYT10LnRpY2tzPWZ1bmN0aW9uKHQsZSl7dmFyIGksbixhLG89W107aWYodC5zdGVwU2l6ZSYmMDx0LnN0ZXBTaXplKWE9dC5zdGVwU2l6ZTtlbHNle3ZhciByPWMubmljZU51bShlLm1heC1lLm1pbiwhMSk7YT1jLm5pY2VOdW0oci8odC5tYXhUaWNrcy0xKSwhMCksdm9pZCAwIT09KG49dC5wcmVjaXNpb24pJiYoaT1NYXRoLnBvdygxMCxuKSxhPU1hdGguY2VpbChhKmkpL2kpfXZhciBzPU1hdGguZmxvb3IoZS5taW4vYSkqYSxsPU1hdGguY2VpbChlLm1heC9hKSphO2MuaXNOdWxsT3JVbmRlZih0Lm1pbil8fGMuaXNOdWxsT3JVbmRlZih0Lm1heCl8fCF0LnN0ZXBTaXplfHxjLmFsbW9zdFdob2xlKCh0Lm1heC10Lm1pbikvdC5zdGVwU2l6ZSxhLzFlMykmJihzPXQubWluLGw9dC5tYXgpO3ZhciB1PShsLXMpL2E7dT1jLmFsbW9zdEVxdWFscyh1LE1hdGgucm91bmQodSksYS8xZTMpP01hdGgucm91bmQodSk6TWF0aC5jZWlsKHUpLGE8KG49MSkmJihuPU1hdGgucG93KDEwLDEtTWF0aC5mbG9vcihjLmxvZzEwKGEpKSkscz1NYXRoLnJvdW5kKHMqbikvbixsPU1hdGgucm91bmQobCpuKS9uKSxvLnB1c2godm9pZCAwIT09dC5taW4/dC5taW46cyk7Zm9yKHZhciBkPTE7ZDx1OysrZClvLnB1c2goTWF0aC5yb3VuZCgocytkKmEpKm4pL24pO3JldHVybiBvLnB1c2godm9pZCAwIT09dC5tYXg/dC5tYXg6bCksb30obix0KTt0LmhhbmRsZURpcmVjdGlvbmFsQ2hhbmdlcygpLHQubWF4PWMubWF4KGEpLHQubWluPWMubWluKGEpLGUucmV2ZXJzZT8oYS5yZXZlcnNlKCksdC5zdGFydD10Lm1heCx0LmVuZD10Lm1pbik6KHQuc3RhcnQ9dC5taW4sdC5lbmQ9dC5tYXgpfSxjb252ZXJ0VGlja3NUb0xhYmVsczpmdW5jdGlvbigpe3ZhciB0PXRoaXM7dC50aWNrc0FzTnVtYmVycz10LnRpY2tzLnNsaWNlKCksdC56ZXJvTGluZUluZGV4PXQudGlja3MuaW5kZXhPZigwKSxuLnByb3RvdHlwZS5jb252ZXJ0VGlja3NUb0xhYmVscy5jYWxsKHQpfX0pfX0sezMzOjMzLDQ2OjQ2fV0sNTc6W2Z1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjt2YXIgaD10KDQ2KSxuPXQoMzMpLGE9dCgzNCksbz10KDM1KTtlLmV4cG9ydHM9ZnVuY3Rpb24oYyl7dmFyIHQ9e3Bvc2l0aW9uOlwibGVmdFwiLHRpY2tzOntjYWxsYmFjazpvLmZvcm1hdHRlcnMubG9nYXJpdGhtaWN9fSxlPW4uZXh0ZW5kKHtkZXRlcm1pbmVEYXRhTGltaXRzOmZ1bmN0aW9uKCl7dmFyIHI9dGhpcyxpPXIub3B0aW9ucyxzPXIuY2hhcnQsdD1zLmRhdGEuZGF0YXNldHMsZT1yLmlzSG9yaXpvbnRhbCgpO2Z1bmN0aW9uIGwodCl7cmV0dXJuIGU/dC54QXhpc0lEPT09ci5pZDp0LnlBeGlzSUQ9PT1yLmlkfXIubWluPW51bGwsci5tYXg9bnVsbCxyLm1pbk5vdFplcm89bnVsbDt2YXIgbj1pLnN0YWNrZWQ7aWYodm9pZCAwPT09biYmaC5lYWNoKHQsZnVuY3Rpb24odCxlKXtpZighbil7dmFyIGk9cy5nZXREYXRhc2V0TWV0YShlKTtzLmlzRGF0YXNldFZpc2libGUoZSkmJmwoaSkmJnZvaWQgMCE9PWkuc3RhY2smJihuPSEwKX19KSxpLnN0YWNrZWR8fG4pe3ZhciB1PXt9O2guZWFjaCh0LGZ1bmN0aW9uKHQsZSl7dmFyIGE9cy5nZXREYXRhc2V0TWV0YShlKSxvPVthLnR5cGUsdm9pZCAwPT09aS5zdGFja2VkJiZ2b2lkIDA9PT1hLnN0YWNrP2U6XCJcIixhLnN0YWNrXS5qb2luKFwiLlwiKTtzLmlzRGF0YXNldFZpc2libGUoZSkmJmwoYSkmJih2b2lkIDA9PT11W29dJiYodVtvXT1bXSksaC5lYWNoKHQuZGF0YSxmdW5jdGlvbih0LGUpe3ZhciBpPXVbb10sbj0rci5nZXRSaWdodFZhbHVlKHQpO2lzTmFOKG4pfHxhLmRhdGFbZV0uaGlkZGVufHxuPDB8fChpW2VdPWlbZV18fDAsaVtlXSs9bil9KSl9KSxoLmVhY2godSxmdW5jdGlvbih0KXtpZigwPHQubGVuZ3RoKXt2YXIgZT1oLm1pbih0KSxpPWgubWF4KHQpO3IubWluPW51bGw9PT1yLm1pbj9lOk1hdGgubWluKHIubWluLGUpLHIubWF4PW51bGw9PT1yLm1heD9pOk1hdGgubWF4KHIubWF4LGkpfX0pfWVsc2UgaC5lYWNoKHQsZnVuY3Rpb24odCxlKXt2YXIgbj1zLmdldERhdGFzZXRNZXRhKGUpO3MuaXNEYXRhc2V0VmlzaWJsZShlKSYmbChuKSYmaC5lYWNoKHQuZGF0YSxmdW5jdGlvbih0LGUpe3ZhciBpPStyLmdldFJpZ2h0VmFsdWUodCk7aXNOYU4oaSl8fG4uZGF0YVtlXS5oaWRkZW58fGk8MHx8KG51bGw9PT1yLm1pbj9yLm1pbj1pOmk8ci5taW4mJihyLm1pbj1pKSxudWxsPT09ci5tYXg/ci5tYXg9aTppPnIubWF4JiYoci5tYXg9aSksMCE9PWkmJihudWxsPT09ci5taW5Ob3RaZXJvfHxpPHIubWluTm90WmVybykmJihyLm1pbk5vdFplcm89aSkpfSl9KTt0aGlzLmhhbmRsZVRpY2tSYW5nZU9wdGlvbnMoKX0saGFuZGxlVGlja1JhbmdlT3B0aW9uczpmdW5jdGlvbigpe3ZhciB0PXRoaXMsZT10Lm9wdGlvbnMudGlja3MsaT1oLnZhbHVlT3JEZWZhdWx0O3QubWluPWkoZS5taW4sdC5taW4pLHQubWF4PWkoZS5tYXgsdC5tYXgpLHQubWluPT09dC5tYXgmJigwIT09dC5taW4mJm51bGwhPT10Lm1pbj8odC5taW49TWF0aC5wb3coMTAsTWF0aC5mbG9vcihoLmxvZzEwKHQubWluKSktMSksdC5tYXg9TWF0aC5wb3coMTAsTWF0aC5mbG9vcihoLmxvZzEwKHQubWF4KSkrMSkpOih0Lm1pbj0xLHQubWF4PTEwKSksbnVsbD09PXQubWluJiYodC5taW49TWF0aC5wb3coMTAsTWF0aC5mbG9vcihoLmxvZzEwKHQubWF4KSktMSkpLG51bGw9PT10Lm1heCYmKHQubWF4PTAhPT10Lm1pbj9NYXRoLnBvdygxMCxNYXRoLmZsb29yKGgubG9nMTAodC5taW4pKSsxKToxMCksbnVsbD09PXQubWluTm90WmVybyYmKDA8dC5taW4/dC5taW5Ob3RaZXJvPXQubWluOnQubWF4PDE/dC5taW5Ob3RaZXJvPU1hdGgucG93KDEwLE1hdGguZmxvb3IoaC5sb2cxMCh0Lm1heCkpKTp0Lm1pbk5vdFplcm89MSl9LGJ1aWxkVGlja3M6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLGU9dC5vcHRpb25zLnRpY2tzLGk9IXQuaXNIb3Jpem9udGFsKCksbj17bWluOmUubWluLG1heDplLm1heH0sYT10LnRpY2tzPWZ1bmN0aW9uKHQsZSl7dmFyIGksbixhPVtdLG89aC52YWx1ZU9yRGVmYXVsdCxyPW8odC5taW4sTWF0aC5wb3coMTAsTWF0aC5mbG9vcihoLmxvZzEwKGUubWluKSkpKSxzPU1hdGguZmxvb3IoaC5sb2cxMChlLm1heCkpLGw9TWF0aC5jZWlsKGUubWF4L01hdGgucG93KDEwLHMpKTswPT09cj8oaT1NYXRoLmZsb29yKGgubG9nMTAoZS5taW5Ob3RaZXJvKSksbj1NYXRoLmZsb29yKGUubWluTm90WmVyby9NYXRoLnBvdygxMCxpKSksYS5wdXNoKHIpLHI9bipNYXRoLnBvdygxMCxpKSk6KGk9TWF0aC5mbG9vcihoLmxvZzEwKHIpKSxuPU1hdGguZmxvb3Ioci9NYXRoLnBvdygxMCxpKSkpO2Zvcih2YXIgdT1pPDA/TWF0aC5wb3coMTAsTWF0aC5hYnMoaSkpOjE7YS5wdXNoKHIpLDEwPT0rK24mJihuPTEsdT0wPD0rK2k/MTp1KSxyPU1hdGgucm91bmQobipNYXRoLnBvdygxMCxpKSp1KS91LGk8c3x8aT09PXMmJm48bDspO3ZhciBkPW8odC5tYXgscik7cmV0dXJuIGEucHVzaChkKSxhfShuLHQpO3QubWF4PWgubWF4KGEpLHQubWluPWgubWluKGEpLGUucmV2ZXJzZT8oaT0haSx0LnN0YXJ0PXQubWF4LHQuZW5kPXQubWluKToodC5zdGFydD10Lm1pbix0LmVuZD10Lm1heCksaSYmYS5yZXZlcnNlKCl9LGNvbnZlcnRUaWNrc1RvTGFiZWxzOmZ1bmN0aW9uKCl7dGhpcy50aWNrVmFsdWVzPXRoaXMudGlja3Muc2xpY2UoKSxuLnByb3RvdHlwZS5jb252ZXJ0VGlja3NUb0xhYmVscy5jYWxsKHRoaXMpfSxnZXRMYWJlbEZvckluZGV4OmZ1bmN0aW9uKHQsZSl7cmV0dXJuK3RoaXMuZ2V0UmlnaHRWYWx1ZSh0aGlzLmNoYXJ0LmRhdGEuZGF0YXNldHNbZV0uZGF0YVt0XSl9LGdldFBpeGVsRm9yVGljazpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5nZXRQaXhlbEZvclZhbHVlKHRoaXMudGlja1ZhbHVlc1t0XSl9LF9nZXRGaXJzdFRpY2tWYWx1ZTpmdW5jdGlvbih0KXt2YXIgZT1NYXRoLmZsb29yKGgubG9nMTAodCkpO3JldHVybiBNYXRoLmZsb29yKHQvTWF0aC5wb3coMTAsZSkpKk1hdGgucG93KDEwLGUpfSxnZXRQaXhlbEZvclZhbHVlOmZ1bmN0aW9uKHQpe3ZhciBlLGksbixhLG8scj10aGlzLHM9ci5vcHRpb25zLnRpY2tzLnJldmVyc2UsbD1oLmxvZzEwLHU9ci5fZ2V0Rmlyc3RUaWNrVmFsdWUoci5taW5Ob3RaZXJvKSxkPTA7cmV0dXJuIHQ9K3IuZ2V0UmlnaHRWYWx1ZSh0KSxvPXM/KG49ci5lbmQsYT1yLnN0YXJ0LC0xKToobj1yLnN0YXJ0LGE9ci5lbmQsMSksaT1yLmlzSG9yaXpvbnRhbCgpPyhlPXIud2lkdGgscz9yLnJpZ2h0OnIubGVmdCk6KGU9ci5oZWlnaHQsbyo9LTEscz9yLnRvcDpyLmJvdHRvbSksdCE9PW4mJigwPT09biYmKGUtPWQ9aC5nZXRWYWx1ZU9yRGVmYXVsdChyLm9wdGlvbnMudGlja3MuZm9udFNpemUsYy5kZWZhdWx0cy5nbG9iYWwuZGVmYXVsdEZvbnRTaXplKSxuPXUpLDAhPT10JiYoZCs9ZS8obChhKS1sKG4pKSoobCh0KS1sKG4pKSksaSs9bypkKSxpfSxnZXRWYWx1ZUZvclBpeGVsOmZ1bmN0aW9uKHQpe3ZhciBlLGksbixhLG89dGhpcyxyPW8ub3B0aW9ucy50aWNrcy5yZXZlcnNlLHM9aC5sb2cxMCxsPW8uX2dldEZpcnN0VGlja1ZhbHVlKG8ubWluTm90WmVybyk7aWYobj1yPyhpPW8uZW5kLG8uc3RhcnQpOihpPW8uc3RhcnQsby5lbmQpLChhPW8uaXNIb3Jpem9udGFsKCk/KGU9by53aWR0aCxyP28ucmlnaHQtdDp0LW8ubGVmdCk6KGU9by5oZWlnaHQscj90LW8udG9wOm8uYm90dG9tLXQpKSE9PWkpe2lmKDA9PT1pKXt2YXIgdT1oLmdldFZhbHVlT3JEZWZhdWx0KG8ub3B0aW9ucy50aWNrcy5mb250U2l6ZSxjLmRlZmF1bHRzLmdsb2JhbC5kZWZhdWx0Rm9udFNpemUpO2EtPXUsZS09dSxpPWx9YSo9cyhuKS1zKGkpLGEvPWUsYT1NYXRoLnBvdygxMCxzKGkpK2EpfXJldHVybiBhfX0pO2EucmVnaXN0ZXJTY2FsZVR5cGUoXCJsb2dhcml0aG1pY1wiLGUsdCl9fSx7MzM6MzMsMzQ6MzQsMzU6MzUsNDY6NDZ9XSw1ODpbZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBuPXQoMjYpLGs9dCg0NiksYT10KDM0KSxvPXQoMzUpO2UuZXhwb3J0cz1mdW5jdGlvbihlKXt2YXIgdj1uLmdsb2JhbCx0PXtkaXNwbGF5OiEwLGFuaW1hdGU6ITAscG9zaXRpb246XCJjaGFydEFyZWFcIixhbmdsZUxpbmVzOntkaXNwbGF5OiEwLGNvbG9yOlwicmdiYSgwLCAwLCAwLCAwLjEpXCIsbGluZVdpZHRoOjF9LGdyaWRMaW5lczp7Y2lyY3VsYXI6ITF9LHRpY2tzOntzaG93TGFiZWxCYWNrZHJvcDohMCxiYWNrZHJvcENvbG9yOlwicmdiYSgyNTUsMjU1LDI1NSwwLjc1KVwiLGJhY2tkcm9wUGFkZGluZ1k6MixiYWNrZHJvcFBhZGRpbmdYOjIsY2FsbGJhY2s6by5mb3JtYXR0ZXJzLmxpbmVhcn0scG9pbnRMYWJlbHM6e2Rpc3BsYXk6ITAsZm9udFNpemU6MTAsY2FsbGJhY2s6ZnVuY3Rpb24odCl7cmV0dXJuIHR9fX07ZnVuY3Rpb24gYih0KXt2YXIgZT10Lm9wdGlvbnM7cmV0dXJuIGUuYW5nbGVMaW5lcy5kaXNwbGF5fHxlLnBvaW50TGFiZWxzLmRpc3BsYXk/dC5jaGFydC5kYXRhLmxhYmVscy5sZW5ndGg6MH1mdW5jdGlvbiB4KHQpe3ZhciBlPXQub3B0aW9ucy5wb2ludExhYmVscyxpPWsudmFsdWVPckRlZmF1bHQoZS5mb250U2l6ZSx2LmRlZmF1bHRGb250U2l6ZSksbj1rLnZhbHVlT3JEZWZhdWx0KGUuZm9udFN0eWxlLHYuZGVmYXVsdEZvbnRTdHlsZSksYT1rLnZhbHVlT3JEZWZhdWx0KGUuZm9udEZhbWlseSx2LmRlZmF1bHRGb250RmFtaWx5KTtyZXR1cm57c2l6ZTppLHN0eWxlOm4sZmFtaWx5OmEsZm9udDprLmZvbnRTdHJpbmcoaSxuLGEpfX1mdW5jdGlvbiBtKHQsZSxpLG4sYSl7cmV0dXJuIHQ9PT1ufHx0PT09YT97c3RhcnQ6ZS1pLzIsZW5kOmUraS8yfTp0PG58fGE8dD97c3RhcnQ6ZS1pLTUsZW5kOmV9OntzdGFydDplLGVuZDplK2krNX19ZnVuY3Rpb24geSh0LGUsaSxuKXtpZihrLmlzQXJyYXkoZSkpZm9yKHZhciBhPWkueSxvPTEuNSpuLHI9MDtyPGUubGVuZ3RoOysrcil0LmZpbGxUZXh0KGVbcl0saS54LGEpLGErPW87ZWxzZSB0LmZpbGxUZXh0KGUsaS54LGkueSl9ZnVuY3Rpb24gcyh0KXtyZXR1cm4gay5pc051bWJlcih0KT90OjB9dmFyIGk9ZS5MaW5lYXJTY2FsZUJhc2UuZXh0ZW5kKHtzZXREaW1lbnNpb25zOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxlPXQub3B0aW9ucyxpPWUudGlja3M7dC53aWR0aD10Lm1heFdpZHRoLHQuaGVpZ2h0PXQubWF4SGVpZ2h0LHQueENlbnRlcj1NYXRoLnJvdW5kKHQud2lkdGgvMiksdC55Q2VudGVyPU1hdGgucm91bmQodC5oZWlnaHQvMik7dmFyIG49ay5taW4oW3QuaGVpZ2h0LHQud2lkdGhdKSxhPWsudmFsdWVPckRlZmF1bHQoaS5mb250U2l6ZSx2LmRlZmF1bHRGb250U2l6ZSk7dC5kcmF3aW5nQXJlYT1lLmRpc3BsYXk/bi8yLShhLzIraS5iYWNrZHJvcFBhZGRpbmdZKTpuLzJ9LGRldGVybWluZURhdGFMaW1pdHM6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLGk9YS5jaGFydCxvPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSxyPU51bWJlci5ORUdBVElWRV9JTkZJTklUWTtrLmVhY2goaS5kYXRhLmRhdGFzZXRzLGZ1bmN0aW9uKHQsZSl7aWYoaS5pc0RhdGFzZXRWaXNpYmxlKGUpKXt2YXIgbj1pLmdldERhdGFzZXRNZXRhKGUpO2suZWFjaCh0LmRhdGEsZnVuY3Rpb24odCxlKXt2YXIgaT0rYS5nZXRSaWdodFZhbHVlKHQpO2lzTmFOKGkpfHxuLmRhdGFbZV0uaGlkZGVufHwobz1NYXRoLm1pbihpLG8pLHI9TWF0aC5tYXgoaSxyKSl9KX19KSxhLm1pbj1vPT09TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZPzA6byxhLm1heD1yPT09TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZPzA6cixhLmhhbmRsZVRpY2tSYW5nZU9wdGlvbnMoKX0sZ2V0VGlja0xpbWl0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5vcHRpb25zLnRpY2tzLGU9ay52YWx1ZU9yRGVmYXVsdCh0LmZvbnRTaXplLHYuZGVmYXVsdEZvbnRTaXplKTtyZXR1cm4gTWF0aC5taW4odC5tYXhUaWNrc0xpbWl0P3QubWF4VGlja3NMaW1pdDoxMSxNYXRoLmNlaWwodGhpcy5kcmF3aW5nQXJlYS8oMS41KmUpKSl9LGNvbnZlcnRUaWNrc1RvTGFiZWxzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcztlLkxpbmVhclNjYWxlQmFzZS5wcm90b3R5cGUuY29udmVydFRpY2tzVG9MYWJlbHMuY2FsbCh0KSx0LnBvaW50TGFiZWxzPXQuY2hhcnQuZGF0YS5sYWJlbHMubWFwKHQub3B0aW9ucy5wb2ludExhYmVscy5jYWxsYmFjayx0KX0sZ2V0TGFiZWxGb3JJbmRleDpmdW5jdGlvbih0LGUpe3JldHVybit0aGlzLmdldFJpZ2h0VmFsdWUodGhpcy5jaGFydC5kYXRhLmRhdGFzZXRzW2VdLmRhdGFbdF0pfSxmaXQ6ZnVuY3Rpb24oKXt2YXIgdCxlO3RoaXMub3B0aW9ucy5wb2ludExhYmVscy5kaXNwbGF5P2Z1bmN0aW9uKHQpe3ZhciBlLGksbixhPXgodCksbz1NYXRoLm1pbih0LmhlaWdodC8yLHQud2lkdGgvMikscj17cjp0LndpZHRoLGw6MCx0OnQuaGVpZ2h0LGI6MH0scz17fTt0LmN0eC5mb250PWEuZm9udCx0Ll9wb2ludExhYmVsU2l6ZXM9W107dmFyIGwsdSxkLGM9Yih0KTtmb3IoZT0wO2U8YztlKyspe249dC5nZXRQb2ludFBvc2l0aW9uKGUsbyksbD10LmN0eCx1PWEuc2l6ZSxkPXQucG9pbnRMYWJlbHNbZV18fFwiXCIsaT1rLmlzQXJyYXkoZCk/e3c6ay5sb25nZXN0VGV4dChsLGwuZm9udCxkKSxoOmQubGVuZ3RoKnUrMS41KihkLmxlbmd0aC0xKSp1fTp7dzpsLm1lYXN1cmVUZXh0KGQpLndpZHRoLGg6dX0sdC5fcG9pbnRMYWJlbFNpemVzW2VdPWk7dmFyIGg9dC5nZXRJbmRleEFuZ2xlKGUpLGY9ay50b0RlZ3JlZXMoaCklMzYwLGc9bShmLG4ueCxpLncsMCwxODApLHA9bShmLG4ueSxpLmgsOTAsMjcwKTtnLnN0YXJ0PHIubCYmKHIubD1nLnN0YXJ0LHMubD1oKSxnLmVuZD5yLnImJihyLnI9Zy5lbmQscy5yPWgpLHAuc3RhcnQ8ci50JiYoci50PXAuc3RhcnQscy50PWgpLHAuZW5kPnIuYiYmKHIuYj1wLmVuZCxzLmI9aCl9dC5zZXRSZWR1Y3Rpb25zKG8scixzKX0odGhpcyk6KHQ9dGhpcyxlPU1hdGgubWluKHQuaGVpZ2h0LzIsdC53aWR0aC8yKSx0LmRyYXdpbmdBcmVhPU1hdGgucm91bmQoZSksdC5zZXRDZW50ZXJQb2ludCgwLDAsMCwwKSl9LHNldFJlZHVjdGlvbnM6ZnVuY3Rpb24odCxlLGkpe3ZhciBuPWUubC9NYXRoLnNpbihpLmwpLGE9TWF0aC5tYXgoZS5yLXRoaXMud2lkdGgsMCkvTWF0aC5zaW4oaS5yKSxvPS1lLnQvTWF0aC5jb3MoaS50KSxyPS1NYXRoLm1heChlLmItdGhpcy5oZWlnaHQsMCkvTWF0aC5jb3MoaS5iKTtuPXMobiksYT1zKGEpLG89cyhvKSxyPXMociksdGhpcy5kcmF3aW5nQXJlYT1NYXRoLm1pbihNYXRoLnJvdW5kKHQtKG4rYSkvMiksTWF0aC5yb3VuZCh0LShvK3IpLzIpKSx0aGlzLnNldENlbnRlclBvaW50KG4sYSxvLHIpfSxzZXRDZW50ZXJQb2ludDpmdW5jdGlvbih0LGUsaSxuKXt2YXIgYT10aGlzLG89YS53aWR0aC1lLWEuZHJhd2luZ0FyZWEscj10K2EuZHJhd2luZ0FyZWEscz1pK2EuZHJhd2luZ0FyZWEsbD1hLmhlaWdodC1uLWEuZHJhd2luZ0FyZWE7YS54Q2VudGVyPU1hdGgucm91bmQoKHIrbykvMithLmxlZnQpLGEueUNlbnRlcj1NYXRoLnJvdW5kKChzK2wpLzIrYS50b3ApfSxnZXRJbmRleEFuZ2xlOmZ1bmN0aW9uKHQpe3JldHVybiB0KigyKk1hdGguUEkvYih0aGlzKSkrKHRoaXMuY2hhcnQub3B0aW9ucyYmdGhpcy5jaGFydC5vcHRpb25zLnN0YXJ0QW5nbGU/dGhpcy5jaGFydC5vcHRpb25zLnN0YXJ0QW5nbGU6MCkqTWF0aC5QSSoyLzM2MH0sZ2V0RGlzdGFuY2VGcm9tQ2VudGVyRm9yVmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcztpZihudWxsPT09dClyZXR1cm4gMDt2YXIgaT1lLmRyYXdpbmdBcmVhLyhlLm1heC1lLm1pbik7cmV0dXJuIGUub3B0aW9ucy50aWNrcy5yZXZlcnNlPyhlLm1heC10KSppOih0LWUubWluKSppfSxnZXRQb2ludFBvc2l0aW9uOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5nZXRJbmRleEFuZ2xlKHQpLU1hdGguUEkvMjtyZXR1cm57eDpNYXRoLnJvdW5kKE1hdGguY29zKGkpKmUpK3RoaXMueENlbnRlcix5Ok1hdGgucm91bmQoTWF0aC5zaW4oaSkqZSkrdGhpcy55Q2VudGVyfX0sZ2V0UG9pbnRQb3NpdGlvbkZvclZhbHVlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuZ2V0UG9pbnRQb3NpdGlvbih0LHRoaXMuZ2V0RGlzdGFuY2VGcm9tQ2VudGVyRm9yVmFsdWUoZSkpfSxnZXRCYXNlUG9zaXRpb246ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm1pbixlPXRoaXMubWF4O3JldHVybiB0aGlzLmdldFBvaW50UG9zaXRpb25Gb3JWYWx1ZSgwLHRoaXMuYmVnaW5BdFplcm8/MDp0PDAmJmU8MD9lOjA8dCYmMDxlP3Q6MCl9LGRyYXc6ZnVuY3Rpb24oKXt2YXIgbz10aGlzLHQ9by5vcHRpb25zLHI9dC5ncmlkTGluZXMscz10LnRpY2tzLGw9ay52YWx1ZU9yRGVmYXVsdDtpZih0LmRpc3BsYXkpe3ZhciB1PW8uY3R4LGQ9dGhpcy5nZXRJbmRleEFuZ2xlKDApLGM9bChzLmZvbnRTaXplLHYuZGVmYXVsdEZvbnRTaXplKSxlPWwocy5mb250U3R5bGUsdi5kZWZhdWx0Rm9udFN0eWxlKSxpPWwocy5mb250RmFtaWx5LHYuZGVmYXVsdEZvbnRGYW1pbHkpLGg9ay5mb250U3RyaW5nKGMsZSxpKTtrLmVhY2goby50aWNrcyxmdW5jdGlvbih0LGUpe2lmKDA8ZXx8cy5yZXZlcnNlKXt2YXIgaT1vLmdldERpc3RhbmNlRnJvbUNlbnRlckZvclZhbHVlKG8udGlja3NBc051bWJlcnNbZV0pO2lmKHIuZGlzcGxheSYmMCE9PWUmJmZ1bmN0aW9uKHQsZSxpLG4pe3ZhciBhPXQuY3R4O2lmKGEuc3Ryb2tlU3R5bGU9ay52YWx1ZUF0SW5kZXhPckRlZmF1bHQoZS5jb2xvcixuLTEpLGEubGluZVdpZHRoPWsudmFsdWVBdEluZGV4T3JEZWZhdWx0KGUubGluZVdpZHRoLG4tMSksdC5vcHRpb25zLmdyaWRMaW5lcy5jaXJjdWxhcilhLmJlZ2luUGF0aCgpLGEuYXJjKHQueENlbnRlcix0LnlDZW50ZXIsaSwwLDIqTWF0aC5QSSksYS5jbG9zZVBhdGgoKSxhLnN0cm9rZSgpO2Vsc2V7dmFyIG89Yih0KTtpZigwPT09bylyZXR1cm47YS5iZWdpblBhdGgoKTt2YXIgcj10LmdldFBvaW50UG9zaXRpb24oMCxpKTthLm1vdmVUbyhyLngsci55KTtmb3IodmFyIHM9MTtzPG87cysrKXI9dC5nZXRQb2ludFBvc2l0aW9uKHMsaSksYS5saW5lVG8oci54LHIueSk7YS5jbG9zZVBhdGgoKSxhLnN0cm9rZSgpfX0obyxyLGksZSkscy5kaXNwbGF5KXt2YXIgbj1sKHMuZm9udENvbG9yLHYuZGVmYXVsdEZvbnRDb2xvcik7aWYodS5mb250PWgsdS5zYXZlKCksdS50cmFuc2xhdGUoby54Q2VudGVyLG8ueUNlbnRlciksdS5yb3RhdGUoZCkscy5zaG93TGFiZWxCYWNrZHJvcCl7dmFyIGE9dS5tZWFzdXJlVGV4dCh0KS53aWR0aDt1LmZpbGxTdHlsZT1zLmJhY2tkcm9wQ29sb3IsdS5maWxsUmVjdCgtYS8yLXMuYmFja2Ryb3BQYWRkaW5nWCwtaS1jLzItcy5iYWNrZHJvcFBhZGRpbmdZLGErMipzLmJhY2tkcm9wUGFkZGluZ1gsYysyKnMuYmFja2Ryb3BQYWRkaW5nWSl9dS50ZXh0QWxpZ249XCJjZW50ZXJcIix1LnRleHRCYXNlbGluZT1cIm1pZGRsZVwiLHUuZmlsbFN0eWxlPW4sdS5maWxsVGV4dCh0LDAsLWkpLHUucmVzdG9yZSgpfX19KSwodC5hbmdsZUxpbmVzLmRpc3BsYXl8fHQucG9pbnRMYWJlbHMuZGlzcGxheSkmJmZ1bmN0aW9uKHQpe3ZhciBlPXQuY3R4LGk9dC5vcHRpb25zLG49aS5hbmdsZUxpbmVzLGE9aS5wb2ludExhYmVscztlLmxpbmVXaWR0aD1uLmxpbmVXaWR0aCxlLnN0cm9rZVN0eWxlPW4uY29sb3I7dmFyIG8scixzLGwsdT10LmdldERpc3RhbmNlRnJvbUNlbnRlckZvclZhbHVlKGkudGlja3MucmV2ZXJzZT90Lm1pbjp0Lm1heCksZD14KHQpO2UudGV4dEJhc2VsaW5lPVwidG9wXCI7Zm9yKHZhciBjPWIodCktMTswPD1jO2MtLSl7aWYobi5kaXNwbGF5KXt2YXIgaD10LmdldFBvaW50UG9zaXRpb24oYyx1KTtlLmJlZ2luUGF0aCgpLGUubW92ZVRvKHQueENlbnRlcix0LnlDZW50ZXIpLGUubGluZVRvKGgueCxoLnkpLGUuc3Ryb2tlKCksZS5jbG9zZVBhdGgoKX1pZihhLmRpc3BsYXkpe3ZhciBmPXQuZ2V0UG9pbnRQb3NpdGlvbihjLHUrNSksZz1rLnZhbHVlQXRJbmRleE9yRGVmYXVsdChhLmZvbnRDb2xvcixjLHYuZGVmYXVsdEZvbnRDb2xvcik7ZS5mb250PWQuZm9udCxlLmZpbGxTdHlsZT1nO3ZhciBwPXQuZ2V0SW5kZXhBbmdsZShjKSxtPWsudG9EZWdyZWVzKHApO2UudGV4dEFsaWduPTA9PT0obD1tKXx8MTgwPT09bD9cImNlbnRlclwiOmw8MTgwP1wibGVmdFwiOlwicmlnaHRcIixvPW0scj10Ll9wb2ludExhYmVsU2l6ZXNbY10scz1mLDkwPT09b3x8MjcwPT09bz9zLnktPXIuaC8yOigyNzA8b3x8bzw5MCkmJihzLnktPXIuaCkseShlLHQucG9pbnRMYWJlbHNbY118fFwiXCIsZixkLnNpemUpfX19KG8pfX19KTthLnJlZ2lzdGVyU2NhbGVUeXBlKFwicmFkaWFsTGluZWFyXCIsaSx0KX19LHsyNjoyNiwzNDozNCwzNTozNSw0Njo0Nn1dLDU5OltmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIHg9dCgxKTt4PVwiZnVuY3Rpb25cIj09dHlwZW9mIHg/eDp3aW5kb3cubW9tZW50O3ZhciByPXQoMjYpLG09dCg0Niksbj10KDMzKSxhPXQoMzQpLHA9TnVtYmVyLk1JTl9TQUZFX0lOVEVHRVJ8fC05MDA3MTk5MjU0NzQwOTkxLHY9TnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJ8fDkwMDcxOTkyNTQ3NDA5OTEseT17bWlsbGlzZWNvbmQ6e2NvbW1vbjohMCxzaXplOjEsc3RlcHM6WzEsMiw1LDEwLDIwLDUwLDEwMCwyNTAsNTAwXX0sc2Vjb25kOntjb21tb246ITAsc2l6ZToxZTMsc3RlcHM6WzEsMiw1LDEwLDE1LDMwXX0sbWludXRlOntjb21tb246ITAsc2l6ZTo2ZTQsc3RlcHM6WzEsMiw1LDEwLDE1LDMwXX0saG91cjp7Y29tbW9uOiEwLHNpemU6MzZlNSxzdGVwczpbMSwyLDMsNiwxMl19LGRheTp7Y29tbW9uOiEwLHNpemU6ODY0ZTUsc3RlcHM6WzEsMiw1XX0sd2Vlazp7Y29tbW9uOiExLHNpemU6NjA0OGU1LHN0ZXBzOlsxLDIsMyw0XX0sbW9udGg6e2NvbW1vbjohMCxzaXplOjI2MjhlNixzdGVwczpbMSwyLDNdfSxxdWFydGVyOntjb21tb246ITEsc2l6ZTo3ODg0ZTYsc3RlcHM6WzEsMiwzLDRdfSx5ZWFyOntjb21tb246ITAsc2l6ZTozMTU0ZTd9fSxrPU9iamVjdC5rZXlzKHkpO2Z1bmN0aW9uIGIodCxlKXtyZXR1cm4gdC1lfWZ1bmN0aW9uIE0odCl7dmFyIGUsaSxuLGE9e30sbz1bXTtmb3IoZT0wLGk9dC5sZW5ndGg7ZTxpOysrZSlhW249dFtlXV18fChhW25dPSEwLG8ucHVzaChuKSk7cmV0dXJuIG99ZnVuY3Rpb24gdyh0LGUsaSxuKXt2YXIgYT1mdW5jdGlvbih0LGUsaSl7Zm9yKHZhciBuLGEsbyxyPTAscz10Lmxlbmd0aC0xOzA8PXImJnI8PXM7KXtpZihhPXRbKG49citzPj4xKS0xXXx8bnVsbCxvPXRbbl0sIWEpcmV0dXJue2xvOm51bGwsaGk6b307aWYob1tlXTxpKXI9bisxO2Vsc2V7aWYoIShhW2VdPmkpKXJldHVybntsbzphLGhpOm99O3M9bi0xfX1yZXR1cm57bG86byxoaTpudWxsfX0odCxlLGkpLG89YS5sbz9hLmhpP2EubG86dFt0Lmxlbmd0aC0yXTp0WzBdLHI9YS5sbz9hLmhpP2EuaGk6dFt0Lmxlbmd0aC0xXTp0WzFdLHM9cltlXS1vW2VdLGw9cz8oaS1vW2VdKS9zOjAsdT0ocltuXS1vW25dKSpsO3JldHVybiBvW25dK3V9ZnVuY3Rpb24gQyh0LGUpe3ZhciBpPWUucGFyc2VyLG49ZS5wYXJzZXJ8fGUuZm9ybWF0O3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIGk/aSh0KTpcInN0cmluZ1wiPT10eXBlb2YgdCYmXCJzdHJpbmdcIj09dHlwZW9mIG4/eCh0LG4pOih0IGluc3RhbmNlb2YgeHx8KHQ9eCh0KSksdC5pc1ZhbGlkKCk/dDpcImZ1bmN0aW9uXCI9PXR5cGVvZiBuP24odCk6dCl9ZnVuY3Rpb24gUyh0LGUpe2lmKG0uaXNOdWxsT3JVbmRlZih0KSlyZXR1cm4gbnVsbDt2YXIgaT1lLm9wdGlvbnMudGltZSxuPUMoZS5nZXRSaWdodFZhbHVlKHQpLGkpO3JldHVybiBuLmlzVmFsaWQoKT8oaS5yb3VuZCYmbi5zdGFydE9mKGkucm91bmQpLG4udmFsdWVPZigpKTpudWxsfWZ1bmN0aW9uIF8odCl7Zm9yKHZhciBlPWsuaW5kZXhPZih0KSsxLGk9ay5sZW5ndGg7ZTxpOysrZSlpZih5W2tbZV1dLmNvbW1vbilyZXR1cm4ga1tlXX1mdW5jdGlvbiBEKHQsZSxpLG4pe3ZhciBhLG89bi50aW1lLHI9by51bml0fHxmdW5jdGlvbih0LGUsaSxuKXt2YXIgYSxvLHIscz1rLmxlbmd0aDtmb3IoYT1rLmluZGV4T2YodCk7YTxzLTE7KythKWlmKHI9KG89eVtrW2FdXSkuc3RlcHM/by5zdGVwc1tvLnN0ZXBzLmxlbmd0aC0xXTp2LG8uY29tbW9uJiZNYXRoLmNlaWwoKGktZSkvKHIqby5zaXplKSk8PW4pcmV0dXJuIGtbYV07cmV0dXJuIGtbcy0xXX0oby5taW5Vbml0LHQsZSxpKSxzPV8ociksbD1tLnZhbHVlT3JEZWZhdWx0KG8uc3RlcFNpemUsby51bml0U3RlcFNpemUpLHU9XCJ3ZWVrXCI9PT1yJiZvLmlzb1dlZWtkYXksZD1uLnRpY2tzLm1ham9yLmVuYWJsZWQsYz15W3JdLGg9eCh0KSxmPXgoZSksZz1bXTtmb3IobHx8KGw9ZnVuY3Rpb24odCxlLGksbil7dmFyIGEsbyxyLHM9ZS10LGw9eVtpXSx1PWwuc2l6ZSxkPWwuc3RlcHM7aWYoIWQpcmV0dXJuIE1hdGguY2VpbChzLyhuKnUpKTtmb3IoYT0wLG89ZC5sZW5ndGg7YTxvJiYocj1kW2FdLCEoTWF0aC5jZWlsKHMvKHUqcikpPD1uKSk7KythKTtyZXR1cm4gcn0odCxlLHIsaSkpLHUmJihoPWguaXNvV2Vla2RheSh1KSxmPWYuaXNvV2Vla2RheSh1KSksaD1oLnN0YXJ0T2YodT9cImRheVwiOnIpLChmPWYuc3RhcnRPZih1P1wiZGF5XCI6cikpPGUmJmYuYWRkKDEsciksYT14KGgpLGQmJnMmJiF1JiYhby5yb3VuZCYmKGEuc3RhcnRPZihzKSxhLmFkZCh+figoaC1hKS8oYy5zaXplKmwpKSpsLHIpKTthPGY7YS5hZGQobCxyKSlnLnB1c2goK2EpO3JldHVybiBnLnB1c2goK2EpLGd9ZS5leHBvcnRzPWZ1bmN0aW9uKCl7dmFyIHQ9bi5leHRlbmQoe2luaXRpYWxpemU6ZnVuY3Rpb24oKXtpZigheCl0aHJvdyBuZXcgRXJyb3IoXCJDaGFydC5qcyAtIE1vbWVudC5qcyBjb3VsZCBub3QgYmUgZm91bmQhIFlvdSBtdXN0IGluY2x1ZGUgaXQgYmVmb3JlIENoYXJ0LmpzIHRvIHVzZSB0aGUgdGltZSBzY2FsZS4gRG93bmxvYWQgYXQgaHR0cHM6Ly9tb21lbnRqcy5jb21cIik7dGhpcy5tZXJnZVRpY2tzT3B0aW9ucygpLG4ucHJvdG90eXBlLmluaXRpYWxpemUuY2FsbCh0aGlzKX0sdXBkYXRlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5vcHRpb25zO3JldHVybiB0LnRpbWUmJnQudGltZS5mb3JtYXQmJmNvbnNvbGUud2FybihcIm9wdGlvbnMudGltZS5mb3JtYXQgaXMgZGVwcmVjYXRlZCBhbmQgcmVwbGFjZWQgYnkgb3B0aW9ucy50aW1lLnBhcnNlci5cIiksbi5wcm90b3R5cGUudXBkYXRlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZ2V0UmlnaHRWYWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdm9pZCAwIT09dC50JiYodD10LnQpLG4ucHJvdG90eXBlLmdldFJpZ2h0VmFsdWUuY2FsbCh0aGlzLHQpfSxkZXRlcm1pbmVEYXRhTGltaXRzOmZ1bmN0aW9uKCl7dmFyIHQsZSxpLG4sYSxvLHI9dGhpcyxzPXIuY2hhcnQsbD1yLm9wdGlvbnMudGltZSx1PWwudW5pdHx8XCJkYXlcIixkPXYsYz1wLGg9W10sZj1bXSxnPVtdO2Zvcih0PTAsaT1zLmRhdGEubGFiZWxzLmxlbmd0aDt0PGk7Kyt0KWcucHVzaChTKHMuZGF0YS5sYWJlbHNbdF0scikpO2Zvcih0PTAsaT0ocy5kYXRhLmRhdGFzZXRzfHxbXSkubGVuZ3RoO3Q8aTsrK3QpaWYocy5pc0RhdGFzZXRWaXNpYmxlKHQpKWlmKGE9cy5kYXRhLmRhdGFzZXRzW3RdLmRhdGEsbS5pc09iamVjdChhWzBdKSlmb3IoZlt0XT1bXSxlPTAsbj1hLmxlbmd0aDtlPG47KytlKW89UyhhW2VdLHIpLGgucHVzaChvKSxmW3RdW2VdPW87ZWxzZSBoLnB1c2guYXBwbHkoaCxnKSxmW3RdPWcuc2xpY2UoMCk7ZWxzZSBmW3RdPVtdO2cubGVuZ3RoJiYoZz1NKGcpLnNvcnQoYiksZD1NYXRoLm1pbihkLGdbMF0pLGM9TWF0aC5tYXgoYyxnW2cubGVuZ3RoLTFdKSksaC5sZW5ndGgmJihoPU0oaCkuc29ydChiKSxkPU1hdGgubWluKGQsaFswXSksYz1NYXRoLm1heChjLGhbaC5sZW5ndGgtMV0pKSxkPVMobC5taW4scil8fGQsYz1TKGwubWF4LHIpfHxjLGQ9ZD09PXY/K3goKS5zdGFydE9mKHUpOmQsYz1jPT09cD8reCgpLmVuZE9mKHUpKzE6YyxyLm1pbj1NYXRoLm1pbihkLGMpLHIubWF4PU1hdGgubWF4KGQrMSxjKSxyLl9ob3Jpem9udGFsPXIuaXNIb3Jpem9udGFsKCksci5fdGFibGU9W10sci5fdGltZXN0YW1wcz17ZGF0YTpoLGRhdGFzZXRzOmYsbGFiZWxzOmd9fSxidWlsZFRpY2tzOmZ1bmN0aW9uKCl7dmFyIHQsZSxpLG4sYSxvLHIscyxsLHUsZCxjLGg9dGhpcyxmPWgubWluLGc9aC5tYXgscD1oLm9wdGlvbnMsbT1wLnRpbWUsdj1bXSxiPVtdO3N3aXRjaChwLnRpY2tzLnNvdXJjZSl7Y2FzZVwiZGF0YVwiOnY9aC5fdGltZXN0YW1wcy5kYXRhO2JyZWFrO2Nhc2VcImxhYmVsc1wiOnY9aC5fdGltZXN0YW1wcy5sYWJlbHM7YnJlYWs7Y2FzZVwiYXV0b1wiOmRlZmF1bHQ6dj1EKGYsZyxoLmdldExhYmVsQ2FwYWNpdHkoZikscCl9Zm9yKFwidGlja3NcIj09PXAuYm91bmRzJiZ2Lmxlbmd0aCYmKGY9dlswXSxnPXZbdi5sZW5ndGgtMV0pLGY9UyhtLm1pbixoKXx8ZixnPVMobS5tYXgsaCl8fGcsdD0wLGU9di5sZW5ndGg7dDxlOysrdClmPD0oaT12W3RdKSYmaTw9ZyYmYi5wdXNoKGkpO3JldHVybiBoLm1pbj1mLGgubWF4PWcsaC5fdW5pdD1tLnVuaXR8fGZ1bmN0aW9uKHQsZSxpLG4pe3ZhciBhLG8scj14LmR1cmF0aW9uKHgobikuZGlmZih4KGkpKSk7Zm9yKGE9ay5sZW5ndGgtMTthPj1rLmluZGV4T2YoZSk7YS0tKWlmKG89a1thXSx5W29dLmNvbW1vbiYmci5hcyhvKT49dC5sZW5ndGgpcmV0dXJuIG87cmV0dXJuIGtbZT9rLmluZGV4T2YoZSk6MF19KGIsbS5taW5Vbml0LGgubWluLGgubWF4KSxoLl9tYWpvclVuaXQ9XyhoLl91bml0KSxoLl90YWJsZT1mdW5jdGlvbih0LGUsaSxuKXtpZihcImxpbmVhclwiPT09bnx8IXQubGVuZ3RoKXJldHVyblt7dGltZTplLHBvczowfSx7dGltZTppLHBvczoxfV07dmFyIGEsbyxyLHMsbCx1PVtdLGQ9W2VdO2ZvcihhPTAsbz10Lmxlbmd0aDthPG87KythKWU8KHM9dFthXSkmJnM8aSYmZC5wdXNoKHMpO2ZvcihkLnB1c2goaSksYT0wLG89ZC5sZW5ndGg7YTxvOysrYSlsPWRbYSsxXSxyPWRbYS0xXSxzPWRbYV0sdm9pZCAwIT09ciYmdm9pZCAwIT09bCYmTWF0aC5yb3VuZCgobCtyKS8yKT09PXN8fHUucHVzaCh7dGltZTpzLHBvczphLyhvLTEpfSk7cmV0dXJuIHV9KGguX3RpbWVzdGFtcHMuZGF0YSxmLGcscC5kaXN0cmlidXRpb24pLGguX29mZnNldHM9KG49aC5fdGFibGUsYT1iLG89ZixyPWcsYz1kPTAsKHM9cCkub2Zmc2V0JiZhLmxlbmd0aCYmKHMudGltZS5taW58fChsPTE8YS5sZW5ndGg/YVsxXTpyLHU9YVswXSxkPSh3KG4sXCJ0aW1lXCIsbCxcInBvc1wiKS13KG4sXCJ0aW1lXCIsdSxcInBvc1wiKSkvMikscy50aW1lLm1heHx8KGw9YVthLmxlbmd0aC0xXSx1PTE8YS5sZW5ndGg/YVthLmxlbmd0aC0yXTpvLGM9KHcobixcInRpbWVcIixsLFwicG9zXCIpLXcobixcInRpbWVcIix1LFwicG9zXCIpKS8yKSkse2xlZnQ6ZCxyaWdodDpjfSksaC5fbGFiZWxGb3JtYXQ9ZnVuY3Rpb24odCxlKXt2YXIgaSxuLGEsbz10Lmxlbmd0aDtmb3IoaT0wO2k8bztpKyspe2lmKDAhPT0obj1DKHRbaV0sZSkpLm1pbGxpc2Vjb25kKCkpcmV0dXJuXCJNTU0gRCwgWVlZWSBoOm1tOnNzLlNTUyBhXCI7MD09PW4uc2Vjb25kKCkmJjA9PT1uLm1pbnV0ZSgpJiYwPT09bi5ob3VyKCl8fChhPSEwKX1yZXR1cm4gYT9cIk1NTSBELCBZWVlZIGg6bW06c3MgYVwiOlwiTU1NIEQsIFlZWVlcIn0oaC5fdGltZXN0YW1wcy5kYXRhLG0pLGZ1bmN0aW9uKHQsZSl7dmFyIGksbixhLG8scj1bXTtmb3IoaT0wLG49dC5sZW5ndGg7aTxuOysraSlhPXRbaV0sbz0hIWUmJmE9PT0reChhKS5zdGFydE9mKGUpLHIucHVzaCh7dmFsdWU6YSxtYWpvcjpvfSk7cmV0dXJuIHJ9KGIsaC5fbWFqb3JVbml0KX0sZ2V0TGFiZWxGb3JJbmRleDpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuY2hhcnQuZGF0YSxuPXRoaXMub3B0aW9ucy50aW1lLGE9aS5sYWJlbHMmJnQ8aS5sYWJlbHMubGVuZ3RoP2kubGFiZWxzW3RdOlwiXCIsbz1pLmRhdGFzZXRzW2VdLmRhdGFbdF07cmV0dXJuIG0uaXNPYmplY3QobykmJihhPXRoaXMuZ2V0UmlnaHRWYWx1ZShvKSksbi50b29sdGlwRm9ybWF0P0MoYSxuKS5mb3JtYXQobi50b29sdGlwRm9ybWF0KTpcInN0cmluZ1wiPT10eXBlb2YgYT9hOkMoYSxuKS5mb3JtYXQodGhpcy5fbGFiZWxGb3JtYXQpfSx0aWNrRm9ybWF0RnVuY3Rpb246ZnVuY3Rpb24odCxlLGksbil7dmFyIGE9dGhpcy5vcHRpb25zLG89dC52YWx1ZU9mKCkscj1hLnRpbWUuZGlzcGxheUZvcm1hdHMscz1yW3RoaXMuX3VuaXRdLGw9dGhpcy5fbWFqb3JVbml0LHU9cltsXSxkPXQuY2xvbmUoKS5zdGFydE9mKGwpLnZhbHVlT2YoKSxjPWEudGlja3MubWFqb3IsaD1jLmVuYWJsZWQmJmwmJnUmJm89PT1kLGY9dC5mb3JtYXQobnx8KGg/dTpzKSksZz1oP2M6YS50aWNrcy5taW5vcixwPW0udmFsdWVPckRlZmF1bHQoZy5jYWxsYmFjayxnLnVzZXJDYWxsYmFjayk7cmV0dXJuIHA/cChmLGUsaSk6Zn0sY29udmVydFRpY2tzVG9MYWJlbHM6ZnVuY3Rpb24odCl7dmFyIGUsaSxuPVtdO2ZvcihlPTAsaT10Lmxlbmd0aDtlPGk7KytlKW4ucHVzaCh0aGlzLnRpY2tGb3JtYXRGdW5jdGlvbih4KHRbZV0udmFsdWUpLGUsdCkpO3JldHVybiBufSxnZXRQaXhlbEZvck9mZnNldDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLGk9ZS5faG9yaXpvbnRhbD9lLndpZHRoOmUuaGVpZ2h0LG49ZS5faG9yaXpvbnRhbD9lLmxlZnQ6ZS50b3AsYT13KGUuX3RhYmxlLFwidGltZVwiLHQsXCJwb3NcIik7cmV0dXJuIG4raSooZS5fb2Zmc2V0cy5sZWZ0K2EpLyhlLl9vZmZzZXRzLmxlZnQrMStlLl9vZmZzZXRzLnJpZ2h0KX0sZ2V0UGl4ZWxGb3JWYWx1ZTpmdW5jdGlvbih0LGUsaSl7dmFyIG49bnVsbDtpZih2b2lkIDAhPT1lJiZ2b2lkIDAhPT1pJiYobj10aGlzLl90aW1lc3RhbXBzLmRhdGFzZXRzW2ldW2VdKSxudWxsPT09biYmKG49Uyh0LHRoaXMpKSxudWxsIT09bilyZXR1cm4gdGhpcy5nZXRQaXhlbEZvck9mZnNldChuKX0sZ2V0UGl4ZWxGb3JUaWNrOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0VGlja3MoKTtyZXR1cm4gMDw9dCYmdDxlLmxlbmd0aD90aGlzLmdldFBpeGVsRm9yT2Zmc2V0KGVbdF0udmFsdWUpOm51bGx9LGdldFZhbHVlRm9yUGl4ZWw6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxpPWUuX2hvcml6b250YWw/ZS53aWR0aDplLmhlaWdodCxuPWUuX2hvcml6b250YWw/ZS5sZWZ0OmUudG9wLGE9KGk/KHQtbikvaTowKSooZS5fb2Zmc2V0cy5sZWZ0KzErZS5fb2Zmc2V0cy5sZWZ0KS1lLl9vZmZzZXRzLnJpZ2h0LG89dyhlLl90YWJsZSxcInBvc1wiLGEsXCJ0aW1lXCIpO3JldHVybiB4KG8pfSxnZXRMYWJlbFdpZHRoOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMub3B0aW9ucy50aWNrcyxpPXRoaXMuY3R4Lm1lYXN1cmVUZXh0KHQpLndpZHRoLG49bS50b1JhZGlhbnMoZS5tYXhSb3RhdGlvbiksYT1NYXRoLmNvcyhuKSxvPU1hdGguc2luKG4pO3JldHVybiBpKmErbS52YWx1ZU9yRGVmYXVsdChlLmZvbnRTaXplLHIuZ2xvYmFsLmRlZmF1bHRGb250U2l6ZSkqb30sZ2V0TGFiZWxDYXBhY2l0eTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLm9wdGlvbnMudGltZS5kaXNwbGF5Rm9ybWF0cy5taWxsaXNlY29uZCxpPXRoaXMudGlja0Zvcm1hdEZ1bmN0aW9uKHgodCksMCxbXSxlKSxuPXRoaXMuZ2V0TGFiZWxXaWR0aChpKSxhPXRoaXMuaXNIb3Jpem9udGFsKCk/dGhpcy53aWR0aDp0aGlzLmhlaWdodCxvPU1hdGguZmxvb3IoYS9uKTtyZXR1cm4gMDxvP286MX19KTthLnJlZ2lzdGVyU2NhbGVUeXBlKFwidGltZVwiLHQse3Bvc2l0aW9uOlwiYm90dG9tXCIsZGlzdHJpYnV0aW9uOlwibGluZWFyXCIsYm91bmRzOlwiZGF0YVwiLHRpbWU6e3BhcnNlcjohMSxmb3JtYXQ6ITEsdW5pdDohMSxyb3VuZDohMSxkaXNwbGF5Rm9ybWF0OiExLGlzb1dlZWtkYXk6ITEsbWluVW5pdDpcIm1pbGxpc2Vjb25kXCIsZGlzcGxheUZvcm1hdHM6e21pbGxpc2Vjb25kOlwiaDptbTpzcy5TU1MgYVwiLHNlY29uZDpcImg6bW06c3MgYVwiLG1pbnV0ZTpcImg6bW0gYVwiLGhvdXI6XCJoQVwiLGRheTpcIk1NTSBEXCIsd2VlazpcImxsXCIsbW9udGg6XCJNTU0gWVlZWVwiLHF1YXJ0ZXI6XCJbUV1RIC0gWVlZWVwiLHllYXI6XCJZWVlZXCJ9fSx0aWNrczp7YXV0b1NraXA6ITEsc291cmNlOlwiYXV0b1wiLG1ham9yOntlbmFibGVkOiExfX19KX19LHsxOjEsMjY6MjYsMzM6MzMsMzQ6MzQsNDY6NDZ9XX0se30sWzddKSg3KX0pOyIsImlmICghRWxlbWVudC5wcm90b3R5cGUubWF0Y2hlcykge1xuICBFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzID0gRWxlbWVudC5wcm90b3R5cGUubXNNYXRjaGVzU2VsZWN0b3IgfHwgIEVsZW1lbnQucHJvdG90eXBlLndlYmtpdE1hdGNoZXNTZWxlY3Rvcjtcbn1cblxuaWYgKCFFbGVtZW50LnByb3RvdHlwZS5jbG9zZXN0KSB7XG4gIEVsZW1lbnQucHJvdG90eXBlLmNsb3Nlc3QgPSBmdW5jdGlvbihzKSB7XG4gICAgICB2YXIgZWwgPSB0aGlzO1xuICAgICAgaWYgKCFkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY29udGFpbnMoZWwpKSByZXR1cm4gbnVsbDtcbiAgICAgIGRvIHtcbiAgICAgICAgICBpZiAoZWwubWF0Y2hlcyhzKSkgcmV0dXJuIGVsO1xuICAgICAgICAgIGVsID0gZWwucGFyZW50RWxlbWVudDtcbiAgICAgIH0gd2hpbGUgKGVsICE9PSBudWxsKTtcbiAgICAgIHJldHVybiBudWxsO1xuICB9O1xufVxuIiwiIWZ1bmN0aW9uKGUpe2lmKFwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlKW1vZHVsZS5leHBvcnRzPWUoKTtlbHNlIGlmKFwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoW10sZSk7ZWxzZXt2YXIgbjtuPVwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OlwidW5kZWZpbmVkXCIhPXR5cGVvZiBnbG9iYWw/Z2xvYmFsOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBzZWxmP3NlbGY6dGhpcyxuLmRyYWd1bGE9ZSgpfX0oZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24gZShuLHQscil7ZnVuY3Rpb24gbyh1LGMpe2lmKCF0W3VdKXtpZighblt1XSl7dmFyIGE9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighYyYmYSlyZXR1cm4gYSh1LCEwKTtpZihpKXJldHVybiBpKHUsITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrdStcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9dFt1XT17ZXhwb3J0czp7fX07blt1XVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgdD1uW3VdWzFdW2VdO3JldHVybiBvKHQ/dDplKX0sbCxsLmV4cG9ydHMsZSxuLHQscil9cmV0dXJuIHRbdV0uZXhwb3J0c31mb3IodmFyIGk9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSx1PTA7dTxyLmxlbmd0aDt1KyspbyhyW3VdKTtyZXR1cm4gb30oezE6W2Z1bmN0aW9uKGUsbix0KXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUpe3ZhciBuPXVbZV07cmV0dXJuIG4/bi5sYXN0SW5kZXg9MDp1W2VdPW49bmV3IFJlZ0V4cChjK2UrYSxcImdcIiksbn1mdW5jdGlvbiBvKGUsbil7dmFyIHQ9ZS5jbGFzc05hbWU7dC5sZW5ndGg/cihuKS50ZXN0KHQpfHwoZS5jbGFzc05hbWUrPVwiIFwiK24pOmUuY2xhc3NOYW1lPW59ZnVuY3Rpb24gaShlLG4pe2UuY2xhc3NOYW1lPWUuY2xhc3NOYW1lLnJlcGxhY2UocihuKSxcIiBcIikudHJpbSgpfXZhciB1PXt9LGM9XCIoPzpefFxcXFxzKVwiLGE9XCIoPzpcXFxcc3wkKVwiO24uZXhwb3J0cz17YWRkOm8scm06aX19LHt9XSwyOltmdW5jdGlvbihlLG4sdCl7KGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSxuKXtmdW5jdGlvbiB0KGUpe3JldHVybi0xIT09bGUuY29udGFpbmVycy5pbmRleE9mKGUpfHxmZS5pc0NvbnRhaW5lcihlKX1mdW5jdGlvbiByKGUpe3ZhciBuPWU/XCJyZW1vdmVcIjpcImFkZFwiO28oUyxuLFwibW91c2Vkb3duXCIsTyksbyhTLG4sXCJtb3VzZXVwXCIsTCl9ZnVuY3Rpb24gYyhlKXt2YXIgbj1lP1wicmVtb3ZlXCI6XCJhZGRcIjtvKFMsbixcIm1vdXNlbW92ZVwiLE4pfWZ1bmN0aW9uIG0oZSl7dmFyIG49ZT9cInJlbW92ZVwiOlwiYWRkXCI7d1tuXShTLFwic2VsZWN0c3RhcnRcIixDKSx3W25dKFMsXCJjbGlja1wiLEMpfWZ1bmN0aW9uIGgoKXtyKCEwKSxMKHt9KX1mdW5jdGlvbiBDKGUpe2NlJiZlLnByZXZlbnREZWZhdWx0KCl9ZnVuY3Rpb24gTyhlKXtuZT1lLmNsaWVudFgsdGU9ZS5jbGllbnRZO3ZhciBuPTEhPT1pKGUpfHxlLm1ldGFLZXl8fGUuY3RybEtleTtpZighbil7dmFyIHQ9ZS50YXJnZXQscj1UKHQpO3ImJihjZT1yLGMoKSxcIm1vdXNlZG93blwiPT09ZS50eXBlJiYocCh0KT90LmZvY3VzKCk6ZS5wcmV2ZW50RGVmYXVsdCgpKSl9fWZ1bmN0aW9uIE4oZSl7aWYoY2Upe2lmKDA9PT1pKGUpKXJldHVybiB2b2lkIEwoe30pO2lmKHZvaWQgMD09PWUuY2xpZW50WHx8ZS5jbGllbnRYIT09bmV8fHZvaWQgMD09PWUuY2xpZW50WXx8ZS5jbGllbnRZIT09dGUpe2lmKGZlLmlnbm9yZUlucHV0VGV4dFNlbGVjdGlvbil7dmFyIG49eShcImNsaWVudFhcIixlKSx0PXkoXCJjbGllbnRZXCIsZSkscj14LmVsZW1lbnRGcm9tUG9pbnQobix0KTtpZihwKHIpKXJldHVybn12YXIgbz1jZTtjKCEwKSxtKCksRCgpLEIobyk7dmFyIGE9dShXKTtaPXkoXCJwYWdlWFwiLGUpLWEubGVmdCxlZT15KFwicGFnZVlcIixlKS1hLnRvcCxFLmFkZChpZXx8VyxcImd1LXRyYW5zaXRcIiksSygpLFUoZSl9fX1mdW5jdGlvbiBUKGUpe2lmKCEobGUuZHJhZ2dpbmcmJkp8fHQoZSkpKXtmb3IodmFyIG49ZTt2KGUpJiZ0KHYoZSkpPT09ITE7KXtpZihmZS5pbnZhbGlkKGUsbikpcmV0dXJuO2lmKGU9dihlKSwhZSlyZXR1cm59dmFyIHI9dihlKTtpZihyJiYhZmUuaW52YWxpZChlLG4pKXt2YXIgbz1mZS5tb3ZlcyhlLHIsbixnKGUpKTtpZihvKXJldHVybntpdGVtOmUsc291cmNlOnJ9fX19ZnVuY3Rpb24gWChlKXtyZXR1cm4hIVQoZSl9ZnVuY3Rpb24gWShlKXt2YXIgbj1UKGUpO24mJkIobil9ZnVuY3Rpb24gQihlKXskKGUuaXRlbSxlLnNvdXJjZSkmJihpZT1lLml0ZW0uY2xvbmVOb2RlKCEwKSxsZS5lbWl0KFwiY2xvbmVkXCIsaWUsZS5pdGVtLFwiY29weVwiKSksUT1lLnNvdXJjZSxXPWUuaXRlbSxyZT1vZT1nKGUuaXRlbSksbGUuZHJhZ2dpbmc9ITAsbGUuZW1pdChcImRyYWdcIixXLFEpfWZ1bmN0aW9uIFAoKXtyZXR1cm4hMX1mdW5jdGlvbiBEKCl7aWYobGUuZHJhZ2dpbmcpe3ZhciBlPWllfHxXO00oZSx2KGUpKX19ZnVuY3Rpb24gSSgpe2NlPSExLGMoITApLG0oITApfWZ1bmN0aW9uIEwoZSl7aWYoSSgpLGxlLmRyYWdnaW5nKXt2YXIgbj1pZXx8Vyx0PXkoXCJjbGllbnRYXCIsZSkscj15KFwiY2xpZW50WVwiLGUpLG89YShKLHQsciksaT1xKG8sdCxyKTtpJiYoaWUmJmZlLmNvcHlTb3J0U291cmNlfHwhaWV8fGkhPT1RKT9NKG4saSk6ZmUucmVtb3ZlT25TcGlsbD9SKCk6QSgpfX1mdW5jdGlvbiBNKGUsbil7dmFyIHQ9dihlKTtpZSYmZmUuY29weVNvcnRTb3VyY2UmJm49PT1RJiZ0LnJlbW92ZUNoaWxkKFcpLGsobik/bGUuZW1pdChcImNhbmNlbFwiLGUsUSxRKTpsZS5lbWl0KFwiZHJvcFwiLGUsbixRLG9lKSxqKCl9ZnVuY3Rpb24gUigpe2lmKGxlLmRyYWdnaW5nKXt2YXIgZT1pZXx8VyxuPXYoZSk7biYmbi5yZW1vdmVDaGlsZChlKSxsZS5lbWl0KGllP1wiY2FuY2VsXCI6XCJyZW1vdmVcIixlLG4sUSksaigpfX1mdW5jdGlvbiBBKGUpe2lmKGxlLmRyYWdnaW5nKXt2YXIgbj1hcmd1bWVudHMubGVuZ3RoPjA/ZTpmZS5yZXZlcnRPblNwaWxsLHQ9aWV8fFcscj12KHQpLG89ayhyKTtvPT09ITEmJm4mJihpZT9yJiZyLnJlbW92ZUNoaWxkKGllKTpRLmluc2VydEJlZm9yZSh0LHJlKSksb3x8bj9sZS5lbWl0KFwiY2FuY2VsXCIsdCxRLFEpOmxlLmVtaXQoXCJkcm9wXCIsdCxyLFEsb2UpLGooKX19ZnVuY3Rpb24gaigpe3ZhciBlPWllfHxXO0koKSx6KCksZSYmRS5ybShlLFwiZ3UtdHJhbnNpdFwiKSx1ZSYmY2xlYXJUaW1lb3V0KHVlKSxsZS5kcmFnZ2luZz0hMSxhZSYmbGUuZW1pdChcIm91dFwiLGUsYWUsUSksbGUuZW1pdChcImRyYWdlbmRcIixlKSxRPVc9aWU9cmU9b2U9dWU9YWU9bnVsbH1mdW5jdGlvbiBrKGUsbil7dmFyIHQ7cmV0dXJuIHQ9dm9pZCAwIT09bj9uOko/b2U6ZyhpZXx8VyksZT09PVEmJnQ9PT1yZX1mdW5jdGlvbiBxKGUsbixyKXtmdW5jdGlvbiBvKCl7dmFyIG89dChpKTtpZihvPT09ITEpcmV0dXJuITE7dmFyIHU9SChpLGUpLGM9VihpLHUsbixyKSxhPWsoaSxjKTtyZXR1cm4gYT8hMDpmZS5hY2NlcHRzKFcsaSxRLGMpfWZvcih2YXIgaT1lO2kmJiFvKCk7KWk9dihpKTtyZXR1cm4gaX1mdW5jdGlvbiBVKGUpe2Z1bmN0aW9uIG4oZSl7bGUuZW1pdChlLGYsYWUsUSl9ZnVuY3Rpb24gdCgpe3MmJm4oXCJvdmVyXCIpfWZ1bmN0aW9uIHIoKXthZSYmbihcIm91dFwiKX1pZihKKXtlLnByZXZlbnREZWZhdWx0KCk7dmFyIG89eShcImNsaWVudFhcIixlKSxpPXkoXCJjbGllbnRZXCIsZSksdT1vLVosYz1pLWVlO0ouc3R5bGUubGVmdD11K1wicHhcIixKLnN0eWxlLnRvcD1jK1wicHhcIjt2YXIgZj1pZXx8VyxsPWEoSixvLGkpLGQ9cShsLG8saSkscz1udWxsIT09ZCYmZCE9PWFlOyhzfHxudWxsPT09ZCkmJihyKCksYWU9ZCx0KCkpO3ZhciBwPXYoZik7aWYoZD09PVEmJmllJiYhZmUuY29weVNvcnRTb3VyY2UpcmV0dXJuIHZvaWQocCYmcC5yZW1vdmVDaGlsZChmKSk7dmFyIG0saD1IKGQsbCk7aWYobnVsbCE9PWgpbT1WKGQsaCxvLGkpO2Vsc2V7aWYoZmUucmV2ZXJ0T25TcGlsbCE9PSEwfHxpZSlyZXR1cm4gdm9pZChpZSYmcCYmcC5yZW1vdmVDaGlsZChmKSk7bT1yZSxkPVF9KG51bGw9PT1tJiZzfHxtIT09ZiYmbSE9PWcoZikpJiYob2U9bSxkLmluc2VydEJlZm9yZShmLG0pLGxlLmVtaXQoXCJzaGFkb3dcIixmLGQsUSkpfX1mdW5jdGlvbiBfKGUpe0Uucm0oZSxcImd1LWhpZGVcIil9ZnVuY3Rpb24gRihlKXtsZS5kcmFnZ2luZyYmRS5hZGQoZSxcImd1LWhpZGVcIil9ZnVuY3Rpb24gSygpe2lmKCFKKXt2YXIgZT1XLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO0o9Vy5jbG9uZU5vZGUoITApLEouc3R5bGUud2lkdGg9ZChlKStcInB4XCIsSi5zdHlsZS5oZWlnaHQ9cyhlKStcInB4XCIsRS5ybShKLFwiZ3UtdHJhbnNpdFwiKSxFLmFkZChKLFwiZ3UtbWlycm9yXCIpLGZlLm1pcnJvckNvbnRhaW5lci5hcHBlbmRDaGlsZChKKSxvKFMsXCJhZGRcIixcIm1vdXNlbW92ZVwiLFUpLEUuYWRkKGZlLm1pcnJvckNvbnRhaW5lcixcImd1LXVuc2VsZWN0YWJsZVwiKSxsZS5lbWl0KFwiY2xvbmVkXCIsSixXLFwibWlycm9yXCIpfX1mdW5jdGlvbiB6KCl7SiYmKEUucm0oZmUubWlycm9yQ29udGFpbmVyLFwiZ3UtdW5zZWxlY3RhYmxlXCIpLG8oUyxcInJlbW92ZVwiLFwibW91c2Vtb3ZlXCIsVSksdihKKS5yZW1vdmVDaGlsZChKKSxKPW51bGwpfWZ1bmN0aW9uIEgoZSxuKXtmb3IodmFyIHQ9bjt0IT09ZSYmdih0KSE9PWU7KXQ9dih0KTtyZXR1cm4gdD09PVM/bnVsbDp0fWZ1bmN0aW9uIFYoZSxuLHQscil7ZnVuY3Rpb24gbygpe3ZhciBuLG8saSx1PWUuY2hpbGRyZW4ubGVuZ3RoO2ZvcihuPTA7dT5uO24rKyl7aWYobz1lLmNoaWxkcmVuW25dLGk9by5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxjJiZpLmxlZnQraS53aWR0aC8yPnQpcmV0dXJuIG87aWYoIWMmJmkudG9wK2kuaGVpZ2h0LzI+cilyZXR1cm4gb31yZXR1cm4gbnVsbH1mdW5jdGlvbiBpKCl7dmFyIGU9bi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtyZXR1cm4gdShjP3Q+ZS5sZWZ0K2QoZSkvMjpyPmUudG9wK3MoZSkvMil9ZnVuY3Rpb24gdShlKXtyZXR1cm4gZT9nKG4pOm59dmFyIGM9XCJob3Jpem9udGFsXCI9PT1mZS5kaXJlY3Rpb24sYT1uIT09ZT9pKCk6bygpO3JldHVybiBhfWZ1bmN0aW9uICQoZSxuKXtyZXR1cm5cImJvb2xlYW5cIj09dHlwZW9mIGZlLmNvcHk/ZmUuY29weTpmZS5jb3B5KGUsbil9dmFyIEc9YXJndW1lbnRzLmxlbmd0aDsxPT09RyYmQXJyYXkuaXNBcnJheShlKT09PSExJiYobj1lLGU9W10pO3ZhciBKLFEsVyxaLGVlLG5lLHRlLHJlLG9lLGllLHVlLGNlLGFlPW51bGwsZmU9bnx8e307dm9pZCAwPT09ZmUubW92ZXMmJihmZS5tb3Zlcz1sKSx2b2lkIDA9PT1mZS5hY2NlcHRzJiYoZmUuYWNjZXB0cz1sKSx2b2lkIDA9PT1mZS5pbnZhbGlkJiYoZmUuaW52YWxpZD1QKSx2b2lkIDA9PT1mZS5jb250YWluZXJzJiYoZmUuY29udGFpbmVycz1lfHxbXSksdm9pZCAwPT09ZmUuaXNDb250YWluZXImJihmZS5pc0NvbnRhaW5lcj1mKSx2b2lkIDA9PT1mZS5jb3B5JiYoZmUuY29weT0hMSksdm9pZCAwPT09ZmUuY29weVNvcnRTb3VyY2UmJihmZS5jb3B5U29ydFNvdXJjZT0hMSksdm9pZCAwPT09ZmUucmV2ZXJ0T25TcGlsbCYmKGZlLnJldmVydE9uU3BpbGw9ITEpLHZvaWQgMD09PWZlLnJlbW92ZU9uU3BpbGwmJihmZS5yZW1vdmVPblNwaWxsPSExKSx2b2lkIDA9PT1mZS5kaXJlY3Rpb24mJihmZS5kaXJlY3Rpb249XCJ2ZXJ0aWNhbFwiKSx2b2lkIDA9PT1mZS5pZ25vcmVJbnB1dFRleHRTZWxlY3Rpb24mJihmZS5pZ25vcmVJbnB1dFRleHRTZWxlY3Rpb249ITApLHZvaWQgMD09PWZlLm1pcnJvckNvbnRhaW5lciYmKGZlLm1pcnJvckNvbnRhaW5lcj14LmJvZHkpO3ZhciBsZT1iKHtjb250YWluZXJzOmZlLmNvbnRhaW5lcnMsc3RhcnQ6WSxlbmQ6RCxjYW5jZWw6QSxyZW1vdmU6UixkZXN0cm95OmgsY2FuTW92ZTpYLGRyYWdnaW5nOiExfSk7cmV0dXJuIGZlLnJlbW92ZU9uU3BpbGw9PT0hMCYmbGUub24oXCJvdmVyXCIsXykub24oXCJvdXRcIixGKSxyKCksbGV9ZnVuY3Rpb24gbyhlLG4scixvKXt2YXIgaT17bW91c2V1cDpcInRvdWNoZW5kXCIsbW91c2Vkb3duOlwidG91Y2hzdGFydFwiLG1vdXNlbW92ZTpcInRvdWNobW92ZVwifSx1PXttb3VzZXVwOlwicG9pbnRlcnVwXCIsbW91c2Vkb3duOlwicG9pbnRlcmRvd25cIixtb3VzZW1vdmU6XCJwb2ludGVybW92ZVwifSxjPXttb3VzZXVwOlwiTVNQb2ludGVyVXBcIixtb3VzZWRvd246XCJNU1BvaW50ZXJEb3duXCIsbW91c2Vtb3ZlOlwiTVNQb2ludGVyTW92ZVwifTt0Lm5hdmlnYXRvci5wb2ludGVyRW5hYmxlZD93W25dKGUsdVtyXSxvKTp0Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkP3dbbl0oZSxjW3JdLG8pOih3W25dKGUsaVtyXSxvKSx3W25dKGUscixvKSl9ZnVuY3Rpb24gaShlKXtpZih2b2lkIDAhPT1lLnRvdWNoZXMpcmV0dXJuIGUudG91Y2hlcy5sZW5ndGg7aWYodm9pZCAwIT09ZS53aGljaCYmMCE9PWUud2hpY2gpcmV0dXJuIGUud2hpY2g7aWYodm9pZCAwIT09ZS5idXR0b25zKXJldHVybiBlLmJ1dHRvbnM7dmFyIG49ZS5idXR0b247cmV0dXJuIHZvaWQgMCE9PW4/MSZuPzE6MiZuPzM6NCZuPzI6MDp2b2lkIDB9ZnVuY3Rpb24gdShlKXt2YXIgbj1lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3JldHVybntsZWZ0Om4ubGVmdCtjKFwic2Nyb2xsTGVmdFwiLFwicGFnZVhPZmZzZXRcIiksdG9wOm4udG9wK2MoXCJzY3JvbGxUb3BcIixcInBhZ2VZT2Zmc2V0XCIpfX1mdW5jdGlvbiBjKGUsbil7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHRbbl0/dFtuXTpTLmNsaWVudEhlaWdodD9TW2VdOnguYm9keVtlXX1mdW5jdGlvbiBhKGUsbix0KXt2YXIgcixvPWV8fHt9LGk9by5jbGFzc05hbWU7cmV0dXJuIG8uY2xhc3NOYW1lKz1cIiBndS1oaWRlXCIscj14LmVsZW1lbnRGcm9tUG9pbnQobix0KSxvLmNsYXNzTmFtZT1pLHJ9ZnVuY3Rpb24gZigpe3JldHVybiExfWZ1bmN0aW9uIGwoKXtyZXR1cm4hMH1mdW5jdGlvbiBkKGUpe3JldHVybiBlLndpZHRofHxlLnJpZ2h0LWUubGVmdH1mdW5jdGlvbiBzKGUpe3JldHVybiBlLmhlaWdodHx8ZS5ib3R0b20tZS50b3B9ZnVuY3Rpb24gdihlKXtyZXR1cm4gZS5wYXJlbnROb2RlPT09eD9udWxsOmUucGFyZW50Tm9kZX1mdW5jdGlvbiBwKGUpe3JldHVyblwiSU5QVVRcIj09PWUudGFnTmFtZXx8XCJURVhUQVJFQVwiPT09ZS50YWdOYW1lfHxcIlNFTEVDVFwiPT09ZS50YWdOYW1lfHxtKGUpfWZ1bmN0aW9uIG0oZSl7cmV0dXJuIGU/XCJmYWxzZVwiPT09ZS5jb250ZW50RWRpdGFibGU/ITE6XCJ0cnVlXCI9PT1lLmNvbnRlbnRFZGl0YWJsZT8hMDptKHYoZSkpOiExfWZ1bmN0aW9uIGcoZSl7ZnVuY3Rpb24gbigpe3ZhciBuPWU7ZG8gbj1uLm5leHRTaWJsaW5nO3doaWxlKG4mJjEhPT1uLm5vZGVUeXBlKTtyZXR1cm4gbn1yZXR1cm4gZS5uZXh0RWxlbWVudFNpYmxpbmd8fG4oKX1mdW5jdGlvbiBoKGUpe3JldHVybiBlLnRhcmdldFRvdWNoZXMmJmUudGFyZ2V0VG91Y2hlcy5sZW5ndGg/ZS50YXJnZXRUb3VjaGVzWzBdOmUuY2hhbmdlZFRvdWNoZXMmJmUuY2hhbmdlZFRvdWNoZXMubGVuZ3RoP2UuY2hhbmdlZFRvdWNoZXNbMF06ZX1mdW5jdGlvbiB5KGUsbil7dmFyIHQ9aChuKSxyPXtwYWdlWDpcImNsaWVudFhcIixwYWdlWTpcImNsaWVudFlcIn07cmV0dXJuIGUgaW4gciYmIShlIGluIHQpJiZyW2VdaW4gdCYmKGU9cltlXSksdFtlXX12YXIgYj1lKFwiY29udHJhL2VtaXR0ZXJcIiksdz1lKFwiY3Jvc3N2ZW50XCIpLEU9ZShcIi4vY2xhc3Nlc1wiKSx4PWRvY3VtZW50LFM9eC5kb2N1bWVudEVsZW1lbnQ7bi5leHBvcnRzPXJ9KS5jYWxsKHRoaXMsXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGdsb2JhbD9nbG9iYWw6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHNlbGY/c2VsZjpcInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93P3dpbmRvdzp7fSl9LHtcIi4vY2xhc3Nlc1wiOjEsXCJjb250cmEvZW1pdHRlclwiOjUsY3Jvc3N2ZW50OjZ9XSwzOltmdW5jdGlvbihlLG4sdCl7bi5leHBvcnRzPWZ1bmN0aW9uKGUsbil7cmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGUsbil9fSx7fV0sNDpbZnVuY3Rpb24oZSxuLHQpe1widXNlIHN0cmljdFwiO3ZhciByPWUoXCJ0aWNreVwiKTtuLmV4cG9ydHM9ZnVuY3Rpb24oZSxuLHQpe2UmJnIoZnVuY3Rpb24oKXtlLmFwcGx5KHR8fG51bGwsbnx8W10pfSl9fSx7dGlja3k6OX1dLDU6W2Z1bmN0aW9uKGUsbix0KXtcInVzZSBzdHJpY3RcIjt2YXIgcj1lKFwiYXRvYVwiKSxvPWUoXCIuL2RlYm91bmNlXCIpO24uZXhwb3J0cz1mdW5jdGlvbihlLG4pe3ZhciB0PW58fHt9LGk9e307cmV0dXJuIHZvaWQgMD09PWUmJihlPXt9KSxlLm9uPWZ1bmN0aW9uKG4sdCl7cmV0dXJuIGlbbl0/aVtuXS5wdXNoKHQpOmlbbl09W3RdLGV9LGUub25jZT1mdW5jdGlvbihuLHQpe3JldHVybiB0Ll9vbmNlPSEwLGUub24obix0KSxlfSxlLm9mZj1mdW5jdGlvbihuLHQpe3ZhciByPWFyZ3VtZW50cy5sZW5ndGg7aWYoMT09PXIpZGVsZXRlIGlbbl07ZWxzZSBpZigwPT09cilpPXt9O2Vsc2V7dmFyIG89aVtuXTtpZighbylyZXR1cm4gZTtvLnNwbGljZShvLmluZGV4T2YodCksMSl9cmV0dXJuIGV9LGUuZW1pdD1mdW5jdGlvbigpe3ZhciBuPXIoYXJndW1lbnRzKTtyZXR1cm4gZS5lbWl0dGVyU25hcHNob3Qobi5zaGlmdCgpKS5hcHBseSh0aGlzLG4pfSxlLmVtaXR0ZXJTbmFwc2hvdD1mdW5jdGlvbihuKXt2YXIgdT0oaVtuXXx8W10pLnNsaWNlKDApO3JldHVybiBmdW5jdGlvbigpe3ZhciBpPXIoYXJndW1lbnRzKSxjPXRoaXN8fGU7aWYoXCJlcnJvclwiPT09biYmdFtcInRocm93c1wiXSE9PSExJiYhdS5sZW5ndGgpdGhyb3cgMT09PWkubGVuZ3RoP2lbMF06aTtyZXR1cm4gdS5mb3JFYWNoKGZ1bmN0aW9uKHIpe3QuYXN5bmM/byhyLGksYyk6ci5hcHBseShjLGkpLHIuX29uY2UmJmUub2ZmKG4scil9KSxlfX0sZX19LHtcIi4vZGVib3VuY2VcIjo0LGF0b2E6M31dLDY6W2Z1bmN0aW9uKGUsbix0KXsoZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcihlLG4sdCxyKXtyZXR1cm4gZS5hZGRFdmVudExpc3RlbmVyKG4sdCxyKX1mdW5jdGlvbiBvKGUsbix0KXtyZXR1cm4gZS5hdHRhY2hFdmVudChcIm9uXCIrbixmKGUsbix0KSl9ZnVuY3Rpb24gaShlLG4sdCxyKXtyZXR1cm4gZS5yZW1vdmVFdmVudExpc3RlbmVyKG4sdCxyKX1mdW5jdGlvbiB1KGUsbix0KXt2YXIgcj1sKGUsbix0KTtyZXR1cm4gcj9lLmRldGFjaEV2ZW50KFwib25cIituLHIpOnZvaWQgMH1mdW5jdGlvbiBjKGUsbix0KXtmdW5jdGlvbiByKCl7dmFyIGU7cmV0dXJuIHAuY3JlYXRlRXZlbnQ/KGU9cC5jcmVhdGVFdmVudChcIkV2ZW50XCIpLGUuaW5pdEV2ZW50KG4sITAsITApKTpwLmNyZWF0ZUV2ZW50T2JqZWN0JiYoZT1wLmNyZWF0ZUV2ZW50T2JqZWN0KCkpLGV9ZnVuY3Rpb24gbygpe3JldHVybiBuZXcgcyhuLHtkZXRhaWw6dH0pfXZhciBpPS0xPT09di5pbmRleE9mKG4pP28oKTpyKCk7ZS5kaXNwYXRjaEV2ZW50P2UuZGlzcGF0Y2hFdmVudChpKTplLmZpcmVFdmVudChcIm9uXCIrbixpKX1mdW5jdGlvbiBhKGUsbixyKXtyZXR1cm4gZnVuY3Rpb24obil7dmFyIG89bnx8dC5ldmVudDtvLnRhcmdldD1vLnRhcmdldHx8by5zcmNFbGVtZW50LG8ucHJldmVudERlZmF1bHQ9by5wcmV2ZW50RGVmYXVsdHx8ZnVuY3Rpb24oKXtvLnJldHVyblZhbHVlPSExfSxvLnN0b3BQcm9wYWdhdGlvbj1vLnN0b3BQcm9wYWdhdGlvbnx8ZnVuY3Rpb24oKXtvLmNhbmNlbEJ1YmJsZT0hMH0sby53aGljaD1vLndoaWNofHxvLmtleUNvZGUsci5jYWxsKGUsbyl9fWZ1bmN0aW9uIGYoZSxuLHQpe3ZhciByPWwoZSxuLHQpfHxhKGUsbix0KTtyZXR1cm4gaC5wdXNoKHt3cmFwcGVyOnIsZWxlbWVudDplLHR5cGU6bixmbjp0fSkscn1mdW5jdGlvbiBsKGUsbix0KXt2YXIgcj1kKGUsbix0KTtpZihyKXt2YXIgbz1oW3JdLndyYXBwZXI7cmV0dXJuIGguc3BsaWNlKHIsMSksb319ZnVuY3Rpb24gZChlLG4sdCl7dmFyIHIsbztmb3Iocj0wO3I8aC5sZW5ndGg7cisrKWlmKG89aFtyXSxvLmVsZW1lbnQ9PT1lJiZvLnR5cGU9PT1uJiZvLmZuPT09dClyZXR1cm4gcn12YXIgcz1lKFwiY3VzdG9tLWV2ZW50XCIpLHY9ZShcIi4vZXZlbnRtYXBcIikscD10LmRvY3VtZW50LG09cixnPWksaD1bXTt0LmFkZEV2ZW50TGlzdGVuZXJ8fChtPW8sZz11KSxuLmV4cG9ydHM9e2FkZDptLHJlbW92ZTpnLGZhYnJpY2F0ZTpjfX0pLmNhbGwodGhpcyxcInVuZGVmaW5lZFwiIT10eXBlb2YgZ2xvYmFsP2dsb2JhbDpcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZj9zZWxmOlwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3c/d2luZG93Ont9KX0se1wiLi9ldmVudG1hcFwiOjcsXCJjdXN0b20tZXZlbnRcIjo4fV0sNzpbZnVuY3Rpb24oZSxuLHQpeyhmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjt2YXIgdD1bXSxyPVwiXCIsbz0vXm9uLztmb3IociBpbiBlKW8udGVzdChyKSYmdC5wdXNoKHIuc2xpY2UoMikpO24uZXhwb3J0cz10fSkuY2FsbCh0aGlzLFwidW5kZWZpbmVkXCIhPXR5cGVvZiBnbG9iYWw/Z2xvYmFsOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBzZWxmP3NlbGY6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6e30pfSx7fV0sODpbZnVuY3Rpb24oZSxuLHQpeyhmdW5jdGlvbihlKXtmdW5jdGlvbiB0KCl7dHJ5e3ZhciBlPW5ldyByKFwiY2F0XCIse2RldGFpbDp7Zm9vOlwiYmFyXCJ9fSk7cmV0dXJuXCJjYXRcIj09PWUudHlwZSYmXCJiYXJcIj09PWUuZGV0YWlsLmZvb31jYXRjaChuKXt9cmV0dXJuITF9dmFyIHI9ZS5DdXN0b21FdmVudDtuLmV4cG9ydHM9dCgpP3I6XCJmdW5jdGlvblwiPT10eXBlb2YgZG9jdW1lbnQuY3JlYXRlRXZlbnQ/ZnVuY3Rpb24oZSxuKXt2YXIgdD1kb2N1bWVudC5jcmVhdGVFdmVudChcIkN1c3RvbUV2ZW50XCIpO3JldHVybiBuP3QuaW5pdEN1c3RvbUV2ZW50KGUsbi5idWJibGVzLG4uY2FuY2VsYWJsZSxuLmRldGFpbCk6dC5pbml0Q3VzdG9tRXZlbnQoZSwhMSwhMSx2b2lkIDApLHR9OmZ1bmN0aW9uKGUsbil7dmFyIHQ9ZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTtyZXR1cm4gdC50eXBlPWUsbj8odC5idWJibGVzPUJvb2xlYW4obi5idWJibGVzKSx0LmNhbmNlbGFibGU9Qm9vbGVhbihuLmNhbmNlbGFibGUpLHQuZGV0YWlsPW4uZGV0YWlsKToodC5idWJibGVzPSExLHQuY2FuY2VsYWJsZT0hMSx0LmRldGFpbD12b2lkIDApLHR9fSkuY2FsbCh0aGlzLFwidW5kZWZpbmVkXCIhPXR5cGVvZiBnbG9iYWw/Z2xvYmFsOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBzZWxmP3NlbGY6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6e30pfSx7fV0sOTpbZnVuY3Rpb24oZSxuLHQpe3ZhciByLG89XCJmdW5jdGlvblwiPT10eXBlb2Ygc2V0SW1tZWRpYXRlO3I9bz9mdW5jdGlvbihlKXtzZXRJbW1lZGlhdGUoZSl9OmZ1bmN0aW9uKGUpe3NldFRpbWVvdXQoZSwwKX0sbi5leHBvcnRzPXJ9LHt9XX0se30sWzJdKSgyKX0pOyIsIiFmdW5jdGlvbih0LGUpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPWUoKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKGUpOnQuRVM2UHJvbWlzZT1lKCl9KHRoaXMsZnVuY3Rpb24oKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KHQpe3ZhciBlPXR5cGVvZiB0O3JldHVybiBudWxsIT09dCYmKFwib2JqZWN0XCI9PT1lfHxcImZ1bmN0aW9uXCI9PT1lKX1mdW5jdGlvbiBlKHQpe3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIHR9ZnVuY3Rpb24gbih0KXtCPXR9ZnVuY3Rpb24gcih0KXtHPXR9ZnVuY3Rpb24gbygpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBwcm9jZXNzLm5leHRUaWNrKGEpfX1mdW5jdGlvbiBpKCl7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHo/ZnVuY3Rpb24oKXt6KGEpfTpjKCl9ZnVuY3Rpb24gcygpe3ZhciB0PTAsZT1uZXcgSihhKSxuPWRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiXCIpO3JldHVybiBlLm9ic2VydmUobix7Y2hhcmFjdGVyRGF0YTohMH0pLGZ1bmN0aW9uKCl7bi5kYXRhPXQ9Kyt0JTJ9fWZ1bmN0aW9uIHUoKXt2YXIgdD1uZXcgTWVzc2FnZUNoYW5uZWw7cmV0dXJuIHQucG9ydDEub25tZXNzYWdlPWEsZnVuY3Rpb24oKXtyZXR1cm4gdC5wb3J0Mi5wb3N0TWVzc2FnZSgwKX19ZnVuY3Rpb24gYygpe3ZhciB0PXNldFRpbWVvdXQ7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHQoYSwxKX19ZnVuY3Rpb24gYSgpe2Zvcih2YXIgdD0wO3Q8Vzt0Kz0yKXt2YXIgZT1WW3RdLG49Vlt0KzFdO2UobiksVlt0XT12b2lkIDAsVlt0KzFdPXZvaWQgMH1XPTB9ZnVuY3Rpb24gZigpe3RyeXt2YXIgdD1GdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCkucmVxdWlyZShcInZlcnR4XCIpO3JldHVybiB6PXQucnVuT25Mb29wfHx0LnJ1bk9uQ29udGV4dCxpKCl9Y2F0Y2goZSl7cmV0dXJuIGMoKX19ZnVuY3Rpb24gbCh0LGUpe3ZhciBuPXRoaXMscj1uZXcgdGhpcy5jb25zdHJ1Y3RvcihwKTt2b2lkIDA9PT1yW1pdJiZPKHIpO3ZhciBvPW4uX3N0YXRlO2lmKG8pe3ZhciBpPWFyZ3VtZW50c1tvLTFdO0coZnVuY3Rpb24oKXtyZXR1cm4gUChvLHIsaSxuLl9yZXN1bHQpfSl9ZWxzZSBFKG4scix0LGUpO3JldHVybiByfWZ1bmN0aW9uIGgodCl7dmFyIGU9dGhpcztpZih0JiZcIm9iamVjdFwiPT10eXBlb2YgdCYmdC5jb25zdHJ1Y3Rvcj09PWUpcmV0dXJuIHQ7dmFyIG49bmV3IGUocCk7cmV0dXJuIGcobix0KSxufWZ1bmN0aW9uIHAoKXt9ZnVuY3Rpb24gdigpe3JldHVybiBuZXcgVHlwZUVycm9yKFwiWW91IGNhbm5vdCByZXNvbHZlIGEgcHJvbWlzZSB3aXRoIGl0c2VsZlwiKX1mdW5jdGlvbiBkKCl7cmV0dXJuIG5ldyBUeXBlRXJyb3IoXCJBIHByb21pc2VzIGNhbGxiYWNrIGNhbm5vdCByZXR1cm4gdGhhdCBzYW1lIHByb21pc2UuXCIpfWZ1bmN0aW9uIF8odCl7dHJ5e3JldHVybiB0LnRoZW59Y2F0Y2goZSl7cmV0dXJuIG50LmVycm9yPWUsbnR9fWZ1bmN0aW9uIHkodCxlLG4scil7dHJ5e3QuY2FsbChlLG4scil9Y2F0Y2gobyl7cmV0dXJuIG99fWZ1bmN0aW9uIG0odCxlLG4pe0coZnVuY3Rpb24odCl7dmFyIHI9ITEsbz15KG4sZSxmdW5jdGlvbihuKXtyfHwocj0hMCxlIT09bj9nKHQsbik6Uyh0LG4pKX0sZnVuY3Rpb24oZSl7cnx8KHI9ITAsaih0LGUpKX0sXCJTZXR0bGU6IFwiKyh0Ll9sYWJlbHx8XCIgdW5rbm93biBwcm9taXNlXCIpKTshciYmbyYmKHI9ITAsaih0LG8pKX0sdCl9ZnVuY3Rpb24gYih0LGUpe2UuX3N0YXRlPT09dHQ/Uyh0LGUuX3Jlc3VsdCk6ZS5fc3RhdGU9PT1ldD9qKHQsZS5fcmVzdWx0KTpFKGUsdm9pZCAwLGZ1bmN0aW9uKGUpe3JldHVybiBnKHQsZSl9LGZ1bmN0aW9uKGUpe3JldHVybiBqKHQsZSl9KX1mdW5jdGlvbiB3KHQsbixyKXtuLmNvbnN0cnVjdG9yPT09dC5jb25zdHJ1Y3RvciYmcj09PWwmJm4uY29uc3RydWN0b3IucmVzb2x2ZT09PWg/Yih0LG4pOnI9PT1udD8oaih0LG50LmVycm9yKSxudC5lcnJvcj1udWxsKTp2b2lkIDA9PT1yP1ModCxuKTplKHIpP20odCxuLHIpOlModCxuKX1mdW5jdGlvbiBnKGUsbil7ZT09PW4/aihlLHYoKSk6dChuKT93KGUsbixfKG4pKTpTKGUsbil9ZnVuY3Rpb24gQSh0KXt0Ll9vbmVycm9yJiZ0Ll9vbmVycm9yKHQuX3Jlc3VsdCksVCh0KX1mdW5jdGlvbiBTKHQsZSl7dC5fc3RhdGU9PT0kJiYodC5fcmVzdWx0PWUsdC5fc3RhdGU9dHQsMCE9PXQuX3N1YnNjcmliZXJzLmxlbmd0aCYmRyhULHQpKX1mdW5jdGlvbiBqKHQsZSl7dC5fc3RhdGU9PT0kJiYodC5fc3RhdGU9ZXQsdC5fcmVzdWx0PWUsRyhBLHQpKX1mdW5jdGlvbiBFKHQsZSxuLHIpe3ZhciBvPXQuX3N1YnNjcmliZXJzLGk9by5sZW5ndGg7dC5fb25lcnJvcj1udWxsLG9baV09ZSxvW2krdHRdPW4sb1tpK2V0XT1yLDA9PT1pJiZ0Ll9zdGF0ZSYmRyhULHQpfWZ1bmN0aW9uIFQodCl7dmFyIGU9dC5fc3Vic2NyaWJlcnMsbj10Ll9zdGF0ZTtpZigwIT09ZS5sZW5ndGgpe2Zvcih2YXIgcj12b2lkIDAsbz12b2lkIDAsaT10Ll9yZXN1bHQscz0wO3M8ZS5sZW5ndGg7cys9MylyPWVbc10sbz1lW3Mrbl0scj9QKG4scixvLGkpOm8oaSk7dC5fc3Vic2NyaWJlcnMubGVuZ3RoPTB9fWZ1bmN0aW9uIE0odCxlKXt0cnl7cmV0dXJuIHQoZSl9Y2F0Y2gobil7cmV0dXJuIG50LmVycm9yPW4sbnR9fWZ1bmN0aW9uIFAodCxuLHIsbyl7dmFyIGk9ZShyKSxzPXZvaWQgMCx1PXZvaWQgMCxjPXZvaWQgMCxhPXZvaWQgMDtpZihpKXtpZihzPU0ocixvKSxzPT09bnQ/KGE9ITAsdT1zLmVycm9yLHMuZXJyb3I9bnVsbCk6Yz0hMCxuPT09cylyZXR1cm4gdm9pZCBqKG4sZCgpKX1lbHNlIHM9byxjPSEwO24uX3N0YXRlIT09JHx8KGkmJmM/ZyhuLHMpOmE/aihuLHUpOnQ9PT10dD9TKG4scyk6dD09PWV0JiZqKG4scykpfWZ1bmN0aW9uIHgodCxlKXt0cnl7ZShmdW5jdGlvbihlKXtnKHQsZSl9LGZ1bmN0aW9uKGUpe2oodCxlKX0pfWNhdGNoKG4pe2oodCxuKX19ZnVuY3Rpb24gQygpe3JldHVybiBydCsrfWZ1bmN0aW9uIE8odCl7dFtaXT1ydCsrLHQuX3N0YXRlPXZvaWQgMCx0Ll9yZXN1bHQ9dm9pZCAwLHQuX3N1YnNjcmliZXJzPVtdfWZ1bmN0aW9uIGsoKXtyZXR1cm4gbmV3IEVycm9yKFwiQXJyYXkgTWV0aG9kcyBtdXN0IGJlIHByb3ZpZGVkIGFuIEFycmF5XCIpfWZ1bmN0aW9uIEYodCl7cmV0dXJuIG5ldyBvdCh0aGlzLHQpLnByb21pc2V9ZnVuY3Rpb24gWSh0KXt2YXIgZT10aGlzO3JldHVybiBuZXcgZShVKHQpP2Z1bmN0aW9uKG4scil7Zm9yKHZhciBvPXQubGVuZ3RoLGk9MDtpPG87aSsrKWUucmVzb2x2ZSh0W2ldKS50aGVuKG4scil9OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUobmV3IFR5cGVFcnJvcihcIllvdSBtdXN0IHBhc3MgYW4gYXJyYXkgdG8gcmFjZS5cIikpfSl9ZnVuY3Rpb24gcSh0KXt2YXIgZT10aGlzLG49bmV3IGUocCk7cmV0dXJuIGoobix0KSxufWZ1bmN0aW9uIEQoKXt0aHJvdyBuZXcgVHlwZUVycm9yKFwiWW91IG11c3QgcGFzcyBhIHJlc29sdmVyIGZ1bmN0aW9uIGFzIHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvclwiKX1mdW5jdGlvbiBLKCl7dGhyb3cgbmV3IFR5cGVFcnJvcihcIkZhaWxlZCB0byBjb25zdHJ1Y3QgJ1Byb21pc2UnOiBQbGVhc2UgdXNlIHRoZSAnbmV3JyBvcGVyYXRvciwgdGhpcyBvYmplY3QgY29uc3RydWN0b3IgY2Fubm90IGJlIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLlwiKX1mdW5jdGlvbiBMKCl7dmFyIHQ9dm9pZCAwO2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBnbG9iYWwpdD1nbG9iYWw7ZWxzZSBpZihcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZil0PXNlbGY7ZWxzZSB0cnl7dD1GdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCl9Y2F0Y2goZSl7dGhyb3cgbmV3IEVycm9yKFwicG9seWZpbGwgZmFpbGVkIGJlY2F1c2UgZ2xvYmFsIG9iamVjdCBpcyB1bmF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50XCIpfXZhciBuPXQuUHJvbWlzZTtpZihuKXt2YXIgcj1udWxsO3RyeXtyPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChuLnJlc29sdmUoKSl9Y2F0Y2goZSl7fWlmKFwiW29iamVjdCBQcm9taXNlXVwiPT09ciYmIW4uY2FzdClyZXR1cm59dC5Qcm9taXNlPWl0fXZhciBOPXZvaWQgMDtOPUFycmF5LmlzQXJyYXk/QXJyYXkuaXNBcnJheTpmdW5jdGlvbih0KXtyZXR1cm5cIltvYmplY3QgQXJyYXldXCI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9O3ZhciBVPU4sVz0wLHo9dm9pZCAwLEI9dm9pZCAwLEc9ZnVuY3Rpb24odCxlKXtWW1ddPXQsVltXKzFdPWUsVys9MiwyPT09VyYmKEI/QihhKTpYKCkpfSxIPVwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OnZvaWQgMCxJPUh8fHt9LEo9SS5NdXRhdGlvbk9ic2VydmVyfHxJLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIsUT1cInVuZGVmaW5lZFwiPT10eXBlb2Ygc2VsZiYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHByb2Nlc3MmJlwiW29iamVjdCBwcm9jZXNzXVwiPT09e30udG9TdHJpbmcuY2FsbChwcm9jZXNzKSxSPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBVaW50OENsYW1wZWRBcnJheSYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGltcG9ydFNjcmlwdHMmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBNZXNzYWdlQ2hhbm5lbCxWPW5ldyBBcnJheSgxZTMpLFg9dm9pZCAwO1g9UT9vKCk6Sj9zKCk6Uj91KCk6dm9pZCAwPT09SCYmXCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZT9mKCk6YygpO3ZhciBaPU1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyKSwkPXZvaWQgMCx0dD0xLGV0PTIsbnQ9e2Vycm9yOm51bGx9LHJ0PTAsb3Q9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7dGhpcy5faW5zdGFuY2VDb25zdHJ1Y3Rvcj10LHRoaXMucHJvbWlzZT1uZXcgdChwKSx0aGlzLnByb21pc2VbWl18fE8odGhpcy5wcm9taXNlKSxVKGUpPyh0aGlzLmxlbmd0aD1lLmxlbmd0aCx0aGlzLl9yZW1haW5pbmc9ZS5sZW5ndGgsdGhpcy5fcmVzdWx0PW5ldyBBcnJheSh0aGlzLmxlbmd0aCksMD09PXRoaXMubGVuZ3RoP1ModGhpcy5wcm9taXNlLHRoaXMuX3Jlc3VsdCk6KHRoaXMubGVuZ3RoPXRoaXMubGVuZ3RofHwwLHRoaXMuX2VudW1lcmF0ZShlKSwwPT09dGhpcy5fcmVtYWluaW5nJiZTKHRoaXMucHJvbWlzZSx0aGlzLl9yZXN1bHQpKSk6aih0aGlzLnByb21pc2UsaygpKX1yZXR1cm4gdC5wcm90b3R5cGUuX2VudW1lcmF0ZT1mdW5jdGlvbih0KXtmb3IodmFyIGU9MDt0aGlzLl9zdGF0ZT09PSQmJmU8dC5sZW5ndGg7ZSsrKXRoaXMuX2VhY2hFbnRyeSh0W2VdLGUpfSx0LnByb3RvdHlwZS5fZWFjaEVudHJ5PWZ1bmN0aW9uKHQsZSl7dmFyIG49dGhpcy5faW5zdGFuY2VDb25zdHJ1Y3RvcixyPW4ucmVzb2x2ZTtpZihyPT09aCl7dmFyIG89Xyh0KTtpZihvPT09bCYmdC5fc3RhdGUhPT0kKXRoaXMuX3NldHRsZWRBdCh0Ll9zdGF0ZSxlLHQuX3Jlc3VsdCk7ZWxzZSBpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBvKXRoaXMuX3JlbWFpbmluZy0tLHRoaXMuX3Jlc3VsdFtlXT10O2Vsc2UgaWYobj09PWl0KXt2YXIgaT1uZXcgbihwKTt3KGksdCxvKSx0aGlzLl93aWxsU2V0dGxlQXQoaSxlKX1lbHNlIHRoaXMuX3dpbGxTZXR0bGVBdChuZXcgbihmdW5jdGlvbihlKXtyZXR1cm4gZSh0KX0pLGUpfWVsc2UgdGhpcy5fd2lsbFNldHRsZUF0KHIodCksZSl9LHQucHJvdG90eXBlLl9zZXR0bGVkQXQ9ZnVuY3Rpb24odCxlLG4pe3ZhciByPXRoaXMucHJvbWlzZTtyLl9zdGF0ZT09PSQmJih0aGlzLl9yZW1haW5pbmctLSx0PT09ZXQ/aihyLG4pOnRoaXMuX3Jlc3VsdFtlXT1uKSwwPT09dGhpcy5fcmVtYWluaW5nJiZTKHIsdGhpcy5fcmVzdWx0KX0sdC5wcm90b3R5cGUuX3dpbGxTZXR0bGVBdD1mdW5jdGlvbih0LGUpe3ZhciBuPXRoaXM7RSh0LHZvaWQgMCxmdW5jdGlvbih0KXtyZXR1cm4gbi5fc2V0dGxlZEF0KHR0LGUsdCl9LGZ1bmN0aW9uKHQpe3JldHVybiBuLl9zZXR0bGVkQXQoZXQsZSx0KX0pfSx0fSgpLGl0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdChlKXt0aGlzW1pdPUMoKSx0aGlzLl9yZXN1bHQ9dGhpcy5fc3RhdGU9dm9pZCAwLHRoaXMuX3N1YnNjcmliZXJzPVtdLHAhPT1lJiYoXCJmdW5jdGlvblwiIT10eXBlb2YgZSYmRCgpLHRoaXMgaW5zdGFuY2VvZiB0P3godGhpcyxlKTpLKCkpfXJldHVybiB0LnByb3RvdHlwZVtcImNhdGNoXCJdPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRoZW4obnVsbCx0KX0sdC5wcm90b3R5cGVbXCJmaW5hbGx5XCJdPWZ1bmN0aW9uKHQpe3ZhciBuPXRoaXMscj1uLmNvbnN0cnVjdG9yO3JldHVybiBlKHQpP24udGhlbihmdW5jdGlvbihlKXtyZXR1cm4gci5yZXNvbHZlKHQoKSkudGhlbihmdW5jdGlvbigpe3JldHVybiBlfSl9LGZ1bmN0aW9uKGUpe3JldHVybiByLnJlc29sdmUodCgpKS50aGVuKGZ1bmN0aW9uKCl7dGhyb3cgZX0pfSk6bi50aGVuKHQsdCl9LHR9KCk7cmV0dXJuIGl0LnByb3RvdHlwZS50aGVuPWwsaXQuYWxsPUYsaXQucmFjZT1ZLGl0LnJlc29sdmU9aCxpdC5yZWplY3Q9cSxpdC5fc2V0U2NoZWR1bGVyPW4saXQuX3NldEFzYXA9cixpdC5fYXNhcD1HLGl0LnBvbHlmaWxsPUwsaXQuUHJvbWlzZT1pdCxpdC5wb2x5ZmlsbCgpLGl0fSk7XG4iLCIhZnVuY3Rpb24odCxlKXtcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cyYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1lKCk6XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShlKTp0LkVTNlByb21pc2U9ZSgpfSh0aGlzLGZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdCh0KXt2YXIgZT10eXBlb2YgdDtyZXR1cm4gbnVsbCE9PXQmJihcIm9iamVjdFwiPT09ZXx8XCJmdW5jdGlvblwiPT09ZSl9ZnVuY3Rpb24gZSh0KXtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiB0fWZ1bmN0aW9uIG4odCl7Qj10fWZ1bmN0aW9uIHIodCl7Rz10fWZ1bmN0aW9uIG8oKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhhKX19ZnVuY3Rpb24gaSgpe3JldHVyblwidW5kZWZpbmVkXCIhPXR5cGVvZiB6P2Z1bmN0aW9uKCl7eihhKX06YygpfWZ1bmN0aW9uIHMoKXt2YXIgdD0wLGU9bmV3IEooYSksbj1kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIlwiKTtyZXR1cm4gZS5vYnNlcnZlKG4se2NoYXJhY3RlckRhdGE6ITB9KSxmdW5jdGlvbigpe24uZGF0YT10PSsrdCUyfX1mdW5jdGlvbiB1KCl7dmFyIHQ9bmV3IE1lc3NhZ2VDaGFubmVsO3JldHVybiB0LnBvcnQxLm9ubWVzc2FnZT1hLGZ1bmN0aW9uKCl7cmV0dXJuIHQucG9ydDIucG9zdE1lc3NhZ2UoMCl9fWZ1bmN0aW9uIGMoKXt2YXIgdD1zZXRUaW1lb3V0O3JldHVybiBmdW5jdGlvbigpe3JldHVybiB0KGEsMSl9fWZ1bmN0aW9uIGEoKXtmb3IodmFyIHQ9MDt0PFc7dCs9Mil7dmFyIGU9Vlt0XSxuPVZbdCsxXTtlKG4pLFZbdF09dm9pZCAwLFZbdCsxXT12b2lkIDB9Vz0wfWZ1bmN0aW9uIGYoKXt0cnl7dmFyIHQ9RnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpLnJlcXVpcmUoXCJ2ZXJ0eFwiKTtyZXR1cm4gej10LnJ1bk9uTG9vcHx8dC5ydW5PbkNvbnRleHQsaSgpfWNhdGNoKGUpe3JldHVybiBjKCl9fWZ1bmN0aW9uIGwodCxlKXt2YXIgbj10aGlzLHI9bmV3IHRoaXMuY29uc3RydWN0b3IocCk7dm9pZCAwPT09cltaXSYmTyhyKTt2YXIgbz1uLl9zdGF0ZTtpZihvKXt2YXIgaT1hcmd1bWVudHNbby0xXTtHKGZ1bmN0aW9uKCl7cmV0dXJuIFAobyxyLGksbi5fcmVzdWx0KX0pfWVsc2UgRShuLHIsdCxlKTtyZXR1cm4gcn1mdW5jdGlvbiBoKHQpe3ZhciBlPXRoaXM7aWYodCYmXCJvYmplY3RcIj09dHlwZW9mIHQmJnQuY29uc3RydWN0b3I9PT1lKXJldHVybiB0O3ZhciBuPW5ldyBlKHApO3JldHVybiBnKG4sdCksbn1mdW5jdGlvbiBwKCl7fWZ1bmN0aW9uIHYoKXtyZXR1cm4gbmV3IFR5cGVFcnJvcihcIllvdSBjYW5ub3QgcmVzb2x2ZSBhIHByb21pc2Ugd2l0aCBpdHNlbGZcIil9ZnVuY3Rpb24gZCgpe3JldHVybiBuZXcgVHlwZUVycm9yKFwiQSBwcm9taXNlcyBjYWxsYmFjayBjYW5ub3QgcmV0dXJuIHRoYXQgc2FtZSBwcm9taXNlLlwiKX1mdW5jdGlvbiBfKHQpe3RyeXtyZXR1cm4gdC50aGVufWNhdGNoKGUpe3JldHVybiBudC5lcnJvcj1lLG50fX1mdW5jdGlvbiB5KHQsZSxuLHIpe3RyeXt0LmNhbGwoZSxuLHIpfWNhdGNoKG8pe3JldHVybiBvfX1mdW5jdGlvbiBtKHQsZSxuKXtHKGZ1bmN0aW9uKHQpe3ZhciByPSExLG89eShuLGUsZnVuY3Rpb24obil7cnx8KHI9ITAsZSE9PW4/Zyh0LG4pOlModCxuKSl9LGZ1bmN0aW9uKGUpe3J8fChyPSEwLGoodCxlKSl9LFwiU2V0dGxlOiBcIisodC5fbGFiZWx8fFwiIHVua25vd24gcHJvbWlzZVwiKSk7IXImJm8mJihyPSEwLGoodCxvKSl9LHQpfWZ1bmN0aW9uIGIodCxlKXtlLl9zdGF0ZT09PXR0P1ModCxlLl9yZXN1bHQpOmUuX3N0YXRlPT09ZXQ/aih0LGUuX3Jlc3VsdCk6RShlLHZvaWQgMCxmdW5jdGlvbihlKXtyZXR1cm4gZyh0LGUpfSxmdW5jdGlvbihlKXtyZXR1cm4gaih0LGUpfSl9ZnVuY3Rpb24gdyh0LG4scil7bi5jb25zdHJ1Y3Rvcj09PXQuY29uc3RydWN0b3ImJnI9PT1sJiZuLmNvbnN0cnVjdG9yLnJlc29sdmU9PT1oP2IodCxuKTpyPT09bnQ/KGoodCxudC5lcnJvciksbnQuZXJyb3I9bnVsbCk6dm9pZCAwPT09cj9TKHQsbik6ZShyKT9tKHQsbixyKTpTKHQsbil9ZnVuY3Rpb24gZyhlLG4pe2U9PT1uP2ooZSx2KCkpOnQobik/dyhlLG4sXyhuKSk6UyhlLG4pfWZ1bmN0aW9uIEEodCl7dC5fb25lcnJvciYmdC5fb25lcnJvcih0Ll9yZXN1bHQpLFQodCl9ZnVuY3Rpb24gUyh0LGUpe3QuX3N0YXRlPT09JCYmKHQuX3Jlc3VsdD1lLHQuX3N0YXRlPXR0LDAhPT10Ll9zdWJzY3JpYmVycy5sZW5ndGgmJkcoVCx0KSl9ZnVuY3Rpb24gaih0LGUpe3QuX3N0YXRlPT09JCYmKHQuX3N0YXRlPWV0LHQuX3Jlc3VsdD1lLEcoQSx0KSl9ZnVuY3Rpb24gRSh0LGUsbixyKXt2YXIgbz10Ll9zdWJzY3JpYmVycyxpPW8ubGVuZ3RoO3QuX29uZXJyb3I9bnVsbCxvW2ldPWUsb1tpK3R0XT1uLG9baStldF09ciwwPT09aSYmdC5fc3RhdGUmJkcoVCx0KX1mdW5jdGlvbiBUKHQpe3ZhciBlPXQuX3N1YnNjcmliZXJzLG49dC5fc3RhdGU7aWYoMCE9PWUubGVuZ3RoKXtmb3IodmFyIHI9dm9pZCAwLG89dm9pZCAwLGk9dC5fcmVzdWx0LHM9MDtzPGUubGVuZ3RoO3MrPTMpcj1lW3NdLG89ZVtzK25dLHI/UChuLHIsbyxpKTpvKGkpO3QuX3N1YnNjcmliZXJzLmxlbmd0aD0wfX1mdW5jdGlvbiBNKHQsZSl7dHJ5e3JldHVybiB0KGUpfWNhdGNoKG4pe3JldHVybiBudC5lcnJvcj1uLG50fX1mdW5jdGlvbiBQKHQsbixyLG8pe3ZhciBpPWUocikscz12b2lkIDAsdT12b2lkIDAsYz12b2lkIDAsYT12b2lkIDA7aWYoaSl7aWYocz1NKHIsbykscz09PW50PyhhPSEwLHU9cy5lcnJvcixzLmVycm9yPW51bGwpOmM9ITAsbj09PXMpcmV0dXJuIHZvaWQgaihuLGQoKSl9ZWxzZSBzPW8sYz0hMDtuLl9zdGF0ZSE9PSR8fChpJiZjP2cobixzKTphP2oobix1KTp0PT09dHQ/UyhuLHMpOnQ9PT1ldCYmaihuLHMpKX1mdW5jdGlvbiB4KHQsZSl7dHJ5e2UoZnVuY3Rpb24oZSl7Zyh0LGUpfSxmdW5jdGlvbihlKXtqKHQsZSl9KX1jYXRjaChuKXtqKHQsbil9fWZ1bmN0aW9uIEMoKXtyZXR1cm4gcnQrK31mdW5jdGlvbiBPKHQpe3RbWl09cnQrKyx0Ll9zdGF0ZT12b2lkIDAsdC5fcmVzdWx0PXZvaWQgMCx0Ll9zdWJzY3JpYmVycz1bXX1mdW5jdGlvbiBrKCl7cmV0dXJuIG5ldyBFcnJvcihcIkFycmF5IE1ldGhvZHMgbXVzdCBiZSBwcm92aWRlZCBhbiBBcnJheVwiKX1mdW5jdGlvbiBGKHQpe3JldHVybiBuZXcgb3QodGhpcyx0KS5wcm9taXNlfWZ1bmN0aW9uIFkodCl7dmFyIGU9dGhpcztyZXR1cm4gbmV3IGUoVSh0KT9mdW5jdGlvbihuLHIpe2Zvcih2YXIgbz10Lmxlbmd0aCxpPTA7aTxvO2krKyllLnJlc29sdmUodFtpXSkudGhlbihuLHIpfTpmdW5jdGlvbih0LGUpe3JldHVybiBlKG5ldyBUeXBlRXJyb3IoXCJZb3UgbXVzdCBwYXNzIGFuIGFycmF5IHRvIHJhY2UuXCIpKX0pfWZ1bmN0aW9uIHEodCl7dmFyIGU9dGhpcyxuPW5ldyBlKHApO3JldHVybiBqKG4sdCksbn1mdW5jdGlvbiBEKCl7dGhyb3cgbmV3IFR5cGVFcnJvcihcIllvdSBtdXN0IHBhc3MgYSByZXNvbHZlciBmdW5jdGlvbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQgdG8gdGhlIHByb21pc2UgY29uc3RydWN0b3JcIil9ZnVuY3Rpb24gSygpe3Rocm93IG5ldyBUeXBlRXJyb3IoXCJGYWlsZWQgdG8gY29uc3RydWN0ICdQcm9taXNlJzogUGxlYXNlIHVzZSB0aGUgJ25ldycgb3BlcmF0b3IsIHRoaXMgb2JqZWN0IGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBjYWxsZWQgYXMgYSBmdW5jdGlvbi5cIil9ZnVuY3Rpb24gTCgpe3ZhciB0PXZvaWQgMDtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgZ2xvYmFsKXQ9Z2xvYmFsO2Vsc2UgaWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHNlbGYpdD1zZWxmO2Vsc2UgdHJ5e3Q9RnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpfWNhdGNoKGUpe3Rocm93IG5ldyBFcnJvcihcInBvbHlmaWxsIGZhaWxlZCBiZWNhdXNlIGdsb2JhbCBvYmplY3QgaXMgdW5hdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudFwiKX12YXIgbj10LlByb21pc2U7aWYobil7dmFyIHI9bnVsbDt0cnl7cj1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobi5yZXNvbHZlKCkpfWNhdGNoKGUpe31pZihcIltvYmplY3QgUHJvbWlzZV1cIj09PXImJiFuLmNhc3QpcmV0dXJufXQuUHJvbWlzZT1pdH12YXIgTj12b2lkIDA7Tj1BcnJheS5pc0FycmF5P0FycmF5LmlzQXJyYXk6ZnVuY3Rpb24odCl7cmV0dXJuXCJbb2JqZWN0IEFycmF5XVwiPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfTt2YXIgVT1OLFc9MCx6PXZvaWQgMCxCPXZvaWQgMCxHPWZ1bmN0aW9uKHQsZSl7VltXXT10LFZbVysxXT1lLFcrPTIsMj09PVcmJihCP0IoYSk6WCgpKX0sSD1cInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93P3dpbmRvdzp2b2lkIDAsST1IfHx7fSxKPUkuTXV0YXRpb25PYnNlcnZlcnx8SS5XZWJLaXRNdXRhdGlvbk9ic2VydmVyLFE9XCJ1bmRlZmluZWRcIj09dHlwZW9mIHNlbGYmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBwcm9jZXNzJiZcIltvYmplY3QgcHJvY2Vzc11cIj09PXt9LnRvU3RyaW5nLmNhbGwocHJvY2VzcyksUj1cInVuZGVmaW5lZFwiIT10eXBlb2YgVWludDhDbGFtcGVkQXJyYXkmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBpbXBvcnRTY3JpcHRzJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgTWVzc2FnZUNoYW5uZWwsVj1uZXcgQXJyYXkoMWUzKSxYPXZvaWQgMDtYPVE/bygpOko/cygpOlI/dSgpOnZvaWQgMD09PUgmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmU/ZigpOmMoKTt2YXIgWj1NYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiksJD12b2lkIDAsdHQ9MSxldD0yLG50PXtlcnJvcjpudWxsfSxydD0wLG90PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3RoaXMuX2luc3RhbmNlQ29uc3RydWN0b3I9dCx0aGlzLnByb21pc2U9bmV3IHQocCksdGhpcy5wcm9taXNlW1pdfHxPKHRoaXMucHJvbWlzZSksVShlKT8odGhpcy5sZW5ndGg9ZS5sZW5ndGgsdGhpcy5fcmVtYWluaW5nPWUubGVuZ3RoLHRoaXMuX3Jlc3VsdD1uZXcgQXJyYXkodGhpcy5sZW5ndGgpLDA9PT10aGlzLmxlbmd0aD9TKHRoaXMucHJvbWlzZSx0aGlzLl9yZXN1bHQpOih0aGlzLmxlbmd0aD10aGlzLmxlbmd0aHx8MCx0aGlzLl9lbnVtZXJhdGUoZSksMD09PXRoaXMuX3JlbWFpbmluZyYmUyh0aGlzLnByb21pc2UsdGhpcy5fcmVzdWx0KSkpOmoodGhpcy5wcm9taXNlLGsoKSl9cmV0dXJuIHQucHJvdG90eXBlLl9lbnVtZXJhdGU9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTA7dGhpcy5fc3RhdGU9PT0kJiZlPHQubGVuZ3RoO2UrKyl0aGlzLl9lYWNoRW50cnkodFtlXSxlKX0sdC5wcm90b3R5cGUuX2VhY2hFbnRyeT1mdW5jdGlvbih0LGUpe3ZhciBuPXRoaXMuX2luc3RhbmNlQ29uc3RydWN0b3Iscj1uLnJlc29sdmU7aWYocj09PWgpe3ZhciBvPV8odCk7aWYobz09PWwmJnQuX3N0YXRlIT09JCl0aGlzLl9zZXR0bGVkQXQodC5fc3RhdGUsZSx0Ll9yZXN1bHQpO2Vsc2UgaWYoXCJmdW5jdGlvblwiIT10eXBlb2Ygbyl0aGlzLl9yZW1haW5pbmctLSx0aGlzLl9yZXN1bHRbZV09dDtlbHNlIGlmKG49PT1pdCl7dmFyIGk9bmV3IG4ocCk7dyhpLHQsbyksdGhpcy5fd2lsbFNldHRsZUF0KGksZSl9ZWxzZSB0aGlzLl93aWxsU2V0dGxlQXQobmV3IG4oZnVuY3Rpb24oZSl7cmV0dXJuIGUodCl9KSxlKX1lbHNlIHRoaXMuX3dpbGxTZXR0bGVBdChyKHQpLGUpfSx0LnByb3RvdHlwZS5fc2V0dGxlZEF0PWZ1bmN0aW9uKHQsZSxuKXt2YXIgcj10aGlzLnByb21pc2U7ci5fc3RhdGU9PT0kJiYodGhpcy5fcmVtYWluaW5nLS0sdD09PWV0P2oocixuKTp0aGlzLl9yZXN1bHRbZV09biksMD09PXRoaXMuX3JlbWFpbmluZyYmUyhyLHRoaXMuX3Jlc3VsdCl9LHQucHJvdG90eXBlLl93aWxsU2V0dGxlQXQ9ZnVuY3Rpb24odCxlKXt2YXIgbj10aGlzO0UodCx2b2lkIDAsZnVuY3Rpb24odCl7cmV0dXJuIG4uX3NldHRsZWRBdCh0dCxlLHQpfSxmdW5jdGlvbih0KXtyZXR1cm4gbi5fc2V0dGxlZEF0KGV0LGUsdCl9KX0sdH0oKSxpdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQoZSl7dGhpc1taXT1DKCksdGhpcy5fcmVzdWx0PXRoaXMuX3N0YXRlPXZvaWQgMCx0aGlzLl9zdWJzY3JpYmVycz1bXSxwIT09ZSYmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIGUmJkQoKSx0aGlzIGluc3RhbmNlb2YgdD94KHRoaXMsZSk6SygpKX1yZXR1cm4gdC5wcm90b3R5cGVbXCJjYXRjaFwiXT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50aGVuKG51bGwsdCl9LHQucHJvdG90eXBlW1wiZmluYWxseVwiXT1mdW5jdGlvbih0KXt2YXIgbj10aGlzLHI9bi5jb25zdHJ1Y3RvcjtyZXR1cm4gZSh0KT9uLnRoZW4oZnVuY3Rpb24oZSl7cmV0dXJuIHIucmVzb2x2ZSh0KCkpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4gZX0pfSxmdW5jdGlvbihlKXtyZXR1cm4gci5yZXNvbHZlKHQoKSkudGhlbihmdW5jdGlvbigpe3Rocm93IGV9KX0pOm4udGhlbih0LHQpfSx0fSgpO3JldHVybiBpdC5wcm90b3R5cGUudGhlbj1sLGl0LmFsbD1GLGl0LnJhY2U9WSxpdC5yZXNvbHZlPWgsaXQucmVqZWN0PXEsaXQuX3NldFNjaGVkdWxlcj1uLGl0Ll9zZXRBc2FwPXIsaXQuX2FzYXA9RyxpdC5wb2x5ZmlsbD1MLGl0LlByb21pc2U9aXQsaXR9KTtcbiIsIihmdW5jdGlvbihhLGIpe2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoW10sYik7ZWxzZSBpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgZXhwb3J0cyliKCk7ZWxzZXtiKCksYS5GaWxlU2F2ZXI9e2V4cG9ydHM6e319LmV4cG9ydHN9fSkodGhpcyxmdW5jdGlvbigpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGIoYSxiKXtyZXR1cm5cInVuZGVmaW5lZFwiPT10eXBlb2YgYj9iPXthdXRvQm9tOiExfTpcIm9iamVjdFwiIT10eXBlb2YgYiYmKGNvbnNvbGUud2FybihcIkRlcHJpY2F0ZWQ6IEV4cGVjdGVkIHRoaXJkIGFyZ3VtZW50IHRvIGJlIGEgb2JqZWN0XCIpLGI9e2F1dG9Cb206IWJ9KSxiLmF1dG9Cb20mJi9eXFxzKig/OnRleHRcXC9cXFMqfGFwcGxpY2F0aW9uXFwveG1sfFxcUypcXC9cXFMqXFwreG1sKVxccyo7LipjaGFyc2V0XFxzKj1cXHMqdXRmLTgvaS50ZXN0KGEudHlwZSk/bmV3IEJsb2IoW1wiXFx1RkVGRlwiLGFdLHt0eXBlOmEudHlwZX0pOmF9ZnVuY3Rpb24gYyhiLGMsZCl7dmFyIGU9bmV3IFhNTEh0dHBSZXF1ZXN0O2Uub3BlbihcIkdFVFwiLGIpLGUucmVzcG9uc2VUeXBlPVwiYmxvYlwiLGUub25sb2FkPWZ1bmN0aW9uKCl7YShlLnJlc3BvbnNlLGMsZCl9LGUub25lcnJvcj1mdW5jdGlvbigpe2NvbnNvbGUuZXJyb3IoXCJjb3VsZCBub3QgZG93bmxvYWQgZmlsZVwiKX0sZS5zZW5kKCl9ZnVuY3Rpb24gZChhKXt2YXIgYj1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIGIub3BlbihcIkhFQURcIixhLCExKSxiLnNlbmQoKSwyMDA8PWIuc3RhdHVzJiYyOTk+PWIuc3RhdHVzfWZ1bmN0aW9uIGUoYSl7dHJ5e2EuZGlzcGF0Y2hFdmVudChuZXcgTW91c2VFdmVudChcImNsaWNrXCIpKX1jYXRjaChjKXt2YXIgYj1kb2N1bWVudC5jcmVhdGVFdmVudChcIk1vdXNlRXZlbnRzXCIpO2IuaW5pdE1vdXNlRXZlbnQoXCJjbGlja1wiLCEwLCEwLHdpbmRvdywwLDAsMCw4MCwyMCwhMSwhMSwhMSwhMSwwLG51bGwpLGEuZGlzcGF0Y2hFdmVudChiKX19dmFyIGY9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKXx8KDQyLGV2YWwpKFwidGhpc1wiKX1jYXRjaChhKXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2Ygd2luZG93JiZ3aW5kb3cud2luZG93PT09d2luZG93P3dpbmRvdzpcIm9iamVjdFwiPT10eXBlb2Ygc2VsZiYmc2VsZi5zZWxmPT09c2VsZj9zZWxmOlwib2JqZWN0XCI9PXR5cGVvZiBnbG9iYWwmJmdsb2JhbC5nbG9iYWw9PT1nbG9iYWw/Z2xvYmFsOnRoaXN9fSgpLGE9Zi5zYXZlQXN8fFwib2JqZWN0XCIhPXR5cGVvZiB3aW5kb3d8fHdpbmRvdyE9PWY/ZnVuY3Rpb24oKXt9OlwiZG93bmxvYWRcImluIEhUTUxBbmNob3JFbGVtZW50LnByb3RvdHlwZT9mdW5jdGlvbihiLGcsaCl7dmFyIGk9Zi5VUkx8fGYud2Via2l0VVJMLGo9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7Zz1nfHxiLm5hbWV8fFwiZG93bmxvYWRcIixqLmRvd25sb2FkPWcsai5yZWw9XCJub29wZW5lclwiLFwic3RyaW5nXCI9PXR5cGVvZiBiPyhqLmhyZWY9YixqLm9yaWdpbj09PWxvY2F0aW9uLm9yaWdpbj9lKGopOmQoai5ocmVmKT9jKGIsZyxoKTplKGosai50YXJnZXQ9XCJfYmxhbmtcIikpOihqLmhyZWY9aS5jcmVhdGVPYmplY3RVUkwoYiksc2V0VGltZW91dChmdW5jdGlvbigpe2kucmV2b2tlT2JqZWN0VVJMKGouaHJlZil9LDRFNCksc2V0VGltZW91dChmdW5jdGlvbigpe2Uoail9LDApKX06XCJtc1NhdmVPck9wZW5CbG9iXCJpbiBuYXZpZ2F0b3I/ZnVuY3Rpb24oZixnLGgpe2lmKGc9Z3x8Zi5uYW1lfHxcImRvd25sb2FkXCIsXCJzdHJpbmdcIiE9dHlwZW9mIGYpbmF2aWdhdG9yLm1zU2F2ZU9yT3BlbkJsb2IoYihmLGgpLGcpO2Vsc2UgaWYoZChmKSljKGYsZyxoKTtlbHNle3ZhciBpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO2kuaHJlZj1mLGkudGFyZ2V0PVwiX2JsYW5rXCIsc2V0VGltZW91dChmdW5jdGlvbigpe2UoaSl9KX19OmZ1bmN0aW9uKGEsYixkLGUpe2lmKGU9ZXx8b3BlbihcIlwiLFwiX2JsYW5rXCIpLGUmJihlLmRvY3VtZW50LnRpdGxlPWUuZG9jdW1lbnQuYm9keS5pbm5lclRleHQ9XCJkb3dubG9hZGluZy4uLlwiKSxcInN0cmluZ1wiPT10eXBlb2YgYSlyZXR1cm4gYyhhLGIsZCk7dmFyIGc9XCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cIj09PWEudHlwZSxoPS9jb25zdHJ1Y3Rvci9pLnRlc3QoZi5IVE1MRWxlbWVudCl8fGYuc2FmYXJpLGk9L0NyaU9TXFwvW1xcZF0rLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO2lmKChpfHxnJiZoKSYmXCJvYmplY3RcIj09dHlwZW9mIEZpbGVSZWFkZXIpe3ZhciBqPW5ldyBGaWxlUmVhZGVyO2oub25sb2FkZW5kPWZ1bmN0aW9uKCl7dmFyIGE9ai5yZXN1bHQ7YT1pP2E6YS5yZXBsYWNlKC9eZGF0YTpbXjtdKjsvLFwiZGF0YTphdHRhY2htZW50L2ZpbGU7XCIpLGU/ZS5sb2NhdGlvbi5ocmVmPWE6bG9jYXRpb249YSxlPW51bGx9LGoucmVhZEFzRGF0YVVSTChhKX1lbHNle3ZhciBrPWYuVVJMfHxmLndlYmtpdFVSTCxsPWsuY3JlYXRlT2JqZWN0VVJMKGEpO2U/ZS5sb2NhdGlvbj1sOmxvY2F0aW9uLmhyZWY9bCxlPW51bGwsc2V0VGltZW91dChmdW5jdGlvbigpe2sucmV2b2tlT2JqZWN0VVJMKGwpfSw0RTQpfX07Zi5zYXZlQXM9YS5zYXZlQXM9YSxcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlJiYobW9kdWxlLmV4cG9ydHM9YSl9KTtcbiIsIi8qIVxuICogRmxpY2tpdHkgUEFDS0FHRUQgdjIuMS4yXG4gKiBUb3VjaCwgcmVzcG9uc2l2ZSwgZmxpY2thYmxlIGNhcm91c2Vsc1xuICpcbiAqIExpY2Vuc2VkIEdQTHYzIGZvciBvcGVuIHNvdXJjZSB1c2VcbiAqIG9yIEZsaWNraXR5IENvbW1lcmNpYWwgTGljZW5zZSBmb3IgY29tbWVyY2lhbCB1c2VcbiAqXG4gKiBodHRwczovL2ZsaWNraXR5Lm1ldGFmaXp6eS5jb1xuICogQ29weXJpZ2h0IDIwMTUtMjAxOCBNZXRhZml6enlcbiAqL1xuXG4hZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwianF1ZXJ5LWJyaWRnZXQvanF1ZXJ5LWJyaWRnZXRcIixbXCJqcXVlcnlcIl0sZnVuY3Rpb24oaSl7cmV0dXJuIGUodCxpKX0pOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUodCxyZXF1aXJlKFwianF1ZXJ5XCIpKTp0LmpRdWVyeUJyaWRnZXQ9ZSh0LHQualF1ZXJ5KX0od2luZG93LGZ1bmN0aW9uKHQsZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gaShpLG8sYSl7ZnVuY3Rpb24gbCh0LGUsbil7dmFyIHMsbz1cIiQoKS5cIitpKycoXCInK2UrJ1wiKSc7cmV0dXJuIHQuZWFjaChmdW5jdGlvbih0LGwpe3ZhciBoPWEuZGF0YShsLGkpO2lmKCFoKXJldHVybiB2b2lkIHIoaStcIiBub3QgaW5pdGlhbGl6ZWQuIENhbm5vdCBjYWxsIG1ldGhvZHMsIGkuZS4gXCIrbyk7dmFyIGM9aFtlXTtpZighY3x8XCJfXCI9PWUuY2hhckF0KDApKXJldHVybiB2b2lkIHIobytcIiBpcyBub3QgYSB2YWxpZCBtZXRob2RcIik7dmFyIGQ9Yy5hcHBseShoLG4pO3M9dm9pZCAwPT09cz9kOnN9KSx2b2lkIDAhPT1zP3M6dH1mdW5jdGlvbiBoKHQsZSl7dC5lYWNoKGZ1bmN0aW9uKHQsbil7dmFyIHM9YS5kYXRhKG4saSk7cz8ocy5vcHRpb24oZSkscy5faW5pdCgpKToocz1uZXcgbyhuLGUpLGEuZGF0YShuLGkscykpfSl9YT1hfHxlfHx0LmpRdWVyeSxhJiYoby5wcm90b3R5cGUub3B0aW9ufHwoby5wcm90b3R5cGUub3B0aW9uPWZ1bmN0aW9uKHQpe2EuaXNQbGFpbk9iamVjdCh0KSYmKHRoaXMub3B0aW9ucz1hLmV4dGVuZCghMCx0aGlzLm9wdGlvbnMsdCkpfSksYS5mbltpXT1mdW5jdGlvbih0KXtpZihcInN0cmluZ1wiPT10eXBlb2YgdCl7dmFyIGU9cy5jYWxsKGFyZ3VtZW50cywxKTtyZXR1cm4gbCh0aGlzLHQsZSl9cmV0dXJuIGgodGhpcyx0KSx0aGlzfSxuKGEpKX1mdW5jdGlvbiBuKHQpeyF0fHx0JiZ0LmJyaWRnZXR8fCh0LmJyaWRnZXQ9aSl9dmFyIHM9QXJyYXkucHJvdG90eXBlLnNsaWNlLG89dC5jb25zb2xlLHI9XCJ1bmRlZmluZWRcIj09dHlwZW9mIG8/ZnVuY3Rpb24oKXt9OmZ1bmN0aW9uKHQpe28uZXJyb3IodCl9O3JldHVybiBuKGV8fHQualF1ZXJ5KSxpfSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiZXYtZW1pdHRlci9ldi1lbWl0dGVyXCIsZSk6XCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZSgpOnQuRXZFbWl0dGVyPWUoKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dGhpcyxmdW5jdGlvbigpe2Z1bmN0aW9uIHQoKXt9dmFyIGU9dC5wcm90b3R5cGU7cmV0dXJuIGUub249ZnVuY3Rpb24odCxlKXtpZih0JiZlKXt2YXIgaT10aGlzLl9ldmVudHM9dGhpcy5fZXZlbnRzfHx7fSxuPWlbdF09aVt0XXx8W107cmV0dXJuIG4uaW5kZXhPZihlKT09LTEmJm4ucHVzaChlKSx0aGlzfX0sZS5vbmNlPWZ1bmN0aW9uKHQsZSl7aWYodCYmZSl7dGhpcy5vbih0LGUpO3ZhciBpPXRoaXMuX29uY2VFdmVudHM9dGhpcy5fb25jZUV2ZW50c3x8e30sbj1pW3RdPWlbdF18fHt9O3JldHVybiBuW2VdPSEwLHRoaXN9fSxlLm9mZj1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX2V2ZW50cyYmdGhpcy5fZXZlbnRzW3RdO2lmKGkmJmkubGVuZ3RoKXt2YXIgbj1pLmluZGV4T2YoZSk7cmV0dXJuIG4hPS0xJiZpLnNwbGljZShuLDEpLHRoaXN9fSxlLmVtaXRFdmVudD1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX2V2ZW50cyYmdGhpcy5fZXZlbnRzW3RdO2lmKGkmJmkubGVuZ3RoKXtpPWkuc2xpY2UoMCksZT1lfHxbXTtmb3IodmFyIG49dGhpcy5fb25jZUV2ZW50cyYmdGhpcy5fb25jZUV2ZW50c1t0XSxzPTA7czxpLmxlbmd0aDtzKyspe3ZhciBvPWlbc10scj1uJiZuW29dO3ImJih0aGlzLm9mZih0LG8pLGRlbGV0ZSBuW29dKSxvLmFwcGx5KHRoaXMsZSl9cmV0dXJuIHRoaXN9fSxlLmFsbE9mZj1mdW5jdGlvbigpe2RlbGV0ZSB0aGlzLl9ldmVudHMsZGVsZXRlIHRoaXMuX29uY2VFdmVudHN9LHR9KSxmdW5jdGlvbih0LGUpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJnZXQtc2l6ZS9nZXQtc2l6ZVwiLGUpOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUoKTp0LmdldFNpemU9ZSgpfSh3aW5kb3csZnVuY3Rpb24oKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KHQpe3ZhciBlPXBhcnNlRmxvYXQodCksaT10LmluZGV4T2YoXCIlXCIpPT0tMSYmIWlzTmFOKGUpO3JldHVybiBpJiZlfWZ1bmN0aW9uIGUoKXt9ZnVuY3Rpb24gaSgpe2Zvcih2YXIgdD17d2lkdGg6MCxoZWlnaHQ6MCxpbm5lcldpZHRoOjAsaW5uZXJIZWlnaHQ6MCxvdXRlcldpZHRoOjAsb3V0ZXJIZWlnaHQ6MH0sZT0wO2U8aDtlKyspe3ZhciBpPWxbZV07dFtpXT0wfXJldHVybiB0fWZ1bmN0aW9uIG4odCl7dmFyIGU9Z2V0Q29tcHV0ZWRTdHlsZSh0KTtyZXR1cm4gZXx8YShcIlN0eWxlIHJldHVybmVkIFwiK2UrXCIuIEFyZSB5b3UgcnVubmluZyB0aGlzIGNvZGUgaW4gYSBoaWRkZW4gaWZyYW1lIG9uIEZpcmVmb3g/IFNlZSBodHRwczovL2JpdC5seS9nZXRzaXplYnVnMVwiKSxlfWZ1bmN0aW9uIHMoKXtpZighYyl7Yz0hMDt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2Uuc3R5bGUud2lkdGg9XCIyMDBweFwiLGUuc3R5bGUucGFkZGluZz1cIjFweCAycHggM3B4IDRweFwiLGUuc3R5bGUuYm9yZGVyU3R5bGU9XCJzb2xpZFwiLGUuc3R5bGUuYm9yZGVyV2lkdGg9XCIxcHggMnB4IDNweCA0cHhcIixlLnN0eWxlLmJveFNpemluZz1cImJvcmRlci1ib3hcIjt2YXIgaT1kb2N1bWVudC5ib2R5fHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7aS5hcHBlbmRDaGlsZChlKTt2YXIgcz1uKGUpO3I9MjAwPT1NYXRoLnJvdW5kKHQocy53aWR0aCkpLG8uaXNCb3hTaXplT3V0ZXI9cixpLnJlbW92ZUNoaWxkKGUpfX1mdW5jdGlvbiBvKGUpe2lmKHMoKSxcInN0cmluZ1wiPT10eXBlb2YgZSYmKGU9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlKSksZSYmXCJvYmplY3RcIj09dHlwZW9mIGUmJmUubm9kZVR5cGUpe3ZhciBvPW4oZSk7aWYoXCJub25lXCI9PW8uZGlzcGxheSlyZXR1cm4gaSgpO3ZhciBhPXt9O2Eud2lkdGg9ZS5vZmZzZXRXaWR0aCxhLmhlaWdodD1lLm9mZnNldEhlaWdodDtmb3IodmFyIGM9YS5pc0JvcmRlckJveD1cImJvcmRlci1ib3hcIj09by5ib3hTaXppbmcsZD0wO2Q8aDtkKyspe3ZhciB1PWxbZF0sZj1vW3VdLHA9cGFyc2VGbG9hdChmKTthW3VdPWlzTmFOKHApPzA6cH12YXIgZz1hLnBhZGRpbmdMZWZ0K2EucGFkZGluZ1JpZ2h0LHY9YS5wYWRkaW5nVG9wK2EucGFkZGluZ0JvdHRvbSxtPWEubWFyZ2luTGVmdCthLm1hcmdpblJpZ2h0LHk9YS5tYXJnaW5Ub3ArYS5tYXJnaW5Cb3R0b20sYj1hLmJvcmRlckxlZnRXaWR0aCthLmJvcmRlclJpZ2h0V2lkdGgsRT1hLmJvcmRlclRvcFdpZHRoK2EuYm9yZGVyQm90dG9tV2lkdGgsUz1jJiZyLEM9dChvLndpZHRoKTtDIT09ITEmJihhLndpZHRoPUMrKFM/MDpnK2IpKTt2YXIgeD10KG8uaGVpZ2h0KTtyZXR1cm4geCE9PSExJiYoYS5oZWlnaHQ9eCsoUz8wOnYrRSkpLGEuaW5uZXJXaWR0aD1hLndpZHRoLShnK2IpLGEuaW5uZXJIZWlnaHQ9YS5oZWlnaHQtKHYrRSksYS5vdXRlcldpZHRoPWEud2lkdGgrbSxhLm91dGVySGVpZ2h0PWEuaGVpZ2h0K3ksYX19dmFyIHIsYT1cInVuZGVmaW5lZFwiPT10eXBlb2YgY29uc29sZT9lOmZ1bmN0aW9uKHQpe2NvbnNvbGUuZXJyb3IodCl9LGw9W1wicGFkZGluZ0xlZnRcIixcInBhZGRpbmdSaWdodFwiLFwicGFkZGluZ1RvcFwiLFwicGFkZGluZ0JvdHRvbVwiLFwibWFyZ2luTGVmdFwiLFwibWFyZ2luUmlnaHRcIixcIm1hcmdpblRvcFwiLFwibWFyZ2luQm90dG9tXCIsXCJib3JkZXJMZWZ0V2lkdGhcIixcImJvcmRlclJpZ2h0V2lkdGhcIixcImJvcmRlclRvcFdpZHRoXCIsXCJib3JkZXJCb3R0b21XaWR0aFwiXSxoPWwubGVuZ3RoLGM9ITE7cmV0dXJuIG99KSxmdW5jdGlvbih0LGUpe1widXNlIHN0cmljdFwiO1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJkZXNhbmRyby1tYXRjaGVzLXNlbGVjdG9yL21hdGNoZXMtc2VsZWN0b3JcIixlKTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lKCk6dC5tYXRjaGVzU2VsZWN0b3I9ZSgpfSh3aW5kb3csZnVuY3Rpb24oKXtcInVzZSBzdHJpY3RcIjt2YXIgdD1mdW5jdGlvbigpe3ZhciB0PXdpbmRvdy5FbGVtZW50LnByb3RvdHlwZTtpZih0Lm1hdGNoZXMpcmV0dXJuXCJtYXRjaGVzXCI7aWYodC5tYXRjaGVzU2VsZWN0b3IpcmV0dXJuXCJtYXRjaGVzU2VsZWN0b3JcIjtmb3IodmFyIGU9W1wid2Via2l0XCIsXCJtb3pcIixcIm1zXCIsXCJvXCJdLGk9MDtpPGUubGVuZ3RoO2krKyl7dmFyIG49ZVtpXSxzPW4rXCJNYXRjaGVzU2VsZWN0b3JcIjtpZih0W3NdKXJldHVybiBzfX0oKTtyZXR1cm4gZnVuY3Rpb24oZSxpKXtyZXR1cm4gZVt0XShpKX19KSxmdW5jdGlvbih0LGUpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJmaXp6eS11aS11dGlscy91dGlsc1wiLFtcImRlc2FuZHJvLW1hdGNoZXMtc2VsZWN0b3IvbWF0Y2hlcy1zZWxlY3RvclwiXSxmdW5jdGlvbihpKXtyZXR1cm4gZSh0LGkpfSk6XCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZSh0LHJlcXVpcmUoXCJkZXNhbmRyby1tYXRjaGVzLXNlbGVjdG9yXCIpKTp0LmZpenp5VUlVdGlscz1lKHQsdC5tYXRjaGVzU2VsZWN0b3IpfSh3aW5kb3csZnVuY3Rpb24odCxlKXt2YXIgaT17fTtpLmV4dGVuZD1mdW5jdGlvbih0LGUpe2Zvcih2YXIgaSBpbiBlKXRbaV09ZVtpXTtyZXR1cm4gdH0saS5tb2R1bG89ZnVuY3Rpb24odCxlKXtyZXR1cm4odCVlK2UpJWV9O3ZhciBuPUFycmF5LnByb3RvdHlwZS5zbGljZTtpLm1ha2VBcnJheT1mdW5jdGlvbih0KXtpZihBcnJheS5pc0FycmF5KHQpKXJldHVybiB0O2lmKG51bGw9PT10fHx2b2lkIDA9PT10KXJldHVybltdO3ZhciBlPVwib2JqZWN0XCI9PXR5cGVvZiB0JiZcIm51bWJlclwiPT10eXBlb2YgdC5sZW5ndGg7cmV0dXJuIGU/bi5jYWxsKHQpOlt0XX0saS5yZW1vdmVGcm9tPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5pbmRleE9mKGUpO2khPS0xJiZ0LnNwbGljZShpLDEpfSxpLmdldFBhcmVudD1mdW5jdGlvbih0LGkpe2Zvcig7dC5wYXJlbnROb2RlJiZ0IT1kb2N1bWVudC5ib2R5OylpZih0PXQucGFyZW50Tm9kZSxlKHQsaSkpcmV0dXJuIHR9LGkuZ2V0UXVlcnlFbGVtZW50PWZ1bmN0aW9uKHQpe3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiB0P2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodCk6dH0saS5oYW5kbGVFdmVudD1mdW5jdGlvbih0KXt2YXIgZT1cIm9uXCIrdC50eXBlO3RoaXNbZV0mJnRoaXNbZV0odCl9LGkuZmlsdGVyRmluZEVsZW1lbnRzPWZ1bmN0aW9uKHQsbil7dD1pLm1ha2VBcnJheSh0KTt2YXIgcz1bXTtyZXR1cm4gdC5mb3JFYWNoKGZ1bmN0aW9uKHQpe2lmKHQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCl7aWYoIW4pcmV0dXJuIHZvaWQgcy5wdXNoKHQpO2UodCxuKSYmcy5wdXNoKHQpO2Zvcih2YXIgaT10LnF1ZXJ5U2VsZWN0b3JBbGwobiksbz0wO288aS5sZW5ndGg7bysrKXMucHVzaChpW29dKX19KSxzfSxpLmRlYm91bmNlTWV0aG9kPWZ1bmN0aW9uKHQsZSxpKXtpPWl8fDEwMDt2YXIgbj10LnByb3RvdHlwZVtlXSxzPWUrXCJUaW1lb3V0XCI7dC5wcm90b3R5cGVbZV09ZnVuY3Rpb24oKXt2YXIgdD10aGlzW3NdO2NsZWFyVGltZW91dCh0KTt2YXIgZT1hcmd1bWVudHMsbz10aGlzO3RoaXNbc109c2V0VGltZW91dChmdW5jdGlvbigpe24uYXBwbHkobyxlKSxkZWxldGUgb1tzXX0saSl9fSxpLmRvY1JlYWR5PWZ1bmN0aW9uKHQpe3ZhciBlPWRvY3VtZW50LnJlYWR5U3RhdGU7XCJjb21wbGV0ZVwiPT1lfHxcImludGVyYWN0aXZlXCI9PWU/c2V0VGltZW91dCh0KTpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLHQpfSxpLnRvRGFzaGVkPWZ1bmN0aW9uKHQpe3JldHVybiB0LnJlcGxhY2UoLyguKShbQS1aXSkvZyxmdW5jdGlvbih0LGUsaSl7cmV0dXJuIGUrXCItXCIraX0pLnRvTG93ZXJDYXNlKCl9O3ZhciBzPXQuY29uc29sZTtyZXR1cm4gaS5odG1sSW5pdD1mdW5jdGlvbihlLG4pe2kuZG9jUmVhZHkoZnVuY3Rpb24oKXt2YXIgbz1pLnRvRGFzaGVkKG4pLHI9XCJkYXRhLVwiK28sYT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW1wiK3IrXCJdXCIpLGw9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5qcy1cIitvKSxoPWkubWFrZUFycmF5KGEpLmNvbmNhdChpLm1ha2VBcnJheShsKSksYz1yK1wiLW9wdGlvbnNcIixkPXQualF1ZXJ5O2guZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgaSxvPXQuZ2V0QXR0cmlidXRlKHIpfHx0LmdldEF0dHJpYnV0ZShjKTt0cnl7aT1vJiZKU09OLnBhcnNlKG8pfWNhdGNoKGEpe3JldHVybiB2b2lkKHMmJnMuZXJyb3IoXCJFcnJvciBwYXJzaW5nIFwiK3IrXCIgb24gXCIrdC5jbGFzc05hbWUrXCI6IFwiK2EpKX12YXIgbD1uZXcgZSh0LGkpO2QmJmQuZGF0YSh0LG4sbCl9KX0pfSxpfSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiZmxpY2tpdHkvanMvY2VsbFwiLFtcImdldC1zaXplL2dldC1zaXplXCJdLGZ1bmN0aW9uKGkpe3JldHVybiBlKHQsaSl9KTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lKHQscmVxdWlyZShcImdldC1zaXplXCIpKToodC5GbGlja2l0eT10LkZsaWNraXR5fHx7fSx0LkZsaWNraXR5LkNlbGw9ZSh0LHQuZ2V0U2l6ZSkpfSh3aW5kb3csZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKHQsZSl7dGhpcy5lbGVtZW50PXQsdGhpcy5wYXJlbnQ9ZSx0aGlzLmNyZWF0ZSgpfXZhciBuPWkucHJvdG90eXBlO3JldHVybiBuLmNyZWF0ZT1mdW5jdGlvbigpe3RoaXMuZWxlbWVudC5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcImFyaWEtc2VsZWN0ZWRcIixcImZhbHNlXCIpLHRoaXMueD0wLHRoaXMuc2hpZnQ9MH0sbi5kZXN0cm95PWZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50LnN0eWxlLnBvc2l0aW9uPVwiXCI7dmFyIHQ9dGhpcy5wYXJlbnQub3JpZ2luU2lkZTt0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1zZWxlY3RlZFwiKSx0aGlzLmVsZW1lbnQuc3R5bGVbdF09XCJcIn0sbi5nZXRTaXplPWZ1bmN0aW9uKCl7dGhpcy5zaXplPWUodGhpcy5lbGVtZW50KX0sbi5zZXRQb3NpdGlvbj1mdW5jdGlvbih0KXt0aGlzLng9dCx0aGlzLnVwZGF0ZVRhcmdldCgpLHRoaXMucmVuZGVyUG9zaXRpb24odCl9LG4udXBkYXRlVGFyZ2V0PW4uc2V0RGVmYXVsdFRhcmdldD1mdW5jdGlvbigpe3ZhciB0PVwibGVmdFwiPT10aGlzLnBhcmVudC5vcmlnaW5TaWRlP1wibWFyZ2luTGVmdFwiOlwibWFyZ2luUmlnaHRcIjt0aGlzLnRhcmdldD10aGlzLngrdGhpcy5zaXplW3RdK3RoaXMuc2l6ZS53aWR0aCp0aGlzLnBhcmVudC5jZWxsQWxpZ259LG4ucmVuZGVyUG9zaXRpb249ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5wYXJlbnQub3JpZ2luU2lkZTt0aGlzLmVsZW1lbnQuc3R5bGVbZV09dGhpcy5wYXJlbnQuZ2V0UG9zaXRpb25WYWx1ZSh0KX0sbi53cmFwU2hpZnQ9ZnVuY3Rpb24odCl7dGhpcy5zaGlmdD10LHRoaXMucmVuZGVyUG9zaXRpb24odGhpcy54K3RoaXMucGFyZW50LnNsaWRlYWJsZVdpZHRoKnQpfSxuLnJlbW92ZT1mdW5jdGlvbigpe3RoaXMuZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudCl9LGl9KSxmdW5jdGlvbih0LGUpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJmbGlja2l0eS9qcy9zbGlkZVwiLGUpOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUoKToodC5GbGlja2l0eT10LkZsaWNraXR5fHx7fSx0LkZsaWNraXR5LlNsaWRlPWUoKSl9KHdpbmRvdyxmdW5jdGlvbigpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQodCl7dGhpcy5wYXJlbnQ9dCx0aGlzLmlzT3JpZ2luTGVmdD1cImxlZnRcIj09dC5vcmlnaW5TaWRlLHRoaXMuY2VsbHM9W10sdGhpcy5vdXRlcldpZHRoPTAsdGhpcy5oZWlnaHQ9MH12YXIgZT10LnByb3RvdHlwZTtyZXR1cm4gZS5hZGRDZWxsPWZ1bmN0aW9uKHQpe2lmKHRoaXMuY2VsbHMucHVzaCh0KSx0aGlzLm91dGVyV2lkdGgrPXQuc2l6ZS5vdXRlcldpZHRoLHRoaXMuaGVpZ2h0PU1hdGgubWF4KHQuc2l6ZS5vdXRlckhlaWdodCx0aGlzLmhlaWdodCksMT09dGhpcy5jZWxscy5sZW5ndGgpe3RoaXMueD10Lng7dmFyIGU9dGhpcy5pc09yaWdpbkxlZnQ/XCJtYXJnaW5MZWZ0XCI6XCJtYXJnaW5SaWdodFwiO3RoaXMuZmlyc3RNYXJnaW49dC5zaXplW2VdfX0sZS51cGRhdGVUYXJnZXQ9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmlzT3JpZ2luTGVmdD9cIm1hcmdpblJpZ2h0XCI6XCJtYXJnaW5MZWZ0XCIsZT10aGlzLmdldExhc3RDZWxsKCksaT1lP2Uuc2l6ZVt0XTowLG49dGhpcy5vdXRlcldpZHRoLSh0aGlzLmZpcnN0TWFyZ2luK2kpO3RoaXMudGFyZ2V0PXRoaXMueCt0aGlzLmZpcnN0TWFyZ2luK24qdGhpcy5wYXJlbnQuY2VsbEFsaWdufSxlLmdldExhc3RDZWxsPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2VsbHNbdGhpcy5jZWxscy5sZW5ndGgtMV19LGUuc2VsZWN0PWZ1bmN0aW9uKCl7dGhpcy5jaGFuZ2VTZWxlY3RlZCghMCl9LGUudW5zZWxlY3Q9ZnVuY3Rpb24oKXt0aGlzLmNoYW5nZVNlbGVjdGVkKCExKX0sZS5jaGFuZ2VTZWxlY3RlZD1mdW5jdGlvbih0KXt2YXIgZT10P1wiYWRkXCI6XCJyZW1vdmVcIjt0aGlzLmNlbGxzLmZvckVhY2goZnVuY3Rpb24oaSl7aS5lbGVtZW50LmNsYXNzTGlzdFtlXShcImlzLXNlbGVjdGVkXCIpLGkuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLXNlbGVjdGVkXCIsdC50b1N0cmluZygpKX0pfSxlLmdldENlbGxFbGVtZW50cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNlbGxzLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdC5lbGVtZW50fSl9LHR9KSxmdW5jdGlvbih0LGUpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJmbGlja2l0eS9qcy9hbmltYXRlXCIsW1wiZml6enktdWktdXRpbHMvdXRpbHNcIl0sZnVuY3Rpb24oaSl7cmV0dXJuIGUodCxpKX0pOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUodCxyZXF1aXJlKFwiZml6enktdWktdXRpbHNcIikpOih0LkZsaWNraXR5PXQuRmxpY2tpdHl8fHt9LHQuRmxpY2tpdHkuYW5pbWF0ZVByb3RvdHlwZT1lKHQsdC5maXp6eVVJVXRpbHMpKX0od2luZG93LGZ1bmN0aW9uKHQsZSl7dmFyIGk9e307cmV0dXJuIGkuc3RhcnRBbmltYXRpb249ZnVuY3Rpb24oKXt0aGlzLmlzQW5pbWF0aW5nfHwodGhpcy5pc0FuaW1hdGluZz0hMCx0aGlzLnJlc3RpbmdGcmFtZXM9MCx0aGlzLmFuaW1hdGUoKSl9LGkuYW5pbWF0ZT1mdW5jdGlvbigpe3RoaXMuYXBwbHlEcmFnRm9yY2UoKSx0aGlzLmFwcGx5U2VsZWN0ZWRBdHRyYWN0aW9uKCk7dmFyIHQ9dGhpcy54O2lmKHRoaXMuaW50ZWdyYXRlUGh5c2ljcygpLHRoaXMucG9zaXRpb25TbGlkZXIoKSx0aGlzLnNldHRsZSh0KSx0aGlzLmlzQW5pbWF0aW5nKXt2YXIgZT10aGlzO3JlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe2UuYW5pbWF0ZSgpfSl9fSxpLnBvc2l0aW9uU2xpZGVyPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy54O3RoaXMub3B0aW9ucy53cmFwQXJvdW5kJiZ0aGlzLmNlbGxzLmxlbmd0aD4xJiYodD1lLm1vZHVsbyh0LHRoaXMuc2xpZGVhYmxlV2lkdGgpLHQtPXRoaXMuc2xpZGVhYmxlV2lkdGgsdGhpcy5zaGlmdFdyYXBDZWxscyh0KSksdCs9dGhpcy5jdXJzb3JQb3NpdGlvbix0PXRoaXMub3B0aW9ucy5yaWdodFRvTGVmdD8tdDp0O3ZhciBpPXRoaXMuZ2V0UG9zaXRpb25WYWx1ZSh0KTt0aGlzLnNsaWRlci5zdHlsZS50cmFuc2Zvcm09dGhpcy5pc0FuaW1hdGluZz9cInRyYW5zbGF0ZTNkKFwiK2krXCIsMCwwKVwiOlwidHJhbnNsYXRlWChcIitpK1wiKVwiO3ZhciBuPXRoaXMuc2xpZGVzWzBdO2lmKG4pe3ZhciBzPS10aGlzLngtbi50YXJnZXQsbz1zL3RoaXMuc2xpZGVzV2lkdGg7dGhpcy5kaXNwYXRjaEV2ZW50KFwic2Nyb2xsXCIsbnVsbCxbbyxzXSl9fSxpLnBvc2l0aW9uU2xpZGVyQXRTZWxlY3RlZD1mdW5jdGlvbigpe3RoaXMuY2VsbHMubGVuZ3RoJiYodGhpcy54PS10aGlzLnNlbGVjdGVkU2xpZGUudGFyZ2V0LHRoaXMudmVsb2NpdHk9MCx0aGlzLnBvc2l0aW9uU2xpZGVyKCkpfSxpLmdldFBvc2l0aW9uVmFsdWU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMub3B0aW9ucy5wZXJjZW50UG9zaXRpb24/LjAxKk1hdGgucm91bmQodC90aGlzLnNpemUuaW5uZXJXaWR0aCoxZTQpK1wiJVwiOk1hdGgucm91bmQodCkrXCJweFwifSxpLnNldHRsZT1mdW5jdGlvbih0KXt0aGlzLmlzUG9pbnRlckRvd258fE1hdGgucm91bmQoMTAwKnRoaXMueCkhPU1hdGgucm91bmQoMTAwKnQpfHx0aGlzLnJlc3RpbmdGcmFtZXMrKyx0aGlzLnJlc3RpbmdGcmFtZXM+MiYmKHRoaXMuaXNBbmltYXRpbmc9ITEsZGVsZXRlIHRoaXMuaXNGcmVlU2Nyb2xsaW5nLHRoaXMucG9zaXRpb25TbGlkZXIoKSx0aGlzLmRpc3BhdGNoRXZlbnQoXCJzZXR0bGVcIixudWxsLFt0aGlzLnNlbGVjdGVkSW5kZXhdKSl9LGkuc2hpZnRXcmFwQ2VsbHM9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5jdXJzb3JQb3NpdGlvbit0O3RoaXMuX3NoaWZ0Q2VsbHModGhpcy5iZWZvcmVTaGlmdENlbGxzLGUsLTEpO3ZhciBpPXRoaXMuc2l6ZS5pbm5lcldpZHRoLSh0K3RoaXMuc2xpZGVhYmxlV2lkdGgrdGhpcy5jdXJzb3JQb3NpdGlvbik7dGhpcy5fc2hpZnRDZWxscyh0aGlzLmFmdGVyU2hpZnRDZWxscyxpLDEpfSxpLl9zaGlmdENlbGxzPWZ1bmN0aW9uKHQsZSxpKXtmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHM9dFtuXSxvPWU+MD9pOjA7cy53cmFwU2hpZnQobyksZS09cy5zaXplLm91dGVyV2lkdGh9fSxpLl91bnNoaWZ0Q2VsbHM9ZnVuY3Rpb24odCl7aWYodCYmdC5sZW5ndGgpZm9yKHZhciBlPTA7ZTx0Lmxlbmd0aDtlKyspdFtlXS53cmFwU2hpZnQoMCl9LGkuaW50ZWdyYXRlUGh5c2ljcz1mdW5jdGlvbigpe3RoaXMueCs9dGhpcy52ZWxvY2l0eSx0aGlzLnZlbG9jaXR5Kj10aGlzLmdldEZyaWN0aW9uRmFjdG9yKCl9LGkuYXBwbHlGb3JjZT1mdW5jdGlvbih0KXt0aGlzLnZlbG9jaXR5Kz10fSxpLmdldEZyaWN0aW9uRmFjdG9yPWZ1bmN0aW9uKCl7cmV0dXJuIDEtdGhpcy5vcHRpb25zW3RoaXMuaXNGcmVlU2Nyb2xsaW5nP1wiZnJlZVNjcm9sbEZyaWN0aW9uXCI6XCJmcmljdGlvblwiXX0saS5nZXRSZXN0aW5nUG9zaXRpb249ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy54K3RoaXMudmVsb2NpdHkvKDEtdGhpcy5nZXRGcmljdGlvbkZhY3RvcigpKX0saS5hcHBseURyYWdGb3JjZT1mdW5jdGlvbigpe2lmKHRoaXMuaXNEcmFnZ2FibGUmJnRoaXMuaXNQb2ludGVyRG93bil7dmFyIHQ9dGhpcy5kcmFnWC10aGlzLngsZT10LXRoaXMudmVsb2NpdHk7dGhpcy5hcHBseUZvcmNlKGUpfX0saS5hcHBseVNlbGVjdGVkQXR0cmFjdGlvbj1mdW5jdGlvbigpe3ZhciB0PXRoaXMuaXNEcmFnZ2FibGUmJnRoaXMuaXNQb2ludGVyRG93bjtpZighdCYmIXRoaXMuaXNGcmVlU2Nyb2xsaW5nJiZ0aGlzLnNsaWRlcy5sZW5ndGgpe3ZhciBlPXRoaXMuc2VsZWN0ZWRTbGlkZS50YXJnZXQqLTEtdGhpcy54LGk9ZSp0aGlzLm9wdGlvbnMuc2VsZWN0ZWRBdHRyYWN0aW9uO3RoaXMuYXBwbHlGb3JjZShpKX19LGl9KSxmdW5jdGlvbih0LGUpe2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoXCJmbGlja2l0eS9qcy9mbGlja2l0eVwiLFtcImV2LWVtaXR0ZXIvZXYtZW1pdHRlclwiLFwiZ2V0LXNpemUvZ2V0LXNpemVcIixcImZpenp5LXVpLXV0aWxzL3V0aWxzXCIsXCIuL2NlbGxcIixcIi4vc2xpZGVcIixcIi4vYW5pbWF0ZVwiXSxmdW5jdGlvbihpLG4scyxvLHIsYSl7cmV0dXJuIGUodCxpLG4scyxvLHIsYSl9KTtlbHNlIGlmKFwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzKW1vZHVsZS5leHBvcnRzPWUodCxyZXF1aXJlKFwiZXYtZW1pdHRlclwiKSxyZXF1aXJlKFwiZ2V0LXNpemVcIikscmVxdWlyZShcImZpenp5LXVpLXV0aWxzXCIpLHJlcXVpcmUoXCIuL2NlbGxcIikscmVxdWlyZShcIi4vc2xpZGVcIikscmVxdWlyZShcIi4vYW5pbWF0ZVwiKSk7ZWxzZXt2YXIgaT10LkZsaWNraXR5O3QuRmxpY2tpdHk9ZSh0LHQuRXZFbWl0dGVyLHQuZ2V0U2l6ZSx0LmZpenp5VUlVdGlscyxpLkNlbGwsaS5TbGlkZSxpLmFuaW1hdGVQcm90b3R5cGUpfX0od2luZG93LGZ1bmN0aW9uKHQsZSxpLG4scyxvLHIpe2Z1bmN0aW9uIGEodCxlKXtmb3IodD1uLm1ha2VBcnJheSh0KTt0Lmxlbmd0aDspZS5hcHBlbmRDaGlsZCh0LnNoaWZ0KCkpfWZ1bmN0aW9uIGwodCxlKXt2YXIgaT1uLmdldFF1ZXJ5RWxlbWVudCh0KTtpZighaSlyZXR1cm4gdm9pZChkJiZkLmVycm9yKFwiQmFkIGVsZW1lbnQgZm9yIEZsaWNraXR5OiBcIisoaXx8dCkpKTtpZih0aGlzLmVsZW1lbnQ9aSx0aGlzLmVsZW1lbnQuZmxpY2tpdHlHVUlEKXt2YXIgcz1mW3RoaXMuZWxlbWVudC5mbGlja2l0eUdVSURdO3JldHVybiBzLm9wdGlvbihlKSxzfWgmJih0aGlzLiRlbGVtZW50PWgodGhpcy5lbGVtZW50KSksdGhpcy5vcHRpb25zPW4uZXh0ZW5kKHt9LHRoaXMuY29uc3RydWN0b3IuZGVmYXVsdHMpLHRoaXMub3B0aW9uKGUpLHRoaXMuX2NyZWF0ZSgpfXZhciBoPXQualF1ZXJ5LGM9dC5nZXRDb21wdXRlZFN0eWxlLGQ9dC5jb25zb2xlLHU9MCxmPXt9O2wuZGVmYXVsdHM9e2FjY2Vzc2liaWxpdHk6ITAsY2VsbEFsaWduOlwiY2VudGVyXCIsZnJlZVNjcm9sbEZyaWN0aW9uOi4wNzUsZnJpY3Rpb246LjI4LG5hbWVzcGFjZUpRdWVyeUV2ZW50czohMCxwZXJjZW50UG9zaXRpb246ITAscmVzaXplOiEwLHNlbGVjdGVkQXR0cmFjdGlvbjouMDI1LHNldEdhbGxlcnlTaXplOiEwfSxsLmNyZWF0ZU1ldGhvZHM9W107dmFyIHA9bC5wcm90b3R5cGU7bi5leHRlbmQocCxlLnByb3RvdHlwZSkscC5fY3JlYXRlPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5ndWlkPSsrdTt0aGlzLmVsZW1lbnQuZmxpY2tpdHlHVUlEPWUsZltlXT10aGlzLHRoaXMuc2VsZWN0ZWRJbmRleD0wLHRoaXMucmVzdGluZ0ZyYW1lcz0wLHRoaXMueD0wLHRoaXMudmVsb2NpdHk9MCx0aGlzLm9yaWdpblNpZGU9dGhpcy5vcHRpb25zLnJpZ2h0VG9MZWZ0P1wicmlnaHRcIjpcImxlZnRcIix0aGlzLnZpZXdwb3J0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksdGhpcy52aWV3cG9ydC5jbGFzc05hbWU9XCJmbGlja2l0eS12aWV3cG9ydFwiLHRoaXMuX2NyZWF0ZVNsaWRlcigpLCh0aGlzLm9wdGlvbnMucmVzaXplfHx0aGlzLm9wdGlvbnMud2F0Y2hDU1MpJiZ0LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIix0aGlzKTtmb3IodmFyIGkgaW4gdGhpcy5vcHRpb25zLm9uKXt2YXIgbj10aGlzLm9wdGlvbnMub25baV07dGhpcy5vbihpLG4pfWwuY3JlYXRlTWV0aG9kcy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3RoaXNbdF0oKX0sdGhpcyksdGhpcy5vcHRpb25zLndhdGNoQ1NTP3RoaXMud2F0Y2hDU1MoKTp0aGlzLmFjdGl2YXRlKCl9LHAub3B0aW9uPWZ1bmN0aW9uKHQpe24uZXh0ZW5kKHRoaXMub3B0aW9ucyx0KX0scC5hY3RpdmF0ZT1mdW5jdGlvbigpe2lmKCF0aGlzLmlzQWN0aXZlKXt0aGlzLmlzQWN0aXZlPSEwLHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZmxpY2tpdHktZW5hYmxlZFwiKSx0aGlzLm9wdGlvbnMucmlnaHRUb0xlZnQmJnRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZmxpY2tpdHktcnRsXCIpLHRoaXMuZ2V0U2l6ZSgpO3ZhciB0PXRoaXMuX2ZpbHRlckZpbmRDZWxsRWxlbWVudHModGhpcy5lbGVtZW50LmNoaWxkcmVuKTthKHQsdGhpcy5zbGlkZXIpLHRoaXMudmlld3BvcnQuYXBwZW5kQ2hpbGQodGhpcy5zbGlkZXIpLHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLnZpZXdwb3J0KSx0aGlzLnJlbG9hZENlbGxzKCksdGhpcy5vcHRpb25zLmFjY2Vzc2liaWxpdHkmJih0aGlzLmVsZW1lbnQudGFiSW5kZXg9MCx0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIix0aGlzKSksdGhpcy5lbWl0RXZlbnQoXCJhY3RpdmF0ZVwiKTt2YXIgZSxpPXRoaXMub3B0aW9ucy5pbml0aWFsSW5kZXg7ZT10aGlzLmlzSW5pdEFjdGl2YXRlZD90aGlzLnNlbGVjdGVkSW5kZXg6dm9pZCAwIT09aSYmdGhpcy5jZWxsc1tpXT9pOjAsdGhpcy5zZWxlY3QoZSwhMSwhMCksdGhpcy5pc0luaXRBY3RpdmF0ZWQ9ITAsdGhpcy5kaXNwYXRjaEV2ZW50KFwicmVhZHlcIil9fSxwLl9jcmVhdGVTbGlkZXI9ZnVuY3Rpb24oKXt2YXIgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3QuY2xhc3NOYW1lPVwiZmxpY2tpdHktc2xpZGVyXCIsdC5zdHlsZVt0aGlzLm9yaWdpblNpZGVdPTAsdGhpcy5zbGlkZXI9dH0scC5fZmlsdGVyRmluZENlbGxFbGVtZW50cz1mdW5jdGlvbih0KXtyZXR1cm4gbi5maWx0ZXJGaW5kRWxlbWVudHModCx0aGlzLm9wdGlvbnMuY2VsbFNlbGVjdG9yKX0scC5yZWxvYWRDZWxscz1mdW5jdGlvbigpe3RoaXMuY2VsbHM9dGhpcy5fbWFrZUNlbGxzKHRoaXMuc2xpZGVyLmNoaWxkcmVuKSx0aGlzLnBvc2l0aW9uQ2VsbHMoKSx0aGlzLl9nZXRXcmFwU2hpZnRDZWxscygpLHRoaXMuc2V0R2FsbGVyeVNpemUoKX0scC5fbWFrZUNlbGxzPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2ZpbHRlckZpbmRDZWxsRWxlbWVudHModCksaT1lLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gbmV3IHModCx0aGlzKX0sdGhpcyk7cmV0dXJuIGl9LHAuZ2V0TGFzdENlbGw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jZWxsc1t0aGlzLmNlbGxzLmxlbmd0aC0xXX0scC5nZXRMYXN0U2xpZGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zbGlkZXNbdGhpcy5zbGlkZXMubGVuZ3RoLTFdfSxwLnBvc2l0aW9uQ2VsbHM9ZnVuY3Rpb24oKXt0aGlzLl9zaXplQ2VsbHModGhpcy5jZWxscyksdGhpcy5fcG9zaXRpb25DZWxscygwKX0scC5fcG9zaXRpb25DZWxscz1mdW5jdGlvbih0KXt0PXR8fDAsdGhpcy5tYXhDZWxsSGVpZ2h0PXQ/dGhpcy5tYXhDZWxsSGVpZ2h0fHwwOjA7dmFyIGU9MDtpZih0PjApe3ZhciBpPXRoaXMuY2VsbHNbdC0xXTtlPWkueCtpLnNpemUub3V0ZXJXaWR0aH1mb3IodmFyIG49dGhpcy5jZWxscy5sZW5ndGgscz10O3M8bjtzKyspe3ZhciBvPXRoaXMuY2VsbHNbc107by5zZXRQb3NpdGlvbihlKSxlKz1vLnNpemUub3V0ZXJXaWR0aCx0aGlzLm1heENlbGxIZWlnaHQ9TWF0aC5tYXgoby5zaXplLm91dGVySGVpZ2h0LHRoaXMubWF4Q2VsbEhlaWdodCl9dGhpcy5zbGlkZWFibGVXaWR0aD1lLHRoaXMudXBkYXRlU2xpZGVzKCksdGhpcy5fY29udGFpblNsaWRlcygpLHRoaXMuc2xpZGVzV2lkdGg9bj90aGlzLmdldExhc3RTbGlkZSgpLnRhcmdldC10aGlzLnNsaWRlc1swXS50YXJnZXQ6MH0scC5fc2l6ZUNlbGxzPWZ1bmN0aW9uKHQpe3QuZm9yRWFjaChmdW5jdGlvbih0KXt0LmdldFNpemUoKX0pfSxwLnVwZGF0ZVNsaWRlcz1mdW5jdGlvbigpe2lmKHRoaXMuc2xpZGVzPVtdLHRoaXMuY2VsbHMubGVuZ3RoKXt2YXIgdD1uZXcgbyh0aGlzKTt0aGlzLnNsaWRlcy5wdXNoKHQpO3ZhciBlPVwibGVmdFwiPT10aGlzLm9yaWdpblNpZGUsaT1lP1wibWFyZ2luUmlnaHRcIjpcIm1hcmdpbkxlZnRcIixuPXRoaXMuX2dldENhbkNlbGxGaXQoKTt0aGlzLmNlbGxzLmZvckVhY2goZnVuY3Rpb24oZSxzKXtpZighdC5jZWxscy5sZW5ndGgpcmV0dXJuIHZvaWQgdC5hZGRDZWxsKGUpO3ZhciByPXQub3V0ZXJXaWR0aC10LmZpcnN0TWFyZ2luKyhlLnNpemUub3V0ZXJXaWR0aC1lLnNpemVbaV0pO24uY2FsbCh0aGlzLHMscik/dC5hZGRDZWxsKGUpOih0LnVwZGF0ZVRhcmdldCgpLHQ9bmV3IG8odGhpcyksdGhpcy5zbGlkZXMucHVzaCh0KSx0LmFkZENlbGwoZSkpfSx0aGlzKSx0LnVwZGF0ZVRhcmdldCgpLHRoaXMudXBkYXRlU2VsZWN0ZWRTbGlkZSgpfX0scC5fZ2V0Q2FuQ2VsbEZpdD1mdW5jdGlvbigpe3ZhciB0PXRoaXMub3B0aW9ucy5ncm91cENlbGxzO2lmKCF0KXJldHVybiBmdW5jdGlvbigpe3JldHVybiExfTtpZihcIm51bWJlclwiPT10eXBlb2YgdCl7dmFyIGU9cGFyc2VJbnQodCwxMCk7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiB0JWUhPT0wfX12YXIgaT1cInN0cmluZ1wiPT10eXBlb2YgdCYmdC5tYXRjaCgvXihcXGQrKSUkLyksbj1pP3BhcnNlSW50KGlbMV0sMTApLzEwMDoxO3JldHVybiBmdW5jdGlvbih0LGUpe3JldHVybiBlPD0odGhpcy5zaXplLmlubmVyV2lkdGgrMSkqbn19LHAuX2luaXQ9cC5yZXBvc2l0aW9uPWZ1bmN0aW9uKCl7dGhpcy5wb3NpdGlvbkNlbGxzKCksdGhpcy5wb3NpdGlvblNsaWRlckF0U2VsZWN0ZWQoKX0scC5nZXRTaXplPWZ1bmN0aW9uKCl7dGhpcy5zaXplPWkodGhpcy5lbGVtZW50KSx0aGlzLnNldENlbGxBbGlnbigpLHRoaXMuY3Vyc29yUG9zaXRpb249dGhpcy5zaXplLmlubmVyV2lkdGgqdGhpcy5jZWxsQWxpZ259O3ZhciBnPXtjZW50ZXI6e2xlZnQ6LjUscmlnaHQ6LjV9LGxlZnQ6e2xlZnQ6MCxyaWdodDoxfSxyaWdodDp7cmlnaHQ6MCxsZWZ0OjF9fTtyZXR1cm4gcC5zZXRDZWxsQWxpZ249ZnVuY3Rpb24oKXt2YXIgdD1nW3RoaXMub3B0aW9ucy5jZWxsQWxpZ25dO3RoaXMuY2VsbEFsaWduPXQ/dFt0aGlzLm9yaWdpblNpZGVdOnRoaXMub3B0aW9ucy5jZWxsQWxpZ259LHAuc2V0R2FsbGVyeVNpemU9ZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMuc2V0R2FsbGVyeVNpemUpe3ZhciB0PXRoaXMub3B0aW9ucy5hZGFwdGl2ZUhlaWdodCYmdGhpcy5zZWxlY3RlZFNsaWRlP3RoaXMuc2VsZWN0ZWRTbGlkZS5oZWlnaHQ6dGhpcy5tYXhDZWxsSGVpZ2h0O3RoaXMudmlld3BvcnQuc3R5bGUuaGVpZ2h0PXQrXCJweFwifX0scC5fZ2V0V3JhcFNoaWZ0Q2VsbHM9ZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMud3JhcEFyb3VuZCl7dGhpcy5fdW5zaGlmdENlbGxzKHRoaXMuYmVmb3JlU2hpZnRDZWxscyksdGhpcy5fdW5zaGlmdENlbGxzKHRoaXMuYWZ0ZXJTaGlmdENlbGxzKTt2YXIgdD10aGlzLmN1cnNvclBvc2l0aW9uLGU9dGhpcy5jZWxscy5sZW5ndGgtMTt0aGlzLmJlZm9yZVNoaWZ0Q2VsbHM9dGhpcy5fZ2V0R2FwQ2VsbHModCxlLC0xKSx0PXRoaXMuc2l6ZS5pbm5lcldpZHRoLXRoaXMuY3Vyc29yUG9zaXRpb24sdGhpcy5hZnRlclNoaWZ0Q2VsbHM9dGhpcy5fZ2V0R2FwQ2VsbHModCwwLDEpfX0scC5fZ2V0R2FwQ2VsbHM9ZnVuY3Rpb24odCxlLGkpe2Zvcih2YXIgbj1bXTt0PjA7KXt2YXIgcz10aGlzLmNlbGxzW2VdO2lmKCFzKWJyZWFrO24ucHVzaChzKSxlKz1pLHQtPXMuc2l6ZS5vdXRlcldpZHRofXJldHVybiBufSxwLl9jb250YWluU2xpZGVzPWZ1bmN0aW9uKCl7aWYodGhpcy5vcHRpb25zLmNvbnRhaW4mJiF0aGlzLm9wdGlvbnMud3JhcEFyb3VuZCYmdGhpcy5jZWxscy5sZW5ndGgpe3ZhciB0PXRoaXMub3B0aW9ucy5yaWdodFRvTGVmdCxlPXQ/XCJtYXJnaW5SaWdodFwiOlwibWFyZ2luTGVmdFwiLGk9dD9cIm1hcmdpbkxlZnRcIjpcIm1hcmdpblJpZ2h0XCIsbj10aGlzLnNsaWRlYWJsZVdpZHRoLXRoaXMuZ2V0TGFzdENlbGwoKS5zaXplW2ldLHM9bjx0aGlzLnNpemUuaW5uZXJXaWR0aCxvPXRoaXMuY3Vyc29yUG9zaXRpb24rdGhpcy5jZWxsc1swXS5zaXplW2VdLHI9bi10aGlzLnNpemUuaW5uZXJXaWR0aCooMS10aGlzLmNlbGxBbGlnbik7dGhpcy5zbGlkZXMuZm9yRWFjaChmdW5jdGlvbih0KXtzP3QudGFyZ2V0PW4qdGhpcy5jZWxsQWxpZ246KHQudGFyZ2V0PU1hdGgubWF4KHQudGFyZ2V0LG8pLHQudGFyZ2V0PU1hdGgubWluKHQudGFyZ2V0LHIpKX0sdGhpcyl9fSxwLmRpc3BhdGNoRXZlbnQ9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPWU/W2VdLmNvbmNhdChpKTppO2lmKHRoaXMuZW1pdEV2ZW50KHQsbiksaCYmdGhpcy4kZWxlbWVudCl7dCs9dGhpcy5vcHRpb25zLm5hbWVzcGFjZUpRdWVyeUV2ZW50cz9cIi5mbGlja2l0eVwiOlwiXCI7dmFyIHM9dDtpZihlKXt2YXIgbz1oLkV2ZW50KGUpO28udHlwZT10LHM9b310aGlzLiRlbGVtZW50LnRyaWdnZXIocyxpKX19LHAuc2VsZWN0PWZ1bmN0aW9uKHQsZSxpKXtpZih0aGlzLmlzQWN0aXZlJiYodD1wYXJzZUludCh0LDEwKSx0aGlzLl93cmFwU2VsZWN0KHQpLCh0aGlzLm9wdGlvbnMud3JhcEFyb3VuZHx8ZSkmJih0PW4ubW9kdWxvKHQsdGhpcy5zbGlkZXMubGVuZ3RoKSksdGhpcy5zbGlkZXNbdF0pKXt2YXIgcz10aGlzLnNlbGVjdGVkSW5kZXg7dGhpcy5zZWxlY3RlZEluZGV4PXQsdGhpcy51cGRhdGVTZWxlY3RlZFNsaWRlKCksaT90aGlzLnBvc2l0aW9uU2xpZGVyQXRTZWxlY3RlZCgpOnRoaXMuc3RhcnRBbmltYXRpb24oKSx0aGlzLm9wdGlvbnMuYWRhcHRpdmVIZWlnaHQmJnRoaXMuc2V0R2FsbGVyeVNpemUoKSx0aGlzLmRpc3BhdGNoRXZlbnQoXCJzZWxlY3RcIixudWxsLFt0XSksdCE9cyYmdGhpcy5kaXNwYXRjaEV2ZW50KFwiY2hhbmdlXCIsbnVsbCxbdF0pLHRoaXMuZGlzcGF0Y2hFdmVudChcImNlbGxTZWxlY3RcIil9fSxwLl93cmFwU2VsZWN0PWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuc2xpZGVzLmxlbmd0aCxpPXRoaXMub3B0aW9ucy53cmFwQXJvdW5kJiZlPjE7aWYoIWkpcmV0dXJuIHQ7dmFyIHM9bi5tb2R1bG8odCxlKSxvPU1hdGguYWJzKHMtdGhpcy5zZWxlY3RlZEluZGV4KSxyPU1hdGguYWJzKHMrZS10aGlzLnNlbGVjdGVkSW5kZXgpLGE9TWF0aC5hYnMocy1lLXRoaXMuc2VsZWN0ZWRJbmRleCk7IXRoaXMuaXNEcmFnU2VsZWN0JiZyPG8/dCs9ZTohdGhpcy5pc0RyYWdTZWxlY3QmJmE8byYmKHQtPWUpLHQ8MD90aGlzLngtPXRoaXMuc2xpZGVhYmxlV2lkdGg6dD49ZSYmKHRoaXMueCs9dGhpcy5zbGlkZWFibGVXaWR0aCl9LHAucHJldmlvdXM9ZnVuY3Rpb24odCxlKXt0aGlzLnNlbGVjdCh0aGlzLnNlbGVjdGVkSW5kZXgtMSx0LGUpfSxwLm5leHQ9ZnVuY3Rpb24odCxlKXt0aGlzLnNlbGVjdCh0aGlzLnNlbGVjdGVkSW5kZXgrMSx0LGUpfSxwLnVwZGF0ZVNlbGVjdGVkU2xpZGU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnNsaWRlc1t0aGlzLnNlbGVjdGVkSW5kZXhdO3QmJih0aGlzLnVuc2VsZWN0U2VsZWN0ZWRTbGlkZSgpLHRoaXMuc2VsZWN0ZWRTbGlkZT10LHQuc2VsZWN0KCksdGhpcy5zZWxlY3RlZENlbGxzPXQuY2VsbHMsdGhpcy5zZWxlY3RlZEVsZW1lbnRzPXQuZ2V0Q2VsbEVsZW1lbnRzKCksdGhpcy5zZWxlY3RlZENlbGw9dC5jZWxsc1swXSx0aGlzLnNlbGVjdGVkRWxlbWVudD10aGlzLnNlbGVjdGVkRWxlbWVudHNbMF0pfSxwLnVuc2VsZWN0U2VsZWN0ZWRTbGlkZT1mdW5jdGlvbigpe3RoaXMuc2VsZWN0ZWRTbGlkZSYmdGhpcy5zZWxlY3RlZFNsaWRlLnVuc2VsZWN0KCl9LHAuc2VsZWN0Q2VsbD1mdW5jdGlvbih0LGUsaSl7dmFyIG49dGhpcy5xdWVyeUNlbGwodCk7aWYobil7dmFyIHM9dGhpcy5nZXRDZWxsU2xpZGVJbmRleChuKTt0aGlzLnNlbGVjdChzLGUsaSl9fSxwLmdldENlbGxTbGlkZUluZGV4PWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wO2U8dGhpcy5zbGlkZXMubGVuZ3RoO2UrKyl7dmFyIGk9dGhpcy5zbGlkZXNbZV0sbj1pLmNlbGxzLmluZGV4T2YodCk7aWYobiE9LTEpcmV0dXJuIGV9fSxwLmdldENlbGw9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTA7ZTx0aGlzLmNlbGxzLmxlbmd0aDtlKyspe3ZhciBpPXRoaXMuY2VsbHNbZV07aWYoaS5lbGVtZW50PT10KXJldHVybiBpfX0scC5nZXRDZWxscz1mdW5jdGlvbih0KXt0PW4ubWFrZUFycmF5KHQpO3ZhciBlPVtdO3JldHVybiB0LmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5nZXRDZWxsKHQpO2kmJmUucHVzaChpKX0sdGhpcyksZX0scC5nZXRDZWxsRWxlbWVudHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jZWxscy5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIHQuZWxlbWVudH0pfSxwLmdldFBhcmVudENlbGw9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRDZWxsKHQpO3JldHVybiBlP2U6KHQ9bi5nZXRQYXJlbnQodCxcIi5mbGlja2l0eS1zbGlkZXIgPiAqXCIpLHRoaXMuZ2V0Q2VsbCh0KSl9LHAuZ2V0QWRqYWNlbnRDZWxsRWxlbWVudHM9ZnVuY3Rpb24odCxlKXtpZighdClyZXR1cm4gdGhpcy5zZWxlY3RlZFNsaWRlLmdldENlbGxFbGVtZW50cygpO2U9dm9pZCAwPT09ZT90aGlzLnNlbGVjdGVkSW5kZXg6ZTt2YXIgaT10aGlzLnNsaWRlcy5sZW5ndGg7aWYoMSsyKnQ+PWkpcmV0dXJuIHRoaXMuZ2V0Q2VsbEVsZW1lbnRzKCk7Zm9yKHZhciBzPVtdLG89ZS10O288PWUrdDtvKyspe3ZhciByPXRoaXMub3B0aW9ucy53cmFwQXJvdW5kP24ubW9kdWxvKG8saSk6byxhPXRoaXMuc2xpZGVzW3JdO2EmJihzPXMuY29uY2F0KGEuZ2V0Q2VsbEVsZW1lbnRzKCkpKX1yZXR1cm4gc30scC5xdWVyeUNlbGw9ZnVuY3Rpb24odCl7cmV0dXJuXCJudW1iZXJcIj09dHlwZW9mIHQ/dGhpcy5jZWxsc1t0XTooXCJzdHJpbmdcIj09dHlwZW9mIHQmJih0PXRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKHQpKSx0aGlzLmdldENlbGwodCkpfSxwLnVpQ2hhbmdlPWZ1bmN0aW9uKCl7dGhpcy5lbWl0RXZlbnQoXCJ1aUNoYW5nZVwiKX0scC5jaGlsZFVJUG9pbnRlckRvd249ZnVuY3Rpb24odCl7dGhpcy5lbWl0RXZlbnQoXCJjaGlsZFVJUG9pbnRlckRvd25cIixbdF0pfSxwLm9ucmVzaXplPWZ1bmN0aW9uKCl7dGhpcy53YXRjaENTUygpLHRoaXMucmVzaXplKCl9LG4uZGVib3VuY2VNZXRob2QobCxcIm9ucmVzaXplXCIsMTUwKSxwLnJlc2l6ZT1mdW5jdGlvbigpe2lmKHRoaXMuaXNBY3RpdmUpe3RoaXMuZ2V0U2l6ZSgpLHRoaXMub3B0aW9ucy53cmFwQXJvdW5kJiYodGhpcy54PW4ubW9kdWxvKHRoaXMueCx0aGlzLnNsaWRlYWJsZVdpZHRoKSksdGhpcy5wb3NpdGlvbkNlbGxzKCksdGhpcy5fZ2V0V3JhcFNoaWZ0Q2VsbHMoKSx0aGlzLnNldEdhbGxlcnlTaXplKCksdGhpcy5lbWl0RXZlbnQoXCJyZXNpemVcIik7dmFyIHQ9dGhpcy5zZWxlY3RlZEVsZW1lbnRzJiZ0aGlzLnNlbGVjdGVkRWxlbWVudHNbMF07dGhpcy5zZWxlY3RDZWxsKHQsITEsITApfX0scC53YXRjaENTUz1mdW5jdGlvbigpe3ZhciB0PXRoaXMub3B0aW9ucy53YXRjaENTUztpZih0KXt2YXIgZT1jKHRoaXMuZWxlbWVudCxcIjphZnRlclwiKS5jb250ZW50O2UuaW5kZXhPZihcImZsaWNraXR5XCIpIT0tMT90aGlzLmFjdGl2YXRlKCk6dGhpcy5kZWFjdGl2YXRlKCl9fSxwLm9ua2V5ZG93bj1mdW5jdGlvbih0KXt2YXIgZT1kb2N1bWVudC5hY3RpdmVFbGVtZW50JiZkb2N1bWVudC5hY3RpdmVFbGVtZW50IT10aGlzLmVsZW1lbnQ7aWYodGhpcy5vcHRpb25zLmFjY2Vzc2liaWxpdHkmJiFlKXt2YXIgaT1sLmtleWJvYXJkSGFuZGxlcnNbdC5rZXlDb2RlXTtpJiZpLmNhbGwodGhpcyl9fSxsLmtleWJvYXJkSGFuZGxlcnM9ezM3OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5vcHRpb25zLnJpZ2h0VG9MZWZ0P1wibmV4dFwiOlwicHJldmlvdXNcIjt0aGlzLnVpQ2hhbmdlKCksdGhpc1t0XSgpfSwzOTpmdW5jdGlvbigpe3ZhciB0PXRoaXMub3B0aW9ucy5yaWdodFRvTGVmdD9cInByZXZpb3VzXCI6XCJuZXh0XCI7dGhpcy51aUNoYW5nZSgpLHRoaXNbdF0oKX19LHAuZm9jdXM9ZnVuY3Rpb24oKXt2YXIgZT10LnBhZ2VZT2Zmc2V0O3RoaXMuZWxlbWVudC5mb2N1cyh7cHJldmVudFNjcm9sbDohMH0pLHQucGFnZVlPZmZzZXQhPWUmJnQuc2Nyb2xsVG8odC5wYWdlWE9mZnNldCxlKX0scC5kZWFjdGl2YXRlPWZ1bmN0aW9uKCl7dGhpcy5pc0FjdGl2ZSYmKHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZmxpY2tpdHktZW5hYmxlZFwiKSx0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImZsaWNraXR5LXJ0bFwiKSx0aGlzLnVuc2VsZWN0U2VsZWN0ZWRTbGlkZSgpLHRoaXMuY2VsbHMuZm9yRWFjaChmdW5jdGlvbih0KXt0LmRlc3Ryb3koKX0pLHRoaXMuZWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLnZpZXdwb3J0KSxhKHRoaXMuc2xpZGVyLmNoaWxkcmVuLHRoaXMuZWxlbWVudCksdGhpcy5vcHRpb25zLmFjY2Vzc2liaWxpdHkmJih0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwidGFiSW5kZXhcIiksdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsdGhpcykpLHRoaXMuaXNBY3RpdmU9ITEsdGhpcy5lbWl0RXZlbnQoXCJkZWFjdGl2YXRlXCIpKX0scC5kZXN0cm95PWZ1bmN0aW9uKCl7dGhpcy5kZWFjdGl2YXRlKCksdC5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVzaXplXCIsdGhpcyksdGhpcy5lbWl0RXZlbnQoXCJkZXN0cm95XCIpLGgmJnRoaXMuJGVsZW1lbnQmJmgucmVtb3ZlRGF0YSh0aGlzLmVsZW1lbnQsXCJmbGlja2l0eVwiKSxkZWxldGUgdGhpcy5lbGVtZW50LmZsaWNraXR5R1VJRCxkZWxldGUgZlt0aGlzLmd1aWRdfSxuLmV4dGVuZChwLHIpLGwuZGF0YT1mdW5jdGlvbih0KXt0PW4uZ2V0UXVlcnlFbGVtZW50KHQpO3ZhciBlPXQmJnQuZmxpY2tpdHlHVUlEO3JldHVybiBlJiZmW2VdfSxuLmh0bWxJbml0KGwsXCJmbGlja2l0eVwiKSxoJiZoLmJyaWRnZXQmJmguYnJpZGdldChcImZsaWNraXR5XCIsbCksbC5zZXRKUXVlcnk9ZnVuY3Rpb24odCl7aD10fSxsLkNlbGw9cyxsfSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwidW5pcG9pbnRlci91bmlwb2ludGVyXCIsW1wiZXYtZW1pdHRlci9ldi1lbWl0dGVyXCJdLGZ1bmN0aW9uKGkpe3JldHVybiBlKHQsaSl9KTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lKHQscmVxdWlyZShcImV2LWVtaXR0ZXJcIikpOnQuVW5pcG9pbnRlcj1lKHQsdC5FdkVtaXR0ZXIpfSh3aW5kb3csZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKCl7fWZ1bmN0aW9uIG4oKXt9dmFyIHM9bi5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShlLnByb3RvdHlwZSk7cy5iaW5kU3RhcnRFdmVudD1mdW5jdGlvbih0KXt0aGlzLl9iaW5kU3RhcnRFdmVudCh0LCEwKX0scy51bmJpbmRTdGFydEV2ZW50PWZ1bmN0aW9uKHQpe3RoaXMuX2JpbmRTdGFydEV2ZW50KHQsITEpfSxzLl9iaW5kU3RhcnRFdmVudD1mdW5jdGlvbihlLGkpe2k9dm9pZCAwPT09aXx8aTt2YXIgbj1pP1wiYWRkRXZlbnRMaXN0ZW5lclwiOlwicmVtb3ZlRXZlbnRMaXN0ZW5lclwiLHM9XCJtb3VzZWRvd25cIjt0LlBvaW50ZXJFdmVudD9zPVwicG9pbnRlcmRvd25cIjpcIm9udG91Y2hzdGFydFwiaW4gdCYmKHM9XCJ0b3VjaHN0YXJ0XCIpLGVbbl0ocyx0aGlzKX0scy5oYW5kbGVFdmVudD1mdW5jdGlvbih0KXt2YXIgZT1cIm9uXCIrdC50eXBlO3RoaXNbZV0mJnRoaXNbZV0odCl9LHMuZ2V0VG91Y2g9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTA7ZTx0Lmxlbmd0aDtlKyspe3ZhciBpPXRbZV07aWYoaS5pZGVudGlmaWVyPT10aGlzLnBvaW50ZXJJZGVudGlmaWVyKXJldHVybiBpfX0scy5vbm1vdXNlZG93bj1mdW5jdGlvbih0KXt2YXIgZT10LmJ1dHRvbjtlJiYwIT09ZSYmMSE9PWV8fHRoaXMuX3BvaW50ZXJEb3duKHQsdCl9LHMub250b3VjaHN0YXJ0PWZ1bmN0aW9uKHQpe3RoaXMuX3BvaW50ZXJEb3duKHQsdC5jaGFuZ2VkVG91Y2hlc1swXSl9LHMub25wb2ludGVyZG93bj1mdW5jdGlvbih0KXt0aGlzLl9wb2ludGVyRG93bih0LHQpfSxzLl9wb2ludGVyRG93bj1mdW5jdGlvbih0LGUpe3QuYnV0dG9ufHx0aGlzLmlzUG9pbnRlckRvd258fCh0aGlzLmlzUG9pbnRlckRvd249ITAsdGhpcy5wb2ludGVySWRlbnRpZmllcj12b2lkIDAhPT1lLnBvaW50ZXJJZD9lLnBvaW50ZXJJZDplLmlkZW50aWZpZXIsdGhpcy5wb2ludGVyRG93bih0LGUpKX0scy5wb2ludGVyRG93bj1mdW5jdGlvbih0LGUpe3RoaXMuX2JpbmRQb3N0U3RhcnRFdmVudHModCksdGhpcy5lbWl0RXZlbnQoXCJwb2ludGVyRG93blwiLFt0LGVdKX07dmFyIG89e21vdXNlZG93bjpbXCJtb3VzZW1vdmVcIixcIm1vdXNldXBcIl0sdG91Y2hzdGFydDpbXCJ0b3VjaG1vdmVcIixcInRvdWNoZW5kXCIsXCJ0b3VjaGNhbmNlbFwiXSxwb2ludGVyZG93bjpbXCJwb2ludGVybW92ZVwiLFwicG9pbnRlcnVwXCIsXCJwb2ludGVyY2FuY2VsXCJdfTtyZXR1cm4gcy5fYmluZFBvc3RTdGFydEV2ZW50cz1mdW5jdGlvbihlKXtpZihlKXt2YXIgaT1vW2UudHlwZV07aS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3QuYWRkRXZlbnRMaXN0ZW5lcihlLHRoaXMpfSx0aGlzKSx0aGlzLl9ib3VuZFBvaW50ZXJFdmVudHM9aX19LHMuX3VuYmluZFBvc3RTdGFydEV2ZW50cz1mdW5jdGlvbigpe3RoaXMuX2JvdW5kUG9pbnRlckV2ZW50cyYmKHRoaXMuX2JvdW5kUG9pbnRlckV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGUpe3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLHRoaXMpfSx0aGlzKSxkZWxldGUgdGhpcy5fYm91bmRQb2ludGVyRXZlbnRzKX0scy5vbm1vdXNlbW92ZT1mdW5jdGlvbih0KXt0aGlzLl9wb2ludGVyTW92ZSh0LHQpfSxzLm9ucG9pbnRlcm1vdmU9ZnVuY3Rpb24odCl7dC5wb2ludGVySWQ9PXRoaXMucG9pbnRlcklkZW50aWZpZXImJnRoaXMuX3BvaW50ZXJNb3ZlKHQsdCl9LHMub250b3VjaG1vdmU9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRUb3VjaCh0LmNoYW5nZWRUb3VjaGVzKTtlJiZ0aGlzLl9wb2ludGVyTW92ZSh0LGUpfSxzLl9wb2ludGVyTW92ZT1mdW5jdGlvbih0LGUpe3RoaXMucG9pbnRlck1vdmUodCxlKX0scy5wb2ludGVyTW92ZT1mdW5jdGlvbih0LGUpe3RoaXMuZW1pdEV2ZW50KFwicG9pbnRlck1vdmVcIixbdCxlXSl9LHMub25tb3VzZXVwPWZ1bmN0aW9uKHQpe3RoaXMuX3BvaW50ZXJVcCh0LHQpfSxzLm9ucG9pbnRlcnVwPWZ1bmN0aW9uKHQpe3QucG9pbnRlcklkPT10aGlzLnBvaW50ZXJJZGVudGlmaWVyJiZ0aGlzLl9wb2ludGVyVXAodCx0KX0scy5vbnRvdWNoZW5kPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0VG91Y2godC5jaGFuZ2VkVG91Y2hlcyk7ZSYmdGhpcy5fcG9pbnRlclVwKHQsZSl9LHMuX3BvaW50ZXJVcD1mdW5jdGlvbih0LGUpe3RoaXMuX3BvaW50ZXJEb25lKCksdGhpcy5wb2ludGVyVXAodCxlKX0scy5wb2ludGVyVXA9ZnVuY3Rpb24odCxlKXt0aGlzLmVtaXRFdmVudChcInBvaW50ZXJVcFwiLFt0LGVdKX0scy5fcG9pbnRlckRvbmU9ZnVuY3Rpb24oKXt0aGlzLl9wb2ludGVyUmVzZXQoKSx0aGlzLl91bmJpbmRQb3N0U3RhcnRFdmVudHMoKSx0aGlzLnBvaW50ZXJEb25lKCl9LHMuX3BvaW50ZXJSZXNldD1mdW5jdGlvbigpe3RoaXMuaXNQb2ludGVyRG93bj0hMSxkZWxldGUgdGhpcy5wb2ludGVySWRlbnRpZmllcn0scy5wb2ludGVyRG9uZT1pLHMub25wb2ludGVyY2FuY2VsPWZ1bmN0aW9uKHQpe3QucG9pbnRlcklkPT10aGlzLnBvaW50ZXJJZGVudGlmaWVyJiZ0aGlzLl9wb2ludGVyQ2FuY2VsKHQsdCl9LHMub250b3VjaGNhbmNlbD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFRvdWNoKHQuY2hhbmdlZFRvdWNoZXMpO2UmJnRoaXMuX3BvaW50ZXJDYW5jZWwodCxlKX0scy5fcG9pbnRlckNhbmNlbD1mdW5jdGlvbih0LGUpe3RoaXMuX3BvaW50ZXJEb25lKCksdGhpcy5wb2ludGVyQ2FuY2VsKHQsZSl9LHMucG9pbnRlckNhbmNlbD1mdW5jdGlvbih0LGUpe3RoaXMuZW1pdEV2ZW50KFwicG9pbnRlckNhbmNlbFwiLFt0LGVdKX0sbi5nZXRQb2ludGVyUG9pbnQ9ZnVuY3Rpb24odCl7cmV0dXJue3g6dC5wYWdlWCx5OnQucGFnZVl9fSxufSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwidW5pZHJhZ2dlci91bmlkcmFnZ2VyXCIsW1widW5pcG9pbnRlci91bmlwb2ludGVyXCJdLGZ1bmN0aW9uKGkpe3JldHVybiBlKHQsaSl9KTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lKHQscmVxdWlyZShcInVuaXBvaW50ZXJcIikpOnQuVW5pZHJhZ2dlcj1lKHQsdC5Vbmlwb2ludGVyKX0od2luZG93LGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSgpe312YXIgbj1pLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGUucHJvdG90eXBlKTtuLmJpbmRIYW5kbGVzPWZ1bmN0aW9uKCl7dGhpcy5fYmluZEhhbmRsZXMoITApfSxuLnVuYmluZEhhbmRsZXM9ZnVuY3Rpb24oKXt0aGlzLl9iaW5kSGFuZGxlcyghMSl9LG4uX2JpbmRIYW5kbGVzPWZ1bmN0aW9uKGUpe2U9dm9pZCAwPT09ZXx8ZTtmb3IodmFyIGk9ZT9cImFkZEV2ZW50TGlzdGVuZXJcIjpcInJlbW92ZUV2ZW50TGlzdGVuZXJcIixuPWU/dGhpcy5fdG91Y2hBY3Rpb25WYWx1ZTpcIlwiLHM9MDtzPHRoaXMuaGFuZGxlcy5sZW5ndGg7cysrKXt2YXIgbz10aGlzLmhhbmRsZXNbc107dGhpcy5fYmluZFN0YXJ0RXZlbnQobyxlKSxvW2ldKFwiY2xpY2tcIix0aGlzKSx0LlBvaW50ZXJFdmVudCYmKG8uc3R5bGUudG91Y2hBY3Rpb249bil9fSxuLl90b3VjaEFjdGlvblZhbHVlPVwibm9uZVwiLG4ucG9pbnRlckRvd249ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLm9rYXlQb2ludGVyRG93bih0KTtpJiYodGhpcy5wb2ludGVyRG93blBvaW50ZXI9ZSx0LnByZXZlbnREZWZhdWx0KCksdGhpcy5wb2ludGVyRG93bkJsdXIoKSx0aGlzLl9iaW5kUG9zdFN0YXJ0RXZlbnRzKHQpLHRoaXMuZW1pdEV2ZW50KFwicG9pbnRlckRvd25cIixbdCxlXSkpfTt2YXIgcz17VEVYVEFSRUE6ITAsSU5QVVQ6ITAsU0VMRUNUOiEwLE9QVElPTjohMH0sbz17cmFkaW86ITAsY2hlY2tib3g6ITAsYnV0dG9uOiEwLHN1Ym1pdDohMCxpbWFnZTohMCxmaWxlOiEwfTtyZXR1cm4gbi5va2F5UG9pbnRlckRvd249ZnVuY3Rpb24odCl7dmFyIGU9c1t0LnRhcmdldC5ub2RlTmFtZV0saT1vW3QudGFyZ2V0LnR5cGVdLG49IWV8fGk7cmV0dXJuIG58fHRoaXMuX3BvaW50ZXJSZXNldCgpLG59LG4ucG9pbnRlckRvd25CbHVyPWZ1bmN0aW9uKCl7dmFyIHQ9ZG9jdW1lbnQuYWN0aXZlRWxlbWVudCxlPXQmJnQuYmx1ciYmdCE9ZG9jdW1lbnQuYm9keTtlJiZ0LmJsdXIoKX0sbi5wb2ludGVyTW92ZT1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX2RyYWdQb2ludGVyTW92ZSh0LGUpO3RoaXMuZW1pdEV2ZW50KFwicG9pbnRlck1vdmVcIixbdCxlLGldKSx0aGlzLl9kcmFnTW92ZSh0LGUsaSl9LG4uX2RyYWdQb2ludGVyTW92ZT1mdW5jdGlvbih0LGUpe3ZhciBpPXt4OmUucGFnZVgtdGhpcy5wb2ludGVyRG93blBvaW50ZXIucGFnZVgseTplLnBhZ2VZLXRoaXMucG9pbnRlckRvd25Qb2ludGVyLnBhZ2VZfTtyZXR1cm4hdGhpcy5pc0RyYWdnaW5nJiZ0aGlzLmhhc0RyYWdTdGFydGVkKGkpJiZ0aGlzLl9kcmFnU3RhcnQodCxlKSxpfSxuLmhhc0RyYWdTdGFydGVkPWZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLmFicyh0LngpPjN8fE1hdGguYWJzKHQueSk+M30sbi5wb2ludGVyVXA9ZnVuY3Rpb24odCxlKXt0aGlzLmVtaXRFdmVudChcInBvaW50ZXJVcFwiLFt0LGVdKSx0aGlzLl9kcmFnUG9pbnRlclVwKHQsZSl9LG4uX2RyYWdQb2ludGVyVXA9ZnVuY3Rpb24odCxlKXt0aGlzLmlzRHJhZ2dpbmc/dGhpcy5fZHJhZ0VuZCh0LGUpOnRoaXMuX3N0YXRpY0NsaWNrKHQsZSl9LG4uX2RyYWdTdGFydD1mdW5jdGlvbih0LGUpe3RoaXMuaXNEcmFnZ2luZz0hMCx0aGlzLmlzUHJldmVudGluZ0NsaWNrcz0hMCx0aGlzLmRyYWdTdGFydCh0LGUpfSxuLmRyYWdTdGFydD1mdW5jdGlvbih0LGUpe3RoaXMuZW1pdEV2ZW50KFwiZHJhZ1N0YXJ0XCIsW3QsZV0pfSxuLl9kcmFnTW92ZT1mdW5jdGlvbih0LGUsaSl7dGhpcy5pc0RyYWdnaW5nJiZ0aGlzLmRyYWdNb3ZlKHQsZSxpKX0sbi5kcmFnTW92ZT1mdW5jdGlvbih0LGUsaSl7dC5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuZW1pdEV2ZW50KFwiZHJhZ01vdmVcIixbdCxlLGldKX0sbi5fZHJhZ0VuZD1mdW5jdGlvbih0LGUpe3RoaXMuaXNEcmFnZ2luZz0hMSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZGVsZXRlIHRoaXMuaXNQcmV2ZW50aW5nQ2xpY2tzfS5iaW5kKHRoaXMpKSx0aGlzLmRyYWdFbmQodCxlKX0sbi5kcmFnRW5kPWZ1bmN0aW9uKHQsZSl7dGhpcy5lbWl0RXZlbnQoXCJkcmFnRW5kXCIsW3QsZV0pfSxuLm9uY2xpY2s9ZnVuY3Rpb24odCl7dGhpcy5pc1ByZXZlbnRpbmdDbGlja3MmJnQucHJldmVudERlZmF1bHQoKX0sbi5fc3RhdGljQ2xpY2s9ZnVuY3Rpb24odCxlKXt0aGlzLmlzSWdub3JpbmdNb3VzZVVwJiZcIm1vdXNldXBcIj09dC50eXBlfHwodGhpcy5zdGF0aWNDbGljayh0LGUpLFwibW91c2V1cFwiIT10LnR5cGUmJih0aGlzLmlzSWdub3JpbmdNb3VzZVVwPSEwLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtkZWxldGUgdGhpcy5pc0lnbm9yaW5nTW91c2VVcH0uYmluZCh0aGlzKSw0MDApKSl9LG4uc3RhdGljQ2xpY2s9ZnVuY3Rpb24odCxlKXt0aGlzLmVtaXRFdmVudChcInN0YXRpY0NsaWNrXCIsW3QsZV0pfSxpLmdldFBvaW50ZXJQb2ludD1lLmdldFBvaW50ZXJQb2ludCxpfSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiZmxpY2tpdHkvanMvZHJhZ1wiLFtcIi4vZmxpY2tpdHlcIixcInVuaWRyYWdnZXIvdW5pZHJhZ2dlclwiLFwiZml6enktdWktdXRpbHMvdXRpbHNcIl0sZnVuY3Rpb24oaSxuLHMpe3JldHVybiBlKHQsaSxuLHMpfSk6XCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZSh0LHJlcXVpcmUoXCIuL2ZsaWNraXR5XCIpLHJlcXVpcmUoXCJ1bmlkcmFnZ2VyXCIpLHJlcXVpcmUoXCJmaXp6eS11aS11dGlsc1wiKSk6dC5GbGlja2l0eT1lKHQsdC5GbGlja2l0eSx0LlVuaWRyYWdnZXIsdC5maXp6eVVJVXRpbHMpfSh3aW5kb3csZnVuY3Rpb24odCxlLGksbil7ZnVuY3Rpb24gcygpe3JldHVybnt4OnQucGFnZVhPZmZzZXQseTp0LnBhZ2VZT2Zmc2V0fX1uLmV4dGVuZChlLmRlZmF1bHRzLHtkcmFnZ2FibGU6XCI+MVwiLGRyYWdUaHJlc2hvbGQ6M30pLGUuY3JlYXRlTWV0aG9kcy5wdXNoKFwiX2NyZWF0ZURyYWdcIik7dmFyIG89ZS5wcm90b3R5cGU7bi5leHRlbmQobyxpLnByb3RvdHlwZSksby5fdG91Y2hBY3Rpb25WYWx1ZT1cInBhbi15XCI7dmFyIHI9XCJjcmVhdGVUb3VjaFwiaW4gZG9jdW1lbnQsYT0hMTtvLl9jcmVhdGVEcmFnPWZ1bmN0aW9uKCl7dGhpcy5vbihcImFjdGl2YXRlXCIsdGhpcy5vbkFjdGl2YXRlRHJhZyksdGhpcy5vbihcInVpQ2hhbmdlXCIsdGhpcy5fdWlDaGFuZ2VEcmFnKSx0aGlzLm9uKFwiY2hpbGRVSVBvaW50ZXJEb3duXCIsdGhpcy5fY2hpbGRVSVBvaW50ZXJEb3duRHJhZyksdGhpcy5vbihcImRlYWN0aXZhdGVcIix0aGlzLm9uRGVhY3RpdmF0ZURyYWcpLHRoaXMub24oXCJjZWxsQ2hhbmdlXCIsdGhpcy51cGRhdGVEcmFnZ2FibGUpLHImJiFhJiYodC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsZnVuY3Rpb24oKXt9KSxhPSEwKX0sby5vbkFjdGl2YXRlRHJhZz1mdW5jdGlvbigpe3RoaXMuaGFuZGxlcz1bdGhpcy52aWV3cG9ydF0sdGhpcy5iaW5kSGFuZGxlcygpLHRoaXMudXBkYXRlRHJhZ2dhYmxlKCl9LG8ub25EZWFjdGl2YXRlRHJhZz1mdW5jdGlvbigpe3RoaXMudW5iaW5kSGFuZGxlcygpLHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiaXMtZHJhZ2dhYmxlXCIpfSxvLnVwZGF0ZURyYWdnYWJsZT1mdW5jdGlvbigpe1wiPjFcIj09dGhpcy5vcHRpb25zLmRyYWdnYWJsZT90aGlzLmlzRHJhZ2dhYmxlPXRoaXMuc2xpZGVzLmxlbmd0aD4xOnRoaXMuaXNEcmFnZ2FibGU9dGhpcy5vcHRpb25zLmRyYWdnYWJsZSx0aGlzLmlzRHJhZ2dhYmxlP3RoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiaXMtZHJhZ2dhYmxlXCIpOnRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiaXMtZHJhZ2dhYmxlXCIpfSxvLmJpbmREcmFnPWZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLmRyYWdnYWJsZT0hMCx0aGlzLnVwZGF0ZURyYWdnYWJsZSgpfSxvLnVuYmluZERyYWc9ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuZHJhZ2dhYmxlPSExLHRoaXMudXBkYXRlRHJhZ2dhYmxlKCl9LG8uX3VpQ2hhbmdlRHJhZz1mdW5jdGlvbigpe2RlbGV0ZSB0aGlzLmlzRnJlZVNjcm9sbGluZ30sby5fY2hpbGRVSVBvaW50ZXJEb3duRHJhZz1mdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5wb2ludGVyRG93bkZvY3VzKHQpfSxvLnBvaW50ZXJEb3duPWZ1bmN0aW9uKGUsaSl7aWYoIXRoaXMuaXNEcmFnZ2FibGUpcmV0dXJuIHZvaWQgdGhpcy5fcG9pbnRlckRvd25EZWZhdWx0KGUsaSk7dmFyIG49dGhpcy5va2F5UG9pbnRlckRvd24oZSk7biYmKHRoaXMuX3BvaW50ZXJEb3duUHJldmVudERlZmF1bHQoZSksdGhpcy5wb2ludGVyRG93bkZvY3VzKGUpLGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQhPXRoaXMuZWxlbWVudCYmdGhpcy5wb2ludGVyRG93bkJsdXIoKSx0aGlzLmRyYWdYPXRoaXMueCx0aGlzLnZpZXdwb3J0LmNsYXNzTGlzdC5hZGQoXCJpcy1wb2ludGVyLWRvd25cIiksdGhpcy5wb2ludGVyRG93blNjcm9sbD1zKCksdC5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsdGhpcyksdGhpcy5fcG9pbnRlckRvd25EZWZhdWx0KGUsaSkpfSxvLl9wb2ludGVyRG93bkRlZmF1bHQ9ZnVuY3Rpb24odCxlKXt0aGlzLnBvaW50ZXJEb3duUG9pbnRlcj1lLHRoaXMuX2JpbmRQb3N0U3RhcnRFdmVudHModCksdGhpcy5kaXNwYXRjaEV2ZW50KFwicG9pbnRlckRvd25cIix0LFtlXSl9O3ZhciBsPXtJTlBVVDohMCxURVhUQVJFQTohMCxTRUxFQ1Q6ITB9O3JldHVybiBvLnBvaW50ZXJEb3duRm9jdXM9ZnVuY3Rpb24odCl7dmFyIGU9bFt0LnRhcmdldC5ub2RlTmFtZV07ZXx8dGhpcy5mb2N1cygpfSxvLl9wb2ludGVyRG93blByZXZlbnREZWZhdWx0PWZ1bmN0aW9uKHQpe3ZhciBlPVwidG91Y2hzdGFydFwiPT10LnR5cGUsaT1cInRvdWNoXCI9PXQucG9pbnRlclR5cGUsbj1sW3QudGFyZ2V0Lm5vZGVOYW1lXTtlfHxpfHxufHx0LnByZXZlbnREZWZhdWx0KCl9LG8uaGFzRHJhZ1N0YXJ0ZWQ9ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGguYWJzKHQueCk+dGhpcy5vcHRpb25zLmRyYWdUaHJlc2hvbGR9LG8ucG9pbnRlclVwPWZ1bmN0aW9uKHQsZSl7ZGVsZXRlIHRoaXMuaXNUb3VjaFNjcm9sbGluZyx0aGlzLnZpZXdwb3J0LmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1wb2ludGVyLWRvd25cIiksdGhpcy5kaXNwYXRjaEV2ZW50KFwicG9pbnRlclVwXCIsdCxbZV0pLHRoaXMuX2RyYWdQb2ludGVyVXAodCxlKX0sby5wb2ludGVyRG9uZT1mdW5jdGlvbigpe3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLHRoaXMpLGRlbGV0ZSB0aGlzLnBvaW50ZXJEb3duU2Nyb2xsfSxvLmRyYWdTdGFydD1mdW5jdGlvbihlLGkpe3RoaXMuaXNEcmFnZ2FibGUmJih0aGlzLmRyYWdTdGFydFBvc2l0aW9uPXRoaXMueCx0aGlzLnN0YXJ0QW5pbWF0aW9uKCksdC5yZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsdGhpcyksdGhpcy5kaXNwYXRjaEV2ZW50KFwiZHJhZ1N0YXJ0XCIsZSxbaV0pKX0sby5wb2ludGVyTW92ZT1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX2RyYWdQb2ludGVyTW92ZSh0LGUpO3RoaXMuZGlzcGF0Y2hFdmVudChcInBvaW50ZXJNb3ZlXCIsdCxbZSxpXSksdGhpcy5fZHJhZ01vdmUodCxlLGkpfSxvLmRyYWdNb3ZlPWZ1bmN0aW9uKHQsZSxpKXtpZih0aGlzLmlzRHJhZ2dhYmxlKXt0LnByZXZlbnREZWZhdWx0KCksdGhpcy5wcmV2aW91c0RyYWdYPXRoaXMuZHJhZ1g7dmFyIG49dGhpcy5vcHRpb25zLnJpZ2h0VG9MZWZ0Py0xOjE7dGhpcy5vcHRpb25zLndyYXBBcm91bmQmJihpLng9aS54JXRoaXMuc2xpZGVhYmxlV2lkdGgpO3ZhciBzPXRoaXMuZHJhZ1N0YXJ0UG9zaXRpb24raS54Km47aWYoIXRoaXMub3B0aW9ucy53cmFwQXJvdW5kJiZ0aGlzLnNsaWRlcy5sZW5ndGgpe3ZhciBvPU1hdGgubWF4KC10aGlzLnNsaWRlc1swXS50YXJnZXQsdGhpcy5kcmFnU3RhcnRQb3NpdGlvbik7cz1zPm8/LjUqKHMrbyk6czt2YXIgcj1NYXRoLm1pbigtdGhpcy5nZXRMYXN0U2xpZGUoKS50YXJnZXQsdGhpcy5kcmFnU3RhcnRQb3NpdGlvbik7cz1zPHI/LjUqKHMrcik6c310aGlzLmRyYWdYPXMsdGhpcy5kcmFnTW92ZVRpbWU9bmV3IERhdGUsXG50aGlzLmRpc3BhdGNoRXZlbnQoXCJkcmFnTW92ZVwiLHQsW2UsaV0pfX0sby5kcmFnRW5kPWZ1bmN0aW9uKHQsZSl7aWYodGhpcy5pc0RyYWdnYWJsZSl7dGhpcy5vcHRpb25zLmZyZWVTY3JvbGwmJih0aGlzLmlzRnJlZVNjcm9sbGluZz0hMCk7dmFyIGk9dGhpcy5kcmFnRW5kUmVzdGluZ1NlbGVjdCgpO2lmKHRoaXMub3B0aW9ucy5mcmVlU2Nyb2xsJiYhdGhpcy5vcHRpb25zLndyYXBBcm91bmQpe3ZhciBuPXRoaXMuZ2V0UmVzdGluZ1Bvc2l0aW9uKCk7dGhpcy5pc0ZyZWVTY3JvbGxpbmc9LW4+dGhpcy5zbGlkZXNbMF0udGFyZ2V0JiYtbjx0aGlzLmdldExhc3RTbGlkZSgpLnRhcmdldH1lbHNlIHRoaXMub3B0aW9ucy5mcmVlU2Nyb2xsfHxpIT10aGlzLnNlbGVjdGVkSW5kZXh8fChpKz10aGlzLmRyYWdFbmRCb29zdFNlbGVjdCgpKTtkZWxldGUgdGhpcy5wcmV2aW91c0RyYWdYLHRoaXMuaXNEcmFnU2VsZWN0PXRoaXMub3B0aW9ucy53cmFwQXJvdW5kLHRoaXMuc2VsZWN0KGkpLGRlbGV0ZSB0aGlzLmlzRHJhZ1NlbGVjdCx0aGlzLmRpc3BhdGNoRXZlbnQoXCJkcmFnRW5kXCIsdCxbZV0pfX0sby5kcmFnRW5kUmVzdGluZ1NlbGVjdD1mdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0UmVzdGluZ1Bvc2l0aW9uKCksZT1NYXRoLmFicyh0aGlzLmdldFNsaWRlRGlzdGFuY2UoLXQsdGhpcy5zZWxlY3RlZEluZGV4KSksaT10aGlzLl9nZXRDbG9zZXN0UmVzdGluZyh0LGUsMSksbj10aGlzLl9nZXRDbG9zZXN0UmVzdGluZyh0LGUsLTEpLHM9aS5kaXN0YW5jZTxuLmRpc3RhbmNlP2kuaW5kZXg6bi5pbmRleDtyZXR1cm4gc30sby5fZ2V0Q2xvc2VzdFJlc3Rpbmc9ZnVuY3Rpb24odCxlLGkpe2Zvcih2YXIgbj10aGlzLnNlbGVjdGVkSW5kZXgscz0xLzAsbz10aGlzLm9wdGlvbnMuY29udGFpbiYmIXRoaXMub3B0aW9ucy53cmFwQXJvdW5kP2Z1bmN0aW9uKHQsZSl7cmV0dXJuIHQ8PWV9OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ8ZX07byhlLHMpJiYobis9aSxzPWUsZT10aGlzLmdldFNsaWRlRGlzdGFuY2UoLXQsbiksbnVsbCE9PWUpOyllPU1hdGguYWJzKGUpO3JldHVybntkaXN0YW5jZTpzLGluZGV4Om4taX19LG8uZ2V0U2xpZGVEaXN0YW5jZT1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuc2xpZGVzLmxlbmd0aCxzPXRoaXMub3B0aW9ucy53cmFwQXJvdW5kJiZpPjEsbz1zP24ubW9kdWxvKGUsaSk6ZSxyPXRoaXMuc2xpZGVzW29dO2lmKCFyKXJldHVybiBudWxsO3ZhciBhPXM/dGhpcy5zbGlkZWFibGVXaWR0aCpNYXRoLmZsb29yKGUvaSk6MDtyZXR1cm4gdC0oci50YXJnZXQrYSl9LG8uZHJhZ0VuZEJvb3N0U2VsZWN0PWZ1bmN0aW9uKCl7aWYodm9pZCAwPT09dGhpcy5wcmV2aW91c0RyYWdYfHwhdGhpcy5kcmFnTW92ZVRpbWV8fG5ldyBEYXRlLXRoaXMuZHJhZ01vdmVUaW1lPjEwMClyZXR1cm4gMDt2YXIgdD10aGlzLmdldFNsaWRlRGlzdGFuY2UoLXRoaXMuZHJhZ1gsdGhpcy5zZWxlY3RlZEluZGV4KSxlPXRoaXMucHJldmlvdXNEcmFnWC10aGlzLmRyYWdYO3JldHVybiB0PjAmJmU+MD8xOnQ8MCYmZTwwPy0xOjB9LG8uc3RhdGljQ2xpY2s9ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmdldFBhcmVudENlbGwodC50YXJnZXQpLG49aSYmaS5lbGVtZW50LHM9aSYmdGhpcy5jZWxscy5pbmRleE9mKGkpO3RoaXMuZGlzcGF0Y2hFdmVudChcInN0YXRpY0NsaWNrXCIsdCxbZSxuLHNdKX0sby5vbnNjcm9sbD1mdW5jdGlvbigpe3ZhciB0PXMoKSxlPXRoaXMucG9pbnRlckRvd25TY3JvbGwueC10LngsaT10aGlzLnBvaW50ZXJEb3duU2Nyb2xsLnktdC55OyhNYXRoLmFicyhlKT4zfHxNYXRoLmFicyhpKT4zKSYmdGhpcy5fcG9pbnRlckRvbmUoKX0sZX0pLGZ1bmN0aW9uKHQsZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShcInRhcC1saXN0ZW5lci90YXAtbGlzdGVuZXJcIixbXCJ1bmlwb2ludGVyL3VuaXBvaW50ZXJcIl0sZnVuY3Rpb24oaSl7cmV0dXJuIGUodCxpKX0pOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUodCxyZXF1aXJlKFwidW5pcG9pbnRlclwiKSk6dC5UYXBMaXN0ZW5lcj1lKHQsdC5Vbmlwb2ludGVyKX0od2luZG93LGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0KXt0aGlzLmJpbmRUYXAodCl9dmFyIG49aS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShlLnByb3RvdHlwZSk7cmV0dXJuIG4uYmluZFRhcD1mdW5jdGlvbih0KXt0JiYodGhpcy51bmJpbmRUYXAoKSx0aGlzLnRhcEVsZW1lbnQ9dCx0aGlzLl9iaW5kU3RhcnRFdmVudCh0LCEwKSl9LG4udW5iaW5kVGFwPWZ1bmN0aW9uKCl7dGhpcy50YXBFbGVtZW50JiYodGhpcy5fYmluZFN0YXJ0RXZlbnQodGhpcy50YXBFbGVtZW50LCEwKSxkZWxldGUgdGhpcy50YXBFbGVtZW50KX0sbi5wb2ludGVyVXA9ZnVuY3Rpb24oaSxuKXtpZighdGhpcy5pc0lnbm9yaW5nTW91c2VVcHx8XCJtb3VzZXVwXCIhPWkudHlwZSl7dmFyIHM9ZS5nZXRQb2ludGVyUG9pbnQobiksbz10aGlzLnRhcEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkscj10LnBhZ2VYT2Zmc2V0LGE9dC5wYWdlWU9mZnNldCxsPXMueD49by5sZWZ0K3ImJnMueDw9by5yaWdodCtyJiZzLnk+PW8udG9wK2EmJnMueTw9by5ib3R0b20rYTtpZihsJiZ0aGlzLmVtaXRFdmVudChcInRhcFwiLFtpLG5dKSxcIm1vdXNldXBcIiE9aS50eXBlKXt0aGlzLmlzSWdub3JpbmdNb3VzZVVwPSEwO3ZhciBoPXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe2RlbGV0ZSBoLmlzSWdub3JpbmdNb3VzZVVwfSw0MDApfX19LG4uZGVzdHJveT1mdW5jdGlvbigpe3RoaXMucG9pbnRlckRvbmUoKSx0aGlzLnVuYmluZFRhcCgpfSxpfSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiZmxpY2tpdHkvanMvcHJldi1uZXh0LWJ1dHRvblwiLFtcIi4vZmxpY2tpdHlcIixcInRhcC1saXN0ZW5lci90YXAtbGlzdGVuZXJcIixcImZpenp5LXVpLXV0aWxzL3V0aWxzXCJdLGZ1bmN0aW9uKGksbixzKXtyZXR1cm4gZSh0LGksbixzKX0pOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUodCxyZXF1aXJlKFwiLi9mbGlja2l0eVwiKSxyZXF1aXJlKFwidGFwLWxpc3RlbmVyXCIpLHJlcXVpcmUoXCJmaXp6eS11aS11dGlsc1wiKSk6ZSh0LHQuRmxpY2tpdHksdC5UYXBMaXN0ZW5lcix0LmZpenp5VUlVdGlscyl9KHdpbmRvdyxmdW5jdGlvbih0LGUsaSxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBzKHQsZSl7dGhpcy5kaXJlY3Rpb249dCx0aGlzLnBhcmVudD1lLHRoaXMuX2NyZWF0ZSgpfWZ1bmN0aW9uIG8odCl7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIHQ/dDpcIk0gXCIrdC54MCtcIiw1MCBMIFwiK3QueDErXCIsXCIrKHQueTErNTApK1wiIEwgXCIrdC54MitcIixcIisodC55Mis1MCkrXCIgTCBcIit0LngzK1wiLDUwICBMIFwiK3QueDIrXCIsXCIrKDUwLXQueTIpK1wiIEwgXCIrdC54MStcIixcIisoNTAtdC55MSkrXCIgWlwifXZhciByPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIjtzLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGkucHJvdG90eXBlKSxzLnByb3RvdHlwZS5fY3JlYXRlPWZ1bmN0aW9uKCl7dGhpcy5pc0VuYWJsZWQ9ITAsdGhpcy5pc1ByZXZpb3VzPXRoaXMuZGlyZWN0aW9uPT0tMTt2YXIgdD10aGlzLnBhcmVudC5vcHRpb25zLnJpZ2h0VG9MZWZ0PzE6LTE7dGhpcy5pc0xlZnQ9dGhpcy5kaXJlY3Rpb249PXQ7dmFyIGU9dGhpcy5lbGVtZW50PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7ZS5jbGFzc05hbWU9XCJmbGlja2l0eS1idXR0b24gZmxpY2tpdHktcHJldi1uZXh0LWJ1dHRvblwiLGUuY2xhc3NOYW1lKz10aGlzLmlzUHJldmlvdXM/XCIgcHJldmlvdXNcIjpcIiBuZXh0XCIsZS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsXCJidXR0b25cIiksdGhpcy5kaXNhYmxlKCksZS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsdGhpcy5pc1ByZXZpb3VzP1wiUHJldmlvdXNcIjpcIk5leHRcIik7dmFyIGk9dGhpcy5jcmVhdGVTVkcoKTtlLmFwcGVuZENoaWxkKGkpLHRoaXMub24oXCJ0YXBcIix0aGlzLm9uVGFwKSx0aGlzLnBhcmVudC5vbihcInNlbGVjdFwiLHRoaXMudXBkYXRlLmJpbmQodGhpcykpLHRoaXMub24oXCJwb2ludGVyRG93blwiLHRoaXMucGFyZW50LmNoaWxkVUlQb2ludGVyRG93bi5iaW5kKHRoaXMucGFyZW50KSl9LHMucHJvdG90eXBlLmFjdGl2YXRlPWZ1bmN0aW9uKCl7dGhpcy5iaW5kVGFwKHRoaXMuZWxlbWVudCksdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLHRoaXMpLHRoaXMucGFyZW50LmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50KX0scy5wcm90b3R5cGUuZGVhY3RpdmF0ZT1mdW5jdGlvbigpe3RoaXMucGFyZW50LmVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50KSxpLnByb3RvdHlwZS5kZXN0cm95LmNhbGwodGhpcyksdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLHRoaXMpfSxzLnByb3RvdHlwZS5jcmVhdGVTVkc9ZnVuY3Rpb24oKXt2YXIgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMocixcInN2Z1wiKTt0LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsXCJmbGlja2l0eS1idXR0b24taWNvblwiKSx0LnNldEF0dHJpYnV0ZShcInZpZXdCb3hcIixcIjAgMCAxMDAgMTAwXCIpO3ZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhyLFwicGF0aFwiKSxpPW8odGhpcy5wYXJlbnQub3B0aW9ucy5hcnJvd1NoYXBlKTtyZXR1cm4gZS5zZXRBdHRyaWJ1dGUoXCJkXCIsaSksZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLFwiYXJyb3dcIiksdGhpcy5pc0xlZnR8fGUuc2V0QXR0cmlidXRlKFwidHJhbnNmb3JtXCIsXCJ0cmFuc2xhdGUoMTAwLCAxMDApIHJvdGF0ZSgxODApIFwiKSx0LmFwcGVuZENoaWxkKGUpLHR9LHMucHJvdG90eXBlLm9uVGFwPWZ1bmN0aW9uKCl7aWYodGhpcy5pc0VuYWJsZWQpe3RoaXMucGFyZW50LnVpQ2hhbmdlKCk7dmFyIHQ9dGhpcy5pc1ByZXZpb3VzP1wicHJldmlvdXNcIjpcIm5leHRcIjt0aGlzLnBhcmVudFt0XSgpfX0scy5wcm90b3R5cGUuaGFuZGxlRXZlbnQ9bi5oYW5kbGVFdmVudCxzLnByb3RvdHlwZS5vbmNsaWNrPWZ1bmN0aW9uKHQpe3ZhciBlPWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7ZSYmZT09dGhpcy5lbGVtZW50JiZ0aGlzLm9uVGFwKHQsdCl9LHMucHJvdG90eXBlLmVuYWJsZT1mdW5jdGlvbigpe3RoaXMuaXNFbmFibGVkfHwodGhpcy5lbGVtZW50LmRpc2FibGVkPSExLHRoaXMuaXNFbmFibGVkPSEwKX0scy5wcm90b3R5cGUuZGlzYWJsZT1mdW5jdGlvbigpe3RoaXMuaXNFbmFibGVkJiYodGhpcy5lbGVtZW50LmRpc2FibGVkPSEwLHRoaXMuaXNFbmFibGVkPSExKX0scy5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5wYXJlbnQuc2xpZGVzO2lmKHRoaXMucGFyZW50Lm9wdGlvbnMud3JhcEFyb3VuZCYmdC5sZW5ndGg+MSlyZXR1cm4gdm9pZCB0aGlzLmVuYWJsZSgpO3ZhciBlPXQubGVuZ3RoP3QubGVuZ3RoLTE6MCxpPXRoaXMuaXNQcmV2aW91cz8wOmUsbj10aGlzLnBhcmVudC5zZWxlY3RlZEluZGV4PT1pP1wiZGlzYWJsZVwiOlwiZW5hYmxlXCI7dGhpc1tuXSgpfSxzLnByb3RvdHlwZS5kZXN0cm95PWZ1bmN0aW9uKCl7dGhpcy5kZWFjdGl2YXRlKCl9LG4uZXh0ZW5kKGUuZGVmYXVsdHMse3ByZXZOZXh0QnV0dG9uczohMCxhcnJvd1NoYXBlOnt4MDoxMCx4MTo2MCx5MTo1MCx4Mjo3MCx5Mjo0MCx4MzozMH19KSxlLmNyZWF0ZU1ldGhvZHMucHVzaChcIl9jcmVhdGVQcmV2TmV4dEJ1dHRvbnNcIik7dmFyIGE9ZS5wcm90b3R5cGU7cmV0dXJuIGEuX2NyZWF0ZVByZXZOZXh0QnV0dG9ucz1mdW5jdGlvbigpe3RoaXMub3B0aW9ucy5wcmV2TmV4dEJ1dHRvbnMmJih0aGlzLnByZXZCdXR0b249bmV3IHMoKC0xKSx0aGlzKSx0aGlzLm5leHRCdXR0b249bmV3IHMoMSx0aGlzKSx0aGlzLm9uKFwiYWN0aXZhdGVcIix0aGlzLmFjdGl2YXRlUHJldk5leHRCdXR0b25zKSl9LGEuYWN0aXZhdGVQcmV2TmV4dEJ1dHRvbnM9ZnVuY3Rpb24oKXt0aGlzLnByZXZCdXR0b24uYWN0aXZhdGUoKSx0aGlzLm5leHRCdXR0b24uYWN0aXZhdGUoKSx0aGlzLm9uKFwiZGVhY3RpdmF0ZVwiLHRoaXMuZGVhY3RpdmF0ZVByZXZOZXh0QnV0dG9ucyl9LGEuZGVhY3RpdmF0ZVByZXZOZXh0QnV0dG9ucz1mdW5jdGlvbigpe3RoaXMucHJldkJ1dHRvbi5kZWFjdGl2YXRlKCksdGhpcy5uZXh0QnV0dG9uLmRlYWN0aXZhdGUoKSx0aGlzLm9mZihcImRlYWN0aXZhdGVcIix0aGlzLmRlYWN0aXZhdGVQcmV2TmV4dEJ1dHRvbnMpfSxlLlByZXZOZXh0QnV0dG9uPXMsZX0pLGZ1bmN0aW9uKHQsZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShcImZsaWNraXR5L2pzL3BhZ2UtZG90c1wiLFtcIi4vZmxpY2tpdHlcIixcInRhcC1saXN0ZW5lci90YXAtbGlzdGVuZXJcIixcImZpenp5LXVpLXV0aWxzL3V0aWxzXCJdLGZ1bmN0aW9uKGksbixzKXtyZXR1cm4gZSh0LGksbixzKX0pOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUodCxyZXF1aXJlKFwiLi9mbGlja2l0eVwiKSxyZXF1aXJlKFwidGFwLWxpc3RlbmVyXCIpLHJlcXVpcmUoXCJmaXp6eS11aS11dGlsc1wiKSk6ZSh0LHQuRmxpY2tpdHksdC5UYXBMaXN0ZW5lcix0LmZpenp5VUlVdGlscyl9KHdpbmRvdyxmdW5jdGlvbih0LGUsaSxuKXtmdW5jdGlvbiBzKHQpe3RoaXMucGFyZW50PXQsdGhpcy5fY3JlYXRlKCl9cy5wcm90b3R5cGU9bmV3IGkscy5wcm90b3R5cGUuX2NyZWF0ZT1mdW5jdGlvbigpe3RoaXMuaG9sZGVyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvbFwiKSx0aGlzLmhvbGRlci5jbGFzc05hbWU9XCJmbGlja2l0eS1wYWdlLWRvdHNcIix0aGlzLmRvdHM9W10sdGhpcy5vbihcInRhcFwiLHRoaXMub25UYXApLHRoaXMub24oXCJwb2ludGVyRG93blwiLHRoaXMucGFyZW50LmNoaWxkVUlQb2ludGVyRG93bi5iaW5kKHRoaXMucGFyZW50KSl9LHMucHJvdG90eXBlLmFjdGl2YXRlPWZ1bmN0aW9uKCl7dGhpcy5zZXREb3RzKCksdGhpcy5iaW5kVGFwKHRoaXMuaG9sZGVyKSx0aGlzLnBhcmVudC5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuaG9sZGVyKX0scy5wcm90b3R5cGUuZGVhY3RpdmF0ZT1mdW5jdGlvbigpe3RoaXMucGFyZW50LmVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5ob2xkZXIpLGkucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKX0scy5wcm90b3R5cGUuc2V0RG90cz1mdW5jdGlvbigpe3ZhciB0PXRoaXMucGFyZW50LnNsaWRlcy5sZW5ndGgtdGhpcy5kb3RzLmxlbmd0aDt0PjA/dGhpcy5hZGREb3RzKHQpOnQ8MCYmdGhpcy5yZW1vdmVEb3RzKC10KX0scy5wcm90b3R5cGUuYWRkRG90cz1mdW5jdGlvbih0KXtmb3IodmFyIGU9ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLGk9W10sbj10aGlzLmRvdHMubGVuZ3RoLHM9bit0LG89bjtvPHM7bysrKXt2YXIgcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7ci5jbGFzc05hbWU9XCJkb3RcIixyLnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIixcIlBhZ2UgZG90IFwiKyhvKzEpKSxlLmFwcGVuZENoaWxkKHIpLGkucHVzaChyKX10aGlzLmhvbGRlci5hcHBlbmRDaGlsZChlKSx0aGlzLmRvdHM9dGhpcy5kb3RzLmNvbmNhdChpKX0scy5wcm90b3R5cGUucmVtb3ZlRG90cz1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmRvdHMuc3BsaWNlKHRoaXMuZG90cy5sZW5ndGgtdCx0KTtlLmZvckVhY2goZnVuY3Rpb24odCl7dGhpcy5ob2xkZXIucmVtb3ZlQ2hpbGQodCl9LHRoaXMpfSxzLnByb3RvdHlwZS51cGRhdGVTZWxlY3RlZD1mdW5jdGlvbigpe3RoaXMuc2VsZWN0ZWREb3QmJih0aGlzLnNlbGVjdGVkRG90LmNsYXNzTmFtZT1cImRvdFwiLHRoaXMuc2VsZWN0ZWREb3QucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1jdXJyZW50XCIpKSx0aGlzLmRvdHMubGVuZ3RoJiYodGhpcy5zZWxlY3RlZERvdD10aGlzLmRvdHNbdGhpcy5wYXJlbnQuc2VsZWN0ZWRJbmRleF0sdGhpcy5zZWxlY3RlZERvdC5jbGFzc05hbWU9XCJkb3QgaXMtc2VsZWN0ZWRcIix0aGlzLnNlbGVjdGVkRG90LnNldEF0dHJpYnV0ZShcImFyaWEtY3VycmVudFwiLFwic3RlcFwiKSl9LHMucHJvdG90eXBlLm9uVGFwPWZ1bmN0aW9uKHQpe3ZhciBlPXQudGFyZ2V0O2lmKFwiTElcIj09ZS5ub2RlTmFtZSl7dGhpcy5wYXJlbnQudWlDaGFuZ2UoKTt2YXIgaT10aGlzLmRvdHMuaW5kZXhPZihlKTt0aGlzLnBhcmVudC5zZWxlY3QoaSl9fSxzLnByb3RvdHlwZS5kZXN0cm95PWZ1bmN0aW9uKCl7dGhpcy5kZWFjdGl2YXRlKCl9LGUuUGFnZURvdHM9cyxuLmV4dGVuZChlLmRlZmF1bHRzLHtwYWdlRG90czohMH0pLGUuY3JlYXRlTWV0aG9kcy5wdXNoKFwiX2NyZWF0ZVBhZ2VEb3RzXCIpO3ZhciBvPWUucHJvdG90eXBlO3JldHVybiBvLl9jcmVhdGVQYWdlRG90cz1mdW5jdGlvbigpe3RoaXMub3B0aW9ucy5wYWdlRG90cyYmKHRoaXMucGFnZURvdHM9bmV3IHModGhpcyksdGhpcy5vbihcImFjdGl2YXRlXCIsdGhpcy5hY3RpdmF0ZVBhZ2VEb3RzKSx0aGlzLm9uKFwic2VsZWN0XCIsdGhpcy51cGRhdGVTZWxlY3RlZFBhZ2VEb3RzKSx0aGlzLm9uKFwiY2VsbENoYW5nZVwiLHRoaXMudXBkYXRlUGFnZURvdHMpLHRoaXMub24oXCJyZXNpemVcIix0aGlzLnVwZGF0ZVBhZ2VEb3RzKSx0aGlzLm9uKFwiZGVhY3RpdmF0ZVwiLHRoaXMuZGVhY3RpdmF0ZVBhZ2VEb3RzKSl9LG8uYWN0aXZhdGVQYWdlRG90cz1mdW5jdGlvbigpe3RoaXMucGFnZURvdHMuYWN0aXZhdGUoKX0sby51cGRhdGVTZWxlY3RlZFBhZ2VEb3RzPWZ1bmN0aW9uKCl7dGhpcy5wYWdlRG90cy51cGRhdGVTZWxlY3RlZCgpfSxvLnVwZGF0ZVBhZ2VEb3RzPWZ1bmN0aW9uKCl7dGhpcy5wYWdlRG90cy5zZXREb3RzKCl9LG8uZGVhY3RpdmF0ZVBhZ2VEb3RzPWZ1bmN0aW9uKCl7dGhpcy5wYWdlRG90cy5kZWFjdGl2YXRlKCl9LGUuUGFnZURvdHM9cyxlfSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiZmxpY2tpdHkvanMvcGxheWVyXCIsW1wiZXYtZW1pdHRlci9ldi1lbWl0dGVyXCIsXCJmaXp6eS11aS11dGlscy91dGlsc1wiLFwiLi9mbGlja2l0eVwiXSxmdW5jdGlvbih0LGksbil7cmV0dXJuIGUodCxpLG4pfSk6XCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZShyZXF1aXJlKFwiZXYtZW1pdHRlclwiKSxyZXF1aXJlKFwiZml6enktdWktdXRpbHNcIikscmVxdWlyZShcIi4vZmxpY2tpdHlcIikpOmUodC5FdkVtaXR0ZXIsdC5maXp6eVVJVXRpbHMsdC5GbGlja2l0eSl9KHdpbmRvdyxmdW5jdGlvbih0LGUsaSl7ZnVuY3Rpb24gbih0KXt0aGlzLnBhcmVudD10LHRoaXMuc3RhdGU9XCJzdG9wcGVkXCIsdGhpcy5vblZpc2liaWxpdHlDaGFuZ2U9dGhpcy52aXNpYmlsaXR5Q2hhbmdlLmJpbmQodGhpcyksdGhpcy5vblZpc2liaWxpdHlQbGF5PXRoaXMudmlzaWJpbGl0eVBsYXkuYmluZCh0aGlzKX1uLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHQucHJvdG90eXBlKSxuLnByb3RvdHlwZS5wbGF5PWZ1bmN0aW9uKCl7aWYoXCJwbGF5aW5nXCIhPXRoaXMuc3RhdGUpe3ZhciB0PWRvY3VtZW50LmhpZGRlbjtpZih0KXJldHVybiB2b2lkIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsdGhpcy5vblZpc2liaWxpdHlQbGF5KTt0aGlzLnN0YXRlPVwicGxheWluZ1wiLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsdGhpcy5vblZpc2liaWxpdHlDaGFuZ2UpLHRoaXMudGljaygpfX0sbi5wcm90b3R5cGUudGljaz1mdW5jdGlvbigpe2lmKFwicGxheWluZ1wiPT10aGlzLnN0YXRlKXt2YXIgdD10aGlzLnBhcmVudC5vcHRpb25zLmF1dG9QbGF5O3Q9XCJudW1iZXJcIj09dHlwZW9mIHQ/dDozZTM7dmFyIGU9dGhpczt0aGlzLmNsZWFyKCksdGhpcy50aW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLnBhcmVudC5uZXh0KCEwKSxlLnRpY2soKX0sdCl9fSxuLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKCl7dGhpcy5zdGF0ZT1cInN0b3BwZWRcIix0aGlzLmNsZWFyKCksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIix0aGlzLm9uVmlzaWJpbGl0eUNoYW5nZSl9LG4ucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7Y2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCl9LG4ucHJvdG90eXBlLnBhdXNlPWZ1bmN0aW9uKCl7XCJwbGF5aW5nXCI9PXRoaXMuc3RhdGUmJih0aGlzLnN0YXRlPVwicGF1c2VkXCIsdGhpcy5jbGVhcigpKX0sbi5wcm90b3R5cGUudW5wYXVzZT1mdW5jdGlvbigpe1wicGF1c2VkXCI9PXRoaXMuc3RhdGUmJnRoaXMucGxheSgpfSxuLnByb3RvdHlwZS52aXNpYmlsaXR5Q2hhbmdlPWZ1bmN0aW9uKCl7dmFyIHQ9ZG9jdW1lbnQuaGlkZGVuO3RoaXNbdD9cInBhdXNlXCI6XCJ1bnBhdXNlXCJdKCl9LG4ucHJvdG90eXBlLnZpc2liaWxpdHlQbGF5PWZ1bmN0aW9uKCl7dGhpcy5wbGF5KCksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIix0aGlzLm9uVmlzaWJpbGl0eVBsYXkpfSxlLmV4dGVuZChpLmRlZmF1bHRzLHtwYXVzZUF1dG9QbGF5T25Ib3ZlcjohMH0pLGkuY3JlYXRlTWV0aG9kcy5wdXNoKFwiX2NyZWF0ZVBsYXllclwiKTt2YXIgcz1pLnByb3RvdHlwZTtyZXR1cm4gcy5fY3JlYXRlUGxheWVyPWZ1bmN0aW9uKCl7dGhpcy5wbGF5ZXI9bmV3IG4odGhpcyksdGhpcy5vbihcImFjdGl2YXRlXCIsdGhpcy5hY3RpdmF0ZVBsYXllciksdGhpcy5vbihcInVpQ2hhbmdlXCIsdGhpcy5zdG9wUGxheWVyKSx0aGlzLm9uKFwicG9pbnRlckRvd25cIix0aGlzLnN0b3BQbGF5ZXIpLHRoaXMub24oXCJkZWFjdGl2YXRlXCIsdGhpcy5kZWFjdGl2YXRlUGxheWVyKX0scy5hY3RpdmF0ZVBsYXllcj1mdW5jdGlvbigpe3RoaXMub3B0aW9ucy5hdXRvUGxheSYmKHRoaXMucGxheWVyLnBsYXkoKSx0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIix0aGlzKSl9LHMucGxheVBsYXllcj1mdW5jdGlvbigpe3RoaXMucGxheWVyLnBsYXkoKX0scy5zdG9wUGxheWVyPWZ1bmN0aW9uKCl7dGhpcy5wbGF5ZXIuc3RvcCgpfSxzLnBhdXNlUGxheWVyPWZ1bmN0aW9uKCl7dGhpcy5wbGF5ZXIucGF1c2UoKX0scy51bnBhdXNlUGxheWVyPWZ1bmN0aW9uKCl7dGhpcy5wbGF5ZXIudW5wYXVzZSgpfSxzLmRlYWN0aXZhdGVQbGF5ZXI9ZnVuY3Rpb24oKXt0aGlzLnBsYXllci5zdG9wKCksdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsdGhpcyl9LHMub25tb3VzZWVudGVyPWZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLnBhdXNlQXV0b1BsYXlPbkhvdmVyJiYodGhpcy5wbGF5ZXIucGF1c2UoKSx0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIix0aGlzKSl9LHMub25tb3VzZWxlYXZlPWZ1bmN0aW9uKCl7dGhpcy5wbGF5ZXIudW5wYXVzZSgpLHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLHRoaXMpfSxpLlBsYXllcj1uLGl9KSxmdW5jdGlvbih0LGUpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJmbGlja2l0eS9qcy9hZGQtcmVtb3ZlLWNlbGxcIixbXCIuL2ZsaWNraXR5XCIsXCJmaXp6eS11aS11dGlscy91dGlsc1wiXSxmdW5jdGlvbihpLG4pe3JldHVybiBlKHQsaSxuKX0pOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUodCxyZXF1aXJlKFwiLi9mbGlja2l0eVwiKSxyZXF1aXJlKFwiZml6enktdWktdXRpbHNcIikpOmUodCx0LkZsaWNraXR5LHQuZml6enlVSVV0aWxzKX0od2luZG93LGZ1bmN0aW9uKHQsZSxpKXtmdW5jdGlvbiBuKHQpe3ZhciBlPWRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtyZXR1cm4gdC5mb3JFYWNoKGZ1bmN0aW9uKHQpe2UuYXBwZW5kQ2hpbGQodC5lbGVtZW50KX0pLGV9dmFyIHM9ZS5wcm90b3R5cGU7cmV0dXJuIHMuaW5zZXJ0PWZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fbWFrZUNlbGxzKHQpO2lmKGkmJmkubGVuZ3RoKXt2YXIgcz10aGlzLmNlbGxzLmxlbmd0aDtlPXZvaWQgMD09PWU/czplO3ZhciBvPW4oaSkscj1lPT1zO2lmKHIpdGhpcy5zbGlkZXIuYXBwZW5kQ2hpbGQobyk7ZWxzZXt2YXIgYT10aGlzLmNlbGxzW2VdLmVsZW1lbnQ7dGhpcy5zbGlkZXIuaW5zZXJ0QmVmb3JlKG8sYSl9aWYoMD09PWUpdGhpcy5jZWxscz1pLmNvbmNhdCh0aGlzLmNlbGxzKTtlbHNlIGlmKHIpdGhpcy5jZWxscz10aGlzLmNlbGxzLmNvbmNhdChpKTtlbHNle3ZhciBsPXRoaXMuY2VsbHMuc3BsaWNlKGUscy1lKTt0aGlzLmNlbGxzPXRoaXMuY2VsbHMuY29uY2F0KGkpLmNvbmNhdChsKX10aGlzLl9zaXplQ2VsbHMoaSksdGhpcy5jZWxsQ2hhbmdlKGUsITApfX0scy5hcHBlbmQ9ZnVuY3Rpb24odCl7dGhpcy5pbnNlcnQodCx0aGlzLmNlbGxzLmxlbmd0aCl9LHMucHJlcGVuZD1mdW5jdGlvbih0KXt0aGlzLmluc2VydCh0LDApfSxzLnJlbW92ZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldENlbGxzKHQpO2lmKGUmJmUubGVuZ3RoKXt2YXIgbj10aGlzLmNlbGxzLmxlbmd0aC0xO2UuZm9yRWFjaChmdW5jdGlvbih0KXt0LnJlbW92ZSgpO3ZhciBlPXRoaXMuY2VsbHMuaW5kZXhPZih0KTtuPU1hdGgubWluKGUsbiksaS5yZW1vdmVGcm9tKHRoaXMuY2VsbHMsdCl9LHRoaXMpLHRoaXMuY2VsbENoYW5nZShuLCEwKX19LHMuY2VsbFNpemVDaGFuZ2U9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRDZWxsKHQpO2lmKGUpe2UuZ2V0U2l6ZSgpO3ZhciBpPXRoaXMuY2VsbHMuaW5kZXhPZihlKTt0aGlzLmNlbGxDaGFuZ2UoaSl9fSxzLmNlbGxDaGFuZ2U9ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLnNlbGVjdGVkRWxlbWVudDt0aGlzLl9wb3NpdGlvbkNlbGxzKHQpLHRoaXMuX2dldFdyYXBTaGlmdENlbGxzKCksdGhpcy5zZXRHYWxsZXJ5U2l6ZSgpO3ZhciBuPXRoaXMuZ2V0Q2VsbChpKTtuJiYodGhpcy5zZWxlY3RlZEluZGV4PXRoaXMuZ2V0Q2VsbFNsaWRlSW5kZXgobikpLHRoaXMuc2VsZWN0ZWRJbmRleD1NYXRoLm1pbih0aGlzLnNsaWRlcy5sZW5ndGgtMSx0aGlzLnNlbGVjdGVkSW5kZXgpLHRoaXMuZW1pdEV2ZW50KFwiY2VsbENoYW5nZVwiLFt0XSksdGhpcy5zZWxlY3QodGhpcy5zZWxlY3RlZEluZGV4KSxlJiZ0aGlzLnBvc2l0aW9uU2xpZGVyQXRTZWxlY3RlZCgpfSxlfSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiZmxpY2tpdHkvanMvbGF6eWxvYWRcIixbXCIuL2ZsaWNraXR5XCIsXCJmaXp6eS11aS11dGlscy91dGlsc1wiXSxmdW5jdGlvbihpLG4pe3JldHVybiBlKHQsaSxuKX0pOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUodCxyZXF1aXJlKFwiLi9mbGlja2l0eVwiKSxyZXF1aXJlKFwiZml6enktdWktdXRpbHNcIikpOmUodCx0LkZsaWNraXR5LHQuZml6enlVSVV0aWxzKX0od2luZG93LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBuKHQpe2lmKFwiSU1HXCI9PXQubm9kZU5hbWUpe3ZhciBlPXQuZ2V0QXR0cmlidXRlKFwiZGF0YS1mbGlja2l0eS1sYXp5bG9hZFwiKSxuPXQuZ2V0QXR0cmlidXRlKFwiZGF0YS1mbGlja2l0eS1sYXp5bG9hZC1zcmNcIikscz10LmdldEF0dHJpYnV0ZShcImRhdGEtZmxpY2tpdHktbGF6eWxvYWQtc3Jjc2V0XCIpO2lmKGV8fG58fHMpcmV0dXJuW3RdfXZhciBvPVwiaW1nW2RhdGEtZmxpY2tpdHktbGF6eWxvYWRdLCBpbWdbZGF0YS1mbGlja2l0eS1sYXp5bG9hZC1zcmNdLCBpbWdbZGF0YS1mbGlja2l0eS1sYXp5bG9hZC1zcmNzZXRdXCIscj10LnF1ZXJ5U2VsZWN0b3JBbGwobyk7cmV0dXJuIGkubWFrZUFycmF5KHIpfWZ1bmN0aW9uIHModCxlKXt0aGlzLmltZz10LHRoaXMuZmxpY2tpdHk9ZSx0aGlzLmxvYWQoKX1lLmNyZWF0ZU1ldGhvZHMucHVzaChcIl9jcmVhdGVMYXp5bG9hZFwiKTt2YXIgbz1lLnByb3RvdHlwZTtyZXR1cm4gby5fY3JlYXRlTGF6eWxvYWQ9ZnVuY3Rpb24oKXt0aGlzLm9uKFwic2VsZWN0XCIsdGhpcy5sYXp5TG9hZCl9LG8ubGF6eUxvYWQ9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMubGF6eUxvYWQ7aWYodCl7dmFyIGU9XCJudW1iZXJcIj09dHlwZW9mIHQ/dDowLGk9dGhpcy5nZXRBZGphY2VudENlbGxFbGVtZW50cyhlKSxvPVtdO2kuZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgZT1uKHQpO289by5jb25jYXQoZSl9KSxvLmZvckVhY2goZnVuY3Rpb24odCl7bmV3IHModCx0aGlzKX0sdGhpcyl9fSxzLnByb3RvdHlwZS5oYW5kbGVFdmVudD1pLmhhbmRsZUV2ZW50LHMucHJvdG90eXBlLmxvYWQ9ZnVuY3Rpb24oKXt0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLHRoaXMpLHRoaXMuaW1nLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLHRoaXMpO3ZhciB0PXRoaXMuaW1nLmdldEF0dHJpYnV0ZShcImRhdGEtZmxpY2tpdHktbGF6eWxvYWRcIil8fHRoaXMuaW1nLmdldEF0dHJpYnV0ZShcImRhdGEtZmxpY2tpdHktbGF6eWxvYWQtc3JjXCIpLGU9dGhpcy5pbWcuZ2V0QXR0cmlidXRlKFwiZGF0YS1mbGlja2l0eS1sYXp5bG9hZC1zcmNzZXRcIik7dGhpcy5pbWcuc3JjPXQsZSYmdGhpcy5pbWcuc2V0QXR0cmlidXRlKFwic3Jjc2V0XCIsZSksdGhpcy5pbWcucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1mbGlja2l0eS1sYXp5bG9hZFwiKSx0aGlzLmltZy5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLWZsaWNraXR5LWxhenlsb2FkLXNyY1wiKSx0aGlzLmltZy5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLWZsaWNraXR5LWxhenlsb2FkLXNyY3NldFwiKX0scy5wcm90b3R5cGUub25sb2FkPWZ1bmN0aW9uKHQpe3RoaXMuY29tcGxldGUodCxcImZsaWNraXR5LWxhenlsb2FkZWRcIil9LHMucHJvdG90eXBlLm9uZXJyb3I9ZnVuY3Rpb24odCl7dGhpcy5jb21wbGV0ZSh0LFwiZmxpY2tpdHktbGF6eWVycm9yXCIpfSxzLnByb3RvdHlwZS5jb21wbGV0ZT1mdW5jdGlvbih0LGUpe3RoaXMuaW1nLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsdGhpcyksdGhpcy5pbWcucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsdGhpcyk7dmFyIGk9dGhpcy5mbGlja2l0eS5nZXRQYXJlbnRDZWxsKHRoaXMuaW1nKSxuPWkmJmkuZWxlbWVudDt0aGlzLmZsaWNraXR5LmNlbGxTaXplQ2hhbmdlKG4pLHRoaXMuaW1nLmNsYXNzTGlzdC5hZGQoZSksdGhpcy5mbGlja2l0eS5kaXNwYXRjaEV2ZW50KFwibGF6eUxvYWRcIix0LG4pfSxlLkxhenlMb2FkZXI9cyxlfSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiZmxpY2tpdHkvanMvaW5kZXhcIixbXCIuL2ZsaWNraXR5XCIsXCIuL2RyYWdcIixcIi4vcHJldi1uZXh0LWJ1dHRvblwiLFwiLi9wYWdlLWRvdHNcIixcIi4vcGxheWVyXCIsXCIuL2FkZC1yZW1vdmUtY2VsbFwiLFwiLi9sYXp5bG9hZFwiXSxlKTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cyYmKG1vZHVsZS5leHBvcnRzPWUocmVxdWlyZShcIi4vZmxpY2tpdHlcIikscmVxdWlyZShcIi4vZHJhZ1wiKSxyZXF1aXJlKFwiLi9wcmV2LW5leHQtYnV0dG9uXCIpLHJlcXVpcmUoXCIuL3BhZ2UtZG90c1wiKSxyZXF1aXJlKFwiLi9wbGF5ZXJcIikscmVxdWlyZShcIi4vYWRkLXJlbW92ZS1jZWxsXCIpLHJlcXVpcmUoXCIuL2xhenlsb2FkXCIpKSl9KHdpbmRvdyxmdW5jdGlvbih0KXtyZXR1cm4gdH0pLGZ1bmN0aW9uKHQsZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShcImZsaWNraXR5LWFzLW5hdi1mb3IvYXMtbmF2LWZvclwiLFtcImZsaWNraXR5L2pzL2luZGV4XCIsXCJmaXp6eS11aS11dGlscy91dGlsc1wiXSxlKTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lKHJlcXVpcmUoXCJmbGlja2l0eVwiKSxyZXF1aXJlKFwiZml6enktdWktdXRpbHNcIikpOnQuRmxpY2tpdHk9ZSh0LkZsaWNraXR5LHQuZml6enlVSVV0aWxzKX0od2luZG93LGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0LGUsaSl7cmV0dXJuKGUtdCkqaSt0fXQuY3JlYXRlTWV0aG9kcy5wdXNoKFwiX2NyZWF0ZUFzTmF2Rm9yXCIpO3ZhciBuPXQucHJvdG90eXBlO3JldHVybiBuLl9jcmVhdGVBc05hdkZvcj1mdW5jdGlvbigpe3RoaXMub24oXCJhY3RpdmF0ZVwiLHRoaXMuYWN0aXZhdGVBc05hdkZvciksdGhpcy5vbihcImRlYWN0aXZhdGVcIix0aGlzLmRlYWN0aXZhdGVBc05hdkZvciksdGhpcy5vbihcImRlc3Ryb3lcIix0aGlzLmRlc3Ryb3lBc05hdkZvcik7dmFyIHQ9dGhpcy5vcHRpb25zLmFzTmF2Rm9yO2lmKHQpe3ZhciBlPXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe2Uuc2V0TmF2Q29tcGFuaW9uKHQpfSl9fSxuLnNldE5hdkNvbXBhbmlvbj1mdW5jdGlvbihpKXtpPWUuZ2V0UXVlcnlFbGVtZW50KGkpO3ZhciBuPXQuZGF0YShpKTtpZihuJiZuIT10aGlzKXt0aGlzLm5hdkNvbXBhbmlvbj1uO3ZhciBzPXRoaXM7dGhpcy5vbk5hdkNvbXBhbmlvblNlbGVjdD1mdW5jdGlvbigpe3MubmF2Q29tcGFuaW9uU2VsZWN0KCl9LG4ub24oXCJzZWxlY3RcIix0aGlzLm9uTmF2Q29tcGFuaW9uU2VsZWN0KSx0aGlzLm9uKFwic3RhdGljQ2xpY2tcIix0aGlzLm9uTmF2U3RhdGljQ2xpY2spLHRoaXMubmF2Q29tcGFuaW9uU2VsZWN0KCEwKX19LG4ubmF2Q29tcGFuaW9uU2VsZWN0PWZ1bmN0aW9uKHQpe2lmKHRoaXMubmF2Q29tcGFuaW9uKXt2YXIgZT10aGlzLm5hdkNvbXBhbmlvbi5zZWxlY3RlZENlbGxzWzBdLG49dGhpcy5uYXZDb21wYW5pb24uY2VsbHMuaW5kZXhPZihlKSxzPW4rdGhpcy5uYXZDb21wYW5pb24uc2VsZWN0ZWRDZWxscy5sZW5ndGgtMSxvPU1hdGguZmxvb3IoaShuLHMsdGhpcy5uYXZDb21wYW5pb24uY2VsbEFsaWduKSk7aWYodGhpcy5zZWxlY3RDZWxsKG8sITEsdCksdGhpcy5yZW1vdmVOYXZTZWxlY3RlZEVsZW1lbnRzKCksIShvPj10aGlzLmNlbGxzLmxlbmd0aCkpe3ZhciByPXRoaXMuY2VsbHMuc2xpY2UobixzKzEpO3RoaXMubmF2U2VsZWN0ZWRFbGVtZW50cz1yLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdC5lbGVtZW50fSksdGhpcy5jaGFuZ2VOYXZTZWxlY3RlZENsYXNzKFwiYWRkXCIpfX19LG4uY2hhbmdlTmF2U2VsZWN0ZWRDbGFzcz1mdW5jdGlvbih0KXt0aGlzLm5hdlNlbGVjdGVkRWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbihlKXtlLmNsYXNzTGlzdFt0XShcImlzLW5hdi1zZWxlY3RlZFwiKX0pfSxuLmFjdGl2YXRlQXNOYXZGb3I9ZnVuY3Rpb24oKXt0aGlzLm5hdkNvbXBhbmlvblNlbGVjdCghMCl9LG4ucmVtb3ZlTmF2U2VsZWN0ZWRFbGVtZW50cz1mdW5jdGlvbigpe3RoaXMubmF2U2VsZWN0ZWRFbGVtZW50cyYmKHRoaXMuY2hhbmdlTmF2U2VsZWN0ZWRDbGFzcyhcInJlbW92ZVwiKSxkZWxldGUgdGhpcy5uYXZTZWxlY3RlZEVsZW1lbnRzKX0sbi5vbk5hdlN0YXRpY0NsaWNrPWZ1bmN0aW9uKHQsZSxpLG4pe1wibnVtYmVyXCI9PXR5cGVvZiBuJiZ0aGlzLm5hdkNvbXBhbmlvbi5zZWxlY3RDZWxsKG4pfSxuLmRlYWN0aXZhdGVBc05hdkZvcj1mdW5jdGlvbigpe3RoaXMucmVtb3ZlTmF2U2VsZWN0ZWRFbGVtZW50cygpfSxuLmRlc3Ryb3lBc05hdkZvcj1mdW5jdGlvbigpe3RoaXMubmF2Q29tcGFuaW9uJiYodGhpcy5uYXZDb21wYW5pb24ub2ZmKFwic2VsZWN0XCIsdGhpcy5vbk5hdkNvbXBhbmlvblNlbGVjdCksdGhpcy5vZmYoXCJzdGF0aWNDbGlja1wiLHRoaXMub25OYXZTdGF0aWNDbGljayksZGVsZXRlIHRoaXMubmF2Q29tcGFuaW9uKX0sdH0pLGZ1bmN0aW9uKHQsZSl7XCJ1c2Ugc3RyaWN0XCI7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShcImltYWdlc2xvYWRlZC9pbWFnZXNsb2FkZWRcIixbXCJldi1lbWl0dGVyL2V2LWVtaXR0ZXJcIl0sZnVuY3Rpb24oaSl7cmV0dXJuIGUodCxpKX0pOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUodCxyZXF1aXJlKFwiZXYtZW1pdHRlclwiKSk6dC5pbWFnZXNMb2FkZWQ9ZSh0LHQuRXZFbWl0dGVyKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dGhpcyxmdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkodCxlKXtmb3IodmFyIGkgaW4gZSl0W2ldPWVbaV07cmV0dXJuIHR9ZnVuY3Rpb24gbih0KXtpZihBcnJheS5pc0FycmF5KHQpKXJldHVybiB0O3ZhciBlPVwib2JqZWN0XCI9PXR5cGVvZiB0JiZcIm51bWJlclwiPT10eXBlb2YgdC5sZW5ndGg7cmV0dXJuIGU/aC5jYWxsKHQpOlt0XX1mdW5jdGlvbiBzKHQsZSxvKXtpZighKHRoaXMgaW5zdGFuY2VvZiBzKSlyZXR1cm4gbmV3IHModCxlLG8pO3ZhciByPXQ7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIHQmJihyPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodCkpLHI/KHRoaXMuZWxlbWVudHM9bihyKSx0aGlzLm9wdGlvbnM9aSh7fSx0aGlzLm9wdGlvbnMpLFwiZnVuY3Rpb25cIj09dHlwZW9mIGU/bz1lOmkodGhpcy5vcHRpb25zLGUpLG8mJnRoaXMub24oXCJhbHdheXNcIixvKSx0aGlzLmdldEltYWdlcygpLGEmJih0aGlzLmpxRGVmZXJyZWQ9bmV3IGEuRGVmZXJyZWQpLHZvaWQgc2V0VGltZW91dCh0aGlzLmNoZWNrLmJpbmQodGhpcykpKTp2b2lkIGwuZXJyb3IoXCJCYWQgZWxlbWVudCBmb3IgaW1hZ2VzTG9hZGVkIFwiKyhyfHx0KSl9ZnVuY3Rpb24gbyh0KXt0aGlzLmltZz10fWZ1bmN0aW9uIHIodCxlKXt0aGlzLnVybD10LHRoaXMuZWxlbWVudD1lLHRoaXMuaW1nPW5ldyBJbWFnZX12YXIgYT10LmpRdWVyeSxsPXQuY29uc29sZSxoPUFycmF5LnByb3RvdHlwZS5zbGljZTtzLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGUucHJvdG90eXBlKSxzLnByb3RvdHlwZS5vcHRpb25zPXt9LHMucHJvdG90eXBlLmdldEltYWdlcz1mdW5jdGlvbigpe3RoaXMuaW1hZ2VzPVtdLHRoaXMuZWxlbWVudHMuZm9yRWFjaCh0aGlzLmFkZEVsZW1lbnRJbWFnZXMsdGhpcyl9LHMucHJvdG90eXBlLmFkZEVsZW1lbnRJbWFnZXM9ZnVuY3Rpb24odCl7XCJJTUdcIj09dC5ub2RlTmFtZSYmdGhpcy5hZGRJbWFnZSh0KSx0aGlzLm9wdGlvbnMuYmFja2dyb3VuZD09PSEwJiZ0aGlzLmFkZEVsZW1lbnRCYWNrZ3JvdW5kSW1hZ2VzKHQpO3ZhciBlPXQubm9kZVR5cGU7aWYoZSYmY1tlXSl7Zm9yKHZhciBpPXQucXVlcnlTZWxlY3RvckFsbChcImltZ1wiKSxuPTA7bjxpLmxlbmd0aDtuKyspe3ZhciBzPWlbbl07dGhpcy5hZGRJbWFnZShzKX1pZihcInN0cmluZ1wiPT10eXBlb2YgdGhpcy5vcHRpb25zLmJhY2tncm91bmQpe3ZhciBvPXQucXVlcnlTZWxlY3RvckFsbCh0aGlzLm9wdGlvbnMuYmFja2dyb3VuZCk7Zm9yKG49MDtuPG8ubGVuZ3RoO24rKyl7dmFyIHI9b1tuXTt0aGlzLmFkZEVsZW1lbnRCYWNrZ3JvdW5kSW1hZ2VzKHIpfX19fTt2YXIgYz17MTohMCw5OiEwLDExOiEwfTtyZXR1cm4gcy5wcm90b3R5cGUuYWRkRWxlbWVudEJhY2tncm91bmRJbWFnZXM9ZnVuY3Rpb24odCl7dmFyIGU9Z2V0Q29tcHV0ZWRTdHlsZSh0KTtpZihlKWZvcih2YXIgaT0vdXJsXFwoKFsnXCJdKT8oLio/KVxcMVxcKS9naSxuPWkuZXhlYyhlLmJhY2tncm91bmRJbWFnZSk7bnVsbCE9PW47KXt2YXIgcz1uJiZuWzJdO3MmJnRoaXMuYWRkQmFja2dyb3VuZChzLHQpLG49aS5leGVjKGUuYmFja2dyb3VuZEltYWdlKX19LHMucHJvdG90eXBlLmFkZEltYWdlPWZ1bmN0aW9uKHQpe3ZhciBlPW5ldyBvKHQpO3RoaXMuaW1hZ2VzLnB1c2goZSl9LHMucHJvdG90eXBlLmFkZEJhY2tncm91bmQ9ZnVuY3Rpb24odCxlKXt2YXIgaT1uZXcgcih0LGUpO3RoaXMuaW1hZ2VzLnB1c2goaSl9LHMucHJvdG90eXBlLmNoZWNrPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGksbil7c2V0VGltZW91dChmdW5jdGlvbigpe2UucHJvZ3Jlc3ModCxpLG4pfSl9dmFyIGU9dGhpcztyZXR1cm4gdGhpcy5wcm9ncmVzc2VkQ291bnQ9MCx0aGlzLmhhc0FueUJyb2tlbj0hMSx0aGlzLmltYWdlcy5sZW5ndGg/dm9pZCB0aGlzLmltYWdlcy5mb3JFYWNoKGZ1bmN0aW9uKGUpe2Uub25jZShcInByb2dyZXNzXCIsdCksZS5jaGVjaygpfSk6dm9pZCB0aGlzLmNvbXBsZXRlKCl9LHMucHJvdG90eXBlLnByb2dyZXNzPWZ1bmN0aW9uKHQsZSxpKXt0aGlzLnByb2dyZXNzZWRDb3VudCsrLHRoaXMuaGFzQW55QnJva2VuPXRoaXMuaGFzQW55QnJva2VufHwhdC5pc0xvYWRlZCx0aGlzLmVtaXRFdmVudChcInByb2dyZXNzXCIsW3RoaXMsdCxlXSksdGhpcy5qcURlZmVycmVkJiZ0aGlzLmpxRGVmZXJyZWQubm90aWZ5JiZ0aGlzLmpxRGVmZXJyZWQubm90aWZ5KHRoaXMsdCksdGhpcy5wcm9ncmVzc2VkQ291bnQ9PXRoaXMuaW1hZ2VzLmxlbmd0aCYmdGhpcy5jb21wbGV0ZSgpLHRoaXMub3B0aW9ucy5kZWJ1ZyYmbCYmbC5sb2coXCJwcm9ncmVzczogXCIraSx0LGUpfSxzLnByb3RvdHlwZS5jb21wbGV0ZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMuaGFzQW55QnJva2VuP1wiZmFpbFwiOlwiZG9uZVwiO2lmKHRoaXMuaXNDb21wbGV0ZT0hMCx0aGlzLmVtaXRFdmVudCh0LFt0aGlzXSksdGhpcy5lbWl0RXZlbnQoXCJhbHdheXNcIixbdGhpc10pLHRoaXMuanFEZWZlcnJlZCl7dmFyIGU9dGhpcy5oYXNBbnlCcm9rZW4/XCJyZWplY3RcIjpcInJlc29sdmVcIjt0aGlzLmpxRGVmZXJyZWRbZV0odGhpcyl9fSxvLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGUucHJvdG90eXBlKSxvLnByb3RvdHlwZS5jaGVjaz1mdW5jdGlvbigpe3ZhciB0PXRoaXMuZ2V0SXNJbWFnZUNvbXBsZXRlKCk7cmV0dXJuIHQ/dm9pZCB0aGlzLmNvbmZpcm0oMCE9PXRoaXMuaW1nLm5hdHVyYWxXaWR0aCxcIm5hdHVyYWxXaWR0aFwiKToodGhpcy5wcm94eUltYWdlPW5ldyBJbWFnZSx0aGlzLnByb3h5SW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIix0aGlzKSx0aGlzLnByb3h5SW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsdGhpcyksdGhpcy5pbWcuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIix0aGlzKSx0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIix0aGlzKSx2b2lkKHRoaXMucHJveHlJbWFnZS5zcmM9dGhpcy5pbWcuc3JjKSl9LG8ucHJvdG90eXBlLmdldElzSW1hZ2VDb21wbGV0ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmltZy5jb21wbGV0ZSYmdGhpcy5pbWcubmF0dXJhbFdpZHRofSxvLnByb3RvdHlwZS5jb25maXJtPWZ1bmN0aW9uKHQsZSl7dGhpcy5pc0xvYWRlZD10LHRoaXMuZW1pdEV2ZW50KFwicHJvZ3Jlc3NcIixbdGhpcyx0aGlzLmltZyxlXSl9LG8ucHJvdG90eXBlLmhhbmRsZUV2ZW50PWZ1bmN0aW9uKHQpe3ZhciBlPVwib25cIit0LnR5cGU7dGhpc1tlXSYmdGhpc1tlXSh0KX0sby5wcm90b3R5cGUub25sb2FkPWZ1bmN0aW9uKCl7dGhpcy5jb25maXJtKCEwLFwib25sb2FkXCIpLHRoaXMudW5iaW5kRXZlbnRzKCl9LG8ucHJvdG90eXBlLm9uZXJyb3I9ZnVuY3Rpb24oKXt0aGlzLmNvbmZpcm0oITEsXCJvbmVycm9yXCIpLHRoaXMudW5iaW5kRXZlbnRzKCl9LG8ucHJvdG90eXBlLnVuYmluZEV2ZW50cz1mdW5jdGlvbigpe3RoaXMucHJveHlJbWFnZS5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZFwiLHRoaXMpLHRoaXMucHJveHlJbWFnZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiZXJyb3JcIix0aGlzKSx0aGlzLmltZy5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZFwiLHRoaXMpLHRoaXMuaW1nLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLHRoaXMpfSxyLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG8ucHJvdG90eXBlKSxyLnByb3RvdHlwZS5jaGVjaz1mdW5jdGlvbigpe3RoaXMuaW1nLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsdGhpcyksdGhpcy5pbWcuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsdGhpcyksdGhpcy5pbWcuc3JjPXRoaXMudXJsO3ZhciB0PXRoaXMuZ2V0SXNJbWFnZUNvbXBsZXRlKCk7dCYmKHRoaXMuY29uZmlybSgwIT09dGhpcy5pbWcubmF0dXJhbFdpZHRoLFwibmF0dXJhbFdpZHRoXCIpLHRoaXMudW5iaW5kRXZlbnRzKCkpfSxyLnByb3RvdHlwZS51bmJpbmRFdmVudHM9ZnVuY3Rpb24oKXt0aGlzLmltZy5yZW1vdmVFdmVudExpc3RlbmVyKFwibG9hZFwiLHRoaXMpLHRoaXMuaW1nLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLHRoaXMpfSxyLnByb3RvdHlwZS5jb25maXJtPWZ1bmN0aW9uKHQsZSl7dGhpcy5pc0xvYWRlZD10LHRoaXMuZW1pdEV2ZW50KFwicHJvZ3Jlc3NcIixbdGhpcyx0aGlzLmVsZW1lbnQsZV0pfSxzLm1ha2VKUXVlcnlQbHVnaW49ZnVuY3Rpb24oZSl7ZT1lfHx0LmpRdWVyeSxlJiYoYT1lLGEuZm4uaW1hZ2VzTG9hZGVkPWZ1bmN0aW9uKHQsZSl7dmFyIGk9bmV3IHModGhpcyx0LGUpO3JldHVybiBpLmpxRGVmZXJyZWQucHJvbWlzZShhKHRoaXMpKX0pfSxzLm1ha2VKUXVlcnlQbHVnaW4oKSxzfSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtcImZsaWNraXR5L2pzL2luZGV4XCIsXCJpbWFnZXNsb2FkZWQvaW1hZ2VzbG9hZGVkXCJdLGZ1bmN0aW9uKGksbil7cmV0dXJuIGUodCxpLG4pfSk6XCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZSh0LHJlcXVpcmUoXCJmbGlja2l0eVwiKSxyZXF1aXJlKFwiaW1hZ2VzbG9hZGVkXCIpKTp0LkZsaWNraXR5PWUodCx0LkZsaWNraXR5LHQuaW1hZ2VzTG9hZGVkKX0od2luZG93LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtlLmNyZWF0ZU1ldGhvZHMucHVzaChcIl9jcmVhdGVJbWFnZXNMb2FkZWRcIik7dmFyIG49ZS5wcm90b3R5cGU7cmV0dXJuIG4uX2NyZWF0ZUltYWdlc0xvYWRlZD1mdW5jdGlvbigpe3RoaXMub24oXCJhY3RpdmF0ZVwiLHRoaXMuaW1hZ2VzTG9hZGVkKX0sbi5pbWFnZXNMb2FkZWQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsaSl7dmFyIG49ZS5nZXRQYXJlbnRDZWxsKGkuaW1nKTtlLmNlbGxTaXplQ2hhbmdlKG4mJm4uZWxlbWVudCksZS5vcHRpb25zLmZyZWVTY3JvbGx8fGUucG9zaXRpb25TbGlkZXJBdFNlbGVjdGVkKCl9aWYodGhpcy5vcHRpb25zLmltYWdlc0xvYWRlZCl7dmFyIGU9dGhpcztpKHRoaXMuc2xpZGVyKS5vbihcInByb2dyZXNzXCIsdCl9fSxlfSk7IiwiKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcblx0dHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOlxuXHR0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOlxuXHQoZ2xvYmFsLklNYXNrID0gZmFjdG9yeSgpKTtcbn0odGhpcywgKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4vLyA3LjIuMSBSZXF1aXJlT2JqZWN0Q29lcmNpYmxlKGFyZ3VtZW50KVxudmFyIF9kZWZpbmVkID0gZnVuY3Rpb24gKGl0KSB7XG4gIGlmIChpdCA9PSB1bmRlZmluZWQpIHRocm93IFR5cGVFcnJvcihcIkNhbid0IGNhbGwgbWV0aG9kIG9uICBcIiArIGl0KTtcbiAgcmV0dXJuIGl0O1xufTtcblxuLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KVxuXG52YXIgX3RvT2JqZWN0ID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBPYmplY3QoX2RlZmluZWQoaXQpKTtcbn07XG5cbnZhciBoYXNPd25Qcm9wZXJ0eSA9IHt9Lmhhc093blByb3BlcnR5O1xudmFyIF9oYXMgPSBmdW5jdGlvbiAoaXQsIGtleSkge1xuICByZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChpdCwga2V5KTtcbn07XG5cbnZhciB0b1N0cmluZyA9IHt9LnRvU3RyaW5nO1xuXG52YXIgX2NvZiA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpO1xufTtcblxuLy8gZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBhbmQgbm9uLWVudW1lcmFibGUgb2xkIFY4IHN0cmluZ3NcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXByb3RvdHlwZS1idWlsdGluc1xudmFyIF9pb2JqZWN0ID0gT2JqZWN0KCd6JykucHJvcGVydHlJc0VudW1lcmFibGUoMCkgPyBPYmplY3QgOiBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIF9jb2YoaXQpID09ICdTdHJpbmcnID8gaXQuc3BsaXQoJycpIDogT2JqZWN0KGl0KTtcbn07XG5cbi8vIHRvIGluZGV4ZWQgb2JqZWN0LCB0b09iamVjdCB3aXRoIGZhbGxiYWNrIGZvciBub24tYXJyYXktbGlrZSBFUzMgc3RyaW5nc1xuXG5cbnZhciBfdG9Jb2JqZWN0ID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBfaW9iamVjdChfZGVmaW5lZChpdCkpO1xufTtcblxuLy8gNy4xLjQgVG9JbnRlZ2VyXG52YXIgY2VpbCA9IE1hdGguY2VpbDtcbnZhciBmbG9vciA9IE1hdGguZmxvb3I7XG52YXIgX3RvSW50ZWdlciA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gaXNOYU4oaXQgPSAraXQpID8gMCA6IChpdCA+IDAgPyBmbG9vciA6IGNlaWwpKGl0KTtcbn07XG5cbi8vIDcuMS4xNSBUb0xlbmd0aFxuXG52YXIgbWluID0gTWF0aC5taW47XG52YXIgX3RvTGVuZ3RoID0gZnVuY3Rpb24gKGl0KSB7XG4gIHJldHVybiBpdCA+IDAgPyBtaW4oX3RvSW50ZWdlcihpdCksIDB4MWZmZmZmZmZmZmZmZmYpIDogMDsgLy8gcG93KDIsIDUzKSAtIDEgPT0gOTAwNzE5OTI1NDc0MDk5MVxufTtcblxudmFyIG1heCA9IE1hdGgubWF4O1xudmFyIG1pbiQxID0gTWF0aC5taW47XG52YXIgX3RvQWJzb2x1dGVJbmRleCA9IGZ1bmN0aW9uIChpbmRleCwgbGVuZ3RoKSB7XG4gIGluZGV4ID0gX3RvSW50ZWdlcihpbmRleCk7XG4gIHJldHVybiBpbmRleCA8IDAgPyBtYXgoaW5kZXggKyBsZW5ndGgsIDApIDogbWluJDEoaW5kZXgsIGxlbmd0aCk7XG59O1xuXG4vLyBmYWxzZSAtPiBBcnJheSNpbmRleE9mXG4vLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlc1xuXG5cblxudmFyIF9hcnJheUluY2x1ZGVzID0gZnVuY3Rpb24gKElTX0lOQ0xVREVTKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoJHRoaXMsIGVsLCBmcm9tSW5kZXgpIHtcbiAgICB2YXIgTyA9IF90b0lvYmplY3QoJHRoaXMpO1xuICAgIHZhciBsZW5ndGggPSBfdG9MZW5ndGgoTy5sZW5ndGgpO1xuICAgIHZhciBpbmRleCA9IF90b0Fic29sdXRlSW5kZXgoZnJvbUluZGV4LCBsZW5ndGgpO1xuICAgIHZhciB2YWx1ZTtcbiAgICAvLyBBcnJheSNpbmNsdWRlcyB1c2VzIFNhbWVWYWx1ZVplcm8gZXF1YWxpdHkgYWxnb3JpdGhtXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNlbGYtY29tcGFyZVxuICAgIGlmIChJU19JTkNMVURFUyAmJiBlbCAhPSBlbCkgd2hpbGUgKGxlbmd0aCA+IGluZGV4KSB7XG4gICAgICB2YWx1ZSA9IE9baW5kZXgrK107XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tc2VsZi1jb21wYXJlXG4gICAgICBpZiAodmFsdWUgIT0gdmFsdWUpIHJldHVybiB0cnVlO1xuICAgIC8vIEFycmF5I2luZGV4T2YgaWdub3JlcyBob2xlcywgQXJyYXkjaW5jbHVkZXMgLSBub3RcbiAgICB9IGVsc2UgZm9yICg7bGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIGlmIChJU19JTkNMVURFUyB8fCBpbmRleCBpbiBPKSB7XG4gICAgICBpZiAoT1tpbmRleF0gPT09IGVsKSByZXR1cm4gSVNfSU5DTFVERVMgfHwgaW5kZXggfHwgMDtcbiAgICB9IHJldHVybiAhSVNfSU5DTFVERVMgJiYgLTE7XG4gIH07XG59O1xuXG5mdW5jdGlvbiBjcmVhdGVDb21tb25qc01vZHVsZShmbiwgbW9kdWxlKSB7XG5cdHJldHVybiBtb2R1bGUgPSB7IGV4cG9ydHM6IHt9IH0sIGZuKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMpLCBtb2R1bGUuZXhwb3J0cztcbn1cblxudmFyIF9nbG9iYWwgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7XG4vLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOFxudmFyIGdsb2JhbCA9IG1vZHVsZS5leHBvcnRzID0gdHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoXG4gID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1uZXctZnVuY1xuICA6IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5pZiAodHlwZW9mIF9fZyA9PSAnbnVtYmVyJykgX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG59KTtcblxudmFyIFNIQVJFRCA9ICdfX2NvcmUtanNfc2hhcmVkX18nO1xudmFyIHN0b3JlID0gX2dsb2JhbFtTSEFSRURdIHx8IChfZ2xvYmFsW1NIQVJFRF0gPSB7fSk7XG52YXIgX3NoYXJlZCA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgcmV0dXJuIHN0b3JlW2tleV0gfHwgKHN0b3JlW2tleV0gPSB7fSk7XG59O1xuXG52YXIgaWQgPSAwO1xudmFyIHB4ID0gTWF0aC5yYW5kb20oKTtcbnZhciBfdWlkID0gZnVuY3Rpb24gKGtleSkge1xuICByZXR1cm4gJ1N5bWJvbCgnLmNvbmNhdChrZXkgPT09IHVuZGVmaW5lZCA/ICcnIDoga2V5LCAnKV8nLCAoKytpZCArIHB4KS50b1N0cmluZygzNikpO1xufTtcblxudmFyIHNoYXJlZCA9IF9zaGFyZWQoJ2tleXMnKTtcblxudmFyIF9zaGFyZWRLZXkgPSBmdW5jdGlvbiAoa2V5KSB7XG4gIHJldHVybiBzaGFyZWRba2V5XSB8fCAoc2hhcmVkW2tleV0gPSBfdWlkKGtleSkpO1xufTtcblxudmFyIGFycmF5SW5kZXhPZiA9IF9hcnJheUluY2x1ZGVzKGZhbHNlKTtcbnZhciBJRV9QUk9UTyA9IF9zaGFyZWRLZXkoJ0lFX1BST1RPJyk7XG5cbnZhciBfb2JqZWN0S2V5c0ludGVybmFsID0gZnVuY3Rpb24gKG9iamVjdCwgbmFtZXMpIHtcbiAgdmFyIE8gPSBfdG9Jb2JqZWN0KG9iamVjdCk7XG4gIHZhciBpID0gMDtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICB2YXIga2V5O1xuICBmb3IgKGtleSBpbiBPKSBpZiAoa2V5ICE9IElFX1BST1RPKSBfaGFzKE8sIGtleSkgJiYgcmVzdWx0LnB1c2goa2V5KTtcbiAgLy8gRG9uJ3QgZW51bSBidWcgJiBoaWRkZW4ga2V5c1xuICB3aGlsZSAobmFtZXMubGVuZ3RoID4gaSkgaWYgKF9oYXMoTywga2V5ID0gbmFtZXNbaSsrXSkpIHtcbiAgICB+YXJyYXlJbmRleE9mKHJlc3VsdCwga2V5KSB8fCByZXN1bHQucHVzaChrZXkpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG4vLyBJRSA4LSBkb24ndCBlbnVtIGJ1ZyBrZXlzXG52YXIgX2VudW1CdWdLZXlzID0gKFxuICAnY29uc3RydWN0b3IsaGFzT3duUHJvcGVydHksaXNQcm90b3R5cGVPZixwcm9wZXJ0eUlzRW51bWVyYWJsZSx0b0xvY2FsZVN0cmluZyx0b1N0cmluZyx2YWx1ZU9mJ1xuKS5zcGxpdCgnLCcpO1xuXG4vLyAxOS4xLjIuMTQgLyAxNS4yLjMuMTQgT2JqZWN0LmtleXMoTylcblxuXG5cbnZhciBfb2JqZWN0S2V5cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIGtleXMoTykge1xuICByZXR1cm4gX29iamVjdEtleXNJbnRlcm5hbChPLCBfZW51bUJ1Z0tleXMpO1xufTtcblxudmFyIF9jb3JlID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSkge1xudmFyIGNvcmUgPSBtb2R1bGUuZXhwb3J0cyA9IHsgdmVyc2lvbjogJzIuNS4zJyB9O1xuaWYgKHR5cGVvZiBfX2UgPT0gJ251bWJlcicpIF9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcbn0pO1xuXG52YXIgX2NvcmVfMSA9IF9jb3JlLnZlcnNpb247XG5cbnZhciBfaXNPYmplY3QgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIHR5cGVvZiBpdCA9PT0gJ29iamVjdCcgPyBpdCAhPT0gbnVsbCA6IHR5cGVvZiBpdCA9PT0gJ2Z1bmN0aW9uJztcbn07XG5cbnZhciBfYW5PYmplY3QgPSBmdW5jdGlvbiAoaXQpIHtcbiAgaWYgKCFfaXNPYmplY3QoaXQpKSB0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhbiBvYmplY3QhJyk7XG4gIHJldHVybiBpdDtcbn07XG5cbnZhciBfZmFpbHMgPSBmdW5jdGlvbiAoZXhlYykge1xuICB0cnkge1xuICAgIHJldHVybiAhIWV4ZWMoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59O1xuXG4vLyBUaGFuaydzIElFOCBmb3IgaGlzIGZ1bm55IGRlZmluZVByb3BlcnR5XG52YXIgX2Rlc2NyaXB0b3JzID0gIV9mYWlscyhmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdhJywgeyBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDc7IH0gfSkuYSAhPSA3O1xufSk7XG5cbnZhciBkb2N1bWVudCQxID0gX2dsb2JhbC5kb2N1bWVudDtcbi8vIHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFbGVtZW50IGlzICdvYmplY3QnIGluIG9sZCBJRVxudmFyIGlzID0gX2lzT2JqZWN0KGRvY3VtZW50JDEpICYmIF9pc09iamVjdChkb2N1bWVudCQxLmNyZWF0ZUVsZW1lbnQpO1xudmFyIF9kb21DcmVhdGUgPSBmdW5jdGlvbiAoaXQpIHtcbiAgcmV0dXJuIGlzID8gZG9jdW1lbnQkMS5jcmVhdGVFbGVtZW50KGl0KSA6IHt9O1xufTtcblxudmFyIF9pZThEb21EZWZpbmUgPSAhX2Rlc2NyaXB0b3JzICYmICFfZmFpbHMoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KF9kb21DcmVhdGUoJ2RpdicpLCAnYScsIHsgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiA3OyB9IH0pLmEgIT0gNztcbn0pO1xuXG4vLyA3LjEuMSBUb1ByaW1pdGl2ZShpbnB1dCBbLCBQcmVmZXJyZWRUeXBlXSlcblxuLy8gaW5zdGVhZCBvZiB0aGUgRVM2IHNwZWMgdmVyc2lvbiwgd2UgZGlkbid0IGltcGxlbWVudCBAQHRvUHJpbWl0aXZlIGNhc2Vcbi8vIGFuZCB0aGUgc2Vjb25kIGFyZ3VtZW50IC0gZmxhZyAtIHByZWZlcnJlZCB0eXBlIGlzIGEgc3RyaW5nXG52YXIgX3RvUHJpbWl0aXZlID0gZnVuY3Rpb24gKGl0LCBTKSB7XG4gIGlmICghX2lzT2JqZWN0KGl0KSkgcmV0dXJuIGl0O1xuICB2YXIgZm4sIHZhbDtcbiAgaWYgKFMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFfaXNPYmplY3QodmFsID0gZm4uY2FsbChpdCkpKSByZXR1cm4gdmFsO1xuICBpZiAodHlwZW9mIChmbiA9IGl0LnZhbHVlT2YpID09ICdmdW5jdGlvbicgJiYgIV9pc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpIHJldHVybiB2YWw7XG4gIGlmICghUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIV9pc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpIHJldHVybiB2YWw7XG4gIHRocm93IFR5cGVFcnJvcihcIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZVwiKTtcbn07XG5cbnZhciBkUCA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcblxudmFyIGYgPSBfZGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydHkgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKSB7XG4gIF9hbk9iamVjdChPKTtcbiAgUCA9IF90b1ByaW1pdGl2ZShQLCB0cnVlKTtcbiAgX2FuT2JqZWN0KEF0dHJpYnV0ZXMpO1xuICBpZiAoX2llOERvbURlZmluZSkgdHJ5IHtcbiAgICByZXR1cm4gZFAoTywgUCwgQXR0cmlidXRlcyk7XG4gIH0gY2F0Y2ggKGUpIHsgLyogZW1wdHkgKi8gfVxuICBpZiAoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKSB0aHJvdyBUeXBlRXJyb3IoJ0FjY2Vzc29ycyBub3Qgc3VwcG9ydGVkIScpO1xuICBpZiAoJ3ZhbHVlJyBpbiBBdHRyaWJ1dGVzKSBPW1BdID0gQXR0cmlidXRlcy52YWx1ZTtcbiAgcmV0dXJuIE87XG59O1xuXG52YXIgX29iamVjdERwID0ge1xuXHRmOiBmXG59O1xuXG52YXIgX3Byb3BlcnR5RGVzYyA9IGZ1bmN0aW9uIChiaXRtYXAsIHZhbHVlKSB7XG4gIHJldHVybiB7XG4gICAgZW51bWVyYWJsZTogIShiaXRtYXAgJiAxKSxcbiAgICBjb25maWd1cmFibGU6ICEoYml0bWFwICYgMiksXG4gICAgd3JpdGFibGU6ICEoYml0bWFwICYgNCksXG4gICAgdmFsdWU6IHZhbHVlXG4gIH07XG59O1xuXG52YXIgX2hpZGUgPSBfZGVzY3JpcHRvcnMgPyBmdW5jdGlvbiAob2JqZWN0LCBrZXksIHZhbHVlKSB7XG4gIHJldHVybiBfb2JqZWN0RHAuZihvYmplY3QsIGtleSwgX3Byb3BlcnR5RGVzYygxLCB2YWx1ZSkpO1xufSA6IGZ1bmN0aW9uIChvYmplY3QsIGtleSwgdmFsdWUpIHtcbiAgb2JqZWN0W2tleV0gPSB2YWx1ZTtcbiAgcmV0dXJuIG9iamVjdDtcbn07XG5cbnZhciBfcmVkZWZpbmUgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7XG52YXIgU1JDID0gX3VpZCgnc3JjJyk7XG52YXIgVE9fU1RSSU5HID0gJ3RvU3RyaW5nJztcbnZhciAkdG9TdHJpbmcgPSBGdW5jdGlvbltUT19TVFJJTkddO1xudmFyIFRQTCA9ICgnJyArICR0b1N0cmluZykuc3BsaXQoVE9fU1RSSU5HKTtcblxuX2NvcmUuaW5zcGVjdFNvdXJjZSA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gJHRvU3RyaW5nLmNhbGwoaXQpO1xufTtcblxuKG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKE8sIGtleSwgdmFsLCBzYWZlKSB7XG4gIHZhciBpc0Z1bmN0aW9uID0gdHlwZW9mIHZhbCA9PSAnZnVuY3Rpb24nO1xuICBpZiAoaXNGdW5jdGlvbikgX2hhcyh2YWwsICduYW1lJykgfHwgX2hpZGUodmFsLCAnbmFtZScsIGtleSk7XG4gIGlmIChPW2tleV0gPT09IHZhbCkgcmV0dXJuO1xuICBpZiAoaXNGdW5jdGlvbikgX2hhcyh2YWwsIFNSQykgfHwgX2hpZGUodmFsLCBTUkMsIE9ba2V5XSA/ICcnICsgT1trZXldIDogVFBMLmpvaW4oU3RyaW5nKGtleSkpKTtcbiAgaWYgKE8gPT09IF9nbG9iYWwpIHtcbiAgICBPW2tleV0gPSB2YWw7XG4gIH0gZWxzZSBpZiAoIXNhZmUpIHtcbiAgICBkZWxldGUgT1trZXldO1xuICAgIF9oaWRlKE8sIGtleSwgdmFsKTtcbiAgfSBlbHNlIGlmIChPW2tleV0pIHtcbiAgICBPW2tleV0gPSB2YWw7XG4gIH0gZWxzZSB7XG4gICAgX2hpZGUoTywga2V5LCB2YWwpO1xuICB9XG4vLyBhZGQgZmFrZSBGdW5jdGlvbiN0b1N0cmluZyBmb3IgY29ycmVjdCB3b3JrIHdyYXBwZWQgbWV0aG9kcyAvIGNvbnN0cnVjdG9ycyB3aXRoIG1ldGhvZHMgbGlrZSBMb0Rhc2ggaXNOYXRpdmVcbn0pKEZ1bmN0aW9uLnByb3RvdHlwZSwgVE9fU1RSSU5HLCBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgcmV0dXJuIHR5cGVvZiB0aGlzID09ICdmdW5jdGlvbicgJiYgdGhpc1tTUkNdIHx8ICR0b1N0cmluZy5jYWxsKHRoaXMpO1xufSk7XG59KTtcblxudmFyIF9hRnVuY3Rpb24gPSBmdW5jdGlvbiAoaXQpIHtcbiAgaWYgKHR5cGVvZiBpdCAhPSAnZnVuY3Rpb24nKSB0aHJvdyBUeXBlRXJyb3IoaXQgKyAnIGlzIG5vdCBhIGZ1bmN0aW9uIScpO1xuICByZXR1cm4gaXQ7XG59O1xuXG4vLyBvcHRpb25hbCAvIHNpbXBsZSBjb250ZXh0IGJpbmRpbmdcblxudmFyIF9jdHggPSBmdW5jdGlvbiAoZm4sIHRoYXQsIGxlbmd0aCkge1xuICBfYUZ1bmN0aW9uKGZuKTtcbiAgaWYgKHRoYXQgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZuO1xuICBzd2l0Y2ggKGxlbmd0aCkge1xuICAgIGNhc2UgMTogcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhKTtcbiAgICB9O1xuICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiKTtcbiAgICB9O1xuICAgIGNhc2UgMzogcmV0dXJuIGZ1bmN0aW9uIChhLCBiLCBjKSB7XG4gICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhLCBiLCBjKTtcbiAgICB9O1xuICB9XG4gIHJldHVybiBmdW5jdGlvbiAoLyogLi4uYXJncyAqLykge1xuICAgIHJldHVybiBmbi5hcHBseSh0aGF0LCBhcmd1bWVudHMpO1xuICB9O1xufTtcblxudmFyIFBST1RPVFlQRSA9ICdwcm90b3R5cGUnO1xuXG52YXIgJGV4cG9ydCA9IGZ1bmN0aW9uICh0eXBlLCBuYW1lLCBzb3VyY2UpIHtcbiAgdmFyIElTX0ZPUkNFRCA9IHR5cGUgJiAkZXhwb3J0LkY7XG4gIHZhciBJU19HTE9CQUwgPSB0eXBlICYgJGV4cG9ydC5HO1xuICB2YXIgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuUztcbiAgdmFyIElTX1BST1RPID0gdHlwZSAmICRleHBvcnQuUDtcbiAgdmFyIElTX0JJTkQgPSB0eXBlICYgJGV4cG9ydC5CO1xuICB2YXIgdGFyZ2V0ID0gSVNfR0xPQkFMID8gX2dsb2JhbCA6IElTX1NUQVRJQyA/IF9nbG9iYWxbbmFtZV0gfHwgKF9nbG9iYWxbbmFtZV0gPSB7fSkgOiAoX2dsb2JhbFtuYW1lXSB8fCB7fSlbUFJPVE9UWVBFXTtcbiAgdmFyIGV4cG9ydHMgPSBJU19HTE9CQUwgPyBfY29yZSA6IF9jb3JlW25hbWVdIHx8IChfY29yZVtuYW1lXSA9IHt9KTtcbiAgdmFyIGV4cFByb3RvID0gZXhwb3J0c1tQUk9UT1RZUEVdIHx8IChleHBvcnRzW1BST1RPVFlQRV0gPSB7fSk7XG4gIHZhciBrZXksIG93biwgb3V0LCBleHA7XG4gIGlmIChJU19HTE9CQUwpIHNvdXJjZSA9IG5hbWU7XG4gIGZvciAoa2V5IGluIHNvdXJjZSkge1xuICAgIC8vIGNvbnRhaW5zIGluIG5hdGl2ZVxuICAgIG93biA9ICFJU19GT1JDRUQgJiYgdGFyZ2V0ICYmIHRhcmdldFtrZXldICE9PSB1bmRlZmluZWQ7XG4gICAgLy8gZXhwb3J0IG5hdGl2ZSBvciBwYXNzZWRcbiAgICBvdXQgPSAob3duID8gdGFyZ2V0IDogc291cmNlKVtrZXldO1xuICAgIC8vIGJpbmQgdGltZXJzIHRvIGdsb2JhbCBmb3IgY2FsbCBmcm9tIGV4cG9ydCBjb250ZXh0XG4gICAgZXhwID0gSVNfQklORCAmJiBvd24gPyBfY3R4KG91dCwgX2dsb2JhbCkgOiBJU19QUk9UTyAmJiB0eXBlb2Ygb3V0ID09ICdmdW5jdGlvbicgPyBfY3R4KEZ1bmN0aW9uLmNhbGwsIG91dCkgOiBvdXQ7XG4gICAgLy8gZXh0ZW5kIGdsb2JhbFxuICAgIGlmICh0YXJnZXQpIF9yZWRlZmluZSh0YXJnZXQsIGtleSwgb3V0LCB0eXBlICYgJGV4cG9ydC5VKTtcbiAgICAvLyBleHBvcnRcbiAgICBpZiAoZXhwb3J0c1trZXldICE9IG91dCkgX2hpZGUoZXhwb3J0cywga2V5LCBleHApO1xuICAgIGlmIChJU19QUk9UTyAmJiBleHBQcm90b1trZXldICE9IG91dCkgZXhwUHJvdG9ba2V5XSA9IG91dDtcbiAgfVxufTtcbl9nbG9iYWwuY29yZSA9IF9jb3JlO1xuLy8gdHlwZSBiaXRtYXBcbiRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkXG4kZXhwb3J0LkcgPSAyOyAgIC8vIGdsb2JhbFxuJGV4cG9ydC5TID0gNDsgICAvLyBzdGF0aWNcbiRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG9cbiRleHBvcnQuQiA9IDE2OyAgLy8gYmluZFxuJGV4cG9ydC5XID0gMzI7ICAvLyB3cmFwXG4kZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmVcbiRleHBvcnQuUiA9IDEyODsgLy8gcmVhbCBwcm90byBtZXRob2QgZm9yIGBsaWJyYXJ5YFxudmFyIF9leHBvcnQgPSAkZXhwb3J0O1xuXG4vLyBtb3N0IE9iamVjdCBtZXRob2RzIGJ5IEVTNiBzaG91bGQgYWNjZXB0IHByaW1pdGl2ZXNcblxuXG5cbnZhciBfb2JqZWN0U2FwID0gZnVuY3Rpb24gKEtFWSwgZXhlYykge1xuICB2YXIgZm4gPSAoX2NvcmUuT2JqZWN0IHx8IHt9KVtLRVldIHx8IE9iamVjdFtLRVldO1xuICB2YXIgZXhwID0ge307XG4gIGV4cFtLRVldID0gZXhlYyhmbik7XG4gIF9leHBvcnQoX2V4cG9ydC5TICsgX2V4cG9ydC5GICogX2ZhaWxzKGZ1bmN0aW9uICgpIHsgZm4oMSk7IH0pLCAnT2JqZWN0JywgZXhwKTtcbn07XG5cbi8vIDE5LjEuMi4xNCBPYmplY3Qua2V5cyhPKVxuXG5cblxuX29iamVjdFNhcCgna2V5cycsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGtleXMoaXQpIHtcbiAgICByZXR1cm4gX29iamVjdEtleXMoX3RvT2JqZWN0KGl0KSk7XG4gIH07XG59KTtcblxudmFyIGtleXMgPSBfY29yZS5PYmplY3Qua2V5cztcblxudmFyIF9zdHJpbmdSZXBlYXQgPSBmdW5jdGlvbiByZXBlYXQoY291bnQpIHtcbiAgdmFyIHN0ciA9IFN0cmluZyhfZGVmaW5lZCh0aGlzKSk7XG4gIHZhciByZXMgPSAnJztcbiAgdmFyIG4gPSBfdG9JbnRlZ2VyKGNvdW50KTtcbiAgaWYgKG4gPCAwIHx8IG4gPT0gSW5maW5pdHkpIHRocm93IFJhbmdlRXJyb3IoXCJDb3VudCBjYW4ndCBiZSBuZWdhdGl2ZVwiKTtcbiAgZm9yICg7biA+IDA7IChuID4+Pj0gMSkgJiYgKHN0ciArPSBzdHIpKSBpZiAobiAmIDEpIHJlcyArPSBzdHI7XG4gIHJldHVybiByZXM7XG59O1xuXG5fZXhwb3J0KF9leHBvcnQuUCwgJ1N0cmluZycsIHtcbiAgLy8gMjEuMS4zLjEzIFN0cmluZy5wcm90b3R5cGUucmVwZWF0KGNvdW50KVxuICByZXBlYXQ6IF9zdHJpbmdSZXBlYXRcbn0pO1xuXG52YXIgcmVwZWF0JDEgPSBfY29yZS5TdHJpbmcucmVwZWF0O1xuXG4vLyBodHRwczovL2dpdGh1Yi5jb20vdGMzOS9wcm9wb3NhbC1zdHJpbmctcGFkLXN0YXJ0LWVuZFxuXG5cblxuXG52YXIgX3N0cmluZ1BhZCA9IGZ1bmN0aW9uICh0aGF0LCBtYXhMZW5ndGgsIGZpbGxTdHJpbmcsIGxlZnQpIHtcbiAgdmFyIFMgPSBTdHJpbmcoX2RlZmluZWQodGhhdCkpO1xuICB2YXIgc3RyaW5nTGVuZ3RoID0gUy5sZW5ndGg7XG4gIHZhciBmaWxsU3RyID0gZmlsbFN0cmluZyA9PT0gdW5kZWZpbmVkID8gJyAnIDogU3RyaW5nKGZpbGxTdHJpbmcpO1xuICB2YXIgaW50TWF4TGVuZ3RoID0gX3RvTGVuZ3RoKG1heExlbmd0aCk7XG4gIGlmIChpbnRNYXhMZW5ndGggPD0gc3RyaW5nTGVuZ3RoIHx8IGZpbGxTdHIgPT0gJycpIHJldHVybiBTO1xuICB2YXIgZmlsbExlbiA9IGludE1heExlbmd0aCAtIHN0cmluZ0xlbmd0aDtcbiAgdmFyIHN0cmluZ0ZpbGxlciA9IF9zdHJpbmdSZXBlYXQuY2FsbChmaWxsU3RyLCBNYXRoLmNlaWwoZmlsbExlbiAvIGZpbGxTdHIubGVuZ3RoKSk7XG4gIGlmIChzdHJpbmdGaWxsZXIubGVuZ3RoID4gZmlsbExlbikgc3RyaW5nRmlsbGVyID0gc3RyaW5nRmlsbGVyLnNsaWNlKDAsIGZpbGxMZW4pO1xuICByZXR1cm4gbGVmdCA/IHN0cmluZ0ZpbGxlciArIFMgOiBTICsgc3RyaW5nRmlsbGVyO1xufTtcblxudmFyIG5hdmlnYXRvciA9IF9nbG9iYWwubmF2aWdhdG9yO1xuXG52YXIgX3VzZXJBZ2VudCA9IG5hdmlnYXRvciAmJiBuYXZpZ2F0b3IudXNlckFnZW50IHx8ICcnO1xuXG4vLyBodHRwczovL2dpdGh1Yi5jb20vdGMzOS9wcm9wb3NhbC1zdHJpbmctcGFkLXN0YXJ0LWVuZFxuXG5cblxuXG4vLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvMjgwXG5fZXhwb3J0KF9leHBvcnQuUCArIF9leHBvcnQuRiAqIC9WZXJzaW9uXFwvMTBcXC5cXGQrKFxcLlxcZCspPyBTYWZhcmlcXC8vLnRlc3QoX3VzZXJBZ2VudCksICdTdHJpbmcnLCB7XG4gIHBhZFN0YXJ0OiBmdW5jdGlvbiBwYWRTdGFydChtYXhMZW5ndGggLyogLCBmaWxsU3RyaW5nID0gJyAnICovKSB7XG4gICAgcmV0dXJuIF9zdHJpbmdQYWQodGhpcywgbWF4TGVuZ3RoLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCwgdHJ1ZSk7XG4gIH1cbn0pO1xuXG52YXIgcGFkU3RhcnQgPSBfY29yZS5TdHJpbmcucGFkU3RhcnQ7XG5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLXN0cmluZy1wYWQtc3RhcnQtZW5kXG5cblxuXG5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy8yODBcbl9leHBvcnQoX2V4cG9ydC5QICsgX2V4cG9ydC5GICogL1ZlcnNpb25cXC8xMFxcLlxcZCsoXFwuXFxkKyk/IFNhZmFyaVxcLy8udGVzdChfdXNlckFnZW50KSwgJ1N0cmluZycsIHtcbiAgcGFkRW5kOiBmdW5jdGlvbiBwYWRFbmQobWF4TGVuZ3RoIC8qICwgZmlsbFN0cmluZyA9ICcgJyAqLykge1xuICAgIHJldHVybiBfc3RyaW5nUGFkKHRoaXMsIG1heExlbmd0aCwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQsIGZhbHNlKTtcbiAgfVxufSk7XG5cbnZhciBwYWRFbmQgPSBfY29yZS5TdHJpbmcucGFkRW5kO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gdHlwZW9mIG9iajtcbn0gOiBmdW5jdGlvbiAob2JqKSB7XG4gIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqO1xufTtcblxuXG5cblxuXG5cblxuXG5cblxuXG52YXIgY2xhc3NDYWxsQ2hlY2sgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG4gIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcbiAgfVxufTtcblxudmFyIGNyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO1xuICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykge1xuICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7XG4gICAgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7XG4gICAgcmV0dXJuIENvbnN0cnVjdG9yO1xuICB9O1xufSgpO1xuXG5cblxuXG5cblxuXG52YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuXG4gICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGFyZ2V0O1xufTtcblxudmFyIGdldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikge1xuICBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7XG4gIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTtcblxuICBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpO1xuXG4gICAgaWYgKHBhcmVudCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7XG4gICAgfVxuICB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7XG4gICAgcmV0dXJuIGRlc2MudmFsdWU7XG4gIH0gZWxzZSB7XG4gICAgdmFyIGdldHRlciA9IGRlc2MuZ2V0O1xuXG4gICAgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7XG4gIH1cbn07XG5cbnZhciBpbmhlcml0cyA9IGZ1bmN0aW9uIChzdWJDbGFzcywgc3VwZXJDbGFzcykge1xuICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7XG4gIH1cblxuICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHtcbiAgICBjb25zdHJ1Y3Rvcjoge1xuICAgICAgdmFsdWU6IHN1YkNsYXNzLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH1cbiAgfSk7XG4gIGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzcztcbn07XG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gPSBmdW5jdGlvbiAoc2VsZiwgY2FsbCkge1xuICBpZiAoIXNlbGYpIHtcbiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7XG4gIH1cblxuICByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjtcbn07XG5cblxuXG52YXIgc2V0ID0gZnVuY3Rpb24gc2V0KG9iamVjdCwgcHJvcGVydHksIHZhbHVlLCByZWNlaXZlcikge1xuICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7XG5cbiAgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkge1xuICAgIHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTtcblxuICAgIGlmIChwYXJlbnQgIT09IG51bGwpIHtcbiAgICAgIHNldChwYXJlbnQsIHByb3BlcnR5LCB2YWx1ZSwgcmVjZWl2ZXIpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYyAmJiBkZXNjLndyaXRhYmxlKSB7XG4gICAgZGVzYy52YWx1ZSA9IHZhbHVlO1xuICB9IGVsc2Uge1xuICAgIHZhciBzZXR0ZXIgPSBkZXNjLnNldDtcblxuICAgIGlmIChzZXR0ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgc2V0dGVyLmNhbGwocmVjZWl2ZXIsIHZhbHVlKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdmFsdWU7XG59O1xuXG52YXIgc2xpY2VkVG9BcnJheSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gc2xpY2VJdGVyYXRvcihhcnIsIGkpIHtcbiAgICB2YXIgX2FyciA9IFtdO1xuICAgIHZhciBfbiA9IHRydWU7XG4gICAgdmFyIF9kID0gZmFsc2U7XG4gICAgdmFyIF9lID0gdW5kZWZpbmVkO1xuXG4gICAgdHJ5IHtcbiAgICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHtcbiAgICAgICAgX2Fyci5wdXNoKF9zLnZhbHVlKTtcblxuICAgICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBfZCA9IHRydWU7XG4gICAgICBfZSA9IGVycjtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKCFfbiAmJiBfaVtcInJldHVyblwiXSkgX2lbXCJyZXR1cm5cIl0oKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGlmIChfZCkgdGhyb3cgX2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIF9hcnI7XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKGFyciwgaSkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGFycikpIHtcbiAgICAgIHJldHVybiBhcnI7XG4gICAgfSBlbHNlIGlmIChTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGFycikpIHtcbiAgICAgIHJldHVybiBzbGljZUl0ZXJhdG9yKGFyciwgaSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlXCIpO1xuICAgIH1cbiAgfTtcbn0oKTtcblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIHRvQ29uc3VtYWJsZUFycmF5ID0gZnVuY3Rpb24gKGFycikge1xuICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgYXJyMltpXSA9IGFycltpXTtcblxuICAgIHJldHVybiBhcnIyO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGFycik7XG4gIH1cbn07XG5cbi8qKiBDaGVja3MgaWYgdmFsdWUgaXMgc3RyaW5nICovXG5mdW5jdGlvbiBpc1N0cmluZyhzdHIpIHtcbiAgcmV0dXJuIHR5cGVvZiBzdHIgPT09ICdzdHJpbmcnIHx8IHN0ciBpbnN0YW5jZW9mIFN0cmluZztcbn1cblxuLyoqIENvbmZvcm1zIHN0cmluZyB3aXRoIGZhbGxiYWNrICovXG5mdW5jdGlvbiBjb25mb3JtKHJlcywgc3RyKSB7XG4gIHZhciBmYWxsYmFjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogJyc7XG5cbiAgcmV0dXJuIGlzU3RyaW5nKHJlcykgPyByZXMgOiByZXMgPyBzdHIgOiBmYWxsYmFjaztcbn1cblxuLyoqXG4gIERpcmVjdGlvblxuICBAcHJvcCB7bnVtYmVyfSBOT05FXG4gIEBwcm9wIHtudW1iZXJ9IExFRlRcbiAgQHByb3Age251bWJlcn0gUklHSFRcbiovXG52YXIgRElSRUNUSU9OID0ge1xuICBOT05FOiAwLFxuICBMRUZUOiAtMSxcbiAgUklHSFQ6IDFcbiAgLyoqXG4gICAgRGlyZWN0aW9uXG4gICAgQGVudW0ge251bWJlcn1cbiAgKi9cbn07XG5cbi8qKiBSZXR1cm5zIG5leHQgY2hhciBwb3NpdGlvbiBpbiBkaXJlY3Rpb24gKi9cbmZ1bmN0aW9uIGluZGV4SW5EaXJlY3Rpb24ocG9zLCBkaXJlY3Rpb24pIHtcbiAgaWYgKGRpcmVjdGlvbiA9PT0gRElSRUNUSU9OLkxFRlQpIC0tcG9zO1xuICByZXR1cm4gcG9zO1xufVxuXG4vKiogRXNjYXBlcyByZWd1bGFyIGV4cHJlc3Npb24gY29udHJvbCBjaGFycyAqL1xuZnVuY3Rpb24gZXNjYXBlUmVnRXhwKHN0cikge1xuICByZXR1cm4gc3RyLnJlcGxhY2UoLyhbLiorP149IToke30oKXxbXFxdL1xcXFxdKS9nLCAnXFxcXCQxJyk7XG59XG5cbi8vIGNsb25lZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9lcG9iZXJlemtpbi9mYXN0LWRlZXAtZXF1YWwgd2l0aCBzbWFsbCBjaGFuZ2VzXG5mdW5jdGlvbiBvYmplY3RJbmNsdWRlcyhiLCBhKSB7XG4gIGlmIChhID09PSBiKSByZXR1cm4gdHJ1ZTtcblxuICB2YXIgYXJyQSA9IEFycmF5LmlzQXJyYXkoYSksXG4gICAgICBhcnJCID0gQXJyYXkuaXNBcnJheShiKSxcbiAgICAgIGk7XG5cbiAgaWYgKGFyckEgJiYgYXJyQikge1xuICAgIGlmIChhLmxlbmd0aCAhPSBiLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuICAgIGZvciAoaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoIW9iamVjdEluY2x1ZGVzKGFbaV0sIGJbaV0pKSByZXR1cm4gZmFsc2U7XG4gICAgfXJldHVybiB0cnVlO1xuICB9XG5cbiAgaWYgKGFyckEgIT0gYXJyQikgcmV0dXJuIGZhbHNlO1xuXG4gIGlmIChhICYmIGIgJiYgKHR5cGVvZiBhID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihhKSkgPT09ICdvYmplY3QnICYmICh0eXBlb2YgYiA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoYikpID09PSAnb2JqZWN0Jykge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoYSk7XG4gICAgLy8gaWYgKGtleXMubGVuZ3RoICE9PSBPYmplY3Qua2V5cyhiKS5sZW5ndGgpIHJldHVybiBmYWxzZTtcblxuICAgIHZhciBkYXRlQSA9IGEgaW5zdGFuY2VvZiBEYXRlLFxuICAgICAgICBkYXRlQiA9IGIgaW5zdGFuY2VvZiBEYXRlO1xuICAgIGlmIChkYXRlQSAmJiBkYXRlQikgcmV0dXJuIGEuZ2V0VGltZSgpID09IGIuZ2V0VGltZSgpO1xuICAgIGlmIChkYXRlQSAhPSBkYXRlQikgcmV0dXJuIGZhbHNlO1xuXG4gICAgdmFyIHJlZ2V4cEEgPSBhIGluc3RhbmNlb2YgUmVnRXhwLFxuICAgICAgICByZWdleHBCID0gYiBpbnN0YW5jZW9mIFJlZ0V4cDtcbiAgICBpZiAocmVnZXhwQSAmJiByZWdleHBCKSByZXR1cm4gYS50b1N0cmluZygpID09IGIudG9TdHJpbmcoKTtcbiAgICBpZiAocmVnZXhwQSAhPSByZWdleHBCKSByZXR1cm4gZmFsc2U7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwga2V5c1tpXSkpIHJldHVybiBmYWxzZTtcbiAgICB9Zm9yIChpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghb2JqZWN0SW5jbHVkZXMoYVtrZXlzW2ldXSwgYltrZXlzW2ldXSkpIHJldHVybiBmYWxzZTtcbiAgICB9cmV0dXJuIHRydWU7XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovXG52YXIgZyA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdyB8fCB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyAmJiBnbG9iYWwuZ2xvYmFsID09PSBnbG9iYWwgJiYgZ2xvYmFsIHx8IHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyAmJiBzZWxmLnNlbGYgPT09IHNlbGYgJiYgc2VsZiB8fCB7fTtcbi8qIGVzbGludC1lbmFibGUgbm8tdW5kZWYgKi9cblxuLyoqIFNlbGVjdGlvbiByYW5nZSAqL1xuXG4vKiogUHJvdmlkZXMgZGV0YWlscyBvZiBjaGFuZ2luZyBpbnB1dCAqL1xuXG52YXIgQWN0aW9uRGV0YWlscyA9IGZ1bmN0aW9uICgpIHtcbiAgLyoqIE9sZCBpbnB1dCB2YWx1ZSAqL1xuXG4gIC8qKiBDdXJyZW50IGlucHV0IHZhbHVlICovXG4gIGZ1bmN0aW9uIEFjdGlvbkRldGFpbHModmFsdWUsIGN1cnNvclBvcywgb2xkVmFsdWUsIG9sZFNlbGVjdGlvbikge1xuICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIEFjdGlvbkRldGFpbHMpO1xuXG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMuY3Vyc29yUG9zID0gY3Vyc29yUG9zO1xuICAgIHRoaXMub2xkVmFsdWUgPSBvbGRWYWx1ZTtcbiAgICB0aGlzLm9sZFNlbGVjdGlvbiA9IG9sZFNlbGVjdGlvbjtcblxuICAgIC8vIGRvdWJsZSBjaGVjayBpZiBsZWZ0IHBhcnQgd2FzIGNoYW5nZWQgKGF1dG9maWxsaW5nLCBvdGhlciBub24tc3RhbmRhcmQgaW5wdXQgdHJpZ2dlcnMpXG4gICAgd2hpbGUgKHRoaXMudmFsdWUuc2xpY2UoMCwgdGhpcy5zdGFydENoYW5nZVBvcykgIT09IHRoaXMub2xkVmFsdWUuc2xpY2UoMCwgdGhpcy5zdGFydENoYW5nZVBvcykpIHtcbiAgICAgIC0tdGhpcy5vbGRTZWxlY3Rpb24uc3RhcnQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAgU3RhcnQgY2hhbmdpbmcgcG9zaXRpb25cbiAgICBAcmVhZG9ubHlcbiAgKi9cblxuICAvKiogT2xkIHNlbGVjdGlvbiAqL1xuXG4gIC8qKiBDdXJyZW50IGN1cnNvciBwb3NpdGlvbiAqL1xuXG5cbiAgY3JlYXRlQ2xhc3MoQWN0aW9uRGV0YWlscywgW3tcbiAgICBrZXk6ICdzdGFydENoYW5nZVBvcycsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gTWF0aC5taW4odGhpcy5jdXJzb3JQb3MsIHRoaXMub2xkU2VsZWN0aW9uLnN0YXJ0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgIEluc2VydGVkIHN5bWJvbHMgY291bnRcbiAgICAgIEByZWFkb25seVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ2luc2VydGVkQ291bnQnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgcmV0dXJuIHRoaXMuY3Vyc29yUG9zIC0gdGhpcy5zdGFydENoYW5nZVBvcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgIEluc2VydGVkIHN5bWJvbHNcbiAgICAgIEByZWFkb25seVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ2luc2VydGVkJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIHJldHVybiB0aGlzLnZhbHVlLnN1YnN0cih0aGlzLnN0YXJ0Q2hhbmdlUG9zLCB0aGlzLmluc2VydGVkQ291bnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgUmVtb3ZlZCBzeW1ib2xzIGNvdW50XG4gICAgICBAcmVhZG9ubHlcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdyZW1vdmVkQ291bnQnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgLy8gTWF0aC5tYXggZm9yIG9wcG9zaXRlIG9wZXJhdGlvblxuICAgICAgcmV0dXJuIE1hdGgubWF4KHRoaXMub2xkU2VsZWN0aW9uLmVuZCAtIHRoaXMuc3RhcnRDaGFuZ2VQb3MgfHxcbiAgICAgIC8vIGZvciBEZWxldGVcbiAgICAgIHRoaXMub2xkVmFsdWUubGVuZ3RoIC0gdGhpcy52YWx1ZS5sZW5ndGgsIDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgUmVtb3ZlZCBzeW1ib2xzXG4gICAgICBAcmVhZG9ubHlcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdyZW1vdmVkJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIHJldHVybiB0aGlzLm9sZFZhbHVlLnN1YnN0cih0aGlzLnN0YXJ0Q2hhbmdlUG9zLCB0aGlzLnJlbW92ZWRDb3VudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICBVbmNoYW5nZWQgaGVhZCBzeW1ib2xzXG4gICAgICBAcmVhZG9ubHlcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdoZWFkJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIHJldHVybiB0aGlzLnZhbHVlLnN1YnN0cmluZygwLCB0aGlzLnN0YXJ0Q2hhbmdlUG9zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgIFVuY2hhbmdlZCB0YWlsIHN5bWJvbHNcbiAgICAgIEByZWFkb25seVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ3RhaWwnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgcmV0dXJuIHRoaXMudmFsdWUuc3Vic3RyaW5nKHRoaXMuc3RhcnRDaGFuZ2VQb3MgKyB0aGlzLmluc2VydGVkQ291bnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgUmVtb3ZlIGRpcmVjdGlvblxuICAgICAgQHJlYWRvbmx5XG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAncmVtb3ZlRGlyZWN0aW9uJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIGlmICghdGhpcy5yZW1vdmVkQ291bnQgfHwgdGhpcy5pbnNlcnRlZENvdW50KSByZXR1cm4gRElSRUNUSU9OLk5PTkU7XG5cbiAgICAgIC8vIGFsaWduIHJpZ2h0IGlmIGRlbGV0ZSBhdCByaWdodCBvciBpZiByYW5nZSByZW1vdmVkIChldmVudCB3aXRoIGJhY2tzcGFjZSlcbiAgICAgIHJldHVybiB0aGlzLm9sZFNlbGVjdGlvbi5lbmQgPT09IHRoaXMuY3Vyc29yUG9zIHx8IHRoaXMub2xkU2VsZWN0aW9uLnN0YXJ0ID09PSB0aGlzLmN1cnNvclBvcyA/IERJUkVDVElPTi5SSUdIVCA6IERJUkVDVElPTi5MRUZUO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gQWN0aW9uRGV0YWlscztcbn0oKTtcblxuLyoqXG4gIFByb3ZpZGVzIGRldGFpbHMgb2YgY2hhbmdpbmcgbW9kZWwgdmFsdWVcbiAgQHBhcmFtIHtPYmplY3R9IFtkZXRhaWxzXVxuICBAcGFyYW0ge3N0cmluZ30gW2RldGFpbHMuaW5zZXJ0ZWRdIC0gSW5zZXJ0ZWQgc3ltYm9sc1xuICBAcGFyYW0ge2Jvb2xlYW59IFtkZXRhaWxzLm92ZXJmbG93XSAtIElzIG92ZXJmbG93ZWRcbiAgQHBhcmFtIHtudW1iZXJ9IFtkZXRhaWxzLnJlbW92ZUNvdW50XSAtIFJlbW92ZWQgc3ltYm9scyBjb3VudFxuICBAcGFyYW0ge251bWJlcn0gW2RldGFpbHMuc2hpZnRdIC0gQWRkaXRpb25hbCBvZmZzZXQgaWYgYW55IGNoYW5nZXMgb2NjdXJyZWQgYmVmb3JlIGN1cnJlbnQgcG9zaXRpb25cbiovXG52YXIgQ2hhbmdlRGV0YWlscyA9IGZ1bmN0aW9uICgpIHtcbiAgLyoqIEFkZGl0aW9uYWwgb2Zmc2V0IGlmIGFueSBjaGFuZ2VzIG9jY3VycmVkIGJlZm9yZSBjdXJyZW50IHBvc2l0aW9uICovXG5cbiAgLyoqIEluc2VydGVkIHN5bWJvbHMgKi9cbiAgZnVuY3Rpb24gQ2hhbmdlRGV0YWlscyhkZXRhaWxzKSB7XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgQ2hhbmdlRGV0YWlscyk7XG5cbiAgICBfZXh0ZW5kcyh0aGlzLCB7XG4gICAgICBpbnNlcnRlZDogJycsXG4gICAgICBvdmVyZmxvdzogZmFsc2UsXG4gICAgICBzaGlmdDogMFxuICAgIH0sIGRldGFpbHMpO1xuICB9XG5cbiAgLyoqXG4gICAgQWdncmVnYXRlIGNoYW5nZXNcbiAgICBAcmV0dXJucyB7Q2hhbmdlRGV0YWlsc30gYHRoaXNgXG4gICovXG5cbiAgLyoqIElzIG92ZXJmbG93ZWQgKi9cblxuXG4gIGNyZWF0ZUNsYXNzKENoYW5nZURldGFpbHMsIFt7XG4gICAga2V5OiAnYWdncmVnYXRlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gYWdncmVnYXRlKGRldGFpbHMpIHtcbiAgICAgIGlmIChkZXRhaWxzLnJhd0luc2VydGVkKSB0aGlzLnJhd0luc2VydGVkICs9IGRldGFpbHMucmF3SW5zZXJ0ZWQ7XG4gICAgICB0aGlzLmluc2VydGVkICs9IGRldGFpbHMuaW5zZXJ0ZWQ7XG4gICAgICB0aGlzLnNoaWZ0ICs9IGRldGFpbHMuc2hpZnQ7XG4gICAgICB0aGlzLm92ZXJmbG93ID0gdGhpcy5vdmVyZmxvdyB8fCBkZXRhaWxzLm92ZXJmbG93O1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqIFRvdGFsIG9mZnNldCBjb25zaWRlcmluZyBhbGwgY2hhbmdlcyAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdvZmZzZXQnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgcmV0dXJuIHRoaXMuc2hpZnQgKyB0aGlzLmluc2VydGVkLmxlbmd0aDtcbiAgICB9XG5cbiAgICAvKiogUmF3IGluc2VydGVkIGlzIHVzZWQgYnkgZHluYW1pYyBtYXNrICovXG5cbiAgfSwge1xuICAgIGtleTogJ3Jhd0luc2VydGVkJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9yYXdJbnNlcnRlZCAhPSBudWxsID8gdGhpcy5fcmF3SW5zZXJ0ZWQgOiB0aGlzLmluc2VydGVkO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQkJDEocmF3SW5zZXJ0ZWQpIHtcbiAgICAgIHRoaXMuX3Jhd0luc2VydGVkID0gcmF3SW5zZXJ0ZWQ7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBDaGFuZ2VEZXRhaWxzO1xufSgpO1xuXG4vKiogU3VwcG9ydGVkIG1hc2sgdHlwZSAqL1xuXG5cbi8qKiBBcHBlbmQgZmxhZ3MgKi9cblxuXG4vKiogRXh0cmFjdCBmbGFncyAqL1xuXG4vKiogUHJvdmlkZXMgY29tbW9uIG1hc2tpbmcgc3R1ZmYgKi9cbnZhciBNYXNrZWQgPSBmdW5jdGlvbiAoKSB7XG4gIC8qKiBEb2VzIGFkZGl0aW9uYWwgcHJvY2Vzc2luZyBpbiB0aGUgZW5kIG9mIGVkaXRpbmcgKi9cblxuICAvKiogVHJhbnNmb3JtcyB2YWx1ZSBiZWZvcmUgbWFzayBwcm9jZXNzaW5nICovXG4gIGZ1bmN0aW9uIE1hc2tlZChvcHRzKSB7XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgTWFza2VkKTtcblxuICAgIHRoaXMuX3ZhbHVlID0gJyc7XG4gICAgdGhpcy5fdXBkYXRlKF9leHRlbmRzKHt9LCBNYXNrZWQuREVGQVVMVFMsIG9wdHMpKTtcbiAgICB0aGlzLmlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICB9XG5cbiAgLyoqIFNldHMgYW5kIGFwcGxpZXMgbmV3IG9wdGlvbnMgKi9cblxuICAvKiogKi9cblxuICAvKiogVmFsaWRhdGVzIGlmIHZhbHVlIGlzIGFjY2VwdGFibGUgKi9cbiAgLy8gJFNoYXBlPE1hc2tlZE9wdGlvbnM+OyBUT0RPIGFmdGVyIGZpeCBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svZmxvdy9pc3N1ZXMvNDc3M1xuXG4gIC8qKiBAdHlwZSB7TWFza30gKi9cblxuXG4gIGNyZWF0ZUNsYXNzKE1hc2tlZCwgW3tcbiAgICBrZXk6ICd1cGRhdGVPcHRpb25zJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlT3B0aW9ucyhvcHRzKSB7XG4gICAgICB0aGlzLndpdGhWYWx1ZVJlZnJlc2godGhpcy5fdXBkYXRlLmJpbmQodGhpcywgb3B0cykpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgU2V0cyBuZXcgb3B0aW9uc1xuICAgICAgQHByb3RlY3RlZFxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ191cGRhdGUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfdXBkYXRlKG9wdHMpIHtcbiAgICAgIF9leHRlbmRzKHRoaXMsIG9wdHMpO1xuICAgIH1cblxuICAgIC8qKiBDbG9uZXMgbWFza2VkIHdpdGggb3B0aW9ucyBhbmQgdmFsdWUgKi9cblxuICB9LCB7XG4gICAga2V5OiAnY2xvbmUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9uZSgpIHtcbiAgICAgIHZhciBtID0gbmV3IE1hc2tlZCh0aGlzKTtcbiAgICAgIG0uX3ZhbHVlID0gdGhpcy52YWx1ZS5zbGljZSgpO1xuICAgICAgcmV0dXJuIG07XG4gICAgfVxuXG4gICAgLyoqICovXG5cbiAgfSwge1xuICAgIGtleTogJ2Fzc2lnbicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGFzc2lnbihzb3VyY2UpIHtcbiAgICAgIC8vICRGbG93Rml4TWVcbiAgICAgIHJldHVybiBfZXh0ZW5kcyh0aGlzLCBzb3VyY2UpO1xuICAgIH1cblxuICAgIC8qKiBSZXNldHMgdmFsdWUgKi9cblxuICB9LCB7XG4gICAga2V5OiAncmVzZXQnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgIHRoaXMuX3ZhbHVlID0gJyc7XG4gICAgfVxuXG4gICAgLyoqICovXG5cbiAgfSwge1xuICAgIGtleTogJ3Jlc29sdmUnLFxuXG5cbiAgICAvKiogUmVzb2x2ZSBuZXcgdmFsdWUgKi9cbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzb2x2ZSh2YWx1ZSkge1xuICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgdGhpcy5fYXBwZW5kKHZhbHVlLCB7IGlucHV0OiB0cnVlIH0pO1xuICAgICAgdGhpcy5fYXBwZW5kVGFpbCgpO1xuICAgICAgdGhpcy5kb0NvbW1pdCgpO1xuICAgICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgfVxuXG4gICAgLyoqICovXG5cbiAgfSwge1xuICAgIGtleTogJ25lYXJlc3RJbnB1dFBvcycsXG5cblxuICAgIC8qKiBGaW5kcyBuZWFyZXN0IGlucHV0IHBvc2l0aW9uIGluIGRpcmVjdGlvbiAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbiBuZWFyZXN0SW5wdXRQb3MoY3Vyc29yUG9zLCBkaXJlY3Rpb24pIHtcbiAgICAgIHJldHVybiBjdXJzb3JQb3M7XG4gICAgfVxuXG4gICAgLyoqIEV4dHJhY3RzIHZhbHVlIGluIHJhbmdlIGNvbnNpZGVyaW5nIGZsYWdzICovXG5cbiAgfSwge1xuICAgIGtleTogJ2V4dHJhY3RJbnB1dCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGV4dHJhY3RJbnB1dCgpIHtcbiAgICAgIHZhciBmcm9tUG9zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAwO1xuICAgICAgdmFyIHRvUG9zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB0aGlzLnZhbHVlLmxlbmd0aDtcbiAgICAgIHJldHVybiB0aGlzLnZhbHVlLnNsaWNlKGZyb21Qb3MsIHRvUG9zKTtcbiAgICB9XG5cbiAgICAvKiogRXh0cmFjdHMgdGFpbCBpbiByYW5nZSAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdfZXh0cmFjdFRhaWwnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfZXh0cmFjdFRhaWwoKSB7XG4gICAgICB2YXIgZnJvbVBvcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMDtcbiAgICAgIHZhciB0b1BvcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogdGhpcy52YWx1ZS5sZW5ndGg7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB0aGlzLmV4dHJhY3RJbnB1dChmcm9tUG9zLCB0b1BvcyksXG4gICAgICAgIGZyb21Qb3M6IGZyb21Qb3MsXG4gICAgICAgIHRvUG9zOiB0b1Bvc1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKiogQXBwZW5kcyB0YWlsICovXG5cbiAgfSwge1xuICAgIGtleTogJ19hcHBlbmRUYWlsJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2FwcGVuZFRhaWwodGFpbCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2FwcGVuZCh0YWlsID8gdGFpbC52YWx1ZSA6ICcnLCB7IHRhaWw6IHRydWUgfSk7XG4gICAgfVxuXG4gICAgLyoqIEFwcGVuZHMgc3ltYm9scyBjb25zaWRlcmluZyBmbGFncyAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdfYXBwZW5kJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2FwcGVuZChzdHIpIHtcbiAgICAgIHZhciBmbGFncyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICAgIHZhciBvbGRWYWx1ZUxlbmd0aCA9IHRoaXMudmFsdWUubGVuZ3RoO1xuICAgICAgdmFyIGNvbnNpc3RlbnRWYWx1ZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgIHZhciBvdmVyZmxvdyA9IGZhbHNlO1xuXG4gICAgICBzdHIgPSB0aGlzLmRvUHJlcGFyZShzdHIsIGZsYWdzKTtcblxuICAgICAgZm9yICh2YXIgY2kgPSAwOyBjaSA8IHN0ci5sZW5ndGg7ICsrY2kpIHtcbiAgICAgICAgdGhpcy5fdmFsdWUgKz0gc3RyW2NpXTtcbiAgICAgICAgaWYgKHRoaXMuZG9WYWxpZGF0ZShmbGFncykgPT09IGZhbHNlKSB7XG4gICAgICAgICAgdGhpcy5hc3NpZ24oY29uc2lzdGVudFZhbHVlKTtcbiAgICAgICAgICBpZiAoIWZsYWdzLmlucHV0KSB7XG4gICAgICAgICAgICAvLyBpbiBgaW5wdXRgIG1vZGUgZG9udCBza2lwIGludmFsaWQgY2hhcnNcbiAgICAgICAgICAgIG92ZXJmbG93ID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNpc3RlbnRWYWx1ZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ldyBDaGFuZ2VEZXRhaWxzKHtcbiAgICAgICAgaW5zZXJ0ZWQ6IHRoaXMudmFsdWUuc2xpY2Uob2xkVmFsdWVMZW5ndGgpLFxuICAgICAgICBvdmVyZmxvdzogb3ZlcmZsb3dcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKiBBcHBlbmRzIHN5bWJvbHMgY29uc2lkZXJpbmcgdGFpbCAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdhcHBlbmRXaXRoVGFpbCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGVuZFdpdGhUYWlsKHN0ciwgdGFpbCkge1xuICAgICAgLy8gVE9ETyByZWZhY3RvclxuICAgICAgdmFyIGFnZ3JlZ2F0ZURldGFpbHMgPSBuZXcgQ2hhbmdlRGV0YWlscygpO1xuICAgICAgdmFyIGNvbnNpc3RlbnRWYWx1ZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgIHZhciBjb25zaXN0ZW50QXBwZW5kZWQgPSB2b2lkIDA7XG5cbiAgICAgIGZvciAodmFyIGNpID0gMDsgY2kgPCBzdHIubGVuZ3RoOyArK2NpKSB7XG4gICAgICAgIHZhciBjaCA9IHN0cltjaV07XG5cbiAgICAgICAgdmFyIGFwcGVuZERldGFpbHMgPSB0aGlzLl9hcHBlbmQoY2gsIHsgaW5wdXQ6IHRydWUgfSk7XG4gICAgICAgIGNvbnNpc3RlbnRBcHBlbmRlZCA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgdmFyIHRhaWxBcHBlbmRlZCA9ICFhcHBlbmREZXRhaWxzLm92ZXJmbG93ICYmICF0aGlzLl9hcHBlbmRUYWlsKHRhaWwpLm92ZXJmbG93O1xuICAgICAgICBpZiAoIXRhaWxBcHBlbmRlZCB8fCB0aGlzLmRvVmFsaWRhdGUoeyB0YWlsOiB0cnVlIH0pID09PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMuYXNzaWduKGNvbnNpc3RlbnRWYWx1ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmFzc2lnbihjb25zaXN0ZW50QXBwZW5kZWQpO1xuICAgICAgICBjb25zaXN0ZW50VmFsdWUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGFnZ3JlZ2F0ZURldGFpbHMuYWdncmVnYXRlKGFwcGVuZERldGFpbHMpO1xuICAgICAgfVxuXG4gICAgICAvLyBUT0RPIG5lZWRlZCBmb3IgY2FzZXMgd2hlblxuICAgICAgLy8gMSkgUkVNT1ZFIE9OTFkgQU5EIE5PIExPT1AgQVQgQUxMXG4gICAgICAvLyAyKSBsYXN0IGxvb3AgaXRlcmF0aW9uIHJlbW92ZXMgdGFpbFxuICAgICAgLy8gMykgd2hlbiBicmVha3Mgb24gdGFpbCBpbnNlcnRcblxuICAgICAgLy8gYWdncmVnYXRlIG9ubHkgc2hpZnQgZnJvbSB0YWlsXG4gICAgICBhZ2dyZWdhdGVEZXRhaWxzLnNoaWZ0ICs9IHRoaXMuX2FwcGVuZFRhaWwodGFpbCkuc2hpZnQ7XG5cbiAgICAgIHJldHVybiBhZ2dyZWdhdGVEZXRhaWxzO1xuICAgIH1cblxuICAgIC8qKiAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdyZW1vdmUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICB2YXIgZnJvbSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMDtcbiAgICAgIHZhciBjb3VudCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogdGhpcy52YWx1ZS5sZW5ndGggLSBmcm9tO1xuXG4gICAgICB0aGlzLl92YWx1ZSA9IHRoaXMudmFsdWUuc2xpY2UoMCwgZnJvbSkgKyB0aGlzLnZhbHVlLnNsaWNlKGZyb20gKyBjb3VudCk7XG4gICAgICByZXR1cm4gbmV3IENoYW5nZURldGFpbHMoKTtcbiAgICB9XG5cbiAgICAvKiogQ2FsbHMgZnVuY3Rpb24gYW5kIHJlYXBwbGllcyBjdXJyZW50IHZhbHVlICovXG5cbiAgfSwge1xuICAgIGtleTogJ3dpdGhWYWx1ZVJlZnJlc2gnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB3aXRoVmFsdWVSZWZyZXNoKGZuKSB7XG4gICAgICBpZiAodGhpcy5fcmVmcmVzaGluZyB8fCAhdGhpcy5pc0luaXRpYWxpemVkKSByZXR1cm4gZm4oKTtcbiAgICAgIHRoaXMuX3JlZnJlc2hpbmcgPSB0cnVlO1xuXG4gICAgICB2YXIgdW5tYXNrZWQgPSB0aGlzLnVubWFza2VkVmFsdWU7XG5cbiAgICAgIHZhciByZXQgPSBmbigpO1xuXG4gICAgICB0aGlzLnVubWFza2VkVmFsdWUgPSB1bm1hc2tlZDtcblxuICAgICAgZGVsZXRlIHRoaXMuX3JlZnJlc2hpbmc7XG4gICAgICByZXR1cm4gcmV0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgUHJlcGFyZXMgc3RyaW5nIGJlZm9yZSBtYXNrIHByb2Nlc3NpbmdcbiAgICAgIEBwcm90ZWN0ZWRcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdkb1ByZXBhcmUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBkb1ByZXBhcmUoc3RyKSB7XG4gICAgICB2YXIgZmxhZ3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG4gICAgICByZXR1cm4gdGhpcy5wcmVwYXJlKHN0ciwgdGhpcywgZmxhZ3MpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgVmFsaWRhdGVzIGlmIHZhbHVlIGlzIGFjY2VwdGFibGVcbiAgICAgIEBwcm90ZWN0ZWRcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdkb1ZhbGlkYXRlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZG9WYWxpZGF0ZShmbGFncykge1xuICAgICAgcmV0dXJuIHRoaXMudmFsaWRhdGUodGhpcy52YWx1ZSwgdGhpcywgZmxhZ3MpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgRG9lcyBhZGRpdGlvbmFsIHByb2Nlc3NpbmcgaW4gdGhlIGVuZCBvZiBlZGl0aW5nXG4gICAgICBAcHJvdGVjdGVkXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnZG9Db21taXQnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBkb0NvbW1pdCgpIHtcbiAgICAgIHRoaXMuY29tbWl0KHRoaXMudmFsdWUsIHRoaXMpO1xuICAgIH1cblxuICAgIC8vIFRPRE9cbiAgICAvLyBpbnNlcnQgKHN0ciwgZnJvbVBvcywgZmxhZ3MpXG5cbiAgICAvKiogKi9cblxuICB9LCB7XG4gICAga2V5OiAnc3BsaWNlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaWNlKHN0YXJ0LCBkZWxldGVDb3VudCwgaW5zZXJ0ZWQsIHJlbW92ZURpcmVjdGlvbikge1xuICAgICAgdmFyIHRhaWxQb3MgPSBzdGFydCArIGRlbGV0ZUNvdW50O1xuICAgICAgdmFyIHRhaWwgPSB0aGlzLl9leHRyYWN0VGFpbCh0YWlsUG9zKTtcblxuICAgICAgdmFyIHN0YXJ0Q2hhbmdlUG9zID0gdGhpcy5uZWFyZXN0SW5wdXRQb3Moc3RhcnQsIHJlbW92ZURpcmVjdGlvbik7XG4gICAgICB2YXIgY2hhbmdlRGV0YWlscyA9IG5ldyBDaGFuZ2VEZXRhaWxzKHtcbiAgICAgICAgc2hpZnQ6IHN0YXJ0Q2hhbmdlUG9zIC0gc3RhcnQgLy8gYWRqdXN0IHNoaWZ0IGlmIHN0YXJ0IHdhcyBhbGlnbmVkXG4gICAgICB9KS5hZ2dyZWdhdGUodGhpcy5yZW1vdmUoc3RhcnRDaGFuZ2VQb3MpKS5hZ2dyZWdhdGUodGhpcy5hcHBlbmRXaXRoVGFpbChpbnNlcnRlZCwgdGFpbCkpO1xuXG4gICAgICByZXR1cm4gY2hhbmdlRGV0YWlscztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd2YWx1ZScsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldCQkMSh2YWx1ZSkge1xuICAgICAgdGhpcy5yZXNvbHZlKHZhbHVlKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd1bm1hc2tlZFZhbHVlJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIHJldHVybiB0aGlzLnZhbHVlO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQkJDEodmFsdWUpIHtcbiAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgIHRoaXMuX2FwcGVuZCh2YWx1ZSk7XG4gICAgICB0aGlzLl9hcHBlbmRUYWlsKCk7XG4gICAgICB0aGlzLmRvQ29tbWl0KCk7XG4gICAgfVxuXG4gICAgLyoqIFZhbHVlIHRoYXQgaW5jbHVkZXMgcmF3IHVzZXIgaW5wdXQgKi9cblxuICB9LCB7XG4gICAga2V5OiAncmF3SW5wdXRWYWx1ZScsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gdGhpcy5leHRyYWN0SW5wdXQoMCwgdGhpcy52YWx1ZS5sZW5ndGgsIHsgcmF3OiB0cnVlIH0pO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQkJDEodmFsdWUpIHtcbiAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgIHRoaXMuX2FwcGVuZCh2YWx1ZSwgeyByYXc6IHRydWUgfSk7XG4gICAgICB0aGlzLl9hcHBlbmRUYWlsKCk7XG4gICAgICB0aGlzLmRvQ29tbWl0KCk7XG4gICAgfVxuXG4gICAgLyoqICovXG5cbiAgfSwge1xuICAgIGtleTogJ2lzQ29tcGxldGUnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBNYXNrZWQ7XG59KCk7XG5cbk1hc2tlZC5ERUZBVUxUUyA9IHtcbiAgcHJlcGFyZTogZnVuY3Rpb24gcHJlcGFyZSh2YWwpIHtcbiAgICByZXR1cm4gdmFsO1xuICB9LFxuICB2YWxpZGF0ZTogZnVuY3Rpb24gdmFsaWRhdGUoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0sXG4gIGNvbW1pdDogZnVuY3Rpb24gY29tbWl0KCkge31cbn07XG5cbi8qKiBHZXQgTWFza2VkIGNsYXNzIGJ5IG1hc2sgdHlwZSAqL1xuZnVuY3Rpb24gbWFza2VkQ2xhc3MobWFzaykge1xuICBpZiAobWFzayA9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdtYXNrIHByb3BlcnR5IHNob3VsZCBiZSBkZWZpbmVkJyk7XG4gIH1cblxuICBpZiAobWFzayBpbnN0YW5jZW9mIFJlZ0V4cCkgcmV0dXJuIGcuSU1hc2suTWFza2VkUmVnRXhwO1xuICBpZiAoaXNTdHJpbmcobWFzaykpIHJldHVybiBnLklNYXNrLk1hc2tlZFBhdHRlcm47XG4gIGlmIChtYXNrIGluc3RhbmNlb2YgRGF0ZSB8fCBtYXNrID09PSBEYXRlKSByZXR1cm4gZy5JTWFzay5NYXNrZWREYXRlO1xuICBpZiAobWFzayBpbnN0YW5jZW9mIE51bWJlciB8fCB0eXBlb2YgbWFzayA9PT0gJ251bWJlcicgfHwgbWFzayA9PT0gTnVtYmVyKSByZXR1cm4gZy5JTWFzay5NYXNrZWROdW1iZXI7XG4gIGlmIChBcnJheS5pc0FycmF5KG1hc2spIHx8IG1hc2sgPT09IEFycmF5KSByZXR1cm4gZy5JTWFzay5NYXNrZWREeW5hbWljO1xuICAvLyAkRmxvd0ZpeE1lXG4gIGlmIChtYXNrLnByb3RvdHlwZSBpbnN0YW5jZW9mIGcuSU1hc2suTWFza2VkKSByZXR1cm4gbWFzaztcbiAgLy8gJEZsb3dGaXhNZVxuICBpZiAobWFzayBpbnN0YW5jZW9mIEZ1bmN0aW9uKSByZXR1cm4gZy5JTWFzay5NYXNrZWRGdW5jdGlvbjtcblxuICBjb25zb2xlLndhcm4oJ01hc2sgbm90IGZvdW5kIGZvciBtYXNrJywgbWFzayk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICByZXR1cm4gZy5JTWFzay5NYXNrZWQ7XG59XG5cbi8qKiBDcmVhdGVzIG5ldyB7QGxpbmsgTWFza2VkfSBkZXBlbmRpbmcgb24gbWFzayB0eXBlICovXG5mdW5jdGlvbiBjcmVhdGVNYXNrKG9wdHMpIHtcbiAgb3B0cyA9IF9leHRlbmRzKHt9LCBvcHRzKTsgLy8gY2xvbmVcbiAgdmFyIG1hc2sgPSBvcHRzLm1hc2s7XG5cbiAgaWYgKG1hc2sgaW5zdGFuY2VvZiBnLklNYXNrLk1hc2tlZCkgcmV0dXJuIG1hc2s7XG5cbiAgdmFyIE1hc2tlZENsYXNzID0gbWFza2VkQ2xhc3MobWFzayk7XG4gIHJldHVybiBuZXcgTWFza2VkQ2xhc3Mob3B0cyk7XG59XG5cbi8qKiAqL1xuXG4vKiogKi9cbnZhciBQYXR0ZXJuRGVmaW5pdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgLyoqICovXG5cbiAgLyoqICovXG5cbiAgLyoqICovXG4gIGZ1bmN0aW9uIFBhdHRlcm5EZWZpbml0aW9uKG9wdHMpIHtcbiAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBQYXR0ZXJuRGVmaW5pdGlvbik7XG4gICAgLy8gVE9ETyBmbG93XG4gICAgX2V4dGVuZHModGhpcywgb3B0cyk7XG5cbiAgICBpZiAodGhpcy5tYXNrKSB7XG4gICAgICB0aGlzLl9tYXNrZWQgPSBjcmVhdGVNYXNrKG9wdHMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiAqL1xuXG4gIC8qKiAqL1xuXG4gIC8qKiAqL1xuXG4gIC8qKiAqL1xuXG5cbiAgLyoqICovXG5cblxuICBjcmVhdGVDbGFzcyhQYXR0ZXJuRGVmaW5pdGlvbiwgW3tcbiAgICBrZXk6ICdyZXNldCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgICAgdGhpcy5pc0hvbGxvdyA9IGZhbHNlO1xuICAgICAgdGhpcy5pc1Jhd0lucHV0ID0gZmFsc2U7XG4gICAgICBpZiAodGhpcy5fbWFza2VkKSB0aGlzLl9tYXNrZWQucmVzZXQoKTtcbiAgICB9XG5cbiAgICAvKiogKi9cblxuICB9LCB7XG4gICAga2V5OiAncmVzb2x2ZScsXG5cblxuICAgIC8qKiAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbiByZXNvbHZlKGNoKSB7XG4gICAgICBpZiAoIXRoaXMuX21hc2tlZCkgcmV0dXJuIGZhbHNlO1xuICAgICAgcmV0dXJuIHRoaXMuX21hc2tlZC5yZXNvbHZlKGNoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdpc0lucHV0JyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIHJldHVybiB0aGlzLnR5cGUgPT09IFBhdHRlcm5EZWZpbml0aW9uLlRZUEVTLklOUFVUO1xuICAgIH1cblxuICAgIC8qKiAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdpc0hpZGRlbkhvbGxvdycsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gdGhpcy5pc0hvbGxvdyAmJiB0aGlzLm9wdGlvbmFsO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gUGF0dGVybkRlZmluaXRpb247XG59KCk7XG5cblBhdHRlcm5EZWZpbml0aW9uLkRFRkFVTFRTID0ge1xuICAnMCc6IC9cXGQvLFxuICAnYSc6IC9bXFx1MDA0MS1cXHUwMDVBXFx1MDA2MS1cXHUwMDdBXFx1MDBBQVxcdTAwQjVcXHUwMEJBXFx1MDBDMC1cXHUwMEQ2XFx1MDBEOC1cXHUwMEY2XFx1MDBGOC1cXHUwMkMxXFx1MDJDNi1cXHUwMkQxXFx1MDJFMC1cXHUwMkU0XFx1MDJFQ1xcdTAyRUVcXHUwMzcwLVxcdTAzNzRcXHUwMzc2XFx1MDM3N1xcdTAzN0EtXFx1MDM3RFxcdTAzODZcXHUwMzg4LVxcdTAzOEFcXHUwMzhDXFx1MDM4RS1cXHUwM0ExXFx1MDNBMy1cXHUwM0Y1XFx1MDNGNy1cXHUwNDgxXFx1MDQ4QS1cXHUwNTI3XFx1MDUzMS1cXHUwNTU2XFx1MDU1OVxcdTA1NjEtXFx1MDU4N1xcdTA1RDAtXFx1MDVFQVxcdTA1RjAtXFx1MDVGMlxcdTA2MjAtXFx1MDY0QVxcdTA2NkVcXHUwNjZGXFx1MDY3MS1cXHUwNkQzXFx1MDZENVxcdTA2RTVcXHUwNkU2XFx1MDZFRVxcdTA2RUZcXHUwNkZBLVxcdTA2RkNcXHUwNkZGXFx1MDcxMFxcdTA3MTItXFx1MDcyRlxcdTA3NEQtXFx1MDdBNVxcdTA3QjFcXHUwN0NBLVxcdTA3RUFcXHUwN0Y0XFx1MDdGNVxcdTA3RkFcXHUwODAwLVxcdTA4MTVcXHUwODFBXFx1MDgyNFxcdTA4MjhcXHUwODQwLVxcdTA4NThcXHUwOEEwXFx1MDhBMi1cXHUwOEFDXFx1MDkwNC1cXHUwOTM5XFx1MDkzRFxcdTA5NTBcXHUwOTU4LVxcdTA5NjFcXHUwOTcxLVxcdTA5NzdcXHUwOTc5LVxcdTA5N0ZcXHUwOTg1LVxcdTA5OENcXHUwOThGXFx1MDk5MFxcdTA5OTMtXFx1MDlBOFxcdTA5QUEtXFx1MDlCMFxcdTA5QjJcXHUwOUI2LVxcdTA5QjlcXHUwOUJEXFx1MDlDRVxcdTA5RENcXHUwOUREXFx1MDlERi1cXHUwOUUxXFx1MDlGMFxcdTA5RjFcXHUwQTA1LVxcdTBBMEFcXHUwQTBGXFx1MEExMFxcdTBBMTMtXFx1MEEyOFxcdTBBMkEtXFx1MEEzMFxcdTBBMzJcXHUwQTMzXFx1MEEzNVxcdTBBMzZcXHUwQTM4XFx1MEEzOVxcdTBBNTktXFx1MEE1Q1xcdTBBNUVcXHUwQTcyLVxcdTBBNzRcXHUwQTg1LVxcdTBBOERcXHUwQThGLVxcdTBBOTFcXHUwQTkzLVxcdTBBQThcXHUwQUFBLVxcdTBBQjBcXHUwQUIyXFx1MEFCM1xcdTBBQjUtXFx1MEFCOVxcdTBBQkRcXHUwQUQwXFx1MEFFMFxcdTBBRTFcXHUwQjA1LVxcdTBCMENcXHUwQjBGXFx1MEIxMFxcdTBCMTMtXFx1MEIyOFxcdTBCMkEtXFx1MEIzMFxcdTBCMzJcXHUwQjMzXFx1MEIzNS1cXHUwQjM5XFx1MEIzRFxcdTBCNUNcXHUwQjVEXFx1MEI1Ri1cXHUwQjYxXFx1MEI3MVxcdTBCODNcXHUwQjg1LVxcdTBCOEFcXHUwQjhFLVxcdTBCOTBcXHUwQjkyLVxcdTBCOTVcXHUwQjk5XFx1MEI5QVxcdTBCOUNcXHUwQjlFXFx1MEI5RlxcdTBCQTNcXHUwQkE0XFx1MEJBOC1cXHUwQkFBXFx1MEJBRS1cXHUwQkI5XFx1MEJEMFxcdTBDMDUtXFx1MEMwQ1xcdTBDMEUtXFx1MEMxMFxcdTBDMTItXFx1MEMyOFxcdTBDMkEtXFx1MEMzM1xcdTBDMzUtXFx1MEMzOVxcdTBDM0RcXHUwQzU4XFx1MEM1OVxcdTBDNjBcXHUwQzYxXFx1MEM4NS1cXHUwQzhDXFx1MEM4RS1cXHUwQzkwXFx1MEM5Mi1cXHUwQ0E4XFx1MENBQS1cXHUwQ0IzXFx1MENCNS1cXHUwQ0I5XFx1MENCRFxcdTBDREVcXHUwQ0UwXFx1MENFMVxcdTBDRjFcXHUwQ0YyXFx1MEQwNS1cXHUwRDBDXFx1MEQwRS1cXHUwRDEwXFx1MEQxMi1cXHUwRDNBXFx1MEQzRFxcdTBENEVcXHUwRDYwXFx1MEQ2MVxcdTBEN0EtXFx1MEQ3RlxcdTBEODUtXFx1MEQ5NlxcdTBEOUEtXFx1MERCMVxcdTBEQjMtXFx1MERCQlxcdTBEQkRcXHUwREMwLVxcdTBEQzZcXHUwRTAxLVxcdTBFMzBcXHUwRTMyXFx1MEUzM1xcdTBFNDAtXFx1MEU0NlxcdTBFODFcXHUwRTgyXFx1MEU4NFxcdTBFODdcXHUwRTg4XFx1MEU4QVxcdTBFOERcXHUwRTk0LVxcdTBFOTdcXHUwRTk5LVxcdTBFOUZcXHUwRUExLVxcdTBFQTNcXHUwRUE1XFx1MEVBN1xcdTBFQUFcXHUwRUFCXFx1MEVBRC1cXHUwRUIwXFx1MEVCMlxcdTBFQjNcXHUwRUJEXFx1MEVDMC1cXHUwRUM0XFx1MEVDNlxcdTBFREMtXFx1MEVERlxcdTBGMDBcXHUwRjQwLVxcdTBGNDdcXHUwRjQ5LVxcdTBGNkNcXHUwRjg4LVxcdTBGOENcXHUxMDAwLVxcdTEwMkFcXHUxMDNGXFx1MTA1MC1cXHUxMDU1XFx1MTA1QS1cXHUxMDVEXFx1MTA2MVxcdTEwNjVcXHUxMDY2XFx1MTA2RS1cXHUxMDcwXFx1MTA3NS1cXHUxMDgxXFx1MTA4RVxcdTEwQTAtXFx1MTBDNVxcdTEwQzdcXHUxMENEXFx1MTBEMC1cXHUxMEZBXFx1MTBGQy1cXHUxMjQ4XFx1MTI0QS1cXHUxMjREXFx1MTI1MC1cXHUxMjU2XFx1MTI1OFxcdTEyNUEtXFx1MTI1RFxcdTEyNjAtXFx1MTI4OFxcdTEyOEEtXFx1MTI4RFxcdTEyOTAtXFx1MTJCMFxcdTEyQjItXFx1MTJCNVxcdTEyQjgtXFx1MTJCRVxcdTEyQzBcXHUxMkMyLVxcdTEyQzVcXHUxMkM4LVxcdTEyRDZcXHUxMkQ4LVxcdTEzMTBcXHUxMzEyLVxcdTEzMTVcXHUxMzE4LVxcdTEzNUFcXHUxMzgwLVxcdTEzOEZcXHUxM0EwLVxcdTEzRjRcXHUxNDAxLVxcdTE2NkNcXHUxNjZGLVxcdTE2N0ZcXHUxNjgxLVxcdTE2OUFcXHUxNkEwLVxcdTE2RUFcXHUxNzAwLVxcdTE3MENcXHUxNzBFLVxcdTE3MTFcXHUxNzIwLVxcdTE3MzFcXHUxNzQwLVxcdTE3NTFcXHUxNzYwLVxcdTE3NkNcXHUxNzZFLVxcdTE3NzBcXHUxNzgwLVxcdTE3QjNcXHUxN0Q3XFx1MTdEQ1xcdTE4MjAtXFx1MTg3N1xcdTE4ODAtXFx1MThBOFxcdTE4QUFcXHUxOEIwLVxcdTE4RjVcXHUxOTAwLVxcdTE5MUNcXHUxOTUwLVxcdTE5NkRcXHUxOTcwLVxcdTE5NzRcXHUxOTgwLVxcdTE5QUJcXHUxOUMxLVxcdTE5QzdcXHUxQTAwLVxcdTFBMTZcXHUxQTIwLVxcdTFBNTRcXHUxQUE3XFx1MUIwNS1cXHUxQjMzXFx1MUI0NS1cXHUxQjRCXFx1MUI4My1cXHUxQkEwXFx1MUJBRVxcdTFCQUZcXHUxQkJBLVxcdTFCRTVcXHUxQzAwLVxcdTFDMjNcXHUxQzRELVxcdTFDNEZcXHUxQzVBLVxcdTFDN0RcXHUxQ0U5LVxcdTFDRUNcXHUxQ0VFLVxcdTFDRjFcXHUxQ0Y1XFx1MUNGNlxcdTFEMDAtXFx1MURCRlxcdTFFMDAtXFx1MUYxNVxcdTFGMTgtXFx1MUYxRFxcdTFGMjAtXFx1MUY0NVxcdTFGNDgtXFx1MUY0RFxcdTFGNTAtXFx1MUY1N1xcdTFGNTlcXHUxRjVCXFx1MUY1RFxcdTFGNUYtXFx1MUY3RFxcdTFGODAtXFx1MUZCNFxcdTFGQjYtXFx1MUZCQ1xcdTFGQkVcXHUxRkMyLVxcdTFGQzRcXHUxRkM2LVxcdTFGQ0NcXHUxRkQwLVxcdTFGRDNcXHUxRkQ2LVxcdTFGREJcXHUxRkUwLVxcdTFGRUNcXHUxRkYyLVxcdTFGRjRcXHUxRkY2LVxcdTFGRkNcXHUyMDcxXFx1MjA3RlxcdTIwOTAtXFx1MjA5Q1xcdTIxMDJcXHUyMTA3XFx1MjEwQS1cXHUyMTEzXFx1MjExNVxcdTIxMTktXFx1MjExRFxcdTIxMjRcXHUyMTI2XFx1MjEyOFxcdTIxMkEtXFx1MjEyRFxcdTIxMkYtXFx1MjEzOVxcdTIxM0MtXFx1MjEzRlxcdTIxNDUtXFx1MjE0OVxcdTIxNEVcXHUyMTgzXFx1MjE4NFxcdTJDMDAtXFx1MkMyRVxcdTJDMzAtXFx1MkM1RVxcdTJDNjAtXFx1MkNFNFxcdTJDRUItXFx1MkNFRVxcdTJDRjJcXHUyQ0YzXFx1MkQwMC1cXHUyRDI1XFx1MkQyN1xcdTJEMkRcXHUyRDMwLVxcdTJENjdcXHUyRDZGXFx1MkQ4MC1cXHUyRDk2XFx1MkRBMC1cXHUyREE2XFx1MkRBOC1cXHUyREFFXFx1MkRCMC1cXHUyREI2XFx1MkRCOC1cXHUyREJFXFx1MkRDMC1cXHUyREM2XFx1MkRDOC1cXHUyRENFXFx1MkREMC1cXHUyREQ2XFx1MkREOC1cXHUyRERFXFx1MkUyRlxcdTMwMDVcXHUzMDA2XFx1MzAzMS1cXHUzMDM1XFx1MzAzQlxcdTMwM0NcXHUzMDQxLVxcdTMwOTZcXHUzMDlELVxcdTMwOUZcXHUzMEExLVxcdTMwRkFcXHUzMEZDLVxcdTMwRkZcXHUzMTA1LVxcdTMxMkRcXHUzMTMxLVxcdTMxOEVcXHUzMUEwLVxcdTMxQkFcXHUzMUYwLVxcdTMxRkZcXHUzNDAwLVxcdTREQjVcXHU0RTAwLVxcdTlGQ0NcXHVBMDAwLVxcdUE0OENcXHVBNEQwLVxcdUE0RkRcXHVBNTAwLVxcdUE2MENcXHVBNjEwLVxcdUE2MUZcXHVBNjJBXFx1QTYyQlxcdUE2NDAtXFx1QTY2RVxcdUE2N0YtXFx1QTY5N1xcdUE2QTAtXFx1QTZFNVxcdUE3MTctXFx1QTcxRlxcdUE3MjItXFx1QTc4OFxcdUE3OEItXFx1QTc4RVxcdUE3OTAtXFx1QTc5M1xcdUE3QTAtXFx1QTdBQVxcdUE3RjgtXFx1QTgwMVxcdUE4MDMtXFx1QTgwNVxcdUE4MDctXFx1QTgwQVxcdUE4MEMtXFx1QTgyMlxcdUE4NDAtXFx1QTg3M1xcdUE4ODItXFx1QThCM1xcdUE4RjItXFx1QThGN1xcdUE4RkJcXHVBOTBBLVxcdUE5MjVcXHVBOTMwLVxcdUE5NDZcXHVBOTYwLVxcdUE5N0NcXHVBOTg0LVxcdUE5QjJcXHVBOUNGXFx1QUEwMC1cXHVBQTI4XFx1QUE0MC1cXHVBQTQyXFx1QUE0NC1cXHVBQTRCXFx1QUE2MC1cXHVBQTc2XFx1QUE3QVxcdUFBODAtXFx1QUFBRlxcdUFBQjFcXHVBQUI1XFx1QUFCNlxcdUFBQjktXFx1QUFCRFxcdUFBQzBcXHVBQUMyXFx1QUFEQi1cXHVBQUREXFx1QUFFMC1cXHVBQUVBXFx1QUFGMi1cXHVBQUY0XFx1QUIwMS1cXHVBQjA2XFx1QUIwOS1cXHVBQjBFXFx1QUIxMS1cXHVBQjE2XFx1QUIyMC1cXHVBQjI2XFx1QUIyOC1cXHVBQjJFXFx1QUJDMC1cXHVBQkUyXFx1QUMwMC1cXHVEN0EzXFx1RDdCMC1cXHVEN0M2XFx1RDdDQi1cXHVEN0ZCXFx1RjkwMC1cXHVGQTZEXFx1RkE3MC1cXHVGQUQ5XFx1RkIwMC1cXHVGQjA2XFx1RkIxMy1cXHVGQjE3XFx1RkIxRFxcdUZCMUYtXFx1RkIyOFxcdUZCMkEtXFx1RkIzNlxcdUZCMzgtXFx1RkIzQ1xcdUZCM0VcXHVGQjQwXFx1RkI0MVxcdUZCNDNcXHVGQjQ0XFx1RkI0Ni1cXHVGQkIxXFx1RkJEMy1cXHVGRDNEXFx1RkQ1MC1cXHVGRDhGXFx1RkQ5Mi1cXHVGREM3XFx1RkRGMC1cXHVGREZCXFx1RkU3MC1cXHVGRTc0XFx1RkU3Ni1cXHVGRUZDXFx1RkYyMS1cXHVGRjNBXFx1RkY0MS1cXHVGRjVBXFx1RkY2Ni1cXHVGRkJFXFx1RkZDMi1cXHVGRkM3XFx1RkZDQS1cXHVGRkNGXFx1RkZEMi1cXHVGRkQ3XFx1RkZEQS1cXHVGRkRDXS8sIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIyMDc1MDcwXG4gICcqJzogLy4vXG59O1xuLyoqXG4gIEBwcm9wIHtzdHJpbmd9IElOUFVUXG4gIEBwcm9wIHtzdHJpbmd9IEZJWEVEXG4qL1xuUGF0dGVybkRlZmluaXRpb24uVFlQRVMgPSB7XG4gIElOUFVUOiAnaW5wdXQnLFxuICBGSVhFRDogJ2ZpeGVkJ1xufTtcblxuLyoqICovXG5cblxuLyoqICovXG5cbi8qKlxuICBQYXR0ZXJuIGdyb3VwIHN5bWJvbHMgZnJvbSBwYXJlbnRcbiAgQHBhcmFtIHtNYXNrZWRQYXR0ZXJufSBtYXNrZWQgLSBJbnRlcm5hbCB7QGxpbmsgbWFza2VkfSBtb2RlbFxuICBAcGFyYW0ge09iamVjdH0gb3B0c1xuICBAcGFyYW0ge3N0cmluZ30gb3B0cy5uYW1lIC0gR3JvdXAgbmFtZVxuICBAcGFyYW0ge251bWJlcn0gb3B0cy5vZmZzZXQgLSBHcm91cCBvZmZzZXQgaW4gbWFza2VkIGRlZmluaXRpb25zIGFycmF5XG4gIEBwYXJhbSB7c3RyaW5nfSBvcHRzLm1hc2sgLSBHcm91cCBtYXNrXG4gIEBwYXJhbSB7RnVuY3Rpb259IFtvcHRzLnZhbGlkYXRlXSAtIEN1c3RvbSBncm91cCB2YWxpZGF0b3JcbiovXG52YXIgUGF0dGVybkdyb3VwID0gZnVuY3Rpb24gKCkge1xuICAvKiogR3JvdXAgbWFzayAqL1xuXG4gIC8qKiBHcm91cCBuYW1lICovXG5cbiAgLyoqICovXG4gIGZ1bmN0aW9uIFBhdHRlcm5Hcm91cChtYXNrZWQsIF9yZWYpIHtcbiAgICB2YXIgbmFtZSA9IF9yZWYubmFtZSxcbiAgICAgICAgb2Zmc2V0ID0gX3JlZi5vZmZzZXQsXG4gICAgICAgIG1hc2sgPSBfcmVmLm1hc2ssXG4gICAgICAgIHZhbGlkYXRlID0gX3JlZi52YWxpZGF0ZTtcbiAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBQYXR0ZXJuR3JvdXApO1xuXG4gICAgdGhpcy5tYXNrZWQgPSBtYXNrZWQ7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLm9mZnNldCA9IG9mZnNldDtcbiAgICB0aGlzLm1hc2sgPSBtYXNrO1xuICAgIHRoaXMudmFsaWRhdGUgPSB2YWxpZGF0ZSB8fCBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICB9XG5cbiAgLyoqIFNsaWNlIG9mIGludGVybmFsIHtAbGluayBtYXNrZWR9IHZhbHVlICovXG5cbiAgLyoqIEN1c3RvbSBncm91cCB2YWxpZGF0b3IgKi9cblxuICAvKiogR3JvdXAgb2Zmc2V0IGluIG1hc2tlZCBkZWZpbml0aW9ucyBhcnJheSAqL1xuXG5cbiAgLyoqIEludGVybmFsIHtAbGluayBtYXNrZWR9IG1vZGVsICovXG5cbiAgLyoqICovXG5cblxuICBjcmVhdGVDbGFzcyhQYXR0ZXJuR3JvdXAsIFt7XG4gICAga2V5OiAnZG9WYWxpZGF0ZScsXG5cblxuICAgIC8qKiBWYWxpZGF0ZXMgaWYgY3VycmVudCB2YWx1ZSBpcyBhY2NlcHRhYmxlICovXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRvVmFsaWRhdGUoZmxhZ3MpIHtcbiAgICAgIHJldHVybiB0aGlzLnZhbGlkYXRlKHRoaXMudmFsdWUsIHRoaXMsIGZsYWdzKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd2YWx1ZScsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tYXNrZWQudmFsdWUuc2xpY2UodGhpcy5tYXNrZWQubWFwRGVmSW5kZXhUb1Bvcyh0aGlzLm9mZnNldCksIHRoaXMubWFza2VkLm1hcERlZkluZGV4VG9Qb3ModGhpcy5vZmZzZXQgKyB0aGlzLm1hc2subGVuZ3RoKSk7XG4gICAgfVxuXG4gICAgLyoqIFVubWFza2VkIHNsaWNlIG9mIGludGVybmFsIHtAbGluayBtYXNrZWR9IHZhbHVlICovXG5cbiAgfSwge1xuICAgIGtleTogJ3VubWFza2VkVmFsdWUnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgcmV0dXJuIHRoaXMubWFza2VkLmV4dHJhY3RJbnB1dCh0aGlzLm1hc2tlZC5tYXBEZWZJbmRleFRvUG9zKHRoaXMub2Zmc2V0KSwgdGhpcy5tYXNrZWQubWFwRGVmSW5kZXhUb1Bvcyh0aGlzLm9mZnNldCArIHRoaXMubWFzay5sZW5ndGgpKTtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIFBhdHRlcm5Hcm91cDtcbn0oKTtcblxudmFyIFJhbmdlR3JvdXAgPSBmdW5jdGlvbiAoKSB7XG4gIC8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG4gIGZ1bmN0aW9uIFJhbmdlR3JvdXAoX3JlZjIpIHtcbiAgICB2YXIgX3JlZjMgPSBzbGljZWRUb0FycmF5KF9yZWYyLCAyKSxcbiAgICAgICAgZnJvbSA9IF9yZWYzWzBdLFxuICAgICAgICB0byA9IF9yZWYzWzFdO1xuXG4gICAgdmFyIG1heGxlbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogU3RyaW5nKHRvKS5sZW5ndGg7XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgUmFuZ2VHcm91cCk7XG5cbiAgICB0aGlzLl9mcm9tID0gZnJvbTtcbiAgICB0aGlzLl90byA9IHRvO1xuICAgIHRoaXMuX21heExlbmd0aCA9IG1heGxlbjtcbiAgICB0aGlzLnZhbGlkYXRlID0gdGhpcy52YWxpZGF0ZS5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5fdXBkYXRlKCk7XG4gIH1cbiAgLyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cblxuICBjcmVhdGVDbGFzcyhSYW5nZUdyb3VwLCBbe1xuICAgIGtleTogJ191cGRhdGUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfdXBkYXRlKCkge1xuICAgICAgdGhpcy5fbWF4TGVuZ3RoID0gTWF0aC5tYXgodGhpcy5fbWF4TGVuZ3RoLCBTdHJpbmcodGhpcy50bykubGVuZ3RoKTtcbiAgICAgIHRoaXMubWFzayA9ICcwJy5yZXBlYXQodGhpcy5fbWF4TGVuZ3RoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd2YWxpZGF0ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHZhbGlkYXRlKHN0cikge1xuICAgICAgdmFyIG1pbnN0ciA9ICcnO1xuICAgICAgdmFyIG1heHN0ciA9ICcnO1xuXG4gICAgICB2YXIgX3JlZjQgPSBzdHIubWF0Y2goL14oXFxEKikoXFxkKikoXFxEKikvKSB8fCBbXSxcbiAgICAgICAgICBfcmVmNSA9IHNsaWNlZFRvQXJyYXkoX3JlZjQsIDMpLFxuICAgICAgICAgIHBsYWNlaG9sZGVyID0gX3JlZjVbMV0sXG4gICAgICAgICAgbnVtID0gX3JlZjVbMl07XG5cbiAgICAgIGlmIChudW0pIHtcbiAgICAgICAgbWluc3RyID0gJzAnLnJlcGVhdChwbGFjZWhvbGRlci5sZW5ndGgpICsgbnVtO1xuICAgICAgICBtYXhzdHIgPSAnOScucmVwZWF0KHBsYWNlaG9sZGVyLmxlbmd0aCkgKyBudW07XG4gICAgICB9XG5cbiAgICAgIHZhciBmaXJzdE5vblplcm8gPSBzdHIuc2VhcmNoKC9bXjBdLyk7XG4gICAgICBpZiAoZmlyc3ROb25aZXJvID09PSAtMSAmJiBzdHIubGVuZ3RoIDw9IHRoaXMuX21hdGNoRnJvbSkgcmV0dXJuIHRydWU7XG5cbiAgICAgIG1pbnN0ciA9IG1pbnN0ci5wYWRFbmQodGhpcy5fbWF4TGVuZ3RoLCAnMCcpO1xuICAgICAgbWF4c3RyID0gbWF4c3RyLnBhZEVuZCh0aGlzLl9tYXhMZW5ndGgsICc5Jyk7XG5cbiAgICAgIHJldHVybiB0aGlzLmZyb20gPD0gTnVtYmVyKG1heHN0cikgJiYgTnVtYmVyKG1pbnN0cikgPD0gdGhpcy50bztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd0bycsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdG87XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldCQkMSh0bykge1xuICAgICAgdGhpcy5fdG8gPSB0bztcbiAgICAgIHRoaXMuX3VwZGF0ZSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2Zyb20nLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2Zyb207XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldCQkMShmcm9tKSB7XG4gICAgICB0aGlzLl9mcm9tID0gZnJvbTtcbiAgICAgIHRoaXMuX3VwZGF0ZSgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ21heExlbmd0aCcsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbWF4TGVuZ3RoO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQkJDEobWF4TGVuZ3RoKSB7XG4gICAgICB0aGlzLl9tYXhMZW5ndGggPSBtYXhMZW5ndGg7XG4gICAgICB0aGlzLl91cGRhdGUoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdfbWF0Y2hGcm9tJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1heExlbmd0aCAtIFN0cmluZyh0aGlzLmZyb20pLmxlbmd0aDtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIFJhbmdlR3JvdXA7XG59KCk7XG5cbi8qKiBQYXR0ZXJuIGdyb3VwIHRoYXQgdmFsaWRhdGVzIGVudW0gdmFsdWVzICovXG5mdW5jdGlvbiBFbnVtR3JvdXAoZW51bXMpIHtcbiAgcmV0dXJuIHtcbiAgICBtYXNrOiAnKicucmVwZWF0KGVudW1zWzBdLmxlbmd0aCksXG4gICAgdmFsaWRhdGU6IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbHVlLCBncm91cCwgZmxhZ3MpIHtcbiAgICAgIHJldHVybiBlbnVtcy5zb21lKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHJldHVybiBlLmluZGV4T2YoZ3JvdXAudW5tYXNrZWRWYWx1ZSkgPj0gMDtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1cblxuUGF0dGVybkdyb3VwLlJhbmdlID0gUmFuZ2VHcm91cDtcblBhdHRlcm5Hcm91cC5FbnVtID0gRW51bUdyb3VwO1xuXG52YXIgQ2h1bmtzVGFpbERldGFpbHMgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENodW5rc1RhaWxEZXRhaWxzKGNodW5rcykge1xuICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIENodW5rc1RhaWxEZXRhaWxzKTtcblxuICAgIHRoaXMuY2h1bmtzID0gY2h1bmtzO1xuICB9XG5cbiAgY3JlYXRlQ2xhc3MoQ2h1bmtzVGFpbERldGFpbHMsIFt7XG4gICAga2V5OiAndmFsdWUnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgcmV0dXJuIHRoaXMuY2h1bmtzLm1hcChmdW5jdGlvbiAoYykge1xuICAgICAgICByZXR1cm4gYy52YWx1ZTtcbiAgICAgIH0pLmpvaW4oJycpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2Zyb21Qb3MnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgdmFyIGZpcnN0Q2h1bmsgPSB0aGlzLmNodW5rc1swXTtcbiAgICAgIHJldHVybiBmaXJzdENodW5rICYmIGZpcnN0Q2h1bmsuc3RvcDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd0b1BvcycsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICB2YXIgbGFzdENodW5rID0gdGhpcy5jaHVua3NbdGhpcy5jaHVua3MubGVuZ3RoIC0gMV07XG4gICAgICByZXR1cm4gbGFzdENodW5rICYmIGxhc3RDaHVuay5zdG9wO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gQ2h1bmtzVGFpbERldGFpbHM7XG59KCk7XG5cbi8qKlxuICBQYXR0ZXJuIG1hc2tcbiAgQHBhcmFtIHtPYmplY3R9IG9wdHNcbiAgQHBhcmFtIHtPYmplY3R9IG9wdHMuZ3JvdXBzXG4gIEBwYXJhbSB7T2JqZWN0fSBvcHRzLmRlZmluaXRpb25zXG4gIEBwYXJhbSB7c3RyaW5nfSBvcHRzLnBsYWNlaG9sZGVyQ2hhclxuICBAcGFyYW0ge2Jvb2xlYW59IG9wdHMubGF6eVxuKi9cbnZhciBNYXNrZWRQYXR0ZXJuID0gZnVuY3Rpb24gKF9NYXNrZWQpIHtcbiAgaW5oZXJpdHMoTWFza2VkUGF0dGVybiwgX01hc2tlZCk7XG5cbiAgLy8gVE9ETyBtYXNrIHR5cGVcbiAgLyoqIFNpbmdsZSBjaGFyIGZvciBlbXB0eSBpbnB1dCAqL1xuXG5cbiAgLyoqICovXG4gIGZ1bmN0aW9uIE1hc2tlZFBhdHRlcm4oKSB7XG4gICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIE1hc2tlZFBhdHRlcm4pO1xuICAgIC8vIFRPRE8gdHlwZSAkU2hhcGU8TWFza2VkUGF0dGVybk9wdGlvbnM+PXt9IGRvZXMgbm90IHdvcmtcbiAgICBvcHRzLmRlZmluaXRpb25zID0gX2V4dGVuZHMoe30sIFBhdHRlcm5EZWZpbml0aW9uLkRFRkFVTFRTLCBvcHRzLmRlZmluaXRpb25zKTtcbiAgICByZXR1cm4gcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoTWFza2VkUGF0dGVybi5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1hc2tlZFBhdHRlcm4pKS5jYWxsKHRoaXMsIF9leHRlbmRzKHt9LCBNYXNrZWRQYXR0ZXJuLkRFRkFVTFRTLCBvcHRzKSkpO1xuICB9XG5cbiAgLyoqXG4gICAgQG92ZXJyaWRlXG4gICAgQHBhcmFtIHtPYmplY3R9IG9wdHNcbiAgKi9cblxuICAvKiogU2hvdyBwbGFjZWhvbGRlciBvbmx5IHdoZW4gbmVlZGVkICovXG5cbiAgLyoqICovXG5cblxuICBjcmVhdGVDbGFzcyhNYXNrZWRQYXR0ZXJuLCBbe1xuICAgIGtleTogJ191cGRhdGUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfdXBkYXRlKCkge1xuICAgICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuXG4gICAgICBvcHRzLmRlZmluaXRpb25zID0gX2V4dGVuZHMoe30sIHRoaXMuZGVmaW5pdGlvbnMsIG9wdHMuZGVmaW5pdGlvbnMpO1xuICAgICAgZ2V0KE1hc2tlZFBhdHRlcm4ucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkUGF0dGVybi5wcm90b3R5cGUpLCAnX3VwZGF0ZScsIHRoaXMpLmNhbGwodGhpcywgb3B0cyk7XG4gICAgICB0aGlzLl9yZWJ1aWxkTWFzaygpO1xuICAgIH1cblxuICAgIC8qKiAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdfcmVidWlsZE1hc2snLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVidWlsZE1hc2soKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdmFyIGRlZnMgPSB0aGlzLmRlZmluaXRpb25zO1xuICAgICAgdGhpcy5fY2hhckRlZnMgPSBbXTtcbiAgICAgIHRoaXMuX2dyb3VwRGVmcyA9IFtdO1xuXG4gICAgICB2YXIgcGF0dGVybiA9IHRoaXMubWFzaztcbiAgICAgIGlmICghcGF0dGVybiB8fCAhZGVmcykgcmV0dXJuO1xuXG4gICAgICB2YXIgdW5tYXNraW5nQmxvY2sgPSBmYWxzZTtcbiAgICAgIHZhciBvcHRpb25hbEJsb2NrID0gZmFsc2U7XG4gICAgICB2YXIgc3RvcEFsaWduID0gZmFsc2U7XG5cbiAgICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKF9pKSB7XG4gICAgICAgIGlmIChfdGhpczIuZ3JvdXBzKSB7XG4gICAgICAgICAgdmFyIHAgPSBwYXR0ZXJuLnNsaWNlKF9pKTtcbiAgICAgICAgICB2YXIgZ05hbWVzID0gT2JqZWN0LmtleXMoX3RoaXMyLmdyb3VwcykuZmlsdGVyKGZ1bmN0aW9uIChnTmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHAuaW5kZXhPZihnTmFtZSkgPT09IDA7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgLy8gb3JkZXIgYnkga2V5IGxlbmd0aFxuICAgICAgICAgIGdOYW1lcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICByZXR1cm4gYi5sZW5ndGggLSBhLmxlbmd0aDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvLyB1c2UgZ3JvdXAgbmFtZSB3aXRoIG1heCBsZW5ndGhcbiAgICAgICAgICB2YXIgZ05hbWUgPSBnTmFtZXNbMF07XG4gICAgICAgICAgaWYgKGdOYW1lKSB7XG4gICAgICAgICAgICB2YXIgZ3JvdXAgPSBfdGhpczIuZ3JvdXBzW2dOYW1lXTtcbiAgICAgICAgICAgIF90aGlzMi5fZ3JvdXBEZWZzLnB1c2gobmV3IFBhdHRlcm5Hcm91cChfdGhpczIsIHtcbiAgICAgICAgICAgICAgbmFtZTogZ05hbWUsXG4gICAgICAgICAgICAgIG9mZnNldDogX3RoaXMyLl9jaGFyRGVmcy5sZW5ndGgsXG4gICAgICAgICAgICAgIG1hc2s6IGdyb3VwLm1hc2ssXG4gICAgICAgICAgICAgIHZhbGlkYXRlOiBncm91cC52YWxpZGF0ZVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcGF0dGVybiA9IHBhdHRlcm4ucmVwbGFjZShnTmFtZSwgZ3JvdXAubWFzayk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGNoYXIgPSBwYXR0ZXJuW19pXTtcbiAgICAgICAgdmFyIHR5cGUgPSBjaGFyIGluIGRlZnMgPyBQYXR0ZXJuRGVmaW5pdGlvbi5UWVBFUy5JTlBVVCA6IFBhdHRlcm5EZWZpbml0aW9uLlRZUEVTLkZJWEVEO1xuICAgICAgICB2YXIgdW5tYXNraW5nID0gdHlwZSA9PT0gUGF0dGVybkRlZmluaXRpb24uVFlQRVMuSU5QVVQgfHwgdW5tYXNraW5nQmxvY2s7XG4gICAgICAgIHZhciBvcHRpb25hbCA9IHR5cGUgPT09IFBhdHRlcm5EZWZpbml0aW9uLlRZUEVTLklOUFVUICYmIG9wdGlvbmFsQmxvY2s7XG5cbiAgICAgICAgaWYgKGNoYXIgPT09IE1hc2tlZFBhdHRlcm4uU1RPUF9DSEFSKSB7XG4gICAgICAgICAgc3RvcEFsaWduID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gJ2NvbnRpbnVlJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjaGFyID09PSAneycgfHwgY2hhciA9PT0gJ30nKSB7XG4gICAgICAgICAgdW5tYXNraW5nQmxvY2sgPSAhdW5tYXNraW5nQmxvY2s7XG4gICAgICAgICAgcmV0dXJuICdjb250aW51ZSc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY2hhciA9PT0gJ1snIHx8IGNoYXIgPT09ICddJykge1xuICAgICAgICAgIG9wdGlvbmFsQmxvY2sgPSAhb3B0aW9uYWxCbG9jaztcbiAgICAgICAgICByZXR1cm4gJ2NvbnRpbnVlJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjaGFyID09PSBNYXNrZWRQYXR0ZXJuLkVTQ0FQRV9DSEFSKSB7XG4gICAgICAgICAgKytfaTtcbiAgICAgICAgICBjaGFyID0gcGF0dGVybltfaV07XG4gICAgICAgICAgaWYgKCFjaGFyKSByZXR1cm4gJ2JyZWFrJztcbiAgICAgICAgICB0eXBlID0gUGF0dGVybkRlZmluaXRpb24uVFlQRVMuRklYRUQ7XG4gICAgICAgIH1cblxuICAgICAgICBfdGhpczIuX2NoYXJEZWZzLnB1c2gobmV3IFBhdHRlcm5EZWZpbml0aW9uKHtcbiAgICAgICAgICBjaGFyOiBjaGFyLFxuICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgb3B0aW9uYWw6IG9wdGlvbmFsLFxuICAgICAgICAgIHN0b3BBbGlnbjogc3RvcEFsaWduLFxuICAgICAgICAgIHVubWFza2luZzogdW5tYXNraW5nLFxuICAgICAgICAgIG1hc2s6IHR5cGUgPT09IFBhdHRlcm5EZWZpbml0aW9uLlRZUEVTLklOUFVUID8gZGVmc1tjaGFyXSA6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlID09PSBjaGFyO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHN0b3BBbGlnbiA9IGZhbHNlO1xuICAgICAgICBpID0gX2k7XG4gICAgICB9O1xuXG4gICAgICBfbG9vcDI6IGZvciAodmFyIGkgPSAwOyBpIDwgcGF0dGVybi5sZW5ndGg7ICsraSkge1xuICAgICAgICB2YXIgX3JldCA9IF9sb29wKGkpO1xuXG4gICAgICAgIHN3aXRjaCAoX3JldCkge1xuICAgICAgICAgIGNhc2UgJ2NvbnRpbnVlJzpcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgY2FzZSAnYnJlYWsnOlxuICAgICAgICAgICAgYnJlYWsgX2xvb3AyO31cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgIEBvdmVycmlkZVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ2RvVmFsaWRhdGUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBkb1ZhbGlkYXRlKCkge1xuICAgICAgdmFyIF9iYWJlbEhlbHBlcnMkZ2V0O1xuXG4gICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5fZ3JvdXBEZWZzLmV2ZXJ5KGZ1bmN0aW9uIChnJCQxKSB7XG4gICAgICAgIHJldHVybiBnJCQxLmRvVmFsaWRhdGUuYXBwbHkoZyQkMSwgdG9Db25zdW1hYmxlQXJyYXkoYXJncykpO1xuICAgICAgfSkgJiYgKF9iYWJlbEhlbHBlcnMkZ2V0ID0gZ2V0KE1hc2tlZFBhdHRlcm4ucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkUGF0dGVybi5wcm90b3R5cGUpLCAnZG9WYWxpZGF0ZScsIHRoaXMpKS5jYWxsLmFwcGx5KF9iYWJlbEhlbHBlcnMkZ2V0LCBbdGhpc10uY29uY2F0KHRvQ29uc3VtYWJsZUFycmF5KGFyZ3MpKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICBAb3ZlcnJpZGVcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdjbG9uZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNsb25lKCkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIHZhciBtID0gbmV3IE1hc2tlZFBhdHRlcm4odGhpcyk7XG4gICAgICBtLl92YWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICAvLyAkRmxvd0ZpeE1lXG4gICAgICBtLl9jaGFyRGVmcy5mb3JFYWNoKGZ1bmN0aW9uIChkLCBpKSB7XG4gICAgICAgIHJldHVybiBfZXh0ZW5kcyhkLCBfdGhpczMuX2NoYXJEZWZzW2ldKTtcbiAgICAgIH0pO1xuICAgICAgLy8gJEZsb3dGaXhNZVxuICAgICAgbS5fZ3JvdXBEZWZzLmZvckVhY2goZnVuY3Rpb24gKGQsIGkpIHtcbiAgICAgICAgcmV0dXJuIF9leHRlbmRzKGQsIF90aGlzMy5fZ3JvdXBEZWZzW2ldKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICBAb3ZlcnJpZGVcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdyZXNldCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgICAgZ2V0KE1hc2tlZFBhdHRlcm4ucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkUGF0dGVybi5wcm90b3R5cGUpLCAncmVzZXQnLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5fY2hhckRlZnMuZm9yRWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICBkZWxldGUgZC5pc0hvbGxvdztcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnaGlkZGVuSG9sbG93c0JlZm9yZScsXG5cblxuICAgIC8qKiAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbiBoaWRkZW5Ib2xsb3dzQmVmb3JlKGRlZkluZGV4KSB7XG4gICAgICByZXR1cm4gdGhpcy5fY2hhckRlZnMuc2xpY2UoMCwgZGVmSW5kZXgpLmZpbHRlcihmdW5jdGlvbiAoZCkge1xuICAgICAgICByZXR1cm4gZC5pc0hpZGRlbkhvbGxvdztcbiAgICAgIH0pLmxlbmd0aDtcbiAgICB9XG5cbiAgICAvKiogTWFwIGRlZmluaXRpb24gaW5kZXggdG8gcG9zaXRpb24gb24gdmlldyAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdtYXBEZWZJbmRleFRvUG9zJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gbWFwRGVmSW5kZXhUb1BvcyhkZWZJbmRleCkge1xuICAgICAgcmV0dXJuIGRlZkluZGV4IC0gdGhpcy5oaWRkZW5Ib2xsb3dzQmVmb3JlKGRlZkluZGV4KTtcbiAgICB9XG5cbiAgICAvKiogTWFwIHBvc2l0aW9uIG9uIHZpZXcgdG8gZGVmaW5pdGlvbiBpbmRleCAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdtYXBQb3NUb0RlZkluZGV4JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gbWFwUG9zVG9EZWZJbmRleChwb3MpIHtcbiAgICAgIHZhciBkZWZJbmRleCA9IHBvcztcbiAgICAgIGZvciAodmFyIGRpID0gMDsgZGkgPCB0aGlzLl9jaGFyRGVmcy5sZW5ndGg7ICsrZGkpIHtcbiAgICAgICAgdmFyIGRlZiA9IHRoaXMuX2NoYXJEZWZzW2RpXTtcbiAgICAgICAgaWYgKGRpID49IGRlZkluZGV4KSBicmVhaztcbiAgICAgICAgaWYgKGRlZi5pc0hpZGRlbkhvbGxvdykgKytkZWZJbmRleDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBkZWZJbmRleDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgIEBvdmVycmlkZVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ19hcHBlbmRUYWlsJyxcblxuXG4gICAgLyoqXG4gICAgICBAb3ZlcnJpZGVcbiAgICAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbiBfYXBwZW5kVGFpbCh0YWlsKSB7XG4gICAgICB2YXIgZGV0YWlscyA9IG5ldyBDaGFuZ2VEZXRhaWxzKCk7XG4gICAgICBpZiAodGFpbCkge1xuICAgICAgICBkZXRhaWxzLmFnZ3JlZ2F0ZSh0YWlsIGluc3RhbmNlb2YgQ2h1bmtzVGFpbERldGFpbHMgPyB0aGlzLl9hcHBlbmRDaHVua3ModGFpbC5jaHVua3MsIHsgdGFpbDogdHJ1ZSB9KSA6IGdldChNYXNrZWRQYXR0ZXJuLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1hc2tlZFBhdHRlcm4ucHJvdG90eXBlKSwgJ19hcHBlbmRUYWlsJywgdGhpcykuY2FsbCh0aGlzLCB0YWlsKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZGV0YWlscy5hZ2dyZWdhdGUodGhpcy5fYXBwZW5kUGxhY2Vob2xkZXIoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICBAb3ZlcnJpZGVcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdfYXBwZW5kJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2FwcGVuZChzdHIpIHtcbiAgICAgIHZhciBmbGFncyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICAgIHZhciBvbGRWYWx1ZUxlbmd0aCA9IHRoaXMudmFsdWUubGVuZ3RoO1xuICAgICAgdmFyIHJhd0luc2VydGVkID0gJyc7XG4gICAgICB2YXIgb3ZlcmZsb3cgPSBmYWxzZTtcblxuICAgICAgc3RyID0gdGhpcy5kb1ByZXBhcmUoc3RyLCBmbGFncyk7XG5cbiAgICAgIGZvciAodmFyIGNpID0gMCwgZGkgPSB0aGlzLm1hcFBvc1RvRGVmSW5kZXgodGhpcy52YWx1ZS5sZW5ndGgpOyBjaSA8IHN0ci5sZW5ndGg7KSB7XG4gICAgICAgIHZhciBjaCA9IHN0cltjaV07XG4gICAgICAgIHZhciBkZWYgPSB0aGlzLl9jaGFyRGVmc1tkaV07XG5cbiAgICAgICAgLy8gY2hlY2sgb3ZlcmZsb3dcbiAgICAgICAgaWYgKGRlZiA9PSBudWxsKSB7XG4gICAgICAgICAgb3ZlcmZsb3cgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcmVzZXRcbiAgICAgICAgZGVmLmlzSG9sbG93ID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIHJlc29sdmVkID0gdm9pZCAwLFxuICAgICAgICAgICAgc2tpcHBlZCA9IHZvaWQgMDtcbiAgICAgICAgdmFyIGNocmVzID0gY29uZm9ybShkZWYucmVzb2x2ZShjaCksIGNoKTtcblxuICAgICAgICBpZiAoZGVmLnR5cGUgPT09IFBhdHRlcm5EZWZpbml0aW9uLlRZUEVTLklOUFVUKSB7XG4gICAgICAgICAgaWYgKGNocmVzKSB7XG4gICAgICAgICAgICB0aGlzLl92YWx1ZSArPSBjaHJlcztcbiAgICAgICAgICAgIGlmICghdGhpcy5kb1ZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgICAgY2hyZXMgPSAnJztcbiAgICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSB0aGlzLnZhbHVlLnNsaWNlKDAsIC0xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXNvbHZlZCA9ICEhY2hyZXM7XG4gICAgICAgICAgc2tpcHBlZCA9ICFjaHJlcyAmJiAhZGVmLm9wdGlvbmFsO1xuXG4gICAgICAgICAgaWYgKCFjaHJlcykge1xuICAgICAgICAgICAgaWYgKCFkZWYub3B0aW9uYWwgJiYgIWZsYWdzLmlucHV0ICYmICF0aGlzLmxhenkpIHtcbiAgICAgICAgICAgICAgdGhpcy5fdmFsdWUgKz0gdGhpcy5wbGFjZWhvbGRlckNoYXI7XG4gICAgICAgICAgICAgIHNraXBwZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghc2tpcHBlZCkgZGVmLmlzSG9sbG93ID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmF3SW5zZXJ0ZWQgKz0gY2hyZXM7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX3ZhbHVlICs9IGRlZi5jaGFyO1xuICAgICAgICAgIHJlc29sdmVkID0gY2hyZXMgJiYgKGRlZi51bm1hc2tpbmcgfHwgZmxhZ3MuaW5wdXQgfHwgZmxhZ3MucmF3KSAmJiAhZmxhZ3MudGFpbDtcbiAgICAgICAgICBkZWYuaXNSYXdJbnB1dCA9IHJlc29sdmVkICYmIChmbGFncy5yYXcgfHwgZmxhZ3MuaW5wdXQpO1xuICAgICAgICAgIGlmIChkZWYuaXNSYXdJbnB1dCkgcmF3SW5zZXJ0ZWQgKz0gZGVmLmNoYXI7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXNraXBwZWQpICsrZGk7XG4gICAgICAgIGlmIChyZXNvbHZlZCB8fCBza2lwcGVkKSArK2NpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbmV3IENoYW5nZURldGFpbHMoe1xuICAgICAgICBpbnNlcnRlZDogdGhpcy52YWx1ZS5zbGljZShvbGRWYWx1ZUxlbmd0aCksXG4gICAgICAgIHJhd0luc2VydGVkOiByYXdJbnNlcnRlZCxcbiAgICAgICAgb3ZlcmZsb3c6IG92ZXJmbG93XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKiogQXBwZW5kcyBjaHVua3Mgc3BsaXR0ZWQgYnkgc3RvcCBjaGFycyAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdfYXBwZW5kQ2h1bmtzJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2FwcGVuZENodW5rcyhjaHVua3MpIHtcbiAgICAgIHZhciBkZXRhaWxzID0gbmV3IENoYW5nZURldGFpbHMoKTtcblxuICAgICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gQXJyYXkoX2xlbjIgPiAxID8gX2xlbjIgLSAxIDogMCksIF9rZXkyID0gMTsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykge1xuICAgICAgICBhcmdzW19rZXkyIC0gMV0gPSBhcmd1bWVudHNbX2tleTJdO1xuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBjaSA9IDA7IGNpIDwgY2h1bmtzLmxlbmd0aDsgKytjaSkge1xuICAgICAgICB2YXIgX2NodW5rcyRjaSA9IGNodW5rc1tjaV0sXG4gICAgICAgICAgICBzdG9wID0gX2NodW5rcyRjaS5zdG9wLFxuICAgICAgICAgICAgdmFsdWUgPSBfY2h1bmtzJGNpLnZhbHVlO1xuXG4gICAgICAgIHZhciBmcm9tRGVmID0gc3RvcCAhPSBudWxsICYmIHRoaXMuX2NoYXJEZWZzW3N0b3BdO1xuICAgICAgICAvLyBsZXRzIGRvdWJsZSBjaGVjayBpZiBzdG9wQWxpZ24gaXMgaGVyZVxuICAgICAgICBpZiAoZnJvbURlZiAmJiBmcm9tRGVmLnN0b3BBbGlnbikgZGV0YWlscy5hZ2dyZWdhdGUodGhpcy5fYXBwZW5kUGxhY2Vob2xkZXIoc3RvcCkpO1xuICAgICAgICBpZiAoZGV0YWlscy5hZ2dyZWdhdGUodGhpcy5fYXBwZW5kLmFwcGx5KHRoaXMsIFt2YWx1ZV0uY29uY2F0KHRvQ29uc3VtYWJsZUFycmF5KGFyZ3MpKSkpLm92ZXJmbG93KSBicmVhaztcbiAgICAgIH1cbiAgICAgIHJldHVybiBkZXRhaWxzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnX2V4dHJhY3RUYWlsJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2V4dHJhY3RUYWlsKCkge1xuICAgICAgdmFyIGZyb21Qb3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDA7XG4gICAgICB2YXIgdG9Qb3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHRoaXMudmFsdWUubGVuZ3RoO1xuXG4gICAgICByZXR1cm4gbmV3IENodW5rc1RhaWxEZXRhaWxzKHRoaXMuX2V4dHJhY3RJbnB1dENodW5rcyhmcm9tUG9zLCB0b1BvcykpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnZXh0cmFjdElucHV0JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXh0cmFjdElucHV0KCkge1xuICAgICAgdmFyIGZyb21Qb3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDA7XG4gICAgICB2YXIgdG9Qb3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHRoaXMudmFsdWUubGVuZ3RoO1xuICAgICAgdmFyIGZsYWdzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTtcblxuICAgICAgaWYgKGZyb21Qb3MgPT09IHRvUG9zKSByZXR1cm4gJyc7XG5cbiAgICAgIHZhciBzdHIgPSB0aGlzLnZhbHVlO1xuICAgICAgdmFyIGlucHV0ID0gJyc7XG5cbiAgICAgIHZhciB0b0RlZkluZGV4ID0gdGhpcy5tYXBQb3NUb0RlZkluZGV4KHRvUG9zKTtcbiAgICAgIGZvciAodmFyIGNpID0gZnJvbVBvcywgZGkgPSB0aGlzLm1hcFBvc1RvRGVmSW5kZXgoZnJvbVBvcyk7IGNpIDwgdG9Qb3MgJiYgY2kgPCBzdHIubGVuZ3RoICYmIGRpIDwgdG9EZWZJbmRleDsgKytkaSkge1xuICAgICAgICB2YXIgY2ggPSBzdHJbY2ldO1xuICAgICAgICB2YXIgZGVmID0gdGhpcy5fY2hhckRlZnNbZGldO1xuXG4gICAgICAgIGlmICghZGVmKSBicmVhaztcbiAgICAgICAgaWYgKGRlZi5pc0hpZGRlbkhvbGxvdykgY29udGludWU7XG5cbiAgICAgICAgaWYgKGRlZi5pc0lucHV0ICYmICFkZWYuaXNIb2xsb3cgfHwgZmxhZ3MucmF3ICYmICFkZWYuaXNJbnB1dCAmJiBkZWYuaXNSYXdJbnB1dCkgaW5wdXQgKz0gY2g7XG4gICAgICAgICsrY2k7XG4gICAgICB9XG4gICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxuXG4gICAgLyoqIEV4dHJhY3RzIGNodW5rcyBmcm9tIGlucHV0IHNwbGl0dGVkIGJ5IHN0b3AgY2hhcnMgKi9cblxuICB9LCB7XG4gICAga2V5OiAnX2V4dHJhY3RJbnB1dENodW5rcycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9leHRyYWN0SW5wdXRDaHVua3MoKSB7XG4gICAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgICAgdmFyIGZyb21Qb3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDA7XG4gICAgICB2YXIgdG9Qb3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHRoaXMudmFsdWUubGVuZ3RoO1xuXG4gICAgICBpZiAoZnJvbVBvcyA9PT0gdG9Qb3MpIHJldHVybiBbXTtcblxuICAgICAgdmFyIGZyb21EZWZJbmRleCA9IHRoaXMubWFwUG9zVG9EZWZJbmRleChmcm9tUG9zKTtcbiAgICAgIHZhciB0b0RlZkluZGV4ID0gdGhpcy5tYXBQb3NUb0RlZkluZGV4KHRvUG9zKTtcbiAgICAgIHZhciBzdG9wRGVmSW5kaWNlcyA9IHRoaXMuX2NoYXJEZWZzLm1hcChmdW5jdGlvbiAoZCwgaSkge1xuICAgICAgICByZXR1cm4gW2QsIGldO1xuICAgICAgfSkuc2xpY2UoZnJvbURlZkluZGV4LCB0b0RlZkluZGV4KS5maWx0ZXIoZnVuY3Rpb24gKF9yZWYpIHtcbiAgICAgICAgdmFyIF9yZWYyID0gc2xpY2VkVG9BcnJheShfcmVmLCAxKSxcbiAgICAgICAgICAgIGQgPSBfcmVmMlswXTtcblxuICAgICAgICByZXR1cm4gZC5zdG9wQWxpZ247XG4gICAgICB9KS5tYXAoZnVuY3Rpb24gKF9yZWYzKSB7XG4gICAgICAgIHZhciBfcmVmNCA9IHNsaWNlZFRvQXJyYXkoX3JlZjMsIDIpLFxuICAgICAgICAgICAgaSA9IF9yZWY0WzFdO1xuXG4gICAgICAgIHJldHVybiBpO1xuICAgICAgfSk7XG5cbiAgICAgIHZhciBzdG9wcyA9IFtmcm9tRGVmSW5kZXhdLmNvbmNhdCh0b0NvbnN1bWFibGVBcnJheShzdG9wRGVmSW5kaWNlcyksIFt0b0RlZkluZGV4XSk7XG5cbiAgICAgIHJldHVybiBzdG9wcy5tYXAoZnVuY3Rpb24gKHMsIGkpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdG9wOiBzdG9wRGVmSW5kaWNlcy5pbmRleE9mKHMpID49IDAgPyBzIDogbnVsbCxcblxuICAgICAgICAgIHZhbHVlOiBfdGhpczQuZXh0cmFjdElucHV0KF90aGlzNC5tYXBEZWZJbmRleFRvUG9zKHMpLCBfdGhpczQubWFwRGVmSW5kZXhUb1BvcyhzdG9wc1srK2ldKSlcbiAgICAgICAgfTtcbiAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAoX3JlZjUpIHtcbiAgICAgICAgdmFyIHN0b3AgPSBfcmVmNS5zdG9wLFxuICAgICAgICAgICAgdmFsdWUgPSBfcmVmNS52YWx1ZTtcbiAgICAgICAgcmV0dXJuIHN0b3AgIT0gbnVsbCB8fCB2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKiBBcHBlbmRzIHBsYWNlaG9sZGVyIGRlcGVuZGluZyBvbiBsYXppbmVzcyAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdfYXBwZW5kUGxhY2Vob2xkZXInLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfYXBwZW5kUGxhY2Vob2xkZXIodG9EZWZJbmRleCkge1xuICAgICAgdmFyIG9sZFZhbHVlTGVuZ3RoID0gdGhpcy52YWx1ZS5sZW5ndGg7XG4gICAgICB2YXIgbWF4RGVmSW5kZXggPSB0b0RlZkluZGV4IHx8IHRoaXMuX2NoYXJEZWZzLmxlbmd0aDtcbiAgICAgIGZvciAodmFyIGRpID0gdGhpcy5tYXBQb3NUb0RlZkluZGV4KHRoaXMudmFsdWUubGVuZ3RoKTsgZGkgPCBtYXhEZWZJbmRleDsgKytkaSkge1xuICAgICAgICB2YXIgZGVmID0gdGhpcy5fY2hhckRlZnNbZGldO1xuICAgICAgICBpZiAoZGVmLmlzSW5wdXQpIGRlZi5pc0hvbGxvdyA9IHRydWU7XG5cbiAgICAgICAgaWYgKCF0aGlzLmxhenkgfHwgdG9EZWZJbmRleCkge1xuICAgICAgICAgIHRoaXMuX3ZhbHVlICs9ICFkZWYuaXNJbnB1dCAmJiBkZWYuY2hhciAhPSBudWxsID8gZGVmLmNoYXIgOiAhZGVmLm9wdGlvbmFsID8gdGhpcy5wbGFjZWhvbGRlckNoYXIgOiAnJztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG5ldyBDaGFuZ2VEZXRhaWxzKHtcbiAgICAgICAgaW5zZXJ0ZWQ6IHRoaXMudmFsdWUuc2xpY2Uob2xkVmFsdWVMZW5ndGgpXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgIEBvdmVycmlkZVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ3JlbW92ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgIHZhciBmcm9tID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAwO1xuICAgICAgdmFyIGNvdW50ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB0aGlzLnZhbHVlLmxlbmd0aCAtIGZyb207XG5cbiAgICAgIHZhciBmcm9tRGVmSW5kZXggPSB0aGlzLm1hcFBvc1RvRGVmSW5kZXgoZnJvbSk7XG4gICAgICB2YXIgdG9EZWZJbmRleCA9IHRoaXMubWFwUG9zVG9EZWZJbmRleChmcm9tICsgY291bnQpO1xuICAgICAgdGhpcy5fY2hhckRlZnMuc2xpY2UoZnJvbURlZkluZGV4LCB0b0RlZkluZGV4KS5mb3JFYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHJldHVybiBkLnJlc2V0KCk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGdldChNYXNrZWRQYXR0ZXJuLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1hc2tlZFBhdHRlcm4ucHJvdG90eXBlKSwgJ3JlbW92ZScsIHRoaXMpLmNhbGwodGhpcywgZnJvbSwgY291bnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnbmVhcmVzdElucHV0UG9zJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gbmVhcmVzdElucHV0UG9zKGN1cnNvclBvcykge1xuICAgICAgdmFyIGRpcmVjdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogRElSRUNUSU9OLk5PTkU7XG5cbiAgICAgIHZhciBzdGVwID0gZGlyZWN0aW9uIHx8IERJUkVDVElPTi5SSUdIVDtcblxuICAgICAgdmFyIGluaXRpYWxEZWZJbmRleCA9IHRoaXMubWFwUG9zVG9EZWZJbmRleChjdXJzb3JQb3MpO1xuICAgICAgdmFyIGluaXRpYWxEZWYgPSB0aGlzLl9jaGFyRGVmc1tpbml0aWFsRGVmSW5kZXhdO1xuICAgICAgdmFyIGRpID0gaW5pdGlhbERlZkluZGV4O1xuXG4gICAgICB2YXIgZmlyc3RJbnB1dEluZGV4ID0gdm9pZCAwLFxuICAgICAgICAgIGZpcnN0RmlsbGVkSW5wdXRJbmRleCA9IHZvaWQgMCxcbiAgICAgICAgICBmaXJzdFZpc2libGVIb2xsb3dJbmRleCA9IHZvaWQgMCxcbiAgICAgICAgICBuZXh0ZGkgPSB2b2lkIDA7XG5cbiAgICAgIC8vIGNoZWNrIGlmIGNoYXJzIGF0IHJpZ2h0IGlzIGFjY2VwdGFibGUgZm9yIExFRlQgYW5kIE5PTkUgZGlyZWN0aW9uc1xuICAgICAgaWYgKGRpcmVjdGlvbiAhPT0gRElSRUNUSU9OLlJJR0hUICYmIChpbml0aWFsRGVmICYmIGluaXRpYWxEZWYuaXNJbnB1dCB8fFxuICAgICAgLy8gaW4gbm9uZSBkaXJlY3Rpb24gbGF0ZXN0IHBvc2l0aW9uIGlzIGFjY2VwdGFibGUgYWxzb1xuICAgICAgZGlyZWN0aW9uID09PSBESVJFQ1RJT04uTk9ORSAmJiBjdXJzb3JQb3MgPT09IHRoaXMudmFsdWUubGVuZ3RoKSkge1xuICAgICAgICBmaXJzdElucHV0SW5kZXggPSBpbml0aWFsRGVmSW5kZXg7XG4gICAgICAgIGlmIChpbml0aWFsRGVmICYmICFpbml0aWFsRGVmLmlzSG9sbG93KSBmaXJzdEZpbGxlZElucHV0SW5kZXggPSBpbml0aWFsRGVmSW5kZXg7XG4gICAgICB9XG5cbiAgICAgIGlmIChmaXJzdEZpbGxlZElucHV0SW5kZXggPT0gbnVsbCAmJiBkaXJlY3Rpb24gPT0gRElSRUNUSU9OLkxFRlQgfHwgZmlyc3RJbnB1dEluZGV4ID09IG51bGwpIHtcbiAgICAgICAgLy8gc2VhcmNoIGZvcndhcmRcbiAgICAgICAgZm9yIChuZXh0ZGkgPSBpbmRleEluRGlyZWN0aW9uKGRpLCBzdGVwKTsgMCA8PSBuZXh0ZGkgJiYgbmV4dGRpIDwgdGhpcy5fY2hhckRlZnMubGVuZ3RoOyBkaSArPSBzdGVwLCBuZXh0ZGkgKz0gc3RlcCkge1xuICAgICAgICAgIHZhciBuZXh0RGVmID0gdGhpcy5fY2hhckRlZnNbbmV4dGRpXTtcbiAgICAgICAgICBpZiAoZmlyc3RJbnB1dEluZGV4ID09IG51bGwgJiYgbmV4dERlZi5pc0lucHV0KSB7XG4gICAgICAgICAgICBmaXJzdElucHV0SW5kZXggPSBkaTtcbiAgICAgICAgICAgIGlmIChkaXJlY3Rpb24gPT09IERJUkVDVElPTi5OT05FKSBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZpcnN0VmlzaWJsZUhvbGxvd0luZGV4ID09IG51bGwgJiYgbmV4dERlZi5pc0hvbGxvdyAmJiAhbmV4dERlZi5pc0hpZGRlbkhvbGxvdykgZmlyc3RWaXNpYmxlSG9sbG93SW5kZXggPSBkaTtcbiAgICAgICAgICBpZiAobmV4dERlZi5pc0lucHV0ICYmICFuZXh0RGVmLmlzSG9sbG93KSB7XG4gICAgICAgICAgICBmaXJzdEZpbGxlZElucHV0SW5kZXggPSBkaTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBmb3IgbGF6eSBpZiBoYXMgYWxpZ25lZCBsZWZ0IGluc2lkZSBmaXhlZCBhbmQgaGFzIGNhbWUgdG8gdGhlIHN0YXJ0IC0gdXNlIHN0YXJ0IHBvc2l0aW9uXG4gICAgICBpZiAoZGlyZWN0aW9uID09PSBESVJFQ1RJT04uTEVGVCAmJiBkaSA9PT0gMCAmJiB0aGlzLmxhenkgJiYgIXRoaXMuZXh0cmFjdElucHV0KCkgJiYgKCFpbml0aWFsRGVmIHx8ICFpbml0aWFsRGVmLmlzSW5wdXQpKSBmaXJzdElucHV0SW5kZXggPSAwO1xuXG4gICAgICBpZiAoZGlyZWN0aW9uID09PSBESVJFQ1RJT04uTEVGVCB8fCBmaXJzdElucHV0SW5kZXggPT0gbnVsbCkge1xuICAgICAgICAvLyBzZWFyY2ggYmFja3dhcmRcbiAgICAgICAgc3RlcCA9IC1zdGVwO1xuICAgICAgICB2YXIgb3ZlcmZsb3cgPSBmYWxzZTtcblxuICAgICAgICAvLyBmaW5kIGhvbGxvd3Mgb25seSBiZWZvcmUgaW5pdGlhbCBwb3NcbiAgICAgICAgZm9yIChuZXh0ZGkgPSBpbmRleEluRGlyZWN0aW9uKGRpLCBzdGVwKTsgMCA8PSBuZXh0ZGkgJiYgbmV4dGRpIDwgdGhpcy5fY2hhckRlZnMubGVuZ3RoOyBkaSArPSBzdGVwLCBuZXh0ZGkgKz0gc3RlcCkge1xuICAgICAgICAgIHZhciBfbmV4dERlZiA9IHRoaXMuX2NoYXJEZWZzW25leHRkaV07XG4gICAgICAgICAgaWYgKF9uZXh0RGVmLmlzSW5wdXQpIHtcbiAgICAgICAgICAgIGZpcnN0SW5wdXRJbmRleCA9IGRpO1xuICAgICAgICAgICAgaWYgKF9uZXh0RGVmLmlzSG9sbG93ICYmICFfbmV4dERlZi5pc0hpZGRlbkhvbGxvdykgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gaWYgaG9sbG93IG5vdCBmb3VuZCBiZWZvcmUgc3RhcnQgcG9zaXRpb24gLSBzZXQgYG92ZXJmbG93YFxuICAgICAgICAgIC8vIGFuZCB0cnkgdG8gZmluZCBqdXN0IGFueSBpbnB1dFxuICAgICAgICAgIGlmIChkaSA9PT0gaW5pdGlhbERlZkluZGV4KSBvdmVyZmxvdyA9IHRydWU7XG5cbiAgICAgICAgICAvLyBmaXJzdCBpbnB1dCBmb3VuZFxuICAgICAgICAgIGlmIChvdmVyZmxvdyAmJiBmaXJzdElucHV0SW5kZXggIT0gbnVsbCkgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwcm9jZXNzIG92ZXJmbG93XG4gICAgICAgIG92ZXJmbG93ID0gb3ZlcmZsb3cgfHwgbmV4dGRpID49IHRoaXMuX2NoYXJEZWZzLmxlbmd0aDtcbiAgICAgICAgaWYgKG92ZXJmbG93ICYmIGZpcnN0SW5wdXRJbmRleCAhPSBudWxsKSBkaSA9IGZpcnN0SW5wdXRJbmRleDtcbiAgICAgIH0gZWxzZSBpZiAoZmlyc3RGaWxsZWRJbnB1dEluZGV4ID09IG51bGwpIHtcbiAgICAgICAgLy8gYWRqdXN0IGluZGV4IGlmIGRlbGV0ZSBhdCByaWdodCBhbmQgZmlsbGVkIGlucHV0IG5vdCBmb3VuZCBhdCByaWdodFxuICAgICAgICBkaSA9IGZpcnN0VmlzaWJsZUhvbGxvd0luZGV4ICE9IG51bGwgPyBmaXJzdFZpc2libGVIb2xsb3dJbmRleCA6IGZpcnN0SW5wdXRJbmRleDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMubWFwRGVmSW5kZXhUb1BvcyhkaSk7XG4gICAgfVxuXG4gICAgLyoqIEdldCBncm91cCBieSBuYW1lICovXG5cbiAgfSwge1xuICAgIGtleTogJ2dyb3VwJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ3JvdXAobmFtZSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ3JvdXBzQnlOYW1lKG5hbWUpWzBdO1xuICAgIH1cblxuICAgIC8qKiBHZXQgYWxsIGdyb3VwcyBieSBuYW1lICovXG5cbiAgfSwge1xuICAgIGtleTogJ2dyb3Vwc0J5TmFtZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdyb3Vwc0J5TmFtZShuYW1lKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZ3JvdXBEZWZzLmZpbHRlcihmdW5jdGlvbiAoZyQkMSkge1xuICAgICAgICByZXR1cm4gZyQkMS5uYW1lID09PSBuYW1lO1xuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnaXNDb21wbGV0ZScsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICAgICAgcmV0dXJuICF0aGlzLl9jaGFyRGVmcy5zb21lKGZ1bmN0aW9uIChkLCBpKSB7XG4gICAgICAgIHJldHVybiBkLmlzSW5wdXQgJiYgIWQub3B0aW9uYWwgJiYgKGQuaXNIb2xsb3cgfHwgIV90aGlzNS5leHRyYWN0SW5wdXQoaSwgaSArIDEpKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3VubWFza2VkVmFsdWUnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgdmFyIHN0ciA9IHRoaXMudmFsdWU7XG4gICAgICB2YXIgdW5tYXNrZWQgPSAnJztcblxuICAgICAgZm9yICh2YXIgY2kgPSAwLCBkaSA9IDA7IGNpIDwgc3RyLmxlbmd0aCAmJiBkaSA8IHRoaXMuX2NoYXJEZWZzLmxlbmd0aDsgKytkaSkge1xuICAgICAgICB2YXIgY2ggPSBzdHJbY2ldO1xuICAgICAgICB2YXIgZGVmID0gdGhpcy5fY2hhckRlZnNbZGldO1xuXG4gICAgICAgIGlmIChkZWYuaXNIaWRkZW5Ib2xsb3cpIGNvbnRpbnVlO1xuICAgICAgICBpZiAoZGVmLnVubWFza2luZyAmJiAhZGVmLmlzSG9sbG93KSB1bm1hc2tlZCArPSBjaDtcbiAgICAgICAgKytjaTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHVubWFza2VkO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQkJDEodW5tYXNrZWRWYWx1ZSkge1xuICAgICAgc2V0KE1hc2tlZFBhdHRlcm4ucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkUGF0dGVybi5wcm90b3R5cGUpLCAndW5tYXNrZWRWYWx1ZScsIHVubWFza2VkVmFsdWUsIHRoaXMpO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gTWFza2VkUGF0dGVybjtcbn0oTWFza2VkKTtcblxuTWFza2VkUGF0dGVybi5ERUZBVUxUUyA9IHtcbiAgbGF6eTogdHJ1ZSxcbiAgcGxhY2Vob2xkZXJDaGFyOiAnXydcbn07XG5NYXNrZWRQYXR0ZXJuLlNUT1BfQ0hBUiA9ICdgJztcbk1hc2tlZFBhdHRlcm4uRVNDQVBFX0NIQVIgPSAnXFxcXCc7XG5NYXNrZWRQYXR0ZXJuLkRlZmluaXRpb24gPSBQYXR0ZXJuRGVmaW5pdGlvbjtcbk1hc2tlZFBhdHRlcm4uR3JvdXAgPSBQYXR0ZXJuR3JvdXA7XG5cbi8qKiBEYXRlIG1hc2sgKi9cblxudmFyIE1hc2tlZERhdGUgPSBmdW5jdGlvbiAoX01hc2tlZFBhdHRlcm4pIHtcbiAgaW5oZXJpdHMoTWFza2VkRGF0ZSwgX01hc2tlZFBhdHRlcm4pO1xuXG4gIC8qKlxuICAgIEBwYXJhbSB7T2JqZWN0fSBvcHRzXG4gICovXG5cbiAgLyoqIFN0YXJ0IGRhdGUgKi9cblxuICAvKiogRm9ybWF0IERhdGUgdG8gc3RyaW5nICovXG4gIGZ1bmN0aW9uIE1hc2tlZERhdGUob3B0cykge1xuICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIE1hc2tlZERhdGUpO1xuICAgIHJldHVybiBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChNYXNrZWREYXRlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkRGF0ZSkpLmNhbGwodGhpcywgX2V4dGVuZHMoe30sIE1hc2tlZERhdGUuREVGQVVMVFMsIG9wdHMpKSk7XG4gIH1cblxuICAvKipcbiAgICBAb3ZlcnJpZGVcbiAgKi9cblxuICAvKiogRW5kIGRhdGUgKi9cblxuICAvKiogUGF0dGVybiBtYXNrIGZvciBkYXRlIGFjY29yZGluZyB0byB7QGxpbmsgTWFza2VkRGF0ZSNmb3JtYXR9ICovXG5cblxuICAvKiogUGFyc2Ugc3RyaW5nIHRvIERhdGUgKi9cblxuXG4gIGNyZWF0ZUNsYXNzKE1hc2tlZERhdGUsIFt7XG4gICAga2V5OiAnX3VwZGF0ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF91cGRhdGUob3B0cykge1xuICAgICAgaWYgKG9wdHMubWFzayA9PT0gRGF0ZSkgZGVsZXRlIG9wdHMubWFzaztcbiAgICAgIGlmIChvcHRzLnBhdHRlcm4pIHtcbiAgICAgICAgb3B0cy5tYXNrID0gb3B0cy5wYXR0ZXJuO1xuICAgICAgICBkZWxldGUgb3B0cy5wYXR0ZXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgZ3JvdXBzID0gb3B0cy5ncm91cHM7XG4gICAgICBvcHRzLmdyb3VwcyA9IF9leHRlbmRzKHt9LCBNYXNrZWREYXRlLkdFVF9ERUZBVUxUX0dST1VQUygpKTtcbiAgICAgIC8vIGFkanVzdCB5ZWFyIGdyb3VwXG4gICAgICBpZiAob3B0cy5taW4pIG9wdHMuZ3JvdXBzLlkuZnJvbSA9IG9wdHMubWluLmdldEZ1bGxZZWFyKCk7XG4gICAgICBpZiAob3B0cy5tYXgpIG9wdHMuZ3JvdXBzLlkudG8gPSBvcHRzLm1heC5nZXRGdWxsWWVhcigpO1xuICAgICAgX2V4dGVuZHMob3B0cy5ncm91cHMsIGdyb3Vwcyk7XG5cbiAgICAgIGdldChNYXNrZWREYXRlLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1hc2tlZERhdGUucHJvdG90eXBlKSwgJ191cGRhdGUnLCB0aGlzKS5jYWxsKHRoaXMsIG9wdHMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnZG9WYWxpZGF0ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRvVmFsaWRhdGUoKSB7XG4gICAgICB2YXIgX2JhYmVsSGVscGVycyRnZXQ7XG5cbiAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICB9XG5cbiAgICAgIHZhciB2YWxpZCA9IChfYmFiZWxIZWxwZXJzJGdldCA9IGdldChNYXNrZWREYXRlLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1hc2tlZERhdGUucHJvdG90eXBlKSwgJ2RvVmFsaWRhdGUnLCB0aGlzKSkuY2FsbC5hcHBseShfYmFiZWxIZWxwZXJzJGdldCwgW3RoaXNdLmNvbmNhdCh0b0NvbnN1bWFibGVBcnJheShhcmdzKSkpO1xuICAgICAgdmFyIGRhdGUgPSB0aGlzLmRhdGU7XG5cbiAgICAgIHJldHVybiB2YWxpZCAmJiAoIXRoaXMuaXNDb21wbGV0ZSB8fCB0aGlzLmlzRGF0ZUV4aXN0KHRoaXMudmFsdWUpICYmIGRhdGUgJiYgKHRoaXMubWluID09IG51bGwgfHwgdGhpcy5taW4gPD0gZGF0ZSkgJiYgKHRoaXMubWF4ID09IG51bGwgfHwgZGF0ZSA8PSB0aGlzLm1heCkpO1xuICAgIH1cblxuICAgIC8qKiBDaGVja3MgaWYgZGF0ZSBpcyBleGlzdHMgKi9cblxuICB9LCB7XG4gICAga2V5OiAnaXNEYXRlRXhpc3QnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpc0RhdGVFeGlzdChzdHIpIHtcbiAgICAgIHJldHVybiB0aGlzLmZvcm1hdCh0aGlzLnBhcnNlKHN0cikpID09PSBzdHI7XG4gICAgfVxuXG4gICAgLyoqIFBhcnNlZCBEYXRlICovXG5cbiAgfSwge1xuICAgIGtleTogJ2RhdGUnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNDb21wbGV0ZSA/IHRoaXMucGFyc2UodGhpcy52YWx1ZSkgOiBudWxsO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQkJDEoZGF0ZSkge1xuICAgICAgdGhpcy52YWx1ZSA9IHRoaXMuZm9ybWF0KGRhdGUpO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gTWFza2VkRGF0ZTtcbn0oTWFza2VkUGF0dGVybik7XG5cbk1hc2tlZERhdGUuREVGQVVMVFMgPSB7XG4gIHBhdHRlcm46ICdkey59YG17Ln1gWScsXG4gIGZvcm1hdDogZnVuY3Rpb24gZm9ybWF0KGRhdGUpIHtcbiAgICB2YXIgZGF5ID0gU3RyaW5nKGRhdGUuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgIHZhciBtb250aCA9IFN0cmluZyhkYXRlLmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuXG4gICAgcmV0dXJuIFtkYXksIG1vbnRoLCB5ZWFyXS5qb2luKCcuJyk7XG4gIH0sXG4gIHBhcnNlOiBmdW5jdGlvbiBwYXJzZShzdHIpIHtcbiAgICB2YXIgX3N0ciRzcGxpdCA9IHN0ci5zcGxpdCgnLicpLFxuICAgICAgICBfc3RyJHNwbGl0MiA9IHNsaWNlZFRvQXJyYXkoX3N0ciRzcGxpdCwgMyksXG4gICAgICAgIGRheSA9IF9zdHIkc3BsaXQyWzBdLFxuICAgICAgICBtb250aCA9IF9zdHIkc3BsaXQyWzFdLFxuICAgICAgICB5ZWFyID0gX3N0ciRzcGxpdDJbMl07XG5cbiAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCBkYXkpO1xuICB9XG59O1xuTWFza2VkRGF0ZS5HRVRfREVGQVVMVF9HUk9VUFMgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB7XG4gICAgZDogbmV3IFBhdHRlcm5Hcm91cC5SYW5nZShbMSwgMzFdKSxcbiAgICBtOiBuZXcgUGF0dGVybkdyb3VwLlJhbmdlKFsxLCAxMl0pLFxuICAgIFk6IG5ldyBQYXR0ZXJuR3JvdXAuUmFuZ2UoWzE5MDAsIDk5OTldKVxuICB9O1xufTtcblxuLyoqXG4gIEdlbmVyaWMgZWxlbWVudCBBUEkgdG8gdXNlIHdpdGggbWFza1xuICBAaW50ZXJmYWNlXG4qL1xuXG4vKiogTGlzdGVucyB0byBlbGVtZW50IGV2ZW50cyBhbmQgY29udHJvbHMgY2hhbmdlcyBiZXR3ZWVuIGVsZW1lbnQgYW5kIHtAbGluayBNYXNrZWR9ICovXG52YXIgSW5wdXRNYXNrID0gZnVuY3Rpb24gKCkge1xuXG4gIC8qKlxuICAgIEBwYXJhbSB7VUlFbGVtZW50fSBlbFxuICAgIEBwYXJhbSB7T2JqZWN0fSBvcHRzXG4gICovXG5cbiAgLyoqXG4gICAgVmlldyBlbGVtZW50XG4gICAgQHJlYWRvbmx5XG4gICovXG4gIGZ1bmN0aW9uIElucHV0TWFzayhlbCwgb3B0cykge1xuICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIElucHV0TWFzayk7XG5cbiAgICB0aGlzLmVsID0gZWw7XG4gICAgdGhpcy5tYXNrZWQgPSBjcmVhdGVNYXNrKG9wdHMpO1xuXG4gICAgdGhpcy5fbGlzdGVuZXJzID0ge307XG4gICAgdGhpcy5fdmFsdWUgPSAnJztcbiAgICB0aGlzLl91bm1hc2tlZFZhbHVlID0gJyc7XG5cbiAgICB0aGlzLl9zYXZlU2VsZWN0aW9uID0gdGhpcy5fc2F2ZVNlbGVjdGlvbi5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uSW5wdXQgPSB0aGlzLl9vbklucHV0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25DaGFuZ2UgPSB0aGlzLl9vbkNoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uRHJvcCA9IHRoaXMuX29uRHJvcC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuYWxpZ25DdXJzb3IgPSB0aGlzLmFsaWduQ3Vyc29yLmJpbmQodGhpcyk7XG4gICAgdGhpcy5hbGlnbkN1cnNvckZyaWVuZGx5ID0gdGhpcy5hbGlnbkN1cnNvckZyaWVuZGx5LmJpbmQodGhpcyk7XG5cbiAgICB0aGlzLl9iaW5kRXZlbnRzKCk7XG5cbiAgICAvLyByZWZyZXNoXG4gICAgdGhpcy51cGRhdGVWYWx1ZSgpO1xuICAgIHRoaXMuX29uQ2hhbmdlKCk7XG4gIH1cblxuICAvKiogUmVhZCBvciB1cGRhdGUgbWFzayAqL1xuXG5cbiAgLyoqXG4gICAgSW50ZXJuYWwge0BsaW5rIE1hc2tlZH0gbW9kZWxcbiAgICBAcmVhZG9ubHlcbiAgKi9cblxuXG4gIGNyZWF0ZUNsYXNzKElucHV0TWFzaywgW3tcbiAgICBrZXk6ICdfYmluZEV2ZW50cycsXG5cblxuICAgIC8qKlxuICAgICAgU3RhcnRzIGxpc3RlbmluZyB0byBlbGVtZW50IGV2ZW50c1xuICAgICAgQHByb3RlY3RlZFxuICAgICovXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9iaW5kRXZlbnRzKCkge1xuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fc2F2ZVNlbGVjdGlvbik7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdGhpcy5fb25JbnB1dCk7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCB0aGlzLl9vbkRyb3ApO1xuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuYWxpZ25DdXJzb3JGcmllbmRseSk7XG4gICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuX29uQ2hhbmdlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgIFN0b3BzIGxpc3RlbmluZyB0byBlbGVtZW50IGV2ZW50c1xuICAgICAgQHByb3RlY3RlZFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdfdW5iaW5kRXZlbnRzJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX3VuYmluZEV2ZW50cygpIHtcbiAgICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX3NhdmVTZWxlY3Rpb24pO1xuICAgICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdpbnB1dCcsIHRoaXMuX29uSW5wdXQpO1xuICAgICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5fb25Ecm9wKTtcbiAgICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmFsaWduQ3Vyc29yRnJpZW5kbHkpO1xuICAgICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLl9vbkNoYW5nZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICBGaXJlcyBjdXN0b20gZXZlbnRcbiAgICAgIEBwcm90ZWN0ZWRcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnX2ZpcmVFdmVudCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9maXJlRXZlbnQoZXYpIHtcbiAgICAgIHZhciBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnNbZXZdIHx8IFtdO1xuICAgICAgbGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgcmV0dXJuIGwoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQ3VycmVudCBzZWxlY3Rpb24gc3RhcnRcbiAgICAgIEByZWFkb25seVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ19zYXZlU2VsZWN0aW9uJyxcblxuXG4gICAgLyoqXG4gICAgICBTdG9yZXMgY3VycmVudCBzZWxlY3Rpb25cbiAgICAgIEBwcm90ZWN0ZWRcbiAgICAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbiBfc2F2ZVNlbGVjdGlvbigpIC8qIGV2ICove1xuICAgICAgaWYgKHRoaXMudmFsdWUgIT09IHRoaXMuZWwudmFsdWUpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdVbmNvbnRyb2xsZWQgaW5wdXQgY2hhbmdlLCByZWZyZXNoIG1hc2sgbWFudWFsbHkhJyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgfVxuICAgICAgdGhpcy5fc2VsZWN0aW9uID0ge1xuICAgICAgICBzdGFydDogdGhpcy5zZWxlY3Rpb25TdGFydCxcbiAgICAgICAgZW5kOiB0aGlzLmN1cnNvclBvc1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKiogU3luY3Jvbml6ZXMgbW9kZWwgdmFsdWUgZnJvbSB2aWV3ICovXG5cbiAgfSwge1xuICAgIGtleTogJ3VwZGF0ZVZhbHVlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlVmFsdWUoKSB7XG4gICAgICB0aGlzLm1hc2tlZC52YWx1ZSA9IHRoaXMuZWwudmFsdWU7XG4gICAgfVxuXG4gICAgLyoqIFN5bmNyb25pemVzIHZpZXcgZnJvbSBtb2RlbCB2YWx1ZSwgZmlyZXMgY2hhbmdlIGV2ZW50cyAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICd1cGRhdGVDb250cm9sJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQ29udHJvbCgpIHtcbiAgICAgIHZhciBuZXdVbm1hc2tlZFZhbHVlID0gdGhpcy5tYXNrZWQudW5tYXNrZWRWYWx1ZTtcbiAgICAgIHZhciBuZXdWYWx1ZSA9IHRoaXMubWFza2VkLnZhbHVlO1xuICAgICAgdmFyIGlzQ2hhbmdlZCA9IHRoaXMudW5tYXNrZWRWYWx1ZSAhPT0gbmV3VW5tYXNrZWRWYWx1ZSB8fCB0aGlzLnZhbHVlICE9PSBuZXdWYWx1ZTtcblxuICAgICAgdGhpcy5fdW5tYXNrZWRWYWx1ZSA9IG5ld1VubWFza2VkVmFsdWU7XG4gICAgICB0aGlzLl92YWx1ZSA9IG5ld1ZhbHVlO1xuXG4gICAgICBpZiAodGhpcy5lbC52YWx1ZSAhPT0gbmV3VmFsdWUpIHRoaXMuZWwudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgIGlmIChpc0NoYW5nZWQpIHRoaXMuX2ZpcmVDaGFuZ2VFdmVudHMoKTtcbiAgICB9XG5cbiAgICAvKiogVXBkYXRlcyBvcHRpb25zIHdpdGggZGVlcCBlcXVhbCBjaGVjaywgcmVjcmVhdGVzIEB7bGluayBNYXNrZWR9IG1vZGVsIGlmIG1hc2sgdHlwZSBjaGFuZ2VzICovXG5cbiAgfSwge1xuICAgIGtleTogJ3VwZGF0ZU9wdGlvbnMnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVPcHRpb25zKG9wdHMpIHtcbiAgICAgIG9wdHMgPSBfZXh0ZW5kcyh7fSwgb3B0cyk7IC8vIGNsb25lXG4gICAgICBpZiAob3B0cy5tYXNrID09PSBEYXRlICYmIHRoaXMubWFza2VkIGluc3RhbmNlb2YgTWFza2VkRGF0ZSkgZGVsZXRlIG9wdHMubWFzaztcblxuICAgICAgLy8gY2hlY2sgaWYgY2hhbmdlZFxuICAgICAgaWYgKG9iamVjdEluY2x1ZGVzKHRoaXMubWFza2VkLCBvcHRzKSkgcmV0dXJuO1xuXG4gICAgICB0aGlzLm1hc2tlZC51cGRhdGVPcHRpb25zKG9wdHMpO1xuICAgICAgdGhpcy51cGRhdGVDb250cm9sKCk7XG4gICAgfVxuXG4gICAgLyoqIFVwZGF0ZXMgY3Vyc29yICovXG5cbiAgfSwge1xuICAgIGtleTogJ3VwZGF0ZUN1cnNvcicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUN1cnNvcihjdXJzb3JQb3MpIHtcbiAgICAgIGlmIChjdXJzb3JQb3MgPT0gbnVsbCkgcmV0dXJuO1xuICAgICAgdGhpcy5jdXJzb3JQb3MgPSBjdXJzb3JQb3M7XG5cbiAgICAgIC8vIGFsc28gcXVldWUgY2hhbmdlIGN1cnNvciBmb3IgbW9iaWxlIGJyb3dzZXJzXG4gICAgICB0aGlzLl9kZWxheVVwZGF0ZUN1cnNvcihjdXJzb3JQb3MpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgRGVsYXlzIGN1cnNvciB1cGRhdGUgdG8gc3VwcG9ydCBtb2JpbGUgYnJvd3NlcnNcbiAgICAgIEBwcml2YXRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnX2RlbGF5VXBkYXRlQ3Vyc29yJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGF5VXBkYXRlQ3Vyc29yKGN1cnNvclBvcykge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgdGhpcy5fYWJvcnRVcGRhdGVDdXJzb3IoKTtcbiAgICAgIHRoaXMuX2NoYW5naW5nQ3Vyc29yUG9zID0gY3Vyc29yUG9zO1xuICAgICAgdGhpcy5fY3Vyc29yQ2hhbmdpbmcgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFfdGhpcy5lbCkgcmV0dXJuOyAvLyBpZiB3YXMgZGVzdHJveWVkXG4gICAgICAgIF90aGlzLmN1cnNvclBvcyA9IF90aGlzLl9jaGFuZ2luZ0N1cnNvclBvcztcbiAgICAgICAgX3RoaXMuX2Fib3J0VXBkYXRlQ3Vyc29yKCk7XG4gICAgICB9LCAxMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICBGaXJlcyBjdXN0b20gZXZlbnRzXG4gICAgICBAcHJvdGVjdGVkXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnX2ZpcmVDaGFuZ2VFdmVudHMnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlyZUNoYW5nZUV2ZW50cygpIHtcbiAgICAgIHRoaXMuX2ZpcmVFdmVudCgnYWNjZXB0Jyk7XG4gICAgICBpZiAodGhpcy5tYXNrZWQuaXNDb21wbGV0ZSkgdGhpcy5fZmlyZUV2ZW50KCdjb21wbGV0ZScpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQWJvcnRzIGRlbGF5ZWQgY3Vyc29yIHVwZGF0ZVxuICAgICAgQHByaXZhdGVcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdfYWJvcnRVcGRhdGVDdXJzb3InLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfYWJvcnRVcGRhdGVDdXJzb3IoKSB7XG4gICAgICBpZiAodGhpcy5fY3Vyc29yQ2hhbmdpbmcpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX2N1cnNvckNoYW5naW5nKTtcbiAgICAgICAgZGVsZXRlIHRoaXMuX2N1cnNvckNoYW5naW5nO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBBbGlnbnMgY3Vyc29yIHRvIG5lYXJlc3QgYXZhaWxhYmxlIHBvc2l0aW9uICovXG5cbiAgfSwge1xuICAgIGtleTogJ2FsaWduQ3Vyc29yJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gYWxpZ25DdXJzb3IoKSB7XG4gICAgICB0aGlzLmN1cnNvclBvcyA9IHRoaXMubWFza2VkLm5lYXJlc3RJbnB1dFBvcyh0aGlzLmN1cnNvclBvcywgRElSRUNUSU9OLkxFRlQpO1xuICAgIH1cblxuICAgIC8qKiBBbGlnbnMgY3Vyc29yIG9ubHkgaWYgc2VsZWN0aW9uIGlzIGVtcHR5ICovXG5cbiAgfSwge1xuICAgIGtleTogJ2FsaWduQ3Vyc29yRnJpZW5kbHknLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBhbGlnbkN1cnNvckZyaWVuZGx5KCkge1xuICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uU3RhcnQgIT09IHRoaXMuY3Vyc29yUG9zKSByZXR1cm47XG4gICAgICB0aGlzLmFsaWduQ3Vyc29yKCk7XG4gICAgfVxuXG4gICAgLyoqIEFkZHMgbGlzdGVuZXIgb24gY3VzdG9tIGV2ZW50ICovXG5cbiAgfSwge1xuICAgIGtleTogJ29uJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gb24oZXYsIGhhbmRsZXIpIHtcbiAgICAgIGlmICghdGhpcy5fbGlzdGVuZXJzW2V2XSkgdGhpcy5fbGlzdGVuZXJzW2V2XSA9IFtdO1xuICAgICAgdGhpcy5fbGlzdGVuZXJzW2V2XS5wdXNoKGhhbmRsZXIpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqIFJlbW92ZXMgY3VzdG9tIGV2ZW50IGxpc3RlbmVyICovXG5cbiAgfSwge1xuICAgIGtleTogJ29mZicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9mZihldiwgaGFuZGxlcikge1xuICAgICAgaWYgKCF0aGlzLl9saXN0ZW5lcnNbZXZdKSByZXR1cm47XG4gICAgICBpZiAoIWhhbmRsZXIpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuX2xpc3RlbmVyc1tldl07XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBoSW5kZXggPSB0aGlzLl9saXN0ZW5lcnNbZXZdLmluZGV4T2YoaGFuZGxlcik7XG4gICAgICBpZiAoaEluZGV4ID49IDApIHRoaXMuX2xpc3RlbmVyc1tldl0uc3BsaWNlKGhJbmRleCwgMSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKiogSGFuZGxlcyB2aWV3IGlucHV0IGV2ZW50ICovXG5cbiAgfSwge1xuICAgIGtleTogJ19vbklucHV0JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX29uSW5wdXQoKSB7XG4gICAgICB0aGlzLl9hYm9ydFVwZGF0ZUN1cnNvcigpO1xuXG4gICAgICB2YXIgZGV0YWlscyA9IG5ldyBBY3Rpb25EZXRhaWxzKFxuICAgICAgLy8gbmV3IHN0YXRlXG4gICAgICB0aGlzLmVsLnZhbHVlLCB0aGlzLmN1cnNvclBvcyxcbiAgICAgIC8vIG9sZCBzdGF0ZVxuICAgICAgdGhpcy52YWx1ZSwgdGhpcy5fc2VsZWN0aW9uKTtcblxuICAgICAgdmFyIG9mZnNldCA9IHRoaXMubWFza2VkLnNwbGljZShkZXRhaWxzLnN0YXJ0Q2hhbmdlUG9zLCBkZXRhaWxzLnJlbW92ZWQubGVuZ3RoLCBkZXRhaWxzLmluc2VydGVkLCBkZXRhaWxzLnJlbW92ZURpcmVjdGlvbikub2Zmc2V0O1xuXG4gICAgICB2YXIgY3Vyc29yUG9zID0gdGhpcy5tYXNrZWQubmVhcmVzdElucHV0UG9zKGRldGFpbHMuc3RhcnRDaGFuZ2VQb3MgKyBvZmZzZXQsIGRldGFpbHMucmVtb3ZlRGlyZWN0aW9uKTtcblxuICAgICAgdGhpcy51cGRhdGVDb250cm9sKCk7XG4gICAgICB0aGlzLnVwZGF0ZUN1cnNvcihjdXJzb3JQb3MpO1xuICAgIH1cblxuICAgIC8qKiBIYW5kbGVzIHZpZXcgY2hhbmdlIGV2ZW50IGFuZCBjb21taXRzIG1vZGVsIHZhbHVlICovXG5cbiAgfSwge1xuICAgIGtleTogJ19vbkNoYW5nZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNoYW5nZSgpIHtcbiAgICAgIGlmICh0aGlzLnZhbHVlICE9PSB0aGlzLmVsLnZhbHVlKSB7XG4gICAgICAgIHRoaXMudXBkYXRlVmFsdWUoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMubWFza2VkLmRvQ29tbWl0KCk7XG4gICAgICB0aGlzLnVwZGF0ZUNvbnRyb2woKTtcbiAgICB9XG5cbiAgICAvKiogSGFuZGxlcyB2aWV3IGRyb3AgZXZlbnQsIHByZXZlbnRzIGJ5IGRlZmF1bHQgKi9cblxuICB9LCB7XG4gICAga2V5OiAnX29uRHJvcCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRyb3AoZXYpIHtcbiAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9XG5cbiAgICAvKiogVW5iaW5kIHZpZXcgZXZlbnRzIGFuZCByZW1vdmVzIGVsZW1lbnQgcmVmZXJlbmNlICovXG5cbiAgfSwge1xuICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgdGhpcy5fdW5iaW5kRXZlbnRzKCk7XG4gICAgICAvLyAkRmxvd0ZpeE1lIHdoeSBub3QgZG8gc28/XG4gICAgICB0aGlzLl9saXN0ZW5lcnMubGVuZ3RoID0gMDtcbiAgICAgIGRlbGV0ZSB0aGlzLmVsO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ21hc2snLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgcmV0dXJuIHRoaXMubWFza2VkLm1hc2s7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldCQkMShtYXNrKSB7XG4gICAgICBpZiAobWFzayA9PSBudWxsIHx8IG1hc2sgPT09IHRoaXMubWFza2VkLm1hc2spIHJldHVybjtcblxuICAgICAgaWYgKHRoaXMubWFza2VkLmNvbnN0cnVjdG9yID09PSBtYXNrZWRDbGFzcyhtYXNrKSkge1xuICAgICAgICB0aGlzLm1hc2tlZC5tYXNrID0gbWFzaztcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgbWFza2VkID0gY3JlYXRlTWFzayh7IG1hc2s6IG1hc2sgfSk7XG4gICAgICBtYXNrZWQudW5tYXNrZWRWYWx1ZSA9IHRoaXMubWFza2VkLnVubWFza2VkVmFsdWU7XG4gICAgICB0aGlzLm1hc2tlZCA9IG1hc2tlZDtcbiAgICB9XG5cbiAgICAvKiogUmF3IHZhbHVlICovXG5cbiAgfSwge1xuICAgIGtleTogJ3ZhbHVlJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gc2V0JCQxKHN0cikge1xuICAgICAgdGhpcy5tYXNrZWQudmFsdWUgPSBzdHI7XG4gICAgICB0aGlzLnVwZGF0ZUNvbnRyb2woKTtcbiAgICAgIHRoaXMuYWxpZ25DdXJzb3IoKTtcbiAgICB9XG5cbiAgICAvKiogVW5tYXNrZWQgdmFsdWUgKi9cblxuICB9LCB7XG4gICAga2V5OiAndW5tYXNrZWRWYWx1ZScsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fdW5tYXNrZWRWYWx1ZTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gc2V0JCQxKHN0cikge1xuICAgICAgdGhpcy5tYXNrZWQudW5tYXNrZWRWYWx1ZSA9IHN0cjtcbiAgICAgIHRoaXMudXBkYXRlQ29udHJvbCgpO1xuICAgICAgdGhpcy5hbGlnbkN1cnNvcigpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3NlbGVjdGlvblN0YXJ0JyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jdXJzb3JDaGFuZ2luZyA/IHRoaXMuX2NoYW5naW5nQ3Vyc29yUG9zIDogdGhpcy5lbC5zZWxlY3Rpb25TdGFydDtcbiAgICB9XG5cbiAgICAvKiogQ3VycmVudCBjdXJzb3IgcG9zaXRpb24gKi9cblxuICB9LCB7XG4gICAga2V5OiAnY3Vyc29yUG9zJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jdXJzb3JDaGFuZ2luZyA/IHRoaXMuX2NoYW5naW5nQ3Vyc29yUG9zIDogdGhpcy5lbC5zZWxlY3Rpb25FbmQ7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldCQkMShwb3MpIHtcbiAgICAgIGlmICh0aGlzLmVsICE9PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50KSByZXR1cm47XG5cbiAgICAgIHRoaXMuZWwuc2V0U2VsZWN0aW9uUmFuZ2UocG9zLCBwb3MpO1xuICAgICAgdGhpcy5fc2F2ZVNlbGVjdGlvbigpO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gSW5wdXRNYXNrO1xufSgpO1xuXG4vKipcbiAgTnVtYmVyIG1hc2tcbiAgQHBhcmFtIHtPYmplY3R9IG9wdHNcbiAgQHBhcmFtIHtzdHJpbmd9IG9wdHMucmFkaXggLSBTaW5nbGUgY2hhclxuICBAcGFyYW0ge3N0cmluZ30gb3B0cy50aG91c2FuZHNTZXBhcmF0b3IgLSBTaW5nbGUgY2hhclxuICBAcGFyYW0ge0FycmF5PHN0cmluZz59IG9wdHMubWFwVG9SYWRpeCAtIEFycmF5IG9mIHNpbmdsZSBjaGFyc1xuICBAcGFyYW0ge251bWJlcn0gb3B0cy5taW5cbiAgQHBhcmFtIHtudW1iZXJ9IG9wdHMubWF4XG4gIEBwYXJhbSB7bnVtYmVyfSBvcHRzLnNjYWxlIC0gRGlnaXRzIGFmdGVyIHBvaW50XG4gIEBwYXJhbSB7Ym9vbGVhbn0gb3B0cy5zaWduZWQgLSBBbGxvdyBuZWdhdGl2ZVxuICBAcGFyYW0ge2Jvb2xlYW59IG9wdHMubm9ybWFsaXplWmVyb3MgLSBGbGFnIHRvIHJlbW92ZSBsZWFkaW5nIGFuZCB0cmFpbGluZyB6ZXJvcyBpbiB0aGUgZW5kIG9mIGVkaXRpbmdcbiAgQHBhcmFtIHtib29sZWFufSBvcHRzLnBhZEZyYWN0aW9uYWxaZXJvcyAtIEZsYWcgdG8gcGFkIHRyYWlsaW5nIHplcm9zIGFmdGVyIHBvaW50IGluIHRoZSBlbmQgb2YgZWRpdGluZ1xuKi9cbnZhciBNYXNrZWROdW1iZXIgPSBmdW5jdGlvbiAoX01hc2tlZCkge1xuICBpbmhlcml0cyhNYXNrZWROdW1iZXIsIF9NYXNrZWQpO1xuXG4gIC8qKiBGbGFnIHRvIHJlbW92ZSBsZWFkaW5nIGFuZCB0cmFpbGluZyB6ZXJvcyBpbiB0aGUgZW5kIG9mIGVkaXRpbmcgKi9cblxuICAvKiogRGlnaXRzIGFmdGVyIHBvaW50ICovXG5cbiAgLyoqICovXG5cbiAgLyoqIFNpbmdsZSBjaGFyICovXG4gIGZ1bmN0aW9uIE1hc2tlZE51bWJlcihvcHRzKSB7XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgTWFza2VkTnVtYmVyKTtcbiAgICByZXR1cm4gcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoTWFza2VkTnVtYmVyLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkTnVtYmVyKSkuY2FsbCh0aGlzLCBfZXh0ZW5kcyh7fSwgTWFza2VkTnVtYmVyLkRFRkFVTFRTLCBvcHRzKSkpO1xuICB9XG5cbiAgLyoqXG4gICAgQG92ZXJyaWRlXG4gICovXG5cbiAgLyoqIEZsYWcgdG8gcGFkIHRyYWlsaW5nIHplcm9zIGFmdGVyIHBvaW50IGluIHRoZSBlbmQgb2YgZWRpdGluZyAqL1xuXG4gIC8qKiAqL1xuXG4gIC8qKiAqL1xuXG4gIC8qKiBBcnJheSBvZiBzaW5nbGUgY2hhcnMgKi9cblxuXG4gIC8qKiBTaW5nbGUgY2hhciAqL1xuXG5cbiAgY3JlYXRlQ2xhc3MoTWFza2VkTnVtYmVyLCBbe1xuICAgIGtleTogJ191cGRhdGUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfdXBkYXRlKG9wdHMpIHtcbiAgICAgIGdldChNYXNrZWROdW1iZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkTnVtYmVyLnByb3RvdHlwZSksICdfdXBkYXRlJywgdGhpcykuY2FsbCh0aGlzLCBvcHRzKTtcbiAgICAgIHRoaXMuX3VwZGF0ZVJlZ0V4cHMoKTtcbiAgICB9XG5cbiAgICAvKiogKi9cblxuICB9LCB7XG4gICAga2V5OiAnX3VwZGF0ZVJlZ0V4cHMnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfdXBkYXRlUmVnRXhwcygpIHtcbiAgICAgIC8vIHVzZSBkaWZmZXJlbnQgcmVnZXhwIHRvIHByb2Nlc3MgdXNlciBpbnB1dCAobW9yZSBzdHJpY3QsIGlucHV0IHN1ZmZpeCkgYW5kIHRhaWwgc2hpZnRpbmdcbiAgICAgIHZhciBzdGFydCA9ICdeJztcblxuICAgICAgdmFyIG1pZElucHV0ID0gJyc7XG4gICAgICB2YXIgbWlkID0gJyc7XG4gICAgICBpZiAodGhpcy5hbGxvd05lZ2F0aXZlKSB7XG4gICAgICAgIG1pZElucHV0ICs9ICcoWyt8XFxcXC1dP3woWyt8XFxcXC1dPygwfChbMS05XStcXFxcZCopKSkpJztcbiAgICAgICAgbWlkICs9ICdbK3xcXFxcLV0/JztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1pZElucHV0ICs9ICcoMHwoWzEtOV0rXFxcXGQqKSknO1xuICAgICAgfVxuICAgICAgbWlkICs9ICdcXFxcZConO1xuXG4gICAgICB2YXIgZW5kID0gKHRoaXMuc2NhbGUgPyAnKCcgKyB0aGlzLnJhZGl4ICsgJ1xcXFxkezAsJyArIHRoaXMuc2NhbGUgKyAnfSk/JyA6ICcnKSArICckJztcblxuICAgICAgdGhpcy5fbnVtYmVyUmVnRXhwSW5wdXQgPSBuZXcgUmVnRXhwKHN0YXJ0ICsgbWlkSW5wdXQgKyBlbmQpO1xuICAgICAgdGhpcy5fbnVtYmVyUmVnRXhwID0gbmV3IFJlZ0V4cChzdGFydCArIG1pZCArIGVuZCk7XG4gICAgICB0aGlzLl9tYXBUb1JhZGl4UmVnRXhwID0gbmV3IFJlZ0V4cCgnWycgKyB0aGlzLm1hcFRvUmFkaXgubWFwKGVzY2FwZVJlZ0V4cCkuam9pbignJykgKyAnXScsICdnJyk7XG4gICAgICB0aGlzLl90aG91c2FuZHNTZXBhcmF0b3JSZWdFeHAgPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4cCh0aGlzLnRob3VzYW5kc1NlcGFyYXRvciksICdnJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICBAb3ZlcnJpZGVcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdfZXh0cmFjdFRhaWwnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfZXh0cmFjdFRhaWwoKSB7XG4gICAgICB2YXIgZnJvbVBvcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMDtcbiAgICAgIHZhciB0b1BvcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogdGhpcy52YWx1ZS5sZW5ndGg7XG5cbiAgICAgIHZhciB0YWlsID0gZ2V0KE1hc2tlZE51bWJlci5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNYXNrZWROdW1iZXIucHJvdG90eXBlKSwgJ19leHRyYWN0VGFpbCcsIHRoaXMpLmNhbGwodGhpcywgZnJvbVBvcywgdG9Qb3MpO1xuXG4gICAgICByZXR1cm4gX2V4dGVuZHMoe30sIHRhaWwsIHtcbiAgICAgICAgdmFsdWU6IHRoaXMuX3JlbW92ZVRob3VzYW5kc1NlcGFyYXRvcnModGFpbC52YWx1ZSlcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKiAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdfcmVtb3ZlVGhvdXNhbmRzU2VwYXJhdG9ycycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9yZW1vdmVUaG91c2FuZHNTZXBhcmF0b3JzKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWUucmVwbGFjZSh0aGlzLl90aG91c2FuZHNTZXBhcmF0b3JSZWdFeHAsICcnKTtcbiAgICB9XG5cbiAgICAvKiogKi9cblxuICB9LCB7XG4gICAga2V5OiAnX2luc2VydFRob3VzYW5kc1NlcGFyYXRvcnMnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfaW5zZXJ0VGhvdXNhbmRzU2VwYXJhdG9ycyh2YWx1ZSkge1xuICAgICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjkwMTEwMi9ob3ctdG8tcHJpbnQtYS1udW1iZXItd2l0aC1jb21tYXMtYXMtdGhvdXNhbmRzLXNlcGFyYXRvcnMtaW4tamF2YXNjcmlwdFxuICAgICAgdmFyIHBhcnRzID0gdmFsdWUuc3BsaXQodGhpcy5yYWRpeCk7XG4gICAgICBwYXJ0c1swXSA9IHBhcnRzWzBdLnJlcGxhY2UoL1xcQig/PShcXGR7M30pKyg/IVxcZCkpL2csIHRoaXMudGhvdXNhbmRzU2VwYXJhdG9yKTtcbiAgICAgIHJldHVybiBwYXJ0cy5qb2luKHRoaXMucmFkaXgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnZG9QcmVwYXJlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZG9QcmVwYXJlKHN0cikge1xuICAgICAgdmFyIF9iYWJlbEhlbHBlcnMkZ2V0O1xuXG4gICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAoX2JhYmVsSGVscGVycyRnZXQgPSBnZXQoTWFza2VkTnVtYmVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1hc2tlZE51bWJlci5wcm90b3R5cGUpLCAnZG9QcmVwYXJlJywgdGhpcykpLmNhbGwuYXBwbHkoX2JhYmVsSGVscGVycyRnZXQsIFt0aGlzLCB0aGlzLl9yZW1vdmVUaG91c2FuZHNTZXBhcmF0b3JzKHN0ci5yZXBsYWNlKHRoaXMuX21hcFRvUmFkaXhSZWdFeHAsIHRoaXMucmFkaXgpKV0uY29uY2F0KHRvQ29uc3VtYWJsZUFycmF5KGFyZ3MpKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICBAb3ZlcnJpZGVcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdhcHBlbmRXaXRoVGFpbCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGVuZFdpdGhUYWlsKCkge1xuICAgICAgdmFyIF9iYWJlbEhlbHBlcnMkZ2V0MjtcblxuICAgICAgdmFyIHByZXZpb3VzVmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgICAgdGhpcy5fdmFsdWUgPSB0aGlzLl9yZW1vdmVUaG91c2FuZHNTZXBhcmF0b3JzKHRoaXMudmFsdWUpO1xuICAgICAgdmFyIHN0YXJ0Q2hhbmdlUG9zID0gdGhpcy52YWx1ZS5sZW5ndGg7XG5cbiAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgICAgIGFyZ3NbX2tleTJdID0gYXJndW1lbnRzW19rZXkyXTtcbiAgICAgIH1cblxuICAgICAgdmFyIGFwcGVuZERldGFpbHMgPSAoX2JhYmVsSGVscGVycyRnZXQyID0gZ2V0KE1hc2tlZE51bWJlci5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNYXNrZWROdW1iZXIucHJvdG90eXBlKSwgJ2FwcGVuZFdpdGhUYWlsJywgdGhpcykpLmNhbGwuYXBwbHkoX2JhYmVsSGVscGVycyRnZXQyLCBbdGhpc10uY29uY2F0KHRvQ29uc3VtYWJsZUFycmF5KGFyZ3MpKSk7XG4gICAgICB0aGlzLl92YWx1ZSA9IHRoaXMuX2luc2VydFRob3VzYW5kc1NlcGFyYXRvcnModGhpcy52YWx1ZSk7XG5cbiAgICAgIC8vIGNhbGN1bGF0ZSBvZmZzZXRzIGFmdGVyIGluc2VydCBzZXBhcmF0b3JzXG4gICAgICB2YXIgYmVmb3JlVGFpbFBvcyA9IHN0YXJ0Q2hhbmdlUG9zICsgYXBwZW5kRGV0YWlscy5pbnNlcnRlZC5sZW5ndGg7XG4gICAgICBmb3IgKHZhciBwb3MgPSAwOyBwb3MgPD0gYmVmb3JlVGFpbFBvczsgKytwb3MpIHtcbiAgICAgICAgaWYgKHRoaXMudmFsdWVbcG9zXSA9PT0gdGhpcy50aG91c2FuZHNTZXBhcmF0b3IpIHtcbiAgICAgICAgICBpZiAocG9zIDwgc3RhcnRDaGFuZ2VQb3MgfHxcbiAgICAgICAgICAvLyBjaGVjayBoaWdoIGJvdW5kXG4gICAgICAgICAgLy8gaWYgc2VwYXJhdG9yIGlzIHN0aWxsIHRoZXJlIC0gY29uc2lkZXIgaXQgYWxzb1xuICAgICAgICAgIHBvcyA9PT0gc3RhcnRDaGFuZ2VQb3MgJiYgcHJldmlvdXNWYWx1ZVtwb3NdID09PSB0aGlzLnRob3VzYW5kc1NlcGFyYXRvcikge1xuICAgICAgICAgICAgKytzdGFydENoYW5nZVBvcztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHBvcyA8IGJlZm9yZVRhaWxQb3MpICsrYmVmb3JlVGFpbFBvcztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBhZGp1c3QgZGV0YWlscyB3aXRoIHNlcGFyYXRvcnNcbiAgICAgIGFwcGVuZERldGFpbHMucmF3SW5zZXJ0ZWQgPSBhcHBlbmREZXRhaWxzLmluc2VydGVkO1xuICAgICAgYXBwZW5kRGV0YWlscy5pbnNlcnRlZCA9IHRoaXMudmFsdWUuc2xpY2Uoc3RhcnRDaGFuZ2VQb3MsIGJlZm9yZVRhaWxQb3MpO1xuICAgICAgYXBwZW5kRGV0YWlscy5zaGlmdCArPSBzdGFydENoYW5nZVBvcyAtIHByZXZpb3VzVmFsdWUubGVuZ3RoO1xuXG4gICAgICByZXR1cm4gYXBwZW5kRGV0YWlscztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgIEBvdmVycmlkZVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ25lYXJlc3RJbnB1dFBvcycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG5lYXJlc3RJbnB1dFBvcyhjdXJzb3JQb3MsIGRpcmVjdGlvbikge1xuICAgICAgaWYgKCFkaXJlY3Rpb24pIHJldHVybiBjdXJzb3JQb3M7XG5cbiAgICAgIHZhciBuZXh0UG9zID0gaW5kZXhJbkRpcmVjdGlvbihjdXJzb3JQb3MsIGRpcmVjdGlvbik7XG4gICAgICBpZiAodGhpcy52YWx1ZVtuZXh0UG9zXSA9PT0gdGhpcy50aG91c2FuZHNTZXBhcmF0b3IpIGN1cnNvclBvcyArPSBkaXJlY3Rpb247XG4gICAgICByZXR1cm4gY3Vyc29yUG9zO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnZG9WYWxpZGF0ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRvVmFsaWRhdGUoZmxhZ3MpIHtcbiAgICAgIHZhciByZWdleHAgPSBmbGFncy5pbnB1dCA/IHRoaXMuX251bWJlclJlZ0V4cElucHV0IDogdGhpcy5fbnVtYmVyUmVnRXhwO1xuXG4gICAgICAvLyB2YWxpZGF0ZSBhcyBzdHJpbmdcbiAgICAgIHZhciB2YWxpZCA9IHJlZ2V4cC50ZXN0KHRoaXMuX3JlbW92ZVRob3VzYW5kc1NlcGFyYXRvcnModGhpcy52YWx1ZSkpO1xuXG4gICAgICBpZiAodmFsaWQpIHtcbiAgICAgICAgLy8gdmFsaWRhdGUgYXMgbnVtYmVyXG4gICAgICAgIHZhciBudW1iZXIgPSB0aGlzLm51bWJlcjtcbiAgICAgICAgdmFsaWQgPSB2YWxpZCAmJiAhaXNOYU4obnVtYmVyKSAmJiAoXG4gICAgICAgIC8vIGNoZWNrIG1pbiBib3VuZCBmb3IgbmVnYXRpdmUgdmFsdWVzXG4gICAgICAgIHRoaXMubWluID09IG51bGwgfHwgdGhpcy5taW4gPj0gMCB8fCB0aGlzLm1pbiA8PSB0aGlzLm51bWJlcikgJiYgKFxuICAgICAgICAvLyBjaGVjayBtYXggYm91bmQgZm9yIHBvc2l0aXZlIHZhbHVlc1xuICAgICAgICB0aGlzLm1heCA9PSBudWxsIHx8IHRoaXMubWF4IDw9IDAgfHwgdGhpcy5udW1iZXIgPD0gdGhpcy5tYXgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdmFsaWQgJiYgZ2V0KE1hc2tlZE51bWJlci5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNYXNrZWROdW1iZXIucHJvdG90eXBlKSwgJ2RvVmFsaWRhdGUnLCB0aGlzKS5jYWxsKHRoaXMsIGZsYWdzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgIEBvdmVycmlkZVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ2RvQ29tbWl0JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZG9Db21taXQoKSB7XG4gICAgICB2YXIgbnVtYmVyID0gdGhpcy5udW1iZXI7XG4gICAgICB2YXIgdmFsaWRudW0gPSBudW1iZXI7XG5cbiAgICAgIC8vIGNoZWNrIGJvdW5kc1xuICAgICAgaWYgKHRoaXMubWluICE9IG51bGwpIHZhbGlkbnVtID0gTWF0aC5tYXgodmFsaWRudW0sIHRoaXMubWluKTtcbiAgICAgIGlmICh0aGlzLm1heCAhPSBudWxsKSB2YWxpZG51bSA9IE1hdGgubWluKHZhbGlkbnVtLCB0aGlzLm1heCk7XG5cbiAgICAgIGlmICh2YWxpZG51bSAhPT0gbnVtYmVyKSB0aGlzLnVubWFza2VkVmFsdWUgPSBTdHJpbmcodmFsaWRudW0pO1xuXG4gICAgICB2YXIgZm9ybWF0dGVkID0gdGhpcy52YWx1ZTtcblxuICAgICAgaWYgKHRoaXMubm9ybWFsaXplWmVyb3MpIGZvcm1hdHRlZCA9IHRoaXMuX25vcm1hbGl6ZVplcm9zKGZvcm1hdHRlZCk7XG4gICAgICBpZiAodGhpcy5wYWRGcmFjdGlvbmFsWmVyb3MpIGZvcm1hdHRlZCA9IHRoaXMuX3BhZEZyYWN0aW9uYWxaZXJvcyhmb3JtYXR0ZWQpO1xuXG4gICAgICB0aGlzLl92YWx1ZSA9IGZvcm1hdHRlZDtcbiAgICAgIGdldChNYXNrZWROdW1iZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkTnVtYmVyLnByb3RvdHlwZSksICdkb0NvbW1pdCcsIHRoaXMpLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgLyoqICovXG5cbiAgfSwge1xuICAgIGtleTogJ19ub3JtYWxpemVaZXJvcycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9ub3JtYWxpemVaZXJvcyh2YWx1ZSkge1xuICAgICAgdmFyIHBhcnRzID0gdGhpcy5fcmVtb3ZlVGhvdXNhbmRzU2VwYXJhdG9ycyh2YWx1ZSkuc3BsaXQodGhpcy5yYWRpeCk7XG5cbiAgICAgIC8vIHJlbW92ZSBsZWFkaW5nIHplcm9zXG4gICAgICBwYXJ0c1swXSA9IHBhcnRzWzBdLnJlcGxhY2UoL14oXFxEKikoMCopKFxcZCopLywgZnVuY3Rpb24gKG1hdGNoLCBzaWduLCB6ZXJvcywgbnVtKSB7XG4gICAgICAgIHJldHVybiBzaWduICsgbnVtO1xuICAgICAgfSk7XG4gICAgICAvLyBhZGQgbGVhZGluZyB6ZXJvXG4gICAgICBpZiAodmFsdWUubGVuZ3RoICYmICEvXFxkJC8udGVzdChwYXJ0c1swXSkpIHBhcnRzWzBdID0gcGFydHNbMF0gKyAnMCc7XG5cbiAgICAgIGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIHBhcnRzWzFdID0gcGFydHNbMV0ucmVwbGFjZSgvMCokLywgJycpOyAvLyByZW1vdmUgdHJhaWxpbmcgemVyb3NcbiAgICAgICAgaWYgKCFwYXJ0c1sxXS5sZW5ndGgpIHBhcnRzLmxlbmd0aCA9IDE7IC8vIHJlbW92ZSBmcmFjdGlvbmFsXG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLl9pbnNlcnRUaG91c2FuZHNTZXBhcmF0b3JzKHBhcnRzLmpvaW4odGhpcy5yYWRpeCkpO1xuICAgIH1cblxuICAgIC8qKiAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdfcGFkRnJhY3Rpb25hbFplcm9zJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX3BhZEZyYWN0aW9uYWxaZXJvcyh2YWx1ZSkge1xuICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuIHZhbHVlO1xuXG4gICAgICB2YXIgcGFydHMgPSB2YWx1ZS5zcGxpdCh0aGlzLnJhZGl4KTtcbiAgICAgIGlmIChwYXJ0cy5sZW5ndGggPCAyKSBwYXJ0cy5wdXNoKCcnKTtcbiAgICAgIHBhcnRzWzFdID0gcGFydHNbMV0ucGFkRW5kKHRoaXMuc2NhbGUsICcwJyk7XG4gICAgICByZXR1cm4gcGFydHMuam9pbih0aGlzLnJhZGl4KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgIEBvdmVycmlkZVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ3VubWFza2VkVmFsdWUnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0JCQxKCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3JlbW92ZVRob3VzYW5kc1NlcGFyYXRvcnModGhpcy5fbm9ybWFsaXplWmVyb3ModGhpcy52YWx1ZSkpLnJlcGxhY2UodGhpcy5yYWRpeCwgJy4nKTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gc2V0JCQxKHVubWFza2VkVmFsdWUpIHtcbiAgICAgIHNldChNYXNrZWROdW1iZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkTnVtYmVyLnByb3RvdHlwZSksICd1bm1hc2tlZFZhbHVlJywgdW5tYXNrZWRWYWx1ZS5yZXBsYWNlKCcuJywgdGhpcy5yYWRpeCksIHRoaXMpO1xuICAgIH1cblxuICAgIC8qKiBQYXJzZWQgTnVtYmVyICovXG5cbiAgfSwge1xuICAgIGtleTogJ251bWJlcicsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gTnVtYmVyKHRoaXMudW5tYXNrZWRWYWx1ZSk7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldCQkMShudW1iZXIpIHtcbiAgICAgIHRoaXMudW5tYXNrZWRWYWx1ZSA9IFN0cmluZyhudW1iZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgSXMgbmVnYXRpdmUgYWxsb3dlZFxuICAgICAgQHJlYWRvbmx5XG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnYWxsb3dOZWdhdGl2ZScsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gdGhpcy5zaWduZWQgfHwgdGhpcy5taW4gIT0gbnVsbCAmJiB0aGlzLm1pbiA8IDAgfHwgdGhpcy5tYXggIT0gbnVsbCAmJiB0aGlzLm1heCA8IDA7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBNYXNrZWROdW1iZXI7XG59KE1hc2tlZCk7XG5cbk1hc2tlZE51bWJlci5ERUZBVUxUUyA9IHtcbiAgcmFkaXg6ICcsJyxcbiAgdGhvdXNhbmRzU2VwYXJhdG9yOiAnJyxcbiAgbWFwVG9SYWRpeDogWycuJ10sXG4gIHNjYWxlOiAyLFxuICBzaWduZWQ6IGZhbHNlLFxuICBub3JtYWxpemVaZXJvczogdHJ1ZSxcbiAgcGFkRnJhY3Rpb25hbFplcm9zOiBmYWxzZVxufTtcblxuLyoqIE1hc2tpbmcgYnkgUmVnRXhwICovXG5cbnZhciBNYXNrZWRSZWdFeHAgPSBmdW5jdGlvbiAoX01hc2tlZCkge1xuICBpbmhlcml0cyhNYXNrZWRSZWdFeHAsIF9NYXNrZWQpO1xuXG4gIGZ1bmN0aW9uIE1hc2tlZFJlZ0V4cCgpIHtcbiAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBNYXNrZWRSZWdFeHApO1xuICAgIHJldHVybiBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChNYXNrZWRSZWdFeHAuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNYXNrZWRSZWdFeHApKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgfVxuXG4gIGNyZWF0ZUNsYXNzKE1hc2tlZFJlZ0V4cCwgW3tcbiAgICBrZXk6ICdfdXBkYXRlJyxcblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgICBAcGFyYW0ge09iamVjdH0gb3B0c1xuICAgICovXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF91cGRhdGUob3B0cykge1xuICAgICAgb3B0cy52YWxpZGF0ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUuc2VhcmNoKG9wdHMubWFzaykgPj0gMDtcbiAgICAgIH07XG4gICAgICBnZXQoTWFza2VkUmVnRXhwLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1hc2tlZFJlZ0V4cC5wcm90b3R5cGUpLCAnX3VwZGF0ZScsIHRoaXMpLmNhbGwodGhpcywgb3B0cyk7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBNYXNrZWRSZWdFeHA7XG59KE1hc2tlZCk7XG5cbi8qKiBNYXNraW5nIGJ5IGN1c3RvbSBGdW5jdGlvbiAqL1xuXG52YXIgTWFza2VkRnVuY3Rpb24gPSBmdW5jdGlvbiAoX01hc2tlZCkge1xuICBpbmhlcml0cyhNYXNrZWRGdW5jdGlvbiwgX01hc2tlZCk7XG5cbiAgZnVuY3Rpb24gTWFza2VkRnVuY3Rpb24oKSB7XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgTWFza2VkRnVuY3Rpb24pO1xuICAgIHJldHVybiBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChNYXNrZWRGdW5jdGlvbi5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1hc2tlZEZ1bmN0aW9uKSkuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gIH1cblxuICBjcmVhdGVDbGFzcyhNYXNrZWRGdW5jdGlvbiwgW3tcbiAgICBrZXk6ICdfdXBkYXRlJyxcblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgICBAcGFyYW0ge09iamVjdH0gb3B0c1xuICAgICovXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF91cGRhdGUob3B0cykge1xuICAgICAgb3B0cy52YWxpZGF0ZSA9IG9wdHMubWFzaztcbiAgICAgIGdldChNYXNrZWRGdW5jdGlvbi5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNYXNrZWRGdW5jdGlvbi5wcm90b3R5cGUpLCAnX3VwZGF0ZScsIHRoaXMpLmNhbGwodGhpcywgb3B0cyk7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBNYXNrZWRGdW5jdGlvbjtcbn0oTWFza2VkKTtcblxuLyoqIER5bmFtaWMgbWFzayBmb3IgY2hvb3NpbmcgYXByb3ByaWF0ZSBtYXNrIGluIHJ1bi10aW1lICovXG52YXIgTWFza2VkRHluYW1pYyA9IGZ1bmN0aW9uIChfTWFza2VkKSB7XG4gIGluaGVyaXRzKE1hc2tlZER5bmFtaWMsIF9NYXNrZWQpO1xuXG4gIC8qKlxuICAgIEBwYXJhbSB7T2JqZWN0fSBvcHRzXG4gICovXG5cbiAgLyoqIENvbXBsaWxlZCB7QGxpbmsgTWFza2VkfSBvcHRpb25zICovXG4gIGZ1bmN0aW9uIE1hc2tlZER5bmFtaWMob3B0cykge1xuICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIE1hc2tlZER5bmFtaWMpO1xuXG4gICAgdmFyIF90aGlzID0gcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoTWFza2VkRHluYW1pYy5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1hc2tlZER5bmFtaWMpKS5jYWxsKHRoaXMsIF9leHRlbmRzKHt9LCBNYXNrZWREeW5hbWljLkRFRkFVTFRTLCBvcHRzKSkpO1xuXG4gICAgX3RoaXMuY3VycmVudE1hc2sgPSBudWxsO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgIEBvdmVycmlkZVxuICAqL1xuXG4gIC8qKiBDaG9vc2VzIHtAbGluayBNYXNrZWR9IGRlcGVuZGluZyBvbiBpbnB1dCB2YWx1ZSAqL1xuXG4gIC8qKiBDdXJyZW50bHkgY2hvc2VuIG1hc2sgKi9cblxuXG4gIGNyZWF0ZUNsYXNzKE1hc2tlZER5bmFtaWMsIFt7XG4gICAga2V5OiAnX3VwZGF0ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF91cGRhdGUob3B0cykge1xuICAgICAgZ2V0KE1hc2tlZER5bmFtaWMucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkRHluYW1pYy5wcm90b3R5cGUpLCAnX3VwZGF0ZScsIHRoaXMpLmNhbGwodGhpcywgb3B0cyk7XG4gICAgICAvLyBtYXNrIGNvdWxkIGJlIHRvdGFsbHkgZHluYW1pYyB3aXRoIG9ubHkgYGRpc3BhdGNoYCBvcHRpb25cbiAgICAgIHRoaXMuY29tcGlsZWRNYXNrcyA9IEFycmF5LmlzQXJyYXkob3B0cy5tYXNrKSA/IG9wdHMubWFzay5tYXAoZnVuY3Rpb24gKG0pIHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZU1hc2sobSk7XG4gICAgICB9KSA6IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnX2FwcGVuZCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIF9hcHBlbmQoc3RyKSB7XG4gICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICB9XG5cbiAgICAgIHN0ciA9IHRoaXMuZG9QcmVwYXJlLmFwcGx5KHRoaXMsIFtzdHJdLmNvbmNhdCh0b0NvbnN1bWFibGVBcnJheShhcmdzKSkpO1xuXG4gICAgICB2YXIgZGV0YWlscyA9IHRoaXMuX2FwcGx5RGlzcGF0Y2guYXBwbHkodGhpcywgW3N0cl0uY29uY2F0KHRvQ29uc3VtYWJsZUFycmF5KGFyZ3MpKSk7XG5cbiAgICAgIGlmICh0aGlzLmN1cnJlbnRNYXNrKSB7XG4gICAgICAgIHZhciBfY3VycmVudE1hc2s7XG5cbiAgICAgICAgZGV0YWlscy5hZ2dyZWdhdGUoKF9jdXJyZW50TWFzayA9IHRoaXMuY3VycmVudE1hc2spLl9hcHBlbmQuYXBwbHkoX2N1cnJlbnRNYXNrLCBbc3RyXS5jb25jYXQodG9Db25zdW1hYmxlQXJyYXkoYXJncykpKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkZXRhaWxzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ19hcHBseURpc3BhdGNoJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2FwcGx5RGlzcGF0Y2goKSB7XG4gICAgICB2YXIgYXBwZW5kZWQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICcnO1xuXG4gICAgICB2YXIgb2xkVmFsdWVMZW5ndGggPSB0aGlzLnZhbHVlLmxlbmd0aDtcbiAgICAgIHZhciBpbnB1dFZhbHVlID0gdGhpcy5yYXdJbnB1dFZhbHVlO1xuICAgICAgdmFyIG9sZE1hc2sgPSB0aGlzLmN1cnJlbnRNYXNrO1xuICAgICAgdmFyIGRldGFpbHMgPSBuZXcgQ2hhbmdlRGV0YWlscygpO1xuXG4gICAgICAvLyBkaXNwYXRjaCBTSE9VTEQgTk9UIG1vZGlmeSBtYXNrXG5cbiAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4yID4gMSA/IF9sZW4yIC0gMSA6IDApLCBfa2V5MiA9IDE7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHtcbiAgICAgICAgYXJnc1tfa2V5MiAtIDFdID0gYXJndW1lbnRzW19rZXkyXTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5jdXJyZW50TWFzayA9IHRoaXMuZG9EaXNwYXRjaC5hcHBseSh0aGlzLCBbYXBwZW5kZWRdLmNvbmNhdCh0b0NvbnN1bWFibGVBcnJheShhcmdzKSkpO1xuXG4gICAgICAvLyByZXN0b3JlIHN0YXRlIGFmdGVyIGRpc3BhdGNoXG4gICAgICBpZiAodGhpcy5jdXJyZW50TWFzayAmJiB0aGlzLmN1cnJlbnRNYXNrICE9PSBvbGRNYXNrKSB7XG4gICAgICAgIC8vIGlmIG1hc2sgY2hhbmdlZCByZWFwcGx5IGlucHV0XG4gICAgICAgIHRoaXMuY3VycmVudE1hc2sucmVzZXQoKTtcbiAgICAgICAgLy8gJEZsb3dGaXhNZSAtIGl0J3Mgb2ssIHdlIGRvbid0IGNoYW5nZSBjdXJyZW50IG1hc2tcbiAgICAgICAgdGhpcy5jdXJyZW50TWFzay5fYXBwZW5kKGlucHV0VmFsdWUsIHsgcmF3OiB0cnVlIH0pO1xuICAgICAgICBkZXRhaWxzLnNoaWZ0ID0gdGhpcy52YWx1ZS5sZW5ndGggLSBvbGRWYWx1ZUxlbmd0aDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGRldGFpbHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICBAb3ZlcnJpZGVcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdkb0Rpc3BhdGNoJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZG9EaXNwYXRjaChhcHBlbmRlZCkge1xuICAgICAgdmFyIGZsYWdzID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcblxuICAgICAgcmV0dXJuIHRoaXMuZGlzcGF0Y2goYXBwZW5kZWQsIHRoaXMsIGZsYWdzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgIEBvdmVycmlkZVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ2Nsb25lJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvbmUoKSB7XG4gICAgICB2YXIgbSA9IG5ldyBNYXNrZWREeW5hbWljKHRoaXMpO1xuICAgICAgbS5fdmFsdWUgPSB0aGlzLnZhbHVlO1xuXG4gICAgICAvLyB0cnkgdG8ga2VlcCByZWZlcmVuY2UgdG8gY29tcGlsZWQgbWFza3NcbiAgICAgIHZhciBjdXJyZW50TWFza0luZGV4ID0gdGhpcy5jb21waWxlZE1hc2tzLmluZGV4T2YodGhpcy5jdXJyZW50TWFzayk7XG4gICAgICBpZiAodGhpcy5jdXJyZW50TWFzaykge1xuICAgICAgICBtLmN1cnJlbnRNYXNrID0gY3VycmVudE1hc2tJbmRleCA+PSAwID8gbS5jb21waWxlZE1hc2tzW2N1cnJlbnRNYXNrSW5kZXhdLmFzc2lnbih0aGlzLmN1cnJlbnRNYXNrKSA6IHRoaXMuY3VycmVudE1hc2suY2xvbmUoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICBAb3ZlcnJpZGVcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdyZXNldCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgICAgaWYgKHRoaXMuY3VycmVudE1hc2spIHRoaXMuY3VycmVudE1hc2sucmVzZXQoKTtcbiAgICAgIHRoaXMuY29tcGlsZWRNYXNrcy5mb3JFYWNoKGZ1bmN0aW9uIChjbSkge1xuICAgICAgICByZXR1cm4gY20ucmVzZXQoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAncmVtb3ZlJyxcblxuXG4gICAgLyoqXG4gICAgICBAb3ZlcnJpZGVcbiAgICAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICB2YXIgZGV0YWlscyA9IG5ldyBDaGFuZ2VEZXRhaWxzKCk7XG4gICAgICBpZiAodGhpcy5jdXJyZW50TWFzaykge1xuICAgICAgICB2YXIgX2N1cnJlbnRNYXNrMjtcblxuICAgICAgICBkZXRhaWxzLmFnZ3JlZ2F0ZSgoX2N1cnJlbnRNYXNrMiA9IHRoaXMuY3VycmVudE1hc2spLnJlbW92ZS5hcHBseShfY3VycmVudE1hc2syLCBhcmd1bWVudHMpKVxuICAgICAgICAvLyB1cGRhdGUgd2l0aCBkaXNwYXRjaFxuICAgICAgICAuYWdncmVnYXRlKHRoaXMuX2FwcGx5RGlzcGF0Y2goKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkZXRhaWxzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnZXh0cmFjdElucHV0JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXh0cmFjdElucHV0KCkge1xuICAgICAgdmFyIF9jdXJyZW50TWFzazM7XG5cbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRNYXNrID8gKF9jdXJyZW50TWFzazMgPSB0aGlzLmN1cnJlbnRNYXNrKS5leHRyYWN0SW5wdXQuYXBwbHkoX2N1cnJlbnRNYXNrMywgYXJndW1lbnRzKSA6ICcnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnX2V4dHJhY3RUYWlsJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2V4dHJhY3RUYWlsKCkge1xuICAgICAgdmFyIF9jdXJyZW50TWFzazQsIF9iYWJlbEhlbHBlcnMkZ2V0O1xuXG4gICAgICBmb3IgKHZhciBfbGVuMyA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuMyksIF9rZXkzID0gMDsgX2tleTMgPCBfbGVuMzsgX2tleTMrKykge1xuICAgICAgICBhcmdzW19rZXkzXSA9IGFyZ3VtZW50c1tfa2V5M107XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRNYXNrID8gKF9jdXJyZW50TWFzazQgPSB0aGlzLmN1cnJlbnRNYXNrKS5fZXh0cmFjdFRhaWwuYXBwbHkoX2N1cnJlbnRNYXNrNCwgdG9Db25zdW1hYmxlQXJyYXkoYXJncykpIDogKF9iYWJlbEhlbHBlcnMkZ2V0ID0gZ2V0KE1hc2tlZER5bmFtaWMucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkRHluYW1pYy5wcm90b3R5cGUpLCAnX2V4dHJhY3RUYWlsJywgdGhpcykpLmNhbGwuYXBwbHkoX2JhYmVsSGVscGVycyRnZXQsIFt0aGlzXS5jb25jYXQodG9Db25zdW1hYmxlQXJyYXkoYXJncykpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgIEBvdmVycmlkZVxuICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ19hcHBlbmRUYWlsJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2FwcGVuZFRhaWwodGFpbCkge1xuICAgICAgdmFyIGRldGFpbHMgPSBuZXcgQ2hhbmdlRGV0YWlscygpO1xuICAgICAgaWYgKHRhaWwpIGRldGFpbHMuYWdncmVnYXRlKHRoaXMuX2FwcGx5RGlzcGF0Y2godGFpbC52YWx1ZSkpO1xuXG4gICAgICByZXR1cm4gZGV0YWlscy5hZ2dyZWdhdGUodGhpcy5jdXJyZW50TWFzayA/IHRoaXMuY3VycmVudE1hc2suX2FwcGVuZFRhaWwodGFpbCkgOiBnZXQoTWFza2VkRHluYW1pYy5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNYXNrZWREeW5hbWljLnByb3RvdHlwZSksICdfYXBwZW5kVGFpbCcsIHRoaXMpLmNhbGwodGhpcywgdGFpbCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnZG9Db21taXQnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBkb0NvbW1pdCgpIHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRNYXNrKSB0aGlzLmN1cnJlbnRNYXNrLmRvQ29tbWl0KCk7XG4gICAgICBnZXQoTWFza2VkRHluYW1pYy5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNYXNrZWREeW5hbWljLnByb3RvdHlwZSksICdkb0NvbW1pdCcsIHRoaXMpLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICBAb3ZlcnJpZGVcbiAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICduZWFyZXN0SW5wdXRQb3MnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBuZWFyZXN0SW5wdXRQb3MoKSB7XG4gICAgICB2YXIgX2N1cnJlbnRNYXNrNSwgX2JhYmVsSGVscGVycyRnZXQyO1xuXG4gICAgICBmb3IgKHZhciBfbGVuNCA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuNCksIF9rZXk0ID0gMDsgX2tleTQgPCBfbGVuNDsgX2tleTQrKykge1xuICAgICAgICBhcmdzW19rZXk0XSA9IGFyZ3VtZW50c1tfa2V5NF07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRNYXNrID8gKF9jdXJyZW50TWFzazUgPSB0aGlzLmN1cnJlbnRNYXNrKS5uZWFyZXN0SW5wdXRQb3MuYXBwbHkoX2N1cnJlbnRNYXNrNSwgdG9Db25zdW1hYmxlQXJyYXkoYXJncykpIDogKF9iYWJlbEhlbHBlcnMkZ2V0MiA9IGdldChNYXNrZWREeW5hbWljLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1hc2tlZER5bmFtaWMucHJvdG90eXBlKSwgJ25lYXJlc3RJbnB1dFBvcycsIHRoaXMpKS5jYWxsLmFwcGx5KF9iYWJlbEhlbHBlcnMkZ2V0MiwgW3RoaXNdLmNvbmNhdCh0b0NvbnN1bWFibGVBcnJheShhcmdzKSkpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3ZhbHVlJyxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCQkMSgpIHtcbiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRNYXNrID8gdGhpcy5jdXJyZW50TWFzay52YWx1ZSA6ICcnO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQkJDEodmFsdWUpIHtcbiAgICAgIHNldChNYXNrZWREeW5hbWljLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1hc2tlZER5bmFtaWMucHJvdG90eXBlKSwgJ3ZhbHVlJywgdmFsdWUsIHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAndW5tYXNrZWRWYWx1ZScsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gdGhpcy5jdXJyZW50TWFzayA/IHRoaXMuY3VycmVudE1hc2sudW5tYXNrZWRWYWx1ZSA6ICcnO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQkJDEodW5tYXNrZWRWYWx1ZSkge1xuICAgICAgc2V0KE1hc2tlZER5bmFtaWMucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTWFza2VkRHluYW1pYy5wcm90b3R5cGUpLCAndW5tYXNrZWRWYWx1ZScsIHVubWFza2VkVmFsdWUsIHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAgQG92ZXJyaWRlXG4gICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAnaXNDb21wbGV0ZScsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQkJDEoKSB7XG4gICAgICByZXR1cm4gISF0aGlzLmN1cnJlbnRNYXNrICYmIHRoaXMuY3VycmVudE1hc2suaXNDb21wbGV0ZTtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIE1hc2tlZER5bmFtaWM7XG59KE1hc2tlZCk7XG5cbk1hc2tlZER5bmFtaWMuREVGQVVMVFMgPSB7XG4gIGRpc3BhdGNoOiBmdW5jdGlvbiBkaXNwYXRjaChhcHBlbmRlZCwgbWFza2VkLCBmbGFncykge1xuICAgIGlmICghbWFza2VkLmNvbXBpbGVkTWFza3MubGVuZ3RoKSByZXR1cm47XG5cbiAgICB2YXIgaW5wdXRWYWx1ZSA9IG1hc2tlZC5yYXdJbnB1dFZhbHVlO1xuXG4gICAgLy8gc2ltdWxhdGUgaW5wdXRcbiAgICB2YXIgaW5wdXRzID0gbWFza2VkLmNvbXBpbGVkTWFza3MubWFwKGZ1bmN0aW9uIChjbSwgaW5kZXgpIHtcbiAgICAgIHZhciBtID0gY20uY2xvbmUoKTtcbiAgICAgIG0ucmF3SW5wdXRWYWx1ZSA9IGlucHV0VmFsdWU7XG4gICAgICBtLl9hcHBlbmQoYXBwZW5kZWQsIGZsYWdzKTtcblxuICAgICAgcmV0dXJuIHsgdmFsdWU6IG0ucmF3SW5wdXRWYWx1ZS5sZW5ndGgsIGluZGV4OiBpbmRleCB9O1xuICAgIH0pO1xuXG4gICAgLy8gcG9wIG1hc2tzIHdpdGggbG9uZ2VyIHZhbHVlcyBmaXJzdFxuICAgIGlucHV0cy5zb3J0KGZ1bmN0aW9uIChpMSwgaTIpIHtcbiAgICAgIHJldHVybiBpMi52YWx1ZSAtIGkxLnZhbHVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIG1hc2tlZC5jb21waWxlZE1hc2tzW2lucHV0c1swXS5pbmRleF07XG4gIH1cbn07XG5cbi8qKlxuICogQXBwbGllcyBtYXNrIG9uIGVsZW1lbnQuXG4gKiBAY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7SFRNTElucHV0fFVJRWxlbWVudH0gZWwgLSBFbGVtZW50IHRvIGFwcGx5IG1hc2tcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRzIC0gQ3VzdG9tIG1hc2sgb3B0aW9uc1xuICogQHJldHVybiB7SW5wdXRNYXNrfVxuICovXG5mdW5jdGlvbiBJTWFzayhlbCkge1xuICB2YXIgb3B0cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgLy8gY3VycmVudGx5IGF2YWlsYWJsZSBvbmx5IGZvciBpbnB1dC1saWtlIGVsZW1lbnRzXG4gIHJldHVybiBuZXcgSW5wdXRNYXNrKGVsLCBvcHRzKTtcbn1cblxuLyoqIHtAbGluayBJbnB1dE1hc2t9ICovXG5JTWFzay5JbnB1dE1hc2sgPSBJbnB1dE1hc2s7XG5cbi8qKiB7QGxpbmsgTWFza2VkfSAqL1xuSU1hc2suTWFza2VkID0gTWFza2VkO1xuLyoqIHtAbGluayBNYXNrZWRQYXR0ZXJufSAqL1xuSU1hc2suTWFza2VkUGF0dGVybiA9IE1hc2tlZFBhdHRlcm47XG4vKioge0BsaW5rIE1hc2tlZE51bWJlcn0gKi9cbklNYXNrLk1hc2tlZE51bWJlciA9IE1hc2tlZE51bWJlcjtcbi8qKiB7QGxpbmsgTWFza2VkRGF0ZX0gKi9cbklNYXNrLk1hc2tlZERhdGUgPSBNYXNrZWREYXRlO1xuLyoqIHtAbGluayBNYXNrZWRSZWdFeHB9ICovXG5JTWFzay5NYXNrZWRSZWdFeHAgPSBNYXNrZWRSZWdFeHA7XG4vKioge0BsaW5rIE1hc2tlZEZ1bmN0aW9ufSAqL1xuSU1hc2suTWFza2VkRnVuY3Rpb24gPSBNYXNrZWRGdW5jdGlvbjtcbi8qKiB7QGxpbmsgTWFza2VkRHluYW1pY30gKi9cbklNYXNrLk1hc2tlZER5bmFtaWMgPSBNYXNrZWREeW5hbWljO1xuLyoqIHtAbGluayBjcmVhdGVNYXNrfSAqL1xuSU1hc2suY3JlYXRlTWFzayA9IGNyZWF0ZU1hc2s7XG5cbmcuSU1hc2sgPSBJTWFzaztcblxucmV0dXJuIElNYXNrO1xuXG59KSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hc2suanMubWFwXG4iLCIvKiFcbiAqIElzb3RvcGUgUEFDS0FHRUQgdjMuMC41XG4gKlxuICogTGljZW5zZWQgR1BMdjMgZm9yIG9wZW4gc291cmNlIHVzZVxuICogb3IgSXNvdG9wZSBDb21tZXJjaWFsIExpY2Vuc2UgZm9yIGNvbW1lcmNpYWwgdXNlXG4gKlxuICogaHR0cHM6Ly9pc290b3BlLm1ldGFmaXp6eS5jb1xuICogQ29weXJpZ2h0IDIwMTcgTWV0YWZpenp5XG4gKi9cblxuIWZ1bmN0aW9uKHQsZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShcImpxdWVyeS1icmlkZ2V0L2pxdWVyeS1icmlkZ2V0XCIsW1wianF1ZXJ5XCJdLGZ1bmN0aW9uKGkpe3JldHVybiBlKHQsaSl9KTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lKHQscmVxdWlyZShcImpxdWVyeVwiKSk6dC5qUXVlcnlCcmlkZ2V0PWUodCx0LmpRdWVyeSl9KHdpbmRvdyxmdW5jdGlvbih0LGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGkoaSxzLGEpe2Z1bmN0aW9uIHUodCxlLG8pe3ZhciBuLHM9XCIkKCkuXCIraSsnKFwiJytlKydcIiknO3JldHVybiB0LmVhY2goZnVuY3Rpb24odCx1KXt2YXIgaD1hLmRhdGEodSxpKTtpZighaClyZXR1cm4gdm9pZCByKGkrXCIgbm90IGluaXRpYWxpemVkLiBDYW5ub3QgY2FsbCBtZXRob2RzLCBpLmUuIFwiK3MpO3ZhciBkPWhbZV07aWYoIWR8fFwiX1wiPT1lLmNoYXJBdCgwKSlyZXR1cm4gdm9pZCByKHMrXCIgaXMgbm90IGEgdmFsaWQgbWV0aG9kXCIpO3ZhciBsPWQuYXBwbHkoaCxvKTtuPXZvaWQgMD09PW4/bDpufSksdm9pZCAwIT09bj9uOnR9ZnVuY3Rpb24gaCh0LGUpe3QuZWFjaChmdW5jdGlvbih0LG8pe3ZhciBuPWEuZGF0YShvLGkpO24/KG4ub3B0aW9uKGUpLG4uX2luaXQoKSk6KG49bmV3IHMobyxlKSxhLmRhdGEobyxpLG4pKX0pfWE9YXx8ZXx8dC5qUXVlcnksYSYmKHMucHJvdG90eXBlLm9wdGlvbnx8KHMucHJvdG90eXBlLm9wdGlvbj1mdW5jdGlvbih0KXthLmlzUGxhaW5PYmplY3QodCkmJih0aGlzLm9wdGlvbnM9YS5leHRlbmQoITAsdGhpcy5vcHRpb25zLHQpKX0pLGEuZm5baV09ZnVuY3Rpb24odCl7aWYoXCJzdHJpbmdcIj09dHlwZW9mIHQpe3ZhciBlPW4uY2FsbChhcmd1bWVudHMsMSk7cmV0dXJuIHUodGhpcyx0LGUpfXJldHVybiBoKHRoaXMsdCksdGhpc30sbyhhKSl9ZnVuY3Rpb24gbyh0KXshdHx8dCYmdC5icmlkZ2V0fHwodC5icmlkZ2V0PWkpfXZhciBuPUFycmF5LnByb3RvdHlwZS5zbGljZSxzPXQuY29uc29sZSxyPVwidW5kZWZpbmVkXCI9PXR5cGVvZiBzP2Z1bmN0aW9uKCl7fTpmdW5jdGlvbih0KXtzLmVycm9yKHQpfTtyZXR1cm4gbyhlfHx0LmpRdWVyeSksaX0pLGZ1bmN0aW9uKHQsZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShcImV2LWVtaXR0ZXIvZXYtZW1pdHRlclwiLGUpOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUoKTp0LkV2RW1pdHRlcj1lKCl9KFwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OnRoaXMsZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7fXZhciBlPXQucHJvdG90eXBlO3JldHVybiBlLm9uPWZ1bmN0aW9uKHQsZSl7aWYodCYmZSl7dmFyIGk9dGhpcy5fZXZlbnRzPXRoaXMuX2V2ZW50c3x8e30sbz1pW3RdPWlbdF18fFtdO3JldHVybiBvLmluZGV4T2YoZSk9PS0xJiZvLnB1c2goZSksdGhpc319LGUub25jZT1mdW5jdGlvbih0LGUpe2lmKHQmJmUpe3RoaXMub24odCxlKTt2YXIgaT10aGlzLl9vbmNlRXZlbnRzPXRoaXMuX29uY2VFdmVudHN8fHt9LG89aVt0XT1pW3RdfHx7fTtyZXR1cm4gb1tlXT0hMCx0aGlzfX0sZS5vZmY9ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLl9ldmVudHMmJnRoaXMuX2V2ZW50c1t0XTtpZihpJiZpLmxlbmd0aCl7dmFyIG89aS5pbmRleE9mKGUpO3JldHVybiBvIT0tMSYmaS5zcGxpY2UobywxKSx0aGlzfX0sZS5lbWl0RXZlbnQ9ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLl9ldmVudHMmJnRoaXMuX2V2ZW50c1t0XTtpZihpJiZpLmxlbmd0aCl7aT1pLnNsaWNlKDApLGU9ZXx8W107Zm9yKHZhciBvPXRoaXMuX29uY2VFdmVudHMmJnRoaXMuX29uY2VFdmVudHNbdF0sbj0wO248aS5sZW5ndGg7bisrKXt2YXIgcz1pW25dLHI9byYmb1tzXTtyJiYodGhpcy5vZmYodCxzKSxkZWxldGUgb1tzXSkscy5hcHBseSh0aGlzLGUpfXJldHVybiB0aGlzfX0sZS5hbGxPZmY9ZnVuY3Rpb24oKXtkZWxldGUgdGhpcy5fZXZlbnRzLGRlbGV0ZSB0aGlzLl9vbmNlRXZlbnRzfSx0fSksZnVuY3Rpb24odCxlKXtcInVzZSBzdHJpY3RcIjtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiZ2V0LXNpemUvZ2V0LXNpemVcIixbXSxmdW5jdGlvbigpe3JldHVybiBlKCl9KTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lKCk6dC5nZXRTaXplPWUoKX0od2luZG93LGZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdCh0KXt2YXIgZT1wYXJzZUZsb2F0KHQpLGk9dC5pbmRleE9mKFwiJVwiKT09LTEmJiFpc05hTihlKTtyZXR1cm4gaSYmZX1mdW5jdGlvbiBlKCl7fWZ1bmN0aW9uIGkoKXtmb3IodmFyIHQ9e3dpZHRoOjAsaGVpZ2h0OjAsaW5uZXJXaWR0aDowLGlubmVySGVpZ2h0OjAsb3V0ZXJXaWR0aDowLG91dGVySGVpZ2h0OjB9LGU9MDtlPGg7ZSsrKXt2YXIgaT11W2VdO3RbaV09MH1yZXR1cm4gdH1mdW5jdGlvbiBvKHQpe3ZhciBlPWdldENvbXB1dGVkU3R5bGUodCk7cmV0dXJuIGV8fGEoXCJTdHlsZSByZXR1cm5lZCBcIitlK1wiLiBBcmUgeW91IHJ1bm5pbmcgdGhpcyBjb2RlIGluIGEgaGlkZGVuIGlmcmFtZSBvbiBGaXJlZm94PyBTZWUgaHR0cDovL2JpdC5seS9nZXRzaXplYnVnMVwiKSxlfWZ1bmN0aW9uIG4oKXtpZighZCl7ZD0hMDt2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2Uuc3R5bGUud2lkdGg9XCIyMDBweFwiLGUuc3R5bGUucGFkZGluZz1cIjFweCAycHggM3B4IDRweFwiLGUuc3R5bGUuYm9yZGVyU3R5bGU9XCJzb2xpZFwiLGUuc3R5bGUuYm9yZGVyV2lkdGg9XCIxcHggMnB4IDNweCA0cHhcIixlLnN0eWxlLmJveFNpemluZz1cImJvcmRlci1ib3hcIjt2YXIgaT1kb2N1bWVudC5ib2R5fHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7aS5hcHBlbmRDaGlsZChlKTt2YXIgbj1vKGUpO3MuaXNCb3hTaXplT3V0ZXI9cj0yMDA9PXQobi53aWR0aCksaS5yZW1vdmVDaGlsZChlKX19ZnVuY3Rpb24gcyhlKXtpZihuKCksXCJzdHJpbmdcIj09dHlwZW9mIGUmJihlPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZSkpLGUmJlwib2JqZWN0XCI9PXR5cGVvZiBlJiZlLm5vZGVUeXBlKXt2YXIgcz1vKGUpO2lmKFwibm9uZVwiPT1zLmRpc3BsYXkpcmV0dXJuIGkoKTt2YXIgYT17fTthLndpZHRoPWUub2Zmc2V0V2lkdGgsYS5oZWlnaHQ9ZS5vZmZzZXRIZWlnaHQ7Zm9yKHZhciBkPWEuaXNCb3JkZXJCb3g9XCJib3JkZXItYm94XCI9PXMuYm94U2l6aW5nLGw9MDtsPGg7bCsrKXt2YXIgZj11W2xdLGM9c1tmXSxtPXBhcnNlRmxvYXQoYyk7YVtmXT1pc05hTihtKT8wOm19dmFyIHA9YS5wYWRkaW5nTGVmdCthLnBhZGRpbmdSaWdodCx5PWEucGFkZGluZ1RvcCthLnBhZGRpbmdCb3R0b20sZz1hLm1hcmdpbkxlZnQrYS5tYXJnaW5SaWdodCx2PWEubWFyZ2luVG9wK2EubWFyZ2luQm90dG9tLF89YS5ib3JkZXJMZWZ0V2lkdGgrYS5ib3JkZXJSaWdodFdpZHRoLEk9YS5ib3JkZXJUb3BXaWR0aCthLmJvcmRlckJvdHRvbVdpZHRoLHo9ZCYmcix4PXQocy53aWR0aCk7eCE9PSExJiYoYS53aWR0aD14Kyh6PzA6cCtfKSk7dmFyIFM9dChzLmhlaWdodCk7cmV0dXJuIFMhPT0hMSYmKGEuaGVpZ2h0PVMrKHo/MDp5K0kpKSxhLmlubmVyV2lkdGg9YS53aWR0aC0ocCtfKSxhLmlubmVySGVpZ2h0PWEuaGVpZ2h0LSh5K0kpLGEub3V0ZXJXaWR0aD1hLndpZHRoK2csYS5vdXRlckhlaWdodD1hLmhlaWdodCt2LGF9fXZhciByLGE9XCJ1bmRlZmluZWRcIj09dHlwZW9mIGNvbnNvbGU/ZTpmdW5jdGlvbih0KXtjb25zb2xlLmVycm9yKHQpfSx1PVtcInBhZGRpbmdMZWZ0XCIsXCJwYWRkaW5nUmlnaHRcIixcInBhZGRpbmdUb3BcIixcInBhZGRpbmdCb3R0b21cIixcIm1hcmdpbkxlZnRcIixcIm1hcmdpblJpZ2h0XCIsXCJtYXJnaW5Ub3BcIixcIm1hcmdpbkJvdHRvbVwiLFwiYm9yZGVyTGVmdFdpZHRoXCIsXCJib3JkZXJSaWdodFdpZHRoXCIsXCJib3JkZXJUb3BXaWR0aFwiLFwiYm9yZGVyQm90dG9tV2lkdGhcIl0saD11Lmxlbmd0aCxkPSExO3JldHVybiBzfSksZnVuY3Rpb24odCxlKXtcInVzZSBzdHJpY3RcIjtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiZGVzYW5kcm8tbWF0Y2hlcy1zZWxlY3Rvci9tYXRjaGVzLXNlbGVjdG9yXCIsZSk6XCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZSgpOnQubWF0Y2hlc1NlbGVjdG9yPWUoKX0od2luZG93LGZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIHQ9ZnVuY3Rpb24oKXt2YXIgdD13aW5kb3cuRWxlbWVudC5wcm90b3R5cGU7aWYodC5tYXRjaGVzKXJldHVyblwibWF0Y2hlc1wiO2lmKHQubWF0Y2hlc1NlbGVjdG9yKXJldHVyblwibWF0Y2hlc1NlbGVjdG9yXCI7Zm9yKHZhciBlPVtcIndlYmtpdFwiLFwibW96XCIsXCJtc1wiLFwib1wiXSxpPTA7aTxlLmxlbmd0aDtpKyspe3ZhciBvPWVbaV0sbj1vK1wiTWF0Y2hlc1NlbGVjdG9yXCI7aWYodFtuXSlyZXR1cm4gbn19KCk7cmV0dXJuIGZ1bmN0aW9uKGUsaSl7cmV0dXJuIGVbdF0oaSl9fSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiZml6enktdWktdXRpbHMvdXRpbHNcIixbXCJkZXNhbmRyby1tYXRjaGVzLXNlbGVjdG9yL21hdGNoZXMtc2VsZWN0b3JcIl0sZnVuY3Rpb24oaSl7cmV0dXJuIGUodCxpKX0pOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUodCxyZXF1aXJlKFwiZGVzYW5kcm8tbWF0Y2hlcy1zZWxlY3RvclwiKSk6dC5maXp6eVVJVXRpbHM9ZSh0LHQubWF0Y2hlc1NlbGVjdG9yKX0od2luZG93LGZ1bmN0aW9uKHQsZSl7dmFyIGk9e307aS5leHRlbmQ9ZnVuY3Rpb24odCxlKXtmb3IodmFyIGkgaW4gZSl0W2ldPWVbaV07cmV0dXJuIHR9LGkubW9kdWxvPWZ1bmN0aW9uKHQsZSl7cmV0dXJuKHQlZStlKSVlfSxpLm1ha2VBcnJheT1mdW5jdGlvbih0KXt2YXIgZT1bXTtpZihBcnJheS5pc0FycmF5KHQpKWU9dDtlbHNlIGlmKHQmJlwib2JqZWN0XCI9PXR5cGVvZiB0JiZcIm51bWJlclwiPT10eXBlb2YgdC5sZW5ndGgpZm9yKHZhciBpPTA7aTx0Lmxlbmd0aDtpKyspZS5wdXNoKHRbaV0pO2Vsc2UgZS5wdXNoKHQpO3JldHVybiBlfSxpLnJlbW92ZUZyb209ZnVuY3Rpb24odCxlKXt2YXIgaT10LmluZGV4T2YoZSk7aSE9LTEmJnQuc3BsaWNlKGksMSl9LGkuZ2V0UGFyZW50PWZ1bmN0aW9uKHQsaSl7Zm9yKDt0LnBhcmVudE5vZGUmJnQhPWRvY3VtZW50LmJvZHk7KWlmKHQ9dC5wYXJlbnROb2RlLGUodCxpKSlyZXR1cm4gdH0saS5nZXRRdWVyeUVsZW1lbnQ9ZnVuY3Rpb24odCl7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIHQ/ZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0KTp0fSxpLmhhbmRsZUV2ZW50PWZ1bmN0aW9uKHQpe3ZhciBlPVwib25cIit0LnR5cGU7dGhpc1tlXSYmdGhpc1tlXSh0KX0saS5maWx0ZXJGaW5kRWxlbWVudHM9ZnVuY3Rpb24odCxvKXt0PWkubWFrZUFycmF5KHQpO3ZhciBuPVtdO3JldHVybiB0LmZvckVhY2goZnVuY3Rpb24odCl7aWYodCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KXtpZighbylyZXR1cm4gdm9pZCBuLnB1c2godCk7ZSh0LG8pJiZuLnB1c2godCk7Zm9yKHZhciBpPXQucXVlcnlTZWxlY3RvckFsbChvKSxzPTA7czxpLmxlbmd0aDtzKyspbi5wdXNoKGlbc10pfX0pLG59LGkuZGVib3VuY2VNZXRob2Q9ZnVuY3Rpb24odCxlLGkpe3ZhciBvPXQucHJvdG90eXBlW2VdLG49ZStcIlRpbWVvdXRcIjt0LnByb3RvdHlwZVtlXT1mdW5jdGlvbigpe3ZhciB0PXRoaXNbbl07dCYmY2xlYXJUaW1lb3V0KHQpO3ZhciBlPWFyZ3VtZW50cyxzPXRoaXM7dGhpc1tuXT1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7by5hcHBseShzLGUpLGRlbGV0ZSBzW25dfSxpfHwxMDApfX0saS5kb2NSZWFkeT1mdW5jdGlvbih0KXt2YXIgZT1kb2N1bWVudC5yZWFkeVN0YXRlO1wiY29tcGxldGVcIj09ZXx8XCJpbnRlcmFjdGl2ZVwiPT1lP3NldFRpbWVvdXQodCk6ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIix0KX0saS50b0Rhc2hlZD1mdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC8oLikoW0EtWl0pL2csZnVuY3Rpb24odCxlLGkpe3JldHVybiBlK1wiLVwiK2l9KS50b0xvd2VyQ2FzZSgpfTt2YXIgbz10LmNvbnNvbGU7cmV0dXJuIGkuaHRtbEluaXQ9ZnVuY3Rpb24oZSxuKXtpLmRvY1JlYWR5KGZ1bmN0aW9uKCl7dmFyIHM9aS50b0Rhc2hlZChuKSxyPVwiZGF0YS1cIitzLGE9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltcIityK1wiXVwiKSx1PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuanMtXCIrcyksaD1pLm1ha2VBcnJheShhKS5jb25jYXQoaS5tYWtlQXJyYXkodSkpLGQ9citcIi1vcHRpb25zXCIsbD10LmpRdWVyeTtoLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGkscz10LmdldEF0dHJpYnV0ZShyKXx8dC5nZXRBdHRyaWJ1dGUoZCk7dHJ5e2k9cyYmSlNPTi5wYXJzZShzKX1jYXRjaChhKXtyZXR1cm4gdm9pZChvJiZvLmVycm9yKFwiRXJyb3IgcGFyc2luZyBcIityK1wiIG9uIFwiK3QuY2xhc3NOYW1lK1wiOiBcIithKSl9dmFyIHU9bmV3IGUodCxpKTtsJiZsLmRhdGEodCxuLHUpfSl9KX0saX0pLGZ1bmN0aW9uKHQsZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShcIm91dGxheWVyL2l0ZW1cIixbXCJldi1lbWl0dGVyL2V2LWVtaXR0ZXJcIixcImdldC1zaXplL2dldC1zaXplXCJdLGUpOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUocmVxdWlyZShcImV2LWVtaXR0ZXJcIikscmVxdWlyZShcImdldC1zaXplXCIpKToodC5PdXRsYXllcj17fSx0Lk91dGxheWVyLkl0ZW09ZSh0LkV2RW1pdHRlcix0LmdldFNpemUpKX0od2luZG93LGZ1bmN0aW9uKHQsZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gaSh0KXtmb3IodmFyIGUgaW4gdClyZXR1cm4hMTtyZXR1cm4gZT1udWxsLCEwfWZ1bmN0aW9uIG8odCxlKXt0JiYodGhpcy5lbGVtZW50PXQsdGhpcy5sYXlvdXQ9ZSx0aGlzLnBvc2l0aW9uPXt4OjAseTowfSx0aGlzLl9jcmVhdGUoKSl9ZnVuY3Rpb24gbih0KXtyZXR1cm4gdC5yZXBsYWNlKC8oW0EtWl0pL2csZnVuY3Rpb24odCl7cmV0dXJuXCItXCIrdC50b0xvd2VyQ2FzZSgpfSl9dmFyIHM9ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLHI9XCJzdHJpbmdcIj09dHlwZW9mIHMudHJhbnNpdGlvbj9cInRyYW5zaXRpb25cIjpcIldlYmtpdFRyYW5zaXRpb25cIixhPVwic3RyaW5nXCI9PXR5cGVvZiBzLnRyYW5zZm9ybT9cInRyYW5zZm9ybVwiOlwiV2Via2l0VHJhbnNmb3JtXCIsdT17V2Via2l0VHJhbnNpdGlvbjpcIndlYmtpdFRyYW5zaXRpb25FbmRcIix0cmFuc2l0aW9uOlwidHJhbnNpdGlvbmVuZFwifVtyXSxoPXt0cmFuc2Zvcm06YSx0cmFuc2l0aW9uOnIsdHJhbnNpdGlvbkR1cmF0aW9uOnIrXCJEdXJhdGlvblwiLHRyYW5zaXRpb25Qcm9wZXJ0eTpyK1wiUHJvcGVydHlcIix0cmFuc2l0aW9uRGVsYXk6citcIkRlbGF5XCJ9LGQ9by5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh0LnByb3RvdHlwZSk7ZC5jb25zdHJ1Y3Rvcj1vLGQuX2NyZWF0ZT1mdW5jdGlvbigpe3RoaXMuX3RyYW5zbj17aW5nUHJvcGVydGllczp7fSxjbGVhbjp7fSxvbkVuZDp7fX0sdGhpcy5jc3Moe3Bvc2l0aW9uOlwiYWJzb2x1dGVcIn0pfSxkLmhhbmRsZUV2ZW50PWZ1bmN0aW9uKHQpe3ZhciBlPVwib25cIit0LnR5cGU7dGhpc1tlXSYmdGhpc1tlXSh0KX0sZC5nZXRTaXplPWZ1bmN0aW9uKCl7dGhpcy5zaXplPWUodGhpcy5lbGVtZW50KX0sZC5jc3M9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5lbGVtZW50LnN0eWxlO2Zvcih2YXIgaSBpbiB0KXt2YXIgbz1oW2ldfHxpO2Vbb109dFtpXX19LGQuZ2V0UG9zaXRpb249ZnVuY3Rpb24oKXt2YXIgdD1nZXRDb21wdXRlZFN0eWxlKHRoaXMuZWxlbWVudCksZT10aGlzLmxheW91dC5fZ2V0T3B0aW9uKFwib3JpZ2luTGVmdFwiKSxpPXRoaXMubGF5b3V0Ll9nZXRPcHRpb24oXCJvcmlnaW5Ub3BcIiksbz10W2U/XCJsZWZ0XCI6XCJyaWdodFwiXSxuPXRbaT9cInRvcFwiOlwiYm90dG9tXCJdLHM9dGhpcy5sYXlvdXQuc2l6ZSxyPW8uaW5kZXhPZihcIiVcIikhPS0xP3BhcnNlRmxvYXQobykvMTAwKnMud2lkdGg6cGFyc2VJbnQobywxMCksYT1uLmluZGV4T2YoXCIlXCIpIT0tMT9wYXJzZUZsb2F0KG4pLzEwMCpzLmhlaWdodDpwYXJzZUludChuLDEwKTtyPWlzTmFOKHIpPzA6cixhPWlzTmFOKGEpPzA6YSxyLT1lP3MucGFkZGluZ0xlZnQ6cy5wYWRkaW5nUmlnaHQsYS09aT9zLnBhZGRpbmdUb3A6cy5wYWRkaW5nQm90dG9tLHRoaXMucG9zaXRpb24ueD1yLHRoaXMucG9zaXRpb24ueT1hfSxkLmxheW91dFBvc2l0aW9uPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5sYXlvdXQuc2l6ZSxlPXt9LGk9dGhpcy5sYXlvdXQuX2dldE9wdGlvbihcIm9yaWdpbkxlZnRcIiksbz10aGlzLmxheW91dC5fZ2V0T3B0aW9uKFwib3JpZ2luVG9wXCIpLG49aT9cInBhZGRpbmdMZWZ0XCI6XCJwYWRkaW5nUmlnaHRcIixzPWk/XCJsZWZ0XCI6XCJyaWdodFwiLHI9aT9cInJpZ2h0XCI6XCJsZWZ0XCIsYT10aGlzLnBvc2l0aW9uLngrdFtuXTtlW3NdPXRoaXMuZ2V0WFZhbHVlKGEpLGVbcl09XCJcIjt2YXIgdT1vP1wicGFkZGluZ1RvcFwiOlwicGFkZGluZ0JvdHRvbVwiLGg9bz9cInRvcFwiOlwiYm90dG9tXCIsZD1vP1wiYm90dG9tXCI6XCJ0b3BcIixsPXRoaXMucG9zaXRpb24ueSt0W3VdO2VbaF09dGhpcy5nZXRZVmFsdWUobCksZVtkXT1cIlwiLHRoaXMuY3NzKGUpLHRoaXMuZW1pdEV2ZW50KFwibGF5b3V0XCIsW3RoaXNdKX0sZC5nZXRYVmFsdWU9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5sYXlvdXQuX2dldE9wdGlvbihcImhvcml6b250YWxcIik7cmV0dXJuIHRoaXMubGF5b3V0Lm9wdGlvbnMucGVyY2VudFBvc2l0aW9uJiYhZT90L3RoaXMubGF5b3V0LnNpemUud2lkdGgqMTAwK1wiJVwiOnQrXCJweFwifSxkLmdldFlWYWx1ZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmxheW91dC5fZ2V0T3B0aW9uKFwiaG9yaXpvbnRhbFwiKTtyZXR1cm4gdGhpcy5sYXlvdXQub3B0aW9ucy5wZXJjZW50UG9zaXRpb24mJmU/dC90aGlzLmxheW91dC5zaXplLmhlaWdodCoxMDArXCIlXCI6dCtcInB4XCJ9LGQuX3RyYW5zaXRpb25Ubz1mdW5jdGlvbih0LGUpe3RoaXMuZ2V0UG9zaXRpb24oKTt2YXIgaT10aGlzLnBvc2l0aW9uLngsbz10aGlzLnBvc2l0aW9uLnksbj1wYXJzZUludCh0LDEwKSxzPXBhcnNlSW50KGUsMTApLHI9bj09PXRoaXMucG9zaXRpb24ueCYmcz09PXRoaXMucG9zaXRpb24ueTtpZih0aGlzLnNldFBvc2l0aW9uKHQsZSksciYmIXRoaXMuaXNUcmFuc2l0aW9uaW5nKXJldHVybiB2b2lkIHRoaXMubGF5b3V0UG9zaXRpb24oKTt2YXIgYT10LWksdT1lLW8saD17fTtoLnRyYW5zZm9ybT10aGlzLmdldFRyYW5zbGF0ZShhLHUpLHRoaXMudHJhbnNpdGlvbih7dG86aCxvblRyYW5zaXRpb25FbmQ6e3RyYW5zZm9ybTp0aGlzLmxheW91dFBvc2l0aW9ufSxpc0NsZWFuaW5nOiEwfSl9LGQuZ2V0VHJhbnNsYXRlPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5sYXlvdXQuX2dldE9wdGlvbihcIm9yaWdpbkxlZnRcIiksbz10aGlzLmxheW91dC5fZ2V0T3B0aW9uKFwib3JpZ2luVG9wXCIpO3JldHVybiB0PWk/dDotdCxlPW8/ZTotZSxcInRyYW5zbGF0ZTNkKFwiK3QrXCJweCwgXCIrZStcInB4LCAwKVwifSxkLmdvVG89ZnVuY3Rpb24odCxlKXt0aGlzLnNldFBvc2l0aW9uKHQsZSksdGhpcy5sYXlvdXRQb3NpdGlvbigpfSxkLm1vdmVUbz1kLl90cmFuc2l0aW9uVG8sZC5zZXRQb3NpdGlvbj1mdW5jdGlvbih0LGUpe3RoaXMucG9zaXRpb24ueD1wYXJzZUludCh0LDEwKSx0aGlzLnBvc2l0aW9uLnk9cGFyc2VJbnQoZSwxMCl9LGQuX25vblRyYW5zaXRpb249ZnVuY3Rpb24odCl7dGhpcy5jc3ModC50byksdC5pc0NsZWFuaW5nJiZ0aGlzLl9yZW1vdmVTdHlsZXModC50byk7Zm9yKHZhciBlIGluIHQub25UcmFuc2l0aW9uRW5kKXQub25UcmFuc2l0aW9uRW5kW2VdLmNhbGwodGhpcyl9LGQudHJhbnNpdGlvbj1mdW5jdGlvbih0KXtpZighcGFyc2VGbG9hdCh0aGlzLmxheW91dC5vcHRpb25zLnRyYW5zaXRpb25EdXJhdGlvbikpcmV0dXJuIHZvaWQgdGhpcy5fbm9uVHJhbnNpdGlvbih0KTt2YXIgZT10aGlzLl90cmFuc247Zm9yKHZhciBpIGluIHQub25UcmFuc2l0aW9uRW5kKWUub25FbmRbaV09dC5vblRyYW5zaXRpb25FbmRbaV07Zm9yKGkgaW4gdC50byllLmluZ1Byb3BlcnRpZXNbaV09ITAsdC5pc0NsZWFuaW5nJiYoZS5jbGVhbltpXT0hMCk7aWYodC5mcm9tKXt0aGlzLmNzcyh0LmZyb20pO3ZhciBvPXRoaXMuZWxlbWVudC5vZmZzZXRIZWlnaHQ7bz1udWxsfXRoaXMuZW5hYmxlVHJhbnNpdGlvbih0LnRvKSx0aGlzLmNzcyh0LnRvKSx0aGlzLmlzVHJhbnNpdGlvbmluZz0hMH07dmFyIGw9XCJvcGFjaXR5LFwiK24oYSk7ZC5lbmFibGVUcmFuc2l0aW9uPWZ1bmN0aW9uKCl7aWYoIXRoaXMuaXNUcmFuc2l0aW9uaW5nKXt2YXIgdD10aGlzLmxheW91dC5vcHRpb25zLnRyYW5zaXRpb25EdXJhdGlvbjt0PVwibnVtYmVyXCI9PXR5cGVvZiB0P3QrXCJtc1wiOnQsdGhpcy5jc3Moe3RyYW5zaXRpb25Qcm9wZXJ0eTpsLHRyYW5zaXRpb25EdXJhdGlvbjp0LHRyYW5zaXRpb25EZWxheTp0aGlzLnN0YWdnZXJEZWxheXx8MH0pLHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKHUsdGhpcywhMSl9fSxkLm9ud2Via2l0VHJhbnNpdGlvbkVuZD1mdW5jdGlvbih0KXt0aGlzLm9udHJhbnNpdGlvbmVuZCh0KX0sZC5vbm90cmFuc2l0aW9uZW5kPWZ1bmN0aW9uKHQpe3RoaXMub250cmFuc2l0aW9uZW5kKHQpfTt2YXIgZj17XCItd2Via2l0LXRyYW5zZm9ybVwiOlwidHJhbnNmb3JtXCJ9O2Qub250cmFuc2l0aW9uZW5kPWZ1bmN0aW9uKHQpe2lmKHQudGFyZ2V0PT09dGhpcy5lbGVtZW50KXt2YXIgZT10aGlzLl90cmFuc24sbz1mW3QucHJvcGVydHlOYW1lXXx8dC5wcm9wZXJ0eU5hbWU7aWYoZGVsZXRlIGUuaW5nUHJvcGVydGllc1tvXSxpKGUuaW5nUHJvcGVydGllcykmJnRoaXMuZGlzYWJsZVRyYW5zaXRpb24oKSxvIGluIGUuY2xlYW4mJih0aGlzLmVsZW1lbnQuc3R5bGVbdC5wcm9wZXJ0eU5hbWVdPVwiXCIsZGVsZXRlIGUuY2xlYW5bb10pLG8gaW4gZS5vbkVuZCl7dmFyIG49ZS5vbkVuZFtvXTtuLmNhbGwodGhpcyksZGVsZXRlIGUub25FbmRbb119dGhpcy5lbWl0RXZlbnQoXCJ0cmFuc2l0aW9uRW5kXCIsW3RoaXNdKX19LGQuZGlzYWJsZVRyYW5zaXRpb249ZnVuY3Rpb24oKXt0aGlzLnJlbW92ZVRyYW5zaXRpb25TdHlsZXMoKSx0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcih1LHRoaXMsITEpLHRoaXMuaXNUcmFuc2l0aW9uaW5nPSExfSxkLl9yZW1vdmVTdHlsZXM9ZnVuY3Rpb24odCl7dmFyIGU9e307Zm9yKHZhciBpIGluIHQpZVtpXT1cIlwiO3RoaXMuY3NzKGUpfTt2YXIgYz17dHJhbnNpdGlvblByb3BlcnR5OlwiXCIsdHJhbnNpdGlvbkR1cmF0aW9uOlwiXCIsdHJhbnNpdGlvbkRlbGF5OlwiXCJ9O3JldHVybiBkLnJlbW92ZVRyYW5zaXRpb25TdHlsZXM9ZnVuY3Rpb24oKXt0aGlzLmNzcyhjKX0sZC5zdGFnZ2VyPWZ1bmN0aW9uKHQpe3Q9aXNOYU4odCk/MDp0LHRoaXMuc3RhZ2dlckRlbGF5PXQrXCJtc1wifSxkLnJlbW92ZUVsZW09ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpLHRoaXMuY3NzKHtkaXNwbGF5OlwiXCJ9KSx0aGlzLmVtaXRFdmVudChcInJlbW92ZVwiLFt0aGlzXSl9LGQucmVtb3ZlPWZ1bmN0aW9uKCl7cmV0dXJuIHImJnBhcnNlRmxvYXQodGhpcy5sYXlvdXQub3B0aW9ucy50cmFuc2l0aW9uRHVyYXRpb24pPyh0aGlzLm9uY2UoXCJ0cmFuc2l0aW9uRW5kXCIsZnVuY3Rpb24oKXt0aGlzLnJlbW92ZUVsZW0oKX0pLHZvaWQgdGhpcy5oaWRlKCkpOnZvaWQgdGhpcy5yZW1vdmVFbGVtKCl9LGQucmV2ZWFsPWZ1bmN0aW9uKCl7ZGVsZXRlIHRoaXMuaXNIaWRkZW4sdGhpcy5jc3Moe2Rpc3BsYXk6XCJcIn0pO3ZhciB0PXRoaXMubGF5b3V0Lm9wdGlvbnMsZT17fSxpPXRoaXMuZ2V0SGlkZVJldmVhbFRyYW5zaXRpb25FbmRQcm9wZXJ0eShcInZpc2libGVTdHlsZVwiKTtlW2ldPXRoaXMub25SZXZlYWxUcmFuc2l0aW9uRW5kLHRoaXMudHJhbnNpdGlvbih7ZnJvbTp0LmhpZGRlblN0eWxlLHRvOnQudmlzaWJsZVN0eWxlLGlzQ2xlYW5pbmc6ITAsb25UcmFuc2l0aW9uRW5kOmV9KX0sZC5vblJldmVhbFRyYW5zaXRpb25FbmQ9ZnVuY3Rpb24oKXt0aGlzLmlzSGlkZGVufHx0aGlzLmVtaXRFdmVudChcInJldmVhbFwiKX0sZC5nZXRIaWRlUmV2ZWFsVHJhbnNpdGlvbkVuZFByb3BlcnR5PWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMubGF5b3V0Lm9wdGlvbnNbdF07aWYoZS5vcGFjaXR5KXJldHVyblwib3BhY2l0eVwiO2Zvcih2YXIgaSBpbiBlKXJldHVybiBpfSxkLmhpZGU9ZnVuY3Rpb24oKXt0aGlzLmlzSGlkZGVuPSEwLHRoaXMuY3NzKHtkaXNwbGF5OlwiXCJ9KTt2YXIgdD10aGlzLmxheW91dC5vcHRpb25zLGU9e30saT10aGlzLmdldEhpZGVSZXZlYWxUcmFuc2l0aW9uRW5kUHJvcGVydHkoXCJoaWRkZW5TdHlsZVwiKTtlW2ldPXRoaXMub25IaWRlVHJhbnNpdGlvbkVuZCx0aGlzLnRyYW5zaXRpb24oe2Zyb206dC52aXNpYmxlU3R5bGUsdG86dC5oaWRkZW5TdHlsZSxpc0NsZWFuaW5nOiEwLG9uVHJhbnNpdGlvbkVuZDplfSl9LGQub25IaWRlVHJhbnNpdGlvbkVuZD1mdW5jdGlvbigpe3RoaXMuaXNIaWRkZW4mJih0aGlzLmNzcyh7ZGlzcGxheTpcIm5vbmVcIn0pLHRoaXMuZW1pdEV2ZW50KFwiaGlkZVwiKSl9LGQuZGVzdHJveT1mdW5jdGlvbigpe3RoaXMuY3NzKHtwb3NpdGlvbjpcIlwiLGxlZnQ6XCJcIixyaWdodDpcIlwiLHRvcDpcIlwiLGJvdHRvbTpcIlwiLHRyYW5zaXRpb246XCJcIix0cmFuc2Zvcm06XCJcIn0pfSxvfSksZnVuY3Rpb24odCxlKXtcInVzZSBzdHJpY3RcIjtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwib3V0bGF5ZXIvb3V0bGF5ZXJcIixbXCJldi1lbWl0dGVyL2V2LWVtaXR0ZXJcIixcImdldC1zaXplL2dldC1zaXplXCIsXCJmaXp6eS11aS11dGlscy91dGlsc1wiLFwiLi9pdGVtXCJdLGZ1bmN0aW9uKGksbyxuLHMpe3JldHVybiBlKHQsaSxvLG4scyl9KTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lKHQscmVxdWlyZShcImV2LWVtaXR0ZXJcIikscmVxdWlyZShcImdldC1zaXplXCIpLHJlcXVpcmUoXCJmaXp6eS11aS11dGlsc1wiKSxyZXF1aXJlKFwiLi9pdGVtXCIpKTp0Lk91dGxheWVyPWUodCx0LkV2RW1pdHRlcix0LmdldFNpemUsdC5maXp6eVVJVXRpbHMsdC5PdXRsYXllci5JdGVtKX0od2luZG93LGZ1bmN0aW9uKHQsZSxpLG8sbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcyh0LGUpe3ZhciBpPW8uZ2V0UXVlcnlFbGVtZW50KHQpO2lmKCFpKXJldHVybiB2b2lkKHUmJnUuZXJyb3IoXCJCYWQgZWxlbWVudCBmb3IgXCIrdGhpcy5jb25zdHJ1Y3Rvci5uYW1lc3BhY2UrXCI6IFwiKyhpfHx0KSkpO3RoaXMuZWxlbWVudD1pLGgmJih0aGlzLiRlbGVtZW50PWgodGhpcy5lbGVtZW50KSksdGhpcy5vcHRpb25zPW8uZXh0ZW5kKHt9LHRoaXMuY29uc3RydWN0b3IuZGVmYXVsdHMpLHRoaXMub3B0aW9uKGUpO3ZhciBuPSsrbDt0aGlzLmVsZW1lbnQub3V0bGF5ZXJHVUlEPW4sZltuXT10aGlzLHRoaXMuX2NyZWF0ZSgpO3ZhciBzPXRoaXMuX2dldE9wdGlvbihcImluaXRMYXlvdXRcIik7cyYmdGhpcy5sYXlvdXQoKX1mdW5jdGlvbiByKHQpe2Z1bmN0aW9uIGUoKXt0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh0LnByb3RvdHlwZSksZS5wcm90b3R5cGUuY29uc3RydWN0b3I9ZSxlfWZ1bmN0aW9uIGEodCl7aWYoXCJudW1iZXJcIj09dHlwZW9mIHQpcmV0dXJuIHQ7dmFyIGU9dC5tYXRjaCgvKF5cXGQqXFwuP1xcZCopKFxcdyopLyksaT1lJiZlWzFdLG89ZSYmZVsyXTtpZighaS5sZW5ndGgpcmV0dXJuIDA7aT1wYXJzZUZsb2F0KGkpO3ZhciBuPW1bb118fDE7cmV0dXJuIGkqbn12YXIgdT10LmNvbnNvbGUsaD10LmpRdWVyeSxkPWZ1bmN0aW9uKCl7fSxsPTAsZj17fTtzLm5hbWVzcGFjZT1cIm91dGxheWVyXCIscy5JdGVtPW4scy5kZWZhdWx0cz17Y29udGFpbmVyU3R5bGU6e3Bvc2l0aW9uOlwicmVsYXRpdmVcIn0saW5pdExheW91dDohMCxvcmlnaW5MZWZ0OiEwLG9yaWdpblRvcDohMCxyZXNpemU6ITAscmVzaXplQ29udGFpbmVyOiEwLHRyYW5zaXRpb25EdXJhdGlvbjpcIjAuNHNcIixoaWRkZW5TdHlsZTp7b3BhY2l0eTowLHRyYW5zZm9ybTpcInNjYWxlKDAuMDAxKVwifSx2aXNpYmxlU3R5bGU6e29wYWNpdHk6MSx0cmFuc2Zvcm06XCJzY2FsZSgxKVwifX07dmFyIGM9cy5wcm90b3R5cGU7by5leHRlbmQoYyxlLnByb3RvdHlwZSksYy5vcHRpb249ZnVuY3Rpb24odCl7by5leHRlbmQodGhpcy5vcHRpb25zLHQpfSxjLl9nZXRPcHRpb249ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5jb25zdHJ1Y3Rvci5jb21wYXRPcHRpb25zW3RdO3JldHVybiBlJiZ2b2lkIDAhPT10aGlzLm9wdGlvbnNbZV0/dGhpcy5vcHRpb25zW2VdOnRoaXMub3B0aW9uc1t0XX0scy5jb21wYXRPcHRpb25zPXtpbml0TGF5b3V0OlwiaXNJbml0TGF5b3V0XCIsaG9yaXpvbnRhbDpcImlzSG9yaXpvbnRhbFwiLGxheW91dEluc3RhbnQ6XCJpc0xheW91dEluc3RhbnRcIixvcmlnaW5MZWZ0OlwiaXNPcmlnaW5MZWZ0XCIsb3JpZ2luVG9wOlwiaXNPcmlnaW5Ub3BcIixyZXNpemU6XCJpc1Jlc2l6ZUJvdW5kXCIscmVzaXplQ29udGFpbmVyOlwiaXNSZXNpemluZ0NvbnRhaW5lclwifSxjLl9jcmVhdGU9ZnVuY3Rpb24oKXt0aGlzLnJlbG9hZEl0ZW1zKCksdGhpcy5zdGFtcHM9W10sdGhpcy5zdGFtcCh0aGlzLm9wdGlvbnMuc3RhbXApLG8uZXh0ZW5kKHRoaXMuZWxlbWVudC5zdHlsZSx0aGlzLm9wdGlvbnMuY29udGFpbmVyU3R5bGUpO3ZhciB0PXRoaXMuX2dldE9wdGlvbihcInJlc2l6ZVwiKTt0JiZ0aGlzLmJpbmRSZXNpemUoKX0sYy5yZWxvYWRJdGVtcz1mdW5jdGlvbigpe3RoaXMuaXRlbXM9dGhpcy5faXRlbWl6ZSh0aGlzLmVsZW1lbnQuY2hpbGRyZW4pfSxjLl9pdGVtaXplPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLl9maWx0ZXJGaW5kSXRlbUVsZW1lbnRzKHQpLGk9dGhpcy5jb25zdHJ1Y3Rvci5JdGVtLG89W10sbj0wO248ZS5sZW5ndGg7bisrKXt2YXIgcz1lW25dLHI9bmV3IGkocyx0aGlzKTtvLnB1c2gocil9cmV0dXJuIG99LGMuX2ZpbHRlckZpbmRJdGVtRWxlbWVudHM9ZnVuY3Rpb24odCl7cmV0dXJuIG8uZmlsdGVyRmluZEVsZW1lbnRzKHQsdGhpcy5vcHRpb25zLml0ZW1TZWxlY3Rvcil9LGMuZ2V0SXRlbUVsZW1lbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXRlbXMubWFwKGZ1bmN0aW9uKHQpe3JldHVybiB0LmVsZW1lbnR9KX0sYy5sYXlvdXQ9ZnVuY3Rpb24oKXt0aGlzLl9yZXNldExheW91dCgpLHRoaXMuX21hbmFnZVN0YW1wcygpO3ZhciB0PXRoaXMuX2dldE9wdGlvbihcImxheW91dEluc3RhbnRcIiksZT12b2lkIDAhPT10P3Q6IXRoaXMuX2lzTGF5b3V0SW5pdGVkO3RoaXMubGF5b3V0SXRlbXModGhpcy5pdGVtcyxlKSx0aGlzLl9pc0xheW91dEluaXRlZD0hMH0sYy5faW5pdD1jLmxheW91dCxjLl9yZXNldExheW91dD1mdW5jdGlvbigpe3RoaXMuZ2V0U2l6ZSgpfSxjLmdldFNpemU9ZnVuY3Rpb24oKXt0aGlzLnNpemU9aSh0aGlzLmVsZW1lbnQpfSxjLl9nZXRNZWFzdXJlbWVudD1mdW5jdGlvbih0LGUpe3ZhciBvLG49dGhpcy5vcHRpb25zW3RdO24/KFwic3RyaW5nXCI9PXR5cGVvZiBuP289dGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3Iobik6biBpbnN0YW5jZW9mIEhUTUxFbGVtZW50JiYobz1uKSx0aGlzW3RdPW8/aShvKVtlXTpuKTp0aGlzW3RdPTB9LGMubGF5b3V0SXRlbXM9ZnVuY3Rpb24odCxlKXt0PXRoaXMuX2dldEl0ZW1zRm9yTGF5b3V0KHQpLHRoaXMuX2xheW91dEl0ZW1zKHQsZSksdGhpcy5fcG9zdExheW91dCgpfSxjLl9nZXRJdGVtc0ZvckxheW91dD1mdW5jdGlvbih0KXtyZXR1cm4gdC5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIXQuaXNJZ25vcmVkfSl9LGMuX2xheW91dEl0ZW1zPWZ1bmN0aW9uKHQsZSl7aWYodGhpcy5fZW1pdENvbXBsZXRlT25JdGVtcyhcImxheW91dFwiLHQpLHQmJnQubGVuZ3RoKXt2YXIgaT1bXTt0LmZvckVhY2goZnVuY3Rpb24odCl7dmFyIG89dGhpcy5fZ2V0SXRlbUxheW91dFBvc2l0aW9uKHQpO28uaXRlbT10LG8uaXNJbnN0YW50PWV8fHQuaXNMYXlvdXRJbnN0YW50LGkucHVzaChvKX0sdGhpcyksdGhpcy5fcHJvY2Vzc0xheW91dFF1ZXVlKGkpfX0sYy5fZ2V0SXRlbUxheW91dFBvc2l0aW9uPWZ1bmN0aW9uKCl7cmV0dXJue3g6MCx5OjB9fSxjLl9wcm9jZXNzTGF5b3V0UXVldWU9ZnVuY3Rpb24odCl7dGhpcy51cGRhdGVTdGFnZ2VyKCksdC5mb3JFYWNoKGZ1bmN0aW9uKHQsZSl7dGhpcy5fcG9zaXRpb25JdGVtKHQuaXRlbSx0LngsdC55LHQuaXNJbnN0YW50LGUpfSx0aGlzKX0sYy51cGRhdGVTdGFnZ2VyPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5vcHRpb25zLnN0YWdnZXI7cmV0dXJuIG51bGw9PT10fHx2b2lkIDA9PT10P3ZvaWQodGhpcy5zdGFnZ2VyPTApOih0aGlzLnN0YWdnZXI9YSh0KSx0aGlzLnN0YWdnZXIpfSxjLl9wb3NpdGlvbkl0ZW09ZnVuY3Rpb24odCxlLGksbyxuKXtvP3QuZ29UbyhlLGkpOih0LnN0YWdnZXIobip0aGlzLnN0YWdnZXIpLHQubW92ZVRvKGUsaSkpfSxjLl9wb3N0TGF5b3V0PWZ1bmN0aW9uKCl7dGhpcy5yZXNpemVDb250YWluZXIoKX0sYy5yZXNpemVDb250YWluZXI9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9nZXRPcHRpb24oXCJyZXNpemVDb250YWluZXJcIik7aWYodCl7dmFyIGU9dGhpcy5fZ2V0Q29udGFpbmVyU2l6ZSgpO2UmJih0aGlzLl9zZXRDb250YWluZXJNZWFzdXJlKGUud2lkdGgsITApLHRoaXMuX3NldENvbnRhaW5lck1lYXN1cmUoZS5oZWlnaHQsITEpKX19LGMuX2dldENvbnRhaW5lclNpemU9ZCxjLl9zZXRDb250YWluZXJNZWFzdXJlPWZ1bmN0aW9uKHQsZSl7aWYodm9pZCAwIT09dCl7dmFyIGk9dGhpcy5zaXplO2kuaXNCb3JkZXJCb3gmJih0Kz1lP2kucGFkZGluZ0xlZnQraS5wYWRkaW5nUmlnaHQraS5ib3JkZXJMZWZ0V2lkdGgraS5ib3JkZXJSaWdodFdpZHRoOmkucGFkZGluZ0JvdHRvbStpLnBhZGRpbmdUb3AraS5ib3JkZXJUb3BXaWR0aCtpLmJvcmRlckJvdHRvbVdpZHRoKSx0PU1hdGgubWF4KHQsMCksdGhpcy5lbGVtZW50LnN0eWxlW2U/XCJ3aWR0aFwiOlwiaGVpZ2h0XCJdPXQrXCJweFwifX0sYy5fZW1pdENvbXBsZXRlT25JdGVtcz1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkoKXtuLmRpc3BhdGNoRXZlbnQodCtcIkNvbXBsZXRlXCIsbnVsbCxbZV0pfWZ1bmN0aW9uIG8oKXtyKysscj09cyYmaSgpfXZhciBuPXRoaXMscz1lLmxlbmd0aDtpZighZXx8IXMpcmV0dXJuIHZvaWQgaSgpO3ZhciByPTA7ZS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2Uub25jZSh0LG8pfSl9LGMuZGlzcGF0Y2hFdmVudD1mdW5jdGlvbih0LGUsaSl7dmFyIG89ZT9bZV0uY29uY2F0KGkpOmk7aWYodGhpcy5lbWl0RXZlbnQodCxvKSxoKWlmKHRoaXMuJGVsZW1lbnQ9dGhpcy4kZWxlbWVudHx8aCh0aGlzLmVsZW1lbnQpLGUpe3ZhciBuPWguRXZlbnQoZSk7bi50eXBlPXQsdGhpcy4kZWxlbWVudC50cmlnZ2VyKG4saSl9ZWxzZSB0aGlzLiRlbGVtZW50LnRyaWdnZXIodCxpKX0sYy5pZ25vcmU9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRJdGVtKHQpO2UmJihlLmlzSWdub3JlZD0hMCl9LGMudW5pZ25vcmU9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRJdGVtKHQpO2UmJmRlbGV0ZSBlLmlzSWdub3JlZH0sYy5zdGFtcD1mdW5jdGlvbih0KXt0PXRoaXMuX2ZpbmQodCksdCYmKHRoaXMuc3RhbXBzPXRoaXMuc3RhbXBzLmNvbmNhdCh0KSx0LmZvckVhY2godGhpcy5pZ25vcmUsdGhpcykpfSxjLnVuc3RhbXA9ZnVuY3Rpb24odCl7dD10aGlzLl9maW5kKHQpLHQmJnQuZm9yRWFjaChmdW5jdGlvbih0KXtvLnJlbW92ZUZyb20odGhpcy5zdGFtcHMsdCksdGhpcy51bmlnbm9yZSh0KX0sdGhpcyl9LGMuX2ZpbmQ9ZnVuY3Rpb24odCl7aWYodClyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgdCYmKHQ9dGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodCkpLHQ9by5tYWtlQXJyYXkodCl9LGMuX21hbmFnZVN0YW1wcz1mdW5jdGlvbigpe3RoaXMuc3RhbXBzJiZ0aGlzLnN0YW1wcy5sZW5ndGgmJih0aGlzLl9nZXRCb3VuZGluZ1JlY3QoKSx0aGlzLnN0YW1wcy5mb3JFYWNoKHRoaXMuX21hbmFnZVN0YW1wLHRoaXMpKX0sYy5fZ2V0Qm91bmRpbmdSZWN0PWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGU9dGhpcy5zaXplO3RoaXMuX2JvdW5kaW5nUmVjdD17bGVmdDp0LmxlZnQrZS5wYWRkaW5nTGVmdCtlLmJvcmRlckxlZnRXaWR0aCx0b3A6dC50b3ArZS5wYWRkaW5nVG9wK2UuYm9yZGVyVG9wV2lkdGgscmlnaHQ6dC5yaWdodC0oZS5wYWRkaW5nUmlnaHQrZS5ib3JkZXJSaWdodFdpZHRoKSxib3R0b206dC5ib3R0b20tKGUucGFkZGluZ0JvdHRvbStlLmJvcmRlckJvdHRvbVdpZHRoKX19LGMuX21hbmFnZVN0YW1wPWQsYy5fZ2V0RWxlbWVudE9mZnNldD1mdW5jdGlvbih0KXt2YXIgZT10LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLG89dGhpcy5fYm91bmRpbmdSZWN0LG49aSh0KSxzPXtsZWZ0OmUubGVmdC1vLmxlZnQtbi5tYXJnaW5MZWZ0LHRvcDplLnRvcC1vLnRvcC1uLm1hcmdpblRvcCxyaWdodDpvLnJpZ2h0LWUucmlnaHQtbi5tYXJnaW5SaWdodCxib3R0b206by5ib3R0b20tZS5ib3R0b20tbi5tYXJnaW5Cb3R0b219O3JldHVybiBzfSxjLmhhbmRsZUV2ZW50PW8uaGFuZGxlRXZlbnQsYy5iaW5kUmVzaXplPWZ1bmN0aW9uKCl7dC5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsdGhpcyksdGhpcy5pc1Jlc2l6ZUJvdW5kPSEwfSxjLnVuYmluZFJlc2l6ZT1mdW5jdGlvbigpe3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLHRoaXMpLHRoaXMuaXNSZXNpemVCb3VuZD0hMX0sYy5vbnJlc2l6ZT1mdW5jdGlvbigpe3RoaXMucmVzaXplKCl9LG8uZGVib3VuY2VNZXRob2QocyxcIm9ucmVzaXplXCIsMTAwKSxjLnJlc2l6ZT1mdW5jdGlvbigpe3RoaXMuaXNSZXNpemVCb3VuZCYmdGhpcy5uZWVkc1Jlc2l6ZUxheW91dCgpJiZ0aGlzLmxheW91dCgpfSxjLm5lZWRzUmVzaXplTGF5b3V0PWZ1bmN0aW9uKCl7dmFyIHQ9aSh0aGlzLmVsZW1lbnQpLGU9dGhpcy5zaXplJiZ0O3JldHVybiBlJiZ0LmlubmVyV2lkdGghPT10aGlzLnNpemUuaW5uZXJXaWR0aH0sYy5hZGRJdGVtcz1mdW5jdGlvbih0KXt2YXIgZT10aGlzLl9pdGVtaXplKHQpO3JldHVybiBlLmxlbmd0aCYmKHRoaXMuaXRlbXM9dGhpcy5pdGVtcy5jb25jYXQoZSkpLGV9LGMuYXBwZW5kZWQ9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5hZGRJdGVtcyh0KTtlLmxlbmd0aCYmKHRoaXMubGF5b3V0SXRlbXMoZSwhMCksdGhpcy5yZXZlYWwoZSkpfSxjLnByZXBlbmRlZD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLl9pdGVtaXplKHQpO2lmKGUubGVuZ3RoKXt2YXIgaT10aGlzLml0ZW1zLnNsaWNlKDApO3RoaXMuaXRlbXM9ZS5jb25jYXQoaSksdGhpcy5fcmVzZXRMYXlvdXQoKSx0aGlzLl9tYW5hZ2VTdGFtcHMoKSx0aGlzLmxheW91dEl0ZW1zKGUsITApLHRoaXMucmV2ZWFsKGUpLHRoaXMubGF5b3V0SXRlbXMoaSl9fSxjLnJldmVhbD1mdW5jdGlvbih0KXtpZih0aGlzLl9lbWl0Q29tcGxldGVPbkl0ZW1zKFwicmV2ZWFsXCIsdCksdCYmdC5sZW5ndGgpe3ZhciBlPXRoaXMudXBkYXRlU3RhZ2dlcigpO3QuZm9yRWFjaChmdW5jdGlvbih0LGkpe3Quc3RhZ2dlcihpKmUpLHQucmV2ZWFsKCl9KX19LGMuaGlkZT1mdW5jdGlvbih0KXtpZih0aGlzLl9lbWl0Q29tcGxldGVPbkl0ZW1zKFwiaGlkZVwiLHQpLHQmJnQubGVuZ3RoKXt2YXIgZT10aGlzLnVwZGF0ZVN0YWdnZXIoKTt0LmZvckVhY2goZnVuY3Rpb24odCxpKXt0LnN0YWdnZXIoaSplKSx0LmhpZGUoKX0pfX0sYy5yZXZlYWxJdGVtRWxlbWVudHM9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRJdGVtcyh0KTt0aGlzLnJldmVhbChlKX0sYy5oaWRlSXRlbUVsZW1lbnRzPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuZ2V0SXRlbXModCk7dGhpcy5oaWRlKGUpfSxjLmdldEl0ZW09ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTA7ZTx0aGlzLml0ZW1zLmxlbmd0aDtlKyspe3ZhciBpPXRoaXMuaXRlbXNbZV07aWYoaS5lbGVtZW50PT10KXJldHVybiBpfX0sYy5nZXRJdGVtcz1mdW5jdGlvbih0KXt0PW8ubWFrZUFycmF5KHQpO3ZhciBlPVtdO3JldHVybiB0LmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGk9dGhpcy5nZXRJdGVtKHQpO2kmJmUucHVzaChpKX0sdGhpcyksZX0sYy5yZW1vdmU9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5nZXRJdGVtcyh0KTt0aGlzLl9lbWl0Q29tcGxldGVPbkl0ZW1zKFwicmVtb3ZlXCIsZSksZSYmZS5sZW5ndGgmJmUuZm9yRWFjaChmdW5jdGlvbih0KXt0LnJlbW92ZSgpLG8ucmVtb3ZlRnJvbSh0aGlzLml0ZW1zLHQpfSx0aGlzKX0sYy5kZXN0cm95PWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5lbGVtZW50LnN0eWxlO3QuaGVpZ2h0PVwiXCIsdC5wb3NpdGlvbj1cIlwiLHQud2lkdGg9XCJcIix0aGlzLml0ZW1zLmZvckVhY2goZnVuY3Rpb24odCl7dC5kZXN0cm95KCl9KSx0aGlzLnVuYmluZFJlc2l6ZSgpO3ZhciBlPXRoaXMuZWxlbWVudC5vdXRsYXllckdVSUQ7ZGVsZXRlIGZbZV0sZGVsZXRlIHRoaXMuZWxlbWVudC5vdXRsYXllckdVSUQsaCYmaC5yZW1vdmVEYXRhKHRoaXMuZWxlbWVudCx0aGlzLmNvbnN0cnVjdG9yLm5hbWVzcGFjZSl9LHMuZGF0YT1mdW5jdGlvbih0KXt0PW8uZ2V0UXVlcnlFbGVtZW50KHQpO3ZhciBlPXQmJnQub3V0bGF5ZXJHVUlEO3JldHVybiBlJiZmW2VdfSxzLmNyZWF0ZT1mdW5jdGlvbih0LGUpe3ZhciBpPXIocyk7cmV0dXJuIGkuZGVmYXVsdHM9by5leHRlbmQoe30scy5kZWZhdWx0cyksby5leHRlbmQoaS5kZWZhdWx0cyxlKSxpLmNvbXBhdE9wdGlvbnM9by5leHRlbmQoe30scy5jb21wYXRPcHRpb25zKSxpLm5hbWVzcGFjZT10LGkuZGF0YT1zLmRhdGEsaS5JdGVtPXIobiksby5odG1sSW5pdChpLHQpLGgmJmguYnJpZGdldCYmaC5icmlkZ2V0KHQsaSksaX07dmFyIG09e21zOjEsczoxZTN9O3JldHVybiBzLkl0ZW09bixzfSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiaXNvdG9wZS1sYXlvdXQvanMvaXRlbVwiLFtcIm91dGxheWVyL291dGxheWVyXCJdLGUpOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUocmVxdWlyZShcIm91dGxheWVyXCIpKToodC5Jc290b3BlPXQuSXNvdG9wZXx8e30sdC5Jc290b3BlLkl0ZW09ZSh0Lk91dGxheWVyKSl9KHdpbmRvdyxmdW5jdGlvbih0KXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBlKCl7dC5JdGVtLmFwcGx5KHRoaXMsYXJndW1lbnRzKX12YXIgaT1lLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHQuSXRlbS5wcm90b3R5cGUpLG89aS5fY3JlYXRlO2kuX2NyZWF0ZT1mdW5jdGlvbigpe3RoaXMuaWQ9dGhpcy5sYXlvdXQuaXRlbUdVSUQrKyxvLmNhbGwodGhpcyksdGhpcy5zb3J0RGF0YT17fX0saS51cGRhdGVTb3J0RGF0YT1mdW5jdGlvbigpe2lmKCF0aGlzLmlzSWdub3JlZCl7dGhpcy5zb3J0RGF0YS5pZD10aGlzLmlkLHRoaXMuc29ydERhdGFbXCJvcmlnaW5hbC1vcmRlclwiXT10aGlzLmlkLHRoaXMuc29ydERhdGEucmFuZG9tPU1hdGgucmFuZG9tKCk7dmFyIHQ9dGhpcy5sYXlvdXQub3B0aW9ucy5nZXRTb3J0RGF0YSxlPXRoaXMubGF5b3V0Ll9zb3J0ZXJzO2Zvcih2YXIgaSBpbiB0KXt2YXIgbz1lW2ldO3RoaXMuc29ydERhdGFbaV09byh0aGlzLmVsZW1lbnQsdGhpcyl9fX07dmFyIG49aS5kZXN0cm95O3JldHVybiBpLmRlc3Ryb3k9ZnVuY3Rpb24oKXtuLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLmNzcyh7ZGlzcGxheTpcIlwifSl9LGV9KSxmdW5jdGlvbih0LGUpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJpc290b3BlLWxheW91dC9qcy9sYXlvdXQtbW9kZVwiLFtcImdldC1zaXplL2dldC1zaXplXCIsXCJvdXRsYXllci9vdXRsYXllclwiXSxlKTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lKHJlcXVpcmUoXCJnZXQtc2l6ZVwiKSxyZXF1aXJlKFwib3V0bGF5ZXJcIikpOih0Lklzb3RvcGU9dC5Jc290b3BlfHx7fSx0Lklzb3RvcGUuTGF5b3V0TW9kZT1lKHQuZ2V0U2l6ZSx0Lk91dGxheWVyKSl9KHdpbmRvdyxmdW5jdGlvbih0LGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGkodCl7dGhpcy5pc290b3BlPXQsdCYmKHRoaXMub3B0aW9ucz10Lm9wdGlvbnNbdGhpcy5uYW1lc3BhY2VdLHRoaXMuZWxlbWVudD10LmVsZW1lbnQsdGhpcy5pdGVtcz10LmZpbHRlcmVkSXRlbXMsdGhpcy5zaXplPXQuc2l6ZSl9dmFyIG89aS5wcm90b3R5cGUsbj1bXCJfcmVzZXRMYXlvdXRcIixcIl9nZXRJdGVtTGF5b3V0UG9zaXRpb25cIixcIl9tYW5hZ2VTdGFtcFwiLFwiX2dldENvbnRhaW5lclNpemVcIixcIl9nZXRFbGVtZW50T2Zmc2V0XCIsXCJuZWVkc1Jlc2l6ZUxheW91dFwiLFwiX2dldE9wdGlvblwiXTtyZXR1cm4gbi5mb3JFYWNoKGZ1bmN0aW9uKHQpe29bdF09ZnVuY3Rpb24oKXtyZXR1cm4gZS5wcm90b3R5cGVbdF0uYXBwbHkodGhpcy5pc290b3BlLGFyZ3VtZW50cyl9fSksby5uZWVkc1ZlcnRpY2FsUmVzaXplTGF5b3V0PWZ1bmN0aW9uKCl7dmFyIGU9dCh0aGlzLmlzb3RvcGUuZWxlbWVudCksaT10aGlzLmlzb3RvcGUuc2l6ZSYmZTtyZXR1cm4gaSYmZS5pbm5lckhlaWdodCE9dGhpcy5pc290b3BlLnNpemUuaW5uZXJIZWlnaHR9LG8uX2dldE1lYXN1cmVtZW50PWZ1bmN0aW9uKCl7dGhpcy5pc290b3BlLl9nZXRNZWFzdXJlbWVudC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LG8uZ2V0Q29sdW1uV2lkdGg9ZnVuY3Rpb24oKXt0aGlzLmdldFNlZ21lbnRTaXplKFwiY29sdW1uXCIsXCJXaWR0aFwiKX0sby5nZXRSb3dIZWlnaHQ9ZnVuY3Rpb24oKXt0aGlzLmdldFNlZ21lbnRTaXplKFwicm93XCIsXCJIZWlnaHRcIil9LG8uZ2V0U2VnbWVudFNpemU9ZnVuY3Rpb24odCxlKXt2YXIgaT10K2Usbz1cIm91dGVyXCIrZTtpZih0aGlzLl9nZXRNZWFzdXJlbWVudChpLG8pLCF0aGlzW2ldKXt2YXIgbj10aGlzLmdldEZpcnN0SXRlbVNpemUoKTt0aGlzW2ldPW4mJm5bb118fHRoaXMuaXNvdG9wZS5zaXplW1wiaW5uZXJcIitlXX19LG8uZ2V0Rmlyc3RJdGVtU2l6ZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuaXNvdG9wZS5maWx0ZXJlZEl0ZW1zWzBdO3JldHVybiBlJiZlLmVsZW1lbnQmJnQoZS5lbGVtZW50KX0sby5sYXlvdXQ9ZnVuY3Rpb24oKXt0aGlzLmlzb3RvcGUubGF5b3V0LmFwcGx5KHRoaXMuaXNvdG9wZSxhcmd1bWVudHMpfSxvLmdldFNpemU9ZnVuY3Rpb24oKXt0aGlzLmlzb3RvcGUuZ2V0U2l6ZSgpLHRoaXMuc2l6ZT10aGlzLmlzb3RvcGUuc2l6ZX0saS5tb2Rlcz17fSxpLmNyZWF0ZT1mdW5jdGlvbih0LGUpe2Z1bmN0aW9uIG4oKXtpLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbi5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShvKSxuLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1uLGUmJihuLm9wdGlvbnM9ZSksbi5wcm90b3R5cGUubmFtZXNwYWNlPXQsaS5tb2Rlc1t0XT1uLG59LGl9KSxmdW5jdGlvbih0LGUpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJtYXNvbnJ5LWxheW91dC9tYXNvbnJ5XCIsW1wib3V0bGF5ZXIvb3V0bGF5ZXJcIixcImdldC1zaXplL2dldC1zaXplXCJdLGUpOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUocmVxdWlyZShcIm91dGxheWVyXCIpLHJlcXVpcmUoXCJnZXQtc2l6ZVwiKSk6dC5NYXNvbnJ5PWUodC5PdXRsYXllcix0LmdldFNpemUpfSh3aW5kb3csZnVuY3Rpb24odCxlKXt2YXIgaT10LmNyZWF0ZShcIm1hc29ucnlcIik7aS5jb21wYXRPcHRpb25zLmZpdFdpZHRoPVwiaXNGaXRXaWR0aFwiO3ZhciBvPWkucHJvdG90eXBlO3JldHVybiBvLl9yZXNldExheW91dD1mdW5jdGlvbigpe3RoaXMuZ2V0U2l6ZSgpLHRoaXMuX2dldE1lYXN1cmVtZW50KFwiY29sdW1uV2lkdGhcIixcIm91dGVyV2lkdGhcIiksdGhpcy5fZ2V0TWVhc3VyZW1lbnQoXCJndXR0ZXJcIixcIm91dGVyV2lkdGhcIiksdGhpcy5tZWFzdXJlQ29sdW1ucygpLHRoaXMuY29sWXM9W107Zm9yKHZhciB0PTA7dDx0aGlzLmNvbHM7dCsrKXRoaXMuY29sWXMucHVzaCgwKTt0aGlzLm1heFk9MCx0aGlzLmhvcml6b250YWxDb2xJbmRleD0wfSxvLm1lYXN1cmVDb2x1bW5zPWZ1bmN0aW9uKCl7aWYodGhpcy5nZXRDb250YWluZXJXaWR0aCgpLCF0aGlzLmNvbHVtbldpZHRoKXt2YXIgdD10aGlzLml0ZW1zWzBdLGk9dCYmdC5lbGVtZW50O3RoaXMuY29sdW1uV2lkdGg9aSYmZShpKS5vdXRlcldpZHRofHx0aGlzLmNvbnRhaW5lcldpZHRofXZhciBvPXRoaXMuY29sdW1uV2lkdGgrPXRoaXMuZ3V0dGVyLG49dGhpcy5jb250YWluZXJXaWR0aCt0aGlzLmd1dHRlcixzPW4vbyxyPW8tbiVvLGE9ciYmcjwxP1wicm91bmRcIjpcImZsb29yXCI7cz1NYXRoW2FdKHMpLHRoaXMuY29scz1NYXRoLm1heChzLDEpfSxvLmdldENvbnRhaW5lcldpZHRoPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZ2V0T3B0aW9uKFwiZml0V2lkdGhcIiksaT10P3RoaXMuZWxlbWVudC5wYXJlbnROb2RlOnRoaXMuZWxlbWVudCxvPWUoaSk7dGhpcy5jb250YWluZXJXaWR0aD1vJiZvLmlubmVyV2lkdGh9LG8uX2dldEl0ZW1MYXlvdXRQb3NpdGlvbj1mdW5jdGlvbih0KXt0LmdldFNpemUoKTt2YXIgZT10LnNpemUub3V0ZXJXaWR0aCV0aGlzLmNvbHVtbldpZHRoLGk9ZSYmZTwxP1wicm91bmRcIjpcImNlaWxcIixvPU1hdGhbaV0odC5zaXplLm91dGVyV2lkdGgvdGhpcy5jb2x1bW5XaWR0aCk7bz1NYXRoLm1pbihvLHRoaXMuY29scyk7Zm9yKHZhciBuPXRoaXMub3B0aW9ucy5ob3Jpem9udGFsT3JkZXI/XCJfZ2V0SG9yaXpvbnRhbENvbFBvc2l0aW9uXCI6XCJfZ2V0VG9wQ29sUG9zaXRpb25cIixzPXRoaXNbbl0obyx0KSxyPXt4OnRoaXMuY29sdW1uV2lkdGgqcy5jb2wseTpzLnl9LGE9cy55K3Quc2l6ZS5vdXRlckhlaWdodCx1PW8rcy5jb2wsaD1zLmNvbDtoPHU7aCsrKXRoaXMuY29sWXNbaF09YTtyZXR1cm4gcn0sby5fZ2V0VG9wQ29sUG9zaXRpb249ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZ2V0VG9wQ29sR3JvdXAodCksaT1NYXRoLm1pbi5hcHBseShNYXRoLGUpO3JldHVybntjb2w6ZS5pbmRleE9mKGkpLHk6aX19LG8uX2dldFRvcENvbEdyb3VwPWZ1bmN0aW9uKHQpe2lmKHQ8MilyZXR1cm4gdGhpcy5jb2xZcztmb3IodmFyIGU9W10saT10aGlzLmNvbHMrMS10LG89MDtvPGk7bysrKWVbb109dGhpcy5fZ2V0Q29sR3JvdXBZKG8sdCk7cmV0dXJuIGV9LG8uX2dldENvbEdyb3VwWT1mdW5jdGlvbih0LGUpe2lmKGU8MilyZXR1cm4gdGhpcy5jb2xZc1t0XTt2YXIgaT10aGlzLmNvbFlzLnNsaWNlKHQsdCtlKTtyZXR1cm4gTWF0aC5tYXguYXBwbHkoTWF0aCxpKX0sby5fZ2V0SG9yaXpvbnRhbENvbFBvc2l0aW9uPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5ob3Jpem9udGFsQ29sSW5kZXgldGhpcy5jb2xzLG89dD4xJiZpK3Q+dGhpcy5jb2xzO2k9bz8wOmk7dmFyIG49ZS5zaXplLm91dGVyV2lkdGgmJmUuc2l6ZS5vdXRlckhlaWdodDtyZXR1cm4gdGhpcy5ob3Jpem9udGFsQ29sSW5kZXg9bj9pK3Q6dGhpcy5ob3Jpem9udGFsQ29sSW5kZXgse2NvbDppLHk6dGhpcy5fZ2V0Q29sR3JvdXBZKGksdCl9fSxvLl9tYW5hZ2VTdGFtcD1mdW5jdGlvbih0KXt2YXIgaT1lKHQpLG89dGhpcy5fZ2V0RWxlbWVudE9mZnNldCh0KSxuPXRoaXMuX2dldE9wdGlvbihcIm9yaWdpbkxlZnRcIikscz1uP28ubGVmdDpvLnJpZ2h0LHI9cytpLm91dGVyV2lkdGgsYT1NYXRoLmZsb29yKHMvdGhpcy5jb2x1bW5XaWR0aCk7YT1NYXRoLm1heCgwLGEpO3ZhciB1PU1hdGguZmxvb3Ioci90aGlzLmNvbHVtbldpZHRoKTt1LT1yJXRoaXMuY29sdW1uV2lkdGg/MDoxLHU9TWF0aC5taW4odGhpcy5jb2xzLTEsdSk7Zm9yKHZhciBoPXRoaXMuX2dldE9wdGlvbihcIm9yaWdpblRvcFwiKSxkPShoP28udG9wOm8uYm90dG9tKStpLm91dGVySGVpZ2h0LGw9YTtsPD11O2wrKyl0aGlzLmNvbFlzW2xdPU1hdGgubWF4KGQsdGhpcy5jb2xZc1tsXSl9LG8uX2dldENvbnRhaW5lclNpemU9ZnVuY3Rpb24oKXt0aGlzLm1heFk9TWF0aC5tYXguYXBwbHkoTWF0aCx0aGlzLmNvbFlzKTt2YXIgdD17aGVpZ2h0OnRoaXMubWF4WX07cmV0dXJuIHRoaXMuX2dldE9wdGlvbihcImZpdFdpZHRoXCIpJiYodC53aWR0aD10aGlzLl9nZXRDb250YWluZXJGaXRXaWR0aCgpKSx0fSxvLl9nZXRDb250YWluZXJGaXRXaWR0aD1mdW5jdGlvbigpe2Zvcih2YXIgdD0wLGU9dGhpcy5jb2xzOy0tZSYmMD09PXRoaXMuY29sWXNbZV07KXQrKztyZXR1cm4odGhpcy5jb2xzLXQpKnRoaXMuY29sdW1uV2lkdGgtdGhpcy5ndXR0ZXJ9LG8ubmVlZHNSZXNpemVMYXlvdXQ9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNvbnRhaW5lcldpZHRoO3JldHVybiB0aGlzLmdldENvbnRhaW5lcldpZHRoKCksdCE9dGhpcy5jb250YWluZXJXaWR0aH0saX0pLGZ1bmN0aW9uKHQsZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShcImlzb3RvcGUtbGF5b3V0L2pzL2xheW91dC1tb2Rlcy9tYXNvbnJ5XCIsW1wiLi4vbGF5b3V0LW1vZGVcIixcIm1hc29ucnktbGF5b3V0L21hc29ucnlcIl0sZSk6XCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZShyZXF1aXJlKFwiLi4vbGF5b3V0LW1vZGVcIikscmVxdWlyZShcIm1hc29ucnktbGF5b3V0XCIpKTplKHQuSXNvdG9wZS5MYXlvdXRNb2RlLHQuTWFzb25yeSl9KHdpbmRvdyxmdW5jdGlvbih0LGUpe1widXNlIHN0cmljdFwiO3ZhciBpPXQuY3JlYXRlKFwibWFzb25yeVwiKSxvPWkucHJvdG90eXBlLG49e19nZXRFbGVtZW50T2Zmc2V0OiEwLGxheW91dDohMCxfZ2V0TWVhc3VyZW1lbnQ6ITB9O2Zvcih2YXIgcyBpbiBlLnByb3RvdHlwZSluW3NdfHwob1tzXT1lLnByb3RvdHlwZVtzXSk7dmFyIHI9by5tZWFzdXJlQ29sdW1ucztvLm1lYXN1cmVDb2x1bW5zPWZ1bmN0aW9uKCl7dGhpcy5pdGVtcz10aGlzLmlzb3RvcGUuZmlsdGVyZWRJdGVtcyxyLmNhbGwodGhpcyl9O3ZhciBhPW8uX2dldE9wdGlvbjtyZXR1cm4gby5fZ2V0T3B0aW9uPWZ1bmN0aW9uKHQpe3JldHVyblwiZml0V2lkdGhcIj09dD92b2lkIDAhPT10aGlzLm9wdGlvbnMuaXNGaXRXaWR0aD90aGlzLm9wdGlvbnMuaXNGaXRXaWR0aDp0aGlzLm9wdGlvbnMuZml0V2lkdGg6YS5hcHBseSh0aGlzLmlzb3RvcGUsYXJndW1lbnRzKX0saX0pLGZ1bmN0aW9uKHQsZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShcImlzb3RvcGUtbGF5b3V0L2pzL2xheW91dC1tb2Rlcy9maXQtcm93c1wiLFtcIi4uL2xheW91dC1tb2RlXCJdLGUpOlwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzP21vZHVsZS5leHBvcnRzPWUocmVxdWlyZShcIi4uL2xheW91dC1tb2RlXCIpKTplKHQuSXNvdG9wZS5MYXlvdXRNb2RlKX0od2luZG93LGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO3ZhciBlPXQuY3JlYXRlKFwiZml0Um93c1wiKSxpPWUucHJvdG90eXBlO3JldHVybiBpLl9yZXNldExheW91dD1mdW5jdGlvbigpe3RoaXMueD0wLHRoaXMueT0wLHRoaXMubWF4WT0wLHRoaXMuX2dldE1lYXN1cmVtZW50KFwiZ3V0dGVyXCIsXCJvdXRlcldpZHRoXCIpfSxpLl9nZXRJdGVtTGF5b3V0UG9zaXRpb249ZnVuY3Rpb24odCl7dC5nZXRTaXplKCk7dmFyIGU9dC5zaXplLm91dGVyV2lkdGgrdGhpcy5ndXR0ZXIsaT10aGlzLmlzb3RvcGUuc2l6ZS5pbm5lcldpZHRoK3RoaXMuZ3V0dGVyOzAhPT10aGlzLngmJmUrdGhpcy54PmkmJih0aGlzLng9MCx0aGlzLnk9dGhpcy5tYXhZKTt2YXIgbz17eDp0aGlzLngseTp0aGlzLnl9O3JldHVybiB0aGlzLm1heFk9TWF0aC5tYXgodGhpcy5tYXhZLHRoaXMueSt0LnNpemUub3V0ZXJIZWlnaHQpLHRoaXMueCs9ZSxvfSxpLl9nZXRDb250YWluZXJTaXplPWZ1bmN0aW9uKCl7cmV0dXJue2hlaWdodDp0aGlzLm1heFl9fSxlfSksZnVuY3Rpb24odCxlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwiaXNvdG9wZS1sYXlvdXQvanMvbGF5b3V0LW1vZGVzL3ZlcnRpY2FsXCIsW1wiLi4vbGF5b3V0LW1vZGVcIl0sZSk6XCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZShyZXF1aXJlKFwiLi4vbGF5b3V0LW1vZGVcIikpOmUodC5Jc290b3BlLkxheW91dE1vZGUpfSh3aW5kb3csZnVuY3Rpb24odCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9dC5jcmVhdGUoXCJ2ZXJ0aWNhbFwiLHtob3Jpem9udGFsQWxpZ25tZW50OjB9KSxpPWUucHJvdG90eXBlO3JldHVybiBpLl9yZXNldExheW91dD1mdW5jdGlvbigpe3RoaXMueT0wfSxpLl9nZXRJdGVtTGF5b3V0UG9zaXRpb249ZnVuY3Rpb24odCl7dC5nZXRTaXplKCk7dmFyIGU9KHRoaXMuaXNvdG9wZS5zaXplLmlubmVyV2lkdGgtdC5zaXplLm91dGVyV2lkdGgpKnRoaXMub3B0aW9ucy5ob3Jpem9udGFsQWxpZ25tZW50LGk9dGhpcy55O3JldHVybiB0aGlzLnkrPXQuc2l6ZS5vdXRlckhlaWdodCx7eDplLHk6aX19LGkuX2dldENvbnRhaW5lclNpemU9ZnVuY3Rpb24oKXtyZXR1cm57aGVpZ2h0OnRoaXMueX19LGV9KSxmdW5jdGlvbih0LGUpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoW1wib3V0bGF5ZXIvb3V0bGF5ZXJcIixcImdldC1zaXplL2dldC1zaXplXCIsXCJkZXNhbmRyby1tYXRjaGVzLXNlbGVjdG9yL21hdGNoZXMtc2VsZWN0b3JcIixcImZpenp5LXVpLXV0aWxzL3V0aWxzXCIsXCJpc290b3BlLWxheW91dC9qcy9pdGVtXCIsXCJpc290b3BlLWxheW91dC9qcy9sYXlvdXQtbW9kZVwiLFwiaXNvdG9wZS1sYXlvdXQvanMvbGF5b3V0LW1vZGVzL21hc29ucnlcIixcImlzb3RvcGUtbGF5b3V0L2pzL2xheW91dC1tb2Rlcy9maXQtcm93c1wiLFwiaXNvdG9wZS1sYXlvdXQvanMvbGF5b3V0LW1vZGVzL3ZlcnRpY2FsXCJdLGZ1bmN0aW9uKGksbyxuLHMscixhKXtyZXR1cm4gZSh0LGksbyxuLHMscixhKX0pOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWUodCxyZXF1aXJlKFwib3V0bGF5ZXJcIikscmVxdWlyZShcImdldC1zaXplXCIpLHJlcXVpcmUoXCJkZXNhbmRyby1tYXRjaGVzLXNlbGVjdG9yXCIpLHJlcXVpcmUoXCJmaXp6eS11aS11dGlsc1wiKSxyZXF1aXJlKFwiaXNvdG9wZS1sYXlvdXQvanMvaXRlbVwiKSxyZXF1aXJlKFwiaXNvdG9wZS1sYXlvdXQvanMvbGF5b3V0LW1vZGVcIikscmVxdWlyZShcImlzb3RvcGUtbGF5b3V0L2pzL2xheW91dC1tb2Rlcy9tYXNvbnJ5XCIpLHJlcXVpcmUoXCJpc290b3BlLWxheW91dC9qcy9sYXlvdXQtbW9kZXMvZml0LXJvd3NcIikscmVxdWlyZShcImlzb3RvcGUtbGF5b3V0L2pzL2xheW91dC1tb2Rlcy92ZXJ0aWNhbFwiKSk6dC5Jc290b3BlPWUodCx0Lk91dGxheWVyLHQuZ2V0U2l6ZSx0Lm1hdGNoZXNTZWxlY3Rvcix0LmZpenp5VUlVdGlscyx0Lklzb3RvcGUuSXRlbSx0Lklzb3RvcGUuTGF5b3V0TW9kZSl9KHdpbmRvdyxmdW5jdGlvbih0LGUsaSxvLG4scyxyKXtmdW5jdGlvbiBhKHQsZSl7cmV0dXJuIGZ1bmN0aW9uKGksbyl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciBzPXRbbl0scj1pLnNvcnREYXRhW3NdLGE9by5zb3J0RGF0YVtzXTtpZihyPmF8fHI8YSl7dmFyIHU9dm9pZCAwIT09ZVtzXT9lW3NdOmUsaD11PzE6LTE7cmV0dXJuKHI+YT8xOi0xKSpofX1yZXR1cm4gMH19dmFyIHU9dC5qUXVlcnksaD1TdHJpbmcucHJvdG90eXBlLnRyaW0/ZnVuY3Rpb24odCl7cmV0dXJuIHQudHJpbSgpfTpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLFwiXCIpfSxkPWUuY3JlYXRlKFwiaXNvdG9wZVwiLHtsYXlvdXRNb2RlOlwibWFzb25yeVwiLGlzSlF1ZXJ5RmlsdGVyaW5nOiEwLHNvcnRBc2NlbmRpbmc6ITB9KTtkLkl0ZW09cyxkLkxheW91dE1vZGU9cjt2YXIgbD1kLnByb3RvdHlwZTtsLl9jcmVhdGU9ZnVuY3Rpb24oKXt0aGlzLml0ZW1HVUlEPTAsdGhpcy5fc29ydGVycz17fSx0aGlzLl9nZXRTb3J0ZXJzKCksZS5wcm90b3R5cGUuX2NyZWF0ZS5jYWxsKHRoaXMpLHRoaXMubW9kZXM9e30sdGhpcy5maWx0ZXJlZEl0ZW1zPXRoaXMuaXRlbXMsdGhpcy5zb3J0SGlzdG9yeT1bXCJvcmlnaW5hbC1vcmRlclwiXTtmb3IodmFyIHQgaW4gci5tb2Rlcyl0aGlzLl9pbml0TGF5b3V0TW9kZSh0KX0sbC5yZWxvYWRJdGVtcz1mdW5jdGlvbigpe3RoaXMuaXRlbUdVSUQ9MCxlLnByb3RvdHlwZS5yZWxvYWRJdGVtcy5jYWxsKHRoaXMpfSxsLl9pdGVtaXplPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PWUucHJvdG90eXBlLl9pdGVtaXplLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxpPTA7aTx0Lmxlbmd0aDtpKyspe3ZhciBvPXRbaV07by5pZD10aGlzLml0ZW1HVUlEKyt9cmV0dXJuIHRoaXMuX3VwZGF0ZUl0ZW1zU29ydERhdGEodCksdH0sbC5faW5pdExheW91dE1vZGU9ZnVuY3Rpb24odCl7dmFyIGU9ci5tb2Rlc1t0XSxpPXRoaXMub3B0aW9uc1t0XXx8e307dGhpcy5vcHRpb25zW3RdPWUub3B0aW9ucz9uLmV4dGVuZChlLm9wdGlvbnMsaSk6aSx0aGlzLm1vZGVzW3RdPW5ldyBlKHRoaXMpfSxsLmxheW91dD1mdW5jdGlvbigpe3JldHVybiF0aGlzLl9pc0xheW91dEluaXRlZCYmdGhpcy5fZ2V0T3B0aW9uKFwiaW5pdExheW91dFwiKT92b2lkIHRoaXMuYXJyYW5nZSgpOnZvaWQgdGhpcy5fbGF5b3V0KCl9LGwuX2xheW91dD1mdW5jdGlvbigpe3ZhciB0PXRoaXMuX2dldElzSW5zdGFudCgpO3RoaXMuX3Jlc2V0TGF5b3V0KCksdGhpcy5fbWFuYWdlU3RhbXBzKCksdGhpcy5sYXlvdXRJdGVtcyh0aGlzLmZpbHRlcmVkSXRlbXMsdCksdGhpcy5faXNMYXlvdXRJbml0ZWQ9ITB9LGwuYXJyYW5nZT1mdW5jdGlvbih0KXt0aGlzLm9wdGlvbih0KSx0aGlzLl9nZXRJc0luc3RhbnQoKTt2YXIgZT10aGlzLl9maWx0ZXIodGhpcy5pdGVtcyk7dGhpcy5maWx0ZXJlZEl0ZW1zPWUubWF0Y2hlcyx0aGlzLl9iaW5kQXJyYW5nZUNvbXBsZXRlKCksdGhpcy5faXNJbnN0YW50P3RoaXMuX25vVHJhbnNpdGlvbih0aGlzLl9oaWRlUmV2ZWFsLFtlXSk6dGhpcy5faGlkZVJldmVhbChlKSx0aGlzLl9zb3J0KCksdGhpcy5fbGF5b3V0KCl9LGwuX2luaXQ9bC5hcnJhbmdlLGwuX2hpZGVSZXZlYWw9ZnVuY3Rpb24odCl7dGhpcy5yZXZlYWwodC5uZWVkUmV2ZWFsKSx0aGlzLmhpZGUodC5uZWVkSGlkZSl9LGwuX2dldElzSW5zdGFudD1mdW5jdGlvbigpe3ZhciB0PXRoaXMuX2dldE9wdGlvbihcImxheW91dEluc3RhbnRcIiksZT12b2lkIDAhPT10P3Q6IXRoaXMuX2lzTGF5b3V0SW5pdGVkO3JldHVybiB0aGlzLl9pc0luc3RhbnQ9ZSxlfSxsLl9iaW5kQXJyYW5nZUNvbXBsZXRlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe2UmJmkmJm8mJm4uZGlzcGF0Y2hFdmVudChcImFycmFuZ2VDb21wbGV0ZVwiLG51bGwsW24uZmlsdGVyZWRJdGVtc10pfXZhciBlLGksbyxuPXRoaXM7dGhpcy5vbmNlKFwibGF5b3V0Q29tcGxldGVcIixmdW5jdGlvbigpe2U9ITAsdCgpfSksdGhpcy5vbmNlKFwiaGlkZUNvbXBsZXRlXCIsZnVuY3Rpb24oKXtpPSEwLHQoKX0pLHRoaXMub25jZShcInJldmVhbENvbXBsZXRlXCIsZnVuY3Rpb24oKXtvPSEwLHQoKX0pfSxsLl9maWx0ZXI9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5vcHRpb25zLmZpbHRlcjtlPWV8fFwiKlwiO2Zvcih2YXIgaT1bXSxvPVtdLG49W10scz10aGlzLl9nZXRGaWx0ZXJUZXN0KGUpLHI9MDtyPHQubGVuZ3RoO3IrKyl7dmFyIGE9dFtyXTtpZighYS5pc0lnbm9yZWQpe3ZhciB1PXMoYSk7dSYmaS5wdXNoKGEpLHUmJmEuaXNIaWRkZW4/by5wdXNoKGEpOnV8fGEuaXNIaWRkZW58fG4ucHVzaChhKX19cmV0dXJue21hdGNoZXM6aSxuZWVkUmV2ZWFsOm8sbmVlZEhpZGU6bn19LGwuX2dldEZpbHRlclRlc3Q9ZnVuY3Rpb24odCl7XG5yZXR1cm4gdSYmdGhpcy5vcHRpb25zLmlzSlF1ZXJ5RmlsdGVyaW5nP2Z1bmN0aW9uKGUpe3JldHVybiB1KGUuZWxlbWVudCkuaXModCl9OlwiZnVuY3Rpb25cIj09dHlwZW9mIHQ/ZnVuY3Rpb24oZSl7cmV0dXJuIHQoZS5lbGVtZW50KX06ZnVuY3Rpb24oZSl7cmV0dXJuIG8oZS5lbGVtZW50LHQpfX0sbC51cGRhdGVTb3J0RGF0YT1mdW5jdGlvbih0KXt2YXIgZTt0Pyh0PW4ubWFrZUFycmF5KHQpLGU9dGhpcy5nZXRJdGVtcyh0KSk6ZT10aGlzLml0ZW1zLHRoaXMuX2dldFNvcnRlcnMoKSx0aGlzLl91cGRhdGVJdGVtc1NvcnREYXRhKGUpfSxsLl9nZXRTb3J0ZXJzPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5vcHRpb25zLmdldFNvcnREYXRhO2Zvcih2YXIgZSBpbiB0KXt2YXIgaT10W2VdO3RoaXMuX3NvcnRlcnNbZV09ZihpKX19LGwuX3VwZGF0ZUl0ZW1zU29ydERhdGE9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXQmJnQubGVuZ3RoLGk9MDtlJiZpPGU7aSsrKXt2YXIgbz10W2ldO28udXBkYXRlU29ydERhdGEoKX19O3ZhciBmPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtpZihcInN0cmluZ1wiIT10eXBlb2YgdClyZXR1cm4gdDt2YXIgaT1oKHQpLnNwbGl0KFwiIFwiKSxvPWlbMF0sbj1vLm1hdGNoKC9eXFxbKC4rKVxcXSQvKSxzPW4mJm5bMV0scj1lKHMsbyksYT1kLnNvcnREYXRhUGFyc2Vyc1tpWzFdXTtyZXR1cm4gdD1hP2Z1bmN0aW9uKHQpe3JldHVybiB0JiZhKHIodCkpfTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmcih0KX19ZnVuY3Rpb24gZSh0LGUpe3JldHVybiB0P2Z1bmN0aW9uKGUpe3JldHVybiBlLmdldEF0dHJpYnV0ZSh0KX06ZnVuY3Rpb24odCl7dmFyIGk9dC5xdWVyeVNlbGVjdG9yKGUpO3JldHVybiBpJiZpLnRleHRDb250ZW50fX1yZXR1cm4gdH0oKTtkLnNvcnREYXRhUGFyc2Vycz17cGFyc2VJbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIHBhcnNlSW50KHQsMTApfSxwYXJzZUZsb2F0OmZ1bmN0aW9uKHQpe3JldHVybiBwYXJzZUZsb2F0KHQpfX0sbC5fc29ydD1mdW5jdGlvbigpe2lmKHRoaXMub3B0aW9ucy5zb3J0Qnkpe3ZhciB0PW4ubWFrZUFycmF5KHRoaXMub3B0aW9ucy5zb3J0QnkpO3RoaXMuX2dldElzU2FtZVNvcnRCeSh0KXx8KHRoaXMuc29ydEhpc3Rvcnk9dC5jb25jYXQodGhpcy5zb3J0SGlzdG9yeSkpO3ZhciBlPWEodGhpcy5zb3J0SGlzdG9yeSx0aGlzLm9wdGlvbnMuc29ydEFzY2VuZGluZyk7dGhpcy5maWx0ZXJlZEl0ZW1zLnNvcnQoZSl9fSxsLl9nZXRJc1NhbWVTb3J0Qnk9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTA7ZTx0Lmxlbmd0aDtlKyspaWYodFtlXSE9dGhpcy5zb3J0SGlzdG9yeVtlXSlyZXR1cm4hMTtyZXR1cm4hMH0sbC5fbW9kZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMub3B0aW9ucy5sYXlvdXRNb2RlLGU9dGhpcy5tb2Rlc1t0XTtpZighZSl0aHJvdyBuZXcgRXJyb3IoXCJObyBsYXlvdXQgbW9kZTogXCIrdCk7cmV0dXJuIGUub3B0aW9ucz10aGlzLm9wdGlvbnNbdF0sZX0sbC5fcmVzZXRMYXlvdXQ9ZnVuY3Rpb24oKXtlLnByb3RvdHlwZS5fcmVzZXRMYXlvdXQuY2FsbCh0aGlzKSx0aGlzLl9tb2RlKCkuX3Jlc2V0TGF5b3V0KCl9LGwuX2dldEl0ZW1MYXlvdXRQb3NpdGlvbj1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fbW9kZSgpLl9nZXRJdGVtTGF5b3V0UG9zaXRpb24odCl9LGwuX21hbmFnZVN0YW1wPWZ1bmN0aW9uKHQpe3RoaXMuX21vZGUoKS5fbWFuYWdlU3RhbXAodCl9LGwuX2dldENvbnRhaW5lclNpemU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbW9kZSgpLl9nZXRDb250YWluZXJTaXplKCl9LGwubmVlZHNSZXNpemVMYXlvdXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbW9kZSgpLm5lZWRzUmVzaXplTGF5b3V0KCl9LGwuYXBwZW5kZWQ9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5hZGRJdGVtcyh0KTtpZihlLmxlbmd0aCl7dmFyIGk9dGhpcy5fZmlsdGVyUmV2ZWFsQWRkZWQoZSk7dGhpcy5maWx0ZXJlZEl0ZW1zPXRoaXMuZmlsdGVyZWRJdGVtcy5jb25jYXQoaSl9fSxsLnByZXBlbmRlZD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLl9pdGVtaXplKHQpO2lmKGUubGVuZ3RoKXt0aGlzLl9yZXNldExheW91dCgpLHRoaXMuX21hbmFnZVN0YW1wcygpO3ZhciBpPXRoaXMuX2ZpbHRlclJldmVhbEFkZGVkKGUpO3RoaXMubGF5b3V0SXRlbXModGhpcy5maWx0ZXJlZEl0ZW1zKSx0aGlzLmZpbHRlcmVkSXRlbXM9aS5jb25jYXQodGhpcy5maWx0ZXJlZEl0ZW1zKSx0aGlzLml0ZW1zPWUuY29uY2F0KHRoaXMuaXRlbXMpfX0sbC5fZmlsdGVyUmV2ZWFsQWRkZWQ9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZmlsdGVyKHQpO3JldHVybiB0aGlzLmhpZGUoZS5uZWVkSGlkZSksdGhpcy5yZXZlYWwoZS5tYXRjaGVzKSx0aGlzLmxheW91dEl0ZW1zKGUubWF0Y2hlcywhMCksZS5tYXRjaGVzfSxsLmluc2VydD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmFkZEl0ZW1zKHQpO2lmKGUubGVuZ3RoKXt2YXIgaSxvLG49ZS5sZW5ndGg7Zm9yKGk9MDtpPG47aSsrKW89ZVtpXSx0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoby5lbGVtZW50KTt2YXIgcz10aGlzLl9maWx0ZXIoZSkubWF0Y2hlcztmb3IoaT0wO2k8bjtpKyspZVtpXS5pc0xheW91dEluc3RhbnQ9ITA7Zm9yKHRoaXMuYXJyYW5nZSgpLGk9MDtpPG47aSsrKWRlbGV0ZSBlW2ldLmlzTGF5b3V0SW5zdGFudDt0aGlzLnJldmVhbChzKX19O3ZhciBjPWwucmVtb3ZlO3JldHVybiBsLnJlbW92ZT1mdW5jdGlvbih0KXt0PW4ubWFrZUFycmF5KHQpO3ZhciBlPXRoaXMuZ2V0SXRlbXModCk7Yy5jYWxsKHRoaXMsdCk7Zm9yKHZhciBpPWUmJmUubGVuZ3RoLG89MDtpJiZvPGk7bysrKXt2YXIgcz1lW29dO24ucmVtb3ZlRnJvbSh0aGlzLmZpbHRlcmVkSXRlbXMscyl9fSxsLnNodWZmbGU9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9MDt0PHRoaXMuaXRlbXMubGVuZ3RoO3QrKyl7dmFyIGU9dGhpcy5pdGVtc1t0XTtlLnNvcnREYXRhLnJhbmRvbT1NYXRoLnJhbmRvbSgpfXRoaXMub3B0aW9ucy5zb3J0Qnk9XCJyYW5kb21cIix0aGlzLl9zb3J0KCksdGhpcy5fbGF5b3V0KCl9LGwuX25vVHJhbnNpdGlvbj1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMub3B0aW9ucy50cmFuc2l0aW9uRHVyYXRpb247dGhpcy5vcHRpb25zLnRyYW5zaXRpb25EdXJhdGlvbj0wO3ZhciBvPXQuYXBwbHkodGhpcyxlKTtyZXR1cm4gdGhpcy5vcHRpb25zLnRyYW5zaXRpb25EdXJhdGlvbj1pLG99LGwuZ2V0RmlsdGVyZWRJdGVtRWxlbWVudHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maWx0ZXJlZEl0ZW1zLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdC5lbGVtZW50fSl9LGR9KTsiLCIvKiFcblxuSlNaaXAgdjMuMS41IC0gQSBKYXZhU2NyaXB0IGNsYXNzIGZvciBnZW5lcmF0aW5nIGFuZCByZWFkaW5nIHppcCBmaWxlc1xuPGh0dHA6Ly9zdHVhcnRrLmNvbS9qc3ppcD5cblxuKGMpIDIwMDktMjAxNiBTdHVhcnQgS25pZ2h0bGV5IDxzdHVhcnQgW2F0XSBzdHVhcnRrLmNvbT5cbkR1YWwgbGljZW5jZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIG9yIEdQTHYzLiBTZWUgaHR0cHM6Ly9yYXcuZ2l0aHViLmNvbS9TdHVrL2pzemlwL21hc3Rlci9MSUNFTlNFLm1hcmtkb3duLlxuXG5KU1ppcCB1c2VzIHRoZSBsaWJyYXJ5IHBha28gcmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIDpcbmh0dHBzOi8vZ2l0aHViLmNvbS9ub2RlY2EvcGFrby9ibG9iL21hc3Rlci9MSUNFTlNFXG4qL1xuIWZ1bmN0aW9uKGEpe2lmKFwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcInVuZGVmaW5lZFwiIT10eXBlb2YgbW9kdWxlKW1vZHVsZS5leHBvcnRzPWEoKTtlbHNlIGlmKFwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoW10sYSk7ZWxzZXt2YXIgYjtiPVwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OlwidW5kZWZpbmVkXCIhPXR5cGVvZiBnbG9iYWw/Z2xvYmFsOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBzZWxmP3NlbGY6dGhpcyxiLkpTWmlwPWEoKX19KGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uIGEoYixjLGQpe2Z1bmN0aW9uIGUoZyxoKXtpZighY1tnXSl7aWYoIWJbZ10pe3ZhciBpPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWgmJmkpcmV0dXJuIGkoZywhMCk7aWYoZilyZXR1cm4gZihnLCEwKTt2YXIgaj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2crXCInXCIpO3Rocm93IGouY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixqfXZhciBrPWNbZ109e2V4cG9ydHM6e319O2JbZ11bMF0uY2FsbChrLmV4cG9ydHMsZnVuY3Rpb24oYSl7dmFyIGM9YltnXVsxXVthXTtyZXR1cm4gZShjP2M6YSl9LGssay5leHBvcnRzLGEsYixjLGQpfXJldHVybiBjW2ddLmV4cG9ydHN9Zm9yKHZhciBmPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsZz0wO2c8ZC5sZW5ndGg7ZysrKWUoZFtnXSk7cmV0dXJuIGV9KHsxOltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGQ9YShcIi4vdXRpbHNcIiksZT1hKFwiLi9zdXBwb3J0XCIpLGY9XCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPVwiO2MuZW5jb2RlPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYixjLGUsZyxoLGksaixrPVtdLGw9MCxtPWEubGVuZ3RoLG49bSxvPVwic3RyaW5nXCIhPT1kLmdldFR5cGVPZihhKTtsPGEubGVuZ3RoOyluPW0tbCxvPyhiPWFbbCsrXSxjPWw8bT9hW2wrK106MCxlPWw8bT9hW2wrK106MCk6KGI9YS5jaGFyQ29kZUF0KGwrKyksYz1sPG0/YS5jaGFyQ29kZUF0KGwrKyk6MCxlPWw8bT9hLmNoYXJDb2RlQXQobCsrKTowKSxnPWI+PjIsaD0oMyZiKTw8NHxjPj40LGk9bj4xPygxNSZjKTw8MnxlPj42OjY0LGo9bj4yPzYzJmU6NjQsay5wdXNoKGYuY2hhckF0KGcpK2YuY2hhckF0KGgpK2YuY2hhckF0KGkpK2YuY2hhckF0KGopKTtyZXR1cm4gay5qb2luKFwiXCIpfSxjLmRlY29kZT1mdW5jdGlvbihhKXt2YXIgYixjLGQsZyxoLGksaixrPTAsbD0wLG09XCJkYXRhOlwiO2lmKGEuc3Vic3RyKDAsbS5sZW5ndGgpPT09bSl0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGJhc2U2NCBpbnB1dCwgaXQgbG9va3MgbGlrZSBhIGRhdGEgdXJsLlwiKTthPWEucmVwbGFjZSgvW15BLVphLXowLTlcXCtcXC9cXD1dL2csXCJcIik7dmFyIG49MyphLmxlbmd0aC80O2lmKGEuY2hhckF0KGEubGVuZ3RoLTEpPT09Zi5jaGFyQXQoNjQpJiZuLS0sYS5jaGFyQXQoYS5sZW5ndGgtMik9PT1mLmNoYXJBdCg2NCkmJm4tLSxuJTEhPT0wKXRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYmFzZTY0IGlucHV0LCBiYWQgY29udGVudCBsZW5ndGguXCIpO3ZhciBvO2ZvcihvPWUudWludDhhcnJheT9uZXcgVWludDhBcnJheSgwfG4pOm5ldyBBcnJheSgwfG4pO2s8YS5sZW5ndGg7KWc9Zi5pbmRleE9mKGEuY2hhckF0KGsrKykpLGg9Zi5pbmRleE9mKGEuY2hhckF0KGsrKykpLGk9Zi5pbmRleE9mKGEuY2hhckF0KGsrKykpLGo9Zi5pbmRleE9mKGEuY2hhckF0KGsrKykpLGI9Zzw8MnxoPj40LGM9KDE1JmgpPDw0fGk+PjIsZD0oMyZpKTw8NnxqLG9bbCsrXT1iLDY0IT09aSYmKG9bbCsrXT1jKSw2NCE9PWomJihvW2wrK109ZCk7cmV0dXJuIG99fSx7XCIuL3N1cHBvcnRcIjozMCxcIi4vdXRpbHNcIjozMn1dLDI6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEsYixjLGQsZSl7dGhpcy5jb21wcmVzc2VkU2l6ZT1hLHRoaXMudW5jb21wcmVzc2VkU2l6ZT1iLHRoaXMuY3JjMzI9Yyx0aGlzLmNvbXByZXNzaW9uPWQsdGhpcy5jb21wcmVzc2VkQ29udGVudD1lfXZhciBlPWEoXCIuL2V4dGVybmFsXCIpLGY9YShcIi4vc3RyZWFtL0RhdGFXb3JrZXJcIiksZz1hKFwiLi9zdHJlYW0vRGF0YUxlbmd0aFByb2JlXCIpLGg9YShcIi4vc3RyZWFtL0NyYzMyUHJvYmVcIiksZz1hKFwiLi9zdHJlYW0vRGF0YUxlbmd0aFByb2JlXCIpO2QucHJvdG90eXBlPXtnZXRDb250ZW50V29ya2VyOmZ1bmN0aW9uKCl7dmFyIGE9bmV3IGYoZS5Qcm9taXNlLnJlc29sdmUodGhpcy5jb21wcmVzc2VkQ29udGVudCkpLnBpcGUodGhpcy5jb21wcmVzc2lvbi51bmNvbXByZXNzV29ya2VyKCkpLnBpcGUobmV3IGcoXCJkYXRhX2xlbmd0aFwiKSksYj10aGlzO3JldHVybiBhLm9uKFwiZW5kXCIsZnVuY3Rpb24oKXtpZih0aGlzLnN0cmVhbUluZm8uZGF0YV9sZW5ndGghPT1iLnVuY29tcHJlc3NlZFNpemUpdGhyb3cgbmV3IEVycm9yKFwiQnVnIDogdW5jb21wcmVzc2VkIGRhdGEgc2l6ZSBtaXNtYXRjaFwiKX0pLGF9LGdldENvbXByZXNzZWRXb3JrZXI6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGYoZS5Qcm9taXNlLnJlc29sdmUodGhpcy5jb21wcmVzc2VkQ29udGVudCkpLndpdGhTdHJlYW1JbmZvKFwiY29tcHJlc3NlZFNpemVcIix0aGlzLmNvbXByZXNzZWRTaXplKS53aXRoU3RyZWFtSW5mbyhcInVuY29tcHJlc3NlZFNpemVcIix0aGlzLnVuY29tcHJlc3NlZFNpemUpLndpdGhTdHJlYW1JbmZvKFwiY3JjMzJcIix0aGlzLmNyYzMyKS53aXRoU3RyZWFtSW5mbyhcImNvbXByZXNzaW9uXCIsdGhpcy5jb21wcmVzc2lvbil9fSxkLmNyZWF0ZVdvcmtlckZyb209ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBhLnBpcGUobmV3IGgpLnBpcGUobmV3IGcoXCJ1bmNvbXByZXNzZWRTaXplXCIpKS5waXBlKGIuY29tcHJlc3NXb3JrZXIoYykpLnBpcGUobmV3IGcoXCJjb21wcmVzc2VkU2l6ZVwiKSkud2l0aFN0cmVhbUluZm8oXCJjb21wcmVzc2lvblwiLGIpfSxiLmV4cG9ydHM9ZH0se1wiLi9leHRlcm5hbFwiOjYsXCIuL3N0cmVhbS9DcmMzMlByb2JlXCI6MjUsXCIuL3N0cmVhbS9EYXRhTGVuZ3RoUHJvYmVcIjoyNixcIi4vc3RyZWFtL0RhdGFXb3JrZXJcIjoyN31dLDM6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjt2YXIgZD1hKFwiLi9zdHJlYW0vR2VuZXJpY1dvcmtlclwiKTtjLlNUT1JFPXttYWdpYzpcIlxcMFxcMFwiLGNvbXByZXNzV29ya2VyOmZ1bmN0aW9uKGEpe3JldHVybiBuZXcgZChcIlNUT1JFIGNvbXByZXNzaW9uXCIpfSx1bmNvbXByZXNzV29ya2VyOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBkKFwiU1RPUkUgZGVjb21wcmVzc2lvblwiKX19LGMuREVGTEFURT1hKFwiLi9mbGF0ZVwiKX0se1wiLi9mbGF0ZVwiOjcsXCIuL3N0cmVhbS9HZW5lcmljV29ya2VyXCI6Mjh9XSw0OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZCgpe2Zvcih2YXIgYSxiPVtdLGM9MDtjPDI1NjtjKyspe2E9Yztmb3IodmFyIGQ9MDtkPDg7ZCsrKWE9MSZhPzM5ODgyOTIzODReYT4+PjE6YT4+PjE7YltjXT1hfXJldHVybiBifWZ1bmN0aW9uIGUoYSxiLGMsZCl7dmFyIGU9aCxmPWQrYzthXj0tMTtmb3IodmFyIGc9ZDtnPGY7ZysrKWE9YT4+PjheZVsyNTUmKGFeYltnXSldO3JldHVybiBhXi0xfWZ1bmN0aW9uIGYoYSxiLGMsZCl7dmFyIGU9aCxmPWQrYzthXj0tMTtmb3IodmFyIGc9ZDtnPGY7ZysrKWE9YT4+PjheZVsyNTUmKGFeYi5jaGFyQ29kZUF0KGcpKV07cmV0dXJuIGFeLTF9dmFyIGc9YShcIi4vdXRpbHNcIiksaD1kKCk7Yi5leHBvcnRzPWZ1bmN0aW9uKGEsYil7aWYoXCJ1bmRlZmluZWRcIj09dHlwZW9mIGF8fCFhLmxlbmd0aClyZXR1cm4gMDt2YXIgYz1cInN0cmluZ1wiIT09Zy5nZXRUeXBlT2YoYSk7cmV0dXJuIGM/ZSgwfGIsYSxhLmxlbmd0aCwwKTpmKDB8YixhLGEubGVuZ3RoLDApfX0se1wiLi91dGlsc1wiOjMyfV0sNTpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2MuYmFzZTY0PSExLGMuYmluYXJ5PSExLGMuZGlyPSExLGMuY3JlYXRlRm9sZGVycz0hMCxjLmRhdGU9bnVsbCxjLmNvbXByZXNzaW9uPW51bGwsYy5jb21wcmVzc2lvbk9wdGlvbnM9bnVsbCxjLmNvbW1lbnQ9bnVsbCxjLnVuaXhQZXJtaXNzaW9ucz1udWxsLGMuZG9zUGVybWlzc2lvbnM9bnVsbH0se31dLDY6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjt2YXIgZD1udWxsO2Q9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIFByb21pc2U/UHJvbWlzZTphKFwibGllXCIpLGIuZXhwb3J0cz17UHJvbWlzZTpkfX0se2xpZTo1OH1dLDc6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEsYil7aC5jYWxsKHRoaXMsXCJGbGF0ZVdvcmtlci9cIithKSx0aGlzLl9wYWtvPW51bGwsdGhpcy5fcGFrb0FjdGlvbj1hLHRoaXMuX3Bha29PcHRpb25zPWIsdGhpcy5tZXRhPXt9fXZhciBlPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBVaW50OEFycmF5JiZcInVuZGVmaW5lZFwiIT10eXBlb2YgVWludDE2QXJyYXkmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBVaW50MzJBcnJheSxmPWEoXCJwYWtvXCIpLGc9YShcIi4vdXRpbHNcIiksaD1hKFwiLi9zdHJlYW0vR2VuZXJpY1dvcmtlclwiKSxpPWU/XCJ1aW50OGFycmF5XCI6XCJhcnJheVwiO2MubWFnaWM9XCJcXGJcXDBcIixnLmluaGVyaXRzKGQsaCksZC5wcm90b3R5cGUucHJvY2Vzc0NodW5rPWZ1bmN0aW9uKGEpe3RoaXMubWV0YT1hLm1ldGEsbnVsbD09PXRoaXMuX3Bha28mJnRoaXMuX2NyZWF0ZVBha28oKSx0aGlzLl9wYWtvLnB1c2goZy50cmFuc2Zvcm1UbyhpLGEuZGF0YSksITEpfSxkLnByb3RvdHlwZS5mbHVzaD1mdW5jdGlvbigpe2gucHJvdG90eXBlLmZsdXNoLmNhbGwodGhpcyksbnVsbD09PXRoaXMuX3Bha28mJnRoaXMuX2NyZWF0ZVBha28oKSx0aGlzLl9wYWtvLnB1c2goW10sITApfSxkLnByb3RvdHlwZS5jbGVhblVwPWZ1bmN0aW9uKCl7aC5wcm90b3R5cGUuY2xlYW5VcC5jYWxsKHRoaXMpLHRoaXMuX3Bha289bnVsbH0sZC5wcm90b3R5cGUuX2NyZWF0ZVBha289ZnVuY3Rpb24oKXt0aGlzLl9wYWtvPW5ldyBmW3RoaXMuX3Bha29BY3Rpb25dKHtyYXc6ITAsbGV2ZWw6dGhpcy5fcGFrb09wdGlvbnMubGV2ZWx8fC0xfSk7dmFyIGE9dGhpczt0aGlzLl9wYWtvLm9uRGF0YT1mdW5jdGlvbihiKXthLnB1c2goe2RhdGE6YixtZXRhOmEubWV0YX0pfX0sYy5jb21wcmVzc1dvcmtlcj1mdW5jdGlvbihhKXtyZXR1cm4gbmV3IGQoXCJEZWZsYXRlXCIsYSl9LGMudW5jb21wcmVzc1dvcmtlcj1mdW5jdGlvbigpe3JldHVybiBuZXcgZChcIkluZmxhdGVcIix7fSl9fSx7XCIuL3N0cmVhbS9HZW5lcmljV29ya2VyXCI6MjgsXCIuL3V0aWxzXCI6MzIscGFrbzo1OX1dLDg6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEsYixjLGQpe2YuY2FsbCh0aGlzLFwiWmlwRmlsZVdvcmtlclwiKSx0aGlzLmJ5dGVzV3JpdHRlbj0wLHRoaXMuemlwQ29tbWVudD1iLHRoaXMuemlwUGxhdGZvcm09Yyx0aGlzLmVuY29kZUZpbGVOYW1lPWQsdGhpcy5zdHJlYW1GaWxlcz1hLHRoaXMuYWNjdW11bGF0ZT0hMSx0aGlzLmNvbnRlbnRCdWZmZXI9W10sdGhpcy5kaXJSZWNvcmRzPVtdLHRoaXMuY3VycmVudFNvdXJjZU9mZnNldD0wLHRoaXMuZW50cmllc0NvdW50PTAsdGhpcy5jdXJyZW50RmlsZT1udWxsLHRoaXMuX3NvdXJjZXM9W119dmFyIGU9YShcIi4uL3V0aWxzXCIpLGY9YShcIi4uL3N0cmVhbS9HZW5lcmljV29ya2VyXCIpLGc9YShcIi4uL3V0ZjhcIiksaD1hKFwiLi4vY3JjMzJcIiksaT1hKFwiLi4vc2lnbmF0dXJlXCIpLGo9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPVwiXCI7Zm9yKGM9MDtjPGI7YysrKWQrPVN0cmluZy5mcm9tQ2hhckNvZGUoMjU1JmEpLGE+Pj49ODtyZXR1cm4gZH0saz1mdW5jdGlvbihhLGIpe3ZhciBjPWE7cmV0dXJuIGF8fChjPWI/MTY4OTM6MzMyMDQpLCg2NTUzNSZjKTw8MTZ9LGw9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gNjMmKGF8fDApfSxtPWZ1bmN0aW9uKGEsYixjLGQsZixtKXt2YXIgbixvLHA9YS5maWxlLHE9YS5jb21wcmVzc2lvbixyPW0hPT1nLnV0ZjhlbmNvZGUscz1lLnRyYW5zZm9ybVRvKFwic3RyaW5nXCIsbShwLm5hbWUpKSx0PWUudHJhbnNmb3JtVG8oXCJzdHJpbmdcIixnLnV0ZjhlbmNvZGUocC5uYW1lKSksdT1wLmNvbW1lbnQsdj1lLnRyYW5zZm9ybVRvKFwic3RyaW5nXCIsbSh1KSksdz1lLnRyYW5zZm9ybVRvKFwic3RyaW5nXCIsZy51dGY4ZW5jb2RlKHUpKSx4PXQubGVuZ3RoIT09cC5uYW1lLmxlbmd0aCx5PXcubGVuZ3RoIT09dS5sZW5ndGgsej1cIlwiLEE9XCJcIixCPVwiXCIsQz1wLmRpcixEPXAuZGF0ZSxFPXtjcmMzMjowLGNvbXByZXNzZWRTaXplOjAsdW5jb21wcmVzc2VkU2l6ZTowfTtiJiYhY3x8KEUuY3JjMzI9YS5jcmMzMixFLmNvbXByZXNzZWRTaXplPWEuY29tcHJlc3NlZFNpemUsRS51bmNvbXByZXNzZWRTaXplPWEudW5jb21wcmVzc2VkU2l6ZSk7dmFyIEY9MDtiJiYoRnw9OCkscnx8IXgmJiF5fHwoRnw9MjA0OCk7dmFyIEc9MCxIPTA7QyYmKEd8PTE2KSxcIlVOSVhcIj09PWY/KEg9Nzk4LEd8PWsocC51bml4UGVybWlzc2lvbnMsQykpOihIPTIwLEd8PWwocC5kb3NQZXJtaXNzaW9ucyxDKSksbj1ELmdldFVUQ0hvdXJzKCksbjw8PTYsbnw9RC5nZXRVVENNaW51dGVzKCksbjw8PTUsbnw9RC5nZXRVVENTZWNvbmRzKCkvMixvPUQuZ2V0VVRDRnVsbFllYXIoKS0xOTgwLG88PD00LG98PUQuZ2V0VVRDTW9udGgoKSsxLG88PD01LG98PUQuZ2V0VVRDRGF0ZSgpLHgmJihBPWooMSwxKStqKGgocyksNCkrdCx6Kz1cInVwXCIraihBLmxlbmd0aCwyKStBKSx5JiYoQj1qKDEsMSkraihoKHYpLDQpK3cseis9XCJ1Y1wiK2ooQi5sZW5ndGgsMikrQik7dmFyIEk9XCJcIjtJKz1cIlxcblxcMFwiLEkrPWooRiwyKSxJKz1xLm1hZ2ljLEkrPWoobiwyKSxJKz1qKG8sMiksSSs9aihFLmNyYzMyLDQpLEkrPWooRS5jb21wcmVzc2VkU2l6ZSw0KSxJKz1qKEUudW5jb21wcmVzc2VkU2l6ZSw0KSxJKz1qKHMubGVuZ3RoLDIpLEkrPWooei5sZW5ndGgsMik7dmFyIEo9aS5MT0NBTF9GSUxFX0hFQURFUitJK3MreixLPWkuQ0VOVFJBTF9GSUxFX0hFQURFUitqKEgsMikrSStqKHYubGVuZ3RoLDIpK1wiXFwwXFwwXFwwXFwwXCIraihHLDQpK2ooZCw0KStzK3ordjtyZXR1cm57ZmlsZVJlY29yZDpKLGRpclJlY29yZDpLfX0sbj1mdW5jdGlvbihhLGIsYyxkLGYpe3ZhciBnPVwiXCIsaD1lLnRyYW5zZm9ybVRvKFwic3RyaW5nXCIsZihkKSk7cmV0dXJuIGc9aS5DRU5UUkFMX0RJUkVDVE9SWV9FTkQrXCJcXDBcXDBcXDBcXDBcIitqKGEsMikraihhLDIpK2ooYiw0KStqKGMsNCkraihoLmxlbmd0aCwyKStofSxvPWZ1bmN0aW9uKGEpe3ZhciBiPVwiXCI7cmV0dXJuIGI9aS5EQVRBX0RFU0NSSVBUT1IraihhLmNyYzMyLDQpK2ooYS5jb21wcmVzc2VkU2l6ZSw0KStqKGEudW5jb21wcmVzc2VkU2l6ZSw0KX07ZS5pbmhlcml0cyhkLGYpLGQucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24oYSl7dmFyIGI9YS5tZXRhLnBlcmNlbnR8fDAsYz10aGlzLmVudHJpZXNDb3VudCxkPXRoaXMuX3NvdXJjZXMubGVuZ3RoO3RoaXMuYWNjdW11bGF0ZT90aGlzLmNvbnRlbnRCdWZmZXIucHVzaChhKToodGhpcy5ieXRlc1dyaXR0ZW4rPWEuZGF0YS5sZW5ndGgsZi5wcm90b3R5cGUucHVzaC5jYWxsKHRoaXMse2RhdGE6YS5kYXRhLG1ldGE6e2N1cnJlbnRGaWxlOnRoaXMuY3VycmVudEZpbGUscGVyY2VudDpjPyhiKzEwMCooYy1kLTEpKS9jOjEwMH19KSl9LGQucHJvdG90eXBlLm9wZW5lZFNvdXJjZT1mdW5jdGlvbihhKXt0aGlzLmN1cnJlbnRTb3VyY2VPZmZzZXQ9dGhpcy5ieXRlc1dyaXR0ZW4sdGhpcy5jdXJyZW50RmlsZT1hLmZpbGUubmFtZTt2YXIgYj10aGlzLnN0cmVhbUZpbGVzJiYhYS5maWxlLmRpcjtpZihiKXt2YXIgYz1tKGEsYiwhMSx0aGlzLmN1cnJlbnRTb3VyY2VPZmZzZXQsdGhpcy56aXBQbGF0Zm9ybSx0aGlzLmVuY29kZUZpbGVOYW1lKTt0aGlzLnB1c2goe2RhdGE6Yy5maWxlUmVjb3JkLG1ldGE6e3BlcmNlbnQ6MH19KX1lbHNlIHRoaXMuYWNjdW11bGF0ZT0hMH0sZC5wcm90b3R5cGUuY2xvc2VkU291cmNlPWZ1bmN0aW9uKGEpe3RoaXMuYWNjdW11bGF0ZT0hMTt2YXIgYj10aGlzLnN0cmVhbUZpbGVzJiYhYS5maWxlLmRpcixjPW0oYSxiLCEwLHRoaXMuY3VycmVudFNvdXJjZU9mZnNldCx0aGlzLnppcFBsYXRmb3JtLHRoaXMuZW5jb2RlRmlsZU5hbWUpO2lmKHRoaXMuZGlyUmVjb3Jkcy5wdXNoKGMuZGlyUmVjb3JkKSxiKXRoaXMucHVzaCh7ZGF0YTpvKGEpLG1ldGE6e3BlcmNlbnQ6MTAwfX0pO2Vsc2UgZm9yKHRoaXMucHVzaCh7ZGF0YTpjLmZpbGVSZWNvcmQsbWV0YTp7cGVyY2VudDowfX0pO3RoaXMuY29udGVudEJ1ZmZlci5sZW5ndGg7KXRoaXMucHVzaCh0aGlzLmNvbnRlbnRCdWZmZXIuc2hpZnQoKSk7dGhpcy5jdXJyZW50RmlsZT1udWxsfSxkLnByb3RvdHlwZS5mbHVzaD1mdW5jdGlvbigpe2Zvcih2YXIgYT10aGlzLmJ5dGVzV3JpdHRlbixiPTA7Yjx0aGlzLmRpclJlY29yZHMubGVuZ3RoO2IrKyl0aGlzLnB1c2goe2RhdGE6dGhpcy5kaXJSZWNvcmRzW2JdLG1ldGE6e3BlcmNlbnQ6MTAwfX0pO3ZhciBjPXRoaXMuYnl0ZXNXcml0dGVuLWEsZD1uKHRoaXMuZGlyUmVjb3Jkcy5sZW5ndGgsYyxhLHRoaXMuemlwQ29tbWVudCx0aGlzLmVuY29kZUZpbGVOYW1lKTt0aGlzLnB1c2goe2RhdGE6ZCxtZXRhOntwZXJjZW50OjEwMH19KX0sZC5wcm90b3R5cGUucHJlcGFyZU5leHRTb3VyY2U9ZnVuY3Rpb24oKXt0aGlzLnByZXZpb3VzPXRoaXMuX3NvdXJjZXMuc2hpZnQoKSx0aGlzLm9wZW5lZFNvdXJjZSh0aGlzLnByZXZpb3VzLnN0cmVhbUluZm8pLHRoaXMuaXNQYXVzZWQ/dGhpcy5wcmV2aW91cy5wYXVzZSgpOnRoaXMucHJldmlvdXMucmVzdW1lKCl9LGQucHJvdG90eXBlLnJlZ2lzdGVyUHJldmlvdXM9ZnVuY3Rpb24oYSl7dGhpcy5fc291cmNlcy5wdXNoKGEpO3ZhciBiPXRoaXM7cmV0dXJuIGEub24oXCJkYXRhXCIsZnVuY3Rpb24oYSl7Yi5wcm9jZXNzQ2h1bmsoYSl9KSxhLm9uKFwiZW5kXCIsZnVuY3Rpb24oKXtiLmNsb3NlZFNvdXJjZShiLnByZXZpb3VzLnN0cmVhbUluZm8pLGIuX3NvdXJjZXMubGVuZ3RoP2IucHJlcGFyZU5leHRTb3VyY2UoKTpiLmVuZCgpfSksYS5vbihcImVycm9yXCIsZnVuY3Rpb24oYSl7Yi5lcnJvcihhKX0pLHRoaXN9LGQucHJvdG90eXBlLnJlc3VtZT1mdW5jdGlvbigpe3JldHVybiEhZi5wcm90b3R5cGUucmVzdW1lLmNhbGwodGhpcykmJighdGhpcy5wcmV2aW91cyYmdGhpcy5fc291cmNlcy5sZW5ndGg/KHRoaXMucHJlcGFyZU5leHRTb3VyY2UoKSwhMCk6dGhpcy5wcmV2aW91c3x8dGhpcy5fc291cmNlcy5sZW5ndGh8fHRoaXMuZ2VuZXJhdGVkRXJyb3I/dm9pZCAwOih0aGlzLmVuZCgpLCEwKSl9LGQucHJvdG90eXBlLmVycm9yPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuX3NvdXJjZXM7aWYoIWYucHJvdG90eXBlLmVycm9yLmNhbGwodGhpcyxhKSlyZXR1cm4hMTtmb3IodmFyIGM9MDtjPGIubGVuZ3RoO2MrKyl0cnl7YltjXS5lcnJvcihhKX1jYXRjaChhKXt9cmV0dXJuITB9LGQucHJvdG90eXBlLmxvY2s9ZnVuY3Rpb24oKXtmLnByb3RvdHlwZS5sb2NrLmNhbGwodGhpcyk7Zm9yKHZhciBhPXRoaXMuX3NvdXJjZXMsYj0wO2I8YS5sZW5ndGg7YisrKWFbYl0ubG9jaygpfSxiLmV4cG9ydHM9ZH0se1wiLi4vY3JjMzJcIjo0LFwiLi4vc2lnbmF0dXJlXCI6MjMsXCIuLi9zdHJlYW0vR2VuZXJpY1dvcmtlclwiOjI4LFwiLi4vdXRmOFwiOjMxLFwiLi4vdXRpbHNcIjozMn1dLDk6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjt2YXIgZD1hKFwiLi4vY29tcHJlc3Npb25zXCIpLGU9YShcIi4vWmlwRmlsZVdvcmtlclwiKSxmPWZ1bmN0aW9uKGEsYil7dmFyIGM9YXx8YixlPWRbY107aWYoIWUpdGhyb3cgbmV3IEVycm9yKGMrXCIgaXMgbm90IGEgdmFsaWQgY29tcHJlc3Npb24gbWV0aG9kICFcIik7cmV0dXJuIGV9O2MuZ2VuZXJhdGVXb3JrZXI9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPW5ldyBlKGIuc3RyZWFtRmlsZXMsYyxiLnBsYXRmb3JtLGIuZW5jb2RlRmlsZU5hbWUpLGc9MDt0cnl7YS5mb3JFYWNoKGZ1bmN0aW9uKGEsYyl7ZysrO3ZhciBlPWYoYy5vcHRpb25zLmNvbXByZXNzaW9uLGIuY29tcHJlc3Npb24pLGg9Yy5vcHRpb25zLmNvbXByZXNzaW9uT3B0aW9uc3x8Yi5jb21wcmVzc2lvbk9wdGlvbnN8fHt9LGk9Yy5kaXIsaj1jLmRhdGU7Yy5fY29tcHJlc3NXb3JrZXIoZSxoKS53aXRoU3RyZWFtSW5mbyhcImZpbGVcIix7bmFtZTphLGRpcjppLGRhdGU6aixjb21tZW50OmMuY29tbWVudHx8XCJcIix1bml4UGVybWlzc2lvbnM6Yy51bml4UGVybWlzc2lvbnMsZG9zUGVybWlzc2lvbnM6Yy5kb3NQZXJtaXNzaW9uc30pLnBpcGUoZCl9KSxkLmVudHJpZXNDb3VudD1nfWNhdGNoKGgpe2QuZXJyb3IoaCl9cmV0dXJuIGR9fSx7XCIuLi9jb21wcmVzc2lvbnNcIjozLFwiLi9aaXBGaWxlV29ya2VyXCI6OH1dLDEwOltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZCgpe2lmKCEodGhpcyBpbnN0YW5jZW9mIGQpKXJldHVybiBuZXcgZDtpZihhcmd1bWVudHMubGVuZ3RoKXRocm93IG5ldyBFcnJvcihcIlRoZSBjb25zdHJ1Y3RvciB3aXRoIHBhcmFtZXRlcnMgaGFzIGJlZW4gcmVtb3ZlZCBpbiBKU1ppcCAzLjAsIHBsZWFzZSBjaGVjayB0aGUgdXBncmFkZSBndWlkZS5cIik7dGhpcy5maWxlcz17fSx0aGlzLmNvbW1lbnQ9bnVsbCx0aGlzLnJvb3Q9XCJcIix0aGlzLmNsb25lPWZ1bmN0aW9uKCl7dmFyIGE9bmV3IGQ7Zm9yKHZhciBiIGluIHRoaXMpXCJmdW5jdGlvblwiIT10eXBlb2YgdGhpc1tiXSYmKGFbYl09dGhpc1tiXSk7cmV0dXJuIGF9fWQucHJvdG90eXBlPWEoXCIuL29iamVjdFwiKSxkLnByb3RvdHlwZS5sb2FkQXN5bmM9YShcIi4vbG9hZFwiKSxkLnN1cHBvcnQ9YShcIi4vc3VwcG9ydFwiKSxkLmRlZmF1bHRzPWEoXCIuL2RlZmF1bHRzXCIpLGQudmVyc2lvbj1cIjMuMS41XCIsZC5sb2FkQXN5bmM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4obmV3IGQpLmxvYWRBc3luYyhhLGIpfSxkLmV4dGVybmFsPWEoXCIuL2V4dGVybmFsXCIpLGIuZXhwb3J0cz1kfSx7XCIuL2RlZmF1bHRzXCI6NSxcIi4vZXh0ZXJuYWxcIjo2LFwiLi9sb2FkXCI6MTEsXCIuL29iamVjdFwiOjE1LFwiLi9zdXBwb3J0XCI6MzB9XSwxMTpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGQoYSl7cmV0dXJuIG5ldyBmLlByb21pc2UoZnVuY3Rpb24oYixjKXt2YXIgZD1hLmRlY29tcHJlc3NlZC5nZXRDb250ZW50V29ya2VyKCkucGlwZShuZXcgaSk7ZC5vbihcImVycm9yXCIsZnVuY3Rpb24oYSl7YyhhKX0pLm9uKFwiZW5kXCIsZnVuY3Rpb24oKXtkLnN0cmVhbUluZm8uY3JjMzIhPT1hLmRlY29tcHJlc3NlZC5jcmMzMj9jKG5ldyBFcnJvcihcIkNvcnJ1cHRlZCB6aXAgOiBDUkMzMiBtaXNtYXRjaFwiKSk6YigpfSkucmVzdW1lKCl9KX12YXIgZT1hKFwiLi91dGlsc1wiKSxmPWEoXCIuL2V4dGVybmFsXCIpLGc9YShcIi4vdXRmOFwiKSxlPWEoXCIuL3V0aWxzXCIpLGg9YShcIi4vemlwRW50cmllc1wiKSxpPWEoXCIuL3N0cmVhbS9DcmMzMlByb2JlXCIpLGo9YShcIi4vbm9kZWpzVXRpbHNcIik7Yi5leHBvcnRzPWZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpcztyZXR1cm4gYj1lLmV4dGVuZChifHx7fSx7YmFzZTY0OiExLGNoZWNrQ1JDMzI6ITEsb3B0aW1pemVkQmluYXJ5U3RyaW5nOiExLGNyZWF0ZUZvbGRlcnM6ITEsZGVjb2RlRmlsZU5hbWU6Zy51dGY4ZGVjb2RlfSksai5pc05vZGUmJmouaXNTdHJlYW0oYSk/Zi5Qcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJKU1ppcCBjYW4ndCBhY2NlcHQgYSBzdHJlYW0gd2hlbiBsb2FkaW5nIGEgemlwIGZpbGUuXCIpKTplLnByZXBhcmVDb250ZW50KFwidGhlIGxvYWRlZCB6aXAgZmlsZVwiLGEsITAsYi5vcHRpbWl6ZWRCaW5hcnlTdHJpbmcsYi5iYXNlNjQpLnRoZW4oZnVuY3Rpb24oYSl7dmFyIGM9bmV3IGgoYik7cmV0dXJuIGMubG9hZChhKSxjfSkudGhlbihmdW5jdGlvbihhKXt2YXIgYz1bZi5Qcm9taXNlLnJlc29sdmUoYSldLGU9YS5maWxlcztpZihiLmNoZWNrQ1JDMzIpZm9yKHZhciBnPTA7ZzxlLmxlbmd0aDtnKyspYy5wdXNoKGQoZVtnXSkpO3JldHVybiBmLlByb21pc2UuYWxsKGMpfSkudGhlbihmdW5jdGlvbihhKXtmb3IodmFyIGQ9YS5zaGlmdCgpLGU9ZC5maWxlcyxmPTA7ZjxlLmxlbmd0aDtmKyspe3ZhciBnPWVbZl07Yy5maWxlKGcuZmlsZU5hbWVTdHIsZy5kZWNvbXByZXNzZWQse2JpbmFyeTohMCxvcHRpbWl6ZWRCaW5hcnlTdHJpbmc6ITAsZGF0ZTpnLmRhdGUsZGlyOmcuZGlyLGNvbW1lbnQ6Zy5maWxlQ29tbWVudFN0ci5sZW5ndGg/Zy5maWxlQ29tbWVudFN0cjpudWxsLHVuaXhQZXJtaXNzaW9uczpnLnVuaXhQZXJtaXNzaW9ucyxkb3NQZXJtaXNzaW9uczpnLmRvc1Blcm1pc3Npb25zLGNyZWF0ZUZvbGRlcnM6Yi5jcmVhdGVGb2xkZXJzfSl9cmV0dXJuIGQuemlwQ29tbWVudC5sZW5ndGgmJihjLmNvbW1lbnQ9ZC56aXBDb21tZW50KSxjfSl9fSx7XCIuL2V4dGVybmFsXCI6NixcIi4vbm9kZWpzVXRpbHNcIjoxNCxcIi4vc3RyZWFtL0NyYzMyUHJvYmVcIjoyNSxcIi4vdXRmOFwiOjMxLFwiLi91dGlsc1wiOjMyLFwiLi96aXBFbnRyaWVzXCI6MzN9XSwxMjpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGQoYSxiKXtmLmNhbGwodGhpcyxcIk5vZGVqcyBzdHJlYW0gaW5wdXQgYWRhcHRlciBmb3IgXCIrYSksdGhpcy5fdXBzdHJlYW1FbmRlZD0hMSx0aGlzLl9iaW5kU3RyZWFtKGIpfXZhciBlPWEoXCIuLi91dGlsc1wiKSxmPWEoXCIuLi9zdHJlYW0vR2VuZXJpY1dvcmtlclwiKTtlLmluaGVyaXRzKGQsZiksZC5wcm90b3R5cGUuX2JpbmRTdHJlYW09ZnVuY3Rpb24oYSl7dmFyIGI9dGhpczt0aGlzLl9zdHJlYW09YSxhLnBhdXNlKCksYS5vbihcImRhdGFcIixmdW5jdGlvbihhKXtiLnB1c2goe2RhdGE6YSxtZXRhOntwZXJjZW50OjB9fSl9KS5vbihcImVycm9yXCIsZnVuY3Rpb24oYSl7Yi5pc1BhdXNlZD90aGlzLmdlbmVyYXRlZEVycm9yPWE6Yi5lcnJvcihhKX0pLm9uKFwiZW5kXCIsZnVuY3Rpb24oKXtiLmlzUGF1c2VkP2IuX3Vwc3RyZWFtRW5kZWQ9ITA6Yi5lbmQoKX0pfSxkLnByb3RvdHlwZS5wYXVzZT1mdW5jdGlvbigpe3JldHVybiEhZi5wcm90b3R5cGUucGF1c2UuY2FsbCh0aGlzKSYmKHRoaXMuX3N0cmVhbS5wYXVzZSgpLCEwKX0sZC5wcm90b3R5cGUucmVzdW1lPWZ1bmN0aW9uKCl7cmV0dXJuISFmLnByb3RvdHlwZS5yZXN1bWUuY2FsbCh0aGlzKSYmKHRoaXMuX3Vwc3RyZWFtRW5kZWQ/dGhpcy5lbmQoKTp0aGlzLl9zdHJlYW0ucmVzdW1lKCksITApfSxiLmV4cG9ydHM9ZH0se1wiLi4vc3RyZWFtL0dlbmVyaWNXb3JrZXJcIjoyOCxcIi4uL3V0aWxzXCI6MzJ9XSwxMzpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGQoYSxiLGMpe2UuY2FsbCh0aGlzLGIpLHRoaXMuX2hlbHBlcj1hO3ZhciBkPXRoaXM7YS5vbihcImRhdGFcIixmdW5jdGlvbihhLGIpe2QucHVzaChhKXx8ZC5faGVscGVyLnBhdXNlKCksYyYmYyhiKX0pLm9uKFwiZXJyb3JcIixmdW5jdGlvbihhKXtkLmVtaXQoXCJlcnJvclwiLGEpfSkub24oXCJlbmRcIixmdW5jdGlvbigpe2QucHVzaChudWxsKX0pfXZhciBlPWEoXCJyZWFkYWJsZS1zdHJlYW1cIikuUmVhZGFibGUsZj1hKFwiLi4vdXRpbHNcIik7Zi5pbmhlcml0cyhkLGUpLGQucHJvdG90eXBlLl9yZWFkPWZ1bmN0aW9uKCl7dGhpcy5faGVscGVyLnJlc3VtZSgpfSxiLmV4cG9ydHM9ZH0se1wiLi4vdXRpbHNcIjozMixcInJlYWRhYmxlLXN0cmVhbVwiOjE2fV0sMTQ6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtiLmV4cG9ydHM9e2lzTm9kZTpcInVuZGVmaW5lZFwiIT10eXBlb2YgQnVmZmVyLG5ld0J1ZmZlckZyb206ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IEJ1ZmZlcihhLGIpfSxhbGxvY0J1ZmZlcjpmdW5jdGlvbihhKXtyZXR1cm4gQnVmZmVyLmFsbG9jP0J1ZmZlci5hbGxvYyhhKTpuZXcgQnVmZmVyKGEpfSxpc0J1ZmZlcjpmdW5jdGlvbihhKXtyZXR1cm4gQnVmZmVyLmlzQnVmZmVyKGEpfSxpc1N0cmVhbTpmdW5jdGlvbihhKXtyZXR1cm4gYSYmXCJmdW5jdGlvblwiPT10eXBlb2YgYS5vbiYmXCJmdW5jdGlvblwiPT10eXBlb2YgYS5wYXVzZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgYS5yZXN1bWV9fX0se31dLDE1OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZChhKXtyZXR1cm5cIltvYmplY3QgUmVnRXhwXVwiPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGEpfXZhciBlPWEoXCIuL3V0ZjhcIiksZj1hKFwiLi91dGlsc1wiKSxnPWEoXCIuL3N0cmVhbS9HZW5lcmljV29ya2VyXCIpLGg9YShcIi4vc3RyZWFtL1N0cmVhbUhlbHBlclwiKSxpPWEoXCIuL2RlZmF1bHRzXCIpLGo9YShcIi4vY29tcHJlc3NlZE9iamVjdFwiKSxrPWEoXCIuL3ppcE9iamVjdFwiKSxsPWEoXCIuL2dlbmVyYXRlXCIpLG09YShcIi4vbm9kZWpzVXRpbHNcIiksbj1hKFwiLi9ub2RlanMvTm9kZWpzU3RyZWFtSW5wdXRBZGFwdGVyXCIpLG89ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU9Zi5nZXRUeXBlT2YoYiksaD1mLmV4dGVuZChjfHx7fSxpKTtoLmRhdGU9aC5kYXRlfHxuZXcgRGF0ZSxudWxsIT09aC5jb21wcmVzc2lvbiYmKGguY29tcHJlc3Npb249aC5jb21wcmVzc2lvbi50b1VwcGVyQ2FzZSgpKSxcInN0cmluZ1wiPT10eXBlb2YgaC51bml4UGVybWlzc2lvbnMmJihoLnVuaXhQZXJtaXNzaW9ucz1wYXJzZUludChoLnVuaXhQZXJtaXNzaW9ucyw4KSksaC51bml4UGVybWlzc2lvbnMmJjE2Mzg0JmgudW5peFBlcm1pc3Npb25zJiYoaC5kaXI9ITApLGguZG9zUGVybWlzc2lvbnMmJjE2JmguZG9zUGVybWlzc2lvbnMmJihoLmRpcj0hMCksaC5kaXImJihhPXEoYSkpLGguY3JlYXRlRm9sZGVycyYmKGQ9cChhKSkmJnIuY2FsbCh0aGlzLGQsITApO3ZhciBsPVwic3RyaW5nXCI9PT1lJiZoLmJpbmFyeT09PSExJiZoLmJhc2U2ND09PSExO2MmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBjLmJpbmFyeXx8KGguYmluYXJ5PSFsKTt2YXIgbz1iIGluc3RhbmNlb2YgaiYmMD09PWIudW5jb21wcmVzc2VkU2l6ZTsob3x8aC5kaXJ8fCFifHwwPT09Yi5sZW5ndGgpJiYoaC5iYXNlNjQ9ITEsaC5iaW5hcnk9ITAsYj1cIlwiLGguY29tcHJlc3Npb249XCJTVE9SRVwiLGU9XCJzdHJpbmdcIik7dmFyIHM9bnVsbDtzPWIgaW5zdGFuY2VvZiBqfHxiIGluc3RhbmNlb2YgZz9iOm0uaXNOb2RlJiZtLmlzU3RyZWFtKGIpP25ldyBuKGEsYik6Zi5wcmVwYXJlQ29udGVudChhLGIsaC5iaW5hcnksaC5vcHRpbWl6ZWRCaW5hcnlTdHJpbmcsaC5iYXNlNjQpO3ZhciB0PW5ldyBrKGEscyxoKTt0aGlzLmZpbGVzW2FdPXR9LHA9ZnVuY3Rpb24oYSl7XCIvXCI9PT1hLnNsaWNlKC0xKSYmKGE9YS5zdWJzdHJpbmcoMCxhLmxlbmd0aC0xKSk7dmFyIGI9YS5sYXN0SW5kZXhPZihcIi9cIik7cmV0dXJuIGI+MD9hLnN1YnN0cmluZygwLGIpOlwiXCJ9LHE9ZnVuY3Rpb24oYSl7cmV0dXJuXCIvXCIhPT1hLnNsaWNlKC0xKSYmKGErPVwiL1wiKSxhfSxyPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGI9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGI/YjppLmNyZWF0ZUZvbGRlcnMsYT1xKGEpLHRoaXMuZmlsZXNbYV18fG8uY2FsbCh0aGlzLGEsbnVsbCx7ZGlyOiEwLGNyZWF0ZUZvbGRlcnM6Yn0pLHRoaXMuZmlsZXNbYV19LHM9e2xvYWQ6ZnVuY3Rpb24oKXt0aHJvdyBuZXcgRXJyb3IoXCJUaGlzIG1ldGhvZCBoYXMgYmVlbiByZW1vdmVkIGluIEpTWmlwIDMuMCwgcGxlYXNlIGNoZWNrIHRoZSB1cGdyYWRlIGd1aWRlLlwiKX0sZm9yRWFjaDpmdW5jdGlvbihhKXt2YXIgYixjLGQ7Zm9yKGIgaW4gdGhpcy5maWxlcyl0aGlzLmZpbGVzLmhhc093blByb3BlcnR5KGIpJiYoZD10aGlzLmZpbGVzW2JdLGM9Yi5zbGljZSh0aGlzLnJvb3QubGVuZ3RoLGIubGVuZ3RoKSxjJiZiLnNsaWNlKDAsdGhpcy5yb290Lmxlbmd0aCk9PT10aGlzLnJvb3QmJmEoYyxkKSl9LGZpbHRlcjpmdW5jdGlvbihhKXt2YXIgYj1bXTtyZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uKGMsZCl7YShjLGQpJiZiLnB1c2goZCl9KSxifSxmaWxlOmZ1bmN0aW9uKGEsYixjKXtpZigxPT09YXJndW1lbnRzLmxlbmd0aCl7aWYoZChhKSl7dmFyIGU9YTtyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oYSxiKXtyZXR1cm4hYi5kaXImJmUudGVzdChhKX0pfXZhciBmPXRoaXMuZmlsZXNbdGhpcy5yb290K2FdO3JldHVybiBmJiYhZi5kaXI/ZjpudWxsfXJldHVybiBhPXRoaXMucm9vdCthLG8uY2FsbCh0aGlzLGEsYixjKSx0aGlzfSxmb2xkZXI6ZnVuY3Rpb24oYSl7aWYoIWEpcmV0dXJuIHRoaXM7aWYoZChhKSlyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oYixjKXtyZXR1cm4gYy5kaXImJmEudGVzdChiKX0pO3ZhciBiPXRoaXMucm9vdCthLGM9ci5jYWxsKHRoaXMsYiksZT10aGlzLmNsb25lKCk7cmV0dXJuIGUucm9vdD1jLm5hbWUsZX0scmVtb3ZlOmZ1bmN0aW9uKGEpe2E9dGhpcy5yb290K2E7dmFyIGI9dGhpcy5maWxlc1thXTtpZihifHwoXCIvXCIhPT1hLnNsaWNlKC0xKSYmKGErPVwiL1wiKSxiPXRoaXMuZmlsZXNbYV0pLGImJiFiLmRpcilkZWxldGUgdGhpcy5maWxlc1thXTtlbHNlIGZvcih2YXIgYz10aGlzLmZpbHRlcihmdW5jdGlvbihiLGMpe3JldHVybiBjLm5hbWUuc2xpY2UoMCxhLmxlbmd0aCk9PT1hfSksZD0wO2Q8Yy5sZW5ndGg7ZCsrKWRlbGV0ZSB0aGlzLmZpbGVzW2NbZF0ubmFtZV07cmV0dXJuIHRoaXN9LGdlbmVyYXRlOmZ1bmN0aW9uKGEpe3Rocm93IG5ldyBFcnJvcihcIlRoaXMgbWV0aG9kIGhhcyBiZWVuIHJlbW92ZWQgaW4gSlNaaXAgMy4wLCBwbGVhc2UgY2hlY2sgdGhlIHVwZ3JhZGUgZ3VpZGUuXCIpfSxnZW5lcmF0ZUludGVybmFsU3RyZWFtOmZ1bmN0aW9uKGEpe3ZhciBiLGM9e307dHJ5e2lmKGM9Zi5leHRlbmQoYXx8e30se3N0cmVhbUZpbGVzOiExLGNvbXByZXNzaW9uOlwiU1RPUkVcIixjb21wcmVzc2lvbk9wdGlvbnM6bnVsbCx0eXBlOlwiXCIscGxhdGZvcm06XCJET1NcIixjb21tZW50Om51bGwsbWltZVR5cGU6XCJhcHBsaWNhdGlvbi96aXBcIixlbmNvZGVGaWxlTmFtZTplLnV0ZjhlbmNvZGV9KSxjLnR5cGU9Yy50eXBlLnRvTG93ZXJDYXNlKCksYy5jb21wcmVzc2lvbj1jLmNvbXByZXNzaW9uLnRvVXBwZXJDYXNlKCksXCJiaW5hcnlzdHJpbmdcIj09PWMudHlwZSYmKGMudHlwZT1cInN0cmluZ1wiKSwhYy50eXBlKXRocm93IG5ldyBFcnJvcihcIk5vIG91dHB1dCB0eXBlIHNwZWNpZmllZC5cIik7Zi5jaGVja1N1cHBvcnQoYy50eXBlKSxcImRhcndpblwiIT09Yy5wbGF0Zm9ybSYmXCJmcmVlYnNkXCIhPT1jLnBsYXRmb3JtJiZcImxpbnV4XCIhPT1jLnBsYXRmb3JtJiZcInN1bm9zXCIhPT1jLnBsYXRmb3JtfHwoYy5wbGF0Zm9ybT1cIlVOSVhcIiksXCJ3aW4zMlwiPT09Yy5wbGF0Zm9ybSYmKGMucGxhdGZvcm09XCJET1NcIik7dmFyIGQ9Yy5jb21tZW50fHx0aGlzLmNvbW1lbnR8fFwiXCI7Yj1sLmdlbmVyYXRlV29ya2VyKHRoaXMsYyxkKX1jYXRjaChpKXtiPW5ldyBnKFwiZXJyb3JcIiksYi5lcnJvcihpKX1yZXR1cm4gbmV3IGgoYixjLnR5cGV8fFwic3RyaW5nXCIsYy5taW1lVHlwZSl9LGdlbmVyYXRlQXN5bmM6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5nZW5lcmF0ZUludGVybmFsU3RyZWFtKGEpLmFjY3VtdWxhdGUoYil9LGdlbmVyYXRlTm9kZVN0cmVhbTpmdW5jdGlvbihhLGIpe3JldHVybiBhPWF8fHt9LGEudHlwZXx8KGEudHlwZT1cIm5vZGVidWZmZXJcIiksdGhpcy5nZW5lcmF0ZUludGVybmFsU3RyZWFtKGEpLnRvTm9kZWpzU3RyZWFtKGIpfX07Yi5leHBvcnRzPXN9LHtcIi4vY29tcHJlc3NlZE9iamVjdFwiOjIsXCIuL2RlZmF1bHRzXCI6NSxcIi4vZ2VuZXJhdGVcIjo5LFwiLi9ub2RlanMvTm9kZWpzU3RyZWFtSW5wdXRBZGFwdGVyXCI6MTIsXCIuL25vZGVqc1V0aWxzXCI6MTQsXCIuL3N0cmVhbS9HZW5lcmljV29ya2VyXCI6MjgsXCIuL3N0cmVhbS9TdHJlYW1IZWxwZXJcIjoyOSxcIi4vdXRmOFwiOjMxLFwiLi91dGlsc1wiOjMyLFwiLi96aXBPYmplY3RcIjozNX1dLDE2OltmdW5jdGlvbihhLGIsYyl7Yi5leHBvcnRzPWEoXCJzdHJlYW1cIil9LHtzdHJlYW06dm9pZCAwfV0sMTc6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEpe2UuY2FsbCh0aGlzLGEpO2Zvcih2YXIgYj0wO2I8dGhpcy5kYXRhLmxlbmd0aDtiKyspYVtiXT0yNTUmYVtiXX12YXIgZT1hKFwiLi9EYXRhUmVhZGVyXCIpLGY9YShcIi4uL3V0aWxzXCIpO2YuaW5oZXJpdHMoZCxlKSxkLnByb3RvdHlwZS5ieXRlQXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZGF0YVt0aGlzLnplcm8rYV19LGQucHJvdG90eXBlLmxhc3RJbmRleE9mU2lnbmF0dXJlPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1hLmNoYXJDb2RlQXQoMCksYz1hLmNoYXJDb2RlQXQoMSksZD1hLmNoYXJDb2RlQXQoMiksZT1hLmNoYXJDb2RlQXQoMyksZj10aGlzLmxlbmd0aC00O2Y+PTA7LS1mKWlmKHRoaXMuZGF0YVtmXT09PWImJnRoaXMuZGF0YVtmKzFdPT09YyYmdGhpcy5kYXRhW2YrMl09PT1kJiZ0aGlzLmRhdGFbZiszXT09PWUpcmV0dXJuIGYtdGhpcy56ZXJvO3JldHVybi0xfSxkLnByb3RvdHlwZS5yZWFkQW5kQ2hlY2tTaWduYXR1cmU9ZnVuY3Rpb24oYSl7dmFyIGI9YS5jaGFyQ29kZUF0KDApLGM9YS5jaGFyQ29kZUF0KDEpLGQ9YS5jaGFyQ29kZUF0KDIpLGU9YS5jaGFyQ29kZUF0KDMpLGY9dGhpcy5yZWFkRGF0YSg0KTtyZXR1cm4gYj09PWZbMF0mJmM9PT1mWzFdJiZkPT09ZlsyXSYmZT09PWZbM119LGQucHJvdG90eXBlLnJlYWREYXRhPWZ1bmN0aW9uKGEpe2lmKHRoaXMuY2hlY2tPZmZzZXQoYSksMD09PWEpcmV0dXJuW107dmFyIGI9dGhpcy5kYXRhLnNsaWNlKHRoaXMuemVybyt0aGlzLmluZGV4LHRoaXMuemVybyt0aGlzLmluZGV4K2EpO3JldHVybiB0aGlzLmluZGV4Kz1hLGJ9LGIuZXhwb3J0cz1kfSx7XCIuLi91dGlsc1wiOjMyLFwiLi9EYXRhUmVhZGVyXCI6MTh9XSwxODpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGQoYSl7dGhpcy5kYXRhPWEsdGhpcy5sZW5ndGg9YS5sZW5ndGgsdGhpcy5pbmRleD0wLHRoaXMuemVybz0wfXZhciBlPWEoXCIuLi91dGlsc1wiKTtkLnByb3RvdHlwZT17Y2hlY2tPZmZzZXQ6ZnVuY3Rpb24oYSl7dGhpcy5jaGVja0luZGV4KHRoaXMuaW5kZXgrYSl9LGNoZWNrSW5kZXg6ZnVuY3Rpb24oYSl7aWYodGhpcy5sZW5ndGg8dGhpcy56ZXJvK2F8fGE8MCl0aHJvdyBuZXcgRXJyb3IoXCJFbmQgb2YgZGF0YSByZWFjaGVkIChkYXRhIGxlbmd0aCA9IFwiK3RoaXMubGVuZ3RoK1wiLCBhc2tlZCBpbmRleCA9IFwiK2ErXCIpLiBDb3JydXB0ZWQgemlwID9cIil9LHNldEluZGV4OmZ1bmN0aW9uKGEpe3RoaXMuY2hlY2tJbmRleChhKSx0aGlzLmluZGV4PWF9LHNraXA6ZnVuY3Rpb24oYSl7dGhpcy5zZXRJbmRleCh0aGlzLmluZGV4K2EpfSxieXRlQXQ6ZnVuY3Rpb24oYSl7fSxyZWFkSW50OmZ1bmN0aW9uKGEpe3ZhciBiLGM9MDtmb3IodGhpcy5jaGVja09mZnNldChhKSxiPXRoaXMuaW5kZXgrYS0xO2I+PXRoaXMuaW5kZXg7Yi0tKWM9KGM8PDgpK3RoaXMuYnl0ZUF0KGIpO3JldHVybiB0aGlzLmluZGV4Kz1hLGN9LHJlYWRTdHJpbmc6ZnVuY3Rpb24oYSl7cmV0dXJuIGUudHJhbnNmb3JtVG8oXCJzdHJpbmdcIix0aGlzLnJlYWREYXRhKGEpKX0scmVhZERhdGE6ZnVuY3Rpb24oYSl7fSxsYXN0SW5kZXhPZlNpZ25hdHVyZTpmdW5jdGlvbihhKXt9LHJlYWRBbmRDaGVja1NpZ25hdHVyZTpmdW5jdGlvbihhKXt9LHJlYWREYXRlOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5yZWFkSW50KDQpO3JldHVybiBuZXcgRGF0ZShEYXRlLlVUQygoYT4+MjUmMTI3KSsxOTgwLChhPj4yMSYxNSktMSxhPj4xNiYzMSxhPj4xMSYzMSxhPj41JjYzLCgzMSZhKTw8MSkpfX0sYi5leHBvcnRzPWR9LHtcIi4uL3V0aWxzXCI6MzJ9XSwxOTpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGQoYSl7ZS5jYWxsKHRoaXMsYSl9dmFyIGU9YShcIi4vVWludDhBcnJheVJlYWRlclwiKSxmPWEoXCIuLi91dGlsc1wiKTtmLmluaGVyaXRzKGQsZSksZC5wcm90b3R5cGUucmVhZERhdGE9ZnVuY3Rpb24oYSl7dGhpcy5jaGVja09mZnNldChhKTt2YXIgYj10aGlzLmRhdGEuc2xpY2UodGhpcy56ZXJvK3RoaXMuaW5kZXgsdGhpcy56ZXJvK3RoaXMuaW5kZXgrYSk7cmV0dXJuIHRoaXMuaW5kZXgrPWEsYn0sYi5leHBvcnRzPWR9LHtcIi4uL3V0aWxzXCI6MzIsXCIuL1VpbnQ4QXJyYXlSZWFkZXJcIjoyMX1dLDIwOltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZChhKXtlLmNhbGwodGhpcyxhKX12YXIgZT1hKFwiLi9EYXRhUmVhZGVyXCIpLGY9YShcIi4uL3V0aWxzXCIpO2YuaW5oZXJpdHMoZCxlKSxkLnByb3RvdHlwZS5ieXRlQXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZGF0YS5jaGFyQ29kZUF0KHRoaXMuemVybythKX0sZC5wcm90b3R5cGUubGFzdEluZGV4T2ZTaWduYXR1cmU9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZGF0YS5sYXN0SW5kZXhPZihhKS10aGlzLnplcm99LGQucHJvdG90eXBlLnJlYWRBbmRDaGVja1NpZ25hdHVyZT1mdW5jdGlvbihhKXt2YXIgYj10aGlzLnJlYWREYXRhKDQpO3JldHVybiBhPT09Yn0sZC5wcm90b3R5cGUucmVhZERhdGE9ZnVuY3Rpb24oYSl7dGhpcy5jaGVja09mZnNldChhKTt2YXIgYj10aGlzLmRhdGEuc2xpY2UodGhpcy56ZXJvK3RoaXMuaW5kZXgsdGhpcy56ZXJvK3RoaXMuaW5kZXgrYSk7cmV0dXJuIHRoaXMuaW5kZXgrPWEsYn0sYi5leHBvcnRzPWR9LHtcIi4uL3V0aWxzXCI6MzIsXCIuL0RhdGFSZWFkZXJcIjoxOH1dLDIxOltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZChhKXtlLmNhbGwodGhpcyxhKX12YXIgZT1hKFwiLi9BcnJheVJlYWRlclwiKSxmPWEoXCIuLi91dGlsc1wiKTtmLmluaGVyaXRzKGQsZSksZC5wcm90b3R5cGUucmVhZERhdGE9ZnVuY3Rpb24oYSl7aWYodGhpcy5jaGVja09mZnNldChhKSwwPT09YSlyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoMCk7dmFyIGI9dGhpcy5kYXRhLnN1YmFycmF5KHRoaXMuemVybyt0aGlzLmluZGV4LHRoaXMuemVybyt0aGlzLmluZGV4K2EpO3JldHVybiB0aGlzLmluZGV4Kz1hLGJ9LGIuZXhwb3J0cz1kfSx7XCIuLi91dGlsc1wiOjMyLFwiLi9BcnJheVJlYWRlclwiOjE3fV0sMjI6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjt2YXIgZD1hKFwiLi4vdXRpbHNcIiksZT1hKFwiLi4vc3VwcG9ydFwiKSxmPWEoXCIuL0FycmF5UmVhZGVyXCIpLGc9YShcIi4vU3RyaW5nUmVhZGVyXCIpLGg9YShcIi4vTm9kZUJ1ZmZlclJlYWRlclwiKSxpPWEoXCIuL1VpbnQ4QXJyYXlSZWFkZXJcIik7Yi5leHBvcnRzPWZ1bmN0aW9uKGEpe3ZhciBiPWQuZ2V0VHlwZU9mKGEpO3JldHVybiBkLmNoZWNrU3VwcG9ydChiKSxcInN0cmluZ1wiIT09Ynx8ZS51aW50OGFycmF5P1wibm9kZWJ1ZmZlclwiPT09Yj9uZXcgaChhKTplLnVpbnQ4YXJyYXk/bmV3IGkoZC50cmFuc2Zvcm1UbyhcInVpbnQ4YXJyYXlcIixhKSk6bmV3IGYoZC50cmFuc2Zvcm1UbyhcImFycmF5XCIsYSkpOm5ldyBnKGEpfX0se1wiLi4vc3VwcG9ydFwiOjMwLFwiLi4vdXRpbHNcIjozMixcIi4vQXJyYXlSZWFkZXJcIjoxNyxcIi4vTm9kZUJ1ZmZlclJlYWRlclwiOjE5LFwiLi9TdHJpbmdSZWFkZXJcIjoyMCxcIi4vVWludDhBcnJheVJlYWRlclwiOjIxfV0sMjM6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtjLkxPQ0FMX0ZJTEVfSEVBREVSPVwiUEtcdTAwMDNcdTAwMDRcIixjLkNFTlRSQUxfRklMRV9IRUFERVI9XCJQS1x1MDAwMVx1MDAwMlwiLGMuQ0VOVFJBTF9ESVJFQ1RPUllfRU5EPVwiUEtcdTAwMDVcdTAwMDZcIixjLlpJUDY0X0NFTlRSQUxfRElSRUNUT1JZX0xPQ0FUT1I9XCJQS1x1MDAwNlx1MDAwN1wiLGMuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfRU5EPVwiUEtcdTAwMDZcdTAwMDZcIixjLkRBVEFfREVTQ1JJUFRPUj1cIlBLXHUwMDA3XFxiXCJ9LHt9XSwyNDpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGQoYSl7ZS5jYWxsKHRoaXMsXCJDb252ZXJ0V29ya2VyIHRvIFwiK2EpLHRoaXMuZGVzdFR5cGU9YX12YXIgZT1hKFwiLi9HZW5lcmljV29ya2VyXCIpLGY9YShcIi4uL3V0aWxzXCIpO2YuaW5oZXJpdHMoZCxlKSxkLnByb3RvdHlwZS5wcm9jZXNzQ2h1bms9ZnVuY3Rpb24oYSl7dGhpcy5wdXNoKHtkYXRhOmYudHJhbnNmb3JtVG8odGhpcy5kZXN0VHlwZSxhLmRhdGEpLG1ldGE6YS5tZXRhfSl9LGIuZXhwb3J0cz1kfSx7XCIuLi91dGlsc1wiOjMyLFwiLi9HZW5lcmljV29ya2VyXCI6Mjh9XSwyNTpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGQoKXtlLmNhbGwodGhpcyxcIkNyYzMyUHJvYmVcIiksdGhpcy53aXRoU3RyZWFtSW5mbyhcImNyYzMyXCIsMCl9dmFyIGU9YShcIi4vR2VuZXJpY1dvcmtlclwiKSxmPWEoXCIuLi9jcmMzMlwiKSxnPWEoXCIuLi91dGlsc1wiKTtnLmluaGVyaXRzKGQsZSksZC5wcm90b3R5cGUucHJvY2Vzc0NodW5rPWZ1bmN0aW9uKGEpe3RoaXMuc3RyZWFtSW5mby5jcmMzMj1mKGEuZGF0YSx0aGlzLnN0cmVhbUluZm8uY3JjMzJ8fDApLHRoaXMucHVzaChhKX0sYi5leHBvcnRzPWR9LHtcIi4uL2NyYzMyXCI6NCxcIi4uL3V0aWxzXCI6MzIsXCIuL0dlbmVyaWNXb3JrZXJcIjoyOH1dLDI2OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZChhKXtmLmNhbGwodGhpcyxcIkRhdGFMZW5ndGhQcm9iZSBmb3IgXCIrYSksdGhpcy5wcm9wTmFtZT1hLHRoaXMud2l0aFN0cmVhbUluZm8oYSwwKX12YXIgZT1hKFwiLi4vdXRpbHNcIiksZj1hKFwiLi9HZW5lcmljV29ya2VyXCIpO2UuaW5oZXJpdHMoZCxmKSxkLnByb3RvdHlwZS5wcm9jZXNzQ2h1bms9ZnVuY3Rpb24oYSl7aWYoYSl7dmFyIGI9dGhpcy5zdHJlYW1JbmZvW3RoaXMucHJvcE5hbWVdfHwwO3RoaXMuc3RyZWFtSW5mb1t0aGlzLnByb3BOYW1lXT1iK2EuZGF0YS5sZW5ndGh9Zi5wcm90b3R5cGUucHJvY2Vzc0NodW5rLmNhbGwodGhpcyxhKX0sYi5leHBvcnRzPWR9LHtcIi4uL3V0aWxzXCI6MzIsXCIuL0dlbmVyaWNXb3JrZXJcIjoyOH1dLDI3OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZChhKXtmLmNhbGwodGhpcyxcIkRhdGFXb3JrZXJcIik7dmFyIGI9dGhpczt0aGlzLmRhdGFJc1JlYWR5PSExLHRoaXMuaW5kZXg9MCx0aGlzLm1heD0wLHRoaXMuZGF0YT1udWxsLHRoaXMudHlwZT1cIlwiLHRoaXMuX3RpY2tTY2hlZHVsZWQ9ITEsYS50aGVuKGZ1bmN0aW9uKGEpe2IuZGF0YUlzUmVhZHk9ITAsYi5kYXRhPWEsYi5tYXg9YSYmYS5sZW5ndGh8fDAsYi50eXBlPWUuZ2V0VHlwZU9mKGEpLGIuaXNQYXVzZWR8fGIuX3RpY2tBbmRSZXBlYXQoKX0sZnVuY3Rpb24oYSl7Yi5lcnJvcihhKX0pfXZhciBlPWEoXCIuLi91dGlsc1wiKSxmPWEoXCIuL0dlbmVyaWNXb3JrZXJcIiksZz0xNjM4NDtlLmluaGVyaXRzKGQsZiksZC5wcm90b3R5cGUuY2xlYW5VcD1mdW5jdGlvbigpe2YucHJvdG90eXBlLmNsZWFuVXAuY2FsbCh0aGlzKSx0aGlzLmRhdGE9bnVsbH0sZC5wcm90b3R5cGUucmVzdW1lPWZ1bmN0aW9uKCl7cmV0dXJuISFmLnByb3RvdHlwZS5yZXN1bWUuY2FsbCh0aGlzKSYmKCF0aGlzLl90aWNrU2NoZWR1bGVkJiZ0aGlzLmRhdGFJc1JlYWR5JiYodGhpcy5fdGlja1NjaGVkdWxlZD0hMCxlLmRlbGF5KHRoaXMuX3RpY2tBbmRSZXBlYXQsW10sdGhpcykpLCEwKX0sZC5wcm90b3R5cGUuX3RpY2tBbmRSZXBlYXQ9ZnVuY3Rpb24oKXt0aGlzLl90aWNrU2NoZWR1bGVkPSExLHRoaXMuaXNQYXVzZWR8fHRoaXMuaXNGaW5pc2hlZHx8KHRoaXMuX3RpY2soKSx0aGlzLmlzRmluaXNoZWR8fChlLmRlbGF5KHRoaXMuX3RpY2tBbmRSZXBlYXQsW10sdGhpcyksdGhpcy5fdGlja1NjaGVkdWxlZD0hMCkpfSxkLnByb3RvdHlwZS5fdGljaz1mdW5jdGlvbigpe2lmKHRoaXMuaXNQYXVzZWR8fHRoaXMuaXNGaW5pc2hlZClyZXR1cm4hMTt2YXIgYT1nLGI9bnVsbCxjPU1hdGgubWluKHRoaXMubWF4LHRoaXMuaW5kZXgrYSk7aWYodGhpcy5pbmRleD49dGhpcy5tYXgpcmV0dXJuIHRoaXMuZW5kKCk7c3dpdGNoKHRoaXMudHlwZSl7Y2FzZVwic3RyaW5nXCI6Yj10aGlzLmRhdGEuc3Vic3RyaW5nKHRoaXMuaW5kZXgsYyk7YnJlYWs7Y2FzZVwidWludDhhcnJheVwiOmI9dGhpcy5kYXRhLnN1YmFycmF5KHRoaXMuaW5kZXgsYyk7YnJlYWs7Y2FzZVwiYXJyYXlcIjpjYXNlXCJub2RlYnVmZmVyXCI6Yj10aGlzLmRhdGEuc2xpY2UodGhpcy5pbmRleCxjKX1yZXR1cm4gdGhpcy5pbmRleD1jLHRoaXMucHVzaCh7ZGF0YTpiLG1ldGE6e3BlcmNlbnQ6dGhpcy5tYXg/dGhpcy5pbmRleC90aGlzLm1heCoxMDA6MH19KX0sYi5leHBvcnRzPWR9LHtcIi4uL3V0aWxzXCI6MzIsXCIuL0dlbmVyaWNXb3JrZXJcIjoyOH1dLDI4OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZChhKXt0aGlzLm5hbWU9YXx8XCJkZWZhdWx0XCIsdGhpcy5zdHJlYW1JbmZvPXt9LHRoaXMuZ2VuZXJhdGVkRXJyb3I9bnVsbCx0aGlzLmV4dHJhU3RyZWFtSW5mbz17fSx0aGlzLmlzUGF1c2VkPSEwLHRoaXMuaXNGaW5pc2hlZD0hMSx0aGlzLmlzTG9ja2VkPSExLHRoaXMuX2xpc3RlbmVycz17ZGF0YTpbXSxlbmQ6W10sZXJyb3I6W119LHRoaXMucHJldmlvdXM9bnVsbH1kLnByb3RvdHlwZT17cHVzaDpmdW5jdGlvbihhKXt0aGlzLmVtaXQoXCJkYXRhXCIsYSl9LGVuZDpmdW5jdGlvbigpe2lmKHRoaXMuaXNGaW5pc2hlZClyZXR1cm4hMTt0aGlzLmZsdXNoKCk7dHJ5e3RoaXMuZW1pdChcImVuZFwiKSx0aGlzLmNsZWFuVXAoKSx0aGlzLmlzRmluaXNoZWQ9ITB9Y2F0Y2goYSl7dGhpcy5lbWl0KFwiZXJyb3JcIixhKX1yZXR1cm4hMH0sZXJyb3I6ZnVuY3Rpb24oYSl7cmV0dXJuIXRoaXMuaXNGaW5pc2hlZCYmKHRoaXMuaXNQYXVzZWQ/dGhpcy5nZW5lcmF0ZWRFcnJvcj1hOih0aGlzLmlzRmluaXNoZWQ9ITAsdGhpcy5lbWl0KFwiZXJyb3JcIixhKSx0aGlzLnByZXZpb3VzJiZ0aGlzLnByZXZpb3VzLmVycm9yKGEpLHRoaXMuY2xlYW5VcCgpKSwhMCl9LG9uOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuX2xpc3RlbmVyc1thXS5wdXNoKGIpLHRoaXN9LGNsZWFuVXA6ZnVuY3Rpb24oKXt0aGlzLnN0cmVhbUluZm89dGhpcy5nZW5lcmF0ZWRFcnJvcj10aGlzLmV4dHJhU3RyZWFtSW5mbz1udWxsLHRoaXMuX2xpc3RlbmVycz1bXX0sZW1pdDpmdW5jdGlvbihhLGIpe2lmKHRoaXMuX2xpc3RlbmVyc1thXSlmb3IodmFyIGM9MDtjPHRoaXMuX2xpc3RlbmVyc1thXS5sZW5ndGg7YysrKXRoaXMuX2xpc3RlbmVyc1thXVtjXS5jYWxsKHRoaXMsYil9LHBpcGU6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVnaXN0ZXJQcmV2aW91cyh0aGlzKX0scmVnaXN0ZXJQcmV2aW91czpmdW5jdGlvbihhKXtpZih0aGlzLmlzTG9ja2VkKXRocm93IG5ldyBFcnJvcihcIlRoZSBzdHJlYW0gJ1wiK3RoaXMrXCInIGhhcyBhbHJlYWR5IGJlZW4gdXNlZC5cIik7dGhpcy5zdHJlYW1JbmZvPWEuc3RyZWFtSW5mbyx0aGlzLm1lcmdlU3RyZWFtSW5mbygpLHRoaXMucHJldmlvdXM9YTt2YXIgYj10aGlzO3JldHVybiBhLm9uKFwiZGF0YVwiLGZ1bmN0aW9uKGEpe2IucHJvY2Vzc0NodW5rKGEpfSksYS5vbihcImVuZFwiLGZ1bmN0aW9uKCl7Yi5lbmQoKX0pLGEub24oXCJlcnJvclwiLGZ1bmN0aW9uKGEpe2IuZXJyb3IoYSl9KSx0aGlzfSxwYXVzZTpmdW5jdGlvbigpe3JldHVybiF0aGlzLmlzUGF1c2VkJiYhdGhpcy5pc0ZpbmlzaGVkJiYodGhpcy5pc1BhdXNlZD0hMCx0aGlzLnByZXZpb3VzJiZ0aGlzLnByZXZpb3VzLnBhdXNlKCksITApfSxyZXN1bWU6ZnVuY3Rpb24oKXtpZighdGhpcy5pc1BhdXNlZHx8dGhpcy5pc0ZpbmlzaGVkKXJldHVybiExO3RoaXMuaXNQYXVzZWQ9ITE7dmFyIGE9ITE7cmV0dXJuIHRoaXMuZ2VuZXJhdGVkRXJyb3ImJih0aGlzLmVycm9yKHRoaXMuZ2VuZXJhdGVkRXJyb3IpLGE9ITApLHRoaXMucHJldmlvdXMmJnRoaXMucHJldmlvdXMucmVzdW1lKCksIWF9LGZsdXNoOmZ1bmN0aW9uKCl7fSxwcm9jZXNzQ2h1bms6ZnVuY3Rpb24oYSl7dGhpcy5wdXNoKGEpfSx3aXRoU3RyZWFtSW5mbzpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmV4dHJhU3RyZWFtSW5mb1thXT1iLHRoaXMubWVyZ2VTdHJlYW1JbmZvKCksdGhpc30sbWVyZ2VTdHJlYW1JbmZvOmZ1bmN0aW9uKCl7Zm9yKHZhciBhIGluIHRoaXMuZXh0cmFTdHJlYW1JbmZvKXRoaXMuZXh0cmFTdHJlYW1JbmZvLmhhc093blByb3BlcnR5KGEpJiYodGhpcy5zdHJlYW1JbmZvW2FdPXRoaXMuZXh0cmFTdHJlYW1JbmZvW2FdKX0sbG9jazpmdW5jdGlvbigpe2lmKHRoaXMuaXNMb2NrZWQpdGhyb3cgbmV3IEVycm9yKFwiVGhlIHN0cmVhbSAnXCIrdGhpcytcIicgaGFzIGFscmVhZHkgYmVlbiB1c2VkLlwiKTt0aGlzLmlzTG9ja2VkPSEwLHRoaXMucHJldmlvdXMmJnRoaXMucHJldmlvdXMubG9jaygpfSx0b1N0cmluZzpmdW5jdGlvbigpe3ZhciBhPVwiV29ya2VyIFwiK3RoaXMubmFtZTtyZXR1cm4gdGhpcy5wcmV2aW91cz90aGlzLnByZXZpb3VzK1wiIC0+IFwiK2E6YX19LGIuZXhwb3J0cz1kfSx7fV0sMjk6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEsYixjKXtzd2l0Y2goYSl7Y2FzZVwiYmxvYlwiOnJldHVybiBoLm5ld0Jsb2IoaC50cmFuc2Zvcm1UbyhcImFycmF5YnVmZmVyXCIsYiksYyk7Y2FzZVwiYmFzZTY0XCI6cmV0dXJuIGsuZW5jb2RlKGIpO2RlZmF1bHQ6cmV0dXJuIGgudHJhbnNmb3JtVG8oYSxiKX19ZnVuY3Rpb24gZShhLGIpe3ZhciBjLGQ9MCxlPW51bGwsZj0wO2ZvcihjPTA7YzxiLmxlbmd0aDtjKyspZis9YltjXS5sZW5ndGg7c3dpdGNoKGEpe2Nhc2VcInN0cmluZ1wiOnJldHVybiBiLmpvaW4oXCJcIik7Y2FzZVwiYXJyYXlcIjpyZXR1cm4gQXJyYXkucHJvdG90eXBlLmNvbmNhdC5hcHBseShbXSxiKTtjYXNlXCJ1aW50OGFycmF5XCI6Zm9yKGU9bmV3IFVpbnQ4QXJyYXkoZiksYz0wO2M8Yi5sZW5ndGg7YysrKWUuc2V0KGJbY10sZCksZCs9YltjXS5sZW5ndGg7cmV0dXJuIGU7Y2FzZVwibm9kZWJ1ZmZlclwiOnJldHVybiBCdWZmZXIuY29uY2F0KGIpO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKFwiY29uY2F0IDogdW5zdXBwb3J0ZWQgdHlwZSAnXCIrYStcIidcIil9fWZ1bmN0aW9uIGYoYSxiKXtyZXR1cm4gbmV3IG0uUHJvbWlzZShmdW5jdGlvbihjLGYpe3ZhciBnPVtdLGg9YS5faW50ZXJuYWxUeXBlLGk9YS5fb3V0cHV0VHlwZSxqPWEuX21pbWVUeXBlO2Eub24oXCJkYXRhXCIsZnVuY3Rpb24oYSxjKXtnLnB1c2goYSksYiYmYihjKX0pLm9uKFwiZXJyb3JcIixmdW5jdGlvbihhKXtnPVtdLGYoYSl9KS5vbihcImVuZFwiLGZ1bmN0aW9uKCl7dHJ5e3ZhciBhPWQoaSxlKGgsZyksaik7YyhhKX1jYXRjaChiKXtmKGIpfWc9W119KS5yZXN1bWUoKX0pfWZ1bmN0aW9uIGcoYSxiLGMpe3ZhciBkPWI7c3dpdGNoKGIpe2Nhc2VcImJsb2JcIjpjYXNlXCJhcnJheWJ1ZmZlclwiOmQ9XCJ1aW50OGFycmF5XCI7YnJlYWs7Y2FzZVwiYmFzZTY0XCI6ZD1cInN0cmluZ1wifXRyeXt0aGlzLl9pbnRlcm5hbFR5cGU9ZCx0aGlzLl9vdXRwdXRUeXBlPWIsdGhpcy5fbWltZVR5cGU9YyxoLmNoZWNrU3VwcG9ydChkKSx0aGlzLl93b3JrZXI9YS5waXBlKG5ldyBpKGQpKSxhLmxvY2soKX1jYXRjaChlKXt0aGlzLl93b3JrZXI9bmV3IGooXCJlcnJvclwiKSx0aGlzLl93b3JrZXIuZXJyb3IoZSl9fXZhciBoPWEoXCIuLi91dGlsc1wiKSxpPWEoXCIuL0NvbnZlcnRXb3JrZXJcIiksaj1hKFwiLi9HZW5lcmljV29ya2VyXCIpLGs9YShcIi4uL2Jhc2U2NFwiKSxsPWEoXCIuLi9zdXBwb3J0XCIpLG09YShcIi4uL2V4dGVybmFsXCIpLG49bnVsbDtpZihsLm5vZGVzdHJlYW0pdHJ5e249YShcIi4uL25vZGVqcy9Ob2RlanNTdHJlYW1PdXRwdXRBZGFwdGVyXCIpfWNhdGNoKG8pe31nLnByb3RvdHlwZT17YWNjdW11bGF0ZTpmdW5jdGlvbihhKXtyZXR1cm4gZih0aGlzLGEpfSxvbjpmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXM7cmV0dXJuXCJkYXRhXCI9PT1hP3RoaXMuX3dvcmtlci5vbihhLGZ1bmN0aW9uKGEpe2IuY2FsbChjLGEuZGF0YSxhLm1ldGEpfSk6dGhpcy5fd29ya2VyLm9uKGEsZnVuY3Rpb24oKXtoLmRlbGF5KGIsYXJndW1lbnRzLGMpfSksdGhpc30scmVzdW1lOmZ1bmN0aW9uKCl7cmV0dXJuIGguZGVsYXkodGhpcy5fd29ya2VyLnJlc3VtZSxbXSx0aGlzLl93b3JrZXIpLHRoaXN9LHBhdXNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dvcmtlci5wYXVzZSgpLHRoaXN9LHRvTm9kZWpzU3RyZWFtOmZ1bmN0aW9uKGEpe2lmKGguY2hlY2tTdXBwb3J0KFwibm9kZXN0cmVhbVwiKSxcIm5vZGVidWZmZXJcIiE9PXRoaXMuX291dHB1dFR5cGUpdGhyb3cgbmV3IEVycm9yKHRoaXMuX291dHB1dFR5cGUrXCIgaXMgbm90IHN1cHBvcnRlZCBieSB0aGlzIG1ldGhvZFwiKTtyZXR1cm4gbmV3IG4odGhpcyx7b2JqZWN0TW9kZTpcIm5vZGVidWZmZXJcIiE9PXRoaXMuX291dHB1dFR5cGV9LGEpfX0sYi5leHBvcnRzPWd9LHtcIi4uL2Jhc2U2NFwiOjEsXCIuLi9leHRlcm5hbFwiOjYsXCIuLi9ub2RlanMvTm9kZWpzU3RyZWFtT3V0cHV0QWRhcHRlclwiOjEzLFwiLi4vc3VwcG9ydFwiOjMwLFwiLi4vdXRpbHNcIjozMixcIi4vQ29udmVydFdvcmtlclwiOjI0LFwiLi9HZW5lcmljV29ya2VyXCI6Mjh9XSwzMDpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2lmKGMuYmFzZTY0PSEwLGMuYXJyYXk9ITAsYy5zdHJpbmc9ITAsYy5hcnJheWJ1ZmZlcj1cInVuZGVmaW5lZFwiIT10eXBlb2YgQXJyYXlCdWZmZXImJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBVaW50OEFycmF5LGMubm9kZWJ1ZmZlcj1cInVuZGVmaW5lZFwiIT10eXBlb2YgQnVmZmVyLGMudWludDhhcnJheT1cInVuZGVmaW5lZFwiIT10eXBlb2YgVWludDhBcnJheSxcInVuZGVmaW5lZFwiPT10eXBlb2YgQXJyYXlCdWZmZXIpYy5ibG9iPSExO2Vsc2V7dmFyIGQ9bmV3IEFycmF5QnVmZmVyKDApO3RyeXtjLmJsb2I9MD09PW5ldyBCbG9iKFtkXSx7dHlwZTpcImFwcGxpY2F0aW9uL3ppcFwifSkuc2l6ZX1jYXRjaChlKXt0cnl7dmFyIGY9c2VsZi5CbG9iQnVpbGRlcnx8c2VsZi5XZWJLaXRCbG9iQnVpbGRlcnx8c2VsZi5Nb3pCbG9iQnVpbGRlcnx8c2VsZi5NU0Jsb2JCdWlsZGVyLGc9bmV3IGY7Zy5hcHBlbmQoZCksYy5ibG9iPTA9PT1nLmdldEJsb2IoXCJhcHBsaWNhdGlvbi96aXBcIikuc2l6ZX1jYXRjaChlKXtjLmJsb2I9ITF9fX10cnl7Yy5ub2Rlc3RyZWFtPSEhYShcInJlYWRhYmxlLXN0cmVhbVwiKS5SZWFkYWJsZX1jYXRjaChlKXtjLm5vZGVzdHJlYW09ITF9fSx7XCJyZWFkYWJsZS1zdHJlYW1cIjoxNn1dLDMxOltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZCgpe2kuY2FsbCh0aGlzLFwidXRmLTggZGVjb2RlXCIpLHRoaXMubGVmdE92ZXI9bnVsbH1mdW5jdGlvbiBlKCl7aS5jYWxsKHRoaXMsXCJ1dGYtOCBlbmNvZGVcIil9Zm9yKHZhciBmPWEoXCIuL3V0aWxzXCIpLGc9YShcIi4vc3VwcG9ydFwiKSxoPWEoXCIuL25vZGVqc1V0aWxzXCIpLGk9YShcIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXJcIiksaj1uZXcgQXJyYXkoMjU2KSxrPTA7azwyNTY7aysrKWpba109az49MjUyPzY6az49MjQ4PzU6az49MjQwPzQ6az49MjI0PzM6az49MTkyPzI6MTtqWzI1NF09alsyNTRdPTE7dmFyIGw9ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixoPWEubGVuZ3RoLGk9MDtmb3IoZT0wO2U8aDtlKyspYz1hLmNoYXJDb2RlQXQoZSksNTUyOTY9PT0oNjQ1MTImYykmJmUrMTxoJiYoZD1hLmNoYXJDb2RlQXQoZSsxKSw1NjMyMD09PSg2NDUxMiZkKSYmKGM9NjU1MzYrKGMtNTUyOTY8PDEwKSsoZC01NjMyMCksZSsrKSksaSs9YzwxMjg/MTpjPDIwNDg/MjpjPDY1NTM2PzM6NDtmb3IoYj1nLnVpbnQ4YXJyYXk/bmV3IFVpbnQ4QXJyYXkoaSk6bmV3IEFycmF5KGkpLGY9MCxlPTA7ZjxpO2UrKyljPWEuY2hhckNvZGVBdChlKSw1NTI5Nj09PSg2NDUxMiZjKSYmZSsxPGgmJihkPWEuY2hhckNvZGVBdChlKzEpLDU2MzIwPT09KDY0NTEyJmQpJiYoYz02NTUzNisoYy01NTI5Njw8MTApKyhkLTU2MzIwKSxlKyspKSxjPDEyOD9iW2YrK109YzpjPDIwNDg/KGJbZisrXT0xOTJ8Yz4+PjYsYltmKytdPTEyOHw2MyZjKTpjPDY1NTM2PyhiW2YrK109MjI0fGM+Pj4xMixiW2YrK109MTI4fGM+Pj42JjYzLGJbZisrXT0xMjh8NjMmYyk6KGJbZisrXT0yNDB8Yz4+PjE4LGJbZisrXT0xMjh8Yz4+PjEyJjYzLGJbZisrXT0xMjh8Yz4+PjYmNjMsYltmKytdPTEyOHw2MyZjKTtyZXR1cm4gYn0sbT1mdW5jdGlvbihhLGIpe3ZhciBjO2ZvcihiPWJ8fGEubGVuZ3RoLGI+YS5sZW5ndGgmJihiPWEubGVuZ3RoKSxjPWItMTtjPj0wJiYxMjg9PT0oMTkyJmFbY10pOyljLS07cmV0dXJuIGM8MD9iOjA9PT1jP2I6YytqW2FbY11dPmI/YzpifSxuPWZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlLGc9YS5sZW5ndGgsaD1uZXcgQXJyYXkoMipnKTtmb3IoYz0wLGI9MDtiPGc7KWlmKGQ9YVtiKytdLGQ8MTI4KWhbYysrXT1kO2Vsc2UgaWYoZT1qW2RdLGU+NCloW2MrK109NjU1MzMsYis9ZS0xO2Vsc2V7Zm9yKGQmPTI9PT1lPzMxOjM9PT1lPzE1Ojc7ZT4xJiZiPGc7KWQ9ZDw8Nnw2MyZhW2IrK10sZS0tO2U+MT9oW2MrK109NjU1MzM6ZDw2NTUzNj9oW2MrK109ZDooZC09NjU1MzYsaFtjKytdPTU1Mjk2fGQ+PjEwJjEwMjMsaFtjKytdPTU2MzIwfDEwMjMmZCl9cmV0dXJuIGgubGVuZ3RoIT09YyYmKGguc3ViYXJyYXk/aD1oLnN1YmFycmF5KDAsYyk6aC5sZW5ndGg9YyksZi5hcHBseUZyb21DaGFyQ29kZShoKX07Yy51dGY4ZW5jb2RlPWZ1bmN0aW9uKGEpe3JldHVybiBnLm5vZGVidWZmZXI/aC5uZXdCdWZmZXJGcm9tKGEsXCJ1dGYtOFwiKTpsKGEpfSxjLnV0ZjhkZWNvZGU9ZnVuY3Rpb24oYSl7cmV0dXJuIGcubm9kZWJ1ZmZlcj9mLnRyYW5zZm9ybVRvKFwibm9kZWJ1ZmZlclwiLGEpLnRvU3RyaW5nKFwidXRmLThcIik6KGE9Zi50cmFuc2Zvcm1UbyhnLnVpbnQ4YXJyYXk/XCJ1aW50OGFycmF5XCI6XCJhcnJheVwiLGEpLG4oYSkpfSxmLmluaGVyaXRzKGQsaSksZC5wcm90b3R5cGUucHJvY2Vzc0NodW5rPWZ1bmN0aW9uKGEpe3ZhciBiPWYudHJhbnNmb3JtVG8oZy51aW50OGFycmF5P1widWludDhhcnJheVwiOlwiYXJyYXlcIixhLmRhdGEpO2lmKHRoaXMubGVmdE92ZXImJnRoaXMubGVmdE92ZXIubGVuZ3RoKXtpZihnLnVpbnQ4YXJyYXkpe3ZhciBkPWI7Yj1uZXcgVWludDhBcnJheShkLmxlbmd0aCt0aGlzLmxlZnRPdmVyLmxlbmd0aCksYi5zZXQodGhpcy5sZWZ0T3ZlciwwKSxiLnNldChkLHRoaXMubGVmdE92ZXIubGVuZ3RoKX1lbHNlIGI9dGhpcy5sZWZ0T3Zlci5jb25jYXQoYik7dGhpcy5sZWZ0T3Zlcj1udWxsfXZhciBlPW0oYiksaD1iO2UhPT1iLmxlbmd0aCYmKGcudWludDhhcnJheT8oaD1iLnN1YmFycmF5KDAsZSksdGhpcy5sZWZ0T3Zlcj1iLnN1YmFycmF5KGUsYi5sZW5ndGgpKTooaD1iLnNsaWNlKDAsZSksdGhpcy5sZWZ0T3Zlcj1iLnNsaWNlKGUsYi5sZW5ndGgpKSksdGhpcy5wdXNoKHtkYXRhOmMudXRmOGRlY29kZShoKSxtZXRhOmEubWV0YX0pfSxkLnByb3RvdHlwZS5mbHVzaD1mdW5jdGlvbigpe3RoaXMubGVmdE92ZXImJnRoaXMubGVmdE92ZXIubGVuZ3RoJiYodGhpcy5wdXNoKHtkYXRhOmMudXRmOGRlY29kZSh0aGlzLmxlZnRPdmVyKSxtZXRhOnt9fSksdGhpcy5sZWZ0T3Zlcj1udWxsKX0sYy5VdGY4RGVjb2RlV29ya2VyPWQsZi5pbmhlcml0cyhlLGkpLGUucHJvdG90eXBlLnByb2Nlc3NDaHVuaz1mdW5jdGlvbihhKXt0aGlzLnB1c2goe2RhdGE6Yy51dGY4ZW5jb2RlKGEuZGF0YSksbWV0YTphLm1ldGF9KX0sYy5VdGY4RW5jb2RlV29ya2VyPWV9LHtcIi4vbm9kZWpzVXRpbHNcIjoxNCxcIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXJcIjoyOCxcIi4vc3VwcG9ydFwiOjMwLFwiLi91dGlsc1wiOjMyfV0sMzI6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEpe3ZhciBiPW51bGw7cmV0dXJuIGI9aS51aW50OGFycmF5P25ldyBVaW50OEFycmF5KGEubGVuZ3RoKTpuZXcgQXJyYXkoYS5sZW5ndGgpLGYoYSxiKX1mdW5jdGlvbiBlKGEpe3JldHVybiBhfWZ1bmN0aW9uIGYoYSxiKXtmb3IodmFyIGM9MDtjPGEubGVuZ3RoOysrYyliW2NdPTI1NSZhLmNoYXJDb2RlQXQoYyk7cmV0dXJuIGJ9ZnVuY3Rpb24gZyhhKXt2YXIgYj02NTUzNixkPWMuZ2V0VHlwZU9mKGEpLGU9ITA7aWYoXCJ1aW50OGFycmF5XCI9PT1kP2U9bi5hcHBseUNhbkJlVXNlZC51aW50OGFycmF5Olwibm9kZWJ1ZmZlclwiPT09ZCYmKGU9bi5hcHBseUNhbkJlVXNlZC5ub2RlYnVmZmVyKSxlKWZvcig7Yj4xOyl0cnl7cmV0dXJuIG4uc3RyaW5naWZ5QnlDaHVuayhhLGQsYil9Y2F0Y2goZil7Yj1NYXRoLmZsb29yKGIvMil9cmV0dXJuIG4uc3RyaW5naWZ5QnlDaGFyKGEpfWZ1bmN0aW9uIGgoYSxiKXtmb3IodmFyIGM9MDtjPGEubGVuZ3RoO2MrKyliW2NdPWFbY107XG5yZXR1cm4gYn12YXIgaT1hKFwiLi9zdXBwb3J0XCIpLGo9YShcIi4vYmFzZTY0XCIpLGs9YShcIi4vbm9kZWpzVXRpbHNcIiksbD1hKFwiY29yZS1qcy9saWJyYXJ5L2ZuL3NldC1pbW1lZGlhdGVcIiksbT1hKFwiLi9leHRlcm5hbFwiKTtjLm5ld0Jsb2I9ZnVuY3Rpb24oYSxiKXtjLmNoZWNrU3VwcG9ydChcImJsb2JcIik7dHJ5e3JldHVybiBuZXcgQmxvYihbYV0se3R5cGU6Yn0pfWNhdGNoKGQpe3RyeXt2YXIgZT1zZWxmLkJsb2JCdWlsZGVyfHxzZWxmLldlYktpdEJsb2JCdWlsZGVyfHxzZWxmLk1vekJsb2JCdWlsZGVyfHxzZWxmLk1TQmxvYkJ1aWxkZXIsZj1uZXcgZTtyZXR1cm4gZi5hcHBlbmQoYSksZi5nZXRCbG9iKGIpfWNhdGNoKGQpe3Rocm93IG5ldyBFcnJvcihcIkJ1ZyA6IGNhbid0IGNvbnN0cnVjdCB0aGUgQmxvYi5cIil9fX07dmFyIG49e3N0cmluZ2lmeUJ5Q2h1bms6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVtdLGU9MCxmPWEubGVuZ3RoO2lmKGY8PWMpcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCxhKTtmb3IoO2U8ZjspXCJhcnJheVwiPT09Ynx8XCJub2RlYnVmZmVyXCI9PT1iP2QucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsYS5zbGljZShlLE1hdGgubWluKGUrYyxmKSkpKTpkLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLGEuc3ViYXJyYXkoZSxNYXRoLm1pbihlK2MsZikpKSksZSs9YztyZXR1cm4gZC5qb2luKFwiXCIpfSxzdHJpbmdpZnlCeUNoYXI6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPVwiXCIsYz0wO2M8YS5sZW5ndGg7YysrKWIrPVN0cmluZy5mcm9tQ2hhckNvZGUoYVtjXSk7cmV0dXJuIGJ9LGFwcGx5Q2FuQmVVc2VkOnt1aW50OGFycmF5OmZ1bmN0aW9uKCl7dHJ5e3JldHVybiBpLnVpbnQ4YXJyYXkmJjE9PT1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsbmV3IFVpbnQ4QXJyYXkoMSkpLmxlbmd0aH1jYXRjaChhKXtyZXR1cm4hMX19KCksbm9kZWJ1ZmZlcjpmdW5jdGlvbigpe3RyeXtyZXR1cm4gaS5ub2RlYnVmZmVyJiYxPT09U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLGsuYWxsb2NCdWZmZXIoMSkpLmxlbmd0aH1jYXRjaChhKXtyZXR1cm4hMX19KCl9fTtjLmFwcGx5RnJvbUNoYXJDb2RlPWc7dmFyIG89e307by5zdHJpbmc9e3N0cmluZzplLGFycmF5OmZ1bmN0aW9uKGEpe3JldHVybiBmKGEsbmV3IEFycmF5KGEubGVuZ3RoKSl9LGFycmF5YnVmZmVyOmZ1bmN0aW9uKGEpe3JldHVybiBvLnN0cmluZy51aW50OGFycmF5KGEpLmJ1ZmZlcn0sdWludDhhcnJheTpmdW5jdGlvbihhKXtyZXR1cm4gZihhLG5ldyBVaW50OEFycmF5KGEubGVuZ3RoKSl9LG5vZGVidWZmZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGYoYSxrLmFsbG9jQnVmZmVyKGEubGVuZ3RoKSl9fSxvLmFycmF5PXtzdHJpbmc6ZyxhcnJheTplLGFycmF5YnVmZmVyOmZ1bmN0aW9uKGEpe3JldHVybiBuZXcgVWludDhBcnJheShhKS5idWZmZXJ9LHVpbnQ4YXJyYXk6ZnVuY3Rpb24oYSl7cmV0dXJuIG5ldyBVaW50OEFycmF5KGEpfSxub2RlYnVmZmVyOmZ1bmN0aW9uKGEpe3JldHVybiBrLm5ld0J1ZmZlckZyb20oYSl9fSxvLmFycmF5YnVmZmVyPXtzdHJpbmc6ZnVuY3Rpb24oYSl7cmV0dXJuIGcobmV3IFVpbnQ4QXJyYXkoYSkpfSxhcnJheTpmdW5jdGlvbihhKXtyZXR1cm4gaChuZXcgVWludDhBcnJheShhKSxuZXcgQXJyYXkoYS5ieXRlTGVuZ3RoKSl9LGFycmF5YnVmZmVyOmUsdWludDhhcnJheTpmdW5jdGlvbihhKXtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoYSl9LG5vZGVidWZmZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGsubmV3QnVmZmVyRnJvbShuZXcgVWludDhBcnJheShhKSl9fSxvLnVpbnQ4YXJyYXk9e3N0cmluZzpnLGFycmF5OmZ1bmN0aW9uKGEpe3JldHVybiBoKGEsbmV3IEFycmF5KGEubGVuZ3RoKSl9LGFycmF5YnVmZmVyOmZ1bmN0aW9uKGEpe3JldHVybiBhLmJ1ZmZlcn0sdWludDhhcnJheTplLG5vZGVidWZmZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGsubmV3QnVmZmVyRnJvbShhKX19LG8ubm9kZWJ1ZmZlcj17c3RyaW5nOmcsYXJyYXk6ZnVuY3Rpb24oYSl7cmV0dXJuIGgoYSxuZXcgQXJyYXkoYS5sZW5ndGgpKX0sYXJyYXlidWZmZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIG8ubm9kZWJ1ZmZlci51aW50OGFycmF5KGEpLmJ1ZmZlcn0sdWludDhhcnJheTpmdW5jdGlvbihhKXtyZXR1cm4gaChhLG5ldyBVaW50OEFycmF5KGEubGVuZ3RoKSl9LG5vZGVidWZmZXI6ZX0sYy50cmFuc2Zvcm1Ubz1mdW5jdGlvbihhLGIpe2lmKGJ8fChiPVwiXCIpLCFhKXJldHVybiBiO2MuY2hlY2tTdXBwb3J0KGEpO3ZhciBkPWMuZ2V0VHlwZU9mKGIpLGU9b1tkXVthXShiKTtyZXR1cm4gZX0sYy5nZXRUeXBlT2Y9ZnVuY3Rpb24oYSl7cmV0dXJuXCJzdHJpbmdcIj09dHlwZW9mIGE/XCJzdHJpbmdcIjpcIltvYmplY3QgQXJyYXldXCI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSk/XCJhcnJheVwiOmkubm9kZWJ1ZmZlciYmay5pc0J1ZmZlcihhKT9cIm5vZGVidWZmZXJcIjppLnVpbnQ4YXJyYXkmJmEgaW5zdGFuY2VvZiBVaW50OEFycmF5P1widWludDhhcnJheVwiOmkuYXJyYXlidWZmZXImJmEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9cImFycmF5YnVmZmVyXCI6dm9pZCAwfSxjLmNoZWNrU3VwcG9ydD1mdW5jdGlvbihhKXt2YXIgYj1pW2EudG9Mb3dlckNhc2UoKV07aWYoIWIpdGhyb3cgbmV3IEVycm9yKGErXCIgaXMgbm90IHN1cHBvcnRlZCBieSB0aGlzIHBsYXRmb3JtXCIpfSxjLk1BWF9WQUxVRV8xNkJJVFM9NjU1MzUsYy5NQVhfVkFMVUVfMzJCSVRTPS0xLGMucHJldHR5PWZ1bmN0aW9uKGEpe3ZhciBiLGMsZD1cIlwiO2ZvcihjPTA7YzwoYXx8XCJcIikubGVuZ3RoO2MrKyliPWEuY2hhckNvZGVBdChjKSxkKz1cIlxcXFx4XCIrKGI8MTY/XCIwXCI6XCJcIikrYi50b1N0cmluZygxNikudG9VcHBlckNhc2UoKTtyZXR1cm4gZH0sYy5kZWxheT1mdW5jdGlvbihhLGIsYyl7bChmdW5jdGlvbigpe2EuYXBwbHkoY3x8bnVsbCxifHxbXSl9KX0sYy5pbmhlcml0cz1mdW5jdGlvbihhLGIpe3ZhciBjPWZ1bmN0aW9uKCl7fTtjLnByb3RvdHlwZT1iLnByb3RvdHlwZSxhLnByb3RvdHlwZT1uZXcgY30sYy5leHRlbmQ9ZnVuY3Rpb24oKXt2YXIgYSxiLGM9e307Zm9yKGE9MDthPGFyZ3VtZW50cy5sZW5ndGg7YSsrKWZvcihiIGluIGFyZ3VtZW50c1thXSlhcmd1bWVudHNbYV0uaGFzT3duUHJvcGVydHkoYikmJlwidW5kZWZpbmVkXCI9PXR5cGVvZiBjW2JdJiYoY1tiXT1hcmd1bWVudHNbYV1bYl0pO3JldHVybiBjfSxjLnByZXBhcmVDb250ZW50PWZ1bmN0aW9uKGEsYixlLGYsZyl7dmFyIGg9bS5Qcm9taXNlLnJlc29sdmUoYikudGhlbihmdW5jdGlvbihhKXt2YXIgYj1pLmJsb2ImJihhIGluc3RhbmNlb2YgQmxvYnx8W1wiW29iamVjdCBGaWxlXVwiLFwiW29iamVjdCBCbG9iXVwiXS5pbmRleE9mKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhKSkhPT0tMSk7cmV0dXJuIGImJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBGaWxlUmVhZGVyP25ldyBtLlByb21pc2UoZnVuY3Rpb24oYixjKXt2YXIgZD1uZXcgRmlsZVJlYWRlcjtkLm9ubG9hZD1mdW5jdGlvbihhKXtiKGEudGFyZ2V0LnJlc3VsdCl9LGQub25lcnJvcj1mdW5jdGlvbihhKXtjKGEudGFyZ2V0LmVycm9yKX0sZC5yZWFkQXNBcnJheUJ1ZmZlcihhKX0pOmF9KTtyZXR1cm4gaC50aGVuKGZ1bmN0aW9uKGIpe3ZhciBoPWMuZ2V0VHlwZU9mKGIpO3JldHVybiBoPyhcImFycmF5YnVmZmVyXCI9PT1oP2I9Yy50cmFuc2Zvcm1UbyhcInVpbnQ4YXJyYXlcIixiKTpcInN0cmluZ1wiPT09aCYmKGc/Yj1qLmRlY29kZShiKTplJiZmIT09ITAmJihiPWQoYikpKSxiKTptLlByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkNhbid0IHJlYWQgdGhlIGRhdGEgb2YgJ1wiK2ErXCInLiBJcyBpdCBpbiBhIHN1cHBvcnRlZCBKYXZhU2NyaXB0IHR5cGUgKFN0cmluZywgQmxvYiwgQXJyYXlCdWZmZXIsIGV0YykgP1wiKSl9KX19LHtcIi4vYmFzZTY0XCI6MSxcIi4vZXh0ZXJuYWxcIjo2LFwiLi9ub2RlanNVdGlsc1wiOjE0LFwiLi9zdXBwb3J0XCI6MzAsXCJjb3JlLWpzL2xpYnJhcnkvZm4vc2V0LWltbWVkaWF0ZVwiOjM2fV0sMzM6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEpe3RoaXMuZmlsZXM9W10sdGhpcy5sb2FkT3B0aW9ucz1hfXZhciBlPWEoXCIuL3JlYWRlci9yZWFkZXJGb3JcIiksZj1hKFwiLi91dGlsc1wiKSxnPWEoXCIuL3NpZ25hdHVyZVwiKSxoPWEoXCIuL3ppcEVudHJ5XCIpLGk9KGEoXCIuL3V0ZjhcIiksYShcIi4vc3VwcG9ydFwiKSk7ZC5wcm90b3R5cGU9e2NoZWNrU2lnbmF0dXJlOmZ1bmN0aW9uKGEpe2lmKCF0aGlzLnJlYWRlci5yZWFkQW5kQ2hlY2tTaWduYXR1cmUoYSkpe3RoaXMucmVhZGVyLmluZGV4LT00O3ZhciBiPXRoaXMucmVhZGVyLnJlYWRTdHJpbmcoNCk7dGhyb3cgbmV3IEVycm9yKFwiQ29ycnVwdGVkIHppcCBvciBidWc6IHVuZXhwZWN0ZWQgc2lnbmF0dXJlIChcIitmLnByZXR0eShiKStcIiwgZXhwZWN0ZWQgXCIrZi5wcmV0dHkoYSkrXCIpXCIpfX0saXNTaWduYXR1cmU6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLnJlYWRlci5pbmRleDt0aGlzLnJlYWRlci5zZXRJbmRleChhKTt2YXIgZD10aGlzLnJlYWRlci5yZWFkU3RyaW5nKDQpLGU9ZD09PWI7cmV0dXJuIHRoaXMucmVhZGVyLnNldEluZGV4KGMpLGV9LHJlYWRCbG9ja0VuZE9mQ2VudHJhbDpmdW5jdGlvbigpe3RoaXMuZGlza051bWJlcj10aGlzLnJlYWRlci5yZWFkSW50KDIpLHRoaXMuZGlza1dpdGhDZW50cmFsRGlyU3RhcnQ9dGhpcy5yZWFkZXIucmVhZEludCgyKSx0aGlzLmNlbnRyYWxEaXJSZWNvcmRzT25UaGlzRGlzaz10aGlzLnJlYWRlci5yZWFkSW50KDIpLHRoaXMuY2VudHJhbERpclJlY29yZHM9dGhpcy5yZWFkZXIucmVhZEludCgyKSx0aGlzLmNlbnRyYWxEaXJTaXplPXRoaXMucmVhZGVyLnJlYWRJbnQoNCksdGhpcy5jZW50cmFsRGlyT2Zmc2V0PXRoaXMucmVhZGVyLnJlYWRJbnQoNCksdGhpcy56aXBDb21tZW50TGVuZ3RoPXRoaXMucmVhZGVyLnJlYWRJbnQoMik7dmFyIGE9dGhpcy5yZWFkZXIucmVhZERhdGEodGhpcy56aXBDb21tZW50TGVuZ3RoKSxiPWkudWludDhhcnJheT9cInVpbnQ4YXJyYXlcIjpcImFycmF5XCIsYz1mLnRyYW5zZm9ybVRvKGIsYSk7dGhpcy56aXBDb21tZW50PXRoaXMubG9hZE9wdGlvbnMuZGVjb2RlRmlsZU5hbWUoYyl9LHJlYWRCbG9ja1ppcDY0RW5kT2ZDZW50cmFsOmZ1bmN0aW9uKCl7dGhpcy56aXA2NEVuZE9mQ2VudHJhbFNpemU9dGhpcy5yZWFkZXIucmVhZEludCg4KSx0aGlzLnJlYWRlci5za2lwKDQpLHRoaXMuZGlza051bWJlcj10aGlzLnJlYWRlci5yZWFkSW50KDQpLHRoaXMuZGlza1dpdGhDZW50cmFsRGlyU3RhcnQ9dGhpcy5yZWFkZXIucmVhZEludCg0KSx0aGlzLmNlbnRyYWxEaXJSZWNvcmRzT25UaGlzRGlzaz10aGlzLnJlYWRlci5yZWFkSW50KDgpLHRoaXMuY2VudHJhbERpclJlY29yZHM9dGhpcy5yZWFkZXIucmVhZEludCg4KSx0aGlzLmNlbnRyYWxEaXJTaXplPXRoaXMucmVhZGVyLnJlYWRJbnQoOCksdGhpcy5jZW50cmFsRGlyT2Zmc2V0PXRoaXMucmVhZGVyLnJlYWRJbnQoOCksdGhpcy56aXA2NEV4dGVuc2libGVEYXRhPXt9O2Zvcih2YXIgYSxiLGMsZD10aGlzLnppcDY0RW5kT2ZDZW50cmFsU2l6ZS00NCxlPTA7ZTxkOylhPXRoaXMucmVhZGVyLnJlYWRJbnQoMiksYj10aGlzLnJlYWRlci5yZWFkSW50KDQpLGM9dGhpcy5yZWFkZXIucmVhZERhdGEoYiksdGhpcy56aXA2NEV4dGVuc2libGVEYXRhW2FdPXtpZDphLGxlbmd0aDpiLHZhbHVlOmN9fSxyZWFkQmxvY2taaXA2NEVuZE9mQ2VudHJhbExvY2F0b3I6ZnVuY3Rpb24oKXtpZih0aGlzLmRpc2tXaXRoWmlwNjRDZW50cmFsRGlyU3RhcnQ9dGhpcy5yZWFkZXIucmVhZEludCg0KSx0aGlzLnJlbGF0aXZlT2Zmc2V0RW5kT2ZaaXA2NENlbnRyYWxEaXI9dGhpcy5yZWFkZXIucmVhZEludCg4KSx0aGlzLmRpc2tzQ291bnQ9dGhpcy5yZWFkZXIucmVhZEludCg0KSx0aGlzLmRpc2tzQ291bnQ+MSl0aHJvdyBuZXcgRXJyb3IoXCJNdWx0aS12b2x1bWVzIHppcCBhcmUgbm90IHN1cHBvcnRlZFwiKX0scmVhZExvY2FsRmlsZXM6ZnVuY3Rpb24oKXt2YXIgYSxiO2ZvcihhPTA7YTx0aGlzLmZpbGVzLmxlbmd0aDthKyspYj10aGlzLmZpbGVzW2FdLHRoaXMucmVhZGVyLnNldEluZGV4KGIubG9jYWxIZWFkZXJPZmZzZXQpLHRoaXMuY2hlY2tTaWduYXR1cmUoZy5MT0NBTF9GSUxFX0hFQURFUiksYi5yZWFkTG9jYWxQYXJ0KHRoaXMucmVhZGVyKSxiLmhhbmRsZVVURjgoKSxiLnByb2Nlc3NBdHRyaWJ1dGVzKCl9LHJlYWRDZW50cmFsRGlyOmZ1bmN0aW9uKCl7dmFyIGE7Zm9yKHRoaXMucmVhZGVyLnNldEluZGV4KHRoaXMuY2VudHJhbERpck9mZnNldCk7dGhpcy5yZWFkZXIucmVhZEFuZENoZWNrU2lnbmF0dXJlKGcuQ0VOVFJBTF9GSUxFX0hFQURFUik7KWE9bmV3IGgoe3ppcDY0OnRoaXMuemlwNjR9LHRoaXMubG9hZE9wdGlvbnMpLGEucmVhZENlbnRyYWxQYXJ0KHRoaXMucmVhZGVyKSx0aGlzLmZpbGVzLnB1c2goYSk7aWYodGhpcy5jZW50cmFsRGlyUmVjb3JkcyE9PXRoaXMuZmlsZXMubGVuZ3RoJiYwIT09dGhpcy5jZW50cmFsRGlyUmVjb3JkcyYmMD09PXRoaXMuZmlsZXMubGVuZ3RoKXRocm93IG5ldyBFcnJvcihcIkNvcnJ1cHRlZCB6aXAgb3IgYnVnOiBleHBlY3RlZCBcIit0aGlzLmNlbnRyYWxEaXJSZWNvcmRzK1wiIHJlY29yZHMgaW4gY2VudHJhbCBkaXIsIGdvdCBcIit0aGlzLmZpbGVzLmxlbmd0aCl9LHJlYWRFbmRPZkNlbnRyYWw6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLnJlYWRlci5sYXN0SW5kZXhPZlNpZ25hdHVyZShnLkNFTlRSQUxfRElSRUNUT1JZX0VORCk7aWYoYTwwKXt2YXIgYj0hdGhpcy5pc1NpZ25hdHVyZSgwLGcuTE9DQUxfRklMRV9IRUFERVIpO3Rocm93IGI/bmV3IEVycm9yKFwiQ2FuJ3QgZmluZCBlbmQgb2YgY2VudHJhbCBkaXJlY3RvcnkgOiBpcyB0aGlzIGEgemlwIGZpbGUgPyBJZiBpdCBpcywgc2VlIGh0dHBzOi8vc3R1ay5naXRodWIuaW8vanN6aXAvZG9jdW1lbnRhdGlvbi9ob3d0by9yZWFkX3ppcC5odG1sXCIpOm5ldyBFcnJvcihcIkNvcnJ1cHRlZCB6aXA6IGNhbid0IGZpbmQgZW5kIG9mIGNlbnRyYWwgZGlyZWN0b3J5XCIpfXRoaXMucmVhZGVyLnNldEluZGV4KGEpO3ZhciBjPWE7aWYodGhpcy5jaGVja1NpZ25hdHVyZShnLkNFTlRSQUxfRElSRUNUT1JZX0VORCksdGhpcy5yZWFkQmxvY2tFbmRPZkNlbnRyYWwoKSx0aGlzLmRpc2tOdW1iZXI9PT1mLk1BWF9WQUxVRV8xNkJJVFN8fHRoaXMuZGlza1dpdGhDZW50cmFsRGlyU3RhcnQ9PT1mLk1BWF9WQUxVRV8xNkJJVFN8fHRoaXMuY2VudHJhbERpclJlY29yZHNPblRoaXNEaXNrPT09Zi5NQVhfVkFMVUVfMTZCSVRTfHx0aGlzLmNlbnRyYWxEaXJSZWNvcmRzPT09Zi5NQVhfVkFMVUVfMTZCSVRTfHx0aGlzLmNlbnRyYWxEaXJTaXplPT09Zi5NQVhfVkFMVUVfMzJCSVRTfHx0aGlzLmNlbnRyYWxEaXJPZmZzZXQ9PT1mLk1BWF9WQUxVRV8zMkJJVFMpe2lmKHRoaXMuemlwNjQ9ITAsYT10aGlzLnJlYWRlci5sYXN0SW5kZXhPZlNpZ25hdHVyZShnLlpJUDY0X0NFTlRSQUxfRElSRUNUT1JZX0xPQ0FUT1IpLGE8MCl0aHJvdyBuZXcgRXJyb3IoXCJDb3JydXB0ZWQgemlwOiBjYW4ndCBmaW5kIHRoZSBaSVA2NCBlbmQgb2YgY2VudHJhbCBkaXJlY3RvcnkgbG9jYXRvclwiKTtpZih0aGlzLnJlYWRlci5zZXRJbmRleChhKSx0aGlzLmNoZWNrU2lnbmF0dXJlKGcuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfTE9DQVRPUiksdGhpcy5yZWFkQmxvY2taaXA2NEVuZE9mQ2VudHJhbExvY2F0b3IoKSwhdGhpcy5pc1NpZ25hdHVyZSh0aGlzLnJlbGF0aXZlT2Zmc2V0RW5kT2ZaaXA2NENlbnRyYWxEaXIsZy5aSVA2NF9DRU5UUkFMX0RJUkVDVE9SWV9FTkQpJiYodGhpcy5yZWxhdGl2ZU9mZnNldEVuZE9mWmlwNjRDZW50cmFsRGlyPXRoaXMucmVhZGVyLmxhc3RJbmRleE9mU2lnbmF0dXJlKGcuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfRU5EKSx0aGlzLnJlbGF0aXZlT2Zmc2V0RW5kT2ZaaXA2NENlbnRyYWxEaXI8MCkpdGhyb3cgbmV3IEVycm9yKFwiQ29ycnVwdGVkIHppcDogY2FuJ3QgZmluZCB0aGUgWklQNjQgZW5kIG9mIGNlbnRyYWwgZGlyZWN0b3J5XCIpO3RoaXMucmVhZGVyLnNldEluZGV4KHRoaXMucmVsYXRpdmVPZmZzZXRFbmRPZlppcDY0Q2VudHJhbERpciksdGhpcy5jaGVja1NpZ25hdHVyZShnLlpJUDY0X0NFTlRSQUxfRElSRUNUT1JZX0VORCksdGhpcy5yZWFkQmxvY2taaXA2NEVuZE9mQ2VudHJhbCgpfXZhciBkPXRoaXMuY2VudHJhbERpck9mZnNldCt0aGlzLmNlbnRyYWxEaXJTaXplO3RoaXMuemlwNjQmJihkKz0yMCxkKz0xMit0aGlzLnppcDY0RW5kT2ZDZW50cmFsU2l6ZSk7dmFyIGU9Yy1kO2lmKGU+MCl0aGlzLmlzU2lnbmF0dXJlKGMsZy5DRU5UUkFMX0ZJTEVfSEVBREVSKXx8KHRoaXMucmVhZGVyLnplcm89ZSk7ZWxzZSBpZihlPDApdGhyb3cgbmV3IEVycm9yKFwiQ29ycnVwdGVkIHppcDogbWlzc2luZyBcIitNYXRoLmFicyhlKStcIiBieXRlcy5cIil9LHByZXBhcmVSZWFkZXI6ZnVuY3Rpb24oYSl7dGhpcy5yZWFkZXI9ZShhKX0sbG9hZDpmdW5jdGlvbihhKXt0aGlzLnByZXBhcmVSZWFkZXIoYSksdGhpcy5yZWFkRW5kT2ZDZW50cmFsKCksdGhpcy5yZWFkQ2VudHJhbERpcigpLHRoaXMucmVhZExvY2FsRmlsZXMoKX19LGIuZXhwb3J0cz1kfSx7XCIuL3JlYWRlci9yZWFkZXJGb3JcIjoyMixcIi4vc2lnbmF0dXJlXCI6MjMsXCIuL3N1cHBvcnRcIjozMCxcIi4vdXRmOFwiOjMxLFwiLi91dGlsc1wiOjMyLFwiLi96aXBFbnRyeVwiOjM0fV0sMzQ6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEsYil7dGhpcy5vcHRpb25zPWEsdGhpcy5sb2FkT3B0aW9ucz1ifXZhciBlPWEoXCIuL3JlYWRlci9yZWFkZXJGb3JcIiksZj1hKFwiLi91dGlsc1wiKSxnPWEoXCIuL2NvbXByZXNzZWRPYmplY3RcIiksaD1hKFwiLi9jcmMzMlwiKSxpPWEoXCIuL3V0ZjhcIiksaj1hKFwiLi9jb21wcmVzc2lvbnNcIiksaz1hKFwiLi9zdXBwb3J0XCIpLGw9MCxtPTMsbj1mdW5jdGlvbihhKXtmb3IodmFyIGIgaW4gailpZihqLmhhc093blByb3BlcnR5KGIpJiZqW2JdLm1hZ2ljPT09YSlyZXR1cm4galtiXTtyZXR1cm4gbnVsbH07ZC5wcm90b3R5cGU9e2lzRW5jcnlwdGVkOmZ1bmN0aW9uKCl7cmV0dXJuIDE9PT0oMSZ0aGlzLmJpdEZsYWcpfSx1c2VVVEY4OmZ1bmN0aW9uKCl7cmV0dXJuIDIwNDg9PT0oMjA0OCZ0aGlzLmJpdEZsYWcpfSxyZWFkTG9jYWxQYXJ0OmZ1bmN0aW9uKGEpe3ZhciBiLGM7aWYoYS5za2lwKDIyKSx0aGlzLmZpbGVOYW1lTGVuZ3RoPWEucmVhZEludCgyKSxjPWEucmVhZEludCgyKSx0aGlzLmZpbGVOYW1lPWEucmVhZERhdGEodGhpcy5maWxlTmFtZUxlbmd0aCksYS5za2lwKGMpLHRoaXMuY29tcHJlc3NlZFNpemU9PT0tMXx8dGhpcy51bmNvbXByZXNzZWRTaXplPT09LTEpdGhyb3cgbmV3IEVycm9yKFwiQnVnIG9yIGNvcnJ1cHRlZCB6aXAgOiBkaWRuJ3QgZ2V0IGVub3VnaCBpbmZvcm1hdGlvbnMgZnJvbSB0aGUgY2VudHJhbCBkaXJlY3RvcnkgKGNvbXByZXNzZWRTaXplID09PSAtMSB8fCB1bmNvbXByZXNzZWRTaXplID09PSAtMSlcIik7aWYoYj1uKHRoaXMuY29tcHJlc3Npb25NZXRob2QpLG51bGw9PT1iKXRocm93IG5ldyBFcnJvcihcIkNvcnJ1cHRlZCB6aXAgOiBjb21wcmVzc2lvbiBcIitmLnByZXR0eSh0aGlzLmNvbXByZXNzaW9uTWV0aG9kKStcIiB1bmtub3duIChpbm5lciBmaWxlIDogXCIrZi50cmFuc2Zvcm1UbyhcInN0cmluZ1wiLHRoaXMuZmlsZU5hbWUpK1wiKVwiKTt0aGlzLmRlY29tcHJlc3NlZD1uZXcgZyh0aGlzLmNvbXByZXNzZWRTaXplLHRoaXMudW5jb21wcmVzc2VkU2l6ZSx0aGlzLmNyYzMyLGIsYS5yZWFkRGF0YSh0aGlzLmNvbXByZXNzZWRTaXplKSl9LHJlYWRDZW50cmFsUGFydDpmdW5jdGlvbihhKXt0aGlzLnZlcnNpb25NYWRlQnk9YS5yZWFkSW50KDIpLGEuc2tpcCgyKSx0aGlzLmJpdEZsYWc9YS5yZWFkSW50KDIpLHRoaXMuY29tcHJlc3Npb25NZXRob2Q9YS5yZWFkU3RyaW5nKDIpLHRoaXMuZGF0ZT1hLnJlYWREYXRlKCksdGhpcy5jcmMzMj1hLnJlYWRJbnQoNCksdGhpcy5jb21wcmVzc2VkU2l6ZT1hLnJlYWRJbnQoNCksdGhpcy51bmNvbXByZXNzZWRTaXplPWEucmVhZEludCg0KTt2YXIgYj1hLnJlYWRJbnQoMik7aWYodGhpcy5leHRyYUZpZWxkc0xlbmd0aD1hLnJlYWRJbnQoMiksdGhpcy5maWxlQ29tbWVudExlbmd0aD1hLnJlYWRJbnQoMiksdGhpcy5kaXNrTnVtYmVyU3RhcnQ9YS5yZWFkSW50KDIpLHRoaXMuaW50ZXJuYWxGaWxlQXR0cmlidXRlcz1hLnJlYWRJbnQoMiksdGhpcy5leHRlcm5hbEZpbGVBdHRyaWJ1dGVzPWEucmVhZEludCg0KSx0aGlzLmxvY2FsSGVhZGVyT2Zmc2V0PWEucmVhZEludCg0KSx0aGlzLmlzRW5jcnlwdGVkKCkpdGhyb3cgbmV3IEVycm9yKFwiRW5jcnlwdGVkIHppcCBhcmUgbm90IHN1cHBvcnRlZFwiKTthLnNraXAoYiksdGhpcy5yZWFkRXh0cmFGaWVsZHMoYSksdGhpcy5wYXJzZVpJUDY0RXh0cmFGaWVsZChhKSx0aGlzLmZpbGVDb21tZW50PWEucmVhZERhdGEodGhpcy5maWxlQ29tbWVudExlbmd0aCl9LHByb2Nlc3NBdHRyaWJ1dGVzOmZ1bmN0aW9uKCl7dGhpcy51bml4UGVybWlzc2lvbnM9bnVsbCx0aGlzLmRvc1Blcm1pc3Npb25zPW51bGw7dmFyIGE9dGhpcy52ZXJzaW9uTWFkZUJ5Pj44O3RoaXMuZGlyPSEhKDE2JnRoaXMuZXh0ZXJuYWxGaWxlQXR0cmlidXRlcyksYT09PWwmJih0aGlzLmRvc1Blcm1pc3Npb25zPTYzJnRoaXMuZXh0ZXJuYWxGaWxlQXR0cmlidXRlcyksYT09PW0mJih0aGlzLnVuaXhQZXJtaXNzaW9ucz10aGlzLmV4dGVybmFsRmlsZUF0dHJpYnV0ZXM+PjE2JjY1NTM1KSx0aGlzLmRpcnx8XCIvXCIhPT10aGlzLmZpbGVOYW1lU3RyLnNsaWNlKC0xKXx8KHRoaXMuZGlyPSEwKX0scGFyc2VaSVA2NEV4dHJhRmllbGQ6ZnVuY3Rpb24oYSl7aWYodGhpcy5leHRyYUZpZWxkc1sxXSl7dmFyIGI9ZSh0aGlzLmV4dHJhRmllbGRzWzFdLnZhbHVlKTt0aGlzLnVuY29tcHJlc3NlZFNpemU9PT1mLk1BWF9WQUxVRV8zMkJJVFMmJih0aGlzLnVuY29tcHJlc3NlZFNpemU9Yi5yZWFkSW50KDgpKSx0aGlzLmNvbXByZXNzZWRTaXplPT09Zi5NQVhfVkFMVUVfMzJCSVRTJiYodGhpcy5jb21wcmVzc2VkU2l6ZT1iLnJlYWRJbnQoOCkpLHRoaXMubG9jYWxIZWFkZXJPZmZzZXQ9PT1mLk1BWF9WQUxVRV8zMkJJVFMmJih0aGlzLmxvY2FsSGVhZGVyT2Zmc2V0PWIucmVhZEludCg4KSksdGhpcy5kaXNrTnVtYmVyU3RhcnQ9PT1mLk1BWF9WQUxVRV8zMkJJVFMmJih0aGlzLmRpc2tOdW1iZXJTdGFydD1iLnJlYWRJbnQoNCkpfX0scmVhZEV4dHJhRmllbGRzOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlPWEuaW5kZXgrdGhpcy5leHRyYUZpZWxkc0xlbmd0aDtmb3IodGhpcy5leHRyYUZpZWxkc3x8KHRoaXMuZXh0cmFGaWVsZHM9e30pO2EuaW5kZXg8ZTspYj1hLnJlYWRJbnQoMiksYz1hLnJlYWRJbnQoMiksZD1hLnJlYWREYXRhKGMpLHRoaXMuZXh0cmFGaWVsZHNbYl09e2lkOmIsbGVuZ3RoOmMsdmFsdWU6ZH19LGhhbmRsZVVURjg6ZnVuY3Rpb24oKXt2YXIgYT1rLnVpbnQ4YXJyYXk/XCJ1aW50OGFycmF5XCI6XCJhcnJheVwiO2lmKHRoaXMudXNlVVRGOCgpKXRoaXMuZmlsZU5hbWVTdHI9aS51dGY4ZGVjb2RlKHRoaXMuZmlsZU5hbWUpLHRoaXMuZmlsZUNvbW1lbnRTdHI9aS51dGY4ZGVjb2RlKHRoaXMuZmlsZUNvbW1lbnQpO2Vsc2V7dmFyIGI9dGhpcy5maW5kRXh0cmFGaWVsZFVuaWNvZGVQYXRoKCk7aWYobnVsbCE9PWIpdGhpcy5maWxlTmFtZVN0cj1iO2Vsc2V7dmFyIGM9Zi50cmFuc2Zvcm1UbyhhLHRoaXMuZmlsZU5hbWUpO3RoaXMuZmlsZU5hbWVTdHI9dGhpcy5sb2FkT3B0aW9ucy5kZWNvZGVGaWxlTmFtZShjKX12YXIgZD10aGlzLmZpbmRFeHRyYUZpZWxkVW5pY29kZUNvbW1lbnQoKTtpZihudWxsIT09ZCl0aGlzLmZpbGVDb21tZW50U3RyPWQ7ZWxzZXt2YXIgZT1mLnRyYW5zZm9ybVRvKGEsdGhpcy5maWxlQ29tbWVudCk7dGhpcy5maWxlQ29tbWVudFN0cj10aGlzLmxvYWRPcHRpb25zLmRlY29kZUZpbGVOYW1lKGUpfX19LGZpbmRFeHRyYUZpZWxkVW5pY29kZVBhdGg6ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmV4dHJhRmllbGRzWzI4Nzg5XTtpZihhKXt2YXIgYj1lKGEudmFsdWUpO3JldHVybiAxIT09Yi5yZWFkSW50KDEpP251bGw6aCh0aGlzLmZpbGVOYW1lKSE9PWIucmVhZEludCg0KT9udWxsOmkudXRmOGRlY29kZShiLnJlYWREYXRhKGEubGVuZ3RoLTUpKX1yZXR1cm4gbnVsbH0sZmluZEV4dHJhRmllbGRVbmljb2RlQ29tbWVudDpmdW5jdGlvbigpe3ZhciBhPXRoaXMuZXh0cmFGaWVsZHNbMjU0NjFdO2lmKGEpe3ZhciBiPWUoYS52YWx1ZSk7cmV0dXJuIDEhPT1iLnJlYWRJbnQoMSk/bnVsbDpoKHRoaXMuZmlsZUNvbW1lbnQpIT09Yi5yZWFkSW50KDQpP251bGw6aS51dGY4ZGVjb2RlKGIucmVhZERhdGEoYS5sZW5ndGgtNSkpfXJldHVybiBudWxsfX0sYi5leHBvcnRzPWR9LHtcIi4vY29tcHJlc3NlZE9iamVjdFwiOjIsXCIuL2NvbXByZXNzaW9uc1wiOjMsXCIuL2NyYzMyXCI6NCxcIi4vcmVhZGVyL3JlYWRlckZvclwiOjIyLFwiLi9zdXBwb3J0XCI6MzAsXCIuL3V0ZjhcIjozMSxcIi4vdXRpbHNcIjozMn1dLDM1OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGQ9YShcIi4vc3RyZWFtL1N0cmVhbUhlbHBlclwiKSxlPWEoXCIuL3N0cmVhbS9EYXRhV29ya2VyXCIpLGY9YShcIi4vdXRmOFwiKSxnPWEoXCIuL2NvbXByZXNzZWRPYmplY3RcIiksaD1hKFwiLi9zdHJlYW0vR2VuZXJpY1dvcmtlclwiKSxpPWZ1bmN0aW9uKGEsYixjKXt0aGlzLm5hbWU9YSx0aGlzLmRpcj1jLmRpcix0aGlzLmRhdGU9Yy5kYXRlLHRoaXMuY29tbWVudD1jLmNvbW1lbnQsdGhpcy51bml4UGVybWlzc2lvbnM9Yy51bml4UGVybWlzc2lvbnMsdGhpcy5kb3NQZXJtaXNzaW9ucz1jLmRvc1Blcm1pc3Npb25zLHRoaXMuX2RhdGE9Yix0aGlzLl9kYXRhQmluYXJ5PWMuYmluYXJ5LHRoaXMub3B0aW9ucz17Y29tcHJlc3Npb246Yy5jb21wcmVzc2lvbixjb21wcmVzc2lvbk9wdGlvbnM6Yy5jb21wcmVzc2lvbk9wdGlvbnN9fTtpLnByb3RvdHlwZT17aW50ZXJuYWxTdHJlYW06ZnVuY3Rpb24oYSl7dmFyIGI9bnVsbCxjPVwic3RyaW5nXCI7dHJ5e2lmKCFhKXRocm93IG5ldyBFcnJvcihcIk5vIG91dHB1dCB0eXBlIHNwZWNpZmllZC5cIik7Yz1hLnRvTG93ZXJDYXNlKCk7dmFyIGU9XCJzdHJpbmdcIj09PWN8fFwidGV4dFwiPT09YztcImJpbmFyeXN0cmluZ1wiIT09YyYmXCJ0ZXh0XCIhPT1jfHwoYz1cInN0cmluZ1wiKSxiPXRoaXMuX2RlY29tcHJlc3NXb3JrZXIoKTt2YXIgZz0hdGhpcy5fZGF0YUJpbmFyeTtnJiYhZSYmKGI9Yi5waXBlKG5ldyBmLlV0ZjhFbmNvZGVXb3JrZXIpKSwhZyYmZSYmKGI9Yi5waXBlKG5ldyBmLlV0ZjhEZWNvZGVXb3JrZXIpKX1jYXRjaChpKXtiPW5ldyBoKFwiZXJyb3JcIiksYi5lcnJvcihpKX1yZXR1cm4gbmV3IGQoYixjLFwiXCIpfSxhc3luYzpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmludGVybmFsU3RyZWFtKGEpLmFjY3VtdWxhdGUoYil9LG5vZGVTdHJlYW06ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5pbnRlcm5hbFN0cmVhbShhfHxcIm5vZGVidWZmZXJcIikudG9Ob2RlanNTdHJlYW0oYil9LF9jb21wcmVzc1dvcmtlcjpmdW5jdGlvbihhLGIpe2lmKHRoaXMuX2RhdGEgaW5zdGFuY2VvZiBnJiZ0aGlzLl9kYXRhLmNvbXByZXNzaW9uLm1hZ2ljPT09YS5tYWdpYylyZXR1cm4gdGhpcy5fZGF0YS5nZXRDb21wcmVzc2VkV29ya2VyKCk7dmFyIGM9dGhpcy5fZGVjb21wcmVzc1dvcmtlcigpO3JldHVybiB0aGlzLl9kYXRhQmluYXJ5fHwoYz1jLnBpcGUobmV3IGYuVXRmOEVuY29kZVdvcmtlcikpLGcuY3JlYXRlV29ya2VyRnJvbShjLGEsYil9LF9kZWNvbXByZXNzV29ya2VyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RhdGEgaW5zdGFuY2VvZiBnP3RoaXMuX2RhdGEuZ2V0Q29udGVudFdvcmtlcigpOnRoaXMuX2RhdGEgaW5zdGFuY2VvZiBoP3RoaXMuX2RhdGE6bmV3IGUodGhpcy5fZGF0YSl9fTtmb3IodmFyIGo9W1wiYXNUZXh0XCIsXCJhc0JpbmFyeVwiLFwiYXNOb2RlQnVmZmVyXCIsXCJhc1VpbnQ4QXJyYXlcIixcImFzQXJyYXlCdWZmZXJcIl0saz1mdW5jdGlvbigpe3Rocm93IG5ldyBFcnJvcihcIlRoaXMgbWV0aG9kIGhhcyBiZWVuIHJlbW92ZWQgaW4gSlNaaXAgMy4wLCBwbGVhc2UgY2hlY2sgdGhlIHVwZ3JhZGUgZ3VpZGUuXCIpfSxsPTA7bDxqLmxlbmd0aDtsKyspaS5wcm90b3R5cGVbaltsXV09aztiLmV4cG9ydHM9aX0se1wiLi9jb21wcmVzc2VkT2JqZWN0XCI6MixcIi4vc3RyZWFtL0RhdGFXb3JrZXJcIjoyNyxcIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXJcIjoyOCxcIi4vc3RyZWFtL1N0cmVhbUhlbHBlclwiOjI5LFwiLi91dGY4XCI6MzF9XSwzNjpbZnVuY3Rpb24oYSxiLGMpe2EoXCIuLi9tb2R1bGVzL3dlYi5pbW1lZGlhdGVcIiksYi5leHBvcnRzPWEoXCIuLi9tb2R1bGVzL19jb3JlXCIpLnNldEltbWVkaWF0ZX0se1wiLi4vbW9kdWxlcy9fY29yZVwiOjQwLFwiLi4vbW9kdWxlcy93ZWIuaW1tZWRpYXRlXCI6NTZ9XSwzNzpbZnVuY3Rpb24oYSxiLGMpe2IuZXhwb3J0cz1mdW5jdGlvbihhKXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBhKXRocm93IFR5cGVFcnJvcihhK1wiIGlzIG5vdCBhIGZ1bmN0aW9uIVwiKTtyZXR1cm4gYX19LHt9XSwzODpbZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWEoXCIuL19pcy1vYmplY3RcIik7Yi5leHBvcnRzPWZ1bmN0aW9uKGEpe2lmKCFkKGEpKXRocm93IFR5cGVFcnJvcihhK1wiIGlzIG5vdCBhbiBvYmplY3QhXCIpO3JldHVybiBhfX0se1wiLi9faXMtb2JqZWN0XCI6NTF9XSwzOTpbZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXt9LnRvU3RyaW5nO2IuZXhwb3J0cz1mdW5jdGlvbihhKXtyZXR1cm4gZC5jYWxsKGEpLnNsaWNlKDgsLTEpfX0se31dLDQwOltmdW5jdGlvbihhLGIsYyl7dmFyIGQ9Yi5leHBvcnRzPXt2ZXJzaW9uOlwiMi4zLjBcIn07XCJudW1iZXJcIj09dHlwZW9mIF9fZSYmKF9fZT1kKX0se31dLDQxOltmdW5jdGlvbihhLGIsYyl7dmFyIGQ9YShcIi4vX2EtZnVuY3Rpb25cIik7Yi5leHBvcnRzPWZ1bmN0aW9uKGEsYixjKXtpZihkKGEpLHZvaWQgMD09PWIpcmV0dXJuIGE7c3dpdGNoKGMpe2Nhc2UgMTpyZXR1cm4gZnVuY3Rpb24oYyl7cmV0dXJuIGEuY2FsbChiLGMpfTtjYXNlIDI6cmV0dXJuIGZ1bmN0aW9uKGMsZCl7cmV0dXJuIGEuY2FsbChiLGMsZCl9O2Nhc2UgMzpyZXR1cm4gZnVuY3Rpb24oYyxkLGUpe3JldHVybiBhLmNhbGwoYixjLGQsZSl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGIsYXJndW1lbnRzKX19fSx7XCIuL19hLWZ1bmN0aW9uXCI6Mzd9XSw0MjpbZnVuY3Rpb24oYSxiLGMpe2IuZXhwb3J0cz0hYShcIi4vX2ZhaWxzXCIpKGZ1bmN0aW9uKCl7cmV0dXJuIDchPU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSxcImFcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDd9fSkuYX0pfSx7XCIuL19mYWlsc1wiOjQ1fV0sNDM6W2Z1bmN0aW9uKGEsYixjKXt2YXIgZD1hKFwiLi9faXMtb2JqZWN0XCIpLGU9YShcIi4vX2dsb2JhbFwiKS5kb2N1bWVudCxmPWQoZSkmJmQoZS5jcmVhdGVFbGVtZW50KTtiLmV4cG9ydHM9ZnVuY3Rpb24oYSl7cmV0dXJuIGY/ZS5jcmVhdGVFbGVtZW50KGEpOnt9fX0se1wiLi9fZ2xvYmFsXCI6NDYsXCIuL19pcy1vYmplY3RcIjo1MX1dLDQ0OltmdW5jdGlvbihhLGIsYyl7dmFyIGQ9YShcIi4vX2dsb2JhbFwiKSxlPWEoXCIuL19jb3JlXCIpLGY9YShcIi4vX2N0eFwiKSxnPWEoXCIuL19oaWRlXCIpLGg9XCJwcm90b3R5cGVcIixpPWZ1bmN0aW9uKGEsYixjKXt2YXIgaixrLGwsbT1hJmkuRixuPWEmaS5HLG89YSZpLlMscD1hJmkuUCxxPWEmaS5CLHI9YSZpLlcscz1uP2U6ZVtiXXx8KGVbYl09e30pLHQ9c1toXSx1PW4/ZDpvP2RbYl06KGRbYl18fHt9KVtoXTtuJiYoYz1iKTtmb3IoaiBpbiBjKWs9IW0mJnUmJnZvaWQgMCE9PXVbal0sayYmaiBpbiBzfHwobD1rP3Vbal06Y1tqXSxzW2pdPW4mJlwiZnVuY3Rpb25cIiE9dHlwZW9mIHVbal0/Y1tqXTpxJiZrP2YobCxkKTpyJiZ1W2pdPT1sP2Z1bmN0aW9uKGEpe3ZhciBiPWZ1bmN0aW9uKGIsYyxkKXtpZih0aGlzIGluc3RhbmNlb2YgYSl7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMDpyZXR1cm4gbmV3IGE7Y2FzZSAxOnJldHVybiBuZXcgYShiKTtjYXNlIDI6cmV0dXJuIG5ldyBhKGIsYyl9cmV0dXJuIG5ldyBhKGIsYyxkKX1yZXR1cm4gYS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O3JldHVybiBiW2hdPWFbaF0sYn0obCk6cCYmXCJmdW5jdGlvblwiPT10eXBlb2YgbD9mKEZ1bmN0aW9uLmNhbGwsbCk6bCxwJiYoKHMudmlydHVhbHx8KHMudmlydHVhbD17fSkpW2pdPWwsYSZpLlImJnQmJiF0W2pdJiZnKHQsaixsKSkpfTtpLkY9MSxpLkc9MixpLlM9NCxpLlA9OCxpLkI9MTYsaS5XPTMyLGkuVT02NCxpLlI9MTI4LGIuZXhwb3J0cz1pfSx7XCIuL19jb3JlXCI6NDAsXCIuL19jdHhcIjo0MSxcIi4vX2dsb2JhbFwiOjQ2LFwiLi9faGlkZVwiOjQ3fV0sNDU6W2Z1bmN0aW9uKGEsYixjKXtiLmV4cG9ydHM9ZnVuY3Rpb24oYSl7dHJ5e3JldHVybiEhYSgpfWNhdGNoKGIpe3JldHVybiEwfX19LHt9XSw0NjpbZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWIuZXhwb3J0cz1cInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93JiZ3aW5kb3cuTWF0aD09TWF0aD93aW5kb3c6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHNlbGYmJnNlbGYuTWF0aD09TWF0aD9zZWxmOkZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKTtcIm51bWJlclwiPT10eXBlb2YgX19nJiYoX19nPWQpfSx7fV0sNDc6W2Z1bmN0aW9uKGEsYixjKXt2YXIgZD1hKFwiLi9fb2JqZWN0LWRwXCIpLGU9YShcIi4vX3Byb3BlcnR5LWRlc2NcIik7Yi5leHBvcnRzPWEoXCIuL19kZXNjcmlwdG9yc1wiKT9mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGQuZihhLGIsZSgxLGMpKX06ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBhW2JdPWMsYX19LHtcIi4vX2Rlc2NyaXB0b3JzXCI6NDIsXCIuL19vYmplY3QtZHBcIjo1MixcIi4vX3Byb3BlcnR5LWRlc2NcIjo1M31dLDQ4OltmdW5jdGlvbihhLGIsYyl7Yi5leHBvcnRzPWEoXCIuL19nbG9iYWxcIikuZG9jdW1lbnQmJmRvY3VtZW50LmRvY3VtZW50RWxlbWVudH0se1wiLi9fZ2xvYmFsXCI6NDZ9XSw0OTpbZnVuY3Rpb24oYSxiLGMpe2IuZXhwb3J0cz0hYShcIi4vX2Rlc2NyaXB0b3JzXCIpJiYhYShcIi4vX2ZhaWxzXCIpKGZ1bmN0aW9uKCl7cmV0dXJuIDchPU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhKFwiLi9fZG9tLWNyZWF0ZVwiKShcImRpdlwiKSxcImFcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDd9fSkuYX0pfSx7XCIuL19kZXNjcmlwdG9yc1wiOjQyLFwiLi9fZG9tLWNyZWF0ZVwiOjQzLFwiLi9fZmFpbHNcIjo0NX1dLDUwOltmdW5jdGlvbihhLGIsYyl7Yi5leHBvcnRzPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD12b2lkIDA9PT1jO3N3aXRjaChiLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBkP2EoKTphLmNhbGwoYyk7Y2FzZSAxOnJldHVybiBkP2EoYlswXSk6YS5jYWxsKGMsYlswXSk7Y2FzZSAyOnJldHVybiBkP2EoYlswXSxiWzFdKTphLmNhbGwoYyxiWzBdLGJbMV0pO2Nhc2UgMzpyZXR1cm4gZD9hKGJbMF0sYlsxXSxiWzJdKTphLmNhbGwoYyxiWzBdLGJbMV0sYlsyXSk7Y2FzZSA0OnJldHVybiBkP2EoYlswXSxiWzFdLGJbMl0sYlszXSk6YS5jYWxsKGMsYlswXSxiWzFdLGJbMl0sYlszXSl9cmV0dXJuIGEuYXBwbHkoYyxiKX19LHt9XSw1MTpbZnVuY3Rpb24oYSxiLGMpe2IuZXhwb3J0cz1mdW5jdGlvbihhKXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgYT9udWxsIT09YTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBhfX0se31dLDUyOltmdW5jdGlvbihhLGIsYyl7dmFyIGQ9YShcIi4vX2FuLW9iamVjdFwiKSxlPWEoXCIuL19pZTgtZG9tLWRlZmluZVwiKSxmPWEoXCIuL190by1wcmltaXRpdmVcIiksZz1PYmplY3QuZGVmaW5lUHJvcGVydHk7Yy5mPWEoXCIuL19kZXNjcmlwdG9yc1wiKT9PYmplY3QuZGVmaW5lUHJvcGVydHk6ZnVuY3Rpb24oYSxiLGMpe2lmKGQoYSksYj1mKGIsITApLGQoYyksZSl0cnl7cmV0dXJuIGcoYSxiLGMpfWNhdGNoKGgpe31pZihcImdldFwiaW4gY3x8XCJzZXRcImluIGMpdGhyb3cgVHlwZUVycm9yKFwiQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhXCIpO3JldHVyblwidmFsdWVcImluIGMmJihhW2JdPWMudmFsdWUpLGF9fSx7XCIuL19hbi1vYmplY3RcIjozOCxcIi4vX2Rlc2NyaXB0b3JzXCI6NDIsXCIuL19pZTgtZG9tLWRlZmluZVwiOjQ5LFwiLi9fdG8tcHJpbWl0aXZlXCI6NTV9XSw1MzpbZnVuY3Rpb24oYSxiLGMpe2IuZXhwb3J0cz1mdW5jdGlvbihhLGIpe3JldHVybntlbnVtZXJhYmxlOiEoMSZhKSxjb25maWd1cmFibGU6ISgyJmEpLHdyaXRhYmxlOiEoNCZhKSx2YWx1ZTpifX19LHt9XSw1NDpbZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnPWEoXCIuL19jdHhcIiksaD1hKFwiLi9faW52b2tlXCIpLGk9YShcIi4vX2h0bWxcIiksaj1hKFwiLi9fZG9tLWNyZWF0ZVwiKSxrPWEoXCIuL19nbG9iYWxcIiksbD1rLnByb2Nlc3MsbT1rLnNldEltbWVkaWF0ZSxuPWsuY2xlYXJJbW1lZGlhdGUsbz1rLk1lc3NhZ2VDaGFubmVsLHA9MCxxPXt9LHI9XCJvbnJlYWR5c3RhdGVjaGFuZ2VcIixzPWZ1bmN0aW9uKCl7dmFyIGE9K3RoaXM7aWYocS5oYXNPd25Qcm9wZXJ0eShhKSl7dmFyIGI9cVthXTtkZWxldGUgcVthXSxiKCl9fSx0PWZ1bmN0aW9uKGEpe3MuY2FsbChhLmRhdGEpfTttJiZufHwobT1mdW5jdGlvbihhKXtmb3IodmFyIGI9W10sYz0xO2FyZ3VtZW50cy5sZW5ndGg+YzspYi5wdXNoKGFyZ3VtZW50c1tjKytdKTtyZXR1cm4gcVsrK3BdPWZ1bmN0aW9uKCl7aChcImZ1bmN0aW9uXCI9PXR5cGVvZiBhP2E6RnVuY3Rpb24oYSksYil9LGQocCkscH0sbj1mdW5jdGlvbihhKXtkZWxldGUgcVthXX0sXCJwcm9jZXNzXCI9PWEoXCIuL19jb2ZcIikobCk/ZD1mdW5jdGlvbihhKXtsLm5leHRUaWNrKGcocyxhLDEpKX06bz8oZT1uZXcgbyxmPWUucG9ydDIsZS5wb3J0MS5vbm1lc3NhZ2U9dCxkPWcoZi5wb3N0TWVzc2FnZSxmLDEpKTprLmFkZEV2ZW50TGlzdGVuZXImJlwiZnVuY3Rpb25cIj09dHlwZW9mIHBvc3RNZXNzYWdlJiYhay5pbXBvcnRTY3JpcHRzPyhkPWZ1bmN0aW9uKGEpe2sucG9zdE1lc3NhZ2UoYStcIlwiLFwiKlwiKX0say5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLHQsITEpKTpkPXIgaW4gaihcInNjcmlwdFwiKT9mdW5jdGlvbihhKXtpLmFwcGVuZENoaWxkKGooXCJzY3JpcHRcIikpW3JdPWZ1bmN0aW9uKCl7aS5yZW1vdmVDaGlsZCh0aGlzKSxzLmNhbGwoYSl9fTpmdW5jdGlvbihhKXtzZXRUaW1lb3V0KGcocyxhLDEpLDApfSksYi5leHBvcnRzPXtzZXQ6bSxjbGVhcjpufX0se1wiLi9fY29mXCI6MzksXCIuL19jdHhcIjo0MSxcIi4vX2RvbS1jcmVhdGVcIjo0MyxcIi4vX2dsb2JhbFwiOjQ2LFwiLi9faHRtbFwiOjQ4LFwiLi9faW52b2tlXCI6NTB9XSw1NTpbZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWEoXCIuL19pcy1vYmplY3RcIik7Yi5leHBvcnRzPWZ1bmN0aW9uKGEsYil7aWYoIWQoYSkpcmV0dXJuIGE7dmFyIGMsZTtpZihiJiZcImZ1bmN0aW9uXCI9PXR5cGVvZihjPWEudG9TdHJpbmcpJiYhZChlPWMuY2FsbChhKSkpcmV0dXJuIGU7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YoYz1hLnZhbHVlT2YpJiYhZChlPWMuY2FsbChhKSkpcmV0dXJuIGU7aWYoIWImJlwiZnVuY3Rpb25cIj09dHlwZW9mKGM9YS50b1N0cmluZykmJiFkKGU9Yy5jYWxsKGEpKSlyZXR1cm4gZTt0aHJvdyBUeXBlRXJyb3IoXCJDYW4ndCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWVcIil9fSx7XCIuL19pcy1vYmplY3RcIjo1MX1dLDU2OltmdW5jdGlvbihhLGIsYyl7dmFyIGQ9YShcIi4vX2V4cG9ydFwiKSxlPWEoXCIuL190YXNrXCIpO2QoZC5HK2QuQix7c2V0SW1tZWRpYXRlOmUuc2V0LGNsZWFySW1tZWRpYXRlOmUuY2xlYXJ9KX0se1wiLi9fZXhwb3J0XCI6NDQsXCIuL190YXNrXCI6NTR9XSw1NzpbZnVuY3Rpb24oYSxiLGMpeyhmdW5jdGlvbihhKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBjKCl7az0hMDtmb3IodmFyIGEsYixjPWwubGVuZ3RoO2M7KXtmb3IoYj1sLGw9W10sYT0tMTsrK2E8YzspYlthXSgpO2M9bC5sZW5ndGh9az0hMX1mdW5jdGlvbiBkKGEpezEhPT1sLnB1c2goYSl8fGt8fGUoKX12YXIgZSxmPWEuTXV0YXRpb25PYnNlcnZlcnx8YS5XZWJLaXRNdXRhdGlvbk9ic2VydmVyO2lmKGYpe3ZhciBnPTAsaD1uZXcgZihjKSxpPWEuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJcIik7aC5vYnNlcnZlKGkse2NoYXJhY3RlckRhdGE6ITB9KSxlPWZ1bmN0aW9uKCl7aS5kYXRhPWc9KytnJTJ9fWVsc2UgaWYoYS5zZXRJbW1lZGlhdGV8fFwidW5kZWZpbmVkXCI9PXR5cGVvZiBhLk1lc3NhZ2VDaGFubmVsKWU9XCJkb2N1bWVudFwiaW4gYSYmXCJvbnJlYWR5c3RhdGVjaGFuZ2VcImluIGEuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKT9mdW5jdGlvbigpe3ZhciBiPWEuZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtiLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe2MoKSxiLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsLGIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKSxiPW51bGx9LGEuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKGIpfTpmdW5jdGlvbigpe3NldFRpbWVvdXQoYywwKX07ZWxzZXt2YXIgaj1uZXcgYS5NZXNzYWdlQ2hhbm5lbDtqLnBvcnQxLm9ubWVzc2FnZT1jLGU9ZnVuY3Rpb24oKXtqLnBvcnQyLnBvc3RNZXNzYWdlKDApfX12YXIgayxsPVtdO2IuZXhwb3J0cz1kfSkuY2FsbCh0aGlzLFwidW5kZWZpbmVkXCIhPXR5cGVvZiBnbG9iYWw/Z2xvYmFsOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBzZWxmP3NlbGY6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6e30pfSx7fV0sNTg6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKCl7fWZ1bmN0aW9uIGUoYSl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgYSl0aHJvdyBuZXcgVHlwZUVycm9yKFwicmVzb2x2ZXIgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO3RoaXMuc3RhdGU9cyx0aGlzLnF1ZXVlPVtdLHRoaXMub3V0Y29tZT12b2lkIDAsYSE9PWQmJmkodGhpcyxhKX1mdW5jdGlvbiBmKGEsYixjKXt0aGlzLnByb21pc2U9YSxcImZ1bmN0aW9uXCI9PXR5cGVvZiBiJiYodGhpcy5vbkZ1bGZpbGxlZD1iLHRoaXMuY2FsbEZ1bGZpbGxlZD10aGlzLm90aGVyQ2FsbEZ1bGZpbGxlZCksXCJmdW5jdGlvblwiPT10eXBlb2YgYyYmKHRoaXMub25SZWplY3RlZD1jLHRoaXMuY2FsbFJlamVjdGVkPXRoaXMub3RoZXJDYWxsUmVqZWN0ZWQpfWZ1bmN0aW9uIGcoYSxiLGMpe28oZnVuY3Rpb24oKXt2YXIgZDt0cnl7ZD1iKGMpfWNhdGNoKGUpe3JldHVybiBwLnJlamVjdChhLGUpfWQ9PT1hP3AucmVqZWN0KGEsbmV3IFR5cGVFcnJvcihcIkNhbm5vdCByZXNvbHZlIHByb21pc2Ugd2l0aCBpdHNlbGZcIikpOnAucmVzb2x2ZShhLGQpfSl9ZnVuY3Rpb24gaChhKXt2YXIgYj1hJiZhLnRoZW47aWYoYSYmKFwib2JqZWN0XCI9PXR5cGVvZiBhfHxcImZ1bmN0aW9uXCI9PXR5cGVvZiBhKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgYilyZXR1cm4gZnVuY3Rpb24oKXtiLmFwcGx5KGEsYXJndW1lbnRzKX19ZnVuY3Rpb24gaShhLGIpe2Z1bmN0aW9uIGMoYil7Znx8KGY9ITAscC5yZWplY3QoYSxiKSl9ZnVuY3Rpb24gZChiKXtmfHwoZj0hMCxwLnJlc29sdmUoYSxiKSl9ZnVuY3Rpb24gZSgpe2IoZCxjKX12YXIgZj0hMSxnPWooZSk7XCJlcnJvclwiPT09Zy5zdGF0dXMmJmMoZy52YWx1ZSl9ZnVuY3Rpb24gaihhLGIpe3ZhciBjPXt9O3RyeXtjLnZhbHVlPWEoYiksYy5zdGF0dXM9XCJzdWNjZXNzXCJ9Y2F0Y2goZCl7Yy5zdGF0dXM9XCJlcnJvclwiLGMudmFsdWU9ZH1yZXR1cm4gY31mdW5jdGlvbiBrKGEpe3JldHVybiBhIGluc3RhbmNlb2YgdGhpcz9hOnAucmVzb2x2ZShuZXcgdGhpcyhkKSxhKX1mdW5jdGlvbiBsKGEpe3ZhciBiPW5ldyB0aGlzKGQpO3JldHVybiBwLnJlamVjdChiLGEpfWZ1bmN0aW9uIG0oYSl7ZnVuY3Rpb24gYihhLGIpe2Z1bmN0aW9uIGQoYSl7Z1tiXT1hLCsraCE9PWV8fGZ8fChmPSEwLHAucmVzb2x2ZShqLGcpKX1jLnJlc29sdmUoYSkudGhlbihkLGZ1bmN0aW9uKGEpe2Z8fChmPSEwLHAucmVqZWN0KGosYSkpfSl9dmFyIGM9dGhpcztpZihcIltvYmplY3QgQXJyYXldXCIhPT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSkpcmV0dXJuIHRoaXMucmVqZWN0KG5ldyBUeXBlRXJyb3IoXCJtdXN0IGJlIGFuIGFycmF5XCIpKTt2YXIgZT1hLmxlbmd0aCxmPSExO2lmKCFlKXJldHVybiB0aGlzLnJlc29sdmUoW10pO2Zvcih2YXIgZz1uZXcgQXJyYXkoZSksaD0wLGk9LTEsaj1uZXcgdGhpcyhkKTsrK2k8ZTspYihhW2ldLGkpO3JldHVybiBqfWZ1bmN0aW9uIG4oYSl7ZnVuY3Rpb24gYihhKXtjLnJlc29sdmUoYSkudGhlbihmdW5jdGlvbihhKXtmfHwoZj0hMCxwLnJlc29sdmUoaCxhKSl9LGZ1bmN0aW9uKGEpe2Z8fChmPSEwLHAucmVqZWN0KGgsYSkpfSl9dmFyIGM9dGhpcztpZihcIltvYmplY3QgQXJyYXldXCIhPT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSkpcmV0dXJuIHRoaXMucmVqZWN0KG5ldyBUeXBlRXJyb3IoXCJtdXN0IGJlIGFuIGFycmF5XCIpKTt2YXIgZT1hLmxlbmd0aCxmPSExO2lmKCFlKXJldHVybiB0aGlzLnJlc29sdmUoW10pO2Zvcih2YXIgZz0tMSxoPW5ldyB0aGlzKGQpOysrZzxlOyliKGFbZ10pO3JldHVybiBofXZhciBvPWEoXCJpbW1lZGlhdGVcIikscD17fSxxPVtcIlJFSkVDVEVEXCJdLHI9W1wiRlVMRklMTEVEXCJdLHM9W1wiUEVORElOR1wiXTtiLmV4cG9ydHM9ZSxlLnByb3RvdHlwZVtcImNhdGNoXCJdPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnRoZW4obnVsbCxhKX0sZS5wcm90b3R5cGUudGhlbj1mdW5jdGlvbihhLGIpe2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIGEmJnRoaXMuc3RhdGU9PT1yfHxcImZ1bmN0aW9uXCIhPXR5cGVvZiBiJiZ0aGlzLnN0YXRlPT09cSlyZXR1cm4gdGhpczt2YXIgYz1uZXcgdGhpcy5jb25zdHJ1Y3RvcihkKTtpZih0aGlzLnN0YXRlIT09cyl7dmFyIGU9dGhpcy5zdGF0ZT09PXI/YTpiO2coYyxlLHRoaXMub3V0Y29tZSl9ZWxzZSB0aGlzLnF1ZXVlLnB1c2gobmV3IGYoYyxhLGIpKTtyZXR1cm4gY30sZi5wcm90b3R5cGUuY2FsbEZ1bGZpbGxlZD1mdW5jdGlvbihhKXtwLnJlc29sdmUodGhpcy5wcm9taXNlLGEpfSxmLnByb3RvdHlwZS5vdGhlckNhbGxGdWxmaWxsZWQ9ZnVuY3Rpb24oYSl7Zyh0aGlzLnByb21pc2UsdGhpcy5vbkZ1bGZpbGxlZCxhKX0sZi5wcm90b3R5cGUuY2FsbFJlamVjdGVkPWZ1bmN0aW9uKGEpe3AucmVqZWN0KHRoaXMucHJvbWlzZSxhKX0sZi5wcm90b3R5cGUub3RoZXJDYWxsUmVqZWN0ZWQ9ZnVuY3Rpb24oYSl7Zyh0aGlzLnByb21pc2UsdGhpcy5vblJlamVjdGVkLGEpfSxwLnJlc29sdmU9ZnVuY3Rpb24oYSxiKXt2YXIgYz1qKGgsYik7aWYoXCJlcnJvclwiPT09Yy5zdGF0dXMpcmV0dXJuIHAucmVqZWN0KGEsYy52YWx1ZSk7dmFyIGQ9Yy52YWx1ZTtpZihkKWkoYSxkKTtlbHNle2Euc3RhdGU9cixhLm91dGNvbWU9Yjtmb3IodmFyIGU9LTEsZj1hLnF1ZXVlLmxlbmd0aDsrK2U8ZjspYS5xdWV1ZVtlXS5jYWxsRnVsZmlsbGVkKGIpfXJldHVybiBhfSxwLnJlamVjdD1mdW5jdGlvbihhLGIpe2Euc3RhdGU9cSxhLm91dGNvbWU9Yjtmb3IodmFyIGM9LTEsZD1hLnF1ZXVlLmxlbmd0aDsrK2M8ZDspYS5xdWV1ZVtjXS5jYWxsUmVqZWN0ZWQoYik7cmV0dXJuIGF9LGUucmVzb2x2ZT1rLGUucmVqZWN0PWwsZS5hbGw9bSxlLnJhY2U9bn0se2ltbWVkaWF0ZTo1N31dLDU5OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGQ9YShcIi4vbGliL3V0aWxzL2NvbW1vblwiKS5hc3NpZ24sZT1hKFwiLi9saWIvZGVmbGF0ZVwiKSxmPWEoXCIuL2xpYi9pbmZsYXRlXCIpLGc9YShcIi4vbGliL3psaWIvY29uc3RhbnRzXCIpLGg9e307ZChoLGUsZixnKSxiLmV4cG9ydHM9aH0se1wiLi9saWIvZGVmbGF0ZVwiOjYwLFwiLi9saWIvaW5mbGF0ZVwiOjYxLFwiLi9saWIvdXRpbHMvY29tbW9uXCI6NjIsXCIuL2xpYi96bGliL2NvbnN0YW50c1wiOjY1fV0sNjA6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEpe2lmKCEodGhpcyBpbnN0YW5jZW9mIGQpKXJldHVybiBuZXcgZChhKTt0aGlzLm9wdGlvbnM9aS5hc3NpZ24oe2xldmVsOnMsbWV0aG9kOnUsY2h1bmtTaXplOjE2Mzg0LHdpbmRvd0JpdHM6MTUsbWVtTGV2ZWw6OCxzdHJhdGVneTp0LHRvOlwiXCJ9LGF8fHt9KTt2YXIgYj10aGlzLm9wdGlvbnM7Yi5yYXcmJmIud2luZG93Qml0cz4wP2Iud2luZG93Qml0cz0tYi53aW5kb3dCaXRzOmIuZ3ppcCYmYi53aW5kb3dCaXRzPjAmJmIud2luZG93Qml0czwxNiYmKGIud2luZG93Qml0cys9MTYpLHRoaXMuZXJyPTAsdGhpcy5tc2c9XCJcIix0aGlzLmVuZGVkPSExLHRoaXMuY2h1bmtzPVtdLHRoaXMuc3RybT1uZXcgbCx0aGlzLnN0cm0uYXZhaWxfb3V0PTA7dmFyIGM9aC5kZWZsYXRlSW5pdDIodGhpcy5zdHJtLGIubGV2ZWwsYi5tZXRob2QsYi53aW5kb3dCaXRzLGIubWVtTGV2ZWwsYi5zdHJhdGVneSk7aWYoYyE9PXApdGhyb3cgbmV3IEVycm9yKGtbY10pO2lmKGIuaGVhZGVyJiZoLmRlZmxhdGVTZXRIZWFkZXIodGhpcy5zdHJtLGIuaGVhZGVyKSxiLmRpY3Rpb25hcnkpe3ZhciBlO2lmKGU9XCJzdHJpbmdcIj09dHlwZW9mIGIuZGljdGlvbmFyeT9qLnN0cmluZzJidWYoYi5kaWN0aW9uYXJ5KTpcIltvYmplY3QgQXJyYXlCdWZmZXJdXCI9PT1tLmNhbGwoYi5kaWN0aW9uYXJ5KT9uZXcgVWludDhBcnJheShiLmRpY3Rpb25hcnkpOmIuZGljdGlvbmFyeSxjPWguZGVmbGF0ZVNldERpY3Rpb25hcnkodGhpcy5zdHJtLGUpLGMhPT1wKXRocm93IG5ldyBFcnJvcihrW2NdKTt0aGlzLl9kaWN0X3NldD0hMH19ZnVuY3Rpb24gZShhLGIpe3ZhciBjPW5ldyBkKGIpO2lmKGMucHVzaChhLCEwKSxjLmVycil0aHJvdyBjLm1zZ3x8a1tjLmVycl07cmV0dXJuIGMucmVzdWx0fWZ1bmN0aW9uIGYoYSxiKXtyZXR1cm4gYj1ifHx7fSxiLnJhdz0hMCxlKGEsYil9ZnVuY3Rpb24gZyhhLGIpe3JldHVybiBiPWJ8fHt9LGIuZ3ppcD0hMCxlKGEsYil9dmFyIGg9YShcIi4vemxpYi9kZWZsYXRlXCIpLGk9YShcIi4vdXRpbHMvY29tbW9uXCIpLGo9YShcIi4vdXRpbHMvc3RyaW5nc1wiKSxrPWEoXCIuL3psaWIvbWVzc2FnZXNcIiksbD1hKFwiLi96bGliL3pzdHJlYW1cIiksbT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLG49MCxvPTQscD0wLHE9MSxyPTIscz0tMSx0PTAsdT04O2QucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGU9dGhpcy5zdHJtLGY9dGhpcy5vcHRpb25zLmNodW5rU2l6ZTtpZih0aGlzLmVuZGVkKXJldHVybiExO2Q9Yj09PX5+Yj9iOmI9PT0hMD9vOm4sXCJzdHJpbmdcIj09dHlwZW9mIGE/ZS5pbnB1dD1qLnN0cmluZzJidWYoYSk6XCJbb2JqZWN0IEFycmF5QnVmZmVyXVwiPT09bS5jYWxsKGEpP2UuaW5wdXQ9bmV3IFVpbnQ4QXJyYXkoYSk6ZS5pbnB1dD1hLGUubmV4dF9pbj0wLGUuYXZhaWxfaW49ZS5pbnB1dC5sZW5ndGg7ZG97aWYoMD09PWUuYXZhaWxfb3V0JiYoZS5vdXRwdXQ9bmV3IGkuQnVmOChmKSxlLm5leHRfb3V0PTAsZS5hdmFpbF9vdXQ9ZiksYz1oLmRlZmxhdGUoZSxkKSxjIT09cSYmYyE9PXApcmV0dXJuIHRoaXMub25FbmQoYyksdGhpcy5lbmRlZD0hMCwhMTswIT09ZS5hdmFpbF9vdXQmJigwIT09ZS5hdmFpbF9pbnx8ZCE9PW8mJmQhPT1yKXx8KFwic3RyaW5nXCI9PT10aGlzLm9wdGlvbnMudG8/dGhpcy5vbkRhdGEoai5idWYyYmluc3RyaW5nKGkuc2hyaW5rQnVmKGUub3V0cHV0LGUubmV4dF9vdXQpKSk6dGhpcy5vbkRhdGEoaS5zaHJpbmtCdWYoZS5vdXRwdXQsZS5uZXh0X291dCkpKX13aGlsZSgoZS5hdmFpbF9pbj4wfHwwPT09ZS5hdmFpbF9vdXQpJiZjIT09cSk7cmV0dXJuIGQ9PT1vPyhjPWguZGVmbGF0ZUVuZCh0aGlzLnN0cm0pLHRoaXMub25FbmQoYyksdGhpcy5lbmRlZD0hMCxjPT09cCk6ZCE9PXJ8fCh0aGlzLm9uRW5kKHApLGUuYXZhaWxfb3V0PTAsITApfSxkLnByb3RvdHlwZS5vbkRhdGE9ZnVuY3Rpb24oYSl7dGhpcy5jaHVua3MucHVzaChhKX0sZC5wcm90b3R5cGUub25FbmQ9ZnVuY3Rpb24oYSl7YT09PXAmJihcInN0cmluZ1wiPT09dGhpcy5vcHRpb25zLnRvP3RoaXMucmVzdWx0PXRoaXMuY2h1bmtzLmpvaW4oXCJcIik6dGhpcy5yZXN1bHQ9aS5mbGF0dGVuQ2h1bmtzKHRoaXMuY2h1bmtzKSksdGhpcy5jaHVua3M9W10sdGhpcy5lcnI9YSx0aGlzLm1zZz10aGlzLnN0cm0ubXNnfSxjLkRlZmxhdGU9ZCxjLmRlZmxhdGU9ZSxjLmRlZmxhdGVSYXc9ZixjLmd6aXA9Z30se1wiLi91dGlscy9jb21tb25cIjo2MixcIi4vdXRpbHMvc3RyaW5nc1wiOjYzLFwiLi96bGliL2RlZmxhdGVcIjo2NyxcIi4vemxpYi9tZXNzYWdlc1wiOjcyLFwiLi96bGliL3pzdHJlYW1cIjo3NH1dLDYxOltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZChhKXtpZighKHRoaXMgaW5zdGFuY2VvZiBkKSlyZXR1cm4gbmV3IGQoYSk7dGhpcy5vcHRpb25zPWguYXNzaWduKHtjaHVua1NpemU6MTYzODQsd2luZG93Qml0czowLHRvOlwiXCJ9LGF8fHt9KTt2YXIgYj10aGlzLm9wdGlvbnM7Yi5yYXcmJmIud2luZG93Qml0cz49MCYmYi53aW5kb3dCaXRzPDE2JiYoYi53aW5kb3dCaXRzPS1iLndpbmRvd0JpdHMsMD09PWIud2luZG93Qml0cyYmKGIud2luZG93Qml0cz0tMTUpKSwhKGIud2luZG93Qml0cz49MCYmYi53aW5kb3dCaXRzPDE2KXx8YSYmYS53aW5kb3dCaXRzfHwoYi53aW5kb3dCaXRzKz0zMiksYi53aW5kb3dCaXRzPjE1JiZiLndpbmRvd0JpdHM8NDgmJjA9PT0oMTUmYi53aW5kb3dCaXRzKSYmKGIud2luZG93Qml0c3w9MTUpLHRoaXMuZXJyPTAsdGhpcy5tc2c9XCJcIix0aGlzLmVuZGVkPSExLHRoaXMuY2h1bmtzPVtdLHRoaXMuc3RybT1uZXcgbCx0aGlzLnN0cm0uYXZhaWxfb3V0PTA7dmFyIGM9Zy5pbmZsYXRlSW5pdDIodGhpcy5zdHJtLGIud2luZG93Qml0cyk7aWYoYyE9PWouWl9PSyl0aHJvdyBuZXcgRXJyb3Ioa1tjXSk7dGhpcy5oZWFkZXI9bmV3IG0sZy5pbmZsYXRlR2V0SGVhZGVyKHRoaXMuc3RybSx0aGlzLmhlYWRlcil9ZnVuY3Rpb24gZShhLGIpe3ZhciBjPW5ldyBkKGIpO2lmKGMucHVzaChhLCEwKSxjLmVycil0aHJvdyBjLm1zZ3x8a1tjLmVycl07cmV0dXJuIGMucmVzdWx0fWZ1bmN0aW9uIGYoYSxiKXtyZXR1cm4gYj1ifHx7fSxiLnJhdz0hMCxlKGEsYil9dmFyIGc9YShcIi4vemxpYi9pbmZsYXRlXCIpLGg9YShcIi4vdXRpbHMvY29tbW9uXCIpLGk9YShcIi4vdXRpbHMvc3RyaW5nc1wiKSxqPWEoXCIuL3psaWIvY29uc3RhbnRzXCIpLGs9YShcIi4vemxpYi9tZXNzYWdlc1wiKSxsPWEoXCIuL3psaWIvenN0cmVhbVwiKSxtPWEoXCIuL3psaWIvZ3poZWFkZXJcIiksbj1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO2QucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZixrLGwsbT10aGlzLnN0cm0sbz10aGlzLm9wdGlvbnMuY2h1bmtTaXplLHA9dGhpcy5vcHRpb25zLmRpY3Rpb25hcnkscT0hMTtpZih0aGlzLmVuZGVkKXJldHVybiExO2Q9Yj09PX5+Yj9iOmI9PT0hMD9qLlpfRklOSVNIOmouWl9OT19GTFVTSCxcInN0cmluZ1wiPT10eXBlb2YgYT9tLmlucHV0PWkuYmluc3RyaW5nMmJ1ZihhKTpcIltvYmplY3QgQXJyYXlCdWZmZXJdXCI9PT1uLmNhbGwoYSk/bS5pbnB1dD1uZXcgVWludDhBcnJheShhKTptLmlucHV0PWEsbS5uZXh0X2luPTAsbS5hdmFpbF9pbj1tLmlucHV0Lmxlbmd0aDtkb3tpZigwPT09bS5hdmFpbF9vdXQmJihtLm91dHB1dD1uZXcgaC5CdWY4KG8pLG0ubmV4dF9vdXQ9MCxtLmF2YWlsX291dD1vKSxjPWcuaW5mbGF0ZShtLGouWl9OT19GTFVTSCksYz09PWouWl9ORUVEX0RJQ1QmJnAmJihsPVwic3RyaW5nXCI9PXR5cGVvZiBwP2kuc3RyaW5nMmJ1ZihwKTpcIltvYmplY3QgQXJyYXlCdWZmZXJdXCI9PT1uLmNhbGwocCk/bmV3IFVpbnQ4QXJyYXkocCk6cCxjPWcuaW5mbGF0ZVNldERpY3Rpb25hcnkodGhpcy5zdHJtLGwpKSxjPT09ai5aX0JVRl9FUlJPUiYmcT09PSEwJiYoYz1qLlpfT0sscT0hMSksYyE9PWouWl9TVFJFQU1fRU5EJiZjIT09ai5aX09LKXJldHVybiB0aGlzLm9uRW5kKGMpLHRoaXMuZW5kZWQ9ITAsITE7bS5uZXh0X291dCYmKDAhPT1tLmF2YWlsX291dCYmYyE9PWouWl9TVFJFQU1fRU5EJiYoMCE9PW0uYXZhaWxfaW58fGQhPT1qLlpfRklOSVNIJiZkIT09ai5aX1NZTkNfRkxVU0gpfHwoXCJzdHJpbmdcIj09PXRoaXMub3B0aW9ucy50bz8oZT1pLnV0Zjhib3JkZXIobS5vdXRwdXQsbS5uZXh0X291dCksZj1tLm5leHRfb3V0LWUsaz1pLmJ1ZjJzdHJpbmcobS5vdXRwdXQsZSksbS5uZXh0X291dD1mLG0uYXZhaWxfb3V0PW8tZixmJiZoLmFycmF5U2V0KG0ub3V0cHV0LG0ub3V0cHV0LGUsZiwwKSx0aGlzLm9uRGF0YShrKSk6dGhpcy5vbkRhdGEoaC5zaHJpbmtCdWYobS5vdXRwdXQsbS5uZXh0X291dCkpKSksMD09PW0uYXZhaWxfaW4mJjA9PT1tLmF2YWlsX291dCYmKHE9ITApfXdoaWxlKChtLmF2YWlsX2luPjB8fDA9PT1tLmF2YWlsX291dCkmJmMhPT1qLlpfU1RSRUFNX0VORCk7cmV0dXJuIGM9PT1qLlpfU1RSRUFNX0VORCYmKGQ9ai5aX0ZJTklTSCksZD09PWouWl9GSU5JU0g/KGM9Zy5pbmZsYXRlRW5kKHRoaXMuc3RybSksdGhpcy5vbkVuZChjKSx0aGlzLmVuZGVkPSEwLGM9PT1qLlpfT0spOmQhPT1qLlpfU1lOQ19GTFVTSHx8KHRoaXMub25FbmQoai5aX09LKSxtLmF2YWlsX291dD0wLCEwKX0sZC5wcm90b3R5cGUub25EYXRhPWZ1bmN0aW9uKGEpe3RoaXMuY2h1bmtzLnB1c2goYSl9LGQucHJvdG90eXBlLm9uRW5kPWZ1bmN0aW9uKGEpe2E9PT1qLlpfT0smJihcInN0cmluZ1wiPT09dGhpcy5vcHRpb25zLnRvP3RoaXMucmVzdWx0PXRoaXMuY2h1bmtzLmpvaW4oXCJcIik6dGhpcy5yZXN1bHQ9aC5mbGF0dGVuQ2h1bmtzKHRoaXMuY2h1bmtzKSksdGhpcy5jaHVua3M9W10sdGhpcy5lcnI9YSx0aGlzLm1zZz10aGlzLnN0cm0ubXNnfSxjLkluZmxhdGU9ZCxjLmluZmxhdGU9ZSxjLmluZmxhdGVSYXc9ZixjLnVuZ3ppcD1lfSx7XCIuL3V0aWxzL2NvbW1vblwiOjYyLFwiLi91dGlscy9zdHJpbmdzXCI6NjMsXCIuL3psaWIvY29uc3RhbnRzXCI6NjUsXCIuL3psaWIvZ3poZWFkZXJcIjo2OCxcIi4vemxpYi9pbmZsYXRlXCI6NzAsXCIuL3psaWIvbWVzc2FnZXNcIjo3MixcIi4vemxpYi96c3RyZWFtXCI6NzR9XSw2MjpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO3ZhciBkPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBVaW50OEFycmF5JiZcInVuZGVmaW5lZFwiIT10eXBlb2YgVWludDE2QXJyYXkmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBJbnQzMkFycmF5O2MuYXNzaWduPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7Yi5sZW5ndGg7KXt2YXIgYz1iLnNoaWZ0KCk7aWYoYyl7aWYoXCJvYmplY3RcIiE9dHlwZW9mIGMpdGhyb3cgbmV3IFR5cGVFcnJvcihjK1wibXVzdCBiZSBub24tb2JqZWN0XCIpO2Zvcih2YXIgZCBpbiBjKWMuaGFzT3duUHJvcGVydHkoZCkmJihhW2RdPWNbZF0pfX1yZXR1cm4gYX0sYy5zaHJpbmtCdWY9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5sZW5ndGg9PT1iP2E6YS5zdWJhcnJheT9hLnN1YmFycmF5KDAsYik6KGEubGVuZ3RoPWIsYSl9O3ZhciBlPXthcnJheVNldDpmdW5jdGlvbihhLGIsYyxkLGUpe2lmKGIuc3ViYXJyYXkmJmEuc3ViYXJyYXkpcmV0dXJuIHZvaWQgYS5zZXQoYi5zdWJhcnJheShjLGMrZCksZSk7Zm9yKHZhciBmPTA7ZjxkO2YrKylhW2UrZl09YltjK2ZdfSxmbGF0dGVuQ2h1bmtzOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlLGYsZztmb3IoZD0wLGI9MCxjPWEubGVuZ3RoO2I8YztiKyspZCs9YVtiXS5sZW5ndGg7Zm9yKGc9bmV3IFVpbnQ4QXJyYXkoZCksZT0wLGI9MCxjPWEubGVuZ3RoO2I8YztiKyspZj1hW2JdLGcuc2V0KGYsZSksZSs9Zi5sZW5ndGg7cmV0dXJuIGd9fSxmPXthcnJheVNldDpmdW5jdGlvbihhLGIsYyxkLGUpe2Zvcih2YXIgZj0wO2Y8ZDtmKyspYVtlK2ZdPWJbYytmXX0sZmxhdHRlbkNodW5rczpmdW5jdGlvbihhKXtyZXR1cm5bXS5jb25jYXQuYXBwbHkoW10sYSl9fTtjLnNldFR5cGVkPWZ1bmN0aW9uKGEpe2E/KGMuQnVmOD1VaW50OEFycmF5LGMuQnVmMTY9VWludDE2QXJyYXksYy5CdWYzMj1JbnQzMkFycmF5LGMuYXNzaWduKGMsZSkpOihjLkJ1Zjg9QXJyYXksYy5CdWYxNj1BcnJheSxjLkJ1ZjMyPUFycmF5LGMuYXNzaWduKGMsZikpfSxjLnNldFR5cGVkKGQpfSx7fV0sNjM6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEsYil7aWYoYjw2NTUzNyYmKGEuc3ViYXJyYXkmJmd8fCFhLnN1YmFycmF5JiZmKSlyZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLGUuc2hyaW5rQnVmKGEsYikpO2Zvcih2YXIgYz1cIlwiLGQ9MDtkPGI7ZCsrKWMrPVN0cmluZy5mcm9tQ2hhckNvZGUoYVtkXSk7cmV0dXJuIGN9dmFyIGU9YShcIi4vY29tbW9uXCIpLGY9ITAsZz0hMDt0cnl7U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLFswXSl9Y2F0Y2goaCl7Zj0hMX10cnl7U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLG5ldyBVaW50OEFycmF5KDEpKX1jYXRjaChoKXtnPSExfWZvcih2YXIgaT1uZXcgZS5CdWY4KDI1Niksaj0wO2o8MjU2O2orKylpW2pdPWo+PTI1Mj82Omo+PTI0OD81Omo+PTI0MD80Omo+PTIyND8zOmo+PTE5Mj8yOjE7aVsyNTRdPWlbMjU0XT0xLGMuc3RyaW5nMmJ1Zj1mdW5jdGlvbihhKXt2YXIgYixjLGQsZixnLGg9YS5sZW5ndGgsaT0wO2ZvcihmPTA7ZjxoO2YrKyljPWEuY2hhckNvZGVBdChmKSw1NTI5Nj09PSg2NDUxMiZjKSYmZisxPGgmJihkPWEuY2hhckNvZGVBdChmKzEpLDU2MzIwPT09KDY0NTEyJmQpJiYoYz02NTUzNisoYy01NTI5Njw8MTApKyhkLTU2MzIwKSxmKyspKSxpKz1jPDEyOD8xOmM8MjA0OD8yOmM8NjU1MzY/Mzo0O2ZvcihiPW5ldyBlLkJ1ZjgoaSksZz0wLGY9MDtnPGk7ZisrKWM9YS5jaGFyQ29kZUF0KGYpLDU1Mjk2PT09KDY0NTEyJmMpJiZmKzE8aCYmKGQ9YS5jaGFyQ29kZUF0KGYrMSksNTYzMjA9PT0oNjQ1MTImZCkmJihjPTY1NTM2KyhjLTU1Mjk2PDwxMCkrKGQtNTYzMjApLGYrKykpLGM8MTI4P2JbZysrXT1jOmM8MjA0OD8oYltnKytdPTE5MnxjPj4+NixiW2crK109MTI4fDYzJmMpOmM8NjU1MzY/KGJbZysrXT0yMjR8Yz4+PjEyLGJbZysrXT0xMjh8Yz4+PjYmNjMsYltnKytdPTEyOHw2MyZjKTooYltnKytdPTI0MHxjPj4+MTgsYltnKytdPTEyOHxjPj4+MTImNjMsYltnKytdPTEyOHxjPj4+NiY2MyxiW2crK109MTI4fDYzJmMpO3JldHVybiBifSxjLmJ1ZjJiaW5zdHJpbmc9ZnVuY3Rpb24oYSl7cmV0dXJuIGQoYSxhLmxlbmd0aCl9LGMuYmluc3RyaW5nMmJ1Zj1mdW5jdGlvbihhKXtmb3IodmFyIGI9bmV3IGUuQnVmOChhLmxlbmd0aCksYz0wLGQ9Yi5sZW5ndGg7YzxkO2MrKyliW2NdPWEuY2hhckNvZGVBdChjKTtyZXR1cm4gYn0sYy5idWYyc3RyaW5nPWZ1bmN0aW9uKGEsYil7dmFyIGMsZSxmLGcsaD1ifHxhLmxlbmd0aCxqPW5ldyBBcnJheSgyKmgpO2ZvcihlPTAsYz0wO2M8aDspaWYoZj1hW2MrK10sZjwxMjgpaltlKytdPWY7ZWxzZSBpZihnPWlbZl0sZz40KWpbZSsrXT02NTUzMyxjKz1nLTE7ZWxzZXtmb3IoZiY9Mj09PWc/MzE6Mz09PWc/MTU6NztnPjEmJmM8aDspZj1mPDw2fDYzJmFbYysrXSxnLS07Zz4xP2pbZSsrXT02NTUzMzpmPDY1NTM2P2pbZSsrXT1mOihmLT02NTUzNixqW2UrK109NTUyOTZ8Zj4+MTAmMTAyMyxqW2UrK109NTYzMjB8MTAyMyZmKX1yZXR1cm4gZChqLGUpfSxjLnV0Zjhib3JkZXI9ZnVuY3Rpb24oYSxiKXt2YXIgYztmb3IoYj1ifHxhLmxlbmd0aCxiPmEubGVuZ3RoJiYoYj1hLmxlbmd0aCksYz1iLTE7Yz49MCYmMTI4PT09KDE5MiZhW2NdKTspYy0tO3JldHVybiBjPDA/YjowPT09Yz9iOmMraVthW2NdXT5iP2M6Yn19LHtcIi4vY29tbW9uXCI6NjJ9XSw2NDpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGQoYSxiLGMsZCl7Zm9yKHZhciBlPTY1NTM1JmF8MCxmPWE+Pj4xNiY2NTUzNXwwLGc9MDswIT09Yzspe2c9Yz4yZTM/MmUzOmMsYy09ZztkbyBlPWUrYltkKytdfDAsZj1mK2V8MDt3aGlsZSgtLWcpO2UlPTY1NTIxLGYlPTY1NTIxfXJldHVybiBlfGY8PDE2fDA7XG59Yi5leHBvcnRzPWR9LHt9XSw2NTpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2IuZXhwb3J0cz17Wl9OT19GTFVTSDowLFpfUEFSVElBTF9GTFVTSDoxLFpfU1lOQ19GTFVTSDoyLFpfRlVMTF9GTFVTSDozLFpfRklOSVNIOjQsWl9CTE9DSzo1LFpfVFJFRVM6NixaX09LOjAsWl9TVFJFQU1fRU5EOjEsWl9ORUVEX0RJQ1Q6MixaX0VSUk5POi0xLFpfU1RSRUFNX0VSUk9SOi0yLFpfREFUQV9FUlJPUjotMyxaX0JVRl9FUlJPUjotNSxaX05PX0NPTVBSRVNTSU9OOjAsWl9CRVNUX1NQRUVEOjEsWl9CRVNUX0NPTVBSRVNTSU9OOjksWl9ERUZBVUxUX0NPTVBSRVNTSU9OOi0xLFpfRklMVEVSRUQ6MSxaX0hVRkZNQU5fT05MWToyLFpfUkxFOjMsWl9GSVhFRDo0LFpfREVGQVVMVF9TVFJBVEVHWTowLFpfQklOQVJZOjAsWl9URVhUOjEsWl9VTktOT1dOOjIsWl9ERUZMQVRFRDo4fX0se31dLDY2OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZCgpe2Zvcih2YXIgYSxiPVtdLGM9MDtjPDI1NjtjKyspe2E9Yztmb3IodmFyIGQ9MDtkPDg7ZCsrKWE9MSZhPzM5ODgyOTIzODReYT4+PjE6YT4+PjE7YltjXT1hfXJldHVybiBifWZ1bmN0aW9uIGUoYSxiLGMsZCl7dmFyIGU9ZixnPWQrYzthXj0tMTtmb3IodmFyIGg9ZDtoPGc7aCsrKWE9YT4+PjheZVsyNTUmKGFeYltoXSldO3JldHVybiBhXi0xfXZhciBmPWQoKTtiLmV4cG9ydHM9ZX0se31dLDY3OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZChhLGIpe3JldHVybiBhLm1zZz1JW2JdLGJ9ZnVuY3Rpb24gZShhKXtyZXR1cm4oYTw8MSktKGE+ND85OjApfWZ1bmN0aW9uIGYoYSl7Zm9yKHZhciBiPWEubGVuZ3RoOy0tYj49MDspYVtiXT0wfWZ1bmN0aW9uIGcoYSl7dmFyIGI9YS5zdGF0ZSxjPWIucGVuZGluZztjPmEuYXZhaWxfb3V0JiYoYz1hLmF2YWlsX291dCksMCE9PWMmJihFLmFycmF5U2V0KGEub3V0cHV0LGIucGVuZGluZ19idWYsYi5wZW5kaW5nX291dCxjLGEubmV4dF9vdXQpLGEubmV4dF9vdXQrPWMsYi5wZW5kaW5nX291dCs9YyxhLnRvdGFsX291dCs9YyxhLmF2YWlsX291dC09YyxiLnBlbmRpbmctPWMsMD09PWIucGVuZGluZyYmKGIucGVuZGluZ19vdXQ9MCkpfWZ1bmN0aW9uIGgoYSxiKXtGLl90cl9mbHVzaF9ibG9jayhhLGEuYmxvY2tfc3RhcnQ+PTA/YS5ibG9ja19zdGFydDotMSxhLnN0cnN0YXJ0LWEuYmxvY2tfc3RhcnQsYiksYS5ibG9ja19zdGFydD1hLnN0cnN0YXJ0LGcoYS5zdHJtKX1mdW5jdGlvbiBpKGEsYil7YS5wZW5kaW5nX2J1ZlthLnBlbmRpbmcrK109Yn1mdW5jdGlvbiBqKGEsYil7YS5wZW5kaW5nX2J1ZlthLnBlbmRpbmcrK109Yj4+PjgmMjU1LGEucGVuZGluZ19idWZbYS5wZW5kaW5nKytdPTI1NSZifWZ1bmN0aW9uIGsoYSxiLGMsZCl7dmFyIGU9YS5hdmFpbF9pbjtyZXR1cm4gZT5kJiYoZT1kKSwwPT09ZT8wOihhLmF2YWlsX2luLT1lLEUuYXJyYXlTZXQoYixhLmlucHV0LGEubmV4dF9pbixlLGMpLDE9PT1hLnN0YXRlLndyYXA/YS5hZGxlcj1HKGEuYWRsZXIsYixlLGMpOjI9PT1hLnN0YXRlLndyYXAmJihhLmFkbGVyPUgoYS5hZGxlcixiLGUsYykpLGEubmV4dF9pbis9ZSxhLnRvdGFsX2luKz1lLGUpfWZ1bmN0aW9uIGwoYSxiKXt2YXIgYyxkLGU9YS5tYXhfY2hhaW5fbGVuZ3RoLGY9YS5zdHJzdGFydCxnPWEucHJldl9sZW5ndGgsaD1hLm5pY2VfbWF0Y2gsaT1hLnN0cnN0YXJ0PmEud19zaXplLWxhP2Euc3Ryc3RhcnQtKGEud19zaXplLWxhKTowLGo9YS53aW5kb3csaz1hLndfbWFzayxsPWEucHJldixtPWEuc3Ryc3RhcnQra2Esbj1qW2YrZy0xXSxvPWpbZitnXTthLnByZXZfbGVuZ3RoPj1hLmdvb2RfbWF0Y2gmJihlPj49MiksaD5hLmxvb2thaGVhZCYmKGg9YS5sb29rYWhlYWQpO2RvIGlmKGM9YixqW2MrZ109PT1vJiZqW2MrZy0xXT09PW4mJmpbY109PT1qW2ZdJiZqWysrY109PT1qW2YrMV0pe2YrPTIsYysrO2RvO3doaWxlKGpbKytmXT09PWpbKytjXSYmalsrK2ZdPT09alsrK2NdJiZqWysrZl09PT1qWysrY10mJmpbKytmXT09PWpbKytjXSYmalsrK2ZdPT09alsrK2NdJiZqWysrZl09PT1qWysrY10mJmpbKytmXT09PWpbKytjXSYmalsrK2ZdPT09alsrK2NdJiZmPG0pO2lmKGQ9a2EtKG0tZiksZj1tLWthLGQ+Zyl7aWYoYS5tYXRjaF9zdGFydD1iLGc9ZCxkPj1oKWJyZWFrO249altmK2ctMV0sbz1qW2YrZ119fXdoaWxlKChiPWxbYiZrXSk+aSYmMCE9PS0tZSk7cmV0dXJuIGc8PWEubG9va2FoZWFkP2c6YS5sb29rYWhlYWR9ZnVuY3Rpb24gbShhKXt2YXIgYixjLGQsZSxmLGc9YS53X3NpemU7ZG97aWYoZT1hLndpbmRvd19zaXplLWEubG9va2FoZWFkLWEuc3Ryc3RhcnQsYS5zdHJzdGFydD49ZysoZy1sYSkpe0UuYXJyYXlTZXQoYS53aW5kb3csYS53aW5kb3csZyxnLDApLGEubWF0Y2hfc3RhcnQtPWcsYS5zdHJzdGFydC09ZyxhLmJsb2NrX3N0YXJ0LT1nLGM9YS5oYXNoX3NpemUsYj1jO2RvIGQ9YS5oZWFkWy0tYl0sYS5oZWFkW2JdPWQ+PWc/ZC1nOjA7d2hpbGUoLS1jKTtjPWcsYj1jO2RvIGQ9YS5wcmV2Wy0tYl0sYS5wcmV2W2JdPWQ+PWc/ZC1nOjA7d2hpbGUoLS1jKTtlKz1nfWlmKDA9PT1hLnN0cm0uYXZhaWxfaW4pYnJlYWs7aWYoYz1rKGEuc3RybSxhLndpbmRvdyxhLnN0cnN0YXJ0K2EubG9va2FoZWFkLGUpLGEubG9va2FoZWFkKz1jLGEubG9va2FoZWFkK2EuaW5zZXJ0Pj1qYSlmb3IoZj1hLnN0cnN0YXJ0LWEuaW5zZXJ0LGEuaW5zX2g9YS53aW5kb3dbZl0sYS5pbnNfaD0oYS5pbnNfaDw8YS5oYXNoX3NoaWZ0XmEud2luZG93W2YrMV0pJmEuaGFzaF9tYXNrO2EuaW5zZXJ0JiYoYS5pbnNfaD0oYS5pbnNfaDw8YS5oYXNoX3NoaWZ0XmEud2luZG93W2YramEtMV0pJmEuaGFzaF9tYXNrLGEucHJldltmJmEud19tYXNrXT1hLmhlYWRbYS5pbnNfaF0sYS5oZWFkW2EuaW5zX2hdPWYsZisrLGEuaW5zZXJ0LS0sIShhLmxvb2thaGVhZCthLmluc2VydDxqYSkpOyk7fXdoaWxlKGEubG9va2FoZWFkPGxhJiYwIT09YS5zdHJtLmF2YWlsX2luKX1mdW5jdGlvbiBuKGEsYil7dmFyIGM9NjU1MzU7Zm9yKGM+YS5wZW5kaW5nX2J1Zl9zaXplLTUmJihjPWEucGVuZGluZ19idWZfc2l6ZS01KTs7KXtpZihhLmxvb2thaGVhZDw9MSl7aWYobShhKSwwPT09YS5sb29rYWhlYWQmJmI9PT1KKXJldHVybiB1YTtpZigwPT09YS5sb29rYWhlYWQpYnJlYWt9YS5zdHJzdGFydCs9YS5sb29rYWhlYWQsYS5sb29rYWhlYWQ9MDt2YXIgZD1hLmJsb2NrX3N0YXJ0K2M7aWYoKDA9PT1hLnN0cnN0YXJ0fHxhLnN0cnN0YXJ0Pj1kKSYmKGEubG9va2FoZWFkPWEuc3Ryc3RhcnQtZCxhLnN0cnN0YXJ0PWQsaChhLCExKSwwPT09YS5zdHJtLmF2YWlsX291dCkpcmV0dXJuIHVhO2lmKGEuc3Ryc3RhcnQtYS5ibG9ja19zdGFydD49YS53X3NpemUtbGEmJihoKGEsITEpLDA9PT1hLnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gdWF9cmV0dXJuIGEuaW5zZXJ0PTAsYj09PU0/KGgoYSwhMCksMD09PWEuc3RybS5hdmFpbF9vdXQ/d2E6eGEpOmEuc3Ryc3RhcnQ+YS5ibG9ja19zdGFydCYmKGgoYSwhMSksMD09PWEuc3RybS5hdmFpbF9vdXQpP3VhOnVhfWZ1bmN0aW9uIG8oYSxiKXtmb3IodmFyIGMsZDs7KXtpZihhLmxvb2thaGVhZDxsYSl7aWYobShhKSxhLmxvb2thaGVhZDxsYSYmYj09PUopcmV0dXJuIHVhO2lmKDA9PT1hLmxvb2thaGVhZClicmVha31pZihjPTAsYS5sb29rYWhlYWQ+PWphJiYoYS5pbnNfaD0oYS5pbnNfaDw8YS5oYXNoX3NoaWZ0XmEud2luZG93W2Euc3Ryc3RhcnQramEtMV0pJmEuaGFzaF9tYXNrLGM9YS5wcmV2W2Euc3Ryc3RhcnQmYS53X21hc2tdPWEuaGVhZFthLmluc19oXSxhLmhlYWRbYS5pbnNfaF09YS5zdHJzdGFydCksMCE9PWMmJmEuc3Ryc3RhcnQtYzw9YS53X3NpemUtbGEmJihhLm1hdGNoX2xlbmd0aD1sKGEsYykpLGEubWF0Y2hfbGVuZ3RoPj1qYSlpZihkPUYuX3RyX3RhbGx5KGEsYS5zdHJzdGFydC1hLm1hdGNoX3N0YXJ0LGEubWF0Y2hfbGVuZ3RoLWphKSxhLmxvb2thaGVhZC09YS5tYXRjaF9sZW5ndGgsYS5tYXRjaF9sZW5ndGg8PWEubWF4X2xhenlfbWF0Y2gmJmEubG9va2FoZWFkPj1qYSl7YS5tYXRjaF9sZW5ndGgtLTtkbyBhLnN0cnN0YXJ0KyssYS5pbnNfaD0oYS5pbnNfaDw8YS5oYXNoX3NoaWZ0XmEud2luZG93W2Euc3Ryc3RhcnQramEtMV0pJmEuaGFzaF9tYXNrLGM9YS5wcmV2W2Euc3Ryc3RhcnQmYS53X21hc2tdPWEuaGVhZFthLmluc19oXSxhLmhlYWRbYS5pbnNfaF09YS5zdHJzdGFydDt3aGlsZSgwIT09LS1hLm1hdGNoX2xlbmd0aCk7YS5zdHJzdGFydCsrfWVsc2UgYS5zdHJzdGFydCs9YS5tYXRjaF9sZW5ndGgsYS5tYXRjaF9sZW5ndGg9MCxhLmluc19oPWEud2luZG93W2Euc3Ryc3RhcnRdLGEuaW5zX2g9KGEuaW5zX2g8PGEuaGFzaF9zaGlmdF5hLndpbmRvd1thLnN0cnN0YXJ0KzFdKSZhLmhhc2hfbWFzaztlbHNlIGQ9Ri5fdHJfdGFsbHkoYSwwLGEud2luZG93W2Euc3Ryc3RhcnRdKSxhLmxvb2thaGVhZC0tLGEuc3Ryc3RhcnQrKztpZihkJiYoaChhLCExKSwwPT09YS5zdHJtLmF2YWlsX291dCkpcmV0dXJuIHVhfXJldHVybiBhLmluc2VydD1hLnN0cnN0YXJ0PGphLTE/YS5zdHJzdGFydDpqYS0xLGI9PT1NPyhoKGEsITApLDA9PT1hLnN0cm0uYXZhaWxfb3V0P3dhOnhhKTphLmxhc3RfbGl0JiYoaChhLCExKSwwPT09YS5zdHJtLmF2YWlsX291dCk/dWE6dmF9ZnVuY3Rpb24gcChhLGIpe2Zvcih2YXIgYyxkLGU7Oyl7aWYoYS5sb29rYWhlYWQ8bGEpe2lmKG0oYSksYS5sb29rYWhlYWQ8bGEmJmI9PT1KKXJldHVybiB1YTtpZigwPT09YS5sb29rYWhlYWQpYnJlYWt9aWYoYz0wLGEubG9va2FoZWFkPj1qYSYmKGEuaW5zX2g9KGEuaW5zX2g8PGEuaGFzaF9zaGlmdF5hLndpbmRvd1thLnN0cnN0YXJ0K2phLTFdKSZhLmhhc2hfbWFzayxjPWEucHJldlthLnN0cnN0YXJ0JmEud19tYXNrXT1hLmhlYWRbYS5pbnNfaF0sYS5oZWFkW2EuaW5zX2hdPWEuc3Ryc3RhcnQpLGEucHJldl9sZW5ndGg9YS5tYXRjaF9sZW5ndGgsYS5wcmV2X21hdGNoPWEubWF0Y2hfc3RhcnQsYS5tYXRjaF9sZW5ndGg9amEtMSwwIT09YyYmYS5wcmV2X2xlbmd0aDxhLm1heF9sYXp5X21hdGNoJiZhLnN0cnN0YXJ0LWM8PWEud19zaXplLWxhJiYoYS5tYXRjaF9sZW5ndGg9bChhLGMpLGEubWF0Y2hfbGVuZ3RoPD01JiYoYS5zdHJhdGVneT09PVV8fGEubWF0Y2hfbGVuZ3RoPT09amEmJmEuc3Ryc3RhcnQtYS5tYXRjaF9zdGFydD40MDk2KSYmKGEubWF0Y2hfbGVuZ3RoPWphLTEpKSxhLnByZXZfbGVuZ3RoPj1qYSYmYS5tYXRjaF9sZW5ndGg8PWEucHJldl9sZW5ndGgpe2U9YS5zdHJzdGFydCthLmxvb2thaGVhZC1qYSxkPUYuX3RyX3RhbGx5KGEsYS5zdHJzdGFydC0xLWEucHJldl9tYXRjaCxhLnByZXZfbGVuZ3RoLWphKSxhLmxvb2thaGVhZC09YS5wcmV2X2xlbmd0aC0xLGEucHJldl9sZW5ndGgtPTI7ZG8rK2Euc3Ryc3RhcnQ8PWUmJihhLmluc19oPShhLmluc19oPDxhLmhhc2hfc2hpZnReYS53aW5kb3dbYS5zdHJzdGFydCtqYS0xXSkmYS5oYXNoX21hc2ssYz1hLnByZXZbYS5zdHJzdGFydCZhLndfbWFza109YS5oZWFkW2EuaW5zX2hdLGEuaGVhZFthLmluc19oXT1hLnN0cnN0YXJ0KTt3aGlsZSgwIT09LS1hLnByZXZfbGVuZ3RoKTtpZihhLm1hdGNoX2F2YWlsYWJsZT0wLGEubWF0Y2hfbGVuZ3RoPWphLTEsYS5zdHJzdGFydCsrLGQmJihoKGEsITEpLDA9PT1hLnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gdWF9ZWxzZSBpZihhLm1hdGNoX2F2YWlsYWJsZSl7aWYoZD1GLl90cl90YWxseShhLDAsYS53aW5kb3dbYS5zdHJzdGFydC0xXSksZCYmaChhLCExKSxhLnN0cnN0YXJ0KyssYS5sb29rYWhlYWQtLSwwPT09YS5zdHJtLmF2YWlsX291dClyZXR1cm4gdWF9ZWxzZSBhLm1hdGNoX2F2YWlsYWJsZT0xLGEuc3Ryc3RhcnQrKyxhLmxvb2thaGVhZC0tfXJldHVybiBhLm1hdGNoX2F2YWlsYWJsZSYmKGQ9Ri5fdHJfdGFsbHkoYSwwLGEud2luZG93W2Euc3Ryc3RhcnQtMV0pLGEubWF0Y2hfYXZhaWxhYmxlPTApLGEuaW5zZXJ0PWEuc3Ryc3RhcnQ8amEtMT9hLnN0cnN0YXJ0OmphLTEsYj09PU0/KGgoYSwhMCksMD09PWEuc3RybS5hdmFpbF9vdXQ/d2E6eGEpOmEubGFzdF9saXQmJihoKGEsITEpLDA9PT1hLnN0cm0uYXZhaWxfb3V0KT91YTp2YX1mdW5jdGlvbiBxKGEsYil7Zm9yKHZhciBjLGQsZSxmLGc9YS53aW5kb3c7Oyl7aWYoYS5sb29rYWhlYWQ8PWthKXtpZihtKGEpLGEubG9va2FoZWFkPD1rYSYmYj09PUopcmV0dXJuIHVhO2lmKDA9PT1hLmxvb2thaGVhZClicmVha31pZihhLm1hdGNoX2xlbmd0aD0wLGEubG9va2FoZWFkPj1qYSYmYS5zdHJzdGFydD4wJiYoZT1hLnN0cnN0YXJ0LTEsZD1nW2VdLGQ9PT1nWysrZV0mJmQ9PT1nWysrZV0mJmQ9PT1nWysrZV0pKXtmPWEuc3Ryc3RhcnQra2E7ZG87d2hpbGUoZD09PWdbKytlXSYmZD09PWdbKytlXSYmZD09PWdbKytlXSYmZD09PWdbKytlXSYmZD09PWdbKytlXSYmZD09PWdbKytlXSYmZD09PWdbKytlXSYmZD09PWdbKytlXSYmZTxmKTthLm1hdGNoX2xlbmd0aD1rYS0oZi1lKSxhLm1hdGNoX2xlbmd0aD5hLmxvb2thaGVhZCYmKGEubWF0Y2hfbGVuZ3RoPWEubG9va2FoZWFkKX1pZihhLm1hdGNoX2xlbmd0aD49amE/KGM9Ri5fdHJfdGFsbHkoYSwxLGEubWF0Y2hfbGVuZ3RoLWphKSxhLmxvb2thaGVhZC09YS5tYXRjaF9sZW5ndGgsYS5zdHJzdGFydCs9YS5tYXRjaF9sZW5ndGgsYS5tYXRjaF9sZW5ndGg9MCk6KGM9Ri5fdHJfdGFsbHkoYSwwLGEud2luZG93W2Euc3Ryc3RhcnRdKSxhLmxvb2thaGVhZC0tLGEuc3Ryc3RhcnQrKyksYyYmKGgoYSwhMSksMD09PWEuc3RybS5hdmFpbF9vdXQpKXJldHVybiB1YX1yZXR1cm4gYS5pbnNlcnQ9MCxiPT09TT8oaChhLCEwKSwwPT09YS5zdHJtLmF2YWlsX291dD93YTp4YSk6YS5sYXN0X2xpdCYmKGgoYSwhMSksMD09PWEuc3RybS5hdmFpbF9vdXQpP3VhOnZhfWZ1bmN0aW9uIHIoYSxiKXtmb3IodmFyIGM7Oyl7aWYoMD09PWEubG9va2FoZWFkJiYobShhKSwwPT09YS5sb29rYWhlYWQpKXtpZihiPT09SilyZXR1cm4gdWE7YnJlYWt9aWYoYS5tYXRjaF9sZW5ndGg9MCxjPUYuX3RyX3RhbGx5KGEsMCxhLndpbmRvd1thLnN0cnN0YXJ0XSksYS5sb29rYWhlYWQtLSxhLnN0cnN0YXJ0KyssYyYmKGgoYSwhMSksMD09PWEuc3RybS5hdmFpbF9vdXQpKXJldHVybiB1YX1yZXR1cm4gYS5pbnNlcnQ9MCxiPT09TT8oaChhLCEwKSwwPT09YS5zdHJtLmF2YWlsX291dD93YTp4YSk6YS5sYXN0X2xpdCYmKGgoYSwhMSksMD09PWEuc3RybS5hdmFpbF9vdXQpP3VhOnZhfWZ1bmN0aW9uIHMoYSxiLGMsZCxlKXt0aGlzLmdvb2RfbGVuZ3RoPWEsdGhpcy5tYXhfbGF6eT1iLHRoaXMubmljZV9sZW5ndGg9Yyx0aGlzLm1heF9jaGFpbj1kLHRoaXMuZnVuYz1lfWZ1bmN0aW9uIHQoYSl7YS53aW5kb3dfc2l6ZT0yKmEud19zaXplLGYoYS5oZWFkKSxhLm1heF9sYXp5X21hdGNoPURbYS5sZXZlbF0ubWF4X2xhenksYS5nb29kX21hdGNoPURbYS5sZXZlbF0uZ29vZF9sZW5ndGgsYS5uaWNlX21hdGNoPURbYS5sZXZlbF0ubmljZV9sZW5ndGgsYS5tYXhfY2hhaW5fbGVuZ3RoPURbYS5sZXZlbF0ubWF4X2NoYWluLGEuc3Ryc3RhcnQ9MCxhLmJsb2NrX3N0YXJ0PTAsYS5sb29rYWhlYWQ9MCxhLmluc2VydD0wLGEubWF0Y2hfbGVuZ3RoPWEucHJldl9sZW5ndGg9amEtMSxhLm1hdGNoX2F2YWlsYWJsZT0wLGEuaW5zX2g9MH1mdW5jdGlvbiB1KCl7dGhpcy5zdHJtPW51bGwsdGhpcy5zdGF0dXM9MCx0aGlzLnBlbmRpbmdfYnVmPW51bGwsdGhpcy5wZW5kaW5nX2J1Zl9zaXplPTAsdGhpcy5wZW5kaW5nX291dD0wLHRoaXMucGVuZGluZz0wLHRoaXMud3JhcD0wLHRoaXMuZ3poZWFkPW51bGwsdGhpcy5nemluZGV4PTAsdGhpcy5tZXRob2Q9JCx0aGlzLmxhc3RfZmx1c2g9LTEsdGhpcy53X3NpemU9MCx0aGlzLndfYml0cz0wLHRoaXMud19tYXNrPTAsdGhpcy53aW5kb3c9bnVsbCx0aGlzLndpbmRvd19zaXplPTAsdGhpcy5wcmV2PW51bGwsdGhpcy5oZWFkPW51bGwsdGhpcy5pbnNfaD0wLHRoaXMuaGFzaF9zaXplPTAsdGhpcy5oYXNoX2JpdHM9MCx0aGlzLmhhc2hfbWFzaz0wLHRoaXMuaGFzaF9zaGlmdD0wLHRoaXMuYmxvY2tfc3RhcnQ9MCx0aGlzLm1hdGNoX2xlbmd0aD0wLHRoaXMucHJldl9tYXRjaD0wLHRoaXMubWF0Y2hfYXZhaWxhYmxlPTAsdGhpcy5zdHJzdGFydD0wLHRoaXMubWF0Y2hfc3RhcnQ9MCx0aGlzLmxvb2thaGVhZD0wLHRoaXMucHJldl9sZW5ndGg9MCx0aGlzLm1heF9jaGFpbl9sZW5ndGg9MCx0aGlzLm1heF9sYXp5X21hdGNoPTAsdGhpcy5sZXZlbD0wLHRoaXMuc3RyYXRlZ3k9MCx0aGlzLmdvb2RfbWF0Y2g9MCx0aGlzLm5pY2VfbWF0Y2g9MCx0aGlzLmR5bl9sdHJlZT1uZXcgRS5CdWYxNigyKmhhKSx0aGlzLmR5bl9kdHJlZT1uZXcgRS5CdWYxNigyKigyKmZhKzEpKSx0aGlzLmJsX3RyZWU9bmV3IEUuQnVmMTYoMiooMipnYSsxKSksZih0aGlzLmR5bl9sdHJlZSksZih0aGlzLmR5bl9kdHJlZSksZih0aGlzLmJsX3RyZWUpLHRoaXMubF9kZXNjPW51bGwsdGhpcy5kX2Rlc2M9bnVsbCx0aGlzLmJsX2Rlc2M9bnVsbCx0aGlzLmJsX2NvdW50PW5ldyBFLkJ1ZjE2KGlhKzEpLHRoaXMuaGVhcD1uZXcgRS5CdWYxNigyKmVhKzEpLGYodGhpcy5oZWFwKSx0aGlzLmhlYXBfbGVuPTAsdGhpcy5oZWFwX21heD0wLHRoaXMuZGVwdGg9bmV3IEUuQnVmMTYoMiplYSsxKSxmKHRoaXMuZGVwdGgpLHRoaXMubF9idWY9MCx0aGlzLmxpdF9idWZzaXplPTAsdGhpcy5sYXN0X2xpdD0wLHRoaXMuZF9idWY9MCx0aGlzLm9wdF9sZW49MCx0aGlzLnN0YXRpY19sZW49MCx0aGlzLm1hdGNoZXM9MCx0aGlzLmluc2VydD0wLHRoaXMuYmlfYnVmPTAsdGhpcy5iaV92YWxpZD0wfWZ1bmN0aW9uIHYoYSl7dmFyIGI7cmV0dXJuIGEmJmEuc3RhdGU/KGEudG90YWxfaW49YS50b3RhbF9vdXQ9MCxhLmRhdGFfdHlwZT1aLGI9YS5zdGF0ZSxiLnBlbmRpbmc9MCxiLnBlbmRpbmdfb3V0PTAsYi53cmFwPDAmJihiLndyYXA9LWIud3JhcCksYi5zdGF0dXM9Yi53cmFwP25hOnNhLGEuYWRsZXI9Mj09PWIud3JhcD8wOjEsYi5sYXN0X2ZsdXNoPUosRi5fdHJfaW5pdChiKSxPKTpkKGEsUSl9ZnVuY3Rpb24gdyhhKXt2YXIgYj12KGEpO3JldHVybiBiPT09TyYmdChhLnN0YXRlKSxifWZ1bmN0aW9uIHgoYSxiKXtyZXR1cm4gYSYmYS5zdGF0ZT8yIT09YS5zdGF0ZS53cmFwP1E6KGEuc3RhdGUuZ3poZWFkPWIsTyk6UX1mdW5jdGlvbiB5KGEsYixjLGUsZixnKXtpZighYSlyZXR1cm4gUTt2YXIgaD0xO2lmKGI9PT1UJiYoYj02KSxlPDA/KGg9MCxlPS1lKTplPjE1JiYoaD0yLGUtPTE2KSxmPDF8fGY+X3x8YyE9PSR8fGU8OHx8ZT4xNXx8YjwwfHxiPjl8fGc8MHx8Zz5YKXJldHVybiBkKGEsUSk7OD09PWUmJihlPTkpO3ZhciBpPW5ldyB1O3JldHVybiBhLnN0YXRlPWksaS5zdHJtPWEsaS53cmFwPWgsaS5nemhlYWQ9bnVsbCxpLndfYml0cz1lLGkud19zaXplPTE8PGkud19iaXRzLGkud19tYXNrPWkud19zaXplLTEsaS5oYXNoX2JpdHM9Zis3LGkuaGFzaF9zaXplPTE8PGkuaGFzaF9iaXRzLGkuaGFzaF9tYXNrPWkuaGFzaF9zaXplLTEsaS5oYXNoX3NoaWZ0PX5+KChpLmhhc2hfYml0cytqYS0xKS9qYSksaS53aW5kb3c9bmV3IEUuQnVmOCgyKmkud19zaXplKSxpLmhlYWQ9bmV3IEUuQnVmMTYoaS5oYXNoX3NpemUpLGkucHJldj1uZXcgRS5CdWYxNihpLndfc2l6ZSksaS5saXRfYnVmc2l6ZT0xPDxmKzYsaS5wZW5kaW5nX2J1Zl9zaXplPTQqaS5saXRfYnVmc2l6ZSxpLnBlbmRpbmdfYnVmPW5ldyBFLkJ1ZjgoaS5wZW5kaW5nX2J1Zl9zaXplKSxpLmRfYnVmPTEqaS5saXRfYnVmc2l6ZSxpLmxfYnVmPTMqaS5saXRfYnVmc2l6ZSxpLmxldmVsPWIsaS5zdHJhdGVneT1nLGkubWV0aG9kPWMsdyhhKX1mdW5jdGlvbiB6KGEsYil7cmV0dXJuIHkoYSxiLCQsYWEsYmEsWSl9ZnVuY3Rpb24gQShhLGIpe3ZhciBjLGgsayxsO2lmKCFhfHwhYS5zdGF0ZXx8Yj5OfHxiPDApcmV0dXJuIGE/ZChhLFEpOlE7aWYoaD1hLnN0YXRlLCFhLm91dHB1dHx8IWEuaW5wdXQmJjAhPT1hLmF2YWlsX2lufHxoLnN0YXR1cz09PXRhJiZiIT09TSlyZXR1cm4gZChhLDA9PT1hLmF2YWlsX291dD9TOlEpO2lmKGguc3RybT1hLGM9aC5sYXN0X2ZsdXNoLGgubGFzdF9mbHVzaD1iLGguc3RhdHVzPT09bmEpaWYoMj09PWgud3JhcClhLmFkbGVyPTAsaShoLDMxKSxpKGgsMTM5KSxpKGgsOCksaC5nemhlYWQ/KGkoaCwoaC5nemhlYWQudGV4dD8xOjApKyhoLmd6aGVhZC5oY3JjPzI6MCkrKGguZ3poZWFkLmV4dHJhPzQ6MCkrKGguZ3poZWFkLm5hbWU/ODowKSsoaC5nemhlYWQuY29tbWVudD8xNjowKSksaShoLDI1NSZoLmd6aGVhZC50aW1lKSxpKGgsaC5nemhlYWQudGltZT4+OCYyNTUpLGkoaCxoLmd6aGVhZC50aW1lPj4xNiYyNTUpLGkoaCxoLmd6aGVhZC50aW1lPj4yNCYyNTUpLGkoaCw5PT09aC5sZXZlbD8yOmguc3RyYXRlZ3k+PVZ8fGgubGV2ZWw8Mj80OjApLGkoaCwyNTUmaC5nemhlYWQub3MpLGguZ3poZWFkLmV4dHJhJiZoLmd6aGVhZC5leHRyYS5sZW5ndGgmJihpKGgsMjU1JmguZ3poZWFkLmV4dHJhLmxlbmd0aCksaShoLGguZ3poZWFkLmV4dHJhLmxlbmd0aD4+OCYyNTUpKSxoLmd6aGVhZC5oY3JjJiYoYS5hZGxlcj1IKGEuYWRsZXIsaC5wZW5kaW5nX2J1ZixoLnBlbmRpbmcsMCkpLGguZ3ppbmRleD0wLGguc3RhdHVzPW9hKTooaShoLDApLGkoaCwwKSxpKGgsMCksaShoLDApLGkoaCwwKSxpKGgsOT09PWgubGV2ZWw/MjpoLnN0cmF0ZWd5Pj1WfHxoLmxldmVsPDI/NDowKSxpKGgseWEpLGguc3RhdHVzPXNhKTtlbHNle3ZhciBtPSQrKGgud19iaXRzLTg8PDQpPDw4LG49LTE7bj1oLnN0cmF0ZWd5Pj1WfHxoLmxldmVsPDI/MDpoLmxldmVsPDY/MTo2PT09aC5sZXZlbD8yOjMsbXw9bjw8NiwwIT09aC5zdHJzdGFydCYmKG18PW1hKSxtKz0zMS1tJTMxLGguc3RhdHVzPXNhLGooaCxtKSwwIT09aC5zdHJzdGFydCYmKGooaCxhLmFkbGVyPj4+MTYpLGooaCw2NTUzNSZhLmFkbGVyKSksYS5hZGxlcj0xfWlmKGguc3RhdHVzPT09b2EpaWYoaC5nemhlYWQuZXh0cmEpe2ZvcihrPWgucGVuZGluZztoLmd6aW5kZXg8KDY1NTM1JmguZ3poZWFkLmV4dHJhLmxlbmd0aCkmJihoLnBlbmRpbmchPT1oLnBlbmRpbmdfYnVmX3NpemV8fChoLmd6aGVhZC5oY3JjJiZoLnBlbmRpbmc+ayYmKGEuYWRsZXI9SChhLmFkbGVyLGgucGVuZGluZ19idWYsaC5wZW5kaW5nLWssaykpLGcoYSksaz1oLnBlbmRpbmcsaC5wZW5kaW5nIT09aC5wZW5kaW5nX2J1Zl9zaXplKSk7KWkoaCwyNTUmaC5nemhlYWQuZXh0cmFbaC5nemluZGV4XSksaC5nemluZGV4Kys7aC5nemhlYWQuaGNyYyYmaC5wZW5kaW5nPmsmJihhLmFkbGVyPUgoYS5hZGxlcixoLnBlbmRpbmdfYnVmLGgucGVuZGluZy1rLGspKSxoLmd6aW5kZXg9PT1oLmd6aGVhZC5leHRyYS5sZW5ndGgmJihoLmd6aW5kZXg9MCxoLnN0YXR1cz1wYSl9ZWxzZSBoLnN0YXR1cz1wYTtpZihoLnN0YXR1cz09PXBhKWlmKGguZ3poZWFkLm5hbWUpe2s9aC5wZW5kaW5nO2Rve2lmKGgucGVuZGluZz09PWgucGVuZGluZ19idWZfc2l6ZSYmKGguZ3poZWFkLmhjcmMmJmgucGVuZGluZz5rJiYoYS5hZGxlcj1IKGEuYWRsZXIsaC5wZW5kaW5nX2J1ZixoLnBlbmRpbmctayxrKSksZyhhKSxrPWgucGVuZGluZyxoLnBlbmRpbmc9PT1oLnBlbmRpbmdfYnVmX3NpemUpKXtsPTE7YnJlYWt9bD1oLmd6aW5kZXg8aC5nemhlYWQubmFtZS5sZW5ndGg/MjU1JmguZ3poZWFkLm5hbWUuY2hhckNvZGVBdChoLmd6aW5kZXgrKyk6MCxpKGgsbCl9d2hpbGUoMCE9PWwpO2guZ3poZWFkLmhjcmMmJmgucGVuZGluZz5rJiYoYS5hZGxlcj1IKGEuYWRsZXIsaC5wZW5kaW5nX2J1ZixoLnBlbmRpbmctayxrKSksMD09PWwmJihoLmd6aW5kZXg9MCxoLnN0YXR1cz1xYSl9ZWxzZSBoLnN0YXR1cz1xYTtpZihoLnN0YXR1cz09PXFhKWlmKGguZ3poZWFkLmNvbW1lbnQpe2s9aC5wZW5kaW5nO2Rve2lmKGgucGVuZGluZz09PWgucGVuZGluZ19idWZfc2l6ZSYmKGguZ3poZWFkLmhjcmMmJmgucGVuZGluZz5rJiYoYS5hZGxlcj1IKGEuYWRsZXIsaC5wZW5kaW5nX2J1ZixoLnBlbmRpbmctayxrKSksZyhhKSxrPWgucGVuZGluZyxoLnBlbmRpbmc9PT1oLnBlbmRpbmdfYnVmX3NpemUpKXtsPTE7YnJlYWt9bD1oLmd6aW5kZXg8aC5nemhlYWQuY29tbWVudC5sZW5ndGg/MjU1JmguZ3poZWFkLmNvbW1lbnQuY2hhckNvZGVBdChoLmd6aW5kZXgrKyk6MCxpKGgsbCl9d2hpbGUoMCE9PWwpO2guZ3poZWFkLmhjcmMmJmgucGVuZGluZz5rJiYoYS5hZGxlcj1IKGEuYWRsZXIsaC5wZW5kaW5nX2J1ZixoLnBlbmRpbmctayxrKSksMD09PWwmJihoLnN0YXR1cz1yYSl9ZWxzZSBoLnN0YXR1cz1yYTtpZihoLnN0YXR1cz09PXJhJiYoaC5nemhlYWQuaGNyYz8oaC5wZW5kaW5nKzI+aC5wZW5kaW5nX2J1Zl9zaXplJiZnKGEpLGgucGVuZGluZysyPD1oLnBlbmRpbmdfYnVmX3NpemUmJihpKGgsMjU1JmEuYWRsZXIpLGkoaCxhLmFkbGVyPj44JjI1NSksYS5hZGxlcj0wLGguc3RhdHVzPXNhKSk6aC5zdGF0dXM9c2EpLDAhPT1oLnBlbmRpbmcpe2lmKGcoYSksMD09PWEuYXZhaWxfb3V0KXJldHVybiBoLmxhc3RfZmx1c2g9LTEsT31lbHNlIGlmKDA9PT1hLmF2YWlsX2luJiZlKGIpPD1lKGMpJiZiIT09TSlyZXR1cm4gZChhLFMpO2lmKGguc3RhdHVzPT09dGEmJjAhPT1hLmF2YWlsX2luKXJldHVybiBkKGEsUyk7aWYoMCE9PWEuYXZhaWxfaW58fDAhPT1oLmxvb2thaGVhZHx8YiE9PUomJmguc3RhdHVzIT09dGEpe3ZhciBvPWguc3RyYXRlZ3k9PT1WP3IoaCxiKTpoLnN0cmF0ZWd5PT09Vz9xKGgsYik6RFtoLmxldmVsXS5mdW5jKGgsYik7aWYobyE9PXdhJiZvIT09eGF8fChoLnN0YXR1cz10YSksbz09PXVhfHxvPT09d2EpcmV0dXJuIDA9PT1hLmF2YWlsX291dCYmKGgubGFzdF9mbHVzaD0tMSksTztpZihvPT09dmEmJihiPT09Sz9GLl90cl9hbGlnbihoKTpiIT09TiYmKEYuX3RyX3N0b3JlZF9ibG9jayhoLDAsMCwhMSksYj09PUwmJihmKGguaGVhZCksMD09PWgubG9va2FoZWFkJiYoaC5zdHJzdGFydD0wLGguYmxvY2tfc3RhcnQ9MCxoLmluc2VydD0wKSkpLGcoYSksMD09PWEuYXZhaWxfb3V0KSlyZXR1cm4gaC5sYXN0X2ZsdXNoPS0xLE99cmV0dXJuIGIhPT1NP086aC53cmFwPD0wP1A6KDI9PT1oLndyYXA/KGkoaCwyNTUmYS5hZGxlciksaShoLGEuYWRsZXI+PjgmMjU1KSxpKGgsYS5hZGxlcj4+MTYmMjU1KSxpKGgsYS5hZGxlcj4+MjQmMjU1KSxpKGgsMjU1JmEudG90YWxfaW4pLGkoaCxhLnRvdGFsX2luPj44JjI1NSksaShoLGEudG90YWxfaW4+PjE2JjI1NSksaShoLGEudG90YWxfaW4+PjI0JjI1NSkpOihqKGgsYS5hZGxlcj4+PjE2KSxqKGgsNjU1MzUmYS5hZGxlcikpLGcoYSksaC53cmFwPjAmJihoLndyYXA9LWgud3JhcCksMCE9PWgucGVuZGluZz9POlApfWZ1bmN0aW9uIEIoYSl7dmFyIGI7cmV0dXJuIGEmJmEuc3RhdGU/KGI9YS5zdGF0ZS5zdGF0dXMsYiE9PW5hJiZiIT09b2EmJmIhPT1wYSYmYiE9PXFhJiZiIT09cmEmJmIhPT1zYSYmYiE9PXRhP2QoYSxRKTooYS5zdGF0ZT1udWxsLGI9PT1zYT9kKGEsUik6TykpOlF9ZnVuY3Rpb24gQyhhLGIpe3ZhciBjLGQsZSxnLGgsaSxqLGssbD1iLmxlbmd0aDtpZighYXx8IWEuc3RhdGUpcmV0dXJuIFE7aWYoYz1hLnN0YXRlLGc9Yy53cmFwLDI9PT1nfHwxPT09ZyYmYy5zdGF0dXMhPT1uYXx8Yy5sb29rYWhlYWQpcmV0dXJuIFE7Zm9yKDE9PT1nJiYoYS5hZGxlcj1HKGEuYWRsZXIsYixsLDApKSxjLndyYXA9MCxsPj1jLndfc2l6ZSYmKDA9PT1nJiYoZihjLmhlYWQpLGMuc3Ryc3RhcnQ9MCxjLmJsb2NrX3N0YXJ0PTAsYy5pbnNlcnQ9MCksaz1uZXcgRS5CdWY4KGMud19zaXplKSxFLmFycmF5U2V0KGssYixsLWMud19zaXplLGMud19zaXplLDApLGI9ayxsPWMud19zaXplKSxoPWEuYXZhaWxfaW4saT1hLm5leHRfaW4saj1hLmlucHV0LGEuYXZhaWxfaW49bCxhLm5leHRfaW49MCxhLmlucHV0PWIsbShjKTtjLmxvb2thaGVhZD49amE7KXtkPWMuc3Ryc3RhcnQsZT1jLmxvb2thaGVhZC0oamEtMSk7ZG8gYy5pbnNfaD0oYy5pbnNfaDw8Yy5oYXNoX3NoaWZ0XmMud2luZG93W2QramEtMV0pJmMuaGFzaF9tYXNrLGMucHJldltkJmMud19tYXNrXT1jLmhlYWRbYy5pbnNfaF0sYy5oZWFkW2MuaW5zX2hdPWQsZCsrO3doaWxlKC0tZSk7Yy5zdHJzdGFydD1kLGMubG9va2FoZWFkPWphLTEsbShjKX1yZXR1cm4gYy5zdHJzdGFydCs9Yy5sb29rYWhlYWQsYy5ibG9ja19zdGFydD1jLnN0cnN0YXJ0LGMuaW5zZXJ0PWMubG9va2FoZWFkLGMubG9va2FoZWFkPTAsYy5tYXRjaF9sZW5ndGg9Yy5wcmV2X2xlbmd0aD1qYS0xLGMubWF0Y2hfYXZhaWxhYmxlPTAsYS5uZXh0X2luPWksYS5pbnB1dD1qLGEuYXZhaWxfaW49aCxjLndyYXA9ZyxPfXZhciBELEU9YShcIi4uL3V0aWxzL2NvbW1vblwiKSxGPWEoXCIuL3RyZWVzXCIpLEc9YShcIi4vYWRsZXIzMlwiKSxIPWEoXCIuL2NyYzMyXCIpLEk9YShcIi4vbWVzc2FnZXNcIiksSj0wLEs9MSxMPTMsTT00LE49NSxPPTAsUD0xLFE9LTIsUj0tMyxTPS01LFQ9LTEsVT0xLFY9MixXPTMsWD00LFk9MCxaPTIsJD04LF89OSxhYT0xNSxiYT04LGNhPTI5LGRhPTI1NixlYT1kYSsxK2NhLGZhPTMwLGdhPTE5LGhhPTIqZWErMSxpYT0xNSxqYT0zLGthPTI1OCxsYT1rYStqYSsxLG1hPTMyLG5hPTQyLG9hPTY5LHBhPTczLHFhPTkxLHJhPTEwMyxzYT0xMTMsdGE9NjY2LHVhPTEsdmE9Mix3YT0zLHhhPTQseWE9MztEPVtuZXcgcygwLDAsMCwwLG4pLG5ldyBzKDQsNCw4LDQsbyksbmV3IHMoNCw1LDE2LDgsbyksbmV3IHMoNCw2LDMyLDMyLG8pLG5ldyBzKDQsNCwxNiwxNixwKSxuZXcgcyg4LDE2LDMyLDMyLHApLG5ldyBzKDgsMTYsMTI4LDEyOCxwKSxuZXcgcyg4LDMyLDEyOCwyNTYscCksbmV3IHMoMzIsMTI4LDI1OCwxMDI0LHApLG5ldyBzKDMyLDI1OCwyNTgsNDA5NixwKV0sYy5kZWZsYXRlSW5pdD16LGMuZGVmbGF0ZUluaXQyPXksYy5kZWZsYXRlUmVzZXQ9dyxjLmRlZmxhdGVSZXNldEtlZXA9dixjLmRlZmxhdGVTZXRIZWFkZXI9eCxjLmRlZmxhdGU9QSxjLmRlZmxhdGVFbmQ9QixjLmRlZmxhdGVTZXREaWN0aW9uYXJ5PUMsYy5kZWZsYXRlSW5mbz1cInBha28gZGVmbGF0ZSAoZnJvbSBOb2RlY2EgcHJvamVjdClcIn0se1wiLi4vdXRpbHMvY29tbW9uXCI6NjIsXCIuL2FkbGVyMzJcIjo2NCxcIi4vY3JjMzJcIjo2NixcIi4vbWVzc2FnZXNcIjo3MixcIi4vdHJlZXNcIjo3M31dLDY4OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZCgpe3RoaXMudGV4dD0wLHRoaXMudGltZT0wLHRoaXMueGZsYWdzPTAsdGhpcy5vcz0wLHRoaXMuZXh0cmE9bnVsbCx0aGlzLmV4dHJhX2xlbj0wLHRoaXMubmFtZT1cIlwiLHRoaXMuY29tbWVudD1cIlwiLHRoaXMuaGNyYz0wLHRoaXMuZG9uZT0hMX1iLmV4cG9ydHM9ZH0se31dLDY5OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGQ9MzAsZT0xMjtiLmV4cG9ydHM9ZnVuY3Rpb24oYSxiKXt2YXIgYyxmLGcsaCxpLGosayxsLG0sbixvLHAscSxyLHMsdCx1LHYsdyx4LHkseixBLEIsQztjPWEuc3RhdGUsZj1hLm5leHRfaW4sQj1hLmlucHV0LGc9ZisoYS5hdmFpbF9pbi01KSxoPWEubmV4dF9vdXQsQz1hLm91dHB1dCxpPWgtKGItYS5hdmFpbF9vdXQpLGo9aCsoYS5hdmFpbF9vdXQtMjU3KSxrPWMuZG1heCxsPWMud3NpemUsbT1jLndoYXZlLG49Yy53bmV4dCxvPWMud2luZG93LHA9Yy5ob2xkLHE9Yy5iaXRzLHI9Yy5sZW5jb2RlLHM9Yy5kaXN0Y29kZSx0PSgxPDxjLmxlbmJpdHMpLTEsdT0oMTw8Yy5kaXN0Yml0cyktMTthOmRve3E8MTUmJihwKz1CW2YrK108PHEscSs9OCxwKz1CW2YrK108PHEscSs9OCksdj1yW3AmdF07Yjpmb3IoOzspe2lmKHc9dj4+PjI0LHA+Pj49dyxxLT13LHc9dj4+PjE2JjI1NSwwPT09dylDW2grK109NjU1MzUmdjtlbHNle2lmKCEoMTYmdykpe2lmKDA9PT0oNjQmdykpe3Y9clsoNjU1MzUmdikrKHAmKDE8PHcpLTEpXTtjb250aW51ZSBifWlmKDMyJncpe2MubW9kZT1lO2JyZWFrIGF9YS5tc2c9XCJpbnZhbGlkIGxpdGVyYWwvbGVuZ3RoIGNvZGVcIixjLm1vZGU9ZDticmVhayBhfXg9NjU1MzUmdix3Jj0xNSx3JiYocTx3JiYocCs9QltmKytdPDxxLHErPTgpLHgrPXAmKDE8PHcpLTEscD4+Pj13LHEtPXcpLHE8MTUmJihwKz1CW2YrK108PHEscSs9OCxwKz1CW2YrK108PHEscSs9OCksdj1zW3AmdV07Yzpmb3IoOzspe2lmKHc9dj4+PjI0LHA+Pj49dyxxLT13LHc9dj4+PjE2JjI1NSwhKDE2JncpKXtpZigwPT09KDY0JncpKXt2PXNbKDY1NTM1JnYpKyhwJigxPDx3KS0xKV07Y29udGludWUgY31hLm1zZz1cImludmFsaWQgZGlzdGFuY2UgY29kZVwiLGMubW9kZT1kO2JyZWFrIGF9aWYoeT02NTUzNSZ2LHcmPTE1LHE8dyYmKHArPUJbZisrXTw8cSxxKz04LHE8dyYmKHArPUJbZisrXTw8cSxxKz04KSkseSs9cCYoMTw8dyktMSx5Pmspe2EubXNnPVwiaW52YWxpZCBkaXN0YW5jZSB0b28gZmFyIGJhY2tcIixjLm1vZGU9ZDticmVhayBhfWlmKHA+Pj49dyxxLT13LHc9aC1pLHk+dyl7aWYodz15LXcsdz5tJiZjLnNhbmUpe2EubXNnPVwiaW52YWxpZCBkaXN0YW5jZSB0b28gZmFyIGJhY2tcIixjLm1vZGU9ZDticmVhayBhfWlmKHo9MCxBPW8sMD09PW4pe2lmKHorPWwtdyx3PHgpe3gtPXc7ZG8gQ1toKytdPW9beisrXTt3aGlsZSgtLXcpO3o9aC15LEE9Q319ZWxzZSBpZihuPHcpe2lmKHorPWwrbi13LHctPW4sdzx4KXt4LT13O2RvIENbaCsrXT1vW3orK107d2hpbGUoLS13KTtpZih6PTAsbjx4KXt3PW4seC09dztkbyBDW2grK109b1t6KytdO3doaWxlKC0tdyk7ej1oLXksQT1DfX19ZWxzZSBpZih6Kz1uLXcsdzx4KXt4LT13O2RvIENbaCsrXT1vW3orK107d2hpbGUoLS13KTt6PWgteSxBPUN9Zm9yKDt4PjI7KUNbaCsrXT1BW3orK10sQ1toKytdPUFbeisrXSxDW2grK109QVt6KytdLHgtPTM7eCYmKENbaCsrXT1BW3orK10seD4xJiYoQ1toKytdPUFbeisrXSkpfWVsc2V7ej1oLXk7ZG8gQ1toKytdPUNbeisrXSxDW2grK109Q1t6KytdLENbaCsrXT1DW3orK10seC09Mzt3aGlsZSh4PjIpO3gmJihDW2grK109Q1t6KytdLHg+MSYmKENbaCsrXT1DW3orK10pKX1icmVha319YnJlYWt9fXdoaWxlKGY8ZyYmaDxqKTt4PXE+PjMsZi09eCxxLT14PDwzLHAmPSgxPDxxKS0xLGEubmV4dF9pbj1mLGEubmV4dF9vdXQ9aCxhLmF2YWlsX2luPWY8Zz81KyhnLWYpOjUtKGYtZyksYS5hdmFpbF9vdXQ9aDxqPzI1Nysoai1oKToyNTctKGgtaiksYy5ob2xkPXAsYy5iaXRzPXF9fSx7fV0sNzA6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEpe3JldHVybihhPj4+MjQmMjU1KSsoYT4+PjgmNjUyODApKygoNjUyODAmYSk8PDgpKygoMjU1JmEpPDwyNCl9ZnVuY3Rpb24gZSgpe3RoaXMubW9kZT0wLHRoaXMubGFzdD0hMSx0aGlzLndyYXA9MCx0aGlzLmhhdmVkaWN0PSExLHRoaXMuZmxhZ3M9MCx0aGlzLmRtYXg9MCx0aGlzLmNoZWNrPTAsdGhpcy50b3RhbD0wLHRoaXMuaGVhZD1udWxsLHRoaXMud2JpdHM9MCx0aGlzLndzaXplPTAsdGhpcy53aGF2ZT0wLHRoaXMud25leHQ9MCx0aGlzLndpbmRvdz1udWxsLHRoaXMuaG9sZD0wLHRoaXMuYml0cz0wLHRoaXMubGVuZ3RoPTAsdGhpcy5vZmZzZXQ9MCx0aGlzLmV4dHJhPTAsdGhpcy5sZW5jb2RlPW51bGwsdGhpcy5kaXN0Y29kZT1udWxsLHRoaXMubGVuYml0cz0wLHRoaXMuZGlzdGJpdHM9MCx0aGlzLm5jb2RlPTAsdGhpcy5ubGVuPTAsdGhpcy5uZGlzdD0wLHRoaXMuaGF2ZT0wLHRoaXMubmV4dD1udWxsLHRoaXMubGVucz1uZXcgcy5CdWYxNigzMjApLHRoaXMud29yaz1uZXcgcy5CdWYxNigyODgpLHRoaXMubGVuZHluPW51bGwsdGhpcy5kaXN0ZHluPW51bGwsdGhpcy5zYW5lPTAsdGhpcy5iYWNrPTAsdGhpcy53YXM9MH1mdW5jdGlvbiBmKGEpe3ZhciBiO3JldHVybiBhJiZhLnN0YXRlPyhiPWEuc3RhdGUsYS50b3RhbF9pbj1hLnRvdGFsX291dD1iLnRvdGFsPTAsYS5tc2c9XCJcIixiLndyYXAmJihhLmFkbGVyPTEmYi53cmFwKSxiLm1vZGU9TCxiLmxhc3Q9MCxiLmhhdmVkaWN0PTAsYi5kbWF4PTMyNzY4LGIuaGVhZD1udWxsLGIuaG9sZD0wLGIuYml0cz0wLGIubGVuY29kZT1iLmxlbmR5bj1uZXcgcy5CdWYzMihwYSksYi5kaXN0Y29kZT1iLmRpc3RkeW49bmV3IHMuQnVmMzIocWEpLGIuc2FuZT0xLGIuYmFjaz0tMSxEKTpHfWZ1bmN0aW9uIGcoYSl7dmFyIGI7cmV0dXJuIGEmJmEuc3RhdGU/KGI9YS5zdGF0ZSxiLndzaXplPTAsYi53aGF2ZT0wLGIud25leHQ9MCxmKGEpKTpHfWZ1bmN0aW9uIGgoYSxiKXt2YXIgYyxkO3JldHVybiBhJiZhLnN0YXRlPyhkPWEuc3RhdGUsYjwwPyhjPTAsYj0tYik6KGM9KGI+PjQpKzEsYjw0OCYmKGImPTE1KSksYiYmKGI8OHx8Yj4xNSk/RzoobnVsbCE9PWQud2luZG93JiZkLndiaXRzIT09YiYmKGQud2luZG93PW51bGwpLGQud3JhcD1jLGQud2JpdHM9YixnKGEpKSk6R31mdW5jdGlvbiBpKGEsYil7dmFyIGMsZDtyZXR1cm4gYT8oZD1uZXcgZSxhLnN0YXRlPWQsZC53aW5kb3c9bnVsbCxjPWgoYSxiKSxjIT09RCYmKGEuc3RhdGU9bnVsbCksYyk6R31mdW5jdGlvbiBqKGEpe3JldHVybiBpKGEsc2EpfWZ1bmN0aW9uIGsoYSl7aWYodGEpe3ZhciBiO2ZvcihxPW5ldyBzLkJ1ZjMyKDUxMikscj1uZXcgcy5CdWYzMigzMiksYj0wO2I8MTQ0OylhLmxlbnNbYisrXT04O2Zvcig7YjwyNTY7KWEubGVuc1tiKytdPTk7Zm9yKDtiPDI4MDspYS5sZW5zW2IrK109Nztmb3IoO2I8Mjg4OylhLmxlbnNbYisrXT04O2Zvcih3KHksYS5sZW5zLDAsMjg4LHEsMCxhLndvcmsse2JpdHM6OX0pLGI9MDtiPDMyOylhLmxlbnNbYisrXT01O3coeixhLmxlbnMsMCwzMixyLDAsYS53b3JrLHtiaXRzOjV9KSx0YT0hMX1hLmxlbmNvZGU9cSxhLmxlbmJpdHM9OSxhLmRpc3Rjb2RlPXIsYS5kaXN0Yml0cz01fWZ1bmN0aW9uIGwoYSxiLGMsZCl7dmFyIGUsZj1hLnN0YXRlO3JldHVybiBudWxsPT09Zi53aW5kb3cmJihmLndzaXplPTE8PGYud2JpdHMsZi53bmV4dD0wLGYud2hhdmU9MCxmLndpbmRvdz1uZXcgcy5CdWY4KGYud3NpemUpKSxkPj1mLndzaXplPyhzLmFycmF5U2V0KGYud2luZG93LGIsYy1mLndzaXplLGYud3NpemUsMCksZi53bmV4dD0wLGYud2hhdmU9Zi53c2l6ZSk6KGU9Zi53c2l6ZS1mLnduZXh0LGU+ZCYmKGU9ZCkscy5hcnJheVNldChmLndpbmRvdyxiLGMtZCxlLGYud25leHQpLGQtPWUsZD8ocy5hcnJheVNldChmLndpbmRvdyxiLGMtZCxkLDApLGYud25leHQ9ZCxmLndoYXZlPWYud3NpemUpOihmLnduZXh0Kz1lLGYud25leHQ9PT1mLndzaXplJiYoZi53bmV4dD0wKSxmLndoYXZlPGYud3NpemUmJihmLndoYXZlKz1lKSkpLDB9ZnVuY3Rpb24gbShhLGIpe3ZhciBjLGUsZixnLGgsaSxqLG0sbixvLHAscSxyLHBhLHFhLHJhLHNhLHRhLHVhLHZhLHdhLHhhLHlhLHphLEFhPTAsQmE9bmV3IHMuQnVmOCg0KSxDYT1bMTYsMTcsMTgsMCw4LDcsOSw2LDEwLDUsMTEsNCwxMiwzLDEzLDIsMTQsMSwxNV07aWYoIWF8fCFhLnN0YXRlfHwhYS5vdXRwdXR8fCFhLmlucHV0JiYwIT09YS5hdmFpbF9pbilyZXR1cm4gRztjPWEuc3RhdGUsYy5tb2RlPT09VyYmKGMubW9kZT1YKSxoPWEubmV4dF9vdXQsZj1hLm91dHB1dCxqPWEuYXZhaWxfb3V0LGc9YS5uZXh0X2luLGU9YS5pbnB1dCxpPWEuYXZhaWxfaW4sbT1jLmhvbGQsbj1jLmJpdHMsbz1pLHA9aix4YT1EO2E6Zm9yKDs7KXN3aXRjaChjLm1vZGUpe2Nhc2UgTDppZigwPT09Yy53cmFwKXtjLm1vZGU9WDticmVha31mb3IoO248MTY7KXtpZigwPT09aSlicmVhayBhO2ktLSxtKz1lW2crK108PG4sbis9OH1pZigyJmMud3JhcCYmMzU2MTU9PT1tKXtjLmNoZWNrPTAsQmFbMF09MjU1Jm0sQmFbMV09bT4+PjgmMjU1LGMuY2hlY2s9dShjLmNoZWNrLEJhLDIsMCksbT0wLG49MCxjLm1vZGU9TTticmVha31pZihjLmZsYWdzPTAsYy5oZWFkJiYoYy5oZWFkLmRvbmU9ITEpLCEoMSZjLndyYXApfHwoKCgyNTUmbSk8PDgpKyhtPj44KSklMzEpe2EubXNnPVwiaW5jb3JyZWN0IGhlYWRlciBjaGVja1wiLGMubW9kZT1tYTticmVha31pZigoMTUmbSkhPT1LKXthLm1zZz1cInVua25vd24gY29tcHJlc3Npb24gbWV0aG9kXCIsYy5tb2RlPW1hO2JyZWFrfWlmKG0+Pj49NCxuLT00LHdhPSgxNSZtKSs4LDA9PT1jLndiaXRzKWMud2JpdHM9d2E7ZWxzZSBpZih3YT5jLndiaXRzKXthLm1zZz1cImludmFsaWQgd2luZG93IHNpemVcIixjLm1vZGU9bWE7YnJlYWt9Yy5kbWF4PTE8PHdhLGEuYWRsZXI9Yy5jaGVjaz0xLGMubW9kZT01MTImbT9VOlcsbT0wLG49MDticmVhaztjYXNlIE06Zm9yKDtuPDE2Oyl7aWYoMD09PWkpYnJlYWsgYTtpLS0sbSs9ZVtnKytdPDxuLG4rPTh9aWYoYy5mbGFncz1tLCgyNTUmYy5mbGFncykhPT1LKXthLm1zZz1cInVua25vd24gY29tcHJlc3Npb24gbWV0aG9kXCIsYy5tb2RlPW1hO2JyZWFrfWlmKDU3MzQ0JmMuZmxhZ3Mpe2EubXNnPVwidW5rbm93biBoZWFkZXIgZmxhZ3Mgc2V0XCIsYy5tb2RlPW1hO2JyZWFrfWMuaGVhZCYmKGMuaGVhZC50ZXh0PW0+PjgmMSksNTEyJmMuZmxhZ3MmJihCYVswXT0yNTUmbSxCYVsxXT1tPj4+OCYyNTUsYy5jaGVjaz11KGMuY2hlY2ssQmEsMiwwKSksbT0wLG49MCxjLm1vZGU9TjtjYXNlIE46Zm9yKDtuPDMyOyl7aWYoMD09PWkpYnJlYWsgYTtpLS0sbSs9ZVtnKytdPDxuLG4rPTh9Yy5oZWFkJiYoYy5oZWFkLnRpbWU9bSksNTEyJmMuZmxhZ3MmJihCYVswXT0yNTUmbSxCYVsxXT1tPj4+OCYyNTUsQmFbMl09bT4+PjE2JjI1NSxCYVszXT1tPj4+MjQmMjU1LGMuY2hlY2s9dShjLmNoZWNrLEJhLDQsMCkpLG09MCxuPTAsYy5tb2RlPU87Y2FzZSBPOmZvcig7bjwxNjspe2lmKDA9PT1pKWJyZWFrIGE7aS0tLG0rPWVbZysrXTw8bixuKz04fWMuaGVhZCYmKGMuaGVhZC54ZmxhZ3M9MjU1Jm0sYy5oZWFkLm9zPW0+PjgpLDUxMiZjLmZsYWdzJiYoQmFbMF09MjU1Jm0sQmFbMV09bT4+PjgmMjU1LGMuY2hlY2s9dShjLmNoZWNrLEJhLDIsMCkpLG09MCxuPTAsYy5tb2RlPVA7Y2FzZSBQOmlmKDEwMjQmYy5mbGFncyl7Zm9yKDtuPDE2Oyl7aWYoMD09PWkpYnJlYWsgYTtpLS0sbSs9ZVtnKytdPDxuLG4rPTh9Yy5sZW5ndGg9bSxjLmhlYWQmJihjLmhlYWQuZXh0cmFfbGVuPW0pLDUxMiZjLmZsYWdzJiYoQmFbMF09MjU1Jm0sQmFbMV09bT4+PjgmMjU1LGMuY2hlY2s9dShjLmNoZWNrLEJhLDIsMCkpLG09MCxuPTB9ZWxzZSBjLmhlYWQmJihjLmhlYWQuZXh0cmE9bnVsbCk7Yy5tb2RlPVE7Y2FzZSBROmlmKDEwMjQmYy5mbGFncyYmKHE9Yy5sZW5ndGgscT5pJiYocT1pKSxxJiYoYy5oZWFkJiYod2E9Yy5oZWFkLmV4dHJhX2xlbi1jLmxlbmd0aCxjLmhlYWQuZXh0cmF8fChjLmhlYWQuZXh0cmE9bmV3IEFycmF5KGMuaGVhZC5leHRyYV9sZW4pKSxzLmFycmF5U2V0KGMuaGVhZC5leHRyYSxlLGcscSx3YSkpLDUxMiZjLmZsYWdzJiYoYy5jaGVjaz11KGMuY2hlY2ssZSxxLGcpKSxpLT1xLGcrPXEsYy5sZW5ndGgtPXEpLGMubGVuZ3RoKSlicmVhayBhO2MubGVuZ3RoPTAsYy5tb2RlPVI7Y2FzZSBSOmlmKDIwNDgmYy5mbGFncyl7aWYoMD09PWkpYnJlYWsgYTtxPTA7ZG8gd2E9ZVtnK3ErK10sYy5oZWFkJiZ3YSYmYy5sZW5ndGg8NjU1MzYmJihjLmhlYWQubmFtZSs9U3RyaW5nLmZyb21DaGFyQ29kZSh3YSkpO3doaWxlKHdhJiZxPGkpO2lmKDUxMiZjLmZsYWdzJiYoYy5jaGVjaz11KGMuY2hlY2ssZSxxLGcpKSxpLT1xLGcrPXEsd2EpYnJlYWsgYX1lbHNlIGMuaGVhZCYmKGMuaGVhZC5uYW1lPW51bGwpO2MubGVuZ3RoPTAsYy5tb2RlPVM7Y2FzZSBTOmlmKDQwOTYmYy5mbGFncyl7aWYoMD09PWkpYnJlYWsgYTtxPTA7ZG8gd2E9ZVtnK3ErK10sYy5oZWFkJiZ3YSYmYy5sZW5ndGg8NjU1MzYmJihjLmhlYWQuY29tbWVudCs9U3RyaW5nLmZyb21DaGFyQ29kZSh3YSkpO3doaWxlKHdhJiZxPGkpO2lmKDUxMiZjLmZsYWdzJiYoYy5jaGVjaz11KGMuY2hlY2ssZSxxLGcpKSxpLT1xLGcrPXEsd2EpYnJlYWsgYX1lbHNlIGMuaGVhZCYmKGMuaGVhZC5jb21tZW50PW51bGwpO2MubW9kZT1UO2Nhc2UgVDppZig1MTImYy5mbGFncyl7Zm9yKDtuPDE2Oyl7aWYoMD09PWkpYnJlYWsgYTtpLS0sbSs9ZVtnKytdPDxuLG4rPTh9aWYobSE9PSg2NTUzNSZjLmNoZWNrKSl7YS5tc2c9XCJoZWFkZXIgY3JjIG1pc21hdGNoXCIsYy5tb2RlPW1hO2JyZWFrfW09MCxuPTB9Yy5oZWFkJiYoYy5oZWFkLmhjcmM9Yy5mbGFncz4+OSYxLGMuaGVhZC5kb25lPSEwKSxhLmFkbGVyPWMuY2hlY2s9MCxjLm1vZGU9VzticmVhaztjYXNlIFU6Zm9yKDtuPDMyOyl7aWYoMD09PWkpYnJlYWsgYTtpLS0sbSs9ZVtnKytdPDxuLG4rPTh9YS5hZGxlcj1jLmNoZWNrPWQobSksbT0wLG49MCxjLm1vZGU9VjtjYXNlIFY6aWYoMD09PWMuaGF2ZWRpY3QpcmV0dXJuIGEubmV4dF9vdXQ9aCxhLmF2YWlsX291dD1qLGEubmV4dF9pbj1nLGEuYXZhaWxfaW49aSxjLmhvbGQ9bSxjLmJpdHM9bixGO2EuYWRsZXI9Yy5jaGVjaz0xLGMubW9kZT1XO2Nhc2UgVzppZihiPT09Qnx8Yj09PUMpYnJlYWsgYTtjYXNlIFg6aWYoYy5sYXN0KXttPj4+PTcmbixuLT03Jm4sYy5tb2RlPWphO2JyZWFrfWZvcig7bjwzOyl7aWYoMD09PWkpYnJlYWsgYTtpLS0sbSs9ZVtnKytdPDxuLG4rPTh9c3dpdGNoKGMubGFzdD0xJm0sbT4+Pj0xLG4tPTEsMyZtKXtjYXNlIDA6Yy5tb2RlPVk7YnJlYWs7Y2FzZSAxOmlmKGsoYyksYy5tb2RlPWNhLGI9PT1DKXttPj4+PTIsbi09MjticmVhayBhfWJyZWFrO2Nhc2UgMjpjLm1vZGU9XzticmVhaztjYXNlIDM6YS5tc2c9XCJpbnZhbGlkIGJsb2NrIHR5cGVcIixjLm1vZGU9bWF9bT4+Pj0yLG4tPTI7YnJlYWs7Y2FzZSBZOmZvcihtPj4+PTcmbixuLT03Jm47bjwzMjspe2lmKDA9PT1pKWJyZWFrIGE7aS0tLG0rPWVbZysrXTw8bixuKz04fWlmKCg2NTUzNSZtKSE9PShtPj4+MTZeNjU1MzUpKXthLm1zZz1cImludmFsaWQgc3RvcmVkIGJsb2NrIGxlbmd0aHNcIixjLm1vZGU9bWE7YnJlYWt9aWYoYy5sZW5ndGg9NjU1MzUmbSxtPTAsbj0wLGMubW9kZT1aLGI9PT1DKWJyZWFrIGE7Y2FzZSBaOmMubW9kZT0kO2Nhc2UgJDppZihxPWMubGVuZ3RoKXtpZihxPmkmJihxPWkpLHE+aiYmKHE9aiksMD09PXEpYnJlYWsgYTtzLmFycmF5U2V0KGYsZSxnLHEsaCksaS09cSxnKz1xLGotPXEsaCs9cSxjLmxlbmd0aC09cTticmVha31jLm1vZGU9VzticmVhaztjYXNlIF86Zm9yKDtuPDE0Oyl7aWYoMD09PWkpYnJlYWsgYTtpLS0sbSs9ZVtnKytdPDxuLG4rPTh9aWYoYy5ubGVuPSgzMSZtKSsyNTcsbT4+Pj01LG4tPTUsYy5uZGlzdD0oMzEmbSkrMSxtPj4+PTUsbi09NSxjLm5jb2RlPSgxNSZtKSs0LG0+Pj49NCxuLT00LGMubmxlbj4yODZ8fGMubmRpc3Q+MzApe2EubXNnPVwidG9vIG1hbnkgbGVuZ3RoIG9yIGRpc3RhbmNlIHN5bWJvbHNcIixjLm1vZGU9bWE7YnJlYWt9Yy5oYXZlPTAsYy5tb2RlPWFhO2Nhc2UgYWE6Zm9yKDtjLmhhdmU8Yy5uY29kZTspe2Zvcig7bjwzOyl7aWYoMD09PWkpYnJlYWsgYTtpLS0sbSs9ZVtnKytdPDxuLG4rPTh9Yy5sZW5zW0NhW2MuaGF2ZSsrXV09NyZtLG0+Pj49MyxuLT0zfWZvcig7Yy5oYXZlPDE5OyljLmxlbnNbQ2FbYy5oYXZlKytdXT0wO2lmKGMubGVuY29kZT1jLmxlbmR5bixjLmxlbmJpdHM9Nyx5YT17Yml0czpjLmxlbmJpdHN9LHhhPXcoeCxjLmxlbnMsMCwxOSxjLmxlbmNvZGUsMCxjLndvcmsseWEpLGMubGVuYml0cz15YS5iaXRzLHhhKXthLm1zZz1cImludmFsaWQgY29kZSBsZW5ndGhzIHNldFwiLGMubW9kZT1tYTticmVha31jLmhhdmU9MCxjLm1vZGU9YmE7Y2FzZSBiYTpmb3IoO2MuaGF2ZTxjLm5sZW4rYy5uZGlzdDspe2Zvcig7QWE9Yy5sZW5jb2RlW20mKDE8PGMubGVuYml0cyktMV0scWE9QWE+Pj4yNCxyYT1BYT4+PjE2JjI1NSxzYT02NTUzNSZBYSwhKHFhPD1uKTspe2lmKDA9PT1pKWJyZWFrIGE7aS0tLG0rPWVbZysrXTw8bixuKz04fWlmKHNhPDE2KW0+Pj49cWEsbi09cWEsYy5sZW5zW2MuaGF2ZSsrXT1zYTtlbHNle2lmKDE2PT09c2Epe2Zvcih6YT1xYSsyO248emE7KXtpZigwPT09aSlicmVhayBhO2ktLSxtKz1lW2crK108PG4sbis9OH1pZihtPj4+PXFhLG4tPXFhLDA9PT1jLmhhdmUpe2EubXNnPVwiaW52YWxpZCBiaXQgbGVuZ3RoIHJlcGVhdFwiLGMubW9kZT1tYTticmVha313YT1jLmxlbnNbYy5oYXZlLTFdLHE9MysoMyZtKSxtPj4+PTIsbi09Mn1lbHNlIGlmKDE3PT09c2Epe2Zvcih6YT1xYSszO248emE7KXtpZigwPT09aSlicmVhayBhO2ktLSxtKz1lW2crK108PG4sbis9OH1tPj4+PXFhLG4tPXFhLHdhPTAscT0zKyg3Jm0pLG0+Pj49MyxuLT0zfWVsc2V7Zm9yKHphPXFhKzc7bjx6YTspe2lmKDA9PT1pKWJyZWFrIGE7aS0tLG0rPWVbZysrXTw8bixuKz04fW0+Pj49cWEsbi09cWEsd2E9MCxxPTExKygxMjcmbSksbT4+Pj03LG4tPTd9aWYoYy5oYXZlK3E+Yy5ubGVuK2MubmRpc3Qpe2EubXNnPVwiaW52YWxpZCBiaXQgbGVuZ3RoIHJlcGVhdFwiLGMubW9kZT1tYTticmVha31mb3IoO3EtLTspYy5sZW5zW2MuaGF2ZSsrXT13YX19aWYoYy5tb2RlPT09bWEpYnJlYWs7aWYoMD09PWMubGVuc1syNTZdKXthLm1zZz1cImludmFsaWQgY29kZSAtLSBtaXNzaW5nIGVuZC1vZi1ibG9ja1wiLGMubW9kZT1tYTticmVha31pZihjLmxlbmJpdHM9OSx5YT17Yml0czpjLmxlbmJpdHN9LHhhPXcoeSxjLmxlbnMsMCxjLm5sZW4sYy5sZW5jb2RlLDAsYy53b3JrLHlhKSxjLmxlbmJpdHM9eWEuYml0cyx4YSl7YS5tc2c9XCJpbnZhbGlkIGxpdGVyYWwvbGVuZ3RocyBzZXRcIixjLm1vZGU9bWE7YnJlYWt9aWYoYy5kaXN0Yml0cz02LGMuZGlzdGNvZGU9Yy5kaXN0ZHluLHlhPXtiaXRzOmMuZGlzdGJpdHN9LHhhPXcoeixjLmxlbnMsYy5ubGVuLGMubmRpc3QsYy5kaXN0Y29kZSwwLGMud29yayx5YSksYy5kaXN0Yml0cz15YS5iaXRzLHhhKXthLm1zZz1cImludmFsaWQgZGlzdGFuY2VzIHNldFwiLGMubW9kZT1tYTticmVha31pZihjLm1vZGU9Y2EsYj09PUMpYnJlYWsgYTtjYXNlIGNhOmMubW9kZT1kYTtjYXNlIGRhOmlmKGk+PTYmJmo+PTI1OCl7YS5uZXh0X291dD1oLGEuYXZhaWxfb3V0PWosYS5uZXh0X2luPWcsYS5hdmFpbF9pbj1pLGMuaG9sZD1tLGMuYml0cz1uLHYoYSxwKSxoPWEubmV4dF9vdXQsZj1hLm91dHB1dCxqPWEuYXZhaWxfb3V0LGc9YS5uZXh0X2luLGU9YS5pbnB1dCxpPWEuYXZhaWxfaW4sbT1jLmhvbGQsbj1jLmJpdHMsYy5tb2RlPT09VyYmKGMuYmFjaz0tMSk7YnJlYWt9Zm9yKGMuYmFjaz0wO0FhPWMubGVuY29kZVttJigxPDxjLmxlbmJpdHMpLTFdLHFhPUFhPj4+MjQscmE9QWE+Pj4xNiYyNTUsc2E9NjU1MzUmQWEsIShxYTw9bik7KXtpZigwPT09aSlicmVhayBhO2ktLSxtKz1lW2crK108PG4sbis9OH1pZihyYSYmMD09PSgyNDAmcmEpKXtmb3IodGE9cWEsdWE9cmEsdmE9c2E7QWE9Yy5sZW5jb2RlW3ZhKygobSYoMTw8dGErdWEpLTEpPj50YSldLHFhPUFhPj4+MjQscmE9QWE+Pj4xNiYyNTUsc2E9NjU1MzUmQWEsISh0YStxYTw9bik7KXtpZigwPT09aSlicmVhayBhO2ktLSxtKz1lW2crK108PG4sbis9OH1tPj4+PXRhLG4tPXRhLGMuYmFjays9dGF9aWYobT4+Pj1xYSxuLT1xYSxjLmJhY2srPXFhLGMubGVuZ3RoPXNhLDA9PT1yYSl7Yy5tb2RlPWlhO2JyZWFrfWlmKDMyJnJhKXtjLmJhY2s9LTEsYy5tb2RlPVc7YnJlYWt9aWYoNjQmcmEpe2EubXNnPVwiaW52YWxpZCBsaXRlcmFsL2xlbmd0aCBjb2RlXCIsYy5tb2RlPW1hO2JyZWFrfWMuZXh0cmE9MTUmcmEsYy5tb2RlPWVhO2Nhc2UgZWE6aWYoYy5leHRyYSl7Zm9yKHphPWMuZXh0cmE7bjx6YTspe2lmKDA9PT1pKWJyZWFrIGE7aS0tLG0rPWVbZysrXTw8bixuKz04fWMubGVuZ3RoKz1tJigxPDxjLmV4dHJhKS0xLG0+Pj49Yy5leHRyYSxuLT1jLmV4dHJhLGMuYmFjays9Yy5leHRyYX1jLndhcz1jLmxlbmd0aCxjLm1vZGU9ZmE7Y2FzZSBmYTpmb3IoO0FhPWMuZGlzdGNvZGVbbSYoMTw8Yy5kaXN0Yml0cyktMV0scWE9QWE+Pj4yNCxyYT1BYT4+PjE2JjI1NSxzYT02NTUzNSZBYSwhKHFhPD1uKTspe2lmKDA9PT1pKWJyZWFrIGE7aS0tLG0rPWVbZysrXTw8bixuKz04fWlmKDA9PT0oMjQwJnJhKSl7Zm9yKHRhPXFhLHVhPXJhLHZhPXNhO0FhPWMuZGlzdGNvZGVbdmErKChtJigxPDx0YSt1YSktMSk+PnRhKV0scWE9QWE+Pj4yNCxyYT1BYT4+PjE2JjI1NSxzYT02NTUzNSZBYSwhKHRhK3FhPD1uKTspe2lmKDA9PT1pKWJyZWFrIGE7aS0tLG0rPWVbZysrXTw8bixuKz04fW0+Pj49dGEsbi09dGEsYy5iYWNrKz10YX1pZihtPj4+PXFhLG4tPXFhLGMuYmFjays9cWEsNjQmcmEpe2EubXNnPVwiaW52YWxpZCBkaXN0YW5jZSBjb2RlXCIsYy5tb2RlPW1hO2JyZWFrfWMub2Zmc2V0PXNhLGMuZXh0cmE9MTUmcmEsYy5tb2RlPWdhO2Nhc2UgZ2E6aWYoYy5leHRyYSl7Zm9yKHphPWMuZXh0cmE7bjx6YTspe2lmKDA9PT1pKWJyZWFrIGE7aS0tLG0rPWVbZysrXTw8bixuKz04fWMub2Zmc2V0Kz1tJigxPDxjLmV4dHJhKS0xLG0+Pj49Yy5leHRyYSxuLT1jLmV4dHJhLGMuYmFjays9Yy5leHRyYX1pZihjLm9mZnNldD5jLmRtYXgpe2EubXNnPVwiaW52YWxpZCBkaXN0YW5jZSB0b28gZmFyIGJhY2tcIixjLm1vZGU9bWE7YnJlYWt9Yy5tb2RlPWhhO2Nhc2UgaGE6aWYoMD09PWopYnJlYWsgYTtpZihxPXAtaixjLm9mZnNldD5xKXtpZihxPWMub2Zmc2V0LXEscT5jLndoYXZlJiZjLnNhbmUpe2EubXNnPVwiaW52YWxpZCBkaXN0YW5jZSB0b28gZmFyIGJhY2tcIixjLm1vZGU9bWE7YnJlYWt9cT5jLnduZXh0PyhxLT1jLnduZXh0LHI9Yy53c2l6ZS1xKTpyPWMud25leHQtcSxxPmMubGVuZ3RoJiYocT1jLmxlbmd0aCkscGE9Yy53aW5kb3d9ZWxzZSBwYT1mLHI9aC1jLm9mZnNldCxxPWMubGVuZ3RoO3E+aiYmKHE9aiksai09cSxjLmxlbmd0aC09cTtkbyBmW2grK109cGFbcisrXTt3aGlsZSgtLXEpOzA9PT1jLmxlbmd0aCYmKGMubW9kZT1kYSk7YnJlYWs7Y2FzZSBpYTppZigwPT09ailicmVhayBhO2ZbaCsrXT1jLmxlbmd0aCxqLS0sYy5tb2RlPWRhO2JyZWFrO2Nhc2UgamE6aWYoYy53cmFwKXtmb3IoO248MzI7KXtpZigwPT09aSlicmVhayBhO2ktLSxtfD1lW2crK108PG4sbis9OH1pZihwLT1qLGEudG90YWxfb3V0Kz1wLGMudG90YWwrPXAscCYmKGEuYWRsZXI9Yy5jaGVjaz1jLmZsYWdzP3UoYy5jaGVjayxmLHAsaC1wKTp0KGMuY2hlY2ssZixwLGgtcCkpLHA9aiwoYy5mbGFncz9tOmQobSkpIT09Yy5jaGVjayl7YS5tc2c9XCJpbmNvcnJlY3QgZGF0YSBjaGVja1wiLGMubW9kZT1tYTticmVha31tPTAsbj0wfWMubW9kZT1rYTtjYXNlIGthOmlmKGMud3JhcCYmYy5mbGFncyl7Zm9yKDtuPDMyOyl7aWYoMD09PWkpYnJlYWsgYTtpLS0sbSs9ZVtnKytdPDxuLG4rPTh9aWYobSE9PSg0Mjk0OTY3Mjk1JmMudG90YWwpKXthLm1zZz1cImluY29ycmVjdCBsZW5ndGggY2hlY2tcIixjLm1vZGU9bWE7YnJlYWt9bT0wLG49MH1jLm1vZGU9bGE7Y2FzZSBsYTp4YT1FO2JyZWFrIGE7Y2FzZSBtYTp4YT1IO2JyZWFrIGE7Y2FzZSBuYTpyZXR1cm4gSTtjYXNlIG9hOmRlZmF1bHQ6cmV0dXJuIEd9cmV0dXJuIGEubmV4dF9vdXQ9aCxhLmF2YWlsX291dD1qLGEubmV4dF9pbj1nLGEuYXZhaWxfaW49aSxjLmhvbGQ9bSxjLmJpdHM9biwoYy53c2l6ZXx8cCE9PWEuYXZhaWxfb3V0JiZjLm1vZGU8bWEmJihjLm1vZGU8amF8fGIhPT1BKSkmJmwoYSxhLm91dHB1dCxhLm5leHRfb3V0LHAtYS5hdmFpbF9vdXQpPyhjLm1vZGU9bmEsSSk6KG8tPWEuYXZhaWxfaW4scC09YS5hdmFpbF9vdXQsYS50b3RhbF9pbis9byxhLnRvdGFsX291dCs9cCxjLnRvdGFsKz1wLGMud3JhcCYmcCYmKGEuYWRsZXI9Yy5jaGVjaz1jLmZsYWdzP3UoYy5jaGVjayxmLHAsYS5uZXh0X291dC1wKTp0KGMuY2hlY2ssZixwLGEubmV4dF9vdXQtcCkpLGEuZGF0YV90eXBlPWMuYml0cysoYy5sYXN0PzY0OjApKyhjLm1vZGU9PT1XPzEyODowKSsoYy5tb2RlPT09Y2F8fGMubW9kZT09PVo/MjU2OjApLCgwPT09byYmMD09PXB8fGI9PT1BKSYmeGE9PT1EJiYoeGE9SikseGEpfWZ1bmN0aW9uIG4oYSl7aWYoIWF8fCFhLnN0YXRlKXJldHVybiBHO3ZhciBiPWEuc3RhdGU7cmV0dXJuIGIud2luZG93JiYoYi53aW5kb3c9bnVsbCksYS5zdGF0ZT1udWxsLER9ZnVuY3Rpb24gbyhhLGIpe3ZhciBjO3JldHVybiBhJiZhLnN0YXRlPyhjPWEuc3RhdGUsMD09PSgyJmMud3JhcCk/RzooYy5oZWFkPWIsYi5kb25lPSExLEQpKTpHfWZ1bmN0aW9uIHAoYSxiKXt2YXIgYyxkLGUsZj1iLmxlbmd0aDtyZXR1cm4gYSYmYS5zdGF0ZT8oYz1hLnN0YXRlLDAhPT1jLndyYXAmJmMubW9kZSE9PVY/RzpjLm1vZGU9PT1WJiYoZD0xLGQ9dChkLGIsZiwwKSxkIT09Yy5jaGVjayk/SDooZT1sKGEsYixmLGYpKT8oYy5tb2RlPW5hLEkpOihjLmhhdmVkaWN0PTEsRCkpOkd9dmFyIHEscixzPWEoXCIuLi91dGlscy9jb21tb25cIiksdD1hKFwiLi9hZGxlcjMyXCIpLHU9YShcIi4vY3JjMzJcIiksdj1hKFwiLi9pbmZmYXN0XCIpLHc9YShcIi4vaW5mdHJlZXNcIikseD0wLHk9MSx6PTIsQT00LEI9NSxDPTYsRD0wLEU9MSxGPTIsRz0tMixIPS0zLEk9LTQsSj0tNSxLPTgsTD0xLE09MixOPTMsTz00LFA9NSxRPTYsUj03LFM9OCxUPTksVT0xMCxWPTExLFc9MTIsWD0xMyxZPTE0LFo9MTUsJD0xNixfPTE3LGFhPTE4LGJhPTE5LGNhPTIwLGRhPTIxLGVhPTIyLGZhPTIzLGdhPTI0LGhhPTI1LGlhPTI2LGphPTI3LGthPTI4LGxhPTI5LG1hPTMwLG5hPTMxLG9hPTMyLHBhPTg1MixxYT01OTIscmE9MTUsc2E9cmEsdGE9ITA7Yy5pbmZsYXRlUmVzZXQ9ZyxjLmluZmxhdGVSZXNldDI9aCxjLmluZmxhdGVSZXNldEtlZXA9ZixjLmluZmxhdGVJbml0PWosYy5pbmZsYXRlSW5pdDI9aSxjLmluZmxhdGU9bSxjLmluZmxhdGVFbmQ9bixjLmluZmxhdGVHZXRIZWFkZXI9byxjLmluZmxhdGVTZXREaWN0aW9uYXJ5PXAsYy5pbmZsYXRlSW5mbz1cInBha28gaW5mbGF0ZSAoZnJvbSBOb2RlY2EgcHJvamVjdClcIn0se1wiLi4vdXRpbHMvY29tbW9uXCI6NjIsXCIuL2FkbGVyMzJcIjo2NCxcIi4vY3JjMzJcIjo2NixcIi4vaW5mZmFzdFwiOjY5LFwiLi9pbmZ0cmVlc1wiOjcxfV0sNzE6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjt2YXIgZD1hKFwiLi4vdXRpbHMvY29tbW9uXCIpLGU9MTUsZj04NTIsZz01OTIsaD0wLGk9MSxqPTIsaz1bMyw0LDUsNiw3LDgsOSwxMCwxMSwxMywxNSwxNywxOSwyMywyNywzMSwzNSw0Myw1MSw1OSw2Nyw4Myw5OSwxMTUsMTMxLDE2MywxOTUsMjI3LDI1OCwwLDBdLGw9WzE2LDE2LDE2LDE2LDE2LDE2LDE2LDE2LDE3LDE3LDE3LDE3LDE4LDE4LDE4LDE4LDE5LDE5LDE5LDE5LDIwLDIwLDIwLDIwLDIxLDIxLDIxLDIxLDE2LDcyLDc4XSxtPVsxLDIsMyw0LDUsNyw5LDEzLDE3LDI1LDMzLDQ5LDY1LDk3LDEyOSwxOTMsMjU3LDM4NSw1MTMsNzY5LDEwMjUsMTUzNywyMDQ5LDMwNzMsNDA5Nyw2MTQ1LDgxOTMsMTIyODksMTYzODUsMjQ1NzcsMCwwXSxuPVsxNiwxNiwxNiwxNiwxNywxNywxOCwxOCwxOSwxOSwyMCwyMCwyMSwyMSwyMiwyMiwyMywyMywyNCwyNCwyNSwyNSwyNiwyNiwyNywyNywyOCwyOCwyOSwyOSw2NCw2NF07Yi5leHBvcnRzPWZ1bmN0aW9uKGEsYixjLG8scCxxLHIscyl7dmFyIHQsdSx2LHcseCx5LHosQSxCLEM9cy5iaXRzLEQ9MCxFPTAsRj0wLEc9MCxIPTAsST0wLEo9MCxLPTAsTD0wLE09MCxOPW51bGwsTz0wLFA9bmV3IGQuQnVmMTYoZSsxKSxRPW5ldyBkLkJ1ZjE2KGUrMSksUj1udWxsLFM9MDtmb3IoRD0wO0Q8PWU7RCsrKVBbRF09MDtmb3IoRT0wO0U8bztFKyspUFtiW2MrRV1dKys7Zm9yKEg9QyxHPWU7Rz49MSYmMD09PVBbR107Ry0tKTtpZihIPkcmJihIPUcpLDA9PT1HKXJldHVybiBwW3ErK109MjA5NzE1MjAscFtxKytdPTIwOTcxNTIwLHMuYml0cz0xLDA7Zm9yKEY9MTtGPEcmJjA9PT1QW0ZdO0YrKyk7Zm9yKEg8RiYmKEg9RiksSz0xLEQ9MTtEPD1lO0QrKylpZihLPDw9MSxLLT1QW0RdLEs8MClyZXR1cm4tMTtpZihLPjAmJihhPT09aHx8MSE9PUcpKXJldHVybi0xO2ZvcihRWzFdPTAsRD0xO0Q8ZTtEKyspUVtEKzFdPVFbRF0rUFtEXTtmb3IoRT0wO0U8bztFKyspMCE9PWJbYytFXSYmKHJbUVtiW2MrRV1dKytdPUUpO2lmKGE9PT1oPyhOPVI9cix5PTE5KTphPT09aT8oTj1rLE8tPTI1NyxSPWwsUy09MjU3LHk9MjU2KTooTj1tLFI9bix5PS0xKSxNPTAsRT0wLEQ9Rix4PXEsST1ILEo9MCx2PS0xLEw9MTw8SCx3PUwtMSxhPT09aSYmTD5mfHxhPT09aiYmTD5nKXJldHVybiAxO2Zvcig7Oyl7ej1ELUoscltFXTx5PyhBPTAsQj1yW0VdKTpyW0VdPnk/KEE9UltTK3JbRV1dLEI9TltPK3JbRV1dKTooQT05NixCPTApLHQ9MTw8RC1KLHU9MTw8SSxGPXU7ZG8gdS09dCxwW3grKE0+PkopK3VdPXo8PDI0fEE8PDE2fEJ8MDt3aGlsZSgwIT09dSk7Zm9yKHQ9MTw8RC0xO00mdDspdD4+PTE7aWYoMCE9PXQ/KE0mPXQtMSxNKz10KTpNPTAsRSsrLDA9PT0tLVBbRF0pe2lmKEQ9PT1HKWJyZWFrO0Q9YltjK3JbRV1dfWlmKEQ+SCYmKE0mdykhPT12KXtmb3IoMD09PUomJihKPUgpLHgrPUYsST1ELUosSz0xPDxJO0krSjxHJiYoSy09UFtJK0pdLCEoSzw9MCkpOylJKyssSzw8PTE7aWYoTCs9MTw8SSxhPT09aSYmTD5mfHxhPT09aiYmTD5nKXJldHVybiAxO3Y9TSZ3LHBbdl09SDw8MjR8STw8MTZ8eC1xfDB9fXJldHVybiAwIT09TSYmKHBbeCtNXT1ELUo8PDI0fDY0PDwxNnwwKSxzLmJpdHM9SCwwfX0se1wiLi4vdXRpbHMvY29tbW9uXCI6NjJ9XSw3MjpbZnVuY3Rpb24oYSxiLGMpe1widXNlIHN0cmljdFwiO2IuZXhwb3J0cz17MjpcIm5lZWQgZGljdGlvbmFyeVwiLDE6XCJzdHJlYW0gZW5kXCIsMDpcIlwiLFwiLTFcIjpcImZpbGUgZXJyb3JcIixcIi0yXCI6XCJzdHJlYW0gZXJyb3JcIixcIi0zXCI6XCJkYXRhIGVycm9yXCIsXCItNFwiOlwiaW5zdWZmaWNpZW50IG1lbW9yeVwiLFwiLTVcIjpcImJ1ZmZlciBlcnJvclwiLFwiLTZcIjpcImluY29tcGF0aWJsZSB2ZXJzaW9uXCJ9fSx7fV0sNzM6W2Z1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEpe2Zvcih2YXIgYj1hLmxlbmd0aDstLWI+PTA7KWFbYl09MH1mdW5jdGlvbiBlKGEsYixjLGQsZSl7dGhpcy5zdGF0aWNfdHJlZT1hLHRoaXMuZXh0cmFfYml0cz1iLHRoaXMuZXh0cmFfYmFzZT1jLHRoaXMuZWxlbXM9ZCx0aGlzLm1heF9sZW5ndGg9ZSx0aGlzLmhhc19zdHJlZT1hJiZhLmxlbmd0aH1mdW5jdGlvbiBmKGEsYil7dGhpcy5keW5fdHJlZT1hLHRoaXMubWF4X2NvZGU9MCx0aGlzLnN0YXRfZGVzYz1ifWZ1bmN0aW9uIGcoYSl7cmV0dXJuIGE8MjU2P2lhW2FdOmlhWzI1NisoYT4+PjcpXX1mdW5jdGlvbiBoKGEsYil7YS5wZW5kaW5nX2J1ZlthLnBlbmRpbmcrK109MjU1JmIsYS5wZW5kaW5nX2J1ZlthLnBlbmRpbmcrK109Yj4+PjgmMjU1fWZ1bmN0aW9uIGkoYSxiLGMpe2EuYmlfdmFsaWQ+WC1jPyhhLmJpX2J1Znw9Yjw8YS5iaV92YWxpZCY2NTUzNSxoKGEsYS5iaV9idWYpLGEuYmlfYnVmPWI+PlgtYS5iaV92YWxpZCxhLmJpX3ZhbGlkKz1jLVgpOihhLmJpX2J1Znw9Yjw8YS5iaV92YWxpZCY2NTUzNSxhLmJpX3ZhbGlkKz1jKX1mdW5jdGlvbiBqKGEsYixjKXtpKGEsY1syKmJdLGNbMipiKzFdKX1mdW5jdGlvbiBrKGEsYil7dmFyIGM9MDtkbyBjfD0xJmEsYT4+Pj0xLGM8PD0xO3doaWxlKC0tYj4wKTtyZXR1cm4gYz4+PjF9ZnVuY3Rpb24gbChhKXsxNj09PWEuYmlfdmFsaWQ/KGgoYSxhLmJpX2J1ZiksYS5iaV9idWY9MCxhLmJpX3ZhbGlkPTApOmEuYmlfdmFsaWQ+PTgmJihhLnBlbmRpbmdfYnVmW2EucGVuZGluZysrXT0yNTUmYS5iaV9idWYsYS5iaV9idWY+Pj04LGEuYmlfdmFsaWQtPTgpfWZ1bmN0aW9uIG0oYSxiKXt2YXIgYyxkLGUsZixnLGgsaT1iLmR5bl90cmVlLGo9Yi5tYXhfY29kZSxrPWIuc3RhdF9kZXNjLnN0YXRpY190cmVlLGw9Yi5zdGF0X2Rlc2MuaGFzX3N0cmVlLG09Yi5zdGF0X2Rlc2MuZXh0cmFfYml0cyxuPWIuc3RhdF9kZXNjLmV4dHJhX2Jhc2Usbz1iLnN0YXRfZGVzYy5tYXhfbGVuZ3RoLHA9MDtmb3IoZj0wO2Y8PVc7ZisrKWEuYmxfY291bnRbZl09MDtmb3IoaVsyKmEuaGVhcFthLmhlYXBfbWF4XSsxXT0wLFxuYz1hLmhlYXBfbWF4KzE7YzxWO2MrKylkPWEuaGVhcFtjXSxmPWlbMippWzIqZCsxXSsxXSsxLGY+byYmKGY9byxwKyspLGlbMipkKzFdPWYsZD5qfHwoYS5ibF9jb3VudFtmXSsrLGc9MCxkPj1uJiYoZz1tW2Qtbl0pLGg9aVsyKmRdLGEub3B0X2xlbis9aCooZitnKSxsJiYoYS5zdGF0aWNfbGVuKz1oKihrWzIqZCsxXStnKSkpO2lmKDAhPT1wKXtkb3tmb3IoZj1vLTE7MD09PWEuYmxfY291bnRbZl07KWYtLTthLmJsX2NvdW50W2ZdLS0sYS5ibF9jb3VudFtmKzFdKz0yLGEuYmxfY291bnRbb10tLSxwLT0yfXdoaWxlKHA+MCk7Zm9yKGY9bzswIT09ZjtmLS0pZm9yKGQ9YS5ibF9jb3VudFtmXTswIT09ZDspZT1hLmhlYXBbLS1jXSxlPmp8fChpWzIqZSsxXSE9PWYmJihhLm9wdF9sZW4rPShmLWlbMiplKzFdKSppWzIqZV0saVsyKmUrMV09ZiksZC0tKX19ZnVuY3Rpb24gbihhLGIsYyl7dmFyIGQsZSxmPW5ldyBBcnJheShXKzEpLGc9MDtmb3IoZD0xO2Q8PVc7ZCsrKWZbZF09Zz1nK2NbZC0xXTw8MTtmb3IoZT0wO2U8PWI7ZSsrKXt2YXIgaD1hWzIqZSsxXTswIT09aCYmKGFbMiplXT1rKGZbaF0rKyxoKSl9fWZ1bmN0aW9uIG8oKXt2YXIgYSxiLGMsZCxmLGc9bmV3IEFycmF5KFcrMSk7Zm9yKGM9MCxkPTA7ZDxRLTE7ZCsrKWZvcihrYVtkXT1jLGE9MDthPDE8PGJhW2RdO2ErKylqYVtjKytdPWQ7Zm9yKGphW2MtMV09ZCxmPTAsZD0wO2Q8MTY7ZCsrKWZvcihsYVtkXT1mLGE9MDthPDE8PGNhW2RdO2ErKylpYVtmKytdPWQ7Zm9yKGY+Pj03O2Q8VDtkKyspZm9yKGxhW2RdPWY8PDcsYT0wO2E8MTw8Y2FbZF0tNzthKyspaWFbMjU2K2YrK109ZDtmb3IoYj0wO2I8PVc7YisrKWdbYl09MDtmb3IoYT0wO2E8PTE0MzspZ2FbMiphKzFdPTgsYSsrLGdbOF0rKztmb3IoO2E8PTI1NTspZ2FbMiphKzFdPTksYSsrLGdbOV0rKztmb3IoO2E8PTI3OTspZ2FbMiphKzFdPTcsYSsrLGdbN10rKztmb3IoO2E8PTI4NzspZ2FbMiphKzFdPTgsYSsrLGdbOF0rKztmb3IobihnYSxTKzEsZyksYT0wO2E8VDthKyspaGFbMiphKzFdPTUsaGFbMiphXT1rKGEsNSk7bWE9bmV3IGUoZ2EsYmEsUisxLFMsVyksbmE9bmV3IGUoaGEsY2EsMCxULFcpLG9hPW5ldyBlKG5ldyBBcnJheSgwKSxkYSwwLFUsWSl9ZnVuY3Rpb24gcChhKXt2YXIgYjtmb3IoYj0wO2I8UztiKyspYS5keW5fbHRyZWVbMipiXT0wO2ZvcihiPTA7YjxUO2IrKylhLmR5bl9kdHJlZVsyKmJdPTA7Zm9yKGI9MDtiPFU7YisrKWEuYmxfdHJlZVsyKmJdPTA7YS5keW5fbHRyZWVbMipaXT0xLGEub3B0X2xlbj1hLnN0YXRpY19sZW49MCxhLmxhc3RfbGl0PWEubWF0Y2hlcz0wfWZ1bmN0aW9uIHEoYSl7YS5iaV92YWxpZD44P2goYSxhLmJpX2J1Zik6YS5iaV92YWxpZD4wJiYoYS5wZW5kaW5nX2J1ZlthLnBlbmRpbmcrK109YS5iaV9idWYpLGEuYmlfYnVmPTAsYS5iaV92YWxpZD0wfWZ1bmN0aW9uIHIoYSxiLGMsZCl7cShhKSxkJiYoaChhLGMpLGgoYSx+YykpLEcuYXJyYXlTZXQoYS5wZW5kaW5nX2J1ZixhLndpbmRvdyxiLGMsYS5wZW5kaW5nKSxhLnBlbmRpbmcrPWN9ZnVuY3Rpb24gcyhhLGIsYyxkKXt2YXIgZT0yKmIsZj0yKmM7cmV0dXJuIGFbZV08YVtmXXx8YVtlXT09PWFbZl0mJmRbYl08PWRbY119ZnVuY3Rpb24gdChhLGIsYyl7Zm9yKHZhciBkPWEuaGVhcFtjXSxlPWM8PDE7ZTw9YS5oZWFwX2xlbiYmKGU8YS5oZWFwX2xlbiYmcyhiLGEuaGVhcFtlKzFdLGEuaGVhcFtlXSxhLmRlcHRoKSYmZSsrLCFzKGIsZCxhLmhlYXBbZV0sYS5kZXB0aCkpOylhLmhlYXBbY109YS5oZWFwW2VdLGM9ZSxlPDw9MTthLmhlYXBbY109ZH1mdW5jdGlvbiB1KGEsYixjKXt2YXIgZCxlLGYsaCxrPTA7aWYoMCE9PWEubGFzdF9saXQpZG8gZD1hLnBlbmRpbmdfYnVmW2EuZF9idWYrMiprXTw8OHxhLnBlbmRpbmdfYnVmW2EuZF9idWYrMiprKzFdLGU9YS5wZW5kaW5nX2J1ZlthLmxfYnVmK2tdLGsrKywwPT09ZD9qKGEsZSxiKTooZj1qYVtlXSxqKGEsZitSKzEsYiksaD1iYVtmXSwwIT09aCYmKGUtPWthW2ZdLGkoYSxlLGgpKSxkLS0sZj1nKGQpLGooYSxmLGMpLGg9Y2FbZl0sMCE9PWgmJihkLT1sYVtmXSxpKGEsZCxoKSkpO3doaWxlKGs8YS5sYXN0X2xpdCk7aihhLFosYil9ZnVuY3Rpb24gdihhLGIpe3ZhciBjLGQsZSxmPWIuZHluX3RyZWUsZz1iLnN0YXRfZGVzYy5zdGF0aWNfdHJlZSxoPWIuc3RhdF9kZXNjLmhhc19zdHJlZSxpPWIuc3RhdF9kZXNjLmVsZW1zLGo9LTE7Zm9yKGEuaGVhcF9sZW49MCxhLmhlYXBfbWF4PVYsYz0wO2M8aTtjKyspMCE9PWZbMipjXT8oYS5oZWFwWysrYS5oZWFwX2xlbl09aj1jLGEuZGVwdGhbY109MCk6ZlsyKmMrMV09MDtmb3IoO2EuaGVhcF9sZW48MjspZT1hLmhlYXBbKythLmhlYXBfbGVuXT1qPDI/KytqOjAsZlsyKmVdPTEsYS5kZXB0aFtlXT0wLGEub3B0X2xlbi0tLGgmJihhLnN0YXRpY19sZW4tPWdbMiplKzFdKTtmb3IoYi5tYXhfY29kZT1qLGM9YS5oZWFwX2xlbj4+MTtjPj0xO2MtLSl0KGEsZixjKTtlPWk7ZG8gYz1hLmhlYXBbMV0sYS5oZWFwWzFdPWEuaGVhcFthLmhlYXBfbGVuLS1dLHQoYSxmLDEpLGQ9YS5oZWFwWzFdLGEuaGVhcFstLWEuaGVhcF9tYXhdPWMsYS5oZWFwWy0tYS5oZWFwX21heF09ZCxmWzIqZV09ZlsyKmNdK2ZbMipkXSxhLmRlcHRoW2VdPShhLmRlcHRoW2NdPj1hLmRlcHRoW2RdP2EuZGVwdGhbY106YS5kZXB0aFtkXSkrMSxmWzIqYysxXT1mWzIqZCsxXT1lLGEuaGVhcFsxXT1lKyssdChhLGYsMSk7d2hpbGUoYS5oZWFwX2xlbj49Mik7YS5oZWFwWy0tYS5oZWFwX21heF09YS5oZWFwWzFdLG0oYSxiKSxuKGYsaixhLmJsX2NvdW50KX1mdW5jdGlvbiB3KGEsYixjKXt2YXIgZCxlLGY9LTEsZz1iWzFdLGg9MCxpPTcsaj00O2ZvcigwPT09ZyYmKGk9MTM4LGo9MyksYlsyKihjKzEpKzFdPTY1NTM1LGQ9MDtkPD1jO2QrKyllPWcsZz1iWzIqKGQrMSkrMV0sKytoPGkmJmU9PT1nfHwoaDxqP2EuYmxfdHJlZVsyKmVdKz1oOjAhPT1lPyhlIT09ZiYmYS5ibF90cmVlWzIqZV0rKyxhLmJsX3RyZWVbMiokXSsrKTpoPD0xMD9hLmJsX3RyZWVbMipfXSsrOmEuYmxfdHJlZVsyKmFhXSsrLGg9MCxmPWUsMD09PWc/KGk9MTM4LGo9Myk6ZT09PWc/KGk9NixqPTMpOihpPTcsaj00KSl9ZnVuY3Rpb24geChhLGIsYyl7dmFyIGQsZSxmPS0xLGc9YlsxXSxoPTAsaz03LGw9NDtmb3IoMD09PWcmJihrPTEzOCxsPTMpLGQ9MDtkPD1jO2QrKylpZihlPWcsZz1iWzIqKGQrMSkrMV0sISgrK2g8ayYmZT09PWcpKXtpZihoPGwpe2RvIGooYSxlLGEuYmxfdHJlZSk7d2hpbGUoMCE9PS0taCl9ZWxzZSAwIT09ZT8oZSE9PWYmJihqKGEsZSxhLmJsX3RyZWUpLGgtLSksaihhLCQsYS5ibF90cmVlKSxpKGEsaC0zLDIpKTpoPD0xMD8oaihhLF8sYS5ibF90cmVlKSxpKGEsaC0zLDMpKTooaihhLGFhLGEuYmxfdHJlZSksaShhLGgtMTEsNykpO2g9MCxmPWUsMD09PWc/KGs9MTM4LGw9Myk6ZT09PWc/KGs9NixsPTMpOihrPTcsbD00KX19ZnVuY3Rpb24geShhKXt2YXIgYjtmb3IodyhhLGEuZHluX2x0cmVlLGEubF9kZXNjLm1heF9jb2RlKSx3KGEsYS5keW5fZHRyZWUsYS5kX2Rlc2MubWF4X2NvZGUpLHYoYSxhLmJsX2Rlc2MpLGI9VS0xO2I+PTMmJjA9PT1hLmJsX3RyZWVbMiplYVtiXSsxXTtiLS0pO3JldHVybiBhLm9wdF9sZW4rPTMqKGIrMSkrNSs1KzQsYn1mdW5jdGlvbiB6KGEsYixjLGQpe3ZhciBlO2ZvcihpKGEsYi0yNTcsNSksaShhLGMtMSw1KSxpKGEsZC00LDQpLGU9MDtlPGQ7ZSsrKWkoYSxhLmJsX3RyZWVbMiplYVtlXSsxXSwzKTt4KGEsYS5keW5fbHRyZWUsYi0xKSx4KGEsYS5keW5fZHRyZWUsYy0xKX1mdW5jdGlvbiBBKGEpe3ZhciBiLGM9NDA5MzYyNDQ0Nztmb3IoYj0wO2I8PTMxO2IrKyxjPj4+PTEpaWYoMSZjJiYwIT09YS5keW5fbHRyZWVbMipiXSlyZXR1cm4gSTtpZigwIT09YS5keW5fbHRyZWVbMThdfHwwIT09YS5keW5fbHRyZWVbMjBdfHwwIT09YS5keW5fbHRyZWVbMjZdKXJldHVybiBKO2ZvcihiPTMyO2I8UjtiKyspaWYoMCE9PWEuZHluX2x0cmVlWzIqYl0pcmV0dXJuIEo7cmV0dXJuIEl9ZnVuY3Rpb24gQihhKXtwYXx8KG8oKSxwYT0hMCksYS5sX2Rlc2M9bmV3IGYoYS5keW5fbHRyZWUsbWEpLGEuZF9kZXNjPW5ldyBmKGEuZHluX2R0cmVlLG5hKSxhLmJsX2Rlc2M9bmV3IGYoYS5ibF90cmVlLG9hKSxhLmJpX2J1Zj0wLGEuYmlfdmFsaWQ9MCxwKGEpfWZ1bmN0aW9uIEMoYSxiLGMsZCl7aShhLChMPDwxKSsoZD8xOjApLDMpLHIoYSxiLGMsITApfWZ1bmN0aW9uIEQoYSl7aShhLE08PDEsMyksaihhLFosZ2EpLGwoYSl9ZnVuY3Rpb24gRShhLGIsYyxkKXt2YXIgZSxmLGc9MDthLmxldmVsPjA/KGEuc3RybS5kYXRhX3R5cGU9PT1LJiYoYS5zdHJtLmRhdGFfdHlwZT1BKGEpKSx2KGEsYS5sX2Rlc2MpLHYoYSxhLmRfZGVzYyksZz15KGEpLGU9YS5vcHRfbGVuKzMrNz4+PjMsZj1hLnN0YXRpY19sZW4rMys3Pj4+MyxmPD1lJiYoZT1mKSk6ZT1mPWMrNSxjKzQ8PWUmJmIhPT0tMT9DKGEsYixjLGQpOmEuc3RyYXRlZ3k9PT1IfHxmPT09ZT8oaShhLChNPDwxKSsoZD8xOjApLDMpLHUoYSxnYSxoYSkpOihpKGEsKE48PDEpKyhkPzE6MCksMykseihhLGEubF9kZXNjLm1heF9jb2RlKzEsYS5kX2Rlc2MubWF4X2NvZGUrMSxnKzEpLHUoYSxhLmR5bl9sdHJlZSxhLmR5bl9kdHJlZSkpLHAoYSksZCYmcShhKX1mdW5jdGlvbiBGKGEsYixjKXtyZXR1cm4gYS5wZW5kaW5nX2J1ZlthLmRfYnVmKzIqYS5sYXN0X2xpdF09Yj4+PjgmMjU1LGEucGVuZGluZ19idWZbYS5kX2J1ZisyKmEubGFzdF9saXQrMV09MjU1JmIsYS5wZW5kaW5nX2J1ZlthLmxfYnVmK2EubGFzdF9saXRdPTI1NSZjLGEubGFzdF9saXQrKywwPT09Yj9hLmR5bl9sdHJlZVsyKmNdKys6KGEubWF0Y2hlcysrLGItLSxhLmR5bl9sdHJlZVsyKihqYVtjXStSKzEpXSsrLGEuZHluX2R0cmVlWzIqZyhiKV0rKyksYS5sYXN0X2xpdD09PWEubGl0X2J1ZnNpemUtMX12YXIgRz1hKFwiLi4vdXRpbHMvY29tbW9uXCIpLEg9NCxJPTAsSj0xLEs9MixMPTAsTT0xLE49MixPPTMsUD0yNTgsUT0yOSxSPTI1NixTPVIrMStRLFQ9MzAsVT0xOSxWPTIqUysxLFc9MTUsWD0xNixZPTcsWj0yNTYsJD0xNixfPTE3LGFhPTE4LGJhPVswLDAsMCwwLDAsMCwwLDAsMSwxLDEsMSwyLDIsMiwyLDMsMywzLDMsNCw0LDQsNCw1LDUsNSw1LDBdLGNhPVswLDAsMCwwLDEsMSwyLDIsMywzLDQsNCw1LDUsNiw2LDcsNyw4LDgsOSw5LDEwLDEwLDExLDExLDEyLDEyLDEzLDEzXSxkYT1bMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwyLDMsN10sZWE9WzE2LDE3LDE4LDAsOCw3LDksNiwxMCw1LDExLDQsMTIsMywxMywyLDE0LDEsMTVdLGZhPTUxMixnYT1uZXcgQXJyYXkoMiooUysyKSk7ZChnYSk7dmFyIGhhPW5ldyBBcnJheSgyKlQpO2QoaGEpO3ZhciBpYT1uZXcgQXJyYXkoZmEpO2QoaWEpO3ZhciBqYT1uZXcgQXJyYXkoUC1PKzEpO2QoamEpO3ZhciBrYT1uZXcgQXJyYXkoUSk7ZChrYSk7dmFyIGxhPW5ldyBBcnJheShUKTtkKGxhKTt2YXIgbWEsbmEsb2EscGE9ITE7Yy5fdHJfaW5pdD1CLGMuX3RyX3N0b3JlZF9ibG9jaz1DLGMuX3RyX2ZsdXNoX2Jsb2NrPUUsYy5fdHJfdGFsbHk9RixjLl90cl9hbGlnbj1EfSx7XCIuLi91dGlscy9jb21tb25cIjo2Mn1dLDc0OltmdW5jdGlvbihhLGIsYyl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZCgpe3RoaXMuaW5wdXQ9bnVsbCx0aGlzLm5leHRfaW49MCx0aGlzLmF2YWlsX2luPTAsdGhpcy50b3RhbF9pbj0wLHRoaXMub3V0cHV0PW51bGwsdGhpcy5uZXh0X291dD0wLHRoaXMuYXZhaWxfb3V0PTAsdGhpcy50b3RhbF9vdXQ9MCx0aGlzLm1zZz1cIlwiLHRoaXMuc3RhdGU9bnVsbCx0aGlzLmRhdGFfdHlwZT0yLHRoaXMuYWRsZXI9MH1iLmV4cG9ydHM9ZH0se31dfSx7fSxbMTBdKSgxMCl9KTsiLCIvKiEganMtY29va2llIHYyLjIuMSB8IE1JVCAqL1xuXG4hZnVuY3Rpb24oYSl7dmFyIGI7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kJiYoZGVmaW5lKGEpLGI9ITApLFwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiYobW9kdWxlLmV4cG9ydHM9YSgpLGI9ITApLCFiKXt2YXIgYz13aW5kb3cuQ29va2llcyxkPXdpbmRvdy5Db29raWVzPWEoKTtkLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gd2luZG93LkNvb2tpZXM9YyxkfX19KGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe2Zvcih2YXIgYT0wLGI9e307YTxhcmd1bWVudHMubGVuZ3RoO2ErKyl7dmFyIGM9YXJndW1lbnRzW2FdO2Zvcih2YXIgZCBpbiBjKWJbZF09Y1tkXX1yZXR1cm4gYn1mdW5jdGlvbiBiKGEpe3JldHVybiBhLnJlcGxhY2UoLyglWzAtOUEtWl17Mn0pKy9nLGRlY29kZVVSSUNvbXBvbmVudCl9ZnVuY3Rpb24gYyhkKXtmdW5jdGlvbiBlKCl7fWZ1bmN0aW9uIGYoYixjLGYpe2lmKFwidW5kZWZpbmVkXCIhPXR5cGVvZiBkb2N1bWVudCl7Zj1hKHtwYXRoOlwiL1wifSxlLmRlZmF1bHRzLGYpLFwibnVtYmVyXCI9PXR5cGVvZiBmLmV4cGlyZXMmJihmLmV4cGlyZXM9bmV3IERhdGUoMSpuZXcgRGF0ZSs4NjRlNSpmLmV4cGlyZXMpKSxmLmV4cGlyZXM9Zi5leHBpcmVzP2YuZXhwaXJlcy50b1VUQ1N0cmluZygpOlwiXCI7dHJ5e3ZhciBnPUpTT04uc3RyaW5naWZ5KGMpOy9eW1xce1xcW10vLnRlc3QoZykmJihjPWcpfWNhdGNoKGope31jPWQud3JpdGU/ZC53cml0ZShjLGIpOmVuY29kZVVSSUNvbXBvbmVudChjK1wiXCIpLnJlcGxhY2UoLyUoMjN8MjR8MjZ8MkJ8M0F8M0N8M0V8M0R8MkZ8M0Z8NDB8NUJ8NUR8NUV8NjB8N0J8N0R8N0MpL2csZGVjb2RlVVJJQ29tcG9uZW50KSxiPWVuY29kZVVSSUNvbXBvbmVudChiK1wiXCIpLnJlcGxhY2UoLyUoMjN8MjR8MjZ8MkJ8NUV8NjB8N0MpL2csZGVjb2RlVVJJQ29tcG9uZW50KS5yZXBsYWNlKC9bXFwoXFwpXS9nLGVzY2FwZSk7dmFyIGg9XCJcIjtmb3IodmFyIGkgaW4gZilmW2ldJiYoaCs9XCI7IFwiK2ksITAhPT1mW2ldJiYoaCs9XCI9XCIrZltpXS5zcGxpdChcIjtcIilbMF0pKTtyZXR1cm4gZG9jdW1lbnQuY29va2llPWIrXCI9XCIrYytofX1mdW5jdGlvbiBnKGEsYyl7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGRvY3VtZW50KXtmb3IodmFyIGU9e30sZj1kb2N1bWVudC5jb29raWU/ZG9jdW1lbnQuY29va2llLnNwbGl0KFwiOyBcIik6W10sZz0wO2c8Zi5sZW5ndGg7ZysrKXt2YXIgaD1mW2ddLnNwbGl0KFwiPVwiKSxpPWguc2xpY2UoMSkuam9pbihcIj1cIik7Y3x8J1wiJyE9PWkuY2hhckF0KDApfHwoaT1pLnNsaWNlKDEsLTEpKTt0cnl7dmFyIGo9YihoWzBdKTtpZihpPShkLnJlYWR8fGQpKGksail8fGIoaSksYyl0cnl7aT1KU09OLnBhcnNlKGkpfWNhdGNoKGspe31pZihlW2pdPWksYT09PWopYnJlYWt9Y2F0Y2goayl7fX1yZXR1cm4gYT9lW2FdOmV9fXJldHVybiBlLnNldD1mLGUuZ2V0PWZ1bmN0aW9uKGEpe3JldHVybiBnKGEsITEpfSxlLmdldEpTT049ZnVuY3Rpb24oYSl7cmV0dXJuIGcoYSwhMCl9LGUucmVtb3ZlPWZ1bmN0aW9uKGIsYyl7ZihiLFwiXCIsYShjLHtleHBpcmVzOi0xfSkpfSxlLmRlZmF1bHRzPXt9LGUud2l0aENvbnZlcnRlcj1jLGV9cmV0dXJuIGMoZnVuY3Rpb24oKXt9KX0pOyIsIi8qKlxuKiBAYXV0aG9yOiBSaW5hdCBHLiBodHRwOi8vY29kaW5nLmt6XG4qIEBjb3B5cmlnaHQ6IENvcHlyaWdodCAoYykgMjAxOSBSaW5hdCBHLlxuKiBAbGljZW5zZTogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLiBTZWUgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcbiovXG5cbi8vIEZvbGxvd2luZyB0aGUgVU1EIHRlbXBsYXRlIGh0dHBzOi8vZ2l0aHViLmNvbS91bWRqcy91bWQvYmxvYi9tYXN0ZXIvdGVtcGxhdGVzL3JldHVybkV4cG9ydHNHbG9iYWwuanNcbihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAvLyBBTUQuIE1ha2UgZ2xvYmFseSBhdmFpbGFibGUgYXMgd2VsbFxuICAgICAgZGVmaW5lKFsnbW9tZW50J10sIGZ1bmN0aW9uIChtb21lbnQpIHtcbiAgICAgICAgICByZXR1cm4gZmFjdG9yeShtb21lbnQpO1xuICAgICAgfSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICAgIC8vIE5vZGUgLyBCcm93c2VyaWZ5XG4gICAgICB2YXIgbW9tZW50ID0gKHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdpbmRvdy5tb21lbnQgIT0gJ3VuZGVmaW5lZCcpID8gd2luZG93Lm1vbWVudCA6IHJlcXVpcmUoJ21vbWVudCcpO1xuICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KG1vbWVudCk7XG4gIH0gZWxzZSB7XG4gICAgICAvLyBCcm93c2VyIGdsb2JhbHNcbiAgICAgIHJvb3QuTGlnaHRwaWNrID0gZmFjdG9yeShyb290Lm1vbWVudCk7XG4gIH1cbn0odGhpcywgZnVuY3Rpb24obW9tZW50KSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQsXG5cbiAgZGVmYXVsdHMgPSB7XG4gICAgICBmaWVsZDogbnVsbCxcbiAgICAgIHNlY29uZEZpZWxkOiBudWxsLFxuICAgICAgZmlyc3REYXk6IDEsXG4gICAgICBwYXJlbnRFbDogJ2JvZHknLFxuICAgICAgbGFuZzogJ2F1dG8nLFxuICAgICAgZm9ybWF0OiAnREQvTU0vWVlZWScsXG4gICAgICBzZXBhcmF0b3I6ICcgLSAnLFxuICAgICAgbnVtYmVyT2ZNb250aHM6IDEsXG4gICAgICBudW1iZXJPZkNvbHVtbnM6IDIsXG4gICAgICBzaW5nbGVEYXRlOiB0cnVlLFxuICAgICAgYXV0b2Nsb3NlOiB0cnVlLFxuICAgICAgcmVwaWNrOiBmYWxzZSxcbiAgICAgIHN0YXJ0RGF0ZTogbnVsbCxcbiAgICAgIGVuZERhdGU6IG51bGwsXG4gICAgICBtaW5EYXRlOiBudWxsLFxuICAgICAgbWF4RGF0ZTogbnVsbCxcbiAgICAgIGRpc2FibGVEYXRlczogbnVsbCxcbiAgICAgIHNlbGVjdEZvcndhcmQ6IGZhbHNlLFxuICAgICAgc2VsZWN0QmFja3dhcmQ6IGZhbHNlLFxuICAgICAgbWluRGF5czogbnVsbCxcbiAgICAgIG1heERheXM6IG51bGwsXG4gICAgICBvblNlbGVjdDogbnVsbCxcbiAgICAgIG9uT3BlbjogbnVsbCxcbiAgICAgIG9uQ2xvc2U6IG51bGwsXG4gICAgICBvbkVycm9yOiBudWxsLFxuICAgICAgaG92ZXJpbmdUb29sdGlwOiB0cnVlLFxuICAgICAgaGlkZU9uQm9keUNsaWNrOiB0cnVlLFxuICAgICAgZm9vdGVyOiBmYWxzZSxcbiAgICAgIGRpc2FibGVkRGF0ZXNJblJhbmdlOiB0cnVlLFxuICAgICAgdG9vbHRpcE5pZ2h0czogZmFsc2UsXG4gICAgICBvcmllbnRhdGlvbjogJ2F1dG8nLFxuICAgICAgZGlzYWJsZVdlZWtlbmRzOiBmYWxzZSxcbiAgICAgIGxvY2FsZToge1xuICAgICAgICAgIGJ1dHRvbnM6IHtcbiAgICAgICAgICAgICAgcHJldjogJyZsZWZ0YXJyb3c7JyxcbiAgICAgICAgICAgICAgbmV4dDogJyZyaWdodGFycm93OycsXG4gICAgICAgICAgICAgIGNsb3NlOiAnJnRpbWVzOycsXG4gICAgICAgICAgICAgIHJlc2V0OiAnUmVzZXQnLFxuICAgICAgICAgICAgICBhcHBseTogJ0FwcGx5JyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRvb2x0aXA6IHtcbiAgICAgICAgICAgICAgb25lOiAnZGF5JyxcbiAgICAgICAgICAgICAgb3RoZXI6ICdkYXlzJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRvb2x0aXBPbkRpc2FibGVkOiBudWxsLFxuICAgICAgICAgIHBsdXJhbGl6ZTogZnVuY3Rpb24oaSwgbG9jYWxlKXtcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpID09PSBcInN0cmluZ1wiKSBpID0gcGFyc2VJbnQoaSwgMTApO1xuXG4gICAgICAgICAgICAgIGlmIChpID09PSAxICYmICdvbmUnIGluIGxvY2FsZSkgcmV0dXJuIGxvY2FsZS5vbmU7XG4gICAgICAgICAgICAgIGlmICgnb3RoZXInIGluIGxvY2FsZSkgcmV0dXJuIGxvY2FsZS5vdGhlcjtcblxuICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgfVxuICAgICAgfVxuICB9LFxuXG4gIHJlbmRlclRvcEJ1dHRvbnMgPSBmdW5jdGlvbihvcHRzLCB2aWV3TW9kZSlcbiAge1xuICAgICAgcmV0dXJuICc8ZGl2IGNsYXNzPVwibGlnaHRwaWNrX190b29sYmFyXCI+J1xuICAgICAgICAgICsgJydcbiAgICAgICAgICArICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImxpZ2h0cGlja19fcHJldmlvdXMtYWN0aW9uXCIgZGF0YS12aWV3LW1vZGU9XCInICsgdmlld01vZGUgKyAnXCI+JyArIG9wdHMubG9jYWxlLmJ1dHRvbnMucHJldiArICc8L2J1dHRvbj4nXG4gICAgICAgICAgKyAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJsaWdodHBpY2tfX25leHQtYWN0aW9uXCIgZGF0YS12aWV3LW1vZGU9XCInICsgdmlld01vZGUgKyAnXCI+JyArIG9wdHMubG9jYWxlLmJ1dHRvbnMubmV4dCArICc8L2J1dHRvbj4nXG4gICAgICAgICAgKyAoIW9wdHMuYXV0b2Nsb3NlID8gJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwibGlnaHRwaWNrX19jbG9zZS1hY3Rpb25cIj4nICsgb3B0cy5sb2NhbGUuYnV0dG9ucy5jbG9zZSArICc8L2J1dHRvbj4nICA6ICcnKVxuICAgICAgICAgICsgJzwvZGl2Pic7XG4gIH0sXG5cbiAgd2Vla2RheU5hbWUgPSBmdW5jdGlvbihvcHRzLCBkYXksIHNob3J0KVxuICB7XG4gICAgICByZXR1cm4gbmV3IERhdGUoMTk3MCwgMCwgZGF5KS50b0xvY2FsZVN0cmluZyhvcHRzLmxhbmcsIHsgd2Vla2RheTogc2hvcnQgPyAnc2hvcnQnIDogJ2xvbmcnIH0pXG4gIH0sXG5cbiAgcmVuZGVyRGF5ID0gZnVuY3Rpb24ob3B0cywgZGF0ZSwgZHVtbXksIGV4dHJhQ2xhc3MpXG4gIHtcbiAgICAgIGlmIChkdW1teSkgcmV0dXJuICc8ZGl2PjwvZGl2Pic7XG5cbiAgICAgIHZhciBkYXRlID0gbW9tZW50KGRhdGUpLFxuICAgICAgICAgIHByZXZNb250aCA9IG1vbWVudChkYXRlKS5zdWJ0cmFjdCgxLCAnbW9udGgnKSxcbiAgICAgICAgICBuZXh0TW9udGggPSBtb21lbnQoZGF0ZSkuYWRkKDEsICdtb250aCcpO1xuXG4gICAgICB2YXIgZGF5ID0ge1xuICAgICAgICAgIHRpbWU6IG1vbWVudChkYXRlKS52YWx1ZU9mKCksXG4gICAgICAgICAgY2xhc3NOYW1lOiBbJ2xpZ2h0cGlja19fZGF5JywgJ2lzLWF2YWlsYWJsZSddXG4gICAgICB9O1xuXG4gICAgICBpZiAoZXh0cmFDbGFzcyBpbnN0YW5jZW9mIEFycmF5IHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChleHRyYUNsYXNzKSA9PT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICAgIGV4dHJhQ2xhc3MgPSBleHRyYUNsYXNzLmZpbHRlciggZnVuY3Rpb24oIGVsICkge1xuICAgICAgICAgICAgICByZXR1cm4gWydsaWdodHBpY2tfX2RheScsICdpcy1hdmFpbGFibGUnLCAnaXMtcHJldmlvdXMtbW9udGgnLCAnaXMtbmV4dC1tb250aCddLmluZGV4T2YoIGVsICkgPj0gMDtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBkYXkuY2xhc3NOYW1lID0gZGF5LmNsYXNzTmFtZS5jb25jYXQoZXh0cmFDbGFzcyk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgICBkYXkuY2xhc3NOYW1lLnB1c2goZXh0cmFDbGFzcyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRzLmRpc2FibGVEYXRlcykge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3B0cy5kaXNhYmxlRGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgaWYgKG9wdHMuZGlzYWJsZURhdGVzW2ldIGluc3RhbmNlb2YgQXJyYXkgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9wdHMuZGlzYWJsZURhdGVzW2ldKSA9PT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgICAgICAgICAgICAgdmFyIF9mcm9tID0gbW9tZW50KG9wdHMuZGlzYWJsZURhdGVzW2ldWzBdKSxcbiAgICAgICAgICAgICAgICAgICAgICBfdG8gPSBtb21lbnQob3B0cy5kaXNhYmxlRGF0ZXNbaV1bMV0pO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoX2Zyb20uaXNWYWxpZCgpICYmIF90by5pc1ZhbGlkKCkgJiYgZGF0ZS5pc0JldHdlZW4oX2Zyb20sIF90bywgJ2RheScsICdbXScpKXtcbiAgICAgICAgICAgICAgICAgICAgICBkYXkuY2xhc3NOYW1lLnB1c2goJ2lzLWRpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxzZSBpZiAobW9tZW50KG9wdHMuZGlzYWJsZURhdGVzW2ldKS5pc1ZhbGlkKCkgJiYgbW9tZW50KG9wdHMuZGlzYWJsZURhdGVzW2ldKS5pc1NhbWUoZGF0ZSwgJ2RheScpKSB7XG4gICAgICAgICAgICAgICAgICBkYXkuY2xhc3NOYW1lLnB1c2goJ2lzLWRpc2FibGVkJyk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoZGF5LmNsYXNzTmFtZS5pbmRleE9mKCdpcy1kaXNhYmxlZCcpID49IDApIHtcblxuICAgICAgICAgICAgICAgICAgaWYgKG9wdHMubG9jYWxlLnRvb2x0aXBPbkRpc2FibGVkICYmICghb3B0cy5zdGFydERhdGUgfHwgZGF0ZS5pc0FmdGVyKG9wdHMuc3RhcnREYXRlKSB8fCBvcHRzLnN0YXJ0RGF0ZSAmJiBvcHRzLmVuZERhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZGF5LmNsYXNzTmFtZS5wdXNoKCdkaXNhYmxlZC10b29sdGlwJyk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmIChkYXkuY2xhc3NOYW1lLmluZGV4T2YoJ2lzLXN0YXJ0LWRhdGUnKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRFbmREYXRlKG51bGwpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZGF5LmNsYXNzTmFtZS5pbmRleE9mKCdpcy1lbmQtZGF0ZScpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEVuZERhdGUobnVsbCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRzLm1pbkRheXMgJiYgb3B0cy5zdGFydERhdGUgJiYgIW9wdHMuZW5kRGF0ZSkge1xuICAgICAgICAgIGlmIChkYXRlLmlzQmV0d2Vlbihtb21lbnQob3B0cy5zdGFydERhdGUpLnN1YnRyYWN0KG9wdHMubWluRGF5cyAtIDEsICdkYXknKSwgbW9tZW50KG9wdHMuc3RhcnREYXRlKS5hZGQob3B0cy5taW5EYXlzIC0gMSwgJ2RheScpLCAnZGF5JykpIHtcbiAgICAgICAgICAgICAgZGF5LmNsYXNzTmFtZS5wdXNoKCdpcy1kaXNhYmxlZCcpO1xuXG4gICAgICAgICAgICAgIGlmIChvcHRzLnNlbGVjdEZvcndhcmQgJiYgZGF0ZS5pc1NhbWVPckFmdGVyKG9wdHMuc3RhcnREYXRlKSkge1xuICAgICAgICAgICAgICAgICAgZGF5LmNsYXNzTmFtZS5wdXNoKCdpcy1mb3J3YXJkLXNlbGVjdGVkJyk7XG4gICAgICAgICAgICAgICAgICBkYXkuY2xhc3NOYW1lLnB1c2goJ2lzLWluLXJhbmdlJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRzLm1heERheXMgJiYgb3B0cy5zdGFydERhdGUgJiYgIW9wdHMuZW5kRGF0ZSkge1xuICAgICAgICAgIGlmIChkYXRlLmlzU2FtZU9yQmVmb3JlKG1vbWVudChvcHRzLnN0YXJ0RGF0ZSkuc3VidHJhY3Qob3B0cy5tYXhEYXlzLCAnZGF5JyksICdkYXknKSkge1xuICAgICAgICAgICAgICBkYXkuY2xhc3NOYW1lLnB1c2goJ2lzLWRpc2FibGVkJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKGRhdGUuaXNTYW1lT3JBZnRlcihtb21lbnQob3B0cy5zdGFydERhdGUpLmFkZChvcHRzLm1heERheXMsICdkYXknKSwgJ2RheScpKSB7XG4gICAgICAgICAgICAgIGRheS5jbGFzc05hbWUucHVzaCgnaXMtZGlzYWJsZWQnKTtcbiAgICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRzLnJlcGljayAmJiAob3B0cy5taW5EYXlzIHx8IG9wdHMubWF4RGF5cykgJiYgb3B0cy5zdGFydERhdGUgJiYgb3B0cy5lbmREYXRlKSB7XG4gICAgICAgICAgdmFyIHRlbXBTdGFydERhdGUgPSBtb21lbnQob3B0cy5yZXBpY2tUcmlnZ2VyID09IG9wdHMuZmllbGQgPyBvcHRzLmVuZERhdGUgOiBvcHRzLnN0YXJ0RGF0ZSk7XG5cbiAgICAgICAgICBpZiAob3B0cy5taW5EYXlzKSB7XG4gICAgICAgICAgICAgIGlmIChkYXRlLmlzQmV0d2Vlbihtb21lbnQodGVtcFN0YXJ0RGF0ZSkuc3VidHJhY3Qob3B0cy5taW5EYXlzIC0gMSwgJ2RheScpLCBtb21lbnQodGVtcFN0YXJ0RGF0ZSkuYWRkKG9wdHMubWluRGF5cyAtIDEsICdkYXknKSwgJ2RheScpKSB7XG4gICAgICAgICAgICAgICAgICBkYXkuY2xhc3NOYW1lLnB1c2goJ2lzLWRpc2FibGVkJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAob3B0cy5tYXhEYXlzKSB7XG4gICAgICAgICAgICAgIGlmIChkYXRlLmlzU2FtZU9yQmVmb3JlKG1vbWVudCh0ZW1wU3RhcnREYXRlKS5zdWJ0cmFjdChvcHRzLm1heERheXMsICdkYXknKSwgJ2RheScpKSB7XG4gICAgICAgICAgICAgICAgICBkYXkuY2xhc3NOYW1lLnB1c2goJ2lzLWRpc2FibGVkJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxzZSBpZiAoZGF0ZS5pc1NhbWVPckFmdGVyKG1vbWVudCh0ZW1wU3RhcnREYXRlKS5hZGQob3B0cy5tYXhEYXlzLCAnZGF5JyksICdkYXknKSkge1xuICAgICAgICAgICAgICAgICAgZGF5LmNsYXNzTmFtZS5wdXNoKCdpcy1kaXNhYmxlZCcpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoZGF0ZS5pc1NhbWUobmV3IERhdGUoKSwgJ2RheScpKSB7XG4gICAgICAgICAgZGF5LmNsYXNzTmFtZS5wdXNoKCdpcy10b2RheScpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZGF0ZS5pc1NhbWUob3B0cy5zdGFydERhdGUsICdkYXknKSkge1xuICAgICAgICAgIGRheS5jbGFzc05hbWUucHVzaCgnaXMtc3RhcnQtZGF0ZScpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZGF0ZS5pc1NhbWUob3B0cy5lbmREYXRlLCAnZGF5JykpIHtcbiAgICAgICAgICBkYXkuY2xhc3NOYW1lLnB1c2goJ2lzLWVuZC1kYXRlJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRzLnN0YXJ0RGF0ZSAmJiBvcHRzLmVuZERhdGUgJiYgZGF0ZS5pc0JldHdlZW4ob3B0cy5zdGFydERhdGUsIG9wdHMuZW5kRGF0ZSwgJ2RheScsICdbXScpKSB7XG4gICAgICAgICAgZGF5LmNsYXNzTmFtZS5wdXNoKCdpcy1pbi1yYW5nZScpO1xuICAgICAgfVxuXG4gICAgICBpZiAobW9tZW50KCkuaXNTYW1lKGRhdGUsICdtb250aCcpKSB7XG5cbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHByZXZNb250aC5pc1NhbWUoZGF0ZSwgJ21vbnRoJykpIHtcbiAgICAgICAgICBkYXkuY2xhc3NOYW1lLnB1c2goJ2lzLXByZXZpb3VzLW1vbnRoJyk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChuZXh0TW9udGguaXNTYW1lKGRhdGUsICdtb250aCcpKSB7XG4gICAgICAgICAgZGF5LmNsYXNzTmFtZS5wdXNoKCdpcy1uZXh0LW1vbnRoJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRzLm1pbkRhdGUgJiYgZGF0ZS5pc0JlZm9yZShvcHRzLm1pbkRhdGUsICdkYXknKSkge1xuICAgICAgICAgIGRheS5jbGFzc05hbWUucHVzaCgnaXMtZGlzYWJsZWQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdHMubWF4RGF0ZSAmJiBkYXRlLmlzQWZ0ZXIob3B0cy5tYXhEYXRlLCAnZGF5JykpIHtcbiAgICAgICAgICBkYXkuY2xhc3NOYW1lLnB1c2goJ2lzLWRpc2FibGVkJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRzLnNlbGVjdEZvcndhcmQgJiYgIW9wdHMuc2luZ2xlRGF0ZSAmJiBvcHRzLnN0YXJ0RGF0ZSAmJiAhb3B0cy5lbmREYXRlICYmIGRhdGUuaXNCZWZvcmUob3B0cy5zdGFydERhdGUsICdkYXknKSkge1xuICAgICAgICAgIGRheS5jbGFzc05hbWUucHVzaCgnaXMtZGlzYWJsZWQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdHMuc2VsZWN0QmFja3dhcmQgJiYgIW9wdHMuc2luZ2xlRGF0ZSAmJiBvcHRzLnN0YXJ0RGF0ZSAmJiAhb3B0cy5lbmREYXRlICYmIGRhdGUuaXNBZnRlcihvcHRzLnN0YXJ0RGF0ZSwgJ2RheScpKSB7XG4gICAgICAgICAgZGF5LmNsYXNzTmFtZS5wdXNoKCdpcy1kaXNhYmxlZCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAob3B0cy5kaXNhYmxlV2Vla2VuZHMgJiYgKGRhdGUuaXNvV2Vla2RheSgpID09IDYgfHwgZGF0ZS5pc29XZWVrZGF5KCkgPT0gNykpIHtcbiAgICAgICAgICBkYXkuY2xhc3NOYW1lLnB1c2goJ2lzLWRpc2FibGVkJyk7XG4gICAgICB9XG5cbiAgICAgIGRheS5jbGFzc05hbWUgPSBkYXkuY2xhc3NOYW1lLmZpbHRlcihmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIHNlbGYpIHtcbiAgICAgICAgICByZXR1cm4gc2VsZi5pbmRleE9mKHZhbHVlKSA9PT0gaW5kZXg7XG4gICAgICB9KTtcblxuICAgICAgaWYgKGRheS5jbGFzc05hbWUuaW5kZXhPZignaXMtZGlzYWJsZWQnKSA+PSAwICYmIGRheS5jbGFzc05hbWUuaW5kZXhPZignaXMtYXZhaWxhYmxlJykgPj0gMCkge1xuICAgICAgICAgIGRheS5jbGFzc05hbWUuc3BsaWNlKGRheS5jbGFzc05hbWUuaW5kZXhPZignaXMtYXZhaWxhYmxlJyksIDEpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBkaXYuY2xhc3NOYW1lID0gZGF5LmNsYXNzTmFtZS5qb2luKCcgJyk7XG4gICAgICBkaXYuaW5uZXJIVE1MID0gZGF0ZS5nZXQoJ2RhdGUnKTtcbiAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtdGltZScsIGRheS50aW1lKTtcblxuICAgICAgcmV0dXJuIGRpdi5vdXRlckhUTUw7XG4gIH0sXG5cbiAgcmVuZGVyQ2FsZW5kYXIgPSBmdW5jdGlvbihlbCwgb3B0cylcbiAge1xuICAgICAgdmFyIGh0bWwgPSAnJyxcbiAgICAgICAgICBtb250aERhdGUgPSBtb21lbnQob3B0cy5jYWxlbmRhclswXSk7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3B0cy5udW1iZXJPZk1vbnRoczsgaSsrKSB7XG4gICAgICAgICAgdmFyIGRheSA9IG1vbWVudChtb250aERhdGUpO1xuXG4gICAgICAgICAgaHRtbCArPSAnPHNlY3Rpb24gY2xhc3M9XCJsaWdodHBpY2tfX21vbnRoXCI+JztcbiAgICAgICAgICBodG1sICs9ICc8aGVhZGVyIGNsYXNzPVwibGlnaHRwaWNrX19tb250aC10aXRsZS1iYXJcIj4nXG4gICAgICAgICAgaHRtbCArPSAnPGgxIGNsYXNzPVwibGlnaHRwaWNrX19tb250aC10aXRsZVwiIGRhdGEteW09XCInICsgZGF5LmZvcm1hdCgnWVlZWS1NTScpICsgJ1wiPidcbiAgICAgICAgICArICc8YiBjbGFzcz1cImxpZ2h0cGlja19fbW9udGgtdGl0bGUtYWNjZW50XCI+JyArIGRheS50b0RhdGUoKS50b0xvY2FsZVN0cmluZyhvcHRzLmxhbmcsIHsgbW9udGg6ICdsb25nJyB9KSArICc8L2I+ICdcbiAgICAgICAgICArIGRheS5mb3JtYXQoJ1lZWVknKVxuICAgICAgICAgICsgJzwvaDE+JztcblxuICAgICAgICAgIGlmIChvcHRzLm51bWJlck9mTW9udGhzID09PSAxKSB7XG4gICAgICAgICAgICAgIGh0bWwgKz0gcmVuZGVyVG9wQnV0dG9ucyhvcHRzLCAnZGF5cycpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGh0bWwgKz0gJzwvaGVhZGVyPic7IC8vIGxpZ2h0cGlja19fbW9udGgtdGl0bGUtYmFyXG5cbiAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwibGlnaHRwaWNrX19kYXlzLW9mLXRoZS13ZWVrXCI+JztcbiAgICAgICAgICBmb3IgKHZhciB3ID0gb3B0cy5maXJzdERheSArIDQ7IHcgPCA3ICsgb3B0cy5maXJzdERheSArIDQ7ICsrdykge1xuICAgICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwibGlnaHRwaWNrX19kYXktb2YtdGhlLXdlZWtcIiB0aXRsZT1cIicgKyB3ZWVrZGF5TmFtZShvcHRzLCB3KSArICdcIj4nICsgd2Vla2RheU5hbWUob3B0cywgdywgdHJ1ZSkgKyAnPC9kaXY+JztcbiAgICAgICAgICB9XG4gICAgICAgICAgaHRtbCArPSAnPC9kaXY+JzsgLy8gbGlnaHRwaWNrX19kYXlzLW9mLXRoZS13ZWVrXG5cbiAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwibGlnaHRwaWNrX19kYXlzXCI+JztcblxuICAgICAgICAgIGlmIChkYXkuaXNvV2Vla2RheSgpICE9PSBvcHRzLmZpcnN0RGF5KSB7XG4gICAgICAgICAgICAgIHZhciBwcmV2RGF5cyA9IGRheS5pc29XZWVrZGF5KCkgLSBvcHRzLmZpcnN0RGF5ID4gMCA/IGRheS5pc29XZWVrZGF5KCkgLSBvcHRzLmZpcnN0RGF5IDogZGF5Lmlzb1dlZWtkYXkoKSxcbiAgICAgICAgICAgICAgICAgIHByZXZNb250aCA9IG1vbWVudChkYXkpLnN1YnRyYWN0KHByZXZEYXlzLCAnZGF5JyksXG4gICAgICAgICAgICAgICAgICBkYXlzSW5Nb250aCA9IHByZXZNb250aC5kYXlzSW5Nb250aCgpO1xuXG4gICAgICAgICAgICAgIGZvciAodmFyIGQgPSBwcmV2TW9udGguZ2V0KCdkYXRlJyk7IGQgPD0gZGF5c0luTW9udGg7IGQrKykge1xuICAgICAgICAgICAgICAgICAgaHRtbCArPSByZW5kZXJEYXkob3B0cywgcHJldk1vbnRoLCBpID4gMCwgJ2lzLXByZXZpb3VzLW1vbnRoJyk7XG5cbiAgICAgICAgICAgICAgICAgIHByZXZNb250aC5hZGQoMSwgJ2RheScpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIGRheXNJbk1vbnRoID0gZGF5LmRheXNJbk1vbnRoKCksXG4gICAgICAgICAgICAgIHRvZGF5ID0gbmV3IERhdGUoKTtcblxuICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBkIDwgZGF5c0luTW9udGg7IGQrKykge1xuICAgICAgICAgICAgICBodG1sICs9IHJlbmRlckRheShvcHRzLCBkYXkpO1xuXG4gICAgICAgICAgICAgIGRheS5hZGQoMSwgJ2RheScpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBuZXh0TW9udGggPSBtb21lbnQoZGF5KSxcbiAgICAgICAgICAgICAgbmV4dERheXMgPSA3IC0gbmV4dE1vbnRoLmlzb1dlZWtkYXkoKSArIG9wdHMuZmlyc3REYXk7XG5cbiAgICAgICAgICBpZiAobmV4dERheXMgPCA3KSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIGQgPSBuZXh0TW9udGguZ2V0KCdkYXRlJyk7IGQgPD0gbmV4dERheXM7IGQrKykge1xuICAgICAgICAgICAgICAgICAgaHRtbCArPSByZW5kZXJEYXkob3B0cywgbmV4dE1vbnRoLCBpIDwgb3B0cy5udW1iZXJPZk1vbnRocyAtIDEsICdpcy1uZXh0LW1vbnRoJyk7XG5cbiAgICAgICAgICAgICAgICAgIG5leHRNb250aC5hZGQoMSwgJ2RheScpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaHRtbCArPSAnPC9kaXY+JzsgLy8gbGlnaHRwaWNrX19kYXlzXG5cbiAgICAgICAgICBodG1sICs9ICc8L3NlY3Rpb24+JzsgLy8gbGlnaHRwaWNrX19tb250aFxuXG4gICAgICAgICAgbW9udGhEYXRlLmFkZCgxLCAnbW9udGgnKTtcbiAgICAgIH1cblxuICAgICAgb3B0cy5jYWxlbmRhclsxXSA9IG1vbWVudChtb250aERhdGUpO1xuXG4gICAgICBlbC5xdWVyeVNlbGVjdG9yKCcubGlnaHRwaWNrX19tb250aHMnKS5pbm5lckhUTUwgPSBodG1sO1xuICB9LFxuXG4gIHJlbmRlck1vbnRoc09mWWVhciA9IGZ1bmN0aW9uKGVsLCBvcHRzLCBkYXRlKVxuICB7XG4gICAgICBpZiAoZGF0ZSkge1xuICAgICAgICAgIG9wdHMuY2FsZW5kYXJbMF0gPSBtb21lbnQoZGF0ZSk7XG4gICAgICB9XG4gICAgICB2YXIgeW0gPSBtb21lbnQob3B0cy5jYWxlbmRhclswXSk7XG5cbiAgICAgIHZhciBodG1sID0gJzxoZWFkZXIgY2xhc3M9XCJsaWdodHBpY2tfX21vbnRoLXRpdGxlLWJhclwiPidcbiAgICAgIGh0bWwgKz0gJzxoMSBjbGFzcz1cImxpZ2h0cGlja19fbW9udGgtdGl0bGVcIj4nICsgeW0uZm9ybWF0KCdZWVlZJykgKyAgJzwvaDE+JztcbiAgICAgIGh0bWwgKz0gcmVuZGVyVG9wQnV0dG9ucyhvcHRzLCAnbW9udGhzJyk7XG4gICAgICBodG1sICs9ICc8L2hlYWRlcj4nO1xuXG4gICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwibGlnaHRwaWNrX19tb250aHMtb2YtdGhlLXllYXItbGlzdFwiPic7XG5cbiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IDEyOyBpKyspIHtcbiAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwibGlnaHRwaWNrX19tb250aC1vZi10aGUteWVhclwiIGRhdGEtZ290by1tb250aD1cIicgKyB5bS5mb3JtYXQoJ1lZWVknKSArICctJyArIGkgKyAnXCI+J1xuICAgICAgICAgICAgICAgKyAnPGRpdj4nICsgbW9tZW50KGksICdNJykudG9EYXRlKCkudG9Mb2NhbGVTdHJpbmcob3B0cy5sYW5nLCB7IG1vbnRoOiAnbG9uZycgfSkgKyAnPC9kaXY+J1xuICAgICAgICAgICAgICAgKyAnPGRpdj4nICsgeW0uZm9ybWF0KCdZWVlZJykgKyAnPC9kaXY+J1xuICAgICAgICAgICAgICAgKyAnPC9kaXY+JztcbiAgICAgIH1cbiAgICAgIGh0bWwgKz0gJzwvZGl2Pic7XG5cbiAgICAgIGVsLnF1ZXJ5U2VsZWN0b3IoJy5saWdodHBpY2tfX21vbnRocy1vZi10aGUteWVhcicpLmlubmVySFRNTCA9IGh0bWw7XG4gIH0sXG5cbiAgdXBkYXRlRGF0ZXMgPSBmdW5jdGlvbihlbCwgb3B0cylcbiAge1xuICAgICAgdmFyIGRheXMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCcubGlnaHRwaWNrX19kYXknKTtcbiAgICAgIFtdLmZvckVhY2guY2FsbChkYXlzLCBmdW5jdGlvbihkYXkpIHtcbiAgICAgICAgICBkYXkub3V0ZXJIVE1MID0gcmVuZGVyRGF5KG9wdHMsIHBhcnNlSW50KGRheS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGltZScpKSwgZmFsc2UsIGRheS5jbGFzc05hbWUuc3BsaXQoJyAnKSk7XG4gICAgICB9KTtcblxuICAgICAgY2hlY2tEaXNhYmxlZERhdGVzSW5SYW5nZShlbCwgb3B0cyk7XG4gIH0sXG5cbiAgY2hlY2tEaXNhYmxlZERhdGVzSW5SYW5nZSA9IGZ1bmN0aW9uKGVsLCBvcHRzKVxuICB7XG4gICAgICBpZiAob3B0cy5kaXNhYmxlZERhdGVzSW5SYW5nZSB8fCAhb3B0cy5zdGFydERhdGUgfHwgb3B0cy5lbmREYXRlIHx8ICFvcHRzLmRpc2FibGVEYXRlcykgcmV0dXJuO1xuXG4gICAgICB2YXIgZGF5cyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5saWdodHBpY2tfX2RheScpLFxuICAgICAgICAgIGRpc2FibGVkQXJyYXkgPSBvcHRzLmRpc2FibGVEYXRlcy5tYXAoZnVuY3Rpb24oZW50cnkpe1xuICAgICAgICAgICAgICByZXR1cm4gZW50cnkgaW5zdGFuY2VvZiBBcnJheSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZW50cnkpID09PSAnW29iamVjdCBBcnJheV0nID8gZW50cnlbMF0gOiBlbnRyeTtcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBjbG9zZXN0UHJldiA9IG1vbWVudChkaXNhYmxlZEFycmF5LmZpbHRlcihmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtb21lbnQoZCkuaXNCZWZvcmUob3B0cy5zdGFydERhdGUpO1xuICAgICAgICAgIH0pLnNvcnQoZnVuY3Rpb24oYSxiKXtcbiAgICAgICAgICAgICAgcmV0dXJuIG1vbWVudChiKS5pc0FmdGVyKG1vbWVudChhKSk7XG4gICAgICAgICAgfSlbMF0pLFxuICAgICAgICAgIGNsb3Nlc3ROZXh0ID0gbW9tZW50KGRpc2FibGVkQXJyYXkuZmlsdGVyKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1vbWVudChkKS5pc0FmdGVyKG9wdHMuc3RhcnREYXRlKTtcbiAgICAgICAgICB9KS5zb3J0KGZ1bmN0aW9uKGEsYil7XG4gICAgICAgICAgICAgIHJldHVybiBtb21lbnQoYSkuaXNBZnRlcihtb21lbnQoYikpO1xuICAgICAgICAgIH0pWzBdKTtcblxuICAgICAgW10uZm9yRWFjaC5jYWxsKGRheXMsIGZ1bmN0aW9uKGRheUNlbGwpIHtcbiAgICAgICAgICB2YXIgZGF5ID0gbW9tZW50KHBhcnNlSW50KGRheUNlbGwuZ2V0QXR0cmlidXRlKCdkYXRhLXRpbWUnKSkpO1xuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgKGNsb3Nlc3RQcmV2ICYmIGRheS5pc0JlZm9yZShjbG9zZXN0UHJldikgJiYgb3B0cy5zdGFydERhdGUuaXNBZnRlcihjbG9zZXN0UHJldikpXG4gICAgICAgICAgICAgIHx8IChjbG9zZXN0TmV4dCAmJiBkYXkuaXNBZnRlcihjbG9zZXN0TmV4dCkgJiYgY2xvc2VzdE5leHQuaXNBZnRlcihvcHRzLnN0YXJ0RGF0ZSkpXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICAgIGRheUNlbGwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYXZhaWxhYmxlJyk7XG4gICAgICAgICAgICAgIGRheUNlbGwuY2xhc3NMaXN0LmFkZCgnaXMtZGlzYWJsZWQnKTtcbiAgICAgICAgICB9XG4gICAgICB9KTtcbiAgfSxcblxuICBMaWdodHBpY2sgPSBmdW5jdGlvbihvcHRpb25zKVxuICB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICAgICAgb3B0cyA9IHNlbGYuY29uZmlnKG9wdGlvbnMpO1xuXG4gICAgICBzZWxmLmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VjdGlvbicpO1xuXG4gICAgICBzZWxmLmVsLmNsYXNzTmFtZSA9ICdsaWdodHBpY2sgbGlnaHRwaWNrLS0nICsgb3B0cy5udW1iZXJPZkNvbHVtbnMgKyAnLWNvbHVtbnMgaXMtaGlkZGVuJztcblxuICAgICAgaWYgKG9wdHMucGFyZW50RWwgIT09ICdib2R5Jykge1xuICAgICAgICAgIHNlbGYuZWwuY2xhc3NOYW1lICs9ICcgbGlnaHRwaWNrLS1pbmxpbmVkJztcbiAgICAgIH1cblxuICAgICAgdmFyIGh0bWwgPSAnPGRpdiBjbGFzcz1cImxpZ2h0cGlja19faW5uZXJcIj4nXG4gICAgICArIChvcHRzLm51bWJlck9mTW9udGhzID4gMSA/IHJlbmRlclRvcEJ1dHRvbnMob3B0cywgJ2RheXMnKSA6ICcnKVxuICAgICAgKyAnPGRpdiBjbGFzcz1cImxpZ2h0cGlja19fbW9udGhzXCI+PC9kaXY+J1xuICAgICAgKyAnPGRpdiBjbGFzcz1cImxpZ2h0cGlja19fdG9vbHRpcFwiIHN0eWxlPVwidmlzaWJpbGl0eTogaGlkZGVuXCI+PC9kaXY+J1xuICAgICAgKyAnPGRpdiBjbGFzcz1cImxpZ2h0cGlja19fbW9udGhzLW9mLXRoZS15ZWFyXCI+PC9kaXY+JztcblxuICAgICAgaWYgKG9wdHMuZm9vdGVyKSB7XG4gICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cImxpZ2h0cGlja19fZm9vdGVyXCI+JztcbiAgICAgICAgICBpZiAob3B0cy5mb290ZXIgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgaHRtbCArPSAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJsaWdodHBpY2tfX3Jlc2V0LWFjdGlvblwiPicgKyBvcHRzLmxvY2FsZS5idXR0b25zLnJlc2V0ICsgJzwvYnV0dG9uPic7XG4gICAgICAgICAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJsaWdodHBpY2tfX2Zvb3Rlci1tZXNzYWdlXCI+PC9kaXY+JztcbiAgICAgICAgICAgICAgaHRtbCArPSAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJsaWdodHBpY2tfX2FwcGx5LWFjdGlvblwiPicgKyBvcHRzLmxvY2FsZS5idXR0b25zLmFwcGx5ICsgJzwvYnV0dG9uPic7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICBodG1sICs9IG9wdHMuZm9vdGVyO1xuICAgICAgICAgIH1cbiAgICAgICAgICBodG1sICs9ICc8L2Rpdj4nO1xuICAgICAgfVxuXG4gICAgICBodG1sICs9ICc8L2Rpdj4nO1xuXG4gICAgICBzZWxmLmVsLmlubmVySFRNTCA9IGh0bWw7XG5cblxuICAgICAgaWYgKG9wdHMucGFyZW50RWwgaW5zdGFuY2VvZiBOb2RlKSB7XG4gICAgICAgICAgb3B0cy5wYXJlbnRFbC5hcHBlbmRDaGlsZChzZWxmLmVsKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG9wdHMucGFyZW50RWwpLmFwcGVuZENoaWxkKHNlbGYuZWwpO1xuICAgICAgfVxuXG4gICAgICBzZWxmLl9vbk1vdXNlRG93biA9IGZ1bmN0aW9uKGUpXG4gICAgICB7XG4gICAgICAgICAgaWYgKCFzZWxmLmlzU2hvd2luZykge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50O1xuICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XG4gICAgICAgICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgdmFyIG9wdHMgPSBzZWxmLl9vcHRzO1xuXG4gICAgICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2xpZ2h0cGlja19fZGF5JykgJiYgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaXMtYXZhaWxhYmxlJykpIHtcblxuICAgICAgICAgICAgICB2YXIgZGF5ID0gbW9tZW50KHBhcnNlSW50KHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGltZScpKSk7XG5cbiAgICAgICAgICAgICAgaWYgKCFvcHRzLmRpc2FibGVkRGF0ZXNJblJhbmdlICYmIG9wdHMuZGlzYWJsZURhdGVzICYmIG9wdHMuc3RhcnREYXRlKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBkYXkuaXNBZnRlcihvcHRzLnN0YXJ0RGF0ZSkgPyBtb21lbnQob3B0cy5zdGFydERhdGUpIDogbW9tZW50KGRheSksXG4gICAgICAgICAgICAgICAgICAgICAgZW5kID0gZGF5LmlzQWZ0ZXIob3B0cy5zdGFydERhdGUpID8gbW9tZW50KGRheSkgOiBtb21lbnQob3B0cy5zdGFydERhdGUpLFxuXG4gICAgICAgICAgICAgICAgICAgICAgaXNJbnZhbGlkUmFuZ2UgPSBvcHRzLmRpc2FibGVEYXRlcy5maWx0ZXIoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgIGlmIChkIGluc3RhbmNlb2YgQXJyYXkgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGQpID09PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfZnJvbSA9IG1vbWVudChkWzBdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90byA9IG1vbWVudChkWzFdKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2Zyb20uaXNWYWxpZCgpICYmIF90by5pc1ZhbGlkKCkgJiYgKF9mcm9tLmlzQmV0d2VlbihzdGFydCwgZW5kLCAnZGF5JywgJ1tdJykgfHwgX3RvLmlzQmV0d2VlbihzdGFydCwgZW5kLCAnZGF5JywgJ1tdJykpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb21lbnQoZCkuaXNCZXR3ZWVuKHN0YXJ0LCBlbmQsICdkYXknLCAnW10nKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoaXNJbnZhbGlkUmFuZ2UubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRTdGFydERhdGUobnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRFbmREYXRlKG51bGwpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdtb3VzZWRvd24nKSk7XG4gICAgICAgICAgICAgICAgICAgICAgc2VsZi5lbC5xdWVyeVNlbGVjdG9yKCcubGlnaHRwaWNrX190b29sdGlwJykuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xuXG4gICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGF0ZXMoc2VsZi5lbCwgb3B0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKG9wdHMuc2luZ2xlRGF0ZSB8fCAoIW9wdHMuc3RhcnREYXRlICYmICFvcHRzLmVuZERhdGUpIHx8IChvcHRzLnN0YXJ0RGF0ZSAmJiBvcHRzLmVuZERhdGUpKSB7XG4gICAgICAgICAgICAgICAgICBpZiAob3B0cy5yZXBpY2sgJiYgb3B0cy5zdGFydERhdGUgJiYgb3B0cy5lbmREYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdHMucmVwaWNrVHJpZ2dlciA9PT0gb3B0cy5maWVsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNldFN0YXJ0RGF0ZShkYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LmFkZCgnaXMtc3RhcnQtZGF0ZScpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRFbmREYXRlKGRheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5jbGFzc0xpc3QuYWRkKCdpcy1lbmQtZGF0ZScpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRzLnN0YXJ0RGF0ZS5pc0FmdGVyKG9wdHMuZW5kRGF0ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zd2FwRGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRzLmF1dG9jbG9zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZXRTdGFydERhdGUoZGF5KTtcbiAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNldEVuZERhdGUobnVsbCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LmFkZCgnaXMtc3RhcnQtZGF0ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdHMuc2luZ2xlRGF0ZSAmJiBvcHRzLmF1dG9jbG9zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFvcHRzLnNpbmdsZURhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGF0ZXMoc2VsZi5lbCwgb3B0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2UgaWYgKG9wdHMuc3RhcnREYXRlICYmICFvcHRzLmVuZERhdGUpIHtcbiAgICAgICAgICAgICAgICAgIHNlbGYuc2V0RW5kRGF0ZShkYXkpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAob3B0cy5zdGFydERhdGUuaXNBZnRlcihvcHRzLmVuZERhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgc2VsZi5zd2FwRGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LmFkZCgnaXMtZW5kLWRhdGUnKTtcblxuXG4gICAgICAgICAgICAgICAgICBpZiAob3B0cy5hdXRvY2xvc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGF0ZXMoc2VsZi5lbCwgb3B0cyk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoIW9wdHMuZGlzYWJsZWREYXRlc0luUmFuZ2UpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5saWdodHBpY2tfX2RheS5pcy1hdmFpbGFibGUnKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNldFN0YXJ0RGF0ZShudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVEYXRlcyhzZWxmLmVsLCBvcHRzKTtcblxuICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRzLmZvb3Rlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuX29wdHMub25FcnJvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fb3B0cy5vbkVycm9yLmNhbGwoc2VsZiwgJ0ludmFsaWQgcmFuZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmb290ZXJNZXNzYWdlID0gc2VsZi5lbC5xdWVyeVNlbGVjdG9yKCcubGlnaHRwaWNrX19mb290ZXItbWVzc2FnZScpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm9vdGVyTWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3Rlck1lc3NhZ2UuaW5uZXJIVE1MID0gb3B0cy5sb2NhbGUubm90X2FsbG93ZWRfcmFuZ2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3Rlck1lc3NhZ2UuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzAwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbGlnaHRwaWNrX19wcmV2aW91cy1hY3Rpb24nKSkge1xuICAgICAgICAgICAgICBpZiAodGFyZ2V0Lmhhc0F0dHJpYnV0ZSgnZGF0YS12aWV3LW1vZGUnKSkge1xuICAgICAgICAgICAgICAgICAgdmFyIHZpZXdNb2RlID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS12aWV3LW1vZGUnKTtcblxuICAgICAgICAgICAgICAgICAgc3dpdGNoICh2aWV3TW9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RheXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnByZXZNb250aCgpO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW9udGhzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wcmV2WWVhcigpO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2xpZ2h0cGlja19fbmV4dC1hY3Rpb24nKSkge1xuICAgICAgICAgICAgICBpZiAodGFyZ2V0Lmhhc0F0dHJpYnV0ZSgnZGF0YS12aWV3LW1vZGUnKSkge1xuICAgICAgICAgICAgICAgICAgdmFyIHZpZXdNb2RlID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS12aWV3LW1vZGUnKTtcblxuICAgICAgICAgICAgICAgICAgc3dpdGNoICh2aWV3TW9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RheXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm5leHRNb250aCgpO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW9udGhzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5uZXh0WWVhcigpO1xuICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2xpZ2h0cGlja19fY2xvc2UtYWN0aW9uJykgfHwgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbGlnaHRwaWNrX19hcHBseS1hY3Rpb24nKSkge1xuICAgICAgICAgICAgICBzZWxmLmhpZGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbGlnaHRwaWNrX19yZXNldC1hY3Rpb24nKSkge1xuICAgICAgICAgICAgICBzZWxmLnJlc2V0KCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2xpZ2h0cGlja19fbW9udGgtdGl0bGUtYWNjZW50JykpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQucGFyZW50Tm9kZS5oYXNBdHRyaWJ1dGUoJ2RhdGEteW0nKSkge1xuICAgICAgICAgICAgICAgIHZhciBfdG9vbGJhciA9IHNlbGYuZWwucXVlcnlTZWxlY3RvcignLmxpZ2h0cGlja19faW5uZXIgPiAubGlnaHRwaWNrX190b29sYmFyJyk7XG4gICAgICAgICAgICAgICAgaWYgKF90b29sYmFyKSB7XG4gICAgICAgICAgICAgICAgICAgIF90b29sYmFyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2VsZi5lbC5xdWVyeVNlbGVjdG9yKCcubGlnaHRwaWNrX19tb250aHMnKS5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgICAgICByZW5kZXJNb250aHNPZlllYXIoc2VsZi5lbCwgb3B0cywgdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS15bScpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbGlnaHRwaWNrX19tb250aC10aXRsZScpKSB7XG4gICAgICAgICAgICAgIGlmICh0YXJnZXQuaGFzQXR0cmlidXRlKCdkYXRhLXltJykpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBfdG9vbGJhciA9IHNlbGYuZWwucXVlcnlTZWxlY3RvcignLmxpZ2h0cGlja19faW5uZXIgPiAubGlnaHRwaWNrX190b29sYmFyJyk7XG4gICAgICAgICAgICAgICAgICBpZiAoX3Rvb2xiYXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICBfdG9vbGJhci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBzZWxmLmVsLnF1ZXJ5U2VsZWN0b3IoJy5saWdodHBpY2tfX21vbnRocycpLmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgICAgICAgcmVuZGVyTW9udGhzT2ZZZWFyKHNlbGYuZWwsIG9wdHMsIHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEteW0nKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAodGFyZ2V0Lmhhc0F0dHJpYnV0ZSgnZGF0YS1nb3RvLW1vbnRoJykpIHtcbiAgICAgICAgICAgICAgdmFyIG1vbnRoID0gbW9tZW50KHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZ290by1tb250aCcpLCAnWVlZWS1NJyk7XG4gICAgICAgICAgICAgIGlmIChtb250aC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICAgIHNlbGYuZ290b0RhdGUobW9udGgpO1xuXG4gICAgICAgICAgICAgICAgICBzZWxmLmVsLnF1ZXJ5U2VsZWN0b3IoJy5saWdodHBpY2tfX21vbnRocy1vZi10aGUteWVhcicpLmlubmVySFRNTCA9ICcnO1xuXG4gICAgICAgICAgICAgICAgICB2YXIgX3Rvb2xiYXIgPSBzZWxmLmVsLnF1ZXJ5U2VsZWN0b3IoJy5saWdodHBpY2tfX2lubmVyID4gLmxpZ2h0cGlja19fdG9vbGJhcicpO1xuICAgICAgICAgICAgICAgICAgaWYgKF90b29sYmFyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgX3Rvb2xiYXIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgfTtcbiAgICAgIHNlbGYuX29uTW91c2VFbnRlciA9IGZ1bmN0aW9uKGUpXG4gICAgICB7XG4gICAgICAgICAgaWYgKCFzZWxmLmlzU2hvd2luZykge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50O1xuICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XG4gICAgICAgICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBvcHRzID0gc2VsZi5fb3B0cztcblxuICAgICAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdsaWdodHBpY2tfX2RheScpICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2Rpc2FibGVkLXRvb2x0aXAnKSAmJiBvcHRzLmxvY2FsZS50b29sdGlwT25EaXNhYmxlZCkge1xuICAgICAgICAgICAgICBzZWxmLnNob3dUb29sdGlwKHRhcmdldCwgb3B0cy5sb2NhbGUudG9vbHRpcE9uRGlzYWJsZWQpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICBzZWxmLmhpZGVUb29sdGlwKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKG9wdHMuc2luZ2xlRGF0ZSB8fCAoIW9wdHMuc3RhcnREYXRlICYmICFvcHRzLmVuZERhdGUpKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2xpZ2h0cGlja19fZGF5JykgJiYgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLWF2YWlsYWJsZScpKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoKG9wdHMuc3RhcnREYXRlICYmICFvcHRzLmVuZERhdGUpIHx8IG9wdHMucmVwaWNrKSB7XG4gICAgICAgICAgICAgIHZhciBob3ZlckRhdGUgPSBtb21lbnQocGFyc2VJbnQodGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS10aW1lJykpKTtcblxuICAgICAgICAgICAgICBpZiAoIWhvdmVyRGF0ZS5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHZhciBzdGFydERhdGUgPSAob3B0cy5zdGFydERhdGUgJiYgIW9wdHMuZW5kRGF0ZSkgfHwgKG9wdHMucmVwaWNrICYmIG9wdHMucmVwaWNrVHJpZ2dlciA9PT0gb3B0cy5zZWNvbmRGaWVsZCkgPyBvcHRzLnN0YXJ0RGF0ZSA6IG9wdHMuZW5kRGF0ZTtcblxuICAgICAgICAgICAgICB2YXIgZGF5cyA9IHNlbGYuZWwucXVlcnlTZWxlY3RvckFsbCgnLmxpZ2h0cGlja19fZGF5Jyk7XG4gICAgICAgICAgICAgIFtdLmZvckVhY2guY2FsbChkYXlzLCBmdW5jdGlvbihkYXkpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBkdCA9IG1vbWVudChwYXJzZUludChkYXkuZ2V0QXR0cmlidXRlKCdkYXRhLXRpbWUnKSkpO1xuXG4gICAgICAgICAgICAgICAgICBkYXkuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZmxpcHBlZCcpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoZHQuaXNWYWxpZCgpICYmIGR0LmlzU2FtZU9yQWZ0ZXIoc3RhcnREYXRlLCAnZGF5JykgJiYgZHQuaXNTYW1lT3JCZWZvcmUoaG92ZXJEYXRlLCAnZGF5JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICBkYXkuY2xhc3NMaXN0LmFkZCgnaXMtaW4tcmFuZ2UnKTtcblxuICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRzLnJlcGlja1RyaWdnZXIgPT09IG9wdHMuZmllbGQgJiYgZHQuaXNTYW1lT3JBZnRlcihvcHRzLmVuZERhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRheS5jbGFzc0xpc3QuYWRkKCdpcy1mbGlwcGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZHQuaXNWYWxpZCgpICYmIGR0LmlzU2FtZU9yQWZ0ZXIoaG92ZXJEYXRlLCAnZGF5JykgJiYgZHQuaXNTYW1lT3JCZWZvcmUoc3RhcnREYXRlLCAnZGF5JykpIHtcbiAgICAgICAgICAgICAgICAgICAgICBkYXkuY2xhc3NMaXN0LmFkZCgnaXMtaW4tcmFuZ2UnKTtcblxuICAgICAgICAgICAgICAgICAgICAgIGlmICgoKG9wdHMuc3RhcnREYXRlICYmICFvcHRzLmVuZERhdGUpIHx8IG9wdHMucmVwaWNrVHJpZ2dlciA9PT0gb3B0cy5zZWNvbmRGaWVsZCkgJiYgZHQuaXNTYW1lT3JCZWZvcmUob3B0cy5zdGFydERhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRheS5jbGFzc0xpc3QuYWRkKCdpcy1mbGlwcGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgZGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWluLXJhbmdlJyk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIGlmIChvcHRzLnN0YXJ0RGF0ZSAmJiBvcHRzLmVuZERhdGUgJiYgb3B0cy5yZXBpY2sgJiYgb3B0cy5yZXBpY2tUcmlnZ2VyID09PSBvcHRzLmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLXN0YXJ0LWRhdGUnKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIGRheS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1lbmQtZGF0ZScpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBpZiAob3B0cy5ob3ZlcmluZ1Rvb2x0aXApIHtcbiAgICAgICAgICAgICAgICAgIGRheXMgPSBNYXRoLmFicyhob3ZlckRhdGUuaXNBZnRlcihzdGFydERhdGUpID8gaG92ZXJEYXRlLmRpZmYoc3RhcnREYXRlLCAnZGF5JykgOiBzdGFydERhdGUuZGlmZihob3ZlckRhdGUsICdkYXknKSk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghb3B0cy50b29sdGlwTmlnaHRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgZGF5cyArPSAxO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB2YXIgdG9vbHRpcCA9IHNlbGYuZWwucXVlcnlTZWxlY3RvcignLmxpZ2h0cGlja19fdG9vbHRpcCcpO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoZGF5cyA+IDAgJiYgIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLWRpc2FibGVkJykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgIHZhciBwbHVyYWxUZXh0ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRzLmxvY2FsZS5wbHVyYWxpemUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1cmFsVGV4dCA9IG9wdHMubG9jYWxlLnBsdXJhbGl6ZS5jYWxsKHNlbGYsIGRheXMsIG9wdHMubG9jYWxlLnRvb2x0aXApO1xuICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2hvd1Rvb2x0aXAodGFyZ2V0LCBkYXlzICsgJyAnICsgcGx1cmFsVGV4dCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhpZGVUb29sdGlwKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAob3B0cy5zdGFydERhdGUgJiYgb3B0cy5lbmREYXRlICYmIG9wdHMucmVwaWNrICYmIG9wdHMucmVwaWNrVHJpZ2dlciA9PT0gb3B0cy5maWVsZCkge1xuICAgICAgICAgICAgICAgICAgdGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2lzLXN0YXJ0LWRhdGUnKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHRhcmdldC5jbGFzc0xpc3QuYWRkKCdpcy1lbmQtZGF0ZScpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHNlbGYuX29uQ2hhbmdlID0gZnVuY3Rpb24oZSlcbiAgICAgIHtcbiAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG4gICAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcbiAgICAgICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLXNlbGVjdGVkLWxpZ2h0cGljay1tb250aCcpKSB7XG4gICAgICAgICAgICAgIHNlbGYuZ290b01vbnRoKHRhcmdldC52YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLXNlbGVjdGVkLWxpZ2h0cGljay15ZWFyJykpIHtcbiAgICAgICAgICAgICAgc2VsZi5nb3RvWWVhcih0YXJnZXQudmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHNlbGYuX29uSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbihlKVxuICAgICAge1xuICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XG5cbiAgICAgICAgICBpZiAoc2VsZi5fb3B0cy5zaW5nbGVEYXRlKSB7XG4gICAgICAgICAgICAgIGlmICghc2VsZi5fb3B0cy5hdXRvY2xvc2UpIHtcbiAgICAgICAgICAgICAgICAgIHNlbGYuZ290b0RhdGUob3B0cy5maWVsZC52YWx1ZSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBzZWxmLnNldFN0YXJ0RGF0ZShvcHRzLmZpZWxkLnZhbHVlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIXNlbGYuaXNTaG93aW5nKSB7XG4gICAgICAgICAgICAgIHNlbGYuc2hvdygpO1xuICAgICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHNlbGYuX29uSW5wdXRGb2N1cyA9IGZ1bmN0aW9uKGUpXG4gICAgICB7XG4gICAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcblxuICAgICAgICAgIHNlbGYuc2hvdyh0YXJnZXQpO1xuICAgICAgfTtcblxuICAgICAgc2VsZi5fb25JbnB1dENsaWNrID0gZnVuY3Rpb24oZSlcbiAgICAgIHtcbiAgICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50O1xuXG4gICAgICAgICAgc2VsZi5zaG93KHRhcmdldCk7XG4gICAgICB9O1xuXG4gICAgICBzZWxmLl9vbkNsaWNrID0gZnVuY3Rpb24oZSlcbiAgICAgIHtcbiAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG4gICAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudCxcbiAgICAgICAgICAgICAgcGFyZW50RWwgPSB0YXJnZXQ7XG5cbiAgICAgICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICBpZiAoKHBhcmVudEVsLmNsYXNzTGlzdCAmJiBwYXJlbnRFbC5jbGFzc0xpc3QuY29udGFpbnMoJ2xpZ2h0cGljaycpKSB8fCBwYXJlbnRFbCA9PT0gb3B0cy5maWVsZCB8fCAob3B0cy5zZWNvbmRGaWVsZCAmJiBwYXJlbnRFbCA9PT0gb3B0cy5zZWNvbmRGaWVsZCkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB3aGlsZSAoKHBhcmVudEVsID0gcGFyZW50RWwucGFyZW50Tm9kZSkpO1xuXG4gICAgICAgICAgaWYgKHNlbGYuaXNTaG93aW5nICYmIG9wdHMuaGlkZU9uQm9keUNsaWNrICYmIHRhcmdldCAhPT0gb3B0cy5maWVsZCAmJiBwYXJlbnRFbCAhPT0gb3B0cy5maWVsZCkge1xuICAgICAgICAgICAgICBzZWxmLmhpZGUoKTtcbiAgICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBzZWxmLnNob3dUb29sdGlwID0gZnVuY3Rpb24odGFyZ2V0LCB0ZXh0KVxuICAgICAge1xuICAgICAgICAgIHZhciB0b29sdGlwID0gc2VsZi5lbC5xdWVyeVNlbGVjdG9yKCcubGlnaHRwaWNrX190b29sdGlwJyk7XG5cbiAgICAgICAgICB2YXIgaGFzUGFyZW50RWwgPSBzZWxmLmVsLmNsYXNzTGlzdC5jb250YWlucygnbGlnaHRwaWNrLS1pbmxpbmVkJyksXG4gICAgICAgICAgZGF5Qm91bmRpbmcgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgcGlja2VyQm91ZGluZyA9IGhhc1BhcmVudEVsID8gc2VsZi5lbC5wYXJlbnROb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpIDogc2VsZi5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcbiAgICAgICAgICBfbGVmdCA9IChkYXlCb3VuZGluZy5sZWZ0IC0gcGlja2VyQm91ZGluZy5sZWZ0KSArIChkYXlCb3VuZGluZy53aWR0aCAvIDIpLFxuICAgICAgICAgIF90b3AgPSBkYXlCb3VuZGluZy50b3AgLSBwaWNrZXJCb3VkaW5nLnRvcDtcblxuICAgICAgICAgIHRvb2x0aXAuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcbiAgICAgICAgICB0b29sdGlwLnRleHRDb250ZW50ID0gdGV4dDtcblxuICAgICAgICAgIHZhciB0b29sdGlwQm91bmRpbmcgPSB0b29sdGlwLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgICAgX3RvcCAtPSB0b29sdGlwQm91bmRpbmcuaGVpZ2h0O1xuICAgICAgICAgIF9sZWZ0IC09ICh0b29sdGlwQm91bmRpbmcud2lkdGggLyAyKTtcblxuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgdG9vbHRpcC5zdHlsZS50b3AgPSBfdG9wICsgJ3B4JztcbiAgICAgICAgICAgICAgdG9vbHRpcC5zdHlsZS5sZWZ0ID0gX2xlZnQgKyAncHgnO1xuICAgICAgICAgIH0sIDEwKTtcbiAgICAgIH07XG5cbiAgICAgIHNlbGYuaGlkZVRvb2x0aXAgPSBmdW5jdGlvbigpXG4gICAgICB7XG4gICAgICAgICAgdmFyIHRvb2x0aXAgPSBzZWxmLmVsLnF1ZXJ5U2VsZWN0b3IoJy5saWdodHBpY2tfX3Rvb2x0aXAnKTtcbiAgICAgICAgICB0b29sdGlwLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICAgIH07XG5cbiAgICAgIHNlbGYuZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgc2VsZi5fb25Nb3VzZURvd24sIHRydWUpO1xuICAgICAgc2VsZi5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgc2VsZi5fb25Nb3VzZUVudGVyLCB0cnVlKTtcbiAgICAgIC8vc2VsZi5lbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHNlbGYuX29uTW91c2VEb3duLCB0cnVlKTsgLy8gdG91Y2hlbmQgYmVpbmcgb3ZlcndyaXR0ZW4gaW5zaWRlIERhdGVQaWNrLmpzLiBSb2xsYmFjayBpbiBjYXNlIG9mIGlzc3Vlcy5cblxuICAgICAgc2VsZi5oaWRlKCk7XG5cbiAgICAgIG9wdHMuZmllbGQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgc2VsZi5fb25JbnB1dENoYW5nZSk7XG4gICAgICBvcHRzLmZpZWxkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2VsZi5fb25JbnB1dENsaWNrKTtcbiAgICAgIG9wdHMuZmllbGQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCBzZWxmLl9vbklucHV0Rm9jdXMpO1xuXG4gICAgICBpZiAob3B0cy5zZWNvbmRGaWVsZCkge1xuICAgICAgICAgIG9wdHMuc2Vjb25kRmllbGQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgc2VsZi5fb25JbnB1dENoYW5nZSk7XG4gICAgICAgICAgb3B0cy5zZWNvbmRGaWVsZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNlbGYuX29uSW5wdXRDbGljayk7XG4gICAgICAgICAgb3B0cy5zZWNvbmRGaWVsZC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHNlbGYuX29uSW5wdXRGb2N1cyk7XG4gICAgICB9XG4gIH07XG5cbiAgTGlnaHRwaWNrLnByb3RvdHlwZSA9IHtcbiAgICAgIGNvbmZpZzogZnVuY3Rpb24ob3B0aW9ucylcbiAgICAgIHtcbiAgICAgICAgICB2YXIgb3B0cyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRzLCBvcHRpb25zKTtcblxuICAgICAgICAgIG9wdHMuZmllbGQgPSAob3B0cy5maWVsZCAmJiBvcHRzLmZpZWxkLm5vZGVOYW1lKSA/IG9wdHMuZmllbGQgOiBudWxsO1xuXG4gICAgICAgICAgb3B0cy5jYWxlbmRhciA9IFttb21lbnQoKS5zZXQoJ2RhdGUnLCAxKV07XG5cbiAgICAgICAgICBpZiAob3B0cy5udW1iZXJPZk1vbnRocyA9PT0gMSAmJiBvcHRzLm51bWJlck9mQ29sdW1ucyA+IDEpIHtcbiAgICAgICAgICAgICAgb3B0cy5udW1iZXJPZkNvbHVtbnMgPSAxO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIG9wdHMubWluRGF0ZSA9IG9wdHMubWluRGF0ZSAmJiBtb21lbnQob3B0cy5taW5EYXRlKS5pc1ZhbGlkKCkgPyBtb21lbnQob3B0cy5taW5EYXRlKSA6IG51bGw7XG5cbiAgICAgICAgICBvcHRzLm1heERhdGUgPSBvcHRzLm1heERhdGUgJiYgbW9tZW50KG9wdHMubWF4RGF0ZSkuaXNWYWxpZCgpID8gbW9tZW50KG9wdHMubWF4RGF0ZSkgOiBudWxsO1xuXG4gICAgICAgICAgaWYgKG9wdHMubGFuZyA9PT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICAgIHZhciBicm93c2VyTGFuZyA9IG5hdmlnYXRvci5sYW5ndWFnZSB8fCBuYXZpZ2F0b3IudXNlckxhbmd1YWdlO1xuICAgICAgICAgICAgICBpZiAoYnJvd3NlckxhbmcpIHtcbiAgICAgICAgICAgICAgICAgIG9wdHMubGFuZyA9IGJyb3dzZXJMYW5nO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgb3B0cy5sYW5nID0gJ2VuLVVTJztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChvcHRzLnNlY29uZEZpZWxkICYmIG9wdHMuc2luZ2xlRGF0ZSkge1xuICAgICAgICAgICAgICBvcHRzLnNpbmdsZURhdGUgPSBmYWxzZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAob3B0cy5ob3ZlcmluZ1Rvb2x0aXAgJiYgb3B0cy5zaW5nbGVEYXRlKSB7XG4gICAgICAgICAgICAgIG9wdHMuaG92ZXJpbmdUb29sdGlwID0gZmFsc2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvcHRpb25zLmxvY2FsZSkgPT09ICdbb2JqZWN0IE9iamVjdF0nKSB7XG4gICAgICAgICAgICAgIG9wdHMubG9jYWxlID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdHMubG9jYWxlLCBvcHRpb25zLmxvY2FsZSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHdpbmRvdy5pbm5lcldpZHRoIDwgNDgwICYmIG9wdHMubnVtYmVyT2ZNb250aHMgPiAxKSB7XG4gICAgICAgICAgICAgIG9wdHMubnVtYmVyT2ZNb250aHMgPSAxO1xuICAgICAgICAgICAgICBvcHRzLm51bWJlck9mQ29sdW1ucyA9IDE7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKG9wdHMucmVwaWNrICYmICFvcHRzLnNlY29uZEZpZWxkKSB7XG4gICAgICAgICAgICAgIG9wdHMucmVwaWNrID0gZmFsc2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5fb3B0cyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdHMpO1xuXG4gICAgICAgICAgaWYgKHRoaXMuZ2V0U3RhcnREYXRlKCkgPT09IG51bGwgJiYgbW9tZW50KHRoaXMuX29wdHMuZmllbGQudmFsdWUsIHRoaXMuX29wdHMuZm9ybWF0KS5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgdGhpcy5fb3B0cy5zdGFydERhdGUgPSBtb21lbnQodGhpcy5fb3B0cy5maWVsZC52YWx1ZSwgdGhpcy5fb3B0cy5mb3JtYXQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLmdldEVuZERhdGUoKSA9PT0gbnVsbCAmJiB0aGlzLl9vcHRzLnNlY29uZEZpZWxkICYmIG1vbWVudCh0aGlzLl9vcHRzLnNlY29uZEZpZWxkLnZhbHVlLCB0aGlzLl9vcHRzLmZvcm1hdCkuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICAgIHRoaXMuX29wdHMuZW5kRGF0ZSA9IG1vbWVudCh0aGlzLl9vcHRzLnNlY29uZEZpZWxkLnZhbHVlLCB0aGlzLl9vcHRzLmZvcm1hdCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUodGhpcy5fb3B0cy5zdGFydERhdGUsIHRydWUpO1xuICAgICAgICAgIHRoaXMuc2V0RW5kRGF0ZSh0aGlzLl9vcHRzLmVuZERhdGUsIHRydWUpO1xuXG4gICAgICAgICAgcmV0dXJuIHRoaXMuX29wdHM7XG4gICAgICB9LFxuXG4gICAgICBzd2FwRGF0ZTogZnVuY3Rpb24oKVxuICAgICAge1xuICAgICAgICAgIHZhciB0bXAgPSBtb21lbnQodGhpcy5fb3B0cy5zdGFydERhdGUpO1xuICAgICAgICAgIHRoaXMuc2V0RGF0ZVJhbmdlKHRoaXMuX29wdHMuZW5kRGF0ZSwgdG1wKTtcbiAgICAgIH0sXG5cbiAgICAgIGdvdG9Ub2RheTogZnVuY3Rpb24oKVxuICAgICAge1xuICAgICAgICAgIHRoaXMuZ290b0RhdGUobmV3IERhdGUoKSk7XG4gICAgICB9LFxuXG4gICAgICBnb3RvRGF0ZTogZnVuY3Rpb24oZGF0ZSlcbiAgICAgIHtcbiAgICAgICAgICB2YXIgZGF0ZSA9IG1vbWVudChkYXRlKTtcblxuICAgICAgICAgIGlmICghZGF0ZS5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgZGF0ZSA9IG1vbWVudCgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGRhdGUuc2V0KCdkYXRlJywgMSk7XG5cbiAgICAgICAgICB0aGlzLl9vcHRzLmNhbGVuZGFyID0gW21vbWVudChkYXRlKV07XG5cbiAgICAgICAgICByZW5kZXJDYWxlbmRhcih0aGlzLmVsLCB0aGlzLl9vcHRzKTtcbiAgICAgIH0sXG5cbiAgICAgIGdvdG9Nb250aDogZnVuY3Rpb24obW9udGgpXG4gICAgICB7XG4gICAgICAgICAgaWYgKGlzTmFOKG1vbnRoKSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5fb3B0cy5jYWxlbmRhclswXS5zZXQoJ21vbnRoJywgbW9udGgpO1xuXG4gICAgICAgICAgcmVuZGVyQ2FsZW5kYXIodGhpcy5lbCwgdGhpcy5fb3B0cyk7XG4gICAgICB9LFxuXG4gICAgICBwcmV2TW9udGg6IGZ1bmN0aW9uKClcbiAgICAgIHtcbiAgICAgICAgICB0aGlzLl9vcHRzLmNhbGVuZGFyWzBdID0gbW9tZW50KHRoaXMuX29wdHMuY2FsZW5kYXJbMF0pLnN1YnRyYWN0KHRoaXMuX29wdHMubnVtYmVyT2ZNb250aHMsICdtb250aCcpO1xuXG4gICAgICAgICAgcmVuZGVyQ2FsZW5kYXIodGhpcy5lbCwgdGhpcy5fb3B0cyk7XG5cbiAgICAgICAgICBjaGVja0Rpc2FibGVkRGF0ZXNJblJhbmdlKHRoaXMuZWwsIHRoaXMuX29wdHMpO1xuICAgICAgfSxcblxuICAgICAgbmV4dE1vbnRoOiBmdW5jdGlvbigpXG4gICAgICB7XG4gICAgICAgICAgdGhpcy5fb3B0cy5jYWxlbmRhclswXSA9IG1vbWVudCh0aGlzLl9vcHRzLmNhbGVuZGFyWzFdKTtcblxuICAgICAgICAgIHJlbmRlckNhbGVuZGFyKHRoaXMuZWwsIHRoaXMuX29wdHMpO1xuXG4gICAgICAgICAgY2hlY2tEaXNhYmxlZERhdGVzSW5SYW5nZSh0aGlzLmVsLCB0aGlzLl9vcHRzKTtcbiAgICAgIH0sXG5cbiAgICAgIHByZXZZZWFyOiBmdW5jdGlvbigpXG4gICAgICB7XG4gICAgICAgICAgdGhpcy5fb3B0cy5jYWxlbmRhclswXSA9IG1vbWVudCh0aGlzLl9vcHRzLmNhbGVuZGFyWzBdKS5zdWJ0cmFjdCgxLCAneWVhcicpO1xuXG4gICAgICAgICAgcmVuZGVyTW9udGhzT2ZZZWFyKHRoaXMuZWwsIHRoaXMuX29wdHMpO1xuICAgICAgfSxcblxuICAgICAgbmV4dFllYXI6IGZ1bmN0aW9uKClcbiAgICAgIHtcbiAgICAgICAgICB0aGlzLl9vcHRzLmNhbGVuZGFyWzBdID0gbW9tZW50KHRoaXMuX29wdHMuY2FsZW5kYXJbMF0pLmFkZCgxLCAneWVhcicpO1xuXG4gICAgICAgICAgcmVuZGVyTW9udGhzT2ZZZWFyKHRoaXMuZWwsIHRoaXMuX29wdHMpO1xuICAgICAgfSxcblxuICAgICAgdXBkYXRlUG9zaXRpb246IGZ1bmN0aW9uKClcbiAgICAgIHtcbiAgICAgICAgICBpZiAodGhpcy5lbC5jbGFzc0xpc3QuY29udGFpbnMoJ2xpZ2h0cGljay0taW5saW5lZCcpKSByZXR1cm47XG5cbiAgICAgICAgICAvLyByZW1vdmUgYGlzLWhpZGRlbmAgY2xhc3MgZm9yIGdldEJvdW5kaW5nQ2xpZW50UmVjdFxuICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtaGlkZGVuJyk7XG5cbiAgICAgICAgICB2YXIgcmVjdCA9IHRoaXMuX29wdHMuZmllbGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG4gICAgICAgICAgICAgIGNhbFJlY3QgPSB0aGlzLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgICBvcmllbnRhdGlvbiA9IHRoaXMuX29wdHMub3JpZW50YXRpb24uc3BsaXQoJyAnKSxcbiAgICAgICAgICAgICAgdG9wID0gMCxcbiAgICAgICAgICAgICAgbGVmdCA9IDA7XG5cbiAgICAgICAgICBpZiAob3JpZW50YXRpb25bMF0gPT0gJ2F1dG8nIHx8ICEoL3RvcHxib3R0b20vLnRlc3Qob3JpZW50YXRpb25bMF0pKSkge1xuICAgICAgICAgICAgICBpZiAocmVjdC5ib3R0b20gKyBjYWxSZWN0LmhlaWdodCA+IHdpbmRvdy5pbm5lckhlaWdodCAmJiB3aW5kb3cucGFnZVlPZmZzZXQgPiBjYWxSZWN0LmhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgdG9wID0gKHJlY3QudG9wICsgd2luZG93LnBhZ2VZT2Zmc2V0KSAtIGNhbFJlY3QuaGVpZ2h0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgdG9wID0gcmVjdC5ib3R0b20gKyB3aW5kb3cucGFnZVlPZmZzZXQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIHRvcCA9IHJlY3Rbb3JpZW50YXRpb25bMF1dICsgd2luZG93LnBhZ2VZT2Zmc2V0O1xuXG4gICAgICAgICAgICAgIGlmIChvcmllbnRhdGlvblswXSA9PSAndG9wJykge1xuICAgICAgICAgICAgICAgICAgdG9wIC09IGNhbFJlY3QuaGVpZ2h0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCEoL2xlZnR8cmlnaHQvLnRlc3Qob3JpZW50YXRpb25bMF0pKSAmJiAoIW9yaWVudGF0aW9uWzFdIHx8IG9yaWVudGF0aW9uWzFdID09ICdhdXRvJyB8fCAhKC9sZWZ0fHJpZ2h0Ly50ZXN0KG9yaWVudGF0aW9uWzFdKSkpKSB7XG4gICAgICAgICAgICAgIGlmIChyZWN0LmxlZnQgKyBjYWxSZWN0LndpZHRoID4gd2luZG93LmlubmVyV2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgIGxlZnQgPSAocmVjdC5yaWdodCArIHdpbmRvdy5wYWdlWE9mZnNldCkgLSBjYWxSZWN0LndpZHRoO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgbGVmdCA9IHJlY3QubGVmdCArIHdpbmRvdy5wYWdlWE9mZnNldDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgaWYgKC9sZWZ0fHJpZ2h0Ly50ZXN0KG9yaWVudGF0aW9uWzBdKSkge1xuICAgICAgICAgICAgICAgICAgbGVmdCA9IHJlY3Rbb3JpZW50YXRpb25bMF1dICsgd2luZG93LnBhZ2VYT2Zmc2V0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgbGVmdCA9IHJlY3Rbb3JpZW50YXRpb25bMV1dICsgd2luZG93LnBhZ2VYT2Zmc2V0O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKG9yaWVudGF0aW9uWzBdID09ICdyaWdodCcgfHwgb3JpZW50YXRpb25bMV0gPT0gJ3JpZ2h0Jykge1xuICAgICAgICAgICAgICAgICAgbGVmdCAtPSBjYWxSZWN0LndpZHRoO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdpcy1oaWRkZW4nKTtcblxuICAgICAgICAgIHRoaXMuZWwuc3R5bGUudG9wID0gdG9wICsgJ3B4JztcbiAgICAgICAgICB0aGlzLmVsLnN0eWxlLmxlZnQgPSBsZWZ0ICsgJ3B4JztcbiAgICAgIH0sXG5cbiAgICAgIHNldFN0YXJ0RGF0ZTogZnVuY3Rpb24oZGF0ZSwgcHJldmVudE9uU2VsZWN0KVxuICAgICAge1xuICAgICAgICAgIHZhciBkYXRlSVNPID0gbW9tZW50KGRhdGUsIG1vbWVudC5JU09fODYwMSksXG4gICAgICAgICAgICAgIGRhdGVPcHRGb3JtYXQgPSBtb21lbnQoZGF0ZSwgdGhpcy5fb3B0cy5mb3JtYXQpO1xuXG4gICAgICAgICAgaWYgKCFkYXRlSVNPLmlzVmFsaWQoKSAmJiAhZGF0ZU9wdEZvcm1hdC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgdGhpcy5fb3B0cy5zdGFydERhdGUgPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLl9vcHRzLmZpZWxkLnZhbHVlID0gJyc7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLl9vcHRzLnN0YXJ0RGF0ZSA9IG1vbWVudChkYXRlSVNPLmlzVmFsaWQoKSA/IGRhdGVJU08gOiBkYXRlT3B0Rm9ybWF0KTtcblxuICAgICAgICAgIGlmICh0aGlzLl9vcHRzLnNpbmdsZURhdGUgfHwgdGhpcy5fb3B0cy5zZWNvbmRGaWVsZCkge1xuICAgICAgICAgICAgICB0aGlzLl9vcHRzLmZpZWxkLnZhbHVlID0gdGhpcy5fb3B0cy5zdGFydERhdGUuZm9ybWF0KHRoaXMuX29wdHMuZm9ybWF0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuX29wdHMuZmllbGQudmFsdWUgPSB0aGlzLl9vcHRzLnN0YXJ0RGF0ZS5mb3JtYXQodGhpcy5fb3B0cy5mb3JtYXQpICsgdGhpcy5fb3B0cy5zZXBhcmF0b3IgKyAnLi4uJ1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghcHJldmVudE9uU2VsZWN0ICYmIHR5cGVvZiB0aGlzLl9vcHRzLm9uU2VsZWN0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgIHRoaXMuX29wdHMub25TZWxlY3QuY2FsbCh0aGlzLCB0aGlzLmdldFN0YXJ0RGF0ZSgpLCB0aGlzLmdldEVuZERhdGUoKSk7XG4gICAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgc2V0RW5kRGF0ZTogZnVuY3Rpb24oZGF0ZSwgcHJldmVudE9uU2VsZWN0KVxuICAgICAge1xuICAgICAgICAgIHZhciBkYXRlSVNPID0gbW9tZW50KGRhdGUsIG1vbWVudC5JU09fODYwMSksXG4gICAgICAgICAgICAgIGRhdGVPcHRGb3JtYXQgPSBtb21lbnQoZGF0ZSwgdGhpcy5fb3B0cy5mb3JtYXQpO1xuXG4gICAgICAgICAgaWYgKCFkYXRlSVNPLmlzVmFsaWQoKSAmJiAhZGF0ZU9wdEZvcm1hdC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgdGhpcy5fb3B0cy5lbmREYXRlID0gbnVsbDtcblxuICAgICAgICAgICAgICBpZiAodGhpcy5fb3B0cy5zZWNvbmRGaWVsZCkge1xuICAgICAgICAgICAgICAgICAgdGhpcy5fb3B0cy5zZWNvbmRGaWVsZC52YWx1ZSA9ICcnO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2UgaWYgKCF0aGlzLl9vcHRzLnNpbmdsZURhdGUgJiYgdGhpcy5fb3B0cy5zdGFydERhdGUpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuX29wdHMuZmllbGQudmFsdWUgPSB0aGlzLl9vcHRzLnN0YXJ0RGF0ZS5mb3JtYXQodGhpcy5fb3B0cy5mb3JtYXQpICsgdGhpcy5fb3B0cy5zZXBhcmF0b3IgKyAnLi4uJ1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLl9vcHRzLmVuZERhdGUgPSBtb21lbnQoZGF0ZUlTTy5pc1ZhbGlkKCkgPyBkYXRlSVNPIDogZGF0ZU9wdEZvcm1hdCk7XG5cbiAgICAgICAgICBpZiAodGhpcy5fb3B0cy5zZWNvbmRGaWVsZCkge1xuICAgICAgICAgICAgICB0aGlzLl9vcHRzLmZpZWxkLnZhbHVlID0gdGhpcy5fb3B0cy5zdGFydERhdGUuZm9ybWF0KHRoaXMuX29wdHMuZm9ybWF0KTtcbiAgICAgICAgICAgICAgdGhpcy5fb3B0cy5zZWNvbmRGaWVsZC52YWx1ZSA9IHRoaXMuX29wdHMuZW5kRGF0ZS5mb3JtYXQodGhpcy5fb3B0cy5mb3JtYXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5fb3B0cy5maWVsZC52YWx1ZSA9IHRoaXMuX29wdHMuc3RhcnREYXRlLmZvcm1hdCh0aGlzLl9vcHRzLmZvcm1hdCkgKyB0aGlzLl9vcHRzLnNlcGFyYXRvciArIHRoaXMuX29wdHMuZW5kRGF0ZS5mb3JtYXQodGhpcy5fb3B0cy5mb3JtYXQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghcHJldmVudE9uU2VsZWN0ICYmIHR5cGVvZiB0aGlzLl9vcHRzLm9uU2VsZWN0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgIHRoaXMuX29wdHMub25TZWxlY3QuY2FsbCh0aGlzLCB0aGlzLmdldFN0YXJ0RGF0ZSgpLCB0aGlzLmdldEVuZERhdGUoKSk7XG4gICAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgc2V0RGF0ZTogZnVuY3Rpb24oZGF0ZSlcbiAgICAgIHtcbiAgICAgICAgICBpZiAoIXRoaXMuX29wdHMuc2luZ2xlRGF0ZSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuc2V0U3RhcnREYXRlKGRhdGUsIHRydWUpO1xuICAgICAgfSxcblxuICAgICAgc2V0RGF0ZVJhbmdlOiBmdW5jdGlvbihzdGFydCwgZW5kLCBwcmV2ZW50T25TZWxlY3QpXG4gICAgICB7XG4gICAgICAgICAgaWYgKHRoaXMuX29wdHMuc2luZ2xlRGF0ZSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuc2V0U3RhcnREYXRlKHN0YXJ0LCB0cnVlKTtcbiAgICAgICAgICB0aGlzLnNldEVuZERhdGUoZW5kLCB0cnVlKTtcblxuICAgICAgICAgIGlmICh0aGlzLmlzU2hvd2luZykge1xuICAgICAgICAgICAgICB1cGRhdGVEYXRlcyh0aGlzLmVsLCB0aGlzLl9vcHRzKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIXByZXZlbnRPblNlbGVjdCAmJiB0eXBlb2YgdGhpcy5fb3B0cy5vblNlbGVjdCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICB0aGlzLl9vcHRzLm9uU2VsZWN0LmNhbGwodGhpcywgdGhpcy5nZXRTdGFydERhdGUoKSwgdGhpcy5nZXRFbmREYXRlKCkpO1xuICAgICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIHNldERpc2FibGVEYXRlczogZnVuY3Rpb24oZGF0ZXMpXG4gICAgICB7XG4gICAgICAgICAgdGhpcy5fb3B0cy5kaXNhYmxlRGF0ZXMgPSBkYXRlcztcblxuICAgICAgICAgIGlmICh0aGlzLmlzU2hvd2luZykge1xuICAgICAgICAgICAgICB1cGRhdGVEYXRlcyh0aGlzLmVsLCB0aGlzLl9vcHRzKTtcbiAgICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICBnZXRTdGFydERhdGU6IGZ1bmN0aW9uKClcbiAgICAgIHtcbiAgICAgICAgICByZXR1cm4gbW9tZW50KHRoaXMuX29wdHMuc3RhcnREYXRlKS5pc1ZhbGlkKCkgPyB0aGlzLl9vcHRzLnN0YXJ0RGF0ZSA6IG51bGw7XG4gICAgICB9LFxuXG4gICAgICBnZXRFbmREYXRlOiBmdW5jdGlvbigpXG4gICAgICB7XG4gICAgICAgICAgcmV0dXJuIG1vbWVudCh0aGlzLl9vcHRzLmVuZERhdGUpLmlzVmFsaWQoKSA/IHRoaXMuX29wdHMuZW5kRGF0ZSA6IG51bGw7XG4gICAgICB9LFxuXG4gICAgICBnZXREYXRlOiBmdW5jdGlvbigpXG4gICAgICB7XG4gICAgICAgICAgcmV0dXJuIG1vbWVudCh0aGlzLl9vcHRzLnN0YXJ0RGF0ZSkuaXNWYWxpZCgpID8gdGhpcy5fb3B0cy5zdGFydERhdGUgOiBudWxsO1xuICAgICAgfSxcblxuICAgICAgdG9TdHJpbmc6IGZ1bmN0aW9uKGZvcm1hdClcbiAgICAgIHtcbiAgICAgICAgICBpZiAodGhpcy5fb3B0cy5zaW5nbGVEYXRlKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtb21lbnQodGhpcy5fb3B0cy5zdGFydERhdGUpLmlzVmFsaWQoKSA/IHRoaXMuX29wdHMuc3RhcnREYXRlLmZvcm1hdChmb3JtYXQpIDogJyc7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKG1vbWVudCh0aGlzLl9vcHRzLnN0YXJ0RGF0ZSkuaXNWYWxpZCgpICYmIG1vbWVudCh0aGlzLl9vcHRzLmVuZERhdGUpLmlzVmFsaWQoKSkge1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fb3B0cy5zdGFydERhdGUuZm9ybWF0KGZvcm1hdCkgKyB0aGlzLl9vcHRzLnNlcGFyYXRvciArIHRoaXMuX29wdHMuZW5kRGF0ZS5mb3JtYXQoZm9ybWF0KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAobW9tZW50KHRoaXMuX29wdHMuc3RhcnREYXRlKS5pc1ZhbGlkKCkgJiYgIW1vbWVudCh0aGlzLl9vcHRzLmVuZERhdGUpLmlzVmFsaWQoKSkge1xuICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fb3B0cy5zdGFydERhdGUuZm9ybWF0KGZvcm1hdCkgKyB0aGlzLl9vcHRzLnNlcGFyYXRvciArICcuLi4nO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghbW9tZW50KHRoaXMuX29wdHMuc3RhcnREYXRlKS5pc1ZhbGlkKCkgJiYgbW9tZW50KHRoaXMuX29wdHMuZW5kRGF0ZSkuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICAgIHJldHVybiAnLi4uJyArIHRoaXMuX29wdHMuc2VwYXJhdG9yICsgdGhpcy5fb3B0cy5lbmREYXRlLmZvcm1hdChmb3JtYXQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiAnJztcbiAgICAgIH0sXG5cbiAgICAgIHNob3c6IGZ1bmN0aW9uKHRhcmdldClcbiAgICAgIHtcbiAgICAgICAgICBpZiAoIXRoaXMuaXNTaG93aW5nKSB7XG4gICAgICAgICAgICAgIHRoaXMuaXNTaG93aW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgICBpZiAodGhpcy5fb3B0cy5yZXBpY2spIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuX29wdHMucmVwaWNrVHJpZ2dlciA9IHRhcmdldDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGlmICh0aGlzLl9vcHRzLnNlY29uZEZpZWxkICYmIHRoaXMuX29wdHMuc2Vjb25kRmllbGQgPT09IHRhcmdldCAmJiB0aGlzLl9vcHRzLmVuZERhdGUpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuZ290b0RhdGUodGhpcy5fb3B0cy5lbmREYXRlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuZ290b0RhdGUodGhpcy5fb3B0cy5zdGFydERhdGUpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkNsaWNrKTtcblxuICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVBvc2l0aW9uKCk7XG5cbiAgICAgICAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1oaWRkZW4nKTtcblxuICAgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuX29wdHMub25PcGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLl9vcHRzLm9uT3Blbi5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcubGlnaHRwaWNrX19tb250aHMtb2YtdGhlLXllYXInKS5pbm5lckhUTUwgPSAnJztcblxuICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICE9IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgaGlkZTogZnVuY3Rpb24oKVxuICAgICAge1xuICAgICAgICAgIGlmICh0aGlzLmlzU2hvd2luZykge1xuICAgICAgICAgICAgICB0aGlzLmlzU2hvd2luZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25DbGljayk7XG5cbiAgICAgICAgICAgICAgdGhpcy5lbC5jbGFzc0xpc3QuYWRkKCdpcy1oaWRkZW4nKTtcblxuICAgICAgICAgICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5saWdodHBpY2tfX3Rvb2x0aXAnKS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG5cbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLl9vcHRzLm9uQ2xvc2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuX29wdHMub25DbG9zZS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgZGVzdHJveTogZnVuY3Rpb24oKVxuICAgICAge1xuICAgICAgICAgIHZhciBvcHRzID0gdGhpcy5fb3B0cztcblxuICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5fb25Nb3VzZURvd24sIHRydWUpO1xuICAgICAgICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLl9vbk1vdXNlRG93biwgdHJ1ZSk7XG4gICAgICAgICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLl9vbkNoYW5nZSwgdHJ1ZSk7XG5cbiAgICAgICAgICBvcHRzLmZpZWxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuX29uSW5wdXRDaGFuZ2UpO1xuICAgICAgICAgIG9wdHMuZmllbGQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbklucHV0Q2xpY2spO1xuICAgICAgICAgIG9wdHMuZmllbGQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzLl9vbklucHV0Rm9jdXMpO1xuXG4gICAgICAgICAgaWYgKG9wdHMuc2Vjb25kRmllbGQpIHtcbiAgICAgICAgICAgICAgb3B0cy5zZWNvbmRGaWVsZC5yZW1vdmVFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLl9vbklucHV0Q2hhbmdlKTtcbiAgICAgICAgICAgICAgb3B0cy5zZWNvbmRGaWVsZC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uSW5wdXRDbGljayk7XG4gICAgICAgICAgICAgIG9wdHMuc2Vjb25kRmllbGQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzLl9vbklucHV0Rm9jdXMpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLmVsLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgdGhpcy5lbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWwpO1xuICAgICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIHJlc2V0OiBmdW5jdGlvbigpXG4gICAgICB7XG4gICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUobnVsbCwgdHJ1ZSk7XG4gICAgICAgICAgdGhpcy5zZXRFbmREYXRlKG51bGwsIHRydWUpO1xuXG4gICAgICAgICAgdXBkYXRlRGF0ZXModGhpcy5lbCwgdGhpcy5fb3B0cyk7XG5cbiAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuX29wdHMub25TZWxlY3QgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgdGhpcy5fb3B0cy5vblNlbGVjdC5jYWxsKHRoaXMsIHRoaXMuZ2V0U3RhcnREYXRlKCksIHRoaXMuZ2V0RW5kRGF0ZSgpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5saWdodHBpY2tfX3Rvb2x0aXAnKS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgICB9LFxuXG4gICAgICByZWxvYWRPcHRpb25zOiBmdW5jdGlvbihvcHRpb25zKVxuICAgICAge1xuICAgICAgICAgIHRoaXMuX29wdHMgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLl9vcHRzLCBvcHRpb25zKTtcbiAgICAgIH1cblxuICB9O1xuXG4gIHJldHVybiBMaWdodHBpY2s7XG59KSk7XG4iLCIvKipcbiAqIE9iamVjdC1maXQgSW1hZ2VzIGZvciBJRTExXG4gKiBAbGluayBodHRwczovL2dpdGh1Yi5jb20vcmVuYW5zYW4vb2JqZWN0LWZpdC1pbWFnZXNcbiAqIEBsaW5rIG5wbS5pbS9vYmplY3QtZml0LWltYWdlcyAzLjIuNFxuICpcbiAqIFRoZSBwcm9qZWN0J3MgYXJjaGl2ZWQgYnkgdGhlIG93bmVyLCBzbyB3ZSBtYWRlIGNoYW5nZXMgZGlyZWN0bHkgaW4gdGhpcyBmaWxlLiBNb3JlIGluZm86XG4gKiBAbGluayBodHRwczovL2dpdGh1Yi5jb20vYmZyZWQtaXQvb2JqZWN0LWZpdC1pbWFnZXMvaXNzdWVzLzEwNCNpc3N1ZWNvbW1lbnQtNDM3NTcyNDYzXG4gKi9cbiB2YXIgb2JqZWN0Rml0SW1hZ2VzPWZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdCh0LGUpe3JldHVyblwiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSdcIit0K1wiJyBoZWlnaHQ9J1wiK2UrXCInJTNFJTNDL3N2ZyUzRVwifWZ1bmN0aW9uIGUodCl7aWYodC5zcmNzZXQmJiFtJiZ3aW5kb3cucGljdHVyZWZpbGwpe3ZhciBlPXdpbmRvdy5waWN0dXJlZmlsbC5fO3RbZS5uc10mJnRbZS5uc10uZXZhbGVkfHxlLmZpbGxJbWcodCx7cmVzZWxlY3Q6ITB9KSx0W2UubnNdLmN1clNyY3x8KHRbZS5uc10uc3VwcG9ydGVkPSExLGUuZmlsbEltZyh0LHtyZXNlbGVjdDohMH0pKSx0LmN1cnJlbnRTcmM9dFtlLm5zXS5jdXJTcmN8fHQuc3JjfX1mdW5jdGlvbiByKHQpe2Zvcih2YXIgZSxyPWdldENvbXB1dGVkU3R5bGUodCkuZm9udEZhbWlseSxpPXt9O251bGwhPT0oZT11LmV4ZWMocikpOylpW2VbMV1dPWVbMl07cmV0dXJuIGl9ZnVuY3Rpb24gaShlLHIsaSl7dmFyIG49dChyfHwxLGl8fDApO3AuY2FsbChlLFwic3JjXCIpIT09biYmYi5jYWxsKGUsXCJzcmNcIixuKX1mdW5jdGlvbiBuKHQsZSl7dC5uYXR1cmFsV2lkdGg/ZSh0KTpzZXRUaW1lb3V0KG4sMTAwLHQsZSl9ZnVuY3Rpb24gYyh0KXt2YXIgYz1yKHQpLG89dFthXTtpZih0Lm5hdHVyYWxXaWR0aCl7aWYoY1tcIm9iamVjdC1maXRcIl09Y1tcIm9iamVjdC1maXRcIl18fFwiZmlsbFwiLCFvLmltZyl7aWYoXCJmaWxsXCI9PT1jW1wib2JqZWN0LWZpdFwiXSlyZXR1cm47aWYoIW8uc2tpcFRlc3QmJmcmJiFjW1wib2JqZWN0LXBvc2l0aW9uXCJdKXJldHVybn1pZighby5pbWcpe28uaW1nPW5ldyBJbWFnZSh0LndpZHRoLHQuaGVpZ2h0KSxvLmltZy5zcmNzZXQ9cC5jYWxsKHQsXCJkYXRhLW9maS1zcmNzZXRcIil8fHQuc3Jjc2V0O3ZhciB1PXAuY2FsbCh0LFwiZGF0YS1vZmktc3JjXCIpfHx0LnNyYzt1JiYoby5pbWcuc3JjPXUpLGIuY2FsbCh0LFwiZGF0YS1vZmktc3JjXCIsdC5zcmMpLHQuc3Jjc2V0JiZiLmNhbGwodCxcImRhdGEtb2ZpLXNyY3NldFwiLHQuc3Jjc2V0KSxpKHQsdC5uYXR1cmFsV2lkdGh8fHQud2lkdGgsdC5uYXR1cmFsSGVpZ2h0fHx0LmhlaWdodCksdC5zcmNzZXQmJih0LnNyY3NldD1cIlwiKTt0cnl7cyh0KX1jYXRjaCh0KXt3aW5kb3cuY29uc29sZSYmY29uc29sZS53YXJuKFwiaHR0cHM6Ly9iaXQubHkvb2ZpLW9sZC1icm93c2VyXCIpfX1lKG8uaW1nKTsoby5pbWcuY3VycmVudFNyY3x8by5pbWcuc3JjKSYmKHQuc3R5bGUuYmFja2dyb3VuZEltYWdlPSd1cmwoXCInKyhvLmltZy5jdXJyZW50U3JjfHxvLmltZy5zcmMpLnJlcGxhY2UoL1wiL2csJ1xcXFxcIicpKydcIiknKSx0LnN0eWxlLmJhY2tncm91bmRJbWFnZT0ndXJsKFwiJysoby5pbWcuY3VycmVudFNyY3x8by5pbWcuc3JjKS5yZXBsYWNlKC9cIi9nLCdcXFxcXCInKSsnXCIpJyx0LnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbj1jW1wib2JqZWN0LXBvc2l0aW9uXCJdfHxcImNlbnRlclwiLHQuc3R5bGUuYmFja2dyb3VuZFJlcGVhdD1cIm5vLXJlcGVhdFwiLHQuc3R5bGUuYmFja2dyb3VuZE9yaWdpbj1cImNvbnRlbnQtYm94XCIsL3NjYWxlLWRvd24vLnRlc3QoY1tcIm9iamVjdC1maXRcIl0pP24oby5pbWcsZnVuY3Rpb24oKXtvLmltZy5uYXR1cmFsV2lkdGg+dC53aWR0aHx8by5pbWcubmF0dXJhbEhlaWdodD50LmhlaWdodD90LnN0eWxlLmJhY2tncm91bmRTaXplPVwiY29udGFpblwiOnQuc3R5bGUuYmFja2dyb3VuZFNpemU9XCJhdXRvXCJ9KTp0LnN0eWxlLmJhY2tncm91bmRTaXplPWNbXCJvYmplY3QtZml0XCJdLnJlcGxhY2UoXCJub25lXCIsXCJhdXRvXCIpLnJlcGxhY2UoXCJmaWxsXCIsXCIxMDAlIDEwMCVcIiksbihvLmltZyxmdW5jdGlvbihlKXtpKHQsZS5uYXR1cmFsV2lkdGgsZS5uYXR1cmFsSGVpZ2h0KX0pfX1mdW5jdGlvbiBzKHQpe3ZhciBlPXtnZXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIHRbYV0uaW1nW2V8fFwic3JjXCJdfSxzZXQ6ZnVuY3Rpb24oZSxyKXtyZXR1cm4gdFthXS5pbWdbcnx8XCJzcmNcIl09ZSxiLmNhbGwodCxcImRhdGEtb2ZpLVwiK3IsZSksYyh0KSxlfX07T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJzcmNcIixlKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcImN1cnJlbnRTcmNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGUuZ2V0KFwiY3VycmVudFNyY1wiKX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcInNyY3NldFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZS5nZXQoXCJzcmNzZXRcIil9LHNldDpmdW5jdGlvbih0KXtyZXR1cm4gZS5zZXQodCxcInNyY3NldFwiKX19KX1mdW5jdGlvbiBvKHQsZSl7dmFyIHI9IWgmJiF0O2lmKGU9ZXx8e30sdD10fHxcImltZ1wiLGYmJiFlLnNraXBUZXN0fHwhZClyZXR1cm4hMTtcImltZ1wiPT09dD90PWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW1nXCIpOlwic3RyaW5nXCI9PXR5cGVvZiB0P3Q9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0KTpcImxlbmd0aFwiaW4gdHx8KHQ9W3RdKTtmb3IodmFyIGk9MDtpPHQubGVuZ3RoO2krKyl0W2ldW2FdPXRbaV1bYV18fHtza2lwVGVzdDplLnNraXBUZXN0fSxjKHRbaV0pO3ImJihkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsZnVuY3Rpb24odCl7XCJJTUdcIj09PXQudGFyZ2V0LnRhZ05hbWUmJm8odC50YXJnZXQse3NraXBUZXN0OmUuc2tpcFRlc3R9KX0sITApLGg9ITAsdD1cImltZ1wiKSxlLndhdGNoTVEmJndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsby5iaW5kKG51bGwsdCx7c2tpcFRlc3Q6ZS5za2lwVGVzdH0pKX12YXIgYT1cImJmcmVkLWl0Om9iamVjdC1maXQtaW1hZ2VzXCIsdT0vKG9iamVjdC1maXR8b2JqZWN0LXBvc2l0aW9uKVxccyo6XFxzKihbLS5cXHdcXHMlXSspL2csbD1cInVuZGVmaW5lZFwiPT10eXBlb2YgSW1hZ2U/e3N0eWxlOntcIm9iamVjdC1wb3NpdGlvblwiOjF9fTpuZXcgSW1hZ2UsZz1cIm9iamVjdC1maXRcImluIGwuc3R5bGUsZj1cIm9iamVjdC1wb3NpdGlvblwiaW4gbC5zdHlsZSxkPVwiYmFja2dyb3VuZC1zaXplXCJpbiBsLnN0eWxlLG09XCJzdHJpbmdcIj09dHlwZW9mIGwuY3VycmVudFNyYyxwPWwuZ2V0QXR0cmlidXRlLGI9bC5zZXRBdHRyaWJ1dGUsaD0hMTtyZXR1cm4gby5zdXBwb3J0c09iamVjdEZpdD1nLG8uc3VwcG9ydHNPYmplY3RQb3NpdGlvbj1mLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3JldHVybiB0W2FdJiZ0W2FdLmltZyYmKFwic3JjXCI9PT1lfHxcInNyY3NldFwiPT09ZSk/dFthXS5pbWc6dH1mfHwoSFRNTEltYWdlRWxlbWVudC5wcm90b3R5cGUuZ2V0QXR0cmlidXRlPWZ1bmN0aW9uKGUpe3JldHVybiBwLmNhbGwodCh0aGlzLGUpLGUpfSxIVE1MSW1hZ2VFbGVtZW50LnByb3RvdHlwZS5zZXRBdHRyaWJ1dGU9ZnVuY3Rpb24oZSxyKXtyZXR1cm4gYi5jYWxsKHQodGhpcyxlKSxlLFN0cmluZyhyKSl9KX0oKSxvfSgpO1xuIiwiLyohXG4gKiBQYWNrZXJ5IGxheW91dCBtb2RlIFBBQ0tBR0VEIHYyLjAuMVxuICogc3ViLWNsYXNzZXMgUGFja2VyeVxuICovXG5cbiFmdW5jdGlvbihhLGIpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJwYWNrZXJ5L2pzL3JlY3RcIixiKTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1iKCk6KGEuUGFja2VyeT1hLlBhY2tlcnl8fHt9LGEuUGFja2VyeS5SZWN0PWIoKSl9KHdpbmRvdyxmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYil7Zm9yKHZhciBjIGluIGEuZGVmYXVsdHMpdGhpc1tjXT1hLmRlZmF1bHRzW2NdO2ZvcihjIGluIGIpdGhpc1tjXT1iW2NdfWEuZGVmYXVsdHM9e3g6MCx5OjAsd2lkdGg6MCxoZWlnaHQ6MH07dmFyIGI9YS5wcm90b3R5cGU7cmV0dXJuIGIuY29udGFpbnM9ZnVuY3Rpb24oYSl7dmFyIGI9YS53aWR0aHx8MCxjPWEuaGVpZ2h0fHwwO3JldHVybiB0aGlzLng8PWEueCYmdGhpcy55PD1hLnkmJnRoaXMueCt0aGlzLndpZHRoPj1hLngrYiYmdGhpcy55K3RoaXMuaGVpZ2h0Pj1hLnkrY30sYi5vdmVybGFwcz1mdW5jdGlvbihhKXt2YXIgYj10aGlzLngrdGhpcy53aWR0aCxjPXRoaXMueSt0aGlzLmhlaWdodCxkPWEueCthLndpZHRoLGU9YS55K2EuaGVpZ2h0O3JldHVybiB0aGlzLng8ZCYmYj5hLngmJnRoaXMueTxlJiZjPmEueX0sYi5nZXRNYXhpbWFsRnJlZVJlY3RzPWZ1bmN0aW9uKGIpe2lmKCF0aGlzLm92ZXJsYXBzKGIpKXJldHVybiExO3ZhciBjLGQ9W10sZT10aGlzLngrdGhpcy53aWR0aCxmPXRoaXMueSt0aGlzLmhlaWdodCxnPWIueCtiLndpZHRoLGg9Yi55K2IuaGVpZ2h0O3JldHVybiB0aGlzLnk8Yi55JiYoYz1uZXcgYSh7eDp0aGlzLngseTp0aGlzLnksd2lkdGg6dGhpcy53aWR0aCxoZWlnaHQ6Yi55LXRoaXMueX0pLGQucHVzaChjKSksZT5nJiYoYz1uZXcgYSh7eDpnLHk6dGhpcy55LHdpZHRoOmUtZyxoZWlnaHQ6dGhpcy5oZWlnaHR9KSxkLnB1c2goYykpLGY+aCYmKGM9bmV3IGEoe3g6dGhpcy54LHk6aCx3aWR0aDp0aGlzLndpZHRoLGhlaWdodDpmLWh9KSxkLnB1c2goYykpLHRoaXMueDxiLngmJihjPW5ldyBhKHt4OnRoaXMueCx5OnRoaXMueSx3aWR0aDpiLngtdGhpcy54LGhlaWdodDp0aGlzLmhlaWdodH0pLGQucHVzaChjKSksZH0sYi5jYW5GaXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMud2lkdGg+PWEud2lkdGgmJnRoaXMuaGVpZ2h0Pj1hLmhlaWdodH0sYX0pLGZ1bmN0aW9uKGEsYil7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kKWRlZmluZShcInBhY2tlcnkvanMvcGFja2VyXCIsW1wiLi9yZWN0XCJdLGIpO2Vsc2UgaWYoXCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHMpbW9kdWxlLmV4cG9ydHM9YihyZXF1aXJlKFwiLi9yZWN0XCIpKTtlbHNle3ZhciBjPWEuUGFja2VyeT1hLlBhY2tlcnl8fHt9O2MuUGFja2VyPWIoYy5SZWN0KX19KHdpbmRvdyxmdW5jdGlvbihhKXtmdW5jdGlvbiBiKGEsYixjKXt0aGlzLndpZHRoPWF8fDAsdGhpcy5oZWlnaHQ9Ynx8MCx0aGlzLnNvcnREaXJlY3Rpb249Y3x8XCJkb3dud2FyZExlZnRUb1JpZ2h0XCIsdGhpcy5yZXNldCgpfXZhciBjPWIucHJvdG90eXBlO2MucmVzZXQ9ZnVuY3Rpb24oKXt0aGlzLnNwYWNlcz1bXTt2YXIgYj1uZXcgYSh7eDowLHk6MCx3aWR0aDp0aGlzLndpZHRoLGhlaWdodDp0aGlzLmhlaWdodH0pO3RoaXMuc3BhY2VzLnB1c2goYiksdGhpcy5zb3J0ZXI9ZFt0aGlzLnNvcnREaXJlY3Rpb25dfHxkLmRvd253YXJkTGVmdFRvUmlnaHR9LGMucGFjaz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MDtiPHRoaXMuc3BhY2VzLmxlbmd0aDtiKyspe3ZhciBjPXRoaXMuc3BhY2VzW2JdO2lmKGMuY2FuRml0KGEpKXt0aGlzLnBsYWNlSW5TcGFjZShhLGMpO2JyZWFrfX19LGMuY29sdW1uUGFjaz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MDtiPHRoaXMuc3BhY2VzLmxlbmd0aDtiKyspe3ZhciBjPXRoaXMuc3BhY2VzW2JdLGQ9Yy54PD1hLngmJmMueCtjLndpZHRoPj1hLngrYS53aWR0aCYmYy5oZWlnaHQ+PWEuaGVpZ2h0LS4wMTtpZihkKXthLnk9Yy55LHRoaXMucGxhY2VkKGEpO2JyZWFrfX19LGMucm93UGFjaz1mdW5jdGlvbihhKXtmb3IodmFyIGI9MDtiPHRoaXMuc3BhY2VzLmxlbmd0aDtiKyspe3ZhciBjPXRoaXMuc3BhY2VzW2JdLGQ9Yy55PD1hLnkmJmMueStjLmhlaWdodD49YS55K2EuaGVpZ2h0JiZjLndpZHRoPj1hLndpZHRoLS4wMTtpZihkKXthLng9Yy54LHRoaXMucGxhY2VkKGEpO2JyZWFrfX19LGMucGxhY2VJblNwYWNlPWZ1bmN0aW9uKGEsYil7YS54PWIueCxhLnk9Yi55LHRoaXMucGxhY2VkKGEpfSxjLnBsYWNlZD1mdW5jdGlvbihhKXtmb3IodmFyIGI9W10sYz0wO2M8dGhpcy5zcGFjZXMubGVuZ3RoO2MrKyl7dmFyIGQ9dGhpcy5zcGFjZXNbY10sZT1kLmdldE1heGltYWxGcmVlUmVjdHMoYSk7ZT9iLnB1c2guYXBwbHkoYixlKTpiLnB1c2goZCl9dGhpcy5zcGFjZXM9Yix0aGlzLm1lcmdlU29ydFNwYWNlcygpfSxjLm1lcmdlU29ydFNwYWNlcz1mdW5jdGlvbigpe2IubWVyZ2VSZWN0cyh0aGlzLnNwYWNlcyksdGhpcy5zcGFjZXMuc29ydCh0aGlzLnNvcnRlcil9LGMuYWRkU3BhY2U9ZnVuY3Rpb24oYSl7dGhpcy5zcGFjZXMucHVzaChhKSx0aGlzLm1lcmdlU29ydFNwYWNlcygpfSxiLm1lcmdlUmVjdHM9ZnVuY3Rpb24oYSl7dmFyIGI9MCxjPWFbYl07YTpmb3IoO2M7KXtmb3IodmFyIGQ9MCxlPWFbYitkXTtlOyl7aWYoZT09YylkKys7ZWxzZXtpZihlLmNvbnRhaW5zKGMpKXthLnNwbGljZShiLDEpLGM9YVtiXTtjb250aW51ZSBhfWMuY29udGFpbnMoZSk/YS5zcGxpY2UoYitkLDEpOmQrK31lPWFbYitkXX1iKyssYz1hW2JdfXJldHVybiBhfTt2YXIgZD17ZG93bndhcmRMZWZ0VG9SaWdodDpmdW5jdGlvbihhLGIpe3JldHVybiBhLnktYi55fHxhLngtYi54fSxyaWdodHdhcmRUb3BUb0JvdHRvbTpmdW5jdGlvbihhLGIpe3JldHVybiBhLngtYi54fHxhLnktYi55fX07cmV0dXJuIGJ9KSxmdW5jdGlvbihhLGIpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoXCJwYWNrZXJ5L2pzL2l0ZW1cIixbXCJvdXRsYXllci9vdXRsYXllclwiLFwiLi9yZWN0XCJdLGIpOlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWIocmVxdWlyZShcIm91dGxheWVyXCIpLHJlcXVpcmUoXCIuL3JlY3RcIikpOmEuUGFja2VyeS5JdGVtPWIoYS5PdXRsYXllcixhLlBhY2tlcnkuUmVjdCl9KHdpbmRvdyxmdW5jdGlvbihhLGIpe3ZhciBjPWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZSxkPVwic3RyaW5nXCI9PXR5cGVvZiBjLnRyYW5zZm9ybT9cInRyYW5zZm9ybVwiOlwiV2Via2l0VHJhbnNmb3JtXCIsZT1mdW5jdGlvbigpe2EuSXRlbS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGY9ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShhLkl0ZW0ucHJvdG90eXBlKSxnPWYuX2NyZWF0ZTtmLl9jcmVhdGU9ZnVuY3Rpb24oKXtnLmNhbGwodGhpcyksdGhpcy5yZWN0PW5ldyBifTt2YXIgaD1mLm1vdmVUbztyZXR1cm4gZi5tb3ZlVG89ZnVuY3Rpb24oYSxiKXt2YXIgYz1NYXRoLmFicyh0aGlzLnBvc2l0aW9uLngtYSksZD1NYXRoLmFicyh0aGlzLnBvc2l0aW9uLnktYiksZT10aGlzLmxheW91dC5kcmFnSXRlbUNvdW50JiYhdGhpcy5pc1BsYWNpbmcmJiF0aGlzLmlzVHJhbnNpdGlvbmluZyYmMT5jJiYxPmQ7cmV0dXJuIGU/dm9pZCB0aGlzLmdvVG8oYSxiKTp2b2lkIGguYXBwbHkodGhpcyxhcmd1bWVudHMpfSxmLmVuYWJsZVBsYWNpbmc9ZnVuY3Rpb24oKXt0aGlzLnJlbW92ZVRyYW5zaXRpb25TdHlsZXMoKSx0aGlzLmlzVHJhbnNpdGlvbmluZyYmZCYmKHRoaXMuZWxlbWVudC5zdHlsZVtkXT1cIm5vbmVcIiksdGhpcy5pc1RyYW5zaXRpb25pbmc9ITEsdGhpcy5nZXRTaXplKCksdGhpcy5sYXlvdXQuX3NldFJlY3RTaXplKHRoaXMuZWxlbWVudCx0aGlzLnJlY3QpLHRoaXMuaXNQbGFjaW5nPSEwfSxmLmRpc2FibGVQbGFjaW5nPWZ1bmN0aW9uKCl7dGhpcy5pc1BsYWNpbmc9ITF9LGYucmVtb3ZlRWxlbT1mdW5jdGlvbigpe3RoaXMuZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudCksdGhpcy5sYXlvdXQucGFja2VyLmFkZFNwYWNlKHRoaXMucmVjdCksdGhpcy5lbWl0RXZlbnQoXCJyZW1vdmVcIixbdGhpc10pfSxmLnNob3dEcm9wUGxhY2Vob2xkZXI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmRyb3BQbGFjZWhvbGRlcjthfHwoYT10aGlzLmRyb3BQbGFjZWhvbGRlcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLGEuY2xhc3NOYW1lPVwicGFja2VyeS1kcm9wLXBsYWNlaG9sZGVyXCIsYS5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIpLGEuc3R5bGUud2lkdGg9dGhpcy5zaXplLndpZHRoK1wicHhcIixhLnN0eWxlLmhlaWdodD10aGlzLnNpemUuaGVpZ2h0K1wicHhcIix0aGlzLnBvc2l0aW9uRHJvcFBsYWNlaG9sZGVyKCksdGhpcy5sYXlvdXQuZWxlbWVudC5hcHBlbmRDaGlsZChhKX0sZi5wb3NpdGlvbkRyb3BQbGFjZWhvbGRlcj1mdW5jdGlvbigpe3RoaXMuZHJvcFBsYWNlaG9sZGVyLnN0eWxlW2RdPVwidHJhbnNsYXRlKFwiK3RoaXMucmVjdC54K1wicHgsIFwiK3RoaXMucmVjdC55K1wicHgpXCJ9LGYuaGlkZURyb3BQbGFjZWhvbGRlcj1mdW5jdGlvbigpe3RoaXMubGF5b3V0LmVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5kcm9wUGxhY2Vob2xkZXIpfSxlfSksZnVuY3Rpb24oYSxiKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFwicGFja2VyeS9qcy9wYWNrZXJ5XCIsW1wiZ2V0LXNpemUvZ2V0LXNpemVcIixcIm91dGxheWVyL291dGxheWVyXCIsXCIuL3JlY3RcIixcIi4vcGFja2VyXCIsXCIuL2l0ZW1cIl0sYik6XCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9YihyZXF1aXJlKFwiZ2V0LXNpemVcIikscmVxdWlyZShcIm91dGxheWVyXCIpLHJlcXVpcmUoXCIuL3JlY3RcIikscmVxdWlyZShcIi4vcGFja2VyXCIpLHJlcXVpcmUoXCIuL2l0ZW1cIikpOmEuUGFja2VyeT1iKGEuZ2V0U2l6ZSxhLk91dGxheWVyLGEuUGFja2VyeS5SZWN0LGEuUGFja2VyeS5QYWNrZXIsYS5QYWNrZXJ5Lkl0ZW0pfSh3aW5kb3csZnVuY3Rpb24oYSxiLGMsZCxlKXtmdW5jdGlvbiBmKGEsYil7cmV0dXJuIGEucG9zaXRpb24ueS1iLnBvc2l0aW9uLnl8fGEucG9zaXRpb24ueC1iLnBvc2l0aW9uLnh9ZnVuY3Rpb24gZyhhLGIpe3JldHVybiBhLnBvc2l0aW9uLngtYi5wb3NpdGlvbi54fHxhLnBvc2l0aW9uLnktYi5wb3NpdGlvbi55fWZ1bmN0aW9uIGgoYSxiKXt2YXIgYz1iLngtYS54LGQ9Yi55LWEueTtyZXR1cm4gTWF0aC5zcXJ0KGMqYytkKmQpfWMucHJvdG90eXBlLmNhbkZpdD1mdW5jdGlvbihhKXtyZXR1cm4gdGhpcy53aWR0aD49YS53aWR0aC0xJiZ0aGlzLmhlaWdodD49YS5oZWlnaHQtMX07dmFyIGk9Yi5jcmVhdGUoXCJwYWNrZXJ5XCIpO2kuSXRlbT1lO3ZhciBqPWkucHJvdG90eXBlO2ouX2NyZWF0ZT1mdW5jdGlvbigpe2IucHJvdG90eXBlLl9jcmVhdGUuY2FsbCh0aGlzKSx0aGlzLnBhY2tlcj1uZXcgZCx0aGlzLnNoaWZ0UGFja2VyPW5ldyBkLHRoaXMuaXNFbmFibGVkPSEwLHRoaXMuZHJhZ0l0ZW1Db3VudD0wO3ZhciBhPXRoaXM7dGhpcy5oYW5kbGVEcmFnZ2FiaWxseT17ZHJhZ1N0YXJ0OmZ1bmN0aW9uKCl7YS5pdGVtRHJhZ1N0YXJ0KHRoaXMuZWxlbWVudCl9LGRyYWdNb3ZlOmZ1bmN0aW9uKCl7YS5pdGVtRHJhZ01vdmUodGhpcy5lbGVtZW50LHRoaXMucG9zaXRpb24ueCx0aGlzLnBvc2l0aW9uLnkpfSxkcmFnRW5kOmZ1bmN0aW9uKCl7YS5pdGVtRHJhZ0VuZCh0aGlzLmVsZW1lbnQpfX0sdGhpcy5oYW5kbGVVSURyYWdnYWJsZT17c3RhcnQ6ZnVuY3Rpb24oYixjKXtjJiZhLml0ZW1EcmFnU3RhcnQoYi5jdXJyZW50VGFyZ2V0KX0sZHJhZzpmdW5jdGlvbihiLGMpe2MmJmEuaXRlbURyYWdNb3ZlKGIuY3VycmVudFRhcmdldCxjLnBvc2l0aW9uLmxlZnQsYy5wb3NpdGlvbi50b3ApfSxzdG9wOmZ1bmN0aW9uKGIsYyl7YyYmYS5pdGVtRHJhZ0VuZChiLmN1cnJlbnRUYXJnZXQpfX19LGouX3Jlc2V0TGF5b3V0PWZ1bmN0aW9uKCl7dGhpcy5nZXRTaXplKCksdGhpcy5fZ2V0TWVhc3VyZW1lbnRzKCk7dmFyIGEsYixjO3RoaXMuX2dldE9wdGlvbihcImhvcml6b250YWxcIik/KGE9MS8wLGI9dGhpcy5zaXplLmlubmVySGVpZ2h0K3RoaXMuZ3V0dGVyLGM9XCJyaWdodHdhcmRUb3BUb0JvdHRvbVwiKTooYT10aGlzLnNpemUuaW5uZXJXaWR0aCt0aGlzLmd1dHRlcixiPTEvMCxjPVwiZG93bndhcmRMZWZ0VG9SaWdodFwiKSx0aGlzLnBhY2tlci53aWR0aD10aGlzLnNoaWZ0UGFja2VyLndpZHRoPWEsdGhpcy5wYWNrZXIuaGVpZ2h0PXRoaXMuc2hpZnRQYWNrZXIuaGVpZ2h0PWIsdGhpcy5wYWNrZXIuc29ydERpcmVjdGlvbj10aGlzLnNoaWZ0UGFja2VyLnNvcnREaXJlY3Rpb249Yyx0aGlzLnBhY2tlci5yZXNldCgpLHRoaXMubWF4WT0wLHRoaXMubWF4WD0wfSxqLl9nZXRNZWFzdXJlbWVudHM9ZnVuY3Rpb24oKXt0aGlzLl9nZXRNZWFzdXJlbWVudChcImNvbHVtbldpZHRoXCIsXCJ3aWR0aFwiKSx0aGlzLl9nZXRNZWFzdXJlbWVudChcInJvd0hlaWdodFwiLFwiaGVpZ2h0XCIpLHRoaXMuX2dldE1lYXN1cmVtZW50KFwiZ3V0dGVyXCIsXCJ3aWR0aFwiKX0sai5fZ2V0SXRlbUxheW91dFBvc2l0aW9uPWZ1bmN0aW9uKGEpe2lmKHRoaXMuX3NldFJlY3RTaXplKGEuZWxlbWVudCxhLnJlY3QpLHRoaXMuaXNTaGlmdGluZ3x8dGhpcy5kcmFnSXRlbUNvdW50PjApe3ZhciBiPXRoaXMuX2dldFBhY2tNZXRob2QoKTt0aGlzLnBhY2tlcltiXShhLnJlY3QpfWVsc2UgdGhpcy5wYWNrZXIucGFjayhhLnJlY3QpO3JldHVybiB0aGlzLl9zZXRNYXhYWShhLnJlY3QpLGEucmVjdH0sai5zaGlmdExheW91dD1mdW5jdGlvbigpe3RoaXMuaXNTaGlmdGluZz0hMCx0aGlzLmxheW91dCgpLGRlbGV0ZSB0aGlzLmlzU2hpZnRpbmd9LGouX2dldFBhY2tNZXRob2Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ2V0T3B0aW9uKFwiaG9yaXpvbnRhbFwiKT9cInJvd1BhY2tcIjpcImNvbHVtblBhY2tcIn0sai5fc2V0TWF4WFk9ZnVuY3Rpb24oYSl7dGhpcy5tYXhYPU1hdGgubWF4KGEueCthLndpZHRoLHRoaXMubWF4WCksdGhpcy5tYXhZPU1hdGgubWF4KGEueSthLmhlaWdodCx0aGlzLm1heFkpfSxqLl9zZXRSZWN0U2l6ZT1mdW5jdGlvbihiLGMpe3ZhciBkPWEoYiksZT1kLm91dGVyV2lkdGgsZj1kLm91dGVySGVpZ2h0OyhlfHxmKSYmKGU9dGhpcy5fYXBwbHlHcmlkR3V0dGVyKGUsdGhpcy5jb2x1bW5XaWR0aCksZj10aGlzLl9hcHBseUdyaWRHdXR0ZXIoZix0aGlzLnJvd0hlaWdodCkpLGMud2lkdGg9TWF0aC5taW4oZSx0aGlzLnBhY2tlci53aWR0aCksYy5oZWlnaHQ9TWF0aC5taW4oZix0aGlzLnBhY2tlci5oZWlnaHQpfSxqLl9hcHBseUdyaWRHdXR0ZXI9ZnVuY3Rpb24oYSxiKXtpZighYilyZXR1cm4gYSt0aGlzLmd1dHRlcjtiKz10aGlzLmd1dHRlcjt2YXIgYz1hJWIsZD1jJiYxPmM/XCJyb3VuZFwiOlwiY2VpbFwiO3JldHVybiBhPU1hdGhbZF0oYS9iKSpifSxqLl9nZXRDb250YWluZXJTaXplPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldE9wdGlvbihcImhvcml6b250YWxcIik/e3dpZHRoOnRoaXMubWF4WC10aGlzLmd1dHRlcn06e2hlaWdodDp0aGlzLm1heFktdGhpcy5ndXR0ZXJ9fSxqLl9tYW5hZ2VTdGFtcD1mdW5jdGlvbihhKXt2YXIgYixkPXRoaXMuZ2V0SXRlbShhKTtpZihkJiZkLmlzUGxhY2luZyliPWQucmVjdDtlbHNle3ZhciBlPXRoaXMuX2dldEVsZW1lbnRPZmZzZXQoYSk7Yj1uZXcgYyh7eDp0aGlzLl9nZXRPcHRpb24oXCJvcmlnaW5MZWZ0XCIpP2UubGVmdDplLnJpZ2h0LHk6dGhpcy5fZ2V0T3B0aW9uKFwib3JpZ2luVG9wXCIpP2UudG9wOmUuYm90dG9tfSl9dGhpcy5fc2V0UmVjdFNpemUoYSxiKSx0aGlzLnBhY2tlci5wbGFjZWQoYiksdGhpcy5fc2V0TWF4WFkoYil9LGouc29ydEl0ZW1zQnlQb3NpdGlvbj1mdW5jdGlvbigpe3ZhciBhPXRoaXMuX2dldE9wdGlvbihcImhvcml6b250YWxcIik/ZzpmO3RoaXMuaXRlbXMuc29ydChhKX0sai5maXQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXRoaXMuZ2V0SXRlbShhKTtkJiYodGhpcy5zdGFtcChkLmVsZW1lbnQpLGQuZW5hYmxlUGxhY2luZygpLHRoaXMudXBkYXRlU2hpZnRUYXJnZXRzKGQpLGI9dm9pZCAwPT09Yj9kLnJlY3QueDpiLGM9dm9pZCAwPT09Yz9kLnJlY3QueTpjLHRoaXMuc2hpZnQoZCxiLGMpLHRoaXMuX2JpbmRGaXRFdmVudHMoZCksZC5tb3ZlVG8oZC5yZWN0LngsZC5yZWN0LnkpLHRoaXMuc2hpZnRMYXlvdXQoKSx0aGlzLnVuc3RhbXAoZC5lbGVtZW50KSx0aGlzLnNvcnRJdGVtc0J5UG9zaXRpb24oKSxkLmRpc2FibGVQbGFjaW5nKCkpfSxqLl9iaW5kRml0RXZlbnRzPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXtkKyssMj09ZCYmYy5kaXNwYXRjaEV2ZW50KFwiZml0Q29tcGxldGVcIixudWxsLFthXSl9dmFyIGM9dGhpcyxkPTA7YS5vbmNlKFwibGF5b3V0XCIsYiksdGhpcy5vbmNlKFwibGF5b3V0Q29tcGxldGVcIixiKX0sai5yZXNpemU9ZnVuY3Rpb24oKXt0aGlzLmlzUmVzaXplQm91bmQmJnRoaXMubmVlZHNSZXNpemVMYXlvdXQoKSYmKHRoaXMub3B0aW9ucy5zaGlmdFBlcmNlbnRSZXNpemU/dGhpcy5yZXNpemVTaGlmdFBlcmNlbnRMYXlvdXQoKTp0aGlzLmxheW91dCgpKX0sai5uZWVkc1Jlc2l6ZUxheW91dD1mdW5jdGlvbigpe3ZhciBiPWEodGhpcy5lbGVtZW50KSxjPXRoaXMuX2dldE9wdGlvbihcImhvcml6b250YWxcIik/XCJpbm5lckhlaWdodFwiOlwiaW5uZXJXaWR0aFwiO3JldHVybiBiW2NdIT10aGlzLnNpemVbY119LGoucmVzaXplU2hpZnRQZXJjZW50TGF5b3V0PWZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5fZ2V0SXRlbXNGb3JMYXlvdXQodGhpcy5pdGVtcyksYz10aGlzLl9nZXRPcHRpb24oXCJob3Jpem9udGFsXCIpLGQ9Yz9cInlcIjpcInhcIixlPWM/XCJoZWlnaHRcIjpcIndpZHRoXCIsZj1jP1wicm93SGVpZ2h0XCI6XCJjb2x1bW5XaWR0aFwiLGc9Yz9cImlubmVySGVpZ2h0XCI6XCJpbm5lcldpZHRoXCIsaD10aGlzW2ZdO2lmKGg9aCYmaCt0aGlzLmd1dHRlcil7dGhpcy5fZ2V0TWVhc3VyZW1lbnRzKCk7dmFyIGk9dGhpc1tmXSt0aGlzLmd1dHRlcjtiLmZvckVhY2goZnVuY3Rpb24oYSl7dmFyIGI9TWF0aC5yb3VuZChhLnJlY3RbZF0vaCk7YS5yZWN0W2RdPWIqaX0pfWVsc2V7dmFyIGo9YSh0aGlzLmVsZW1lbnQpW2ddK3RoaXMuZ3V0dGVyLGs9dGhpcy5wYWNrZXJbZV07Yi5mb3JFYWNoKGZ1bmN0aW9uKGEpe2EucmVjdFtkXT1hLnJlY3RbZF0vaypqfSl9dGhpcy5zaGlmdExheW91dCgpfSxqLml0ZW1EcmFnU3RhcnQ9ZnVuY3Rpb24oYSl7aWYodGhpcy5pc0VuYWJsZWQpe3RoaXMuc3RhbXAoYSk7dmFyIGI9dGhpcy5nZXRJdGVtKGEpO2ImJihiLmVuYWJsZVBsYWNpbmcoKSxiLnNob3dEcm9wUGxhY2Vob2xkZXIoKSx0aGlzLmRyYWdJdGVtQ291bnQrKyx0aGlzLnVwZGF0ZVNoaWZ0VGFyZ2V0cyhiKSl9fSxqLnVwZGF0ZVNoaWZ0VGFyZ2V0cz1mdW5jdGlvbihhKXt0aGlzLnNoaWZ0UGFja2VyLnJlc2V0KCksdGhpcy5fZ2V0Qm91bmRpbmdSZWN0KCk7dmFyIGI9dGhpcy5fZ2V0T3B0aW9uKFwib3JpZ2luTGVmdFwiKSxkPXRoaXMuX2dldE9wdGlvbihcIm9yaWdpblRvcFwiKTt0aGlzLnN0YW1wcy5mb3JFYWNoKGZ1bmN0aW9uKGEpe3ZhciBlPXRoaXMuZ2V0SXRlbShhKTtpZighZXx8IWUuaXNQbGFjaW5nKXt2YXIgZj10aGlzLl9nZXRFbGVtZW50T2Zmc2V0KGEpLGc9bmV3IGMoe3g6Yj9mLmxlZnQ6Zi5yaWdodCx5OmQ/Zi50b3A6Zi5ib3R0b219KTt0aGlzLl9zZXRSZWN0U2l6ZShhLGcpLHRoaXMuc2hpZnRQYWNrZXIucGxhY2VkKGcpfX0sdGhpcyk7dmFyIGU9dGhpcy5fZ2V0T3B0aW9uKFwiaG9yaXpvbnRhbFwiKSxmPWU/XCJyb3dIZWlnaHRcIjpcImNvbHVtbldpZHRoXCIsZz1lP1wiaGVpZ2h0XCI6XCJ3aWR0aFwiO3RoaXMuc2hpZnRUYXJnZXRLZXlzPVtdLHRoaXMuc2hpZnRUYXJnZXRzPVtdO3ZhciBoLGk9dGhpc1tmXTtpZihpPWkmJmkrdGhpcy5ndXR0ZXIpe3ZhciBqPU1hdGguY2VpbChhLnJlY3RbZ10vaSksaz1NYXRoLmZsb29yKCh0aGlzLnNoaWZ0UGFja2VyW2ddK3RoaXMuZ3V0dGVyKS9pKTtoPShrLWopKmk7Zm9yKHZhciBsPTA7az5sO2wrKyl0aGlzLl9hZGRTaGlmdFRhcmdldChsKmksMCxoKX1lbHNlIGg9dGhpcy5zaGlmdFBhY2tlcltnXSt0aGlzLmd1dHRlci1hLnJlY3RbZ10sdGhpcy5fYWRkU2hpZnRUYXJnZXQoMCwwLGgpO3ZhciBtPXRoaXMuX2dldEl0ZW1zRm9yTGF5b3V0KHRoaXMuaXRlbXMpLG49dGhpcy5fZ2V0UGFja01ldGhvZCgpO20uZm9yRWFjaChmdW5jdGlvbihhKXt2YXIgYj1hLnJlY3Q7dGhpcy5fc2V0UmVjdFNpemUoYS5lbGVtZW50LGIpLHRoaXMuc2hpZnRQYWNrZXJbbl0oYiksdGhpcy5fYWRkU2hpZnRUYXJnZXQoYi54LGIueSxoKTt2YXIgYz1lP2IueCtiLndpZHRoOmIueCxkPWU/Yi55OmIueStiLmhlaWdodDtpZih0aGlzLl9hZGRTaGlmdFRhcmdldChjLGQsaCksaSlmb3IodmFyIGY9TWF0aC5yb3VuZChiW2ddL2kpLGo9MTtmPmo7aisrKXt2YXIgaz1lP2M6Yi54K2kqaixsPWU/Yi55K2kqajpkO3RoaXMuX2FkZFNoaWZ0VGFyZ2V0KGssbCxoKX19LHRoaXMpfSxqLl9hZGRTaGlmdFRhcmdldD1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9dGhpcy5fZ2V0T3B0aW9uKFwiaG9yaXpvbnRhbFwiKT9iOmE7aWYoISgwIT09ZCYmZD5jKSl7dmFyIGU9YStcIixcIitiLGY9LTEhPXRoaXMuc2hpZnRUYXJnZXRLZXlzLmluZGV4T2YoZSk7Znx8KHRoaXMuc2hpZnRUYXJnZXRLZXlzLnB1c2goZSksdGhpcy5zaGlmdFRhcmdldHMucHVzaCh7eDphLHk6Yn0pKX19LGouc2hpZnQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU9MS8wLGY9e3g6Yix5OmN9O3RoaXMuc2hpZnRUYXJnZXRzLmZvckVhY2goZnVuY3Rpb24oYSl7dmFyIGI9aChhLGYpO2U+YiYmKGQ9YSxlPWIpfSksYS5yZWN0Lng9ZC54LGEucmVjdC55PWQueX07dmFyIGs9MTIwO2ouaXRlbURyYWdNb3ZlPWZ1bmN0aW9uKGEsYixjKXtmdW5jdGlvbiBkKCl7Zi5zaGlmdChlLGIsYyksZS5wb3NpdGlvbkRyb3BQbGFjZWhvbGRlcigpLGYubGF5b3V0KCl9dmFyIGU9dGhpcy5pc0VuYWJsZWQmJnRoaXMuZ2V0SXRlbShhKTtpZihlKXtiLT10aGlzLnNpemUucGFkZGluZ0xlZnQsYy09dGhpcy5zaXplLnBhZGRpbmdUb3A7dmFyIGY9dGhpcyxnPW5ldyBEYXRlO3RoaXMuX2l0ZW1EcmFnVGltZSYmZy10aGlzLl9pdGVtRHJhZ1RpbWU8az8oY2xlYXJUaW1lb3V0KHRoaXMuZHJhZ1RpbWVvdXQpLHRoaXMuZHJhZ1RpbWVvdXQ9c2V0VGltZW91dChkLGspKTooZCgpLHRoaXMuX2l0ZW1EcmFnVGltZT1nKX19LGouaXRlbURyYWdFbmQ9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gYigpe2QrKywyPT1kJiYoYy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1wb3NpdGlvbmluZy1wb3N0LWRyYWdcIiksYy5oaWRlRHJvcFBsYWNlaG9sZGVyKCksZS5kaXNwYXRjaEV2ZW50KFwiZHJhZ0l0ZW1Qb3NpdGlvbmVkXCIsbnVsbCxbY10pKX12YXIgYz10aGlzLmlzRW5hYmxlZCYmdGhpcy5nZXRJdGVtKGEpO2lmKGMpe2NsZWFyVGltZW91dCh0aGlzLmRyYWdUaW1lb3V0KSxjLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImlzLXBvc2l0aW9uaW5nLXBvc3QtZHJhZ1wiKTt2YXIgZD0wLGU9dGhpcztjLm9uY2UoXCJsYXlvdXRcIixiKSx0aGlzLm9uY2UoXCJsYXlvdXRDb21wbGV0ZVwiLGIpLGMubW92ZVRvKGMucmVjdC54LGMucmVjdC55KSx0aGlzLmxheW91dCgpLHRoaXMuZHJhZ0l0ZW1Db3VudD1NYXRoLm1heCgwLHRoaXMuZHJhZ0l0ZW1Db3VudC0xKSx0aGlzLnNvcnRJdGVtc0J5UG9zaXRpb24oKSxjLmRpc2FibGVQbGFjaW5nKCksdGhpcy51bnN0YW1wKGMuZWxlbWVudCl9fSxqLmJpbmREcmFnZ2FiaWxseUV2ZW50cz1mdW5jdGlvbihhKXt0aGlzLl9iaW5kRHJhZ2dhYmlsbHlFdmVudHMoYSxcIm9uXCIpfSxqLnVuYmluZERyYWdnYWJpbGx5RXZlbnRzPWZ1bmN0aW9uKGEpe3RoaXMuX2JpbmREcmFnZ2FiaWxseUV2ZW50cyhhLFwib2ZmXCIpfSxqLl9iaW5kRHJhZ2dhYmlsbHlFdmVudHM9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmhhbmRsZURyYWdnYWJpbGx5O2FbYl0oXCJkcmFnU3RhcnRcIixjLmRyYWdTdGFydCksYVtiXShcImRyYWdNb3ZlXCIsYy5kcmFnTW92ZSksYVtiXShcImRyYWdFbmRcIixjLmRyYWdFbmQpfSxqLmJpbmRVSURyYWdnYWJsZUV2ZW50cz1mdW5jdGlvbihhKXt0aGlzLl9iaW5kVUlEcmFnZ2FibGVFdmVudHMoYSxcIm9uXCIpfSxqLnVuYmluZFVJRHJhZ2dhYmxlRXZlbnRzPWZ1bmN0aW9uKGEpe3RoaXMuX2JpbmRVSURyYWdnYWJsZUV2ZW50cyhhLFwib2ZmXCIpfSxqLl9iaW5kVUlEcmFnZ2FibGVFdmVudHM9ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmhhbmRsZVVJRHJhZ2dhYmxlO2FbYl0oXCJkcmFnc3RhcnRcIixjLnN0YXJ0KVtiXShcImRyYWdcIixjLmRyYWcpW2JdKFwiZHJhZ3N0b3BcIixjLnN0b3ApfTt2YXIgbD1qLmRlc3Ryb3k7cmV0dXJuIGouZGVzdHJveT1mdW5jdGlvbigpe2wuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuaXNFbmFibGVkPSExfSxpLlJlY3Q9YyxpLlBhY2tlcj1kLGl9KSxmdW5jdGlvbihhLGIpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoW1wiaXNvdG9wZS1sYXlvdXQvanMvbGF5b3V0LW1vZGVcIixcInBhY2tlcnkvanMvcGFja2VyeVwiXSxiKTpcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlJiZtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1iKHJlcXVpcmUoXCJpc290b3BlLWxheW91dC9qcy9sYXlvdXQtbW9kZVwiKSxyZXF1aXJlKFwicGFja2VyeVwiKSk6YihhLklzb3RvcGUuTGF5b3V0TW9kZSxhLlBhY2tlcnkpfSh3aW5kb3csZnVuY3Rpb24oYSxiKXt2YXIgYz1hLmNyZWF0ZShcInBhY2tlcnlcIiksZD1jLnByb3RvdHlwZSxlPXtfZ2V0RWxlbWVudE9mZnNldDohMCxfZ2V0TWVhc3VyZW1lbnQ6ITB9O2Zvcih2YXIgZiBpbiBiLnByb3RvdHlwZSllW2ZdfHwoZFtmXT1iLnByb3RvdHlwZVtmXSk7dmFyIGc9ZC5fcmVzZXRMYXlvdXQ7ZC5fcmVzZXRMYXlvdXQ9ZnVuY3Rpb24oKXt0aGlzLnBhY2tlcj10aGlzLnBhY2tlcnx8bmV3IGIuUGFja2VyLHRoaXMuc2hpZnRQYWNrZXI9dGhpcy5zaGlmdFBhY2tlcnx8bmV3IGIuUGFja2VyLGcuYXBwbHkodGhpcyxhcmd1bWVudHMpfTt2YXIgaD1kLl9nZXRJdGVtTGF5b3V0UG9zaXRpb247ZC5fZ2V0SXRlbUxheW91dFBvc2l0aW9uPWZ1bmN0aW9uKGEpe3JldHVybiBhLnJlY3Q9YS5yZWN0fHxuZXcgYi5SZWN0LGguY2FsbCh0aGlzLGEpfTt2YXIgaT1kLm5lZWRzUmVzaXplTGF5b3V0O2QubmVlZHNSZXNpemVMYXlvdXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ2V0T3B0aW9uKFwiaG9yaXpvbnRhbFwiKT90aGlzLm5lZWRzVmVydGljYWxSZXNpemVMYXlvdXQoKTppLmNhbGwodGhpcyl9O3ZhciBqPWQuX2dldE9wdGlvbjtyZXR1cm4gZC5fZ2V0T3B0aW9uPWZ1bmN0aW9uKGEpe3JldHVyblwiaG9yaXpvbnRhbFwiPT1hP3ZvaWQgMCE9PXRoaXMub3B0aW9ucy5pc0hvcml6b250YWw/dGhpcy5vcHRpb25zLmlzSG9yaXpvbnRhbDp0aGlzLm9wdGlvbnMuaG9yaXpvbnRhbDpqLmFwcGx5KHRoaXMuaXNvdG9wZSxhcmd1bWVudHMpfSxjfSk7XG4iLCIvKiEgcGljdHVyZWZpbGwgLSB2My4wLjIgLSAyMDE2LTAyLTEyXHJcbiAqIGh0dHBzOi8vc2NvdHRqZWhsLmdpdGh1Yi5pby9waWN0dXJlZmlsbC9cclxuICogQ29weXJpZ2h0IChjKSAyMDE2IGh0dHBzOi8vZ2l0aHViLmNvbS9zY290dGplaGwvcGljdHVyZWZpbGwvYmxvYi9tYXN0ZXIvQXV0aG9ycy50eHQ7IExpY2Vuc2VkIE1JVFxyXG4gKi9cclxuIWZ1bmN0aW9uKGEpe3ZhciBiPW5hdmlnYXRvci51c2VyQWdlbnQ7YS5IVE1MUGljdHVyZUVsZW1lbnQmJi9lY2tvLy50ZXN0KGIpJiZiLm1hdGNoKC9ydlxcOihcXGQrKS8pJiZSZWdFeHAuJDE8NDUmJmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIixmdW5jdGlvbigpe3ZhciBiLGM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNvdXJjZVwiKSxkPWZ1bmN0aW9uKGEpe3ZhciBiLGQsZT1hLnBhcmVudE5vZGU7XCJQSUNUVVJFXCI9PT1lLm5vZGVOYW1lLnRvVXBwZXJDYXNlKCk/KGI9Yy5jbG9uZU5vZGUoKSxlLmluc2VydEJlZm9yZShiLGUuZmlyc3RFbGVtZW50Q2hpbGQpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLnJlbW92ZUNoaWxkKGIpfSkpOighYS5fcGZMYXN0U2l6ZXx8YS5vZmZzZXRXaWR0aD5hLl9wZkxhc3RTaXplKSYmKGEuX3BmTGFzdFNpemU9YS5vZmZzZXRXaWR0aCxkPWEuc2l6ZXMsYS5zaXplcys9XCIsMTAwdndcIixzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YS5zaXplcz1kfSkpfSxlPWZ1bmN0aW9uKCl7dmFyIGEsYj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwicGljdHVyZSA+IGltZywgaW1nW3NyY3NldF1bc2l6ZXNdXCIpO2ZvcihhPTA7YTxiLmxlbmd0aDthKyspZChiW2FdKX0sZj1mdW5jdGlvbigpe2NsZWFyVGltZW91dChiKSxiPXNldFRpbWVvdXQoZSw5OSl9LGc9YS5tYXRjaE1lZGlhJiZtYXRjaE1lZGlhKFwiKG9yaWVudGF0aW9uOiBsYW5kc2NhcGUpXCIpLGg9ZnVuY3Rpb24oKXtmKCksZyYmZy5hZGRMaXN0ZW5lciYmZy5hZGRMaXN0ZW5lcihmKX07cmV0dXJuIGMuc3Jjc2V0PVwiZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoQVFBQkFBQUFBQ0g1QkFFS0FBRUFMQUFBQUFBQkFBRUFBQUlDVEFFQU93PT1cIiwvXltjfGldfGQkLy50ZXN0KGRvY3VtZW50LnJlYWR5U3RhdGV8fFwiXCIpP2goKTpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLGgpLGZ9KCkpfSh3aW5kb3cpLGZ1bmN0aW9uKGEsYixjKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBkKGEpe3JldHVyblwiIFwiPT09YXx8XCJcdFwiPT09YXx8XCJcXG5cIj09PWF8fFwiXFxmXCI9PT1hfHxcIlxcclwiPT09YX1mdW5jdGlvbiBlKGIsYyl7dmFyIGQ9bmV3IGEuSW1hZ2U7cmV0dXJuIGQub25lcnJvcj1mdW5jdGlvbigpe0FbYl09ITEsYmEoKX0sZC5vbmxvYWQ9ZnVuY3Rpb24oKXtBW2JdPTE9PT1kLndpZHRoLGJhKCl9LGQuc3JjPWMsXCJwZW5kaW5nXCJ9ZnVuY3Rpb24gZigpe009ITEsUD1hLmRldmljZVBpeGVsUmF0aW8sTj17fSxPPXt9LHMuRFBSPVB8fDEsUS53aWR0aD1NYXRoLm1heChhLmlubmVyV2lkdGh8fDAsei5jbGllbnRXaWR0aCksUS5oZWlnaHQ9TWF0aC5tYXgoYS5pbm5lckhlaWdodHx8MCx6LmNsaWVudEhlaWdodCksUS52dz1RLndpZHRoLzEwMCxRLnZoPVEuaGVpZ2h0LzEwMCxyPVtRLmhlaWdodCxRLndpZHRoLFBdLmpvaW4oXCItXCIpLFEuZW09cy5nZXRFbVZhbHVlKCksUS5yZW09US5lbX1mdW5jdGlvbiBnKGEsYixjLGQpe3ZhciBlLGYsZyxoO3JldHVyblwic2F2ZURhdGFcIj09PUIuYWxnb3JpdGhtP2E+Mi43P2g9YysxOihmPWItYyxlPU1hdGgucG93KGEtLjYsMS41KSxnPWYqZSxkJiYoZys9LjEqZSksaD1hK2cpOmg9Yz4xP01hdGguc3FydChhKmIpOmEsaD5jfWZ1bmN0aW9uIGgoYSl7dmFyIGIsYz1zLmdldFNldChhKSxkPSExO1wicGVuZGluZ1wiIT09YyYmKGQ9cixjJiYoYj1zLnNldFJlcyhjKSxzLmFwcGx5U2V0Q2FuZGlkYXRlKGIsYSkpKSxhW3MubnNdLmV2YWxlZD1kfWZ1bmN0aW9uIGkoYSxiKXtyZXR1cm4gYS5yZXMtYi5yZXN9ZnVuY3Rpb24gaihhLGIsYyl7dmFyIGQ7cmV0dXJuIWMmJmImJihjPWFbcy5uc10uc2V0cyxjPWMmJmNbYy5sZW5ndGgtMV0pLGQ9ayhiLGMpLGQmJihiPXMubWFrZVVybChiKSxhW3MubnNdLmN1clNyYz1iLGFbcy5uc10uY3VyQ2FuPWQsZC5yZXN8fGFhKGQsZC5zZXQuc2l6ZXMpKSxkfWZ1bmN0aW9uIGsoYSxiKXt2YXIgYyxkLGU7aWYoYSYmYilmb3IoZT1zLnBhcnNlU2V0KGIpLGE9cy5tYWtlVXJsKGEpLGM9MDtjPGUubGVuZ3RoO2MrKylpZihhPT09cy5tYWtlVXJsKGVbY10udXJsKSl7ZD1lW2NdO2JyZWFrfXJldHVybiBkfWZ1bmN0aW9uIGwoYSxiKXt2YXIgYyxkLGUsZixnPWEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzb3VyY2VcIik7Zm9yKGM9MCxkPWcubGVuZ3RoO2Q+YztjKyspZT1nW2NdLGVbcy5uc109ITAsZj1lLmdldEF0dHJpYnV0ZShcInNyY3NldFwiKSxmJiZiLnB1c2goe3NyY3NldDpmLG1lZGlhOmUuZ2V0QXR0cmlidXRlKFwibWVkaWFcIiksdHlwZTplLmdldEF0dHJpYnV0ZShcInR5cGVcIiksc2l6ZXM6ZS5nZXRBdHRyaWJ1dGUoXCJzaXplc1wiKX0pfWZ1bmN0aW9uIG0oYSxiKXtmdW5jdGlvbiBjKGIpe3ZhciBjLGQ9Yi5leGVjKGEuc3Vic3RyaW5nKG0pKTtyZXR1cm4gZD8oYz1kWzBdLG0rPWMubGVuZ3RoLGMpOnZvaWQgMH1mdW5jdGlvbiBlKCl7dmFyIGEsYyxkLGUsZixpLGosayxsLG09ITEsbz17fTtmb3IoZT0wO2U8aC5sZW5ndGg7ZSsrKWY9aFtlXSxpPWZbZi5sZW5ndGgtMV0saj1mLnN1YnN0cmluZygwLGYubGVuZ3RoLTEpLGs9cGFyc2VJbnQoaiwxMCksbD1wYXJzZUZsb2F0KGopLFgudGVzdChqKSYmXCJ3XCI9PT1pPygoYXx8YykmJihtPSEwKSwwPT09az9tPSEwOmE9ayk6WS50ZXN0KGopJiZcInhcIj09PWk/KChhfHxjfHxkKSYmKG09ITApLDA+bD9tPSEwOmM9bCk6WC50ZXN0KGopJiZcImhcIj09PWk/KChkfHxjKSYmKG09ITApLDA9PT1rP209ITA6ZD1rKTptPSEwO218fChvLnVybD1nLGEmJihvLnc9YSksYyYmKG8uZD1jKSxkJiYoby5oPWQpLGR8fGN8fGF8fChvLmQ9MSksMT09PW8uZCYmKGIuaGFzMXg9ITApLG8uc2V0PWIsbi5wdXNoKG8pKX1mdW5jdGlvbiBmKCl7Zm9yKGMoVCksaT1cIlwiLGo9XCJpbiBkZXNjcmlwdG9yXCI7Oyl7aWYoaz1hLmNoYXJBdChtKSxcImluIGRlc2NyaXB0b3JcIj09PWopaWYoZChrKSlpJiYoaC5wdXNoKGkpLGk9XCJcIixqPVwiYWZ0ZXIgZGVzY3JpcHRvclwiKTtlbHNle2lmKFwiLFwiPT09aylyZXR1cm4gbSs9MSxpJiZoLnB1c2goaSksdm9pZCBlKCk7aWYoXCIoXCI9PT1rKWkrPWssaj1cImluIHBhcmVuc1wiO2Vsc2V7aWYoXCJcIj09PWspcmV0dXJuIGkmJmgucHVzaChpKSx2b2lkIGUoKTtpKz1rfX1lbHNlIGlmKFwiaW4gcGFyZW5zXCI9PT1qKWlmKFwiKVwiPT09aylpKz1rLGo9XCJpbiBkZXNjcmlwdG9yXCI7ZWxzZXtpZihcIlwiPT09aylyZXR1cm4gaC5wdXNoKGkpLHZvaWQgZSgpO2krPWt9ZWxzZSBpZihcImFmdGVyIGRlc2NyaXB0b3JcIj09PWopaWYoZChrKSk7ZWxzZXtpZihcIlwiPT09aylyZXR1cm4gdm9pZCBlKCk7aj1cImluIGRlc2NyaXB0b3JcIixtLT0xfW0rPTF9fWZvcih2YXIgZyxoLGksaixrLGw9YS5sZW5ndGgsbT0wLG49W107Oyl7aWYoYyhVKSxtPj1sKXJldHVybiBuO2c9YyhWKSxoPVtdLFwiLFwiPT09Zy5zbGljZSgtMSk/KGc9Zy5yZXBsYWNlKFcsXCJcIiksZSgpKTpmKCl9fWZ1bmN0aW9uIG4oYSl7ZnVuY3Rpb24gYihhKXtmdW5jdGlvbiBiKCl7ZiYmKGcucHVzaChmKSxmPVwiXCIpfWZ1bmN0aW9uIGMoKXtnWzBdJiYoaC5wdXNoKGcpLGc9W10pfWZvcih2YXIgZSxmPVwiXCIsZz1bXSxoPVtdLGk9MCxqPTAsaz0hMTs7KXtpZihlPWEuY2hhckF0KGopLFwiXCI9PT1lKXJldHVybiBiKCksYygpLGg7aWYoayl7aWYoXCIqXCI9PT1lJiZcIi9cIj09PWFbaisxXSl7az0hMSxqKz0yLGIoKTtjb250aW51ZX1qKz0xfWVsc2V7aWYoZChlKSl7aWYoYS5jaGFyQXQoai0xKSYmZChhLmNoYXJBdChqLTEpKXx8IWYpe2orPTE7Y29udGludWV9aWYoMD09PWkpe2IoKSxqKz0xO2NvbnRpbnVlfWU9XCIgXCJ9ZWxzZSBpZihcIihcIj09PWUpaSs9MTtlbHNlIGlmKFwiKVwiPT09ZSlpLT0xO2Vsc2V7aWYoXCIsXCI9PT1lKXtiKCksYygpLGorPTE7Y29udGludWV9aWYoXCIvXCI9PT1lJiZcIipcIj09PWEuY2hhckF0KGorMSkpe2s9ITAsais9Mjtjb250aW51ZX19Zis9ZSxqKz0xfX19ZnVuY3Rpb24gYyhhKXtyZXR1cm4gay50ZXN0KGEpJiZwYXJzZUZsb2F0KGEpPj0wPyEwOmwudGVzdChhKT8hMDpcIjBcIj09PWF8fFwiLTBcIj09PWF8fFwiKzBcIj09PWE/ITA6ITF9dmFyIGUsZixnLGgsaSxqLGs9L14oPzpbKy1dP1swLTldK3xbMC05XSpcXC5bMC05XSspKD86W2VFXVsrLV0/WzAtOV0rKT8oPzpjaHxjbXxlbXxleHxpbnxtbXxwY3xwdHxweHxyZW18dmh8dm1pbnx2bWF4fHZ3KSQvaSxsPS9eY2FsY1xcKCg/OlswLTlhLXogXFwuXFwrXFwtXFwqXFwvXFwoXFwpXSspXFwpJC9pO2ZvcihmPWIoYSksZz1mLmxlbmd0aCxlPTA7Zz5lO2UrKylpZihoPWZbZV0saT1oW2gubGVuZ3RoLTFdLGMoaSkpe2lmKGo9aSxoLnBvcCgpLDA9PT1oLmxlbmd0aClyZXR1cm4gajtpZihoPWguam9pbihcIiBcIikscy5tYXRjaGVzTWVkaWEoaCkpcmV0dXJuIGp9cmV0dXJuXCIxMDB2d1wifWIuY3JlYXRlRWxlbWVudChcInBpY3R1cmVcIik7dmFyIG8scCxxLHIscz17fSx0PSExLHU9ZnVuY3Rpb24oKXt9LHY9Yi5jcmVhdGVFbGVtZW50KFwiaW1nXCIpLHc9di5nZXRBdHRyaWJ1dGUseD12LnNldEF0dHJpYnV0ZSx5PXYucmVtb3ZlQXR0cmlidXRlLHo9Yi5kb2N1bWVudEVsZW1lbnQsQT17fSxCPXthbGdvcml0aG06XCJcIn0sQz1cImRhdGEtcGZzcmNcIixEPUMrXCJzZXRcIixFPW5hdmlnYXRvci51c2VyQWdlbnQsRj0vcmlkZW50Ly50ZXN0KEUpfHwvZWNrby8udGVzdChFKSYmRS5tYXRjaCgvcnZcXDooXFxkKykvKSYmUmVnRXhwLiQxPjM1LEc9XCJjdXJyZW50U3JjXCIsSD0vXFxzK1xcKz9cXGQrKGVcXGQrKT93LyxJPS8oXFwoW14pXStcXCkpP1xccyooLispLyxKPWEucGljdHVyZWZpbGxDRkcsSz1cInBvc2l0aW9uOmFic29sdXRlO2xlZnQ6MDt2aXNpYmlsaXR5OmhpZGRlbjtkaXNwbGF5OmJsb2NrO3BhZGRpbmc6MDtib3JkZXI6bm9uZTtmb250LXNpemU6MWVtO3dpZHRoOjFlbTtvdmVyZmxvdzpoaWRkZW47Y2xpcDpyZWN0KDBweCwgMHB4LCAwcHgsIDBweClcIixMPVwiZm9udC1zaXplOjEwMCUhaW1wb3J0YW50O1wiLE09ITAsTj17fSxPPXt9LFA9YS5kZXZpY2VQaXhlbFJhdGlvLFE9e3B4OjEsXCJpblwiOjk2fSxSPWIuY3JlYXRlRWxlbWVudChcImFcIiksUz0hMSxUPS9eWyBcXHRcXG5cXHJcXHUwMDBjXSsvLFU9L15bLCBcXHRcXG5cXHJcXHUwMDBjXSsvLFY9L15bXiBcXHRcXG5cXHJcXHUwMDBjXSsvLFc9L1ssXSskLyxYPS9eXFxkKyQvLFk9L14tPyg/OlswLTldK3xbMC05XSpcXC5bMC05XSspKD86W2VFXVsrLV0/WzAtOV0rKT8kLyxaPWZ1bmN0aW9uKGEsYixjLGQpe2EuYWRkRXZlbnRMaXN0ZW5lcj9hLmFkZEV2ZW50TGlzdGVuZXIoYixjLGR8fCExKTphLmF0dGFjaEV2ZW50JiZhLmF0dGFjaEV2ZW50KFwib25cIitiLGMpfSwkPWZ1bmN0aW9uKGEpe3ZhciBiPXt9O3JldHVybiBmdW5jdGlvbihjKXtyZXR1cm4gYyBpbiBifHwoYltjXT1hKGMpKSxiW2NdfX0sXz1mdW5jdGlvbigpe3ZhciBhPS9eKFtcXGRcXC5dKykoZW18dnd8cHgpJC8sYj1mdW5jdGlvbigpe2Zvcih2YXIgYT1hcmd1bWVudHMsYj0wLGM9YVswXTsrK2IgaW4gYTspYz1jLnJlcGxhY2UoYVtiXSxhWysrYl0pO3JldHVybiBjfSxjPSQoZnVuY3Rpb24oYSl7cmV0dXJuXCJyZXR1cm4gXCIrYigoYXx8XCJcIikudG9Mb3dlckNhc2UoKSwvXFxiYW5kXFxiL2csXCImJlwiLC8sL2csXCJ8fFwiLC9taW4tKFthLXotXFxzXSspOi9nLFwiZS4kMT49XCIsL21heC0oW2Etei1cXHNdKyk6L2csXCJlLiQxPD1cIiwvY2FsYyhbXildKykvZyxcIigkMSlcIiwvKFxcZCtbXFwuXSpbXFxkXSopKFthLXpdKykvZyxcIigkMSAqIGUuJDIpXCIsL14oPyEoZS5bYS16XXxbMC05XFwuJj18PjxcXCtcXC1cXCpcXChcXClcXC9dKSkuKi9naSxcIlwiKStcIjtcIn0pO3JldHVybiBmdW5jdGlvbihiLGQpe3ZhciBlO2lmKCEoYiBpbiBOKSlpZihOW2JdPSExLGQmJihlPWIubWF0Y2goYSkpKU5bYl09ZVsxXSpRW2VbMl1dO2Vsc2UgdHJ5e05bYl09bmV3IEZ1bmN0aW9uKFwiZVwiLGMoYikpKFEpfWNhdGNoKGYpe31yZXR1cm4gTltiXX19KCksYWE9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS53PyhhLmNXaWR0aD1zLmNhbGNMaXN0TGVuZ3RoKGJ8fFwiMTAwdndcIiksYS5yZXM9YS53L2EuY1dpZHRoKTphLnJlcz1hLmQsYX0sYmE9ZnVuY3Rpb24oYSl7aWYodCl7dmFyIGMsZCxlLGY9YXx8e307aWYoZi5lbGVtZW50cyYmMT09PWYuZWxlbWVudHMubm9kZVR5cGUmJihcIklNR1wiPT09Zi5lbGVtZW50cy5ub2RlTmFtZS50b1VwcGVyQ2FzZSgpP2YuZWxlbWVudHM9W2YuZWxlbWVudHNdOihmLmNvbnRleHQ9Zi5lbGVtZW50cyxmLmVsZW1lbnRzPW51bGwpKSxjPWYuZWxlbWVudHN8fHMucXNhKGYuY29udGV4dHx8YixmLnJlZXZhbHVhdGV8fGYucmVzZWxlY3Q/cy5zZWw6cy5zZWxTaG9ydCksZT1jLmxlbmd0aCl7Zm9yKHMuc2V0dXBSdW4oZiksUz0hMCxkPTA7ZT5kO2QrKylzLmZpbGxJbWcoY1tkXSxmKTtzLnRlYXJkb3duUnVuKGYpfX19O289YS5jb25zb2xlJiZjb25zb2xlLndhcm4/ZnVuY3Rpb24oYSl7Y29uc29sZS53YXJuKGEpfTp1LEcgaW4gdnx8KEc9XCJzcmNcIiksQVtcImltYWdlL2pwZWdcIl09ITAsQVtcImltYWdlL2dpZlwiXT0hMCxBW1wiaW1hZ2UvcG5nXCJdPSEwLEFbXCJpbWFnZS9zdmcreG1sXCJdPWIuaW1wbGVtZW50YXRpb24uaGFzRmVhdHVyZShcImh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjSW1hZ2VcIixcIjEuMVwiKSxzLm5zPShcInBmXCIrKG5ldyBEYXRlKS5nZXRUaW1lKCkpLnN1YnN0cigwLDkpLHMuc3VwU3Jjc2V0PVwic3Jjc2V0XCJpbiB2LHMuc3VwU2l6ZXM9XCJzaXplc1wiaW4gdixzLnN1cFBpY3R1cmU9ISFhLkhUTUxQaWN0dXJlRWxlbWVudCxzLnN1cFNyY3NldCYmcy5zdXBQaWN0dXJlJiYhcy5zdXBTaXplcyYmIWZ1bmN0aW9uKGEpe3Yuc3Jjc2V0PVwiZGF0YTosYVwiLGEuc3JjPVwiZGF0YTosYVwiLHMuc3VwU3Jjc2V0PXYuY29tcGxldGU9PT1hLmNvbXBsZXRlLHMuc3VwUGljdHVyZT1zLnN1cFNyY3NldCYmcy5zdXBQaWN0dXJlfShiLmNyZWF0ZUVsZW1lbnQoXCJpbWdcIikpLHMuc3VwU3Jjc2V0JiYhcy5zdXBTaXplcz8hZnVuY3Rpb24oKXt2YXIgYT1cImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFnQUJBUEFBQVAvLy93QUFBQ0g1QkFBQUFBQUFMQUFBQUFBQ0FBRUFBQUlDQkFvQU93PT1cIixjPVwiZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoQVFBQkFBQUFBQ0g1QkFFS0FBRUFMQUFBQUFBQkFBRUFBQUlDVEFFQU93PT1cIixkPWIuY3JlYXRlRWxlbWVudChcImltZ1wiKSxlPWZ1bmN0aW9uKCl7dmFyIGE9ZC53aWR0aDsyPT09YSYmKHMuc3VwU2l6ZXM9ITApLHE9cy5zdXBTcmNzZXQmJiFzLnN1cFNpemVzLHQ9ITAsc2V0VGltZW91dChiYSl9O2Qub25sb2FkPWUsZC5vbmVycm9yPWUsZC5zZXRBdHRyaWJ1dGUoXCJzaXplc1wiLFwiOXB4XCIpLGQuc3Jjc2V0PWMrXCIgMXcsXCIrYStcIiA5d1wiLGQuc3JjPWN9KCk6dD0hMCxzLnNlbFNob3J0PVwicGljdHVyZT5pbWcsaW1nW3NyY3NldF1cIixzLnNlbD1zLnNlbFNob3J0LHMuY2ZnPUIscy5EUFI9UHx8MSxzLnU9USxzLnR5cGVzPUEscy5zZXRTaXplPXUscy5tYWtlVXJsPSQoZnVuY3Rpb24oYSl7cmV0dXJuIFIuaHJlZj1hLFIuaHJlZn0pLHMucXNhPWZ1bmN0aW9uKGEsYil7cmV0dXJuXCJxdWVyeVNlbGVjdG9yXCJpbiBhP2EucXVlcnlTZWxlY3RvckFsbChiKTpbXX0scy5tYXRjaGVzTWVkaWE9ZnVuY3Rpb24oKXtyZXR1cm4gYS5tYXRjaE1lZGlhJiYobWF0Y2hNZWRpYShcIihtaW4td2lkdGg6IDAuMWVtKVwiKXx8e30pLm1hdGNoZXM/cy5tYXRjaGVzTWVkaWE9ZnVuY3Rpb24oYSl7cmV0dXJuIWF8fG1hdGNoTWVkaWEoYSkubWF0Y2hlc306cy5tYXRjaGVzTWVkaWE9cy5tTVEscy5tYXRjaGVzTWVkaWEuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxzLm1NUT1mdW5jdGlvbihhKXtyZXR1cm4gYT9fKGEpOiEwfSxzLmNhbGNMZW5ndGg9ZnVuY3Rpb24oYSl7dmFyIGI9XyhhLCEwKXx8ITE7cmV0dXJuIDA+YiYmKGI9ITEpLGJ9LHMuc3VwcG9ydHNUeXBlPWZ1bmN0aW9uKGEpe3JldHVybiBhP0FbYV06ITB9LHMucGFyc2VTaXplPSQoZnVuY3Rpb24oYSl7dmFyIGI9KGF8fFwiXCIpLm1hdGNoKEkpO3JldHVybnttZWRpYTpiJiZiWzFdLGxlbmd0aDpiJiZiWzJdfX0pLHMucGFyc2VTZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIGEuY2FuZHN8fChhLmNhbmRzPW0oYS5zcmNzZXQsYSkpLGEuY2FuZHN9LHMuZ2V0RW1WYWx1ZT1mdW5jdGlvbigpe3ZhciBhO2lmKCFwJiYoYT1iLmJvZHkpKXt2YXIgYz1iLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksZD16LnN0eWxlLmNzc1RleHQsZT1hLnN0eWxlLmNzc1RleHQ7Yy5zdHlsZS5jc3NUZXh0PUssei5zdHlsZS5jc3NUZXh0PUwsYS5zdHlsZS5jc3NUZXh0PUwsYS5hcHBlbmRDaGlsZChjKSxwPWMub2Zmc2V0V2lkdGgsYS5yZW1vdmVDaGlsZChjKSxwPXBhcnNlRmxvYXQocCwxMCksei5zdHlsZS5jc3NUZXh0PWQsYS5zdHlsZS5jc3NUZXh0PWV9cmV0dXJuIHB8fDE2fSxzLmNhbGNMaXN0TGVuZ3RoPWZ1bmN0aW9uKGEpe2lmKCEoYSBpbiBPKXx8Qi51VCl7dmFyIGI9cy5jYWxjTGVuZ3RoKG4oYSkpO09bYV09Yj9iOlEud2lkdGh9cmV0dXJuIE9bYV19LHMuc2V0UmVzPWZ1bmN0aW9uKGEpe3ZhciBiO2lmKGEpe2I9cy5wYXJzZVNldChhKTtmb3IodmFyIGM9MCxkPWIubGVuZ3RoO2Q+YztjKyspYWEoYltjXSxhLnNpemVzKX1yZXR1cm4gYn0scy5zZXRSZXMucmVzPWFhLHMuYXBwbHlTZXRDYW5kaWRhdGU9ZnVuY3Rpb24oYSxiKXtpZihhLmxlbmd0aCl7dmFyIGMsZCxlLGYsaCxrLGwsbSxuLG89YltzLm5zXSxwPXMuRFBSO2lmKGs9by5jdXJTcmN8fGJbR10sbD1vLmN1ckNhbnx8aihiLGssYVswXS5zZXQpLGwmJmwuc2V0PT09YVswXS5zZXQmJihuPUYmJiFiLmNvbXBsZXRlJiZsLnJlcy0uMT5wLG58fChsLmNhY2hlZD0hMCxsLnJlcz49cCYmKGg9bCkpKSwhaClmb3IoYS5zb3J0KGkpLGY9YS5sZW5ndGgsaD1hW2YtMV0sZD0wO2Y+ZDtkKyspaWYoYz1hW2RdLGMucmVzPj1wKXtlPWQtMSxoPWFbZV0mJihufHxrIT09cy5tYWtlVXJsKGMudXJsKSkmJmcoYVtlXS5yZXMsYy5yZXMscCxhW2VdLmNhY2hlZCk/YVtlXTpjO2JyZWFrfWgmJihtPXMubWFrZVVybChoLnVybCksby5jdXJTcmM9bSxvLmN1ckNhbj1oLG0hPT1rJiZzLnNldFNyYyhiLGgpLHMuc2V0U2l6ZShiKSl9fSxzLnNldFNyYz1mdW5jdGlvbihhLGIpe3ZhciBjO2Euc3JjPWIudXJsLFwiaW1hZ2Uvc3ZnK3htbFwiPT09Yi5zZXQudHlwZSYmKGM9YS5zdHlsZS53aWR0aCxhLnN0eWxlLndpZHRoPWEub2Zmc2V0V2lkdGgrMStcInB4XCIsYS5vZmZzZXRXaWR0aCsxJiYoYS5zdHlsZS53aWR0aD1jKSl9LHMuZ2V0U2V0PWZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlPSExLGY9YVtzLm5zXS5zZXRzO2ZvcihiPTA7YjxmLmxlbmd0aCYmIWU7YisrKWlmKGM9ZltiXSxjLnNyY3NldCYmcy5tYXRjaGVzTWVkaWEoYy5tZWRpYSkmJihkPXMuc3VwcG9ydHNUeXBlKGMudHlwZSkpKXtcInBlbmRpbmdcIj09PWQmJihjPWQpLGU9YzticmVha31yZXR1cm4gZX0scy5wYXJzZVNldHM9ZnVuY3Rpb24oYSxiLGQpe3ZhciBlLGYsZyxoLGk9YiYmXCJQSUNUVVJFXCI9PT1iLm5vZGVOYW1lLnRvVXBwZXJDYXNlKCksaj1hW3MubnNdOyhqLnNyYz09PWN8fGQuc3JjKSYmKGouc3JjPXcuY2FsbChhLFwic3JjXCIpLGouc3JjP3guY2FsbChhLEMsai5zcmMpOnkuY2FsbChhLEMpKSwoai5zcmNzZXQ9PT1jfHxkLnNyY3NldHx8IXMuc3VwU3Jjc2V0fHxhLnNyY3NldCkmJihlPXcuY2FsbChhLFwic3Jjc2V0XCIpLGouc3Jjc2V0PWUsaD0hMCksai5zZXRzPVtdLGkmJihqLnBpYz0hMCxsKGIsai5zZXRzKSksai5zcmNzZXQ/KGY9e3NyY3NldDpqLnNyY3NldCxzaXplczp3LmNhbGwoYSxcInNpemVzXCIpfSxqLnNldHMucHVzaChmKSxnPShxfHxqLnNyYykmJkgudGVzdChqLnNyY3NldHx8XCJcIiksZ3x8IWouc3JjfHxrKGouc3JjLGYpfHxmLmhhczF4fHwoZi5zcmNzZXQrPVwiLCBcIitqLnNyYyxmLmNhbmRzLnB1c2goe3VybDpqLnNyYyxkOjEsc2V0OmZ9KSkpOmouc3JjJiZqLnNldHMucHVzaCh7c3Jjc2V0Omouc3JjLHNpemVzOm51bGx9KSxqLmN1ckNhbj1udWxsLGouY3VyU3JjPWMsai5zdXBwb3J0ZWQ9IShpfHxmJiYhcy5zdXBTcmNzZXR8fGcmJiFzLnN1cFNpemVzKSxoJiZzLnN1cFNyY3NldCYmIWouc3VwcG9ydGVkJiYoZT8oeC5jYWxsKGEsRCxlKSxhLnNyY3NldD1cIlwiKTp5LmNhbGwoYSxEKSksai5zdXBwb3J0ZWQmJiFqLnNyY3NldCYmKCFqLnNyYyYmYS5zcmN8fGEuc3JjIT09cy5tYWtlVXJsKGouc3JjKSkmJihudWxsPT09ai5zcmM/YS5yZW1vdmVBdHRyaWJ1dGUoXCJzcmNcIik6YS5zcmM9ai5zcmMpLGoucGFyc2VkPSEwfSxzLmZpbGxJbWc9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPWIucmVzZWxlY3R8fGIucmVldmFsdWF0ZTthW3MubnNdfHwoYVtzLm5zXT17fSksYz1hW3MubnNdLChkfHxjLmV2YWxlZCE9PXIpJiYoKCFjLnBhcnNlZHx8Yi5yZWV2YWx1YXRlKSYmcy5wYXJzZVNldHMoYSxhLnBhcmVudE5vZGUsYiksYy5zdXBwb3J0ZWQ/Yy5ldmFsZWQ9cjpoKGEpKX0scy5zZXR1cFJ1bj1mdW5jdGlvbigpeyghU3x8TXx8UCE9PWEuZGV2aWNlUGl4ZWxSYXRpbykmJmYoKX0scy5zdXBQaWN0dXJlPyhiYT11LHMuZmlsbEltZz11KTohZnVuY3Rpb24oKXt2YXIgYyxkPWEuYXR0YWNoRXZlbnQ/L2QkfF5jLzovZCR8XmN8XmkvLGU9ZnVuY3Rpb24oKXt2YXIgYT1iLnJlYWR5U3RhdGV8fFwiXCI7Zj1zZXRUaW1lb3V0KGUsXCJsb2FkaW5nXCI9PT1hPzIwMDo5OTkpLGIuYm9keSYmKHMuZmlsbEltZ3MoKSxjPWN8fGQudGVzdChhKSxjJiZjbGVhclRpbWVvdXQoZikpfSxmPXNldFRpbWVvdXQoZSxiLmJvZHk/OTo5OSksZz1mdW5jdGlvbihhLGIpe3ZhciBjLGQsZT1mdW5jdGlvbigpe3ZhciBmPW5ldyBEYXRlLWQ7Yj5mP2M9c2V0VGltZW91dChlLGItZik6KGM9bnVsbCxhKCkpfTtyZXR1cm4gZnVuY3Rpb24oKXtkPW5ldyBEYXRlLGN8fChjPXNldFRpbWVvdXQoZSxiKSl9fSxoPXouY2xpZW50SGVpZ2h0LGk9ZnVuY3Rpb24oKXtNPU1hdGgubWF4KGEuaW5uZXJXaWR0aHx8MCx6LmNsaWVudFdpZHRoKSE9PVEud2lkdGh8fHouY2xpZW50SGVpZ2h0IT09aCxoPXouY2xpZW50SGVpZ2h0LE0mJnMuZmlsbEltZ3MoKX07WihhLFwicmVzaXplXCIsZyhpLDk5KSksWihiLFwicmVhZHlzdGF0ZWNoYW5nZVwiLGUpfSgpLHMucGljdHVyZWZpbGw9YmEscy5maWxsSW1ncz1iYSxzLnRlYXJkb3duUnVuPXUsYmEuXz1zLGEucGljdHVyZWZpbGxDRkc9e3BmOnMscHVzaDpmdW5jdGlvbihhKXt2YXIgYj1hLnNoaWZ0KCk7XCJmdW5jdGlvblwiPT10eXBlb2Ygc1tiXT9zW2JdLmFwcGx5KHMsYSk6KEJbYl09YVswXSxTJiZzLmZpbGxJbWdzKHtyZXNlbGVjdDohMH0pKX19O2Zvcig7SiYmSi5sZW5ndGg7KWEucGljdHVyZWZpbGxDRkcucHVzaChKLnNoaWZ0KCkpO2EucGljdHVyZWZpbGw9YmEsXCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZSYmXCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWJhOlwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZCYmZGVmaW5lKFwicGljdHVyZWZpbGxcIixmdW5jdGlvbigpe3JldHVybiBiYX0pLHMuc3VwUGljdHVyZXx8KEFbXCJpbWFnZS93ZWJwXCJdPWUoXCJpbWFnZS93ZWJwXCIsXCJkYXRhOmltYWdlL3dlYnA7YmFzZTY0LFVrbEdSa29BQUFCWFJVSlFWbEE0V0FvQUFBQVFBQUFBQUFBQUFBQUFRVXhRU0F3QUFBQUJCeEFSL1E5RVJQOERBQUJXVURnZ0dBQUFBREFCQUowQktnRUFBUUFEQURRbHBBQURjQUQrKy8xUUFBPT1cIikpfSh3aW5kb3csZG9jdW1lbnQpO1xuIiwiLyohXG4gKiBQaWthZGF5XG4gKlxuICogQ29weXJpZ2h0IMKpIDIwMTQgRGF2aWQgQnVzaGVsbCB8IEJTRCAmIE1JVCBsaWNlbnNlIHwgaHR0cHM6Ly9naXRodWIuY29tL2RidXNoZWxsL1Bpa2FkYXlcbiAqL1xuXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpXG57XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIG1vbWVudDtcbiAgICBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIC8vIENvbW1vbkpTIG1vZHVsZVxuICAgICAgICAvLyBMb2FkIG1vbWVudC5qcyBhcyBhbiBvcHRpb25hbCBkZXBlbmRlbmN5XG4gICAgICAgIHRyeSB7IG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpOyB9IGNhdGNoIChlKSB7fVxuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkobW9tZW50KTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG4gICAgICAgIGRlZmluZShmdW5jdGlvbiAocmVxKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBMb2FkIG1vbWVudC5qcyBhcyBhbiBvcHRpb25hbCBkZXBlbmRlbmN5XG4gICAgICAgICAgICB2YXIgaWQgPSAnbW9tZW50JztcbiAgICAgICAgICAgIHRyeSB7IG1vbWVudCA9IHJlcShpZCk7IH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgICAgICByZXR1cm4gZmFjdG9yeShtb21lbnQpO1xuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByb290LlBpa2FkYXkgPSBmYWN0b3J5KHJvb3QubW9tZW50KTtcbiAgICB9XG59KHRoaXMsIGZ1bmN0aW9uIChtb21lbnQpXG57XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLyoqXG4gICAgICogZmVhdHVyZSBkZXRlY3Rpb24gYW5kIGhlbHBlciBmdW5jdGlvbnNcbiAgICAgKi9cbiAgICB2YXIgaGFzTW9tZW50ID0gdHlwZW9mIG1vbWVudCA9PT0gJ2Z1bmN0aW9uJyxcblxuICAgIGhhc0V2ZW50TGlzdGVuZXJzID0gISF3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcixcblxuICAgIGRvY3VtZW50ID0gd2luZG93LmRvY3VtZW50LFxuXG4gICAgc3RvID0gd2luZG93LnNldFRpbWVvdXQsXG5cbiAgICBhZGRFdmVudCA9IGZ1bmN0aW9uKGVsLCBlLCBjYWxsYmFjaywgY2FwdHVyZSlcbiAgICB7XG4gICAgICAgIGlmIChoYXNFdmVudExpc3RlbmVycykge1xuICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihlLCBjYWxsYmFjaywgISFjYXB0dXJlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVsLmF0dGFjaEV2ZW50KCdvbicgKyBlLCBjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVtb3ZlRXZlbnQgPSBmdW5jdGlvbihlbCwgZSwgY2FsbGJhY2ssIGNhcHR1cmUpXG4gICAge1xuICAgICAgICBpZiAoaGFzRXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZSwgY2FsbGJhY2ssICEhY2FwdHVyZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbC5kZXRhY2hFdmVudCgnb24nICsgZSwgY2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHRyaW0gPSBmdW5jdGlvbihzdHIpXG4gICAge1xuICAgICAgICByZXR1cm4gc3RyLnRyaW0gPyBzdHIudHJpbSgpIDogc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csJycpO1xuICAgIH0sXG5cbiAgICBoYXNDbGFzcyA9IGZ1bmN0aW9uKGVsLCBjbilcbiAgICB7XG4gICAgICAgIHJldHVybiAoJyAnICsgZWwuY2xhc3NOYW1lICsgJyAnKS5pbmRleE9mKCcgJyArIGNuICsgJyAnKSAhPT0gLTE7XG4gICAgfSxcblxuICAgIGFkZENsYXNzID0gZnVuY3Rpb24oZWwsIGNuKVxuICAgIHtcbiAgICAgICAgaWYgKCFoYXNDbGFzcyhlbCwgY24pKSB7XG4gICAgICAgICAgICBlbC5jbGFzc05hbWUgPSAoZWwuY2xhc3NOYW1lID09PSAnJykgPyBjbiA6IGVsLmNsYXNzTmFtZSArICcgJyArIGNuO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJlbW92ZUNsYXNzID0gZnVuY3Rpb24oZWwsIGNuKVxuICAgIHtcbiAgICAgICAgZWwuY2xhc3NOYW1lID0gdHJpbSgoJyAnICsgZWwuY2xhc3NOYW1lICsgJyAnKS5yZXBsYWNlKCcgJyArIGNuICsgJyAnLCAnICcpKTtcbiAgICB9LFxuXG4gICAgaXNBcnJheSA9IGZ1bmN0aW9uKG9iailcbiAgICB7XG4gICAgICAgIHJldHVybiAoL0FycmF5LykudGVzdChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSk7XG4gICAgfSxcblxuICAgIGlzRGF0ZSA9IGZ1bmN0aW9uKG9iailcbiAgICB7XG4gICAgICAgIHJldHVybiAoL0RhdGUvKS50ZXN0KE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopKSAmJiAhaXNOYU4ob2JqLmdldFRpbWUoKSk7XG4gICAgfSxcblxuICAgIGlzV2Vla2VuZCA9IGZ1bmN0aW9uKGRhdGUpXG4gICAge1xuICAgICAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXkoKTtcbiAgICAgICAgcmV0dXJuIGRheSA9PT0gMCB8fCBkYXkgPT09IDY7XG4gICAgfSxcblxuICAgIGlzTGVhcFllYXIgPSBmdW5jdGlvbih5ZWFyKVxuICAgIHtcbiAgICAgICAgLy8gc29sdXRpb24gYnkgTWF0dGkgVmlya2t1bmVuOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS80ODgxOTUxXG4gICAgICAgIHJldHVybiB5ZWFyICUgNCA9PT0gMCAmJiB5ZWFyICUgMTAwICE9PSAwIHx8IHllYXIgJSA0MDAgPT09IDA7XG4gICAgfSxcblxuICAgIGdldERheXNJbk1vbnRoID0gZnVuY3Rpb24oeWVhciwgbW9udGgpXG4gICAge1xuICAgICAgICByZXR1cm4gWzMxLCBpc0xlYXBZZWFyKHllYXIpID8gMjkgOiAyOCwgMzEsIDMwLCAzMSwgMzAsIDMxLCAzMSwgMzAsIDMxLCAzMCwgMzFdW21vbnRoXTtcbiAgICB9LFxuXG4gICAgc2V0VG9TdGFydE9mRGF5ID0gZnVuY3Rpb24oZGF0ZSlcbiAgICB7XG4gICAgICAgIGlmIChpc0RhdGUoZGF0ZSkpIGRhdGUuc2V0SG91cnMoMCwwLDAsMCk7XG4gICAgfSxcblxuICAgIGNvbXBhcmVEYXRlcyA9IGZ1bmN0aW9uKGEsYilcbiAgICB7XG4gICAgICAgIC8vIHdlYWsgZGF0ZSBjb21wYXJpc29uICh1c2Ugc2V0VG9TdGFydE9mRGF5KGRhdGUpIHRvIGVuc3VyZSBjb3JyZWN0IHJlc3VsdClcbiAgICAgICAgcmV0dXJuIGEuZ2V0VGltZSgpID09PSBiLmdldFRpbWUoKTtcbiAgICB9LFxuXG4gICAgZXh0ZW5kID0gZnVuY3Rpb24odG8sIGZyb20sIG92ZXJ3cml0ZSlcbiAgICB7XG4gICAgICAgIHZhciBwcm9wLCBoYXNQcm9wO1xuICAgICAgICBmb3IgKHByb3AgaW4gZnJvbSkge1xuICAgICAgICAgICAgaGFzUHJvcCA9IHRvW3Byb3BdICE9PSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAoaGFzUHJvcCAmJiB0eXBlb2YgZnJvbVtwcm9wXSA9PT0gJ29iamVjdCcgJiYgZnJvbVtwcm9wXSAhPT0gbnVsbCAmJiBmcm9tW3Byb3BdLm5vZGVOYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNEYXRlKGZyb21bcHJvcF0pKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvdmVyd3JpdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvW3Byb3BdID0gbmV3IERhdGUoZnJvbVtwcm9wXS5nZXRUaW1lKCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlzQXJyYXkoZnJvbVtwcm9wXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG92ZXJ3cml0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9bcHJvcF0gPSBmcm9tW3Byb3BdLnNsaWNlKDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdG9bcHJvcF0gPSBleHRlbmQoe30sIGZyb21bcHJvcF0sIG92ZXJ3cml0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChvdmVyd3JpdGUgfHwgIWhhc1Byb3ApIHtcbiAgICAgICAgICAgICAgICB0b1twcm9wXSA9IGZyb21bcHJvcF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvO1xuICAgIH0sXG5cbiAgICBmaXJlRXZlbnQgPSBmdW5jdGlvbihlbCwgZXZlbnROYW1lLCBkYXRhKVxuICAgIHtcbiAgICAgICAgdmFyIGV2O1xuXG4gICAgICAgIGlmIChkb2N1bWVudC5jcmVhdGVFdmVudCkge1xuICAgICAgICAgICAgZXYgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnSFRNTEV2ZW50cycpO1xuICAgICAgICAgICAgZXYuaW5pdEV2ZW50KGV2ZW50TmFtZSwgdHJ1ZSwgZmFsc2UpO1xuICAgICAgICAgICAgZXYgPSBleHRlbmQoZXYsIGRhdGEpO1xuICAgICAgICAgICAgZWwuZGlzcGF0Y2hFdmVudChldik7XG4gICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QpIHtcbiAgICAgICAgICAgIGV2ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTtcbiAgICAgICAgICAgIGV2ID0gZXh0ZW5kKGV2LCBkYXRhKTtcbiAgICAgICAgICAgIGVsLmZpcmVFdmVudCgnb24nICsgZXZlbnROYW1lLCBldik7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgYWRqdXN0Q2FsZW5kYXIgPSBmdW5jdGlvbihjYWxlbmRhcikge1xuICAgICAgICBpZiAoY2FsZW5kYXIubW9udGggPCAwKSB7XG4gICAgICAgICAgICBjYWxlbmRhci55ZWFyIC09IE1hdGguY2VpbChNYXRoLmFicyhjYWxlbmRhci5tb250aCkvMTIpO1xuICAgICAgICAgICAgY2FsZW5kYXIubW9udGggKz0gMTI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhbGVuZGFyLm1vbnRoID4gMTEpIHtcbiAgICAgICAgICAgIGNhbGVuZGFyLnllYXIgKz0gTWF0aC5mbG9vcihNYXRoLmFicyhjYWxlbmRhci5tb250aCkvMTIpO1xuICAgICAgICAgICAgY2FsZW5kYXIubW9udGggLT0gMTI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhbGVuZGFyO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBkZWZhdWx0cyBhbmQgbG9jYWxpc2F0aW9uXG4gICAgICovXG4gICAgZGVmYXVsdHMgPSB7XG5cbiAgICAgICAgLy8gYmluZCB0aGUgcGlja2VyIHRvIGEgZm9ybSBmaWVsZFxuICAgICAgICBmaWVsZDogbnVsbCxcblxuICAgICAgICAvLyBhdXRvbWF0aWNhbGx5IHNob3cvaGlkZSB0aGUgcGlja2VyIG9uIGBmaWVsZGAgZm9jdXMgKGRlZmF1bHQgYHRydWVgIGlmIGBmaWVsZGAgaXMgc2V0KVxuICAgICAgICBib3VuZDogdW5kZWZpbmVkLFxuXG4gICAgICAgIC8vIHBvc2l0aW9uIG9mIHRoZSBkYXRlcGlja2VyLCByZWxhdGl2ZSB0byB0aGUgZmllbGQgKGRlZmF1bHQgdG8gYm90dG9tICYgbGVmdClcbiAgICAgICAgLy8gKCdib3R0b20nICYgJ2xlZnQnIGtleXdvcmRzIGFyZSBub3QgdXNlZCwgJ3RvcCcgJiAncmlnaHQnIGFyZSBtb2RpZmllciBvbiB0aGUgYm90dG9tL2xlZnQgcG9zaXRpb24pXG4gICAgICAgIHBvc2l0aW9uOiAnYm90dG9tIGxlZnQnLFxuXG4gICAgICAgIC8vIGF1dG9tYXRpY2FsbHkgZml0IGluIHRoZSB2aWV3cG9ydCBldmVuIGlmIGl0IG1lYW5zIHJlcG9zaXRpb25pbmcgZnJvbSB0aGUgcG9zaXRpb24gb3B0aW9uXG4gICAgICAgIHJlcG9zaXRpb246IHRydWUsXG5cbiAgICAgICAgLy8gdGhlIGRlZmF1bHQgb3V0cHV0IGZvcm1hdCBmb3IgYC50b1N0cmluZygpYCBhbmQgYGZpZWxkYCB2YWx1ZVxuICAgICAgICBmb3JtYXQ6ICdZWVlZLU1NLUREJyxcblxuICAgICAgICAvLyB0aGUgdG9TdHJpbmcgZnVuY3Rpb24gd2hpY2ggZ2V0cyBwYXNzZWQgYSBjdXJyZW50IGRhdGUgb2JqZWN0IGFuZCBmb3JtYXRcbiAgICAgICAgLy8gYW5kIHJldHVybnMgYSBzdHJpbmdcbiAgICAgICAgdG9TdHJpbmc6IG51bGwsXG5cbiAgICAgICAgLy8gdXNlZCB0byBjcmVhdGUgZGF0ZSBvYmplY3QgZnJvbSBjdXJyZW50IGlucHV0IHN0cmluZ1xuICAgICAgICBwYXJzZTogbnVsbCxcblxuICAgICAgICAvLyB0aGUgaW5pdGlhbCBkYXRlIHRvIHZpZXcgd2hlbiBmaXJzdCBvcGVuZWRcbiAgICAgICAgZGVmYXVsdERhdGU6IG51bGwsXG5cbiAgICAgICAgLy8gbWFrZSB0aGUgYGRlZmF1bHREYXRlYCB0aGUgaW5pdGlhbCBzZWxlY3RlZCB2YWx1ZVxuICAgICAgICBzZXREZWZhdWx0RGF0ZTogZmFsc2UsXG5cbiAgICAgICAgLy8gZmlyc3QgZGF5IG9mIHdlZWsgKDA6IFN1bmRheSwgMTogTW9uZGF5IGV0YylcbiAgICAgICAgZmlyc3REYXk6IDAsXG5cbiAgICAgICAgLy8gdGhlIGRlZmF1bHQgZmxhZyBmb3IgbW9tZW50J3Mgc3RyaWN0IGRhdGUgcGFyc2luZ1xuICAgICAgICBmb3JtYXRTdHJpY3Q6IGZhbHNlLFxuXG4gICAgICAgIC8vIHRoZSBtaW5pbXVtL2VhcmxpZXN0IGRhdGUgdGhhdCBjYW4gYmUgc2VsZWN0ZWRcbiAgICAgICAgbWluRGF0ZTogbnVsbCxcbiAgICAgICAgLy8gdGhlIG1heGltdW0vbGF0ZXN0IGRhdGUgdGhhdCBjYW4gYmUgc2VsZWN0ZWRcbiAgICAgICAgbWF4RGF0ZTogbnVsbCxcblxuICAgICAgICAvLyBudW1iZXIgb2YgeWVhcnMgZWl0aGVyIHNpZGUsIG9yIGFycmF5IG9mIHVwcGVyL2xvd2VyIHJhbmdlXG4gICAgICAgIHllYXJSYW5nZTogMTAsXG5cbiAgICAgICAgLy8gc2hvdyB3ZWVrIG51bWJlcnMgYXQgaGVhZCBvZiByb3dcbiAgICAgICAgc2hvd1dlZWtOdW1iZXI6IGZhbHNlLFxuXG4gICAgICAgIC8vIFdlZWsgcGlja2VyIG1vZGVcbiAgICAgICAgcGlja1dob2xlV2VlazogZmFsc2UsXG5cbiAgICAgICAgLy8gdXNlZCBpbnRlcm5hbGx5IChkb24ndCBjb25maWcgb3V0c2lkZSlcbiAgICAgICAgbWluWWVhcjogMCxcbiAgICAgICAgbWF4WWVhcjogOTk5OSxcbiAgICAgICAgbWluTW9udGg6IHVuZGVmaW5lZCxcbiAgICAgICAgbWF4TW9udGg6IHVuZGVmaW5lZCxcblxuICAgICAgICBzdGFydFJhbmdlOiBudWxsLFxuICAgICAgICBlbmRSYW5nZTogbnVsbCxcblxuICAgICAgICBpc1JUTDogZmFsc2UsXG5cbiAgICAgICAgLy8gQWRkaXRpb25hbCB0ZXh0IHRvIGFwcGVuZCB0byB0aGUgeWVhciBpbiB0aGUgY2FsZW5kYXIgdGl0bGVcbiAgICAgICAgeWVhclN1ZmZpeDogJycsXG5cbiAgICAgICAgLy8gUmVuZGVyIHRoZSBtb250aCBhZnRlciB5ZWFyIGluIHRoZSBjYWxlbmRhciB0aXRsZVxuICAgICAgICBzaG93TW9udGhBZnRlclllYXI6IGZhbHNlLFxuXG4gICAgICAgIC8vIFJlbmRlciBkYXlzIG9mIHRoZSBjYWxlbmRhciBncmlkIHRoYXQgZmFsbCBpbiB0aGUgbmV4dCBvciBwcmV2aW91cyBtb250aFxuICAgICAgICBzaG93RGF5c0luTmV4dEFuZFByZXZpb3VzTW9udGhzOiBmYWxzZSxcblxuICAgICAgICAvLyBob3cgbWFueSBtb250aHMgYXJlIHZpc2libGVcbiAgICAgICAgbnVtYmVyT2ZNb250aHM6IDEsXG5cbiAgICAgICAgLy8gd2hlbiBudW1iZXJPZk1vbnRocyBpcyB1c2VkLCB0aGlzIHdpbGwgaGVscCB5b3UgdG8gY2hvb3NlIHdoZXJlIHRoZSBtYWluIGNhbGVuZGFyIHdpbGwgYmUgKGRlZmF1bHQgYGxlZnRgLCBjYW4gYmUgc2V0IHRvIGByaWdodGApXG4gICAgICAgIC8vIG9ubHkgdXNlZCBmb3IgdGhlIGZpcnN0IGRpc3BsYXkgb3Igd2hlbiBhIHNlbGVjdGVkIGRhdGUgaXMgbm90IHZpc2libGVcbiAgICAgICAgbWFpbkNhbGVuZGFyOiAnbGVmdCcsXG5cbiAgICAgICAgLy8gU3BlY2lmeSBhIERPTSBlbGVtZW50IHRvIHJlbmRlciB0aGUgY2FsZW5kYXIgaW5cbiAgICAgICAgY29udGFpbmVyOiB1bmRlZmluZWQsXG5cbiAgICAgICAgLy8gQmx1ciBmaWVsZCB3aGVuIGRhdGUgaXMgc2VsZWN0ZWRcbiAgICAgICAgYmx1ckZpZWxkT25TZWxlY3QgOiB0cnVlLFxuXG4gICAgICAgIC8vIGludGVybmF0aW9uYWxpemF0aW9uXG4gICAgICAgIGkxOG46IHtcbiAgICAgICAgICAgIHByZXZpb3VzTW9udGggOiAnUHJldmlvdXMgTW9udGgnLFxuICAgICAgICAgICAgbmV4dE1vbnRoICAgICA6ICdOZXh0IE1vbnRoJyxcbiAgICAgICAgICAgIG1vbnRocyAgICAgICAgOiBbJ0phbnVhcnknLCdGZWJydWFyeScsJ01hcmNoJywnQXByaWwnLCdNYXknLCdKdW5lJywnSnVseScsJ0F1Z3VzdCcsJ1NlcHRlbWJlcicsJ09jdG9iZXInLCdOb3ZlbWJlcicsJ0RlY2VtYmVyJ10sXG4gICAgICAgICAgICB3ZWVrZGF5cyAgICAgIDogWydTdW5kYXknLCdNb25kYXknLCdUdWVzZGF5JywnV2VkbmVzZGF5JywnVGh1cnNkYXknLCdGcmlkYXknLCdTYXR1cmRheSddLFxuICAgICAgICAgICAgd2Vla2RheXNTaG9ydCA6IFsnU3VuJywnTW9uJywnVHVlJywnV2VkJywnVGh1JywnRnJpJywnU2F0J11cbiAgICAgICAgfSxcblxuICAgICAgICAvLyBUaGVtZSBDbGFzc25hbWVcbiAgICAgICAgdGhlbWU6IG51bGwsXG5cbiAgICAgICAgLy8gZXZlbnRzIGFycmF5XG4gICAgICAgIGV2ZW50czogW10sXG5cbiAgICAgICAgLy8gY2FsbGJhY2sgZnVuY3Rpb25cbiAgICAgICAgb25TZWxlY3Q6IG51bGwsXG4gICAgICAgIG9uT3BlbjogbnVsbCxcbiAgICAgICAgb25DbG9zZTogbnVsbCxcbiAgICAgICAgb25EcmF3OiBudWxsXG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICogdGVtcGxhdGluZyBmdW5jdGlvbnMgdG8gYWJzdHJhY3QgSFRNTCByZW5kZXJpbmdcbiAgICAgKi9cbiAgICByZW5kZXJEYXlOYW1lID0gZnVuY3Rpb24ob3B0cywgZGF5LCBhYmJyKVxuICAgIHtcbiAgICAgICAgZGF5ICs9IG9wdHMuZmlyc3REYXk7XG4gICAgICAgIHdoaWxlIChkYXkgPj0gNykge1xuICAgICAgICAgICAgZGF5IC09IDc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFiYnIgPyBvcHRzLmkxOG4ud2Vla2RheXNTaG9ydFtkYXldIDogb3B0cy5pMThuLndlZWtkYXlzW2RheV07XG4gICAgfSxcblxuICAgIHJlbmRlckRheSA9IGZ1bmN0aW9uKG9wdHMpXG4gICAge1xuICAgICAgICB2YXIgYXJyID0gW107XG4gICAgICAgIHZhciBhcmlhU2VsZWN0ZWQgPSAnZmFsc2UnO1xuICAgICAgICBpZiAob3B0cy5pc0VtcHR5KSB7XG4gICAgICAgICAgICBpZiAob3B0cy5zaG93RGF5c0luTmV4dEFuZFByZXZpb3VzTW9udGhzKSB7XG4gICAgICAgICAgICAgICAgYXJyLnB1c2goJ2lzLW91dHNpZGUtY3VycmVudC1tb250aCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJzx0ZCBjbGFzcz1cImlzLWVtcHR5XCI+PC90ZD4nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRzLmlzRGlzYWJsZWQpIHtcbiAgICAgICAgICAgIGFyci5wdXNoKCdpcy1kaXNhYmxlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRzLmlzVG9kYXkpIHtcbiAgICAgICAgICAgIGFyci5wdXNoKCdpcy10b2RheScpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRzLmlzU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIGFyci5wdXNoKCdpcy1zZWxlY3RlZCcpO1xuICAgICAgICAgICAgYXJpYVNlbGVjdGVkID0gJ3RydWUnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRzLmhhc0V2ZW50KSB7XG4gICAgICAgICAgICBhcnIucHVzaCgnaGFzLWV2ZW50Jyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdHMuaXNJblJhbmdlKSB7XG4gICAgICAgICAgICBhcnIucHVzaCgnaXMtaW5yYW5nZScpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRzLmlzU3RhcnRSYW5nZSkge1xuICAgICAgICAgICAgYXJyLnB1c2goJ2lzLXN0YXJ0cmFuZ2UnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0cy5pc0VuZFJhbmdlKSB7XG4gICAgICAgICAgICBhcnIucHVzaCgnaXMtZW5kcmFuZ2UnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJzx0ZCBkYXRhLWRheT1cIicgKyBvcHRzLmRheSArICdcIiBjbGFzcz1cIicgKyBhcnIuam9pbignICcpICsgJ1wiIGFyaWEtc2VsZWN0ZWQ9XCInICsgYXJpYVNlbGVjdGVkICsgJ1wiPicgK1xuICAgICAgICAgICAgICAgICAnPGJ1dHRvbiBjbGFzcz1cInBpa2EtYnV0dG9uIHBpa2EtZGF5XCIgdHlwZT1cImJ1dHRvblwiICcgK1xuICAgICAgICAgICAgICAgICAgICAnZGF0YS1waWthLXllYXI9XCInICsgb3B0cy55ZWFyICsgJ1wiIGRhdGEtcGlrYS1tb250aD1cIicgKyBvcHRzLm1vbnRoICsgJ1wiIGRhdGEtcGlrYS1kYXk9XCInICsgb3B0cy5kYXkgKyAnXCI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRzLmRheSArXG4gICAgICAgICAgICAgICAgICc8L2J1dHRvbj4nICtcbiAgICAgICAgICAgICAgICc8L3RkPic7XG4gICAgfSxcblxuICAgIHJlbmRlcldlZWsgPSBmdW5jdGlvbiAoZCwgbSwgeSkge1xuICAgICAgICAvLyBMaWZ0ZWQgZnJvbSBodHRwOi8vamF2YXNjcmlwdC5hYm91dC5jb20vbGlicmFyeS9ibHdlZWt5ZWFyLmh0bSwgbGlnaHRseSBtb2RpZmllZC5cbiAgICAgICAgdmFyIG9uZWphbiA9IG5ldyBEYXRlKHksIDAsIDEpLFxuICAgICAgICAgICAgd2Vla051bSA9IE1hdGguY2VpbCgoKChuZXcgRGF0ZSh5LCBtLCBkKSAtIG9uZWphbikgLyA4NjQwMDAwMCkgKyBvbmVqYW4uZ2V0RGF5KCkrMSkvNyk7XG4gICAgICAgIHJldHVybiAnPHRkIGNsYXNzPVwicGlrYS13ZWVrXCI+JyArIHdlZWtOdW0gKyAnPC90ZD4nO1xuICAgIH0sXG5cbiAgICByZW5kZXJSb3cgPSBmdW5jdGlvbihkYXlzLCBpc1JUTCwgcGlja1dob2xlV2VlaywgaXNSb3dTZWxlY3RlZClcbiAgICB7XG4gICAgICAgIHJldHVybiAnPHRyIGNsYXNzPVwicGlrYS1yb3cnICsgKHBpY2tXaG9sZVdlZWsgPyAnIHBpY2std2hvbGUtd2VlaycgOiAnJykgKyAoaXNSb3dTZWxlY3RlZCA/ICcgaXMtc2VsZWN0ZWQnIDogJycpICsgJ1wiPicgKyAoaXNSVEwgPyBkYXlzLnJldmVyc2UoKSA6IGRheXMpLmpvaW4oJycpICsgJzwvdHI+JztcbiAgICB9LFxuXG4gICAgcmVuZGVyQm9keSA9IGZ1bmN0aW9uKHJvd3MpXG4gICAge1xuICAgICAgICByZXR1cm4gJzx0Ym9keT4nICsgcm93cy5qb2luKCcnKSArICc8L3Rib2R5Pic7XG4gICAgfSxcblxuICAgIHJlbmRlckhlYWQgPSBmdW5jdGlvbihvcHRzKVxuICAgIHtcbiAgICAgICAgdmFyIGksIGFyciA9IFtdO1xuICAgICAgICBpZiAob3B0cy5zaG93V2Vla051bWJlcikge1xuICAgICAgICAgICAgYXJyLnB1c2goJzx0aD48L3RoPicpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCA3OyBpKyspIHtcbiAgICAgICAgICAgIGFyci5wdXNoKCc8dGggc2NvcGU9XCJjb2xcIj48YWJiciB0aXRsZT1cIicgKyByZW5kZXJEYXlOYW1lKG9wdHMsIGkpICsgJ1wiPicgKyByZW5kZXJEYXlOYW1lKG9wdHMsIGksIHRydWUpICsgJzwvYWJicj48L3RoPicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnPHRoZWFkPjx0cj4nICsgKG9wdHMuaXNSVEwgPyBhcnIucmV2ZXJzZSgpIDogYXJyKS5qb2luKCcnKSArICc8L3RyPjwvdGhlYWQ+JztcbiAgICB9LFxuXG4gICAgcmVuZGVyVGl0bGUgPSBmdW5jdGlvbihpbnN0YW5jZSwgYywgeWVhciwgbW9udGgsIHJlZlllYXIsIHJhbmRJZClcbiAgICB7XG4gICAgICAgIHZhciBpLCBqLCBhcnIsXG4gICAgICAgICAgICBvcHRzID0gaW5zdGFuY2UuX28sXG4gICAgICAgICAgICBpc01pblllYXIgPSB5ZWFyID09PSBvcHRzLm1pblllYXIsXG4gICAgICAgICAgICBpc01heFllYXIgPSB5ZWFyID09PSBvcHRzLm1heFllYXIsXG4gICAgICAgICAgICBodG1sID0gJzxkaXYgaWQ9XCInICsgcmFuZElkICsgJ1wiIGNsYXNzPVwicGlrYS10aXRsZVwiIHJvbGU9XCJoZWFkaW5nXCIgYXJpYS1saXZlPVwiYXNzZXJ0aXZlXCI+JyxcbiAgICAgICAgICAgIG1vbnRoSHRtbCxcbiAgICAgICAgICAgIHllYXJIdG1sLFxuICAgICAgICAgICAgcHJldiA9IHRydWUsXG4gICAgICAgICAgICBuZXh0ID0gdHJ1ZTtcblxuICAgICAgICBmb3IgKGFyciA9IFtdLCBpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgICAgIGFyci5wdXNoKCc8b3B0aW9uIHZhbHVlPVwiJyArICh5ZWFyID09PSByZWZZZWFyID8gaSAtIGMgOiAxMiArIGkgLSBjKSArICdcIicgK1xuICAgICAgICAgICAgICAgIChpID09PSBtb250aCA/ICcgc2VsZWN0ZWQ9XCJzZWxlY3RlZFwiJzogJycpICtcbiAgICAgICAgICAgICAgICAoKGlzTWluWWVhciAmJiBpIDwgb3B0cy5taW5Nb250aCkgfHwgKGlzTWF4WWVhciAmJiBpID4gb3B0cy5tYXhNb250aCkgPyAnZGlzYWJsZWQ9XCJkaXNhYmxlZFwiJyA6ICcnKSArICc+JyArXG4gICAgICAgICAgICAgICAgb3B0cy5pMThuLm1vbnRoc1tpXSArICc8L29wdGlvbj4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1vbnRoSHRtbCA9ICc8ZGl2IGNsYXNzPVwicGlrYS1sYWJlbFwiPicgKyBvcHRzLmkxOG4ubW9udGhzW21vbnRoXSArICc8c2VsZWN0IGNsYXNzPVwicGlrYS1zZWxlY3QgcGlrYS1zZWxlY3QtbW9udGhcIiB0YWJpbmRleD1cIi0xXCI+JyArIGFyci5qb2luKCcnKSArICc8L3NlbGVjdD48L2Rpdj4nO1xuXG4gICAgICAgIGlmIChpc0FycmF5KG9wdHMueWVhclJhbmdlKSkge1xuICAgICAgICAgICAgaSA9IG9wdHMueWVhclJhbmdlWzBdO1xuICAgICAgICAgICAgaiA9IG9wdHMueWVhclJhbmdlWzFdICsgMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGkgPSB5ZWFyIC0gb3B0cy55ZWFyUmFuZ2U7XG4gICAgICAgICAgICBqID0gMSArIHllYXIgKyBvcHRzLnllYXJSYW5nZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoYXJyID0gW107IGkgPCBqICYmIGkgPD0gb3B0cy5tYXhZZWFyOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpID49IG9wdHMubWluWWVhcikge1xuICAgICAgICAgICAgICAgIGFyci5wdXNoKCc8b3B0aW9uIHZhbHVlPVwiJyArIGkgKyAnXCInICsgKGkgPT09IHllYXIgPyAnIHNlbGVjdGVkPVwic2VsZWN0ZWRcIic6ICcnKSArICc+JyArIChpKSArICc8L29wdGlvbj4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB5ZWFySHRtbCA9ICc8ZGl2IGNsYXNzPVwicGlrYS1sYWJlbFwiPicgKyB5ZWFyICsgb3B0cy55ZWFyU3VmZml4ICsgJzxzZWxlY3QgY2xhc3M9XCJwaWthLXNlbGVjdCBwaWthLXNlbGVjdC15ZWFyXCIgdGFiaW5kZXg9XCItMVwiPicgKyBhcnIuam9pbignJykgKyAnPC9zZWxlY3Q+PC9kaXY+JztcblxuICAgICAgICBpZiAob3B0cy5zaG93TW9udGhBZnRlclllYXIpIHtcbiAgICAgICAgICAgIGh0bWwgKz0geWVhckh0bWwgKyBtb250aEh0bWw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBodG1sICs9IG1vbnRoSHRtbCArIHllYXJIdG1sO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzTWluWWVhciAmJiAobW9udGggPT09IDAgfHwgb3B0cy5taW5Nb250aCA+PSBtb250aCkpIHtcbiAgICAgICAgICAgIHByZXYgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc01heFllYXIgJiYgKG1vbnRoID09PSAxMSB8fCBvcHRzLm1heE1vbnRoIDw9IG1vbnRoKSkge1xuICAgICAgICAgICAgbmV4dCA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGMgPT09IDApIHtcbiAgICAgICAgICAgIGh0bWwgKz0gJzxidXR0b24gY2xhc3M9XCJwaWthLXByZXYnICsgKHByZXYgPyAnJyA6ICcgaXMtZGlzYWJsZWQnKSArICdcIiB0eXBlPVwiYnV0dG9uXCI+JyArIG9wdHMuaTE4bi5wcmV2aW91c01vbnRoICsgJzwvYnV0dG9uPic7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGMgPT09IChpbnN0YW5jZS5fby5udW1iZXJPZk1vbnRocyAtIDEpICkge1xuICAgICAgICAgICAgaHRtbCArPSAnPGJ1dHRvbiBjbGFzcz1cInBpa2EtbmV4dCcgKyAobmV4dCA/ICcnIDogJyBpcy1kaXNhYmxlZCcpICsgJ1wiIHR5cGU9XCJidXR0b25cIj4nICsgb3B0cy5pMThuLm5leHRNb250aCArICc8L2J1dHRvbj4nO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGh0bWwgKz0gJzwvZGl2Pic7XG4gICAgfSxcblxuICAgIHJlbmRlclRhYmxlID0gZnVuY3Rpb24ob3B0cywgZGF0YSwgcmFuZElkKVxuICAgIHtcbiAgICAgICAgcmV0dXJuICc8dGFibGUgY2VsbHBhZGRpbmc9XCIwXCIgY2VsbHNwYWNpbmc9XCIwXCIgY2xhc3M9XCJwaWthLXRhYmxlXCIgcm9sZT1cImdyaWRcIiBhcmlhLWxhYmVsbGVkYnk9XCInICsgcmFuZElkICsgJ1wiPicgKyByZW5kZXJIZWFkKG9wdHMpICsgcmVuZGVyQm9keShkYXRhKSArICc8L3RhYmxlPic7XG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICogUGlrYWRheSBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIFBpa2FkYXkgPSBmdW5jdGlvbihvcHRpb25zKVxuICAgIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgICAgICAgb3B0cyA9IHNlbGYuY29uZmlnKG9wdGlvbnMpO1xuXG4gICAgICAgIHNlbGYuX29uTW91c2VEb3duID0gZnVuY3Rpb24oZSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFzZWxmLl92KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50O1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcbiAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWhhc0NsYXNzKHRhcmdldCwgJ2lzLWRpc2FibGVkJykpIHtcbiAgICAgICAgICAgICAgICBpZiAoaGFzQ2xhc3ModGFyZ2V0LCAncGlrYS1idXR0b24nKSAmJiAhaGFzQ2xhc3ModGFyZ2V0LCAnaXMtZW1wdHknKSAmJiAhaGFzQ2xhc3ModGFyZ2V0LnBhcmVudE5vZGUsICdpcy1kaXNhYmxlZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0RGF0ZShuZXcgRGF0ZSh0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXBpa2EteWVhcicpLCB0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXBpa2EtbW9udGgnKSwgdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1waWthLWRheScpKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRzLmJvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG8oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdHMuYmx1ckZpZWxkT25TZWxlY3QgJiYgb3B0cy5maWVsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRzLmZpZWxkLmJsdXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGhhc0NsYXNzKHRhcmdldCwgJ3Bpa2EtcHJldicpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYucHJldk1vbnRoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGhhc0NsYXNzKHRhcmdldCwgJ3Bpa2EtbmV4dCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYubmV4dE1vbnRoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFoYXNDbGFzcyh0YXJnZXQsICdwaWthLXNlbGVjdCcpKSB7XG4gICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyB0b3VjaCBldmVudCBwcmV2ZW50IG1vdXNlIGV2ZW50cyBlbXVsYXRpb25cbiAgICAgICAgICAgICAgICBpZiAoZS5wcmV2ZW50RGVmYXVsdCkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZS5yZXR1cm5WYWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9jID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLl9vbkNoYW5nZSA9IGZ1bmN0aW9uKGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XG4gICAgICAgICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChoYXNDbGFzcyh0YXJnZXQsICdwaWthLXNlbGVjdC1tb250aCcpKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5nb3RvTW9udGgodGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGhhc0NsYXNzKHRhcmdldCwgJ3Bpa2Etc2VsZWN0LXllYXInKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuZ290b1llYXIodGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLl9vbktleUNoYW5nZSA9IGZ1bmN0aW9uKGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDtcblxuICAgICAgICAgICAgaWYgKHNlbGYuaXNWaXNpYmxlKCkpIHtcblxuICAgICAgICAgICAgICAgIHN3aXRjaChlLmtleUNvZGUpe1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOlxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI3OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdHMuZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRzLmZpZWxkLmJsdXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM3OlxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hZGp1c3REYXRlKCdzdWJ0cmFjdCcsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzg6XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFkanVzdERhdGUoJ3N1YnRyYWN0JywgNyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWRqdXN0RGF0ZSgnYWRkJywgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWRqdXN0RGF0ZSgnYWRkJywgNyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5fb25JbnB1dENoYW5nZSA9IGZ1bmN0aW9uKGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBkYXRlO1xuXG4gICAgICAgICAgICBpZiAoZS5maXJlZEJ5ID09PSBzZWxmKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdHMucGFyc2UpIHtcbiAgICAgICAgICAgICAgICBkYXRlID0gb3B0cy5wYXJzZShvcHRzLmZpZWxkLnZhbHVlLCBvcHRzLmZvcm1hdCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGhhc01vbWVudCkge1xuICAgICAgICAgICAgICAgIGRhdGUgPSBtb21lbnQob3B0cy5maWVsZC52YWx1ZSwgb3B0cy5mb3JtYXQsIG9wdHMuZm9ybWF0U3RyaWN0KTtcbiAgICAgICAgICAgICAgICBkYXRlID0gKGRhdGUgJiYgZGF0ZS5pc1ZhbGlkKCkpID8gZGF0ZS50b0RhdGUoKSA6IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBkYXRlID0gbmV3IERhdGUoRGF0ZS5wYXJzZShvcHRzLmZpZWxkLnZhbHVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNEYXRlKGRhdGUpKSB7XG4gICAgICAgICAgICAgIHNlbGYuc2V0RGF0ZShkYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghc2VsZi5fdikge1xuICAgICAgICAgICAgICAgIHNlbGYuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHNlbGYuX29uSW5wdXRGb2N1cyA9IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgc2VsZi5zaG93KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5fb25JbnB1dENsaWNrID0gZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICBzZWxmLnNob3coKTtcbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLl9vbklucHV0Qmx1ciA9IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gSUUgYWxsb3dzIHBpa2EgZGl2IHRvIGdhaW4gZm9jdXM7IGNhdGNoIGJsdXIgdGhlIGlucHV0IGZpZWxkXG4gICAgICAgICAgICB2YXIgcEVsID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpZiAoaGFzQ2xhc3MocEVsLCAncGlrYS1zaW5nbGUnKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKChwRWwgPSBwRWwucGFyZW50Tm9kZSkpO1xuXG4gICAgICAgICAgICBpZiAoIXNlbGYuX2MpIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9iID0gc3RvKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9LCA1MCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLl9jID0gZmFsc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5fb25DbGljayA9IGZ1bmN0aW9uKGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQsXG4gICAgICAgICAgICAgICAgcEVsID0gdGFyZ2V0O1xuICAgICAgICAgICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWhhc0V2ZW50TGlzdGVuZXJzICYmIGhhc0NsYXNzKHRhcmdldCwgJ3Bpa2Etc2VsZWN0JykpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRhcmdldC5vbmNoYW5nZSkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc2V0QXR0cmlidXRlKCdvbmNoYW5nZScsICdyZXR1cm47Jyk7XG4gICAgICAgICAgICAgICAgICAgIGFkZEV2ZW50KHRhcmdldCwgJ2NoYW5nZScsIHNlbGYuX29uQ2hhbmdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaWYgKGhhc0NsYXNzKHBFbCwgJ3Bpa2Etc2luZ2xlJykgfHwgcEVsID09PSBvcHRzLnRyaWdnZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlICgocEVsID0gcEVsLnBhcmVudE5vZGUpKTtcbiAgICAgICAgICAgIGlmIChzZWxmLl92ICYmIHRhcmdldCAhPT0gb3B0cy50cmlnZ2VyICYmIHBFbCAhPT0gb3B0cy50cmlnZ2VyKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5lbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBzZWxmLmVsLmNsYXNzTmFtZSA9ICdwaWthLXNpbmdsZScgKyAob3B0cy5pc1JUTCA/ICcgaXMtcnRsJyA6ICcnKSArIChvcHRzLnRoZW1lID8gJyAnICsgb3B0cy50aGVtZSA6ICcnKTtcblxuICAgICAgICBhZGRFdmVudChzZWxmLmVsLCAnbW91c2Vkb3duJywgc2VsZi5fb25Nb3VzZURvd24sIHRydWUpO1xuICAgICAgICBhZGRFdmVudChzZWxmLmVsLCAndG91Y2hlbmQnLCBzZWxmLl9vbk1vdXNlRG93biwgdHJ1ZSk7XG4gICAgICAgIGFkZEV2ZW50KHNlbGYuZWwsICdjaGFuZ2UnLCBzZWxmLl9vbkNoYW5nZSk7XG4gICAgICAgIGFkZEV2ZW50KGRvY3VtZW50LCAna2V5ZG93bicsIHNlbGYuX29uS2V5Q2hhbmdlKTtcblxuICAgICAgICBpZiAob3B0cy5maWVsZCkge1xuICAgICAgICAgICAgaWYgKG9wdHMuY29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgb3B0cy5jb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZi5lbCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG9wdHMuYm91bmQpIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNlbGYuZWwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvcHRzLmZpZWxkLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHNlbGYuZWwsIG9wdHMuZmllbGQubmV4dFNpYmxpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWRkRXZlbnQob3B0cy5maWVsZCwgJ2NoYW5nZScsIHNlbGYuX29uSW5wdXRDaGFuZ2UpO1xuXG4gICAgICAgICAgICBpZiAoIW9wdHMuZGVmYXVsdERhdGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoaGFzTW9tZW50ICYmIG9wdHMuZmllbGQudmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0cy5kZWZhdWx0RGF0ZSA9IG1vbWVudChvcHRzLmZpZWxkLnZhbHVlLCBvcHRzLmZvcm1hdCkudG9EYXRlKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0cy5kZWZhdWx0RGF0ZSA9IG5ldyBEYXRlKERhdGUucGFyc2Uob3B0cy5maWVsZC52YWx1ZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvcHRzLnNldERlZmF1bHREYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBkZWZEYXRlID0gb3B0cy5kZWZhdWx0RGF0ZTtcblxuICAgICAgICBpZiAoaXNEYXRlKGRlZkRhdGUpKSB7XG4gICAgICAgICAgICBpZiAob3B0cy5zZXREZWZhdWx0RGF0ZSkge1xuICAgICAgICAgICAgICAgIHNlbGYuc2V0RGF0ZShkZWZEYXRlLCB0cnVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5nb3RvRGF0ZShkZWZEYXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuZ290b0RhdGUobmV3IERhdGUoKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3B0cy5ib3VuZCkge1xuICAgICAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICAgICAgICBzZWxmLmVsLmNsYXNzTmFtZSArPSAnIGlzLWJvdW5kJztcbiAgICAgICAgICAgIGFkZEV2ZW50KG9wdHMudHJpZ2dlciwgJ2NsaWNrJywgc2VsZi5fb25JbnB1dENsaWNrKTtcbiAgICAgICAgICAgIGFkZEV2ZW50KG9wdHMudHJpZ2dlciwgJ2ZvY3VzJywgc2VsZi5fb25JbnB1dEZvY3VzKTtcbiAgICAgICAgICAgIGFkZEV2ZW50KG9wdHMudHJpZ2dlciwgJ2JsdXInLCBzZWxmLl9vbklucHV0Qmx1cik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNob3coKTtcbiAgICAgICAgfVxuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAqIHB1YmxpYyBQaWthZGF5IEFQSVxuICAgICAqL1xuICAgIFBpa2FkYXkucHJvdG90eXBlID0ge1xuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNvbmZpZ3VyZSBmdW5jdGlvbmFsaXR5XG4gICAgICAgICAqL1xuICAgICAgICBjb25maWc6IGZ1bmN0aW9uKG9wdGlvbnMpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fbykge1xuICAgICAgICAgICAgICAgIHRoaXMuX28gPSBleHRlbmQoe30sIGRlZmF1bHRzLCB0cnVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG9wdHMgPSBleHRlbmQodGhpcy5fbywgb3B0aW9ucywgdHJ1ZSk7XG5cbiAgICAgICAgICAgIG9wdHMuaXNSVEwgPSAhIW9wdHMuaXNSVEw7XG5cbiAgICAgICAgICAgIG9wdHMuZmllbGQgPSAob3B0cy5maWVsZCAmJiBvcHRzLmZpZWxkLm5vZGVOYW1lKSA/IG9wdHMuZmllbGQgOiBudWxsO1xuXG4gICAgICAgICAgICBvcHRzLnRoZW1lID0gKHR5cGVvZiBvcHRzLnRoZW1lKSA9PT0gJ3N0cmluZycgJiYgb3B0cy50aGVtZSA/IG9wdHMudGhlbWUgOiBudWxsO1xuXG4gICAgICAgICAgICBvcHRzLmJvdW5kID0gISEob3B0cy5ib3VuZCAhPT0gdW5kZWZpbmVkID8gb3B0cy5maWVsZCAmJiBvcHRzLmJvdW5kIDogb3B0cy5maWVsZCk7XG5cbiAgICAgICAgICAgIG9wdHMudHJpZ2dlciA9IChvcHRzLnRyaWdnZXIgJiYgb3B0cy50cmlnZ2VyLm5vZGVOYW1lKSA/IG9wdHMudHJpZ2dlciA6IG9wdHMuZmllbGQ7XG5cbiAgICAgICAgICAgIG9wdHMuZGlzYWJsZVdlZWtlbmRzID0gISFvcHRzLmRpc2FibGVXZWVrZW5kcztcblxuICAgICAgICAgICAgb3B0cy5kaXNhYmxlRGF5Rm4gPSAodHlwZW9mIG9wdHMuZGlzYWJsZURheUZuKSA9PT0gJ2Z1bmN0aW9uJyA/IG9wdHMuZGlzYWJsZURheUZuIDogbnVsbDtcblxuICAgICAgICAgICAgdmFyIG5vbSA9IHBhcnNlSW50KG9wdHMubnVtYmVyT2ZNb250aHMsIDEwKSB8fCAxO1xuICAgICAgICAgICAgb3B0cy5udW1iZXJPZk1vbnRocyA9IG5vbSA+IDQgPyA0IDogbm9tO1xuXG4gICAgICAgICAgICBpZiAoIWlzRGF0ZShvcHRzLm1pbkRhdGUpKSB7XG4gICAgICAgICAgICAgICAgb3B0cy5taW5EYXRlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlzRGF0ZShvcHRzLm1heERhdGUpKSB7XG4gICAgICAgICAgICAgICAgb3B0cy5tYXhEYXRlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKG9wdHMubWluRGF0ZSAmJiBvcHRzLm1heERhdGUpICYmIG9wdHMubWF4RGF0ZSA8IG9wdHMubWluRGF0ZSkge1xuICAgICAgICAgICAgICAgIG9wdHMubWF4RGF0ZSA9IG9wdHMubWluRGF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdHMubWluRGF0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0TWluRGF0ZShvcHRzLm1pbkRhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG9wdHMubWF4RGF0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0TWF4RGF0ZShvcHRzLm1heERhdGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaXNBcnJheShvcHRzLnllYXJSYW5nZSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmFsbGJhY2sgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkgLSAxMDtcbiAgICAgICAgICAgICAgICBvcHRzLnllYXJSYW5nZVswXSA9IHBhcnNlSW50KG9wdHMueWVhclJhbmdlWzBdLCAxMCkgfHwgZmFsbGJhY2s7XG4gICAgICAgICAgICAgICAgb3B0cy55ZWFyUmFuZ2VbMV0gPSBwYXJzZUludChvcHRzLnllYXJSYW5nZVsxXSwgMTApIHx8IGZhbGxiYWNrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvcHRzLnllYXJSYW5nZSA9IE1hdGguYWJzKHBhcnNlSW50KG9wdHMueWVhclJhbmdlLCAxMCkpIHx8IGRlZmF1bHRzLnllYXJSYW5nZTtcbiAgICAgICAgICAgICAgICBpZiAob3B0cy55ZWFyUmFuZ2UgPiAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgb3B0cy55ZWFyUmFuZ2UgPSAxMDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gb3B0cztcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJuIGEgZm9ybWF0dGVkIHN0cmluZyBvZiB0aGUgY3VycmVudCBzZWxlY3Rpb24gKHVzaW5nIE1vbWVudC5qcyBpZiBhdmFpbGFibGUpXG4gICAgICAgICAqL1xuICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24oZm9ybWF0KVxuICAgICAgICB7XG4gICAgICAgICAgICBmb3JtYXQgPSBmb3JtYXQgfHwgdGhpcy5fby5mb3JtYXQ7XG4gICAgICAgICAgICBpZiAoIWlzRGF0ZSh0aGlzLl9kKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9vLnRvU3RyaW5nKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0aGlzLl9vLnRvU3RyaW5nKHRoaXMuX2QsIGZvcm1hdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGFzTW9tZW50KSB7XG4gICAgICAgICAgICAgIHJldHVybiBtb21lbnQodGhpcy5fZCkuZm9ybWF0KGZvcm1hdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZC50b0RhdGVTdHJpbmcoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJuIGEgTW9tZW50LmpzIG9iamVjdCBvZiB0aGUgY3VycmVudCBzZWxlY3Rpb24gKGlmIGF2YWlsYWJsZSlcbiAgICAgICAgICovXG4gICAgICAgIGdldE1vbWVudDogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gaGFzTW9tZW50ID8gbW9tZW50KHRoaXMuX2QpIDogbnVsbDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogc2V0IHRoZSBjdXJyZW50IHNlbGVjdGlvbiBmcm9tIGEgTW9tZW50LmpzIG9iamVjdCAoaWYgYXZhaWxhYmxlKVxuICAgICAgICAgKi9cbiAgICAgICAgc2V0TW9tZW50OiBmdW5jdGlvbihkYXRlLCBwcmV2ZW50T25TZWxlY3QpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChoYXNNb21lbnQgJiYgbW9tZW50LmlzTW9tZW50KGRhdGUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXREYXRlKGRhdGUudG9EYXRlKCksIHByZXZlbnRPblNlbGVjdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJldHVybiBhIERhdGUgb2JqZWN0IG9mIHRoZSBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0RGF0ZTogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICByZXR1cm4gaXNEYXRlKHRoaXMuX2QpID8gbmV3IERhdGUodGhpcy5fZC5nZXRUaW1lKCkpIDogbnVsbDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogc2V0IHRoZSBjdXJyZW50IHNlbGVjdGlvblxuICAgICAgICAgKi9cbiAgICAgICAgc2V0RGF0ZTogZnVuY3Rpb24oZGF0ZSwgcHJldmVudE9uU2VsZWN0KVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIWRhdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vLmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX28uZmllbGQudmFsdWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgZmlyZUV2ZW50KHRoaXMuX28uZmllbGQsICdjaGFuZ2UnLCB7IGZpcmVkQnk6IHRoaXMgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZHJhdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGRhdGUgPSBuZXcgRGF0ZShEYXRlLnBhcnNlKGRhdGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNEYXRlKGRhdGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbWluID0gdGhpcy5fby5taW5EYXRlLFxuICAgICAgICAgICAgICAgIG1heCA9IHRoaXMuX28ubWF4RGF0ZTtcblxuICAgICAgICAgICAgaWYgKGlzRGF0ZShtaW4pICYmIGRhdGUgPCBtaW4pIHtcbiAgICAgICAgICAgICAgICBkYXRlID0gbWluO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpc0RhdGUobWF4KSAmJiBkYXRlID4gbWF4KSB7XG4gICAgICAgICAgICAgICAgZGF0ZSA9IG1heDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fZCA9IG5ldyBEYXRlKGRhdGUuZ2V0VGltZSgpKTtcbiAgICAgICAgICAgIHNldFRvU3RhcnRPZkRheSh0aGlzLl9kKTtcbiAgICAgICAgICAgIHRoaXMuZ290b0RhdGUodGhpcy5fZCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vLmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5maWVsZC52YWx1ZSA9IHRoaXMudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBmaXJlRXZlbnQodGhpcy5fby5maWVsZCwgJ2NoYW5nZScsIHsgZmlyZWRCeTogdGhpcyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghcHJldmVudE9uU2VsZWN0ICYmIHR5cGVvZiB0aGlzLl9vLm9uU2VsZWN0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5vblNlbGVjdC5jYWxsKHRoaXMsIHRoaXMuZ2V0RGF0ZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogY2hhbmdlIHZpZXcgdG8gYSBzcGVjaWZpYyBkYXRlXG4gICAgICAgICAqL1xuICAgICAgICBnb3RvRGF0ZTogZnVuY3Rpb24oZGF0ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIG5ld0NhbGVuZGFyID0gdHJ1ZTtcblxuICAgICAgICAgICAgaWYgKCFpc0RhdGUoZGF0ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmNhbGVuZGFycykge1xuICAgICAgICAgICAgICAgIHZhciBmaXJzdFZpc2libGVEYXRlID0gbmV3IERhdGUodGhpcy5jYWxlbmRhcnNbMF0ueWVhciwgdGhpcy5jYWxlbmRhcnNbMF0ubW9udGgsIDEpLFxuICAgICAgICAgICAgICAgICAgICBsYXN0VmlzaWJsZURhdGUgPSBuZXcgRGF0ZSh0aGlzLmNhbGVuZGFyc1t0aGlzLmNhbGVuZGFycy5sZW5ndGgtMV0ueWVhciwgdGhpcy5jYWxlbmRhcnNbdGhpcy5jYWxlbmRhcnMubGVuZ3RoLTFdLm1vbnRoLCAxKSxcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJsZURhdGUgPSBkYXRlLmdldFRpbWUoKTtcbiAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIGVuZCBvZiB0aGUgbW9udGhcbiAgICAgICAgICAgICAgICBsYXN0VmlzaWJsZURhdGUuc2V0TW9udGgobGFzdFZpc2libGVEYXRlLmdldE1vbnRoKCkrMSk7XG4gICAgICAgICAgICAgICAgbGFzdFZpc2libGVEYXRlLnNldERhdGUobGFzdFZpc2libGVEYXRlLmdldERhdGUoKS0xKTtcbiAgICAgICAgICAgICAgICBuZXdDYWxlbmRhciA9ICh2aXNpYmxlRGF0ZSA8IGZpcnN0VmlzaWJsZURhdGUuZ2V0VGltZSgpIHx8IGxhc3RWaXNpYmxlRGF0ZS5nZXRUaW1lKCkgPCB2aXNpYmxlRGF0ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChuZXdDYWxlbmRhcikge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJzID0gW3tcbiAgICAgICAgICAgICAgICAgICAgbW9udGg6IGRhdGUuZ2V0TW9udGgoKSxcbiAgICAgICAgICAgICAgICAgICAgeWVhcjogZGF0ZS5nZXRGdWxsWWVhcigpXG4gICAgICAgICAgICAgICAgfV07XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX28ubWFpbkNhbGVuZGFyID09PSAncmlnaHQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJzWzBdLm1vbnRoICs9IDEgLSB0aGlzLl9vLm51bWJlck9mTW9udGhzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5hZGp1c3RDYWxlbmRhcnMoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBhZGp1c3REYXRlOiBmdW5jdGlvbihzaWduLCBkYXlzKSB7XG5cbiAgICAgICAgICAgIHZhciBkYXkgPSB0aGlzLmdldERhdGUoKSB8fCBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2UgPSBwYXJzZUludChkYXlzKSoyNCo2MCo2MCoxMDAwO1xuXG4gICAgICAgICAgICB2YXIgbmV3RGF5O1xuXG4gICAgICAgICAgICBpZiAoc2lnbiA9PT0gJ2FkZCcpIHtcbiAgICAgICAgICAgICAgICBuZXdEYXkgPSBuZXcgRGF0ZShkYXkudmFsdWVPZigpICsgZGlmZmVyZW5jZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNpZ24gPT09ICdzdWJ0cmFjdCcpIHtcbiAgICAgICAgICAgICAgICBuZXdEYXkgPSBuZXcgRGF0ZShkYXkudmFsdWVPZigpIC0gZGlmZmVyZW5jZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc2V0RGF0ZShuZXdEYXkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGFkanVzdENhbGVuZGFyczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLmNhbGVuZGFyc1swXSA9IGFkanVzdENhbGVuZGFyKHRoaXMuY2FsZW5kYXJzWzBdKTtcbiAgICAgICAgICAgIGZvciAodmFyIGMgPSAxOyBjIDwgdGhpcy5fby5udW1iZXJPZk1vbnRoczsgYysrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhcnNbY10gPSBhZGp1c3RDYWxlbmRhcih7XG4gICAgICAgICAgICAgICAgICAgIG1vbnRoOiB0aGlzLmNhbGVuZGFyc1swXS5tb250aCArIGMsXG4gICAgICAgICAgICAgICAgICAgIHllYXI6IHRoaXMuY2FsZW5kYXJzWzBdLnllYXJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZHJhdygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdvdG9Ub2RheTogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmdvdG9EYXRlKG5ldyBEYXRlKCkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjaGFuZ2UgdmlldyB0byBhIHNwZWNpZmljIG1vbnRoICh6ZXJvLWluZGV4LCBlLmcuIDA6IEphbnVhcnkpXG4gICAgICAgICAqL1xuICAgICAgICBnb3RvTW9udGg6IGZ1bmN0aW9uKG1vbnRoKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIWlzTmFOKG1vbnRoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJzWzBdLm1vbnRoID0gcGFyc2VJbnQobW9udGgsIDEwKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkanVzdENhbGVuZGFycygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIG5leHRNb250aDogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmNhbGVuZGFyc1swXS5tb250aCsrO1xuICAgICAgICAgICAgdGhpcy5hZGp1c3RDYWxlbmRhcnMoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBwcmV2TW9udGg6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jYWxlbmRhcnNbMF0ubW9udGgtLTtcbiAgICAgICAgICAgIHRoaXMuYWRqdXN0Q2FsZW5kYXJzKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNoYW5nZSB2aWV3IHRvIGEgc3BlY2lmaWMgZnVsbCB5ZWFyIChlLmcuIFwiMjAxMlwiKVxuICAgICAgICAgKi9cbiAgICAgICAgZ290b1llYXI6IGZ1bmN0aW9uKHllYXIpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmICghaXNOYU4oeWVhcikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyc1swXS55ZWFyID0gcGFyc2VJbnQoeWVhciwgMTApO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRqdXN0Q2FsZW5kYXJzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNoYW5nZSB0aGUgbWluRGF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgc2V0TWluRGF0ZTogZnVuY3Rpb24odmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgICAgIHNldFRvU3RhcnRPZkRheSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5taW5EYXRlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5taW5ZZWFyICA9IHZhbHVlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5taW5Nb250aCA9IHZhbHVlLmdldE1vbnRoKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX28ubWluRGF0ZSA9IGRlZmF1bHRzLm1pbkRhdGU7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5taW5ZZWFyICA9IGRlZmF1bHRzLm1pblllYXI7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5taW5Nb250aCA9IGRlZmF1bHRzLm1pbk1vbnRoO1xuICAgICAgICAgICAgICAgIHRoaXMuX28uc3RhcnRSYW5nZSA9IGRlZmF1bHRzLnN0YXJ0UmFuZ2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZHJhdygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjaGFuZ2UgdGhlIG1heERhdGVcbiAgICAgICAgICovXG4gICAgICAgIHNldE1heERhdGU6IGZ1bmN0aW9uKHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZih2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgICAgICBzZXRUb1N0YXJ0T2ZEYXkodmFsdWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuX28ubWF4RGF0ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX28ubWF4WWVhciA9IHZhbHVlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5tYXhNb250aCA9IHZhbHVlLmdldE1vbnRoKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX28ubWF4RGF0ZSA9IGRlZmF1bHRzLm1heERhdGU7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5tYXhZZWFyID0gZGVmYXVsdHMubWF4WWVhcjtcbiAgICAgICAgICAgICAgICB0aGlzLl9vLm1heE1vbnRoID0gZGVmYXVsdHMubWF4TW9udGg7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5lbmRSYW5nZSA9IGRlZmF1bHRzLmVuZFJhbmdlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmRyYXcoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRTdGFydFJhbmdlOiBmdW5jdGlvbih2YWx1ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fby5zdGFydFJhbmdlID0gdmFsdWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0RW5kUmFuZ2U6IGZ1bmN0aW9uKHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLl9vLmVuZFJhbmdlID0gdmFsdWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJlZnJlc2ggdGhlIEhUTUxcbiAgICAgICAgICovXG4gICAgICAgIGRyYXc6IGZ1bmN0aW9uKGZvcmNlKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3YgJiYgIWZvcmNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9wdHMgPSB0aGlzLl9vLFxuICAgICAgICAgICAgICAgIG1pblllYXIgPSBvcHRzLm1pblllYXIsXG4gICAgICAgICAgICAgICAgbWF4WWVhciA9IG9wdHMubWF4WWVhcixcbiAgICAgICAgICAgICAgICBtaW5Nb250aCA9IG9wdHMubWluTW9udGgsXG4gICAgICAgICAgICAgICAgbWF4TW9udGggPSBvcHRzLm1heE1vbnRoLFxuICAgICAgICAgICAgICAgIGh0bWwgPSAnJyxcbiAgICAgICAgICAgICAgICByYW5kSWQ7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl95IDw9IG1pblllYXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl95ID0gbWluWWVhcjtcbiAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKG1pbk1vbnRoKSAmJiB0aGlzLl9tIDwgbWluTW9udGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbSA9IG1pbk1vbnRoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl95ID49IG1heFllYXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl95ID0gbWF4WWVhcjtcbiAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKG1heE1vbnRoKSAmJiB0aGlzLl9tID4gbWF4TW9udGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbSA9IG1heE1vbnRoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmFuZElkID0gJ3Bpa2EtdGl0bGUtJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnJlcGxhY2UoL1teYS16XSsvZywgJycpLnN1YnN0cigwLCAyKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBvcHRzLm51bWJlck9mTW9udGhzOyBjKyspIHtcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwicGlrYS1sZW5kYXJcIj4nICsgcmVuZGVyVGl0bGUodGhpcywgYywgdGhpcy5jYWxlbmRhcnNbY10ueWVhciwgdGhpcy5jYWxlbmRhcnNbY10ubW9udGgsIHRoaXMuY2FsZW5kYXJzWzBdLnllYXIsIHJhbmRJZCkgKyB0aGlzLnJlbmRlcih0aGlzLmNhbGVuZGFyc1tjXS55ZWFyLCB0aGlzLmNhbGVuZGFyc1tjXS5tb250aCwgcmFuZElkKSArICc8L2Rpdj4nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmVsLmlubmVySFRNTCA9IGh0bWw7XG5cbiAgICAgICAgICAgIGlmIChvcHRzLmJvdW5kKSB7XG4gICAgICAgICAgICAgICAgaWYob3B0cy5maWVsZC50eXBlICE9PSAnaGlkZGVuJykge1xuICAgICAgICAgICAgICAgICAgICBzdG8oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRzLnRyaWdnZXIuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuX28ub25EcmF3ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5vbkRyYXcodGhpcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvcHRzLmJvdW5kKSB7XG4gICAgICAgICAgICAgICAgLy8gbGV0IHRoZSBzY3JlZW4gcmVhZGVyIHVzZXIga25vdyB0byB1c2UgYXJyb3cga2V5c1xuICAgICAgICAgICAgICAgIG9wdHMuZmllbGQuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1VzZSB0aGUgYXJyb3cga2V5cyB0byBwaWNrIGEgZGF0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGFkanVzdFBvc2l0aW9uOiBmdW5jdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBmaWVsZCwgcEVsLCB3aWR0aCwgaGVpZ2h0LCB2aWV3cG9ydFdpZHRoLCB2aWV3cG9ydEhlaWdodCwgc2Nyb2xsVG9wLCBsZWZ0LCB0b3AsIGNsaWVudFJlY3Q7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vLmNvbnRhaW5lcikgcmV0dXJuO1xuXG4gICAgICAgICAgICB0aGlzLmVsLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcblxuICAgICAgICAgICAgZmllbGQgPSB0aGlzLl9vLnRyaWdnZXI7XG4gICAgICAgICAgICBwRWwgPSBmaWVsZDtcbiAgICAgICAgICAgIHdpZHRoID0gdGhpcy5lbC5vZmZzZXRXaWR0aDtcbiAgICAgICAgICAgIGhlaWdodCA9IHRoaXMuZWwub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgdmlld3BvcnRXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDtcbiAgICAgICAgICAgIHZpZXdwb3J0SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICBzY3JvbGxUb3AgPSB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWVsZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBjbGllbnRSZWN0ID0gZmllbGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICAgICAgbGVmdCA9IGNsaWVudFJlY3QubGVmdCArIHdpbmRvdy5wYWdlWE9mZnNldDtcbiAgICAgICAgICAgICAgICB0b3AgPSBjbGllbnRSZWN0LmJvdHRvbSArIHdpbmRvdy5wYWdlWU9mZnNldDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGVmdCA9IHBFbC5vZmZzZXRMZWZ0O1xuICAgICAgICAgICAgICAgIHRvcCAgPSBwRWwub2Zmc2V0VG9wICsgcEVsLm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgICAgICB3aGlsZSgocEVsID0gcEVsLm9mZnNldFBhcmVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGVmdCArPSBwRWwub2Zmc2V0TGVmdDtcbiAgICAgICAgICAgICAgICAgICAgdG9wICArPSBwRWwub2Zmc2V0VG9wO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZGVmYXVsdCBwb3NpdGlvbiBpcyBib3R0b20gJiBsZWZ0XG4gICAgICAgICAgICBpZiAoKHRoaXMuX28ucmVwb3NpdGlvbiAmJiBsZWZ0ICsgd2lkdGggPiB2aWV3cG9ydFdpZHRoKSB8fFxuICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fby5wb3NpdGlvbi5pbmRleE9mKCdyaWdodCcpID4gLTEgJiZcbiAgICAgICAgICAgICAgICAgICAgbGVmdCAtIHdpZHRoICsgZmllbGQub2Zmc2V0V2lkdGggPiAwXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgbGVmdCA9IGxlZnQgLSB3aWR0aCArIGZpZWxkLm9mZnNldFdpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCh0aGlzLl9vLnJlcG9zaXRpb24gJiYgdG9wICsgaGVpZ2h0ID4gdmlld3BvcnRIZWlnaHQgKyBzY3JvbGxUb3ApIHx8XG4gICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vLnBvc2l0aW9uLmluZGV4T2YoJ3RvcCcpID4gLTEgJiZcbiAgICAgICAgICAgICAgICAgICAgdG9wIC0gaGVpZ2h0IC0gZmllbGQub2Zmc2V0SGVpZ2h0ID4gMFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHRvcCA9IHRvcCAtIGhlaWdodCAtIGZpZWxkLm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5lbC5zdHlsZS5sZWZ0ID0gbGVmdCArICdweCc7XG4gICAgICAgICAgICB0aGlzLmVsLnN0eWxlLnRvcCA9IHRvcCArICdweCc7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHJlbmRlciBIVE1MIGZvciBhIHBhcnRpY3VsYXIgbW9udGhcbiAgICAgICAgICovXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24oeWVhciwgbW9udGgsIHJhbmRJZClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIG9wdHMgICA9IHRoaXMuX28sXG4gICAgICAgICAgICAgICAgbm93ICAgID0gbmV3IERhdGUoKSxcbiAgICAgICAgICAgICAgICBkYXlzICAgPSBnZXREYXlzSW5Nb250aCh5ZWFyLCBtb250aCksXG4gICAgICAgICAgICAgICAgYmVmb3JlID0gbmV3IERhdGUoeWVhciwgbW9udGgsIDEpLmdldERheSgpLFxuICAgICAgICAgICAgICAgIGRhdGEgICA9IFtdLFxuICAgICAgICAgICAgICAgIHJvdyAgICA9IFtdO1xuICAgICAgICAgICAgc2V0VG9TdGFydE9mRGF5KG5vdyk7XG4gICAgICAgICAgICBpZiAob3B0cy5maXJzdERheSA+IDApIHtcbiAgICAgICAgICAgICAgICBiZWZvcmUgLT0gb3B0cy5maXJzdERheTtcbiAgICAgICAgICAgICAgICBpZiAoYmVmb3JlIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICBiZWZvcmUgKz0gNztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcHJldmlvdXNNb250aCA9IG1vbnRoID09PSAwID8gMTEgOiBtb250aCAtIDEsXG4gICAgICAgICAgICAgICAgbmV4dE1vbnRoID0gbW9udGggPT09IDExID8gMCA6IG1vbnRoICsgMSxcbiAgICAgICAgICAgICAgICB5ZWFyT2ZQcmV2aW91c01vbnRoID0gbW9udGggPT09IDAgPyB5ZWFyIC0gMSA6IHllYXIsXG4gICAgICAgICAgICAgICAgeWVhck9mTmV4dE1vbnRoID0gbW9udGggPT09IDExID8geWVhciArIDEgOiB5ZWFyLFxuICAgICAgICAgICAgICAgIGRheXNJblByZXZpb3VzTW9udGggPSBnZXREYXlzSW5Nb250aCh5ZWFyT2ZQcmV2aW91c01vbnRoLCBwcmV2aW91c01vbnRoKTtcbiAgICAgICAgICAgIHZhciBjZWxscyA9IGRheXMgKyBiZWZvcmUsXG4gICAgICAgICAgICAgICAgYWZ0ZXIgPSBjZWxscztcbiAgICAgICAgICAgIHdoaWxlKGFmdGVyID4gNykge1xuICAgICAgICAgICAgICAgIGFmdGVyIC09IDc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjZWxscyArPSA3IC0gYWZ0ZXI7XG4gICAgICAgICAgICB2YXIgaXNXZWVrU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCByID0gMDsgaSA8IGNlbGxzOyBpKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCAxICsgKGkgLSBiZWZvcmUpKSxcbiAgICAgICAgICAgICAgICAgICAgaXNTZWxlY3RlZCA9IGlzRGF0ZSh0aGlzLl9kKSA/IGNvbXBhcmVEYXRlcyhkYXksIHRoaXMuX2QpIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGlzVG9kYXkgPSBjb21wYXJlRGF0ZXMoZGF5LCBub3cpLFxuICAgICAgICAgICAgICAgICAgICBoYXNFdmVudCA9IG9wdHMuZXZlbnRzLmluZGV4T2YoZGF5LnRvRGF0ZVN0cmluZygpKSAhPT0gLTEgPyB0cnVlIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGlzRW1wdHkgPSBpIDwgYmVmb3JlIHx8IGkgPj0gKGRheXMgKyBiZWZvcmUpLFxuICAgICAgICAgICAgICAgICAgICBkYXlOdW1iZXIgPSAxICsgKGkgLSBiZWZvcmUpLFxuICAgICAgICAgICAgICAgICAgICBtb250aE51bWJlciA9IG1vbnRoLFxuICAgICAgICAgICAgICAgICAgICB5ZWFyTnVtYmVyID0geWVhcixcbiAgICAgICAgICAgICAgICAgICAgaXNTdGFydFJhbmdlID0gb3B0cy5zdGFydFJhbmdlICYmIGNvbXBhcmVEYXRlcyhvcHRzLnN0YXJ0UmFuZ2UsIGRheSksXG4gICAgICAgICAgICAgICAgICAgIGlzRW5kUmFuZ2UgPSBvcHRzLmVuZFJhbmdlICYmIGNvbXBhcmVEYXRlcyhvcHRzLmVuZFJhbmdlLCBkYXkpLFxuICAgICAgICAgICAgICAgICAgICBpc0luUmFuZ2UgPSBvcHRzLnN0YXJ0UmFuZ2UgJiYgb3B0cy5lbmRSYW5nZSAmJiBvcHRzLnN0YXJ0UmFuZ2UgPCBkYXkgJiYgZGF5IDwgb3B0cy5lbmRSYW5nZSxcbiAgICAgICAgICAgICAgICAgICAgaXNEaXNhYmxlZCA9IChvcHRzLm1pbkRhdGUgJiYgZGF5IDwgb3B0cy5taW5EYXRlKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG9wdHMubWF4RGF0ZSAmJiBkYXkgPiBvcHRzLm1heERhdGUpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAob3B0cy5kaXNhYmxlV2Vla2VuZHMgJiYgaXNXZWVrZW5kKGRheSkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAob3B0cy5kaXNhYmxlRGF5Rm4gJiYgb3B0cy5kaXNhYmxlRGF5Rm4oZGF5KSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNFbXB0eSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IGJlZm9yZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF5TnVtYmVyID0gZGF5c0luUHJldmlvdXNNb250aCArIGRheU51bWJlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoTnVtYmVyID0gcHJldmlvdXNNb250aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHllYXJOdW1iZXIgPSB5ZWFyT2ZQcmV2aW91c01vbnRoO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF5TnVtYmVyID0gZGF5TnVtYmVyIC0gZGF5cztcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoTnVtYmVyID0gbmV4dE1vbnRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgeWVhck51bWJlciA9IHllYXJPZk5leHRNb250aDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBkYXlDb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXk6IGRheU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoOiBtb250aE51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHllYXJOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNFdmVudDogaGFzRXZlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1NlbGVjdGVkOiBpc1NlbGVjdGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNUb2RheTogaXNUb2RheSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRGlzYWJsZWQ6IGlzRGlzYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0VtcHR5OiBpc0VtcHR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNTdGFydFJhbmdlOiBpc1N0YXJ0UmFuZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0VuZFJhbmdlOiBpc0VuZFJhbmdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNJblJhbmdlOiBpc0luUmFuZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93RGF5c0luTmV4dEFuZFByZXZpb3VzTW9udGhzOiBvcHRzLnNob3dEYXlzSW5OZXh0QW5kUHJldmlvdXNNb250aHNcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGlmIChvcHRzLnBpY2tXaG9sZVdlZWsgJiYgaXNTZWxlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICBpc1dlZWtTZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcm93LnB1c2gocmVuZGVyRGF5KGRheUNvbmZpZykpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCsrciA9PT0gNykge1xuICAgICAgICAgICAgICAgICAgICBpZiAob3B0cy5zaG93V2Vla051bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcm93LnVuc2hpZnQocmVuZGVyV2VlayhpIC0gYmVmb3JlLCBtb250aCwgeWVhcikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRhdGEucHVzaChyZW5kZXJSb3cocm93LCBvcHRzLmlzUlRMLCBvcHRzLnBpY2tXaG9sZVdlZWssIGlzV2Vla1NlbGVjdGVkKSk7XG4gICAgICAgICAgICAgICAgICAgIHJvdyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICByID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaXNXZWVrU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVuZGVyVGFibGUob3B0cywgZGF0YSwgcmFuZElkKTtcbiAgICAgICAgfSxcblxuICAgICAgICBpc1Zpc2libGU6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Y7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2hvdzogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNWaXNpYmxlKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl92ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXcoKTtcbiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyh0aGlzLmVsLCAnaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX28uYm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkRXZlbnQoZG9jdW1lbnQsICdjbGljaycsIHRoaXMuX29uQ2xpY2spO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkanVzdFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5fby5vbk9wZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fby5vbk9wZW4uY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgaGlkZTogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgdiA9IHRoaXMuX3Y7XG4gICAgICAgICAgICBpZiAodiAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fby5ib3VuZCkge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVFdmVudChkb2N1bWVudCwgJ2NsaWNrJywgdGhpcy5fb25DbGljayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZWwuc3R5bGUucG9zaXRpb24gPSAnc3RhdGljJzsgLy8gcmVzZXRcbiAgICAgICAgICAgICAgICB0aGlzLmVsLnN0eWxlLmxlZnQgPSAnYXV0byc7XG4gICAgICAgICAgICAgICAgdGhpcy5lbC5zdHlsZS50b3AgPSAnYXV0byc7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3ModGhpcy5lbCwgJ2lzLWhpZGRlbicpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3YgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAodiAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiB0aGlzLl9vLm9uQ2xvc2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fby5vbkNsb3NlLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHQU1FIE9WRVJcbiAgICAgICAgICovXG4gICAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICAgICAgICByZW1vdmVFdmVudCh0aGlzLmVsLCAnbW91c2Vkb3duJywgdGhpcy5fb25Nb3VzZURvd24sIHRydWUpO1xuICAgICAgICAgICAgcmVtb3ZlRXZlbnQodGhpcy5lbCwgJ3RvdWNoZW5kJywgdGhpcy5fb25Nb3VzZURvd24sIHRydWUpO1xuICAgICAgICAgICAgcmVtb3ZlRXZlbnQodGhpcy5lbCwgJ2NoYW5nZScsIHRoaXMuX29uQ2hhbmdlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9vLmZpZWxkKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlRXZlbnQodGhpcy5fby5maWVsZCwgJ2NoYW5nZScsIHRoaXMuX29uSW5wdXRDaGFuZ2UpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vLmJvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUV2ZW50KHRoaXMuX28udHJpZ2dlciwgJ2NsaWNrJywgdGhpcy5fb25JbnB1dENsaWNrKTtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRXZlbnQodGhpcy5fby50cmlnZ2VyLCAnZm9jdXMnLCB0aGlzLl9vbklucHV0Rm9jdXMpO1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVFdmVudCh0aGlzLl9vLnRyaWdnZXIsICdibHVyJywgdGhpcy5fb25JbnB1dEJsdXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmVsLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICByZXR1cm4gUGlrYWRheTtcblxufSkpO1xuIiwiIWZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gZShuKXtyZXR1cm5cInVuZGVmaW5lZFwiPT10eXBlb2YgdGhpc3x8T2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpIT09ZS5wcm90b3R5cGU/bmV3IGUobik6KE89dGhpcyxPLnZlcnNpb249XCIzLjMuNlwiLE8udG9vbHM9bmV3IEUsTy5pc1N1cHBvcnRlZCgpPyhPLnRvb2xzLmV4dGVuZChPLmRlZmF1bHRzLG58fHt9KSxPLmRlZmF1bHRzLmNvbnRhaW5lcj10KE8uZGVmYXVsdHMpLE8uc3RvcmU9e2VsZW1lbnRzOnt9LGNvbnRhaW5lcnM6W119LE8uc2VxdWVuY2VzPXt9LE8uaGlzdG9yeT1bXSxPLnVpZD0wLE8uaW5pdGlhbGl6ZWQ9ITEpOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBjb25zb2xlJiZudWxsIT09Y29uc29sZSxPKX1mdW5jdGlvbiB0KGUpe2lmKGUmJmUuY29udGFpbmVyKXtpZihcInN0cmluZ1wiPT10eXBlb2YgZS5jb250YWluZXIpcmV0dXJuIHdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucXVlcnlTZWxlY3RvcihlLmNvbnRhaW5lcik7aWYoTy50b29scy5pc05vZGUoZS5jb250YWluZXIpKXJldHVybiBlLmNvbnRhaW5lcn1yZXR1cm4gTy5kZWZhdWx0cy5jb250YWluZXJ9ZnVuY3Rpb24gbihlLHQpe3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiBlP0FycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHQucXVlcnlTZWxlY3RvckFsbChlKSk6Ty50b29scy5pc05vZGUoZSk/W2VdOk8udG9vbHMuaXNOb2RlTGlzdChlKT9BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChlKTpbXX1mdW5jdGlvbiBpKCl7cmV0dXJuKytPLnVpZH1mdW5jdGlvbiBvKGUsdCxuKXt0LmNvbnRhaW5lciYmKHQuY29udGFpbmVyPW4pLGUuY29uZmlnP2UuY29uZmlnPU8udG9vbHMuZXh0ZW5kQ2xvbmUoZS5jb25maWcsdCk6ZS5jb25maWc9Ty50b29scy5leHRlbmRDbG9uZShPLmRlZmF1bHRzLHQpLFwidG9wXCI9PT1lLmNvbmZpZy5vcmlnaW58fFwiYm90dG9tXCI9PT1lLmNvbmZpZy5vcmlnaW4/ZS5jb25maWcuYXhpcz1cIllcIjplLmNvbmZpZy5heGlzPVwiWFwifWZ1bmN0aW9uIHIoZSl7dmFyIHQ9d2luZG93LmdldENvbXB1dGVkU3R5bGUoZS5kb21FbCk7ZS5zdHlsZXN8fChlLnN0eWxlcz17dHJhbnNpdGlvbjp7fSx0cmFuc2Zvcm06e30sY29tcHV0ZWQ6e319LGUuc3R5bGVzLmlubGluZT1lLmRvbUVsLmdldEF0dHJpYnV0ZShcInN0eWxlXCIpfHxcIlwiLGUuc3R5bGVzLmlubGluZSs9XCI7IHZpc2liaWxpdHk6IHZpc2libGU7IFwiLGUuc3R5bGVzLmNvbXB1dGVkLm9wYWNpdHk9dC5vcGFjaXR5LHQudHJhbnNpdGlvbiYmXCJhbGwgMHMgZWFzZSAwc1wiIT09dC50cmFuc2l0aW9uP2Uuc3R5bGVzLmNvbXB1dGVkLnRyYW5zaXRpb249dC50cmFuc2l0aW9uK1wiLCBcIjplLnN0eWxlcy5jb21wdXRlZC50cmFuc2l0aW9uPVwiXCIpLGUuc3R5bGVzLnRyYW5zaXRpb24uaW5zdGFudD1zKGUsMCksZS5zdHlsZXMudHJhbnNpdGlvbi5kZWxheWVkPXMoZSxlLmNvbmZpZy5kZWxheSksZS5zdHlsZXMudHJhbnNmb3JtLmluaXRpYWw9XCIgLXdlYmtpdC10cmFuc2Zvcm06XCIsZS5zdHlsZXMudHJhbnNmb3JtLnRhcmdldD1cIiAtd2Via2l0LXRyYW5zZm9ybTpcIixhKGUpLGUuc3R5bGVzLnRyYW5zZm9ybS5pbml0aWFsKz1cInRyYW5zZm9ybTpcIixlLnN0eWxlcy50cmFuc2Zvcm0udGFyZ2V0Kz1cInRyYW5zZm9ybTpcIixhKGUpfWZ1bmN0aW9uIHMoZSx0KXt2YXIgbj1lLmNvbmZpZztyZXR1cm5cIi13ZWJraXQtdHJhbnNpdGlvbjogXCIrZS5zdHlsZXMuY29tcHV0ZWQudHJhbnNpdGlvbitcIi13ZWJraXQtdHJhbnNmb3JtIFwiK24uZHVyYXRpb24vMWUzK1wicyBcIituLmVhc2luZytcIiBcIit0LzFlMytcInMsIG9wYWNpdHkgXCIrbi5kdXJhdGlvbi8xZTMrXCJzIFwiK24uZWFzaW5nK1wiIFwiK3QvMWUzK1wiczsgdHJhbnNpdGlvbjogXCIrZS5zdHlsZXMuY29tcHV0ZWQudHJhbnNpdGlvbitcInRyYW5zZm9ybSBcIituLmR1cmF0aW9uLzFlMytcInMgXCIrbi5lYXNpbmcrXCIgXCIrdC8xZTMrXCJzLCBvcGFjaXR5IFwiK24uZHVyYXRpb24vMWUzK1wicyBcIituLmVhc2luZytcIiBcIit0LzFlMytcInM7IFwifWZ1bmN0aW9uIGEoZSl7dmFyIHQsbj1lLmNvbmZpZyxpPWUuc3R5bGVzLnRyYW5zZm9ybTt0PVwidG9wXCI9PT1uLm9yaWdpbnx8XCJsZWZ0XCI9PT1uLm9yaWdpbj8vXi0vLnRlc3Qobi5kaXN0YW5jZSk/bi5kaXN0YW5jZS5zdWJzdHIoMSk6XCItXCIrbi5kaXN0YW5jZTpuLmRpc3RhbmNlLHBhcnNlSW50KG4uZGlzdGFuY2UpJiYoaS5pbml0aWFsKz1cIiB0cmFuc2xhdGVcIituLmF4aXMrXCIoXCIrdCtcIilcIixpLnRhcmdldCs9XCIgdHJhbnNsYXRlXCIrbi5heGlzK1wiKDApXCIpLG4uc2NhbGUmJihpLmluaXRpYWwrPVwiIHNjYWxlKFwiK24uc2NhbGUrXCIpXCIsaS50YXJnZXQrPVwiIHNjYWxlKDEpXCIpLG4ucm90YXRlLngmJihpLmluaXRpYWwrPVwiIHJvdGF0ZVgoXCIrbi5yb3RhdGUueCtcImRlZylcIixpLnRhcmdldCs9XCIgcm90YXRlWCgwKVwiKSxuLnJvdGF0ZS55JiYoaS5pbml0aWFsKz1cIiByb3RhdGVZKFwiK24ucm90YXRlLnkrXCJkZWcpXCIsaS50YXJnZXQrPVwiIHJvdGF0ZVkoMClcIiksbi5yb3RhdGUueiYmKGkuaW5pdGlhbCs9XCIgcm90YXRlWihcIituLnJvdGF0ZS56K1wiZGVnKVwiLGkudGFyZ2V0Kz1cIiByb3RhdGVaKDApXCIpLGkuaW5pdGlhbCs9XCI7IG9wYWNpdHk6IFwiK24ub3BhY2l0eStcIjtcIixpLnRhcmdldCs9XCI7IG9wYWNpdHk6IFwiK2Uuc3R5bGVzLmNvbXB1dGVkLm9wYWNpdHkrXCI7XCJ9ZnVuY3Rpb24gbChlKXt2YXIgdD1lLmNvbmZpZy5jb250YWluZXI7dCYmTy5zdG9yZS5jb250YWluZXJzLmluZGV4T2YodCk9PT0tMSYmTy5zdG9yZS5jb250YWluZXJzLnB1c2goZS5jb25maWcuY29udGFpbmVyKSxPLnN0b3JlLmVsZW1lbnRzW2UuaWRdPWV9ZnVuY3Rpb24gYyhlLHQsbil7dmFyIGk9e3RhcmdldDplLGNvbmZpZzp0LGludGVydmFsOm59O08uaGlzdG9yeS5wdXNoKGkpfWZ1bmN0aW9uIGYoKXtpZihPLmlzU3VwcG9ydGVkKCkpe3koKTtmb3IodmFyIGU9MDtlPE8uc3RvcmUuY29udGFpbmVycy5sZW5ndGg7ZSsrKU8uc3RvcmUuY29udGFpbmVyc1tlXS5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsZCksTy5zdG9yZS5jb250YWluZXJzW2VdLmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIixkKTtPLmluaXRpYWxpemVkfHwod2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIixkKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLGQpLE8uaW5pdGlhbGl6ZWQ9ITApfXJldHVybiBPfWZ1bmN0aW9uIGQoKXtUKHkpfWZ1bmN0aW9uIHUoKXt2YXIgZSx0LG4saTtPLnRvb2xzLmZvck93bihPLnNlcXVlbmNlcyxmdW5jdGlvbihvKXtpPU8uc2VxdWVuY2VzW29dLGU9ITE7Zm9yKHZhciByPTA7cjxpLmVsZW1JZHMubGVuZ3RoO3IrKyluPWkuZWxlbUlkc1tyXSx0PU8uc3RvcmUuZWxlbWVudHNbbl0scSh0KSYmIWUmJihlPSEwKTtpLmFjdGl2ZT1lfSl9ZnVuY3Rpb24geSgpe3ZhciBlLHQ7dSgpLE8udG9vbHMuZm9yT3duKE8uc3RvcmUuZWxlbWVudHMsZnVuY3Rpb24obil7dD1PLnN0b3JlLmVsZW1lbnRzW25dLGU9dyh0KSxnKHQpPyh0LmNvbmZpZy5iZWZvcmVSZXZlYWwodC5kb21FbCksZT90LmRvbUVsLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsdC5zdHlsZXMuaW5saW5lK3Quc3R5bGVzLnRyYW5zZm9ybS50YXJnZXQrdC5zdHlsZXMudHJhbnNpdGlvbi5kZWxheWVkKTp0LmRvbUVsLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsdC5zdHlsZXMuaW5saW5lK3Quc3R5bGVzLnRyYW5zZm9ybS50YXJnZXQrdC5zdHlsZXMudHJhbnNpdGlvbi5pbnN0YW50KSxwKFwicmV2ZWFsXCIsdCxlKSx0LnJldmVhbGluZz0hMCx0LnNlZW49ITAsdC5zZXF1ZW5jZSYmbSh0LGUpKTp2KHQpJiYodC5jb25maWcuYmVmb3JlUmVzZXQodC5kb21FbCksdC5kb21FbC5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLHQuc3R5bGVzLmlubGluZSt0LnN0eWxlcy50cmFuc2Zvcm0uaW5pdGlhbCt0LnN0eWxlcy50cmFuc2l0aW9uLmluc3RhbnQpLHAoXCJyZXNldFwiLHQpLHQucmV2ZWFsaW5nPSExKX0pfWZ1bmN0aW9uIG0oZSx0KXt2YXIgbj0wLGk9MCxvPU8uc2VxdWVuY2VzW2Uuc2VxdWVuY2UuaWRdO28uYmxvY2tlZD0hMCx0JiZcIm9ubG9hZFwiPT09ZS5jb25maWcudXNlRGVsYXkmJihpPWUuY29uZmlnLmRlbGF5KSxlLnNlcXVlbmNlLnRpbWVyJiYobj1NYXRoLmFicyhlLnNlcXVlbmNlLnRpbWVyLnN0YXJ0ZWQtbmV3IERhdGUpLHdpbmRvdy5jbGVhclRpbWVvdXQoZS5zZXF1ZW5jZS50aW1lcikpLGUuc2VxdWVuY2UudGltZXI9e3N0YXJ0ZWQ6bmV3IERhdGV9LGUuc2VxdWVuY2UudGltZXIuY2xvY2s9d2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXtvLmJsb2NrZWQ9ITEsZS5zZXF1ZW5jZS50aW1lcj1udWxsLGQoKX0sTWF0aC5hYnMoby5pbnRlcnZhbCkraS1uKX1mdW5jdGlvbiBwKGUsdCxuKXt2YXIgaT0wLG89MCxyPVwiYWZ0ZXJcIjtzd2l0Y2goZSl7Y2FzZVwicmV2ZWFsXCI6bz10LmNvbmZpZy5kdXJhdGlvbixuJiYobys9dC5jb25maWcuZGVsYXkpLHIrPVwiUmV2ZWFsXCI7YnJlYWs7Y2FzZVwicmVzZXRcIjpvPXQuY29uZmlnLmR1cmF0aW9uLHIrPVwiUmVzZXRcIn10LnRpbWVyJiYoaT1NYXRoLmFicyh0LnRpbWVyLnN0YXJ0ZWQtbmV3IERhdGUpLHdpbmRvdy5jbGVhclRpbWVvdXQodC50aW1lci5jbG9jaykpLHQudGltZXI9e3N0YXJ0ZWQ6bmV3IERhdGV9LHQudGltZXIuY2xvY2s9d2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXt0LmNvbmZpZ1tyXSh0LmRvbUVsKSx0LnRpbWVyPW51bGx9LG8taSl9ZnVuY3Rpb24gZyhlKXtpZihlLnNlcXVlbmNlKXt2YXIgdD1PLnNlcXVlbmNlc1tlLnNlcXVlbmNlLmlkXTtyZXR1cm4gdC5hY3RpdmUmJiF0LmJsb2NrZWQmJiFlLnJldmVhbGluZyYmIWUuZGlzYWJsZWR9cmV0dXJuIHEoZSkmJiFlLnJldmVhbGluZyYmIWUuZGlzYWJsZWR9ZnVuY3Rpb24gdyhlKXt2YXIgdD1lLmNvbmZpZy51c2VEZWxheTtyZXR1cm5cImFsd2F5c1wiPT09dHx8XCJvbmxvYWRcIj09PXQmJiFPLmluaXRpYWxpemVkfHxcIm9uY2VcIj09PXQmJiFlLnNlZW59ZnVuY3Rpb24gdihlKXtpZihlLnNlcXVlbmNlKXt2YXIgdD1PLnNlcXVlbmNlc1tlLnNlcXVlbmNlLmlkXTtyZXR1cm4hdC5hY3RpdmUmJmUuY29uZmlnLnJlc2V0JiZlLnJldmVhbGluZyYmIWUuZGlzYWJsZWR9cmV0dXJuIXEoZSkmJmUuY29uZmlnLnJlc2V0JiZlLnJldmVhbGluZyYmIWUuZGlzYWJsZWR9ZnVuY3Rpb24gYihlKXtyZXR1cm57d2lkdGg6ZS5jbGllbnRXaWR0aCxoZWlnaHQ6ZS5jbGllbnRIZWlnaHR9fWZ1bmN0aW9uIGgoZSl7aWYoZSYmZSE9PXdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpe3ZhciB0PXgoZSk7cmV0dXJue3g6ZS5zY3JvbGxMZWZ0K3QubGVmdCx5OmUuc2Nyb2xsVG9wK3QudG9wfX1yZXR1cm57eDp3aW5kb3cucGFnZVhPZmZzZXQseTp3aW5kb3cucGFnZVlPZmZzZXR9fWZ1bmN0aW9uIHgoZSl7dmFyIHQ9MCxuPTAsaT1lLm9mZnNldEhlaWdodCxvPWUub2Zmc2V0V2lkdGg7ZG8gaXNOYU4oZS5vZmZzZXRUb3ApfHwodCs9ZS5vZmZzZXRUb3ApLGlzTmFOKGUub2Zmc2V0TGVmdCl8fChuKz1lLm9mZnNldExlZnQpLGU9ZS5vZmZzZXRQYXJlbnQ7d2hpbGUoZSk7cmV0dXJue3RvcDp0LGxlZnQ6bixoZWlnaHQ6aSx3aWR0aDpvfX1mdW5jdGlvbiBxKGUpe2Z1bmN0aW9uIHQoKXt2YXIgdD1jK2EqcyxuPWYrbCpzLGk9ZC1hKnMseT11LWwqcyxtPXIueStlLmNvbmZpZy52aWV3T2Zmc2V0LnRvcCxwPXIueCtlLmNvbmZpZy52aWV3T2Zmc2V0LmxlZnQsZz1yLnktZS5jb25maWcudmlld09mZnNldC5ib3R0b20rby5oZWlnaHQsdz1yLngtZS5jb25maWcudmlld09mZnNldC5yaWdodCtvLndpZHRoO3JldHVybiB0PGcmJmk+bSYmbjx3JiZ5PnB9ZnVuY3Rpb24gbigpe3JldHVyblwiZml4ZWRcIj09PXdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGUuZG9tRWwpLnBvc2l0aW9ufXZhciBpPXgoZS5kb21FbCksbz1iKGUuY29uZmlnLmNvbnRhaW5lcikscj1oKGUuY29uZmlnLmNvbnRhaW5lcikscz1lLmNvbmZpZy52aWV3RmFjdG9yLGE9aS5oZWlnaHQsbD1pLndpZHRoLGM9aS50b3AsZj1pLmxlZnQsZD1jK2EsdT1mK2w7cmV0dXJuIHQoKXx8bigpfWZ1bmN0aW9uIEUoKXt9dmFyIE8sVDtlLnByb3RvdHlwZS5kZWZhdWx0cz17b3JpZ2luOlwiYm90dG9tXCIsZGlzdGFuY2U6XCIyMHB4XCIsZHVyYXRpb246NTAwLGRlbGF5OjAscm90YXRlOnt4OjAseTowLHo6MH0sb3BhY2l0eTowLHNjYWxlOi45LGVhc2luZzpcImN1YmljLWJlemllcigwLjYsIDAuMiwgMC4xLCAxKVwiLGNvbnRhaW5lcjp3aW5kb3cuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LG1vYmlsZTohMCxyZXNldDohMSx1c2VEZWxheTpcImFsd2F5c1wiLHZpZXdGYWN0b3I6LjIsdmlld09mZnNldDp7dG9wOjAscmlnaHQ6MCxib3R0b206MCxsZWZ0OjB9LGJlZm9yZVJldmVhbDpmdW5jdGlvbihlKXt9LGJlZm9yZVJlc2V0OmZ1bmN0aW9uKGUpe30sYWZ0ZXJSZXZlYWw6ZnVuY3Rpb24oZSl7fSxhZnRlclJlc2V0OmZ1bmN0aW9uKGUpe319LGUucHJvdG90eXBlLmlzU3VwcG9ydGVkPWZ1bmN0aW9uKCl7dmFyIGU9ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlO3JldHVyblwiV2Via2l0VHJhbnNpdGlvblwiaW4gZSYmXCJXZWJraXRUcmFuc2Zvcm1cImluIGV8fFwidHJhbnNpdGlvblwiaW4gZSYmXCJ0cmFuc2Zvcm1cImluIGV9LGUucHJvdG90eXBlLnJldmVhbD1mdW5jdGlvbihlLHMsYSxkKXt2YXIgdSx5LG0scCxnLHc7aWYodm9pZCAwIT09cyYmXCJudW1iZXJcIj09dHlwZW9mIHM/KGE9cyxzPXt9KTp2b2lkIDAhPT1zJiZudWxsIT09c3x8KHM9e30pLHU9dChzKSx5PW4oZSx1KSwheS5sZW5ndGgpcmV0dXJuIE87YSYmXCJudW1iZXJcIj09dHlwZW9mIGEmJih3PWkoKSxnPU8uc2VxdWVuY2VzW3ddPXtpZDp3LGludGVydmFsOmEsZWxlbUlkczpbXSxhY3RpdmU6ITF9KTtmb3IodmFyIHY9MDt2PHkubGVuZ3RoO3YrKylwPXlbdl0uZ2V0QXR0cmlidXRlKFwiZGF0YS1zci1pZFwiKSxwP209Ty5zdG9yZS5lbGVtZW50c1twXToobT17aWQ6aSgpLGRvbUVsOnlbdl0sc2VlbjohMSxyZXZlYWxpbmc6ITF9LG0uZG9tRWwuc2V0QXR0cmlidXRlKFwiZGF0YS1zci1pZFwiLG0uaWQpKSxnJiYobS5zZXF1ZW5jZT17aWQ6Zy5pZCxpbmRleDpnLmVsZW1JZHMubGVuZ3RofSxnLmVsZW1JZHMucHVzaChtLmlkKSksbyhtLHMsdSkscihtKSxsKG0pLE8udG9vbHMuaXNNb2JpbGUoKSYmIW0uY29uZmlnLm1vYmlsZXx8IU8uaXNTdXBwb3J0ZWQoKT8obS5kb21FbC5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLG0uc3R5bGVzLmlubGluZSksbS5kaXNhYmxlZD0hMCk6bS5yZXZlYWxpbmd8fG0uZG9tRWwuc2V0QXR0cmlidXRlKFwic3R5bGVcIixtLnN0eWxlcy5pbmxpbmUrbS5zdHlsZXMudHJhbnNmb3JtLmluaXRpYWwpO3JldHVybiFkJiZPLmlzU3VwcG9ydGVkKCkmJihjKGUscyxhKSxPLmluaXRUaW1lb3V0JiZ3aW5kb3cuY2xlYXJUaW1lb3V0KE8uaW5pdFRpbWVvdXQpLE8uaW5pdFRpbWVvdXQ9d2luZG93LnNldFRpbWVvdXQoZiwwKSksT30sZS5wcm90b3R5cGUuc3luYz1mdW5jdGlvbigpe2lmKE8uaGlzdG9yeS5sZW5ndGgmJk8uaXNTdXBwb3J0ZWQoKSl7Zm9yKHZhciBlPTA7ZTxPLmhpc3RvcnkubGVuZ3RoO2UrKyl7dmFyIHQ9Ty5oaXN0b3J5W2VdO08ucmV2ZWFsKHQudGFyZ2V0LHQuY29uZmlnLHQuaW50ZXJ2YWwsITApfWYoKX1yZXR1cm4gT30sRS5wcm90b3R5cGUuaXNPYmplY3Q9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPT1lJiZcIm9iamVjdFwiPT10eXBlb2YgZSYmZS5jb25zdHJ1Y3Rvcj09PU9iamVjdH0sRS5wcm90b3R5cGUuaXNOb2RlPWZ1bmN0aW9uKGUpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiB3aW5kb3cuTm9kZT9lIGluc3RhbmNlb2Ygd2luZG93Lk5vZGU6ZSYmXCJvYmplY3RcIj09dHlwZW9mIGUmJlwibnVtYmVyXCI9PXR5cGVvZiBlLm5vZGVUeXBlJiZcInN0cmluZ1wiPT10eXBlb2YgZS5ub2RlTmFtZX0sRS5wcm90b3R5cGUuaXNOb2RlTGlzdD1mdW5jdGlvbihlKXt2YXIgdD1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZSksbj0vXlxcW29iamVjdCAoSFRNTENvbGxlY3Rpb258Tm9kZUxpc3R8T2JqZWN0KVxcXSQvO3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiB3aW5kb3cuTm9kZUxpc3Q/ZSBpbnN0YW5jZW9mIHdpbmRvdy5Ob2RlTGlzdDplJiZcIm9iamVjdFwiPT10eXBlb2YgZSYmbi50ZXN0KHQpJiZcIm51bWJlclwiPT10eXBlb2YgZS5sZW5ndGgmJigwPT09ZS5sZW5ndGh8fHRoaXMuaXNOb2RlKGVbMF0pKX0sRS5wcm90b3R5cGUuZm9yT3duPWZ1bmN0aW9uKGUsdCl7aWYoIXRoaXMuaXNPYmplY3QoZSkpdGhyb3cgbmV3IFR5cGVFcnJvcignRXhwZWN0ZWQgXCJvYmplY3RcIiwgYnV0IHJlY2VpdmVkIFwiJyt0eXBlb2YgZSsnXCIuJyk7Zm9yKHZhciBuIGluIGUpZS5oYXNPd25Qcm9wZXJ0eShuKSYmdChuKX0sRS5wcm90b3R5cGUuZXh0ZW5kPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZm9yT3duKHQsZnVuY3Rpb24obil7dGhpcy5pc09iamVjdCh0W25dKT8oZVtuXSYmdGhpcy5pc09iamVjdChlW25dKXx8KGVbbl09e30pLHRoaXMuZXh0ZW5kKGVbbl0sdFtuXSkpOmVbbl09dFtuXX0uYmluZCh0aGlzKSksZX0sRS5wcm90b3R5cGUuZXh0ZW5kQ2xvbmU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5leHRlbmQodGhpcy5leHRlbmQoe30sZSksdCl9LEUucHJvdG90eXBlLmlzTW9iaWxlPWZ1bmN0aW9uKCl7cmV0dXJuL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpfSxUPXdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZ1bmN0aW9uKGUpe3dpbmRvdy5zZXRUaW1lb3V0KGUsMWUzLzYwKX0sXCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZcIm9iamVjdFwiPT10eXBlb2YgZGVmaW5lLmFtZCYmZGVmaW5lLmFtZD9kZWZpbmUoZnVuY3Rpb24oKXtyZXR1cm4gZX0pOlwidW5kZWZpbmVkXCIhPXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWU6d2luZG93LlNjcm9sbFJldmVhbD1lfSgpO1xuIiwiLyoqXG4gKiBzaGF2ZSAtIFNoYXZlIGlzIGEgamF2YXNjcmlwdCBwbHVnaW4gdGhhdCB0cnVuY2F0ZXMgbXVsdGktbGluZSB0ZXh0IHdpdGhpbiBhIGh0bWwgZWxlbWVudCBiYXNlZCBvbiBzZXQgbWF4IGhlaWdodFxuICogQHZlcnNpb24gdjIuMS43XG4gKiBAbGluayBodHRwczovL2dpdGh1Yi5jb20vZG9sbGFyc2hhdmVjbHViL3NoYXZlI3JlYWRtZVxuICogQGF1dGhvciBKZWZmIFdhaW53cmlnaHQgPGpqd2FpbndyaWdodDJAZ21haWwuY29tPiAoamVmZnJ5LmluKVxuICogQGxpY2Vuc2UgTUlUICovXG4hZnVuY3Rpb24oZSx0KXtcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cyYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz10KCk6XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZSh0KTplLnNoYXZlPXQoKX0odGhpcyxmdW5jdGlvbigpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGUoZSx0KXt2YXIgbj1hcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06e307aWYoIXQpdGhyb3cgRXJyb3IoXCJtYXhIZWlnaHQgaXMgcmVxdWlyZWRcIik7dmFyIGk9XCJzdHJpbmdcIj09dHlwZW9mIGU/ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChlKTplO2lmKGkpe3ZhciByPW4uY2hhcmFjdGVyfHxcIuKAplwiLHM9bi5jbGFzc25hbWV8fFwianMtc2hhdmVcIixhPW4uc3BhY2VzfHwhMCxvPSc8c3BhbiBjbGFzcz1cImpzLXNoYXZlLWNoYXJcIj4nK3IrXCI8L3NwYW4+XCI7XCJsZW5ndGhcImluIGl8fChpPVtpXSk7Zm9yKHZhciBoPTA7aDxpLmxlbmd0aDtoKz0xKXt2YXIgYz1pW2hdLGw9Yy5zdHlsZSxmPWMucXVlcnlTZWxlY3RvcihcIi5cIitzKSxkPXZvaWQgMD09PWMudGV4dENvbnRlbnQ/XCJpbm5lclRleHRcIjpcInRleHRDb250ZW50XCI7ZiYmKGMucmVtb3ZlQ2hpbGQoYy5xdWVyeVNlbGVjdG9yKFwiLmpzLXNoYXZlLWNoYXJcIikpLGNbZF09Y1tkXSk7dmFyIHY9Y1tkXSxnPWE/djp2LnNwbGl0KFwiIFwiKTtpZighKGcubGVuZ3RoPDIpKXt2YXIgdT1sLmhlaWdodDtsLmhlaWdodD1cImF1dG9cIjt2YXIgcD1sLm1heEhlaWdodDtpZihsLm1heEhlaWdodD1cIm5vbmVcIixjLm9mZnNldEhlaWdodDw9dClsLmhlaWdodD11LGwubWF4SGVpZ2h0PXA7ZWxzZXtmb3IodmFyIG09Zy5sZW5ndGgtMSxqPTAseD12b2lkIDA7ajxtOyl4PWorbSsxPj4xLGNbZF09YT9nLnNsaWNlKDAseCk6Zy5zbGljZSgwLHgpLmpvaW4oXCIgXCIpLGMuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsbyksYy5vZmZzZXRIZWlnaHQ+dD9tPWE/eC0yOngtMTpqPXg7Y1tkXT1hP2cuc2xpY2UoMCxtKTpnLnNsaWNlKDAsbSkuam9pbihcIiBcIiksYy5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIixvKTt2YXIgeT1hP2cuc2xpY2UobSk6Zy5zbGljZShtKS5qb2luKFwiIFwiKTtjLmluc2VydEFkamFjZW50SFRNTChcImJlZm9yZWVuZFwiLCc8c3BhbiBjbGFzcz1cIicrcysnXCIgc3R5bGU9XCJkaXNwbGF5Om5vbmU7XCI+Jyt5K1wiPC9zcGFuPlwiKSxsLmhlaWdodD11LGwubWF4SGVpZ2h0PXB9fX19fXJldHVybiBlfSk7IiwiLyoqXG4gKiBTaW1wbGUgTWFzayBNb25leSAoZWRpdGVkKVxuICogUGVndWVpIG8gY8OzZGlnbyBvcmlnaW5hbCwgY29udmVydGkgcHJhIDxlczYgbm8gYmFiZWxcbiAqIGUgZml6IGFsZ3VtYXMgbW9kaWZpY2HDp8O1ZXMgcHJhIGZ1bmNpb25hci5cbiAqIEBsaW5rOiBodHRwczovL2dpdGh1Yi5jb20vY29kZXJtYXJjb3Mvc2ltcGxlLW1hc2stbW9uZXkvYmxvYi9tYXN0ZXIvbGliL3NpbXBsZS1tYXNrLW1vbmV5LmpzXG4gKiBAcmV0dXJuIHtTdHJpbmd9IE1vbmV5IGZvcm1hdGVkXG4gKi9cbnZhciBTaW1wbGVNYXNrTW9uZXkgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBhcmdzID0ge1xuICAgIHByZWZpeDogJycsXG4gICAgc3VmZml4OiAnJyxcbiAgICBmaXhlZDogdHJ1ZSxcbiAgICBmcmFjdGlvbkRpZ2l0czogMixcbiAgICBkZWNpbWFsU2VwYXJhdG9yOiAnLCcsXG4gICAgdGhvdXNhbmRzU2VwYXJhdG9yOiAnLicsXG4gICAgYXV0b0NvbXBsZXRlRGVjaW1hbDogZmFsc2UsXG4gICAgZW1wdHlPckludmFsaWQ6IGZ1bmN0aW9uIGVtcHR5T3JJbnZhbGlkKCkge1xuICAgICAgcmV0dXJuIGFyZ3MuZml4ZWQgPyAnMCcgKyBhcmdzLmRlY2ltYWxTZXBhcmF0b3IgKyAnMDAnIDogJ18nICsgYXJncy5kZWNpbWFsU2VwYXJhdG9yICsgJ19fJztcbiAgICB9XG4gIH07XG5cbiAgdmFyIGZ1bmN0aW9ucyA9IHtcbiAgICBnZXQgYXJncygpIHtcbiAgICAgIHJldHVybiBhcmdzO1xuICAgIH0sXG4gICAgc2V0IGFyZ3ModmFsdWUpIHtcbiAgICAgIGFyZ3MgPSBPYmplY3QuYXNzaWduKGFyZ3MsIHZhbHVlKTtcbiAgICAgIGFyZ3MucHJlZml4ID0gdmFsdWUucHJlZml4IHx8IHZhbHVlLnByZWZmaXg7XG4gICAgfSxcblxuICAgIG9ubHlOdW1iZXI6IGZ1bmN0aW9uIG9ubHlOdW1iZXIodmFsdWUpIHtcbiAgICAgIHZhciByZXRvcm5vID0gJyc7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmFsdWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGlzRmluaXRlKHZhbHVlW2ldKSkge1xuICAgICAgICAgIHJldG9ybm8gKz0gdmFsdWVbaV07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJldG9ybm87XG4gICAgfSxcblxuICAgIGFkZGluZ1ByZWZpeDogZnVuY3Rpb24gYWRkaW5nUHJlZml4KHZhbHVlKSB7XG4gICAgICByZXR1cm4gJycgKyBhcmdzLnByZWZpeCArIHZhbHVlO1xuICAgIH0sXG4gICAgcmVtb3ZpbmdQcmVmaXg6IGZ1bmN0aW9uIHJlbW92aW5nUHJlZml4KHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWUucmVwbGFjZShhcmdzLnByZWZpeCwgJycpO1xuICAgIH0sXG5cbiAgICBhZGRpbmdTdWZmaXg6IGZ1bmN0aW9uIGFkZGluZ1N1ZmZpeCh2YWx1ZSkge1xuICAgICAgcmV0dXJuICcnICsgdmFsdWUgKyBhcmdzLnN1ZmZpeDtcbiAgICB9LFxuICAgIHJlbW92aW5nU3VmZml4OiBmdW5jdGlvbiByZW1vdmluZ1N1ZmZpeCh2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlLmluY2x1ZGVzKGFyZ3Muc3VmZml4LCB2YWx1ZS5sZW5ndGggLSBhcmdzLmZyYWN0aW9uRGlnaXRzKSkge1xuICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoYXJncy5zdWZmaXgsICcnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhbHVlID0gdmFsdWUuc3Vic3RyaW5nKDAsIHZhbHVlLmxlbmd0aCAtIDEpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBhZGRpbmdDb21wbGV0ZXJGcm9tU3RhcnQ6IGZ1bmN0aW9uIGFkZGluZ0NvbXBsZXRlckZyb21TdGFydCh2YWx1ZSwgY29tcGxldGVyKSB7XG4gICAgICB3aGlsZSAodmFsdWUubGVuZ3RoIDwgYXJncy5mcmFjdGlvbkRpZ2l0cykge1xuICAgICAgICB2YWx1ZSA9ICcnICsgY29tcGxldGVyICsgdmFsdWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcblxuICAgIGFkZGluZ0NvbXBsZXRlckZyb21FbmQ6IGZ1bmN0aW9uIGFkZGluZ0NvbXBsZXRlckZyb21FbmQodmFsdWUsIGNvbXBsZXRlcikge1xuICAgICAgd2hpbGUgKHZhbHVlLmxlbmd0aCA8IGFyZ3MuZnJhY3Rpb25EaWdpdHMpIHtcbiAgICAgICAgdmFsdWUgPSAnJyArIHZhbHVlICsgY29tcGxldGVyO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICByZW1vdmluZ0NvbXBsZXRlckZyb21TdGFydDogZnVuY3Rpb24gcmVtb3ZpbmdDb21wbGV0ZXJGcm9tU3RhcnQodmFsdWUsIGNvbXBsZXRlcikge1xuICAgICAgd2hpbGUgKHZhbHVlWzBdID09PSBjb21wbGV0ZXIpIHtcbiAgICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKGNvbXBsZXRlciwgJycpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICByZW1vdmluZ0NvbXBsZXRlckZyb21FbmQ6IGZ1bmN0aW9uIHJlbW92aW5nQ29tcGxldGVyRnJvbUVuZCh2YWx1ZSwgY29tcGxldGVyKSB7XG4gICAgICB3aGlsZSAodmFsdWVbdmFsdWUubGVuZ3RoIC0gMV0gPT09IGNvbXBsZXRlcikge1xuICAgICAgICB2YWx1ZSA9IHZhbHVlLnN1YnN0cmluZygwLCB2YWx1ZS5sZW5ndGggLSAxKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuXG4gICAgYWRkaW5nQXV0b0NvbXBsZXRlOiBmdW5jdGlvbiBhZGRpbmdBdXRvQ29tcGxldGUodmFsdWUpIHtcbiAgICAgIHZhciBuID0gJycgKyB2YWx1ZSArIGZ1bmN0aW9ucy5hZGRpbmdDb21wbGV0ZXJGcm9tRW5kKCcnLCAnMCcpO1xuICAgICAgcmV0dXJuIG47XG4gICAgfSxcblxuICAgIGF1dG9Db21wbGV0ZTogZnVuY3Rpb24gYXV0b0NvbXBsZXRlKHZhbHVlKSB7XG4gICAgICB2YXIgYXJyYXkgPSB2YWx1ZS5tYXRjaChuZXcgUmVnRXhwKCdcXFxcJyArIGFyZ3MuZGVjaW1hbFNlcGFyYXRvciwgJ2cnKSkgfHwgW107XG4gICAgICBpZiAoYXJyYXkubGVuZ3RoID4gMSkge1xuICAgICAgICB2YWx1ZSA9IGZ1bmN0aW9ucy5hZGRpbmdBdXRvQ29tcGxldGUodmFsdWUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG5cbiAgICBhZGRpbmdEZWNpbWFsU2VwYXJhdG9yOiBmdW5jdGlvbiBhZGRpbmdEZWNpbWFsU2VwYXJhdG9yKHZhbHVlLCBjb21wbGV0ZXIsIHNlcGFyYXRvcikge1xuICAgICAgdmFyIGxlbmd0aCA9IHZhbHVlLmxlbmd0aCAtIGFyZ3MuZnJhY3Rpb25EaWdpdHM7XG5cbiAgICAgIHZhciByZWdleHBGcmFjdGlvbiA9IHZvaWQgMDtcbiAgICAgIHZhciBkZWNpbWFscyA9ICckMSc7XG4gICAgICB2YXIgZGV6ZW5hcyA9IGNvbXBsZXRlcjtcbiAgICAgIHZhciBjaGFyYWN0ZXIgPSBpc0Zpbml0ZShjb21wbGV0ZXIpID8gJ2QnIDogJ3cnO1xuXG4gICAgICByZWdleHBGcmFjdGlvbiA9ICcoXFxcXCcgKyBjaGFyYWN0ZXIgKyAneycgKyBhcmdzLmZyYWN0aW9uRGlnaXRzICsgJ30pJztcbiAgICAgIGlmIChsZW5ndGggPiAwKSB7XG4gICAgICAgIHJlZ2V4cEZyYWN0aW9uID0gJyhcXFxcJyArIGNoYXJhY3RlciArICd7JyArIGxlbmd0aCArICd9KScgKyByZWdleHBGcmFjdGlvbjtcbiAgICAgICAgZGV6ZW5hcyA9IGRlY2ltYWxzO1xuICAgICAgICBkZWNpbWFscyA9ICckMic7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKG5ldyBSZWdFeHAocmVnZXhwRnJhY3Rpb24pLCAnJyArIGRlemVuYXMgKyBzZXBhcmF0b3IgKyBkZWNpbWFscyk7XG4gICAgfSxcblxuICAgIGFkZGluZ0h1bmRyZWRzU2VwYXJhdG9yOiBmdW5jdGlvbiBhZGRpbmdIdW5kcmVkc1NlcGFyYXRvcih2YWx1ZSkge1xuICAgICAgdmFyIHNpemUgPSB2YWx1ZS5sZW5ndGggLSBhcmdzLmZyYWN0aW9uRGlnaXRzO1xuICAgICAgdmFyIGh1bmRyZWRzID0gTWF0aC5jZWlsKHNpemUgLyAzKTtcbiAgICAgIHZhciByZWdleHBIdW5kcmVkcyA9ICcoXFxcXGQpJztcblxuICAgICAgdmFyIHJlcGxhY2VtZW50ID0gYXJncy5kZWNpbWFsU2VwYXJhdG9yICsgJyQnICsgKGh1bmRyZWRzICsgMSk7XG5cbiAgICAgIGZvciAodmFyIGkgPSBodW5kcmVkczsgaSAhPT0gMDsgaS0tKSB7XG4gICAgICAgIGlmIChzaXplID49IDMpIHtcbiAgICAgICAgICByZWdleHBIdW5kcmVkcyA9ICcoXFxcXGR7M30pJyArIHJlZ2V4cEh1bmRyZWRzO1xuICAgICAgICAgIHNpemUgLT0gMztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZWdleHBIdW5kcmVkcyA9ICcoXFxcXGR7JyArIHNpemUgKyAnfSknICsgcmVnZXhwSHVuZHJlZHM7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaSA+IDEpIHtcbiAgICAgICAgICByZXBsYWNlbWVudCA9IGFyZ3MudGhvdXNhbmRzU2VwYXJhdG9yICsgJyQnICsgaSArIHJlcGxhY2VtZW50O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlcGxhY2VtZW50ID0gJyQnICsgaSArIHJlcGxhY2VtZW50O1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKG5ldyBSZWdFeHAocmVnZXhwSHVuZHJlZHMpLCByZXBsYWNlbWVudCk7XG4gICAgfSxcbiAgICByZW1vdmVTZXBhcmF0b3I6IGZ1bmN0aW9uIHJlbW92ZVNlcGFyYXRvcih2YWx1ZSwgc2VwYXJhdG9yKSB7XG4gICAgICByZXR1cm4gdmFsdWUucmVwbGFjZShuZXcgUmVnRXhwKCdcXFxcJyArIHNlcGFyYXRvciwgJ2cnKSwgJycpO1xuICAgIH0sXG4gICAgZm9ybWF0RGVjaW1hbDogZnVuY3Rpb24gZm9ybWF0RGVjaW1hbCh2YWx1ZSwgY29tcGxldGVyLCBzZXBhcmF0b3IpIHtcbiAgICAgIHZhbHVlID0gZnVuY3Rpb25zLmFkZGluZ0NvbXBsZXRlckZyb21TdGFydCh2YWx1ZSwgY29tcGxldGVyKTtcbiAgICAgIHZhbHVlID0gZnVuY3Rpb25zLmFkZGluZ0RlY2ltYWxTZXBhcmF0b3IodmFsdWUsIGNvbXBsZXRlciwgc2VwYXJhdG9yKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuXG4gICAgdGV4dFRvTnVtYmVyOiBmdW5jdGlvbiB0ZXh0VG9OdW1iZXIoaW5wdXQpIHtcbiAgICAgIHZhciByZXRvcm5vID0gaW5wdXQudG9TdHJpbmcoKTtcbiAgICAgIHZhciBjb21wbGV0ZXIgPSBhcmdzLmZpeGVkID8gJzAnIDogJ18nO1xuXG4gICAgICBpZiAoYXJncy5wcmVmaXgpIHtcbiAgICAgICAgcmV0b3JubyA9IGZ1bmN0aW9ucy5yZW1vdmluZ1ByZWZpeChyZXRvcm5vKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGFyZ3Muc3VmZml4KSB7XG4gICAgICAgIHJldG9ybm8gPSBmdW5jdGlvbnMucmVtb3ZpbmdTdWZmaXgocmV0b3Jubyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChhcmdzLmF1dG9Db21wbGV0ZURlY2ltYWwpIHtcbiAgICAgICAgcmV0b3JubyA9IGZ1bmN0aW9ucy5hdXRvQ29tcGxldGUocmV0b3Jubyk7XG4gICAgICB9XG5cbiAgICAgIHJldG9ybm8gPSBmdW5jdGlvbnMucmVtb3ZlU2VwYXJhdG9yKHJldG9ybm8sIGFyZ3MudGhvdXNhbmRzU2VwYXJhdG9yKTtcbiAgICAgIHJldG9ybm8gPSBmdW5jdGlvbnMucmVtb3ZlU2VwYXJhdG9yKHJldG9ybm8sIGFyZ3MuZGVjaW1hbFNlcGFyYXRvcik7XG5cbiAgICAgIHJldG9ybm8gPSBmdW5jdGlvbnMub25seU51bWJlcihyZXRvcm5vKTtcblxuICAgICAgcmV0b3JubyA9IGZ1bmN0aW9ucy5yZW1vdmluZ0NvbXBsZXRlckZyb21TdGFydChyZXRvcm5vLCBjb21wbGV0ZXIpO1xuXG4gICAgICByZXR1cm4gcmV0b3JubyB8fCAoYXJncy5maXhlZCA/ICcwJyA6ICcnKTtcbiAgICB9LFxuXG4gICAgbnVtYmVyVG9UZXh0OiBmdW5jdGlvbiBudW1iZXJUb1RleHQoaW5wdXQpIHtcbiAgICAgIHZhciByZXRvcm5vID0gYXJncy5lbXB0eU9ySW52YWxpZCgpO1xuXG4gICAgICBpZiAocGFyc2VGbG9hdChpbnB1dCkgIT09ICdOYU4nKSB7XG4gICAgICAgIGlmIChpbnB1dC5sZW5ndGggPD0gYXJncy5mcmFjdGlvbkRpZ2l0cykge1xuICAgICAgICAgIHJldG9ybm8gPSBmdW5jdGlvbnMuZm9ybWF0RGVjaW1hbChpbnB1dCwgYXJncy5maXhlZCA/ICcwJyA6ICdfJywgYXJncy5kZWNpbWFsU2VwYXJhdG9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXRvcm5vID0gZnVuY3Rpb25zLmFkZGluZ0h1bmRyZWRzU2VwYXJhdG9yKGlucHV0KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoYXJncy5wcmVmaXgpIHtcbiAgICAgICAgcmV0b3JubyA9IGZ1bmN0aW9ucy5hZGRpbmdQcmVmaXgocmV0b3Jubyk7XG4gICAgICB9XG4gICAgICBpZiAoYXJncy5zdWZmaXgpIHtcbiAgICAgICAgcmV0b3JubyA9IGZ1bmN0aW9ucy5hZGRpbmdTdWZmaXgocmV0b3Jubyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXRvcm5vO1xuICAgIH0sXG5cbiAgICBmb3JtYXQ6IGZ1bmN0aW9uIGZvcm1hdCh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9ucy5udW1iZXJUb1RleHQoZnVuY3Rpb25zLnRleHRUb051bWJlcih2YWx1ZSkpO1xuICAgIH0sXG5cbiAgICBmb3JtYXRUb051bWJlcjogZnVuY3Rpb24gZm9ybWF0VG9OdW1iZXIoaW5wdXQpIHtcbiAgICAgIHZhciByZXRvcm5vID0gJzAnO1xuICAgICAgdmFyIHZhbHVlID0gZnVuY3Rpb25zLnRleHRUb051bWJlcihpbnB1dCk7XG5cbiAgICAgIGlmIChwYXJzZUZsb2F0KHZhbHVlKSAhPT0gJ05hTicpIHtcbiAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA8PSBhcmdzLmZyYWN0aW9uRGlnaXRzKSB7XG4gICAgICAgICAgdmFsdWUgPSBmdW5jdGlvbnMuZm9ybWF0RGVjaW1hbCh2YWx1ZSwgJzAnLCAnLicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBsZW5ndGhXaXRob3V0RGVjaW1hbHMgPSB2YWx1ZS5sZW5ndGggLSBhcmdzLmZyYWN0aW9uRGlnaXRzO1xuICAgICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZShuZXcgUmVnRXhwKCcoXFxcXGR7JyArIGxlbmd0aFdpdGhvdXREZWNpbWFscyArICd9KShcXFxcZHsnICsgYXJncy5mcmFjdGlvbkRpZ2l0cyArICd9KScpLCAnJDEuJDInKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldG9ybm8gPSB2YWx1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHBhcnNlRmxvYXQocmV0b3Jubyk7XG4gICAgfSxcblxuICAgIHNldE1hc2s6IGZ1bmN0aW9uIHNldE1hc2soZWxlbWVudCwgYXJncykge1xuICAgICAgdmFyIGlucHV0ID0gdHlwZW9mIGVsZW1lbnQgPT0gJ3N0cmluZycgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnQpIDogZWxlbWVudDtcblxuICAgICAgaWYgKGFyZ3MpIHtcbiAgICAgICAgYXJncyA9IGFyZ3M7XG4gICAgICB9XG5cbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpbnB1dC52YWx1ZSA9IGZ1bmN0aW9ucy5mb3JtYXQoaW5wdXQudmFsdWUpO1xuICAgICAgfSk7XG4gICAgICBpbnB1dFsnZm9ybWF0VG9OdW1iZXInXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9ucy5mb3JtYXRUb051bWJlcihpbnB1dC52YWx1ZSk7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gaW5wdXQudmFsdWU7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBmdW5jdGlvbnM7XG59KCk7XG4iLCIvKiEgc21vb3RoLXNjcm9sbCB2MTQuMi4xIHwgKGMpIDIwMTggQ2hyaXMgRmVyZGluYW5kaSB8IE1JVCBMaWNlbnNlIHwgaHR0cDovL2dpdGh1Yi5jb20vY2ZlcmRpbmFuZGkvc21vb3RoLXNjcm9sbCAqL1xud2luZG93LkVsZW1lbnQmJiFFbGVtZW50LnByb3RvdHlwZS5jbG9zZXN0JiYoRWxlbWVudC5wcm90b3R5cGUuY2xvc2VzdD1mdW5jdGlvbihlKXt2YXIgdCxuPSh0aGlzLmRvY3VtZW50fHx0aGlzLm93bmVyRG9jdW1lbnQpLnF1ZXJ5U2VsZWN0b3JBbGwoZSksbz10aGlzO2Rve2Zvcih0PW4ubGVuZ3RoOy0tdD49MCYmbi5pdGVtKHQpIT09bzspO313aGlsZSh0PDAmJihvPW8ucGFyZW50RWxlbWVudCkpO3JldHVybiBvfSksKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe3Q9dHx8e2J1YmJsZXM6ITEsY2FuY2VsYWJsZTohMSxkZXRhaWw6dm9pZCAwfTt2YXIgbj1kb2N1bWVudC5jcmVhdGVFdmVudChcIkN1c3RvbUV2ZW50XCIpO3JldHVybiBuLmluaXRDdXN0b21FdmVudChlLHQuYnViYmxlcyx0LmNhbmNlbGFibGUsdC5kZXRhaWwpLG59aWYoXCJmdW5jdGlvblwiPT10eXBlb2Ygd2luZG93LkN1c3RvbUV2ZW50KXJldHVybiExO2UucHJvdG90eXBlPXdpbmRvdy5FdmVudC5wcm90b3R5cGUsd2luZG93LkN1c3RvbUV2ZW50PWV9KSgpLChmdW5jdGlvbigpe2Zvcih2YXIgZT0wLHQ9W1wibXNcIixcIm1velwiLFwid2Via2l0XCIsXCJvXCJdLG49MDtuPHQubGVuZ3RoJiYhd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZTsrK24pd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZT13aW5kb3dbdFtuXStcIlJlcXVlc3RBbmltYXRpb25GcmFtZVwiXSx3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWU9d2luZG93W3Rbbl0rXCJDYW5jZWxBbmltYXRpb25GcmFtZVwiXXx8d2luZG93W3Rbbl0rXCJDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcIl07d2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZXx8KHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU9ZnVuY3Rpb24odCxuKXt2YXIgbz0obmV3IERhdGUpLmdldFRpbWUoKSxpPU1hdGgubWF4KDAsMTYtKG8tZSkpLHI9d2luZG93LnNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7dChvK2kpfSksaSk7cmV0dXJuIGU9bytpLHJ9KSx3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWV8fCh3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWU9ZnVuY3Rpb24oZSl7Y2xlYXJUaW1lb3V0KGUpfSl9KSgpLChmdW5jdGlvbihlLHQpe1wiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoW10sKGZ1bmN0aW9uKCl7cmV0dXJuIHQoZSl9KSk6XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9dChlKTplLlNtb290aFNjcm9sbD10KGUpfSkoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGdsb2JhbD9nbG9iYWw6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dGhpcywoZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIHQ9e2lnbm9yZTpcIltkYXRhLXNjcm9sbC1pZ25vcmVdXCIsaGVhZGVyOm51bGwsdG9wT25FbXB0eUhhc2g6ITAsc3BlZWQ6NTAwLGNsaXA6ITAsb2Zmc2V0OjAsZWFzaW5nOlwiZWFzZUluT3V0Q3ViaWNcIixjdXN0b21FYXNpbmc6bnVsbCx1cGRhdGVVUkw6ITAscG9wc3RhdGU6ITAsZW1pdEV2ZW50czohMH0sbj1mdW5jdGlvbigpe3JldHVyblwicXVlcnlTZWxlY3RvclwiaW4gZG9jdW1lbnQmJlwiYWRkRXZlbnRMaXN0ZW5lclwiaW4gZSYmXCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWVcImluIGUmJlwiY2xvc2VzdFwiaW4gZS5FbGVtZW50LnByb3RvdHlwZX0sbz1mdW5jdGlvbigpe2Zvcih2YXIgZT17fSx0PTA7dDxhcmd1bWVudHMubGVuZ3RoO3QrKykhKGZ1bmN0aW9uKHQpe2Zvcih2YXIgbiBpbiB0KXQuaGFzT3duUHJvcGVydHkobikmJihlW25dPXRbbl0pfSkoYXJndW1lbnRzW3RdKTtyZXR1cm4gZX0saT1mdW5jdGlvbih0KXtyZXR1cm4hIShcIm1hdGNoTWVkaWFcImluIGUmJmUubWF0Y2hNZWRpYShcIihwcmVmZXJzLXJlZHVjZWQtbW90aW9uKVwiKS5tYXRjaGVzKX0scj1mdW5jdGlvbih0KXtyZXR1cm4gcGFyc2VJbnQoZS5nZXRDb21wdXRlZFN0eWxlKHQpLmhlaWdodCwxMCl9LGE9ZnVuY3Rpb24oZSl7dmFyIHQ7dHJ5e3Q9ZGVjb2RlVVJJQ29tcG9uZW50KGUpfWNhdGNoKG4pe3Q9ZX1yZXR1cm4gdH0sdT1mdW5jdGlvbihlKXtcIiNcIj09PWUuY2hhckF0KDApJiYoZT1lLnN1YnN0cigxKSk7Zm9yKHZhciB0LG49U3RyaW5nKGUpLG89bi5sZW5ndGgsaT0tMSxyPVwiXCIsYT1uLmNoYXJDb2RlQXQoMCk7KytpPG87KXtpZigwPT09KHQ9bi5jaGFyQ29kZUF0KGkpKSl0aHJvdyBuZXcgSW52YWxpZENoYXJhY3RlckVycm9yKFwiSW52YWxpZCBjaGFyYWN0ZXI6IHRoZSBpbnB1dCBjb250YWlucyBVKzAwMDAuXCIpO3Q+PTEmJnQ8PTMxfHwxMjc9PXR8fDA9PT1pJiZ0Pj00OCYmdDw9NTd8fDE9PT1pJiZ0Pj00OCYmdDw9NTcmJjQ1PT09YT9yKz1cIlxcXFxcIit0LnRvU3RyaW5nKDE2KStcIiBcIjpyKz10Pj0xMjh8fDQ1PT09dHx8OTU9PT10fHx0Pj00OCYmdDw9NTd8fHQ+PTY1JiZ0PD05MHx8dD49OTcmJnQ8PTEyMj9uLmNoYXJBdChpKTpcIlxcXFxcIituLmNoYXJBdChpKX12YXIgdTt0cnl7dT1kZWNvZGVVUklDb21wb25lbnQoXCIjXCIrcil9Y2F0Y2goZSl7dT1cIiNcIityfXJldHVybiB1fSxjPWZ1bmN0aW9uKGUsdCl7dmFyIG47cmV0dXJuXCJlYXNlSW5RdWFkXCI9PT1lLmVhc2luZyYmKG49dCp0KSxcImVhc2VPdXRRdWFkXCI9PT1lLmVhc2luZyYmKG49dCooMi10KSksXCJlYXNlSW5PdXRRdWFkXCI9PT1lLmVhc2luZyYmKG49dDwuNT8yKnQqdDooNC0yKnQpKnQtMSksXCJlYXNlSW5DdWJpY1wiPT09ZS5lYXNpbmcmJihuPXQqdCp0KSxcImVhc2VPdXRDdWJpY1wiPT09ZS5lYXNpbmcmJihuPS0tdCp0KnQrMSksXCJlYXNlSW5PdXRDdWJpY1wiPT09ZS5lYXNpbmcmJihuPXQ8LjU/NCp0KnQqdDoodC0xKSooMip0LTIpKigyKnQtMikrMSksXCJlYXNlSW5RdWFydFwiPT09ZS5lYXNpbmcmJihuPXQqdCp0KnQpLFwiZWFzZU91dFF1YXJ0XCI9PT1lLmVhc2luZyYmKG49MS0gLS10KnQqdCp0KSxcImVhc2VJbk91dFF1YXJ0XCI9PT1lLmVhc2luZyYmKG49dDwuNT84KnQqdCp0KnQ6MS04Ki0tdCp0KnQqdCksXCJlYXNlSW5RdWludFwiPT09ZS5lYXNpbmcmJihuPXQqdCp0KnQqdCksXCJlYXNlT3V0UXVpbnRcIj09PWUuZWFzaW5nJiYobj0xKy0tdCp0KnQqdCp0KSxcImVhc2VJbk91dFF1aW50XCI9PT1lLmVhc2luZyYmKG49dDwuNT8xNip0KnQqdCp0KnQ6MSsxNiotLXQqdCp0KnQqdCksZS5jdXN0b21FYXNpbmcmJihuPWUuY3VzdG9tRWFzaW5nKHQpKSxufHx0fSxzPWZ1bmN0aW9uKCl7cmV0dXJuIE1hdGgubWF4KGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQsZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQsZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lm9mZnNldEhlaWdodCxkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodCxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KX0sbD1mdW5jdGlvbih0LG4sbyxpKXt2YXIgcj0wO2lmKHQub2Zmc2V0UGFyZW50KWRve3IrPXQub2Zmc2V0VG9wLHQ9dC5vZmZzZXRQYXJlbnR9d2hpbGUodCk7cmV0dXJuIHI9TWF0aC5tYXgoci1uLW8sMCksaSYmKHI9TWF0aC5taW4ocixzKCktZS5pbm5lckhlaWdodCkpLHJ9LG09ZnVuY3Rpb24oZSl7cmV0dXJuIGU/cihlKStlLm9mZnNldFRvcDowfSxkPWZ1bmN0aW9uKGUsdCxuKXt0fHxoaXN0b3J5LnB1c2hTdGF0ZSYmbi51cGRhdGVVUkwmJmhpc3RvcnkucHVzaFN0YXRlKHtzbW9vdGhTY3JvbGw6SlNPTi5zdHJpbmdpZnkobiksYW5jaG9yOmUuaWR9LGRvY3VtZW50LnRpdGxlLGU9PT1kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ/XCIjdG9wXCI6XCIjXCIrZS5pZCl9LGY9ZnVuY3Rpb24odCxuLG8pezA9PT10JiZkb2N1bWVudC5ib2R5LmZvY3VzKCksb3x8KHQuZm9jdXMoKSxkb2N1bWVudC5hY3RpdmVFbGVtZW50IT09dCYmKHQuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIixcIi0xXCIpLHQuZm9jdXMoKSx0LnN0eWxlLm91dGxpbmU9XCJub25lXCIpLGUuc2Nyb2xsVG8oMCxuKSl9LGg9ZnVuY3Rpb24odCxuLG8saSl7aWYobi5lbWl0RXZlbnRzJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBlLkN1c3RvbUV2ZW50KXt2YXIgcj1uZXcgQ3VzdG9tRXZlbnQodCx7YnViYmxlczohMCxkZXRhaWw6e2FuY2hvcjpvLHRvZ2dsZTppfX0pO2RvY3VtZW50LmRpc3BhdGNoRXZlbnQocil9fTtyZXR1cm4gZnVuY3Rpb24ocixwKXt2YXIgZyx2LHcseSxFLGIsUyxBPXt9O0EuY2FuY2VsU2Nyb2xsPWZ1bmN0aW9uKGUpe2NhbmNlbEFuaW1hdGlvbkZyYW1lKFMpLFM9bnVsbCxlfHxoKFwic2Nyb2xsQ2FuY2VsXCIsZyl9LEEuYW5pbWF0ZVNjcm9sbD1mdW5jdGlvbihuLGkscil7dmFyIGE9byhnfHx0LHJ8fHt9KSx1PVwiW29iamVjdCBOdW1iZXJdXCI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobikscD11fHwhbi50YWdOYW1lP251bGw6bjtpZih1fHxwKXt2YXIgdj1lLnBhZ2VZT2Zmc2V0O2EuaGVhZGVyJiYheSYmKHk9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhLmhlYWRlcikpLEV8fChFPW0oeSkpO3ZhciB3LGIsQyxPPXU/bjpsKHAsRSxwYXJzZUludChcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLm9mZnNldD9hLm9mZnNldChuLGkpOmEub2Zmc2V0LDEwKSxhLmNsaXApLEk9Ty12LHE9cygpLEY9MCxMPWZ1bmN0aW9uKHQsbyl7dmFyIHI9ZS5wYWdlWU9mZnNldDtpZih0PT1vfHxyPT1vfHwodjxvJiZlLmlubmVySGVpZ2h0K3IpPj1xKXJldHVybiBBLmNhbmNlbFNjcm9sbCghMCksZihuLG8sdSksaChcInNjcm9sbFN0b3BcIixhLG4saSksdz1udWxsLFM9bnVsbCwhMH0sSD1mdW5jdGlvbih0KXt3fHwodz10KSxGKz10LXcsYj1GL3BhcnNlSW50KGEuc3BlZWQsMTApLGI9Yj4xPzE6YixDPXYrSSpjKGEsYiksZS5zY3JvbGxUbygwLE1hdGguZmxvb3IoQykpLEwoQyxPKXx8KFM9ZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoSCksdz10KX07MD09PWUucGFnZVlPZmZzZXQmJmUuc2Nyb2xsVG8oMCwwKSxkKG4sdSxhKSxoKFwic2Nyb2xsU3RhcnRcIixhLG4saSksQS5jYW5jZWxTY3JvbGwoITApLGUucmVxdWVzdEFuaW1hdGlvbkZyYW1lKEgpfX07dmFyIEM9ZnVuY3Rpb24odCl7aWYoIWkoKSYmMD09PXQuYnV0dG9uJiYhdC5tZXRhS2V5JiYhdC5jdHJsS2V5JiZcImNsb3Nlc3RcImluIHQudGFyZ2V0JiYodz10LnRhcmdldC5jbG9zZXN0KHIpKSYmXCJhXCI9PT13LnRhZ05hbWUudG9Mb3dlckNhc2UoKSYmIXQudGFyZ2V0LmNsb3Nlc3QoZy5pZ25vcmUpJiZ3Lmhvc3RuYW1lPT09ZS5sb2NhdGlvbi5ob3N0bmFtZSYmdy5wYXRobmFtZT09PWUubG9jYXRpb24ucGF0aG5hbWUmJi8jLy50ZXN0KHcuaHJlZikpe3ZhciBuPXUoYSh3Lmhhc2gpKSxvPWcudG9wT25FbXB0eUhhc2gmJlwiI1wiPT09bj9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ6ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuKTtvPW98fFwiI3RvcFwiIT09bj9vOmRvY3VtZW50LmRvY3VtZW50RWxlbWVudCxvJiYodC5wcmV2ZW50RGVmYXVsdCgpLEEuYW5pbWF0ZVNjcm9sbChvLHcpKX19LE89ZnVuY3Rpb24oZSl7aWYobnVsbCE9PWhpc3Rvcnkuc3RhdGUmJmhpc3Rvcnkuc3RhdGUuc21vb3RoU2Nyb2xsJiZoaXN0b3J5LnN0YXRlLnNtb290aFNjcm9sbD09PUpTT04uc3RyaW5naWZ5KGcpJiZoaXN0b3J5LnN0YXRlLmFuY2hvcil7dmFyIHQ9ZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1KGEoaGlzdG9yeS5zdGF0ZS5hbmNob3IpKSk7dCYmQS5hbmltYXRlU2Nyb2xsKHQsbnVsbCx7dXBkYXRlVVJMOiExfSl9fSxJPWZ1bmN0aW9uKGUpe2J8fChiPXNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7Yj1udWxsLEU9bSh5KX0pLDY2KSl9O3JldHVybiBBLmRlc3Ryb3k9ZnVuY3Rpb24oKXtnJiYoZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsQywhMSksZS5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVzaXplXCIsSSwhMSksZS5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9wc3RhdGVcIixPLCExKSxBLmNhbmNlbFNjcm9sbCgpLGc9bnVsbCx2PW51bGwsdz1udWxsLHk9bnVsbCxFPW51bGwsYj1udWxsLFM9bnVsbCl9LEEuaW5pdD1mdW5jdGlvbihpKXtpZighbigpKXRocm93XCJTbW9vdGggU2Nyb2xsOiBUaGlzIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCB0aGUgcmVxdWlyZWQgSmF2YVNjcmlwdCBtZXRob2RzIGFuZCBicm93c2VyIEFQSXMuXCI7QS5kZXN0cm95KCksZz1vKHQsaXx8e30pLHk9Zy5oZWFkZXI/ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihnLmhlYWRlcik6bnVsbCxFPW0oeSksZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsQywhMSkseSYmZS5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsSSwhMSksZy51cGRhdGVVUkwmJmcucG9wc3RhdGUmJmUuYWRkRXZlbnRMaXN0ZW5lcihcInBvcHN0YXRlXCIsTywhMSl9LEEuaW5pdChwKSxBfX0pKTtcbiIsIi8qIVxuICogdGFibGVzb3J0IHY1LjAuMiAoMjAxNy0xMS0xMilcbiAqIGh0dHA6Ly90cmlzdGVuLmNhL3RhYmxlc29ydC9kZW1vL1xuICogQ29weXJpZ2h0IChjKSAyMDE3IDsgTGljZW5zZWQgTUlUXG4qLyFmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYixjKXtpZighKHRoaXMgaW5zdGFuY2VvZiBhKSlyZXR1cm4gbmV3IGEoYixjKTtpZighYnx8XCJUQUJMRVwiIT09Yi50YWdOYW1lKXRocm93IG5ldyBFcnJvcihcIkVsZW1lbnQgbXVzdCBiZSBhIHRhYmxlXCIpO3RoaXMuaW5pdChiLGN8fHt9KX12YXIgYj1bXSxjPWZ1bmN0aW9uKGEpe3ZhciBiO3JldHVybiB3aW5kb3cuQ3VzdG9tRXZlbnQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudD9iPW5ldyBDdXN0b21FdmVudChhKTooYj1kb2N1bWVudC5jcmVhdGVFdmVudChcIkN1c3RvbUV2ZW50XCIpLGIuaW5pdEN1c3RvbUV2ZW50KGEsITEsITEsdm9pZCAwKSksYn0sZD1mdW5jdGlvbihhKXtyZXR1cm4gYS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNvcnRcIil8fGEudGV4dENvbnRlbnR8fGEuaW5uZXJUZXh0fHxcIlwifSxlPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9YS50cmltKCkudG9Mb3dlckNhc2UoKSxiPWIudHJpbSgpLnRvTG93ZXJDYXNlKCksYT09PWI/MDphPGI/MTotMX0sZj1mdW5jdGlvbihhLGIpe3JldHVybiBmdW5jdGlvbihjLGQpe3ZhciBlPWEoYy50ZCxkLnRkKTtyZXR1cm4gMD09PWU/Yj9kLmluZGV4LWMuaW5kZXg6Yy5pbmRleC1kLmluZGV4OmV9fTthLmV4dGVuZD1mdW5jdGlvbihhLGMsZCl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgY3x8XCJmdW5jdGlvblwiIT10eXBlb2YgZCl0aHJvdyBuZXcgRXJyb3IoXCJQYXR0ZXJuIGFuZCBzb3J0IG11c3QgYmUgYSBmdW5jdGlvblwiKTtiLnB1c2goe25hbWU6YSxwYXR0ZXJuOmMsc29ydDpkfSl9LGEucHJvdG90eXBlPXtpbml0OmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGYsZz10aGlzO2lmKGcudGFibGU9YSxnLnRoZWFkPSExLGcub3B0aW9ucz1iLGEucm93cyYmYS5yb3dzLmxlbmd0aD4wKWlmKGEudEhlYWQmJmEudEhlYWQucm93cy5sZW5ndGg+MCl7Zm9yKGU9MDtlPGEudEhlYWQucm93cy5sZW5ndGg7ZSsrKWlmKFwidGhlYWRcIj09PWEudEhlYWQucm93c1tlXS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNvcnQtbWV0aG9kXCIpKXtjPWEudEhlYWQucm93c1tlXTticmVha31jfHwoYz1hLnRIZWFkLnJvd3NbYS50SGVhZC5yb3dzLmxlbmd0aC0xXSksZy50aGVhZD0hMH1lbHNlIGM9YS5yb3dzWzBdO2lmKGMpe3ZhciBoPWZ1bmN0aW9uKCl7Zy5jdXJyZW50JiZnLmN1cnJlbnQhPT10aGlzJiZnLmN1cnJlbnQucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1zb3J0XCIpLGcuY3VycmVudD10aGlzLGcuc29ydFRhYmxlKHRoaXMpfTtmb3IoZT0wO2U8Yy5jZWxscy5sZW5ndGg7ZSsrKWY9Yy5jZWxsc1tlXSxmLnNldEF0dHJpYnV0ZShcInJvbGVcIixcImNvbHVtbmhlYWRlclwiKSxcIm5vbmVcIiE9PWYuZ2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0LW1ldGhvZFwiKSYmKGYudGFiaW5kZXg9MCxmLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLGgsITEpLG51bGwhPT1mLmdldEF0dHJpYnV0ZShcImRhdGEtc29ydC1kZWZhdWx0XCIpJiYoZD1mKSk7ZCYmKGcuY3VycmVudD1kLGcuc29ydFRhYmxlKGQpKX19LHNvcnRUYWJsZTpmdW5jdGlvbihhLGcpe3ZhciBoPXRoaXMsaT1hLmNlbGxJbmRleCxqPWUsaz1cIlwiLGw9W10sbT1oLnRoZWFkPzA6MSxuPWEuZ2V0QXR0cmlidXRlKFwiZGF0YS1zb3J0LW1ldGhvZFwiKSxvPWEuZ2V0QXR0cmlidXRlKFwiYXJpYS1zb3J0XCIpO2lmKGgudGFibGUuZGlzcGF0Y2hFdmVudChjKFwiYmVmb3JlU29ydFwiKSksZ3x8KG89XCJhc2NlbmRpbmdcIj09PW8/XCJkZXNjZW5kaW5nXCI6XCJkZXNjZW5kaW5nXCI9PT1vP1wiYXNjZW5kaW5nXCI6aC5vcHRpb25zLmRlc2NlbmRpbmc/XCJkZXNjZW5kaW5nXCI6XCJhc2NlbmRpbmdcIixhLnNldEF0dHJpYnV0ZShcImFyaWEtc29ydFwiLG8pKSwhKGgudGFibGUucm93cy5sZW5ndGg8Mikpe2lmKCFuKXtmb3IoO2wubGVuZ3RoPDMmJm08aC50YWJsZS50Qm9kaWVzWzBdLnJvd3MubGVuZ3RoOylrPWQoaC50YWJsZS50Qm9kaWVzWzBdLnJvd3NbbV0uY2VsbHNbaV0pLGs9ay50cmltKCksay5sZW5ndGg+MCYmbC5wdXNoKGspLG0rKztpZighbClyZXR1cm59Zm9yKG09MDttPGIubGVuZ3RoO20rKylpZihrPWJbbV0sbil7aWYoay5uYW1lPT09bil7aj1rLnNvcnQ7YnJlYWt9fWVsc2UgaWYobC5ldmVyeShrLnBhdHRlcm4pKXtqPWsuc29ydDticmVha31mb3IoaC5jb2w9aSxtPTA7bTxoLnRhYmxlLnRCb2RpZXMubGVuZ3RoO20rKyl7dmFyIHAscT1bXSxyPXt9LHM9MCx0PTA7aWYoIShoLnRhYmxlLnRCb2RpZXNbbV0ucm93cy5sZW5ndGg8Mikpe2ZvcihwPTA7cDxoLnRhYmxlLnRCb2RpZXNbbV0ucm93cy5sZW5ndGg7cCsrKWs9aC50YWJsZS50Qm9kaWVzW21dLnJvd3NbcF0sXCJub25lXCI9PT1rLmdldEF0dHJpYnV0ZShcImRhdGEtc29ydC1tZXRob2RcIik/cltzXT1rOnEucHVzaCh7dHI6ayx0ZDpkKGsuY2VsbHNbaC5jb2xdKSxpbmRleDpzfSkscysrO2ZvcihcImRlc2NlbmRpbmdcIj09PW8/cS5zb3J0KGYoaiwhMCkpOihxLnNvcnQoZihqLCExKSkscS5yZXZlcnNlKCkpLHA9MDtwPHM7cCsrKXJbcF0/KGs9cltwXSx0KyspOms9cVtwLXRdLnRyLGgudGFibGUudEJvZGllc1ttXS5hcHBlbmRDaGlsZChrKX19aC50YWJsZS5kaXNwYXRjaEV2ZW50KGMoXCJhZnRlclNvcnRcIikpfX0scmVmcmVzaDpmdW5jdGlvbigpe3ZvaWQgMCE9PXRoaXMuY3VycmVudCYmdGhpcy5zb3J0VGFibGUodGhpcy5jdXJyZW50LCEwKX19LFwidW5kZWZpbmVkXCIhPXR5cGVvZiBtb2R1bGUmJm1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWE6d2luZG93LlRhYmxlc29ydD1hfSgpO1xuXG4vKiFcbiAqIHRhYmxlc29ydCB2NS4wLjIgKDIwMTctMTEtMTIpXG4gKiBodHRwOi8vdHJpc3Rlbi5jYS90YWJsZXNvcnQvZGVtby9cbiAqIENvcHlyaWdodCAoYykgMjAxNyA7IExpY2Vuc2VkIE1JVFxuKi8hZnVuY3Rpb24oKXt2YXIgYT1mdW5jdGlvbihhKXtyZXR1cm4gYT1hLnJlcGxhY2UoL1xcLS9nLFwiL1wiKSxhPWEucmVwbGFjZSgvKFxcZHsxLDJ9KVtcXC9cXC1dKFxcZHsxLDJ9KVtcXC9cXC1dKFxcZHsyfSkvLFwiJDEvJDIvJDNcIiksbmV3IERhdGUoYSkuZ2V0VGltZSgpfHwtMX07VGFibGVzb3J0LmV4dGVuZChcImRhdGVcIixmdW5jdGlvbihiKXtyZXR1cm4oYi5zZWFyY2goLyhNb258VHVlfFdlZHxUaHV8RnJpfFNhdHxTdW4pXFwuP1xcLD9cXHMqL2kpIT09LTF8fGIuc2VhcmNoKC9cXGR7MSwyfVtcXC9cXC1dXFxkezEsMn1bXFwvXFwtXVxcZHsyLDR9LykhPT0tMXx8Yi5zZWFyY2goLyhKYW58RmVifE1hcnxBcHJ8TWF5fEp1bnxKdWx8QXVnfFNlcHxPY3R8Tm92fERlYykvaSkhPT0tMSkmJiFpc05hTihhKGIpKX0sZnVuY3Rpb24oYixjKXtyZXR1cm4gYj1iLnRvTG93ZXJDYXNlKCksYz1jLnRvTG93ZXJDYXNlKCksYShjKS1hKGIpfSl9KCk7XG4iLCIoZnVuY3Rpb24oZSx0KXsnb2JqZWN0Jz09dHlwZW9mIGV4cG9ydHMmJid1bmRlZmluZWQnIT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPXQoKTonZnVuY3Rpb24nPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZSh0KTplLnRpcHB5PXQoKX0pKHRoaXMsZnVuY3Rpb24oKXsndXNlIHN0cmljdCc7ZnVuY3Rpb24gZShlKXtyZXR1cm4gZSYmJ1tvYmplY3QgRnVuY3Rpb25dJz09PXt9LnRvU3RyaW5nLmNhbGwoZSl9ZnVuY3Rpb24gdChlLHQpe2lmKDEhPT1lLm5vZGVUeXBlKXJldHVybltdO3ZhciByPWUub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldyxhPXIuZ2V0Q29tcHV0ZWRTdHlsZShlLG51bGwpO3JldHVybiB0P2FbdF06YX1mdW5jdGlvbiByKGUpe3JldHVybidIVE1MJz09PWUubm9kZU5hbWU/ZTplLnBhcmVudE5vZGV8fGUuaG9zdH1mdW5jdGlvbiBhKGUpe2lmKCFlKXJldHVybiBkb2N1bWVudC5ib2R5O3N3aXRjaChlLm5vZGVOYW1lKXtjYXNlJ0hUTUwnOmNhc2UnQk9EWSc6cmV0dXJuIGUub3duZXJEb2N1bWVudC5ib2R5O2Nhc2UnI2RvY3VtZW50JzpyZXR1cm4gZS5ib2R5O312YXIgcD10KGUpLG89cC5vdmVyZmxvdyxpPXAub3ZlcmZsb3dYLG49cC5vdmVyZmxvd1k7cmV0dXJuIC8oYXV0b3xzY3JvbGx8b3ZlcmxheSkvLnRlc3QobytuK2kpP2U6YShyKGUpKX1mdW5jdGlvbiBwKGUpe3JldHVybiAxMT09PWU/YnQ6MTA9PT1lP3l0OmJ0fHx5dH1mdW5jdGlvbiBvKGUpe2lmKCFlKXJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7Zm9yKHZhciByPXAoMTApP2RvY3VtZW50LmJvZHk6bnVsbCxhPWUub2Zmc2V0UGFyZW50fHxudWxsO2E9PT1yJiZlLm5leHRFbGVtZW50U2libGluZzspYT0oZT1lLm5leHRFbGVtZW50U2libGluZykub2Zmc2V0UGFyZW50O3ZhciBpPWEmJmEubm9kZU5hbWU7cmV0dXJuIGkmJidCT0RZJyE9PWkmJidIVE1MJyE9PWk/LTEhPT1bJ1RIJywnVEQnLCdUQUJMRSddLmluZGV4T2YoYS5ub2RlTmFtZSkmJidzdGF0aWMnPT09dChhLCdwb3NpdGlvbicpP28oYSk6YTplP2Uub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ6ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50fWZ1bmN0aW9uIG4oZSl7dmFyIHQ9ZS5ub2RlTmFtZTtyZXR1cm4nQk9EWSchPT10JiYoJ0hUTUwnPT09dHx8byhlLmZpcnN0RWxlbWVudENoaWxkKT09PWUpfWZ1bmN0aW9uIHMoZSl7cmV0dXJuIG51bGw9PT1lLnBhcmVudE5vZGU/ZTpzKGUucGFyZW50Tm9kZSl9ZnVuY3Rpb24gbChlLHQpe2lmKCFlfHwhZS5ub2RlVHlwZXx8IXR8fCF0Lm5vZGVUeXBlKXJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7dmFyIHI9ZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbih0KSZOb2RlLkRPQ1VNRU5UX1BPU0lUSU9OX0ZPTExPV0lORyxhPXI/ZTp0LHA9cj90OmUsaT1kb2N1bWVudC5jcmVhdGVSYW5nZSgpO2kuc2V0U3RhcnQoYSwwKSxpLnNldEVuZChwLDApO3ZhciBkPWkuY29tbW9uQW5jZXN0b3JDb250YWluZXI7aWYoZSE9PWQmJnQhPT1kfHxhLmNvbnRhaW5zKHApKXJldHVybiBuKGQpP2Q6byhkKTt2YXIgYz1zKGUpO3JldHVybiBjLmhvc3Q/bChjLmhvc3QsdCk6bChlLHModCkuaG9zdCl9ZnVuY3Rpb24gZChlKXt2YXIgdD0xPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06J3RvcCcscj0ndG9wJz09PXQ/J3Njcm9sbFRvcCc6J3Njcm9sbExlZnQnLGE9ZS5ub2RlTmFtZTtpZignQk9EWSc9PT1hfHwnSFRNTCc9PT1hKXt2YXIgcD1lLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LG89ZS5vd25lckRvY3VtZW50LnNjcm9sbGluZ0VsZW1lbnR8fHA7cmV0dXJuIG9bcl19cmV0dXJuIGVbcl19ZnVuY3Rpb24gYyhlLHQpe3ZhciByPSEhKDI8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzJdKSYmYXJndW1lbnRzWzJdLGE9ZCh0LCd0b3AnKSxwPWQodCwnbGVmdCcpLG89cj8tMToxO3JldHVybiBlLnRvcCs9YSpvLGUuYm90dG9tKz1hKm8sZS5sZWZ0Kz1wKm8sZS5yaWdodCs9cCpvLGV9ZnVuY3Rpb24gbShlLHQpe3ZhciByPSd4Jz09PXQ/J0xlZnQnOidUb3AnLGE9J0xlZnQnPT09cj8nUmlnaHQnOidCb3R0b20nO3JldHVybiBwYXJzZUZsb2F0KGVbJ2JvcmRlcicrcisnV2lkdGgnXSwxMCkrcGFyc2VGbG9hdChlWydib3JkZXInK2ErJ1dpZHRoJ10sMTApfWZ1bmN0aW9uIGYoZSx0LHIsYSl7cmV0dXJuIFplKHRbJ29mZnNldCcrZV0sdFsnc2Nyb2xsJytlXSxyWydjbGllbnQnK2VdLHJbJ29mZnNldCcrZV0sclsnc2Nyb2xsJytlXSxwKDEwKT9wYXJzZUludChyWydvZmZzZXQnK2VdKStwYXJzZUludChhWydtYXJnaW4nKygnSGVpZ2h0Jz09PWU/J1RvcCc6J0xlZnQnKV0pK3BhcnNlSW50KGFbJ21hcmdpbicrKCdIZWlnaHQnPT09ZT8nQm90dG9tJzonUmlnaHQnKV0pOjApfWZ1bmN0aW9uIGgoZSl7dmFyIHQ9ZS5ib2R5LHI9ZS5kb2N1bWVudEVsZW1lbnQsYT1wKDEwKSYmZ2V0Q29tcHV0ZWRTdHlsZShyKTtyZXR1cm57aGVpZ2h0OmYoJ0hlaWdodCcsdCxyLGEpLHdpZHRoOmYoJ1dpZHRoJyx0LHIsYSl9fWZ1bmN0aW9uIGIoZSl7cmV0dXJuIHd0KHt9LGUse3JpZ2h0OmUubGVmdCtlLndpZHRoLGJvdHRvbTplLnRvcCtlLmhlaWdodH0pfWZ1bmN0aW9uIHUoZSl7dmFyIHI9e307dHJ5e2lmKHAoMTApKXtyPWUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7dmFyIGE9ZChlLCd0b3AnKSxvPWQoZSwnbGVmdCcpO3IudG9wKz1hLHIubGVmdCs9byxyLmJvdHRvbSs9YSxyLnJpZ2h0Kz1vfWVsc2Ugcj1lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpfWNhdGNoKHQpe312YXIgaT17bGVmdDpyLmxlZnQsdG9wOnIudG9wLHdpZHRoOnIucmlnaHQtci5sZWZ0LGhlaWdodDpyLmJvdHRvbS1yLnRvcH0sbj0nSFRNTCc9PT1lLm5vZGVOYW1lP2goZS5vd25lckRvY3VtZW50KTp7fSxzPW4ud2lkdGh8fGUuY2xpZW50V2lkdGh8fGkucmlnaHQtaS5sZWZ0LGw9bi5oZWlnaHR8fGUuY2xpZW50SGVpZ2h0fHxpLmJvdHRvbS1pLnRvcCxjPWUub2Zmc2V0V2lkdGgtcyxmPWUub2Zmc2V0SGVpZ2h0LWw7aWYoY3x8Zil7dmFyIHk9dChlKTtjLT1tKHksJ3gnKSxmLT1tKHksJ3knKSxpLndpZHRoLT1jLGkuaGVpZ2h0LT1mfXJldHVybiBiKGkpfWZ1bmN0aW9uIHkoZSxyKXt2YXIgbz0hISgyPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1syXSkmJmFyZ3VtZW50c1syXSxpPXAoMTApLG49J0hUTUwnPT09ci5ub2RlTmFtZSxzPXUoZSksbD11KHIpLGQ9YShlKSxtPXQociksZj1wYXJzZUZsb2F0KG0uYm9yZGVyVG9wV2lkdGgsMTApLGg9cGFyc2VGbG9hdChtLmJvcmRlckxlZnRXaWR0aCwxMCk7byYmbiYmKGwudG9wPVplKGwudG9wLDApLGwubGVmdD1aZShsLmxlZnQsMCkpO3ZhciB5PWIoe3RvcDpzLnRvcC1sLnRvcC1mLGxlZnQ6cy5sZWZ0LWwubGVmdC1oLHdpZHRoOnMud2lkdGgsaGVpZ2h0OnMuaGVpZ2h0fSk7aWYoeS5tYXJnaW5Ub3A9MCx5Lm1hcmdpbkxlZnQ9MCwhaSYmbil7dmFyIGc9cGFyc2VGbG9hdChtLm1hcmdpblRvcCwxMCkseD1wYXJzZUZsb2F0KG0ubWFyZ2luTGVmdCwxMCk7eS50b3AtPWYtZyx5LmJvdHRvbS09Zi1nLHkubGVmdC09aC14LHkucmlnaHQtPWgteCx5Lm1hcmdpblRvcD1nLHkubWFyZ2luTGVmdD14fXJldHVybihpJiYhbz9yLmNvbnRhaW5zKGQpOnI9PT1kJiYnQk9EWSchPT1kLm5vZGVOYW1lKSYmKHk9Yyh5LHIpKSx5fWZ1bmN0aW9uIGcoZSl7dmFyIHQ9ISEoMTxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0pJiZhcmd1bWVudHNbMV0scj1lLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGE9eShlLHIpLHA9WmUoci5jbGllbnRXaWR0aCx3aW5kb3cuaW5uZXJXaWR0aHx8MCksbz1aZShyLmNsaWVudEhlaWdodCx3aW5kb3cuaW5uZXJIZWlnaHR8fDApLGk9dD8wOmQociksbj10PzA6ZChyLCdsZWZ0Jykscz17dG9wOmktYS50b3ArYS5tYXJnaW5Ub3AsbGVmdDpuLWEubGVmdCthLm1hcmdpbkxlZnQsd2lkdGg6cCxoZWlnaHQ6b307cmV0dXJuIGIocyl9ZnVuY3Rpb24geChlKXt2YXIgYT1lLm5vZGVOYW1lO3JldHVybidCT0RZJyE9PWEmJidIVE1MJyE9PWEmJignZml4ZWQnPT09dChlLCdwb3NpdGlvbicpfHx4KHIoZSkpKX1mdW5jdGlvbiB3KGUpe2lmKCFlfHwhZS5wYXJlbnRFbGVtZW50fHxwKCkpcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtmb3IodmFyIHI9ZS5wYXJlbnRFbGVtZW50O3ImJidub25lJz09PXQociwndHJhbnNmb3JtJyk7KXI9ci5wYXJlbnRFbGVtZW50O3JldHVybiByfHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnR9ZnVuY3Rpb24gdihlLHQscCxvKXt2YXIgaT0hISg0PGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1s0XSkmJmFyZ3VtZW50c1s0XSxuPXt0b3A6MCxsZWZ0OjB9LHM9aT93KGUpOmwoZSx0KTtpZigndmlld3BvcnQnPT09byluPWcocyxpKTtlbHNle3ZhciBkOydzY3JvbGxQYXJlbnQnPT09bz8oZD1hKHIodCkpLCdCT0RZJz09PWQubm9kZU5hbWUmJihkPWUub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpKTond2luZG93Jz09PW8/ZD1lLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OmQ9bzt2YXIgYz15KGQscyxpKTtpZignSFRNTCc9PT1kLm5vZGVOYW1lJiYheChzKSl7dmFyIG09aChlLm93bmVyRG9jdW1lbnQpLGY9bS5oZWlnaHQsYj1tLndpZHRoO24udG9wKz1jLnRvcC1jLm1hcmdpblRvcCxuLmJvdHRvbT1mK2MudG9wLG4ubGVmdCs9Yy5sZWZ0LWMubWFyZ2luTGVmdCxuLnJpZ2h0PWIrYy5sZWZ0fWVsc2Ugbj1jfXA9cHx8MDt2YXIgdT0nbnVtYmVyJz09dHlwZW9mIHA7cmV0dXJuIG4ubGVmdCs9dT9wOnAubGVmdHx8MCxuLnRvcCs9dT9wOnAudG9wfHwwLG4ucmlnaHQtPXU/cDpwLnJpZ2h0fHwwLG4uYm90dG9tLT11P3A6cC5ib3R0b218fDAsbn1mdW5jdGlvbiBrKGUpe3ZhciB0PWUud2lkdGgscj1lLmhlaWdodDtyZXR1cm4gdCpyfWZ1bmN0aW9uIEUoZSx0LHIsYSxwKXt2YXIgbz01PGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1s1XT9hcmd1bWVudHNbNV06MDtpZigtMT09PWUuaW5kZXhPZignYXV0bycpKXJldHVybiBlO3ZhciBpPXYocixhLG8scCksbj17dG9wOnt3aWR0aDppLndpZHRoLGhlaWdodDp0LnRvcC1pLnRvcH0scmlnaHQ6e3dpZHRoOmkucmlnaHQtdC5yaWdodCxoZWlnaHQ6aS5oZWlnaHR9LGJvdHRvbTp7d2lkdGg6aS53aWR0aCxoZWlnaHQ6aS5ib3R0b20tdC5ib3R0b219LGxlZnQ6e3dpZHRoOnQubGVmdC1pLmxlZnQsaGVpZ2h0OmkuaGVpZ2h0fX0scz1PYmplY3Qua2V5cyhuKS5tYXAoZnVuY3Rpb24oZSl7cmV0dXJuIHd0KHtrZXk6ZX0sbltlXSx7YXJlYTprKG5bZV0pfSl9KS5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQuYXJlYS1lLmFyZWF9KSxsPXMuZmlsdGVyKGZ1bmN0aW9uKGUpe3ZhciB0PWUud2lkdGgsYT1lLmhlaWdodDtyZXR1cm4gdD49ci5jbGllbnRXaWR0aCYmYT49ci5jbGllbnRIZWlnaHR9KSxkPTA8bC5sZW5ndGg/bFswXS5rZXk6c1swXS5rZXksYz1lLnNwbGl0KCctJylbMV07cmV0dXJuIGQrKGM/Jy0nK2M6JycpfWZ1bmN0aW9uIEMoZSx0LHIpe3ZhciBhPTM8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzNdP2FyZ3VtZW50c1szXTpudWxsLHA9YT93KHQpOmwodCxyKTtyZXR1cm4geShyLHAsYSl9ZnVuY3Rpb24gTChlKXt2YXIgdD1lLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcscj10LmdldENvbXB1dGVkU3R5bGUoZSksYT1wYXJzZUZsb2F0KHIubWFyZ2luVG9wfHwwKStwYXJzZUZsb2F0KHIubWFyZ2luQm90dG9tfHwwKSxwPXBhcnNlRmxvYXQoci5tYXJnaW5MZWZ0fHwwKStwYXJzZUZsb2F0KHIubWFyZ2luUmlnaHR8fDApLG89e3dpZHRoOmUub2Zmc2V0V2lkdGgrcCxoZWlnaHQ6ZS5vZmZzZXRIZWlnaHQrYX07cmV0dXJuIG99ZnVuY3Rpb24gTyhlKXt2YXIgdD17bGVmdDoncmlnaHQnLHJpZ2h0OidsZWZ0Jyxib3R0b206J3RvcCcsdG9wOidib3R0b20nfTtyZXR1cm4gZS5yZXBsYWNlKC9sZWZ0fHJpZ2h0fGJvdHRvbXx0b3AvZyxmdW5jdGlvbihlKXtyZXR1cm4gdFtlXX0pfWZ1bmN0aW9uIFQoZSx0LHIpe3I9ci5zcGxpdCgnLScpWzBdO3ZhciBhPUwoZSkscD17d2lkdGg6YS53aWR0aCxoZWlnaHQ6YS5oZWlnaHR9LG89LTEhPT1bJ3JpZ2h0JywnbGVmdCddLmluZGV4T2YociksaT1vPyd0b3AnOidsZWZ0JyxuPW8/J2xlZnQnOid0b3AnLHM9bz8naGVpZ2h0Jzond2lkdGgnLGw9bz8nd2lkdGgnOidoZWlnaHQnO3JldHVybiBwW2ldPXRbaV0rdFtzXS8yLWFbc10vMixwW25dPXI9PT1uP3Rbbl0tYVtsXTp0W08obildLHB9ZnVuY3Rpb24gUyhlLHQpe3JldHVybiBBcnJheS5wcm90b3R5cGUuZmluZD9lLmZpbmQodCk6ZS5maWx0ZXIodClbMF19ZnVuY3Rpb24gQShlLHQscil7aWYoQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleClyZXR1cm4gZS5maW5kSW5kZXgoZnVuY3Rpb24oZSl7cmV0dXJuIGVbdF09PT1yfSk7dmFyIGE9UyhlLGZ1bmN0aW9uKGUpe3JldHVybiBlW3RdPT09cn0pO3JldHVybiBlLmluZGV4T2YoYSl9ZnVuY3Rpb24gWSh0LHIsYSl7dmFyIHA9dm9pZCAwPT09YT90OnQuc2xpY2UoMCxBKHQsJ25hbWUnLGEpKTtyZXR1cm4gcC5mb3JFYWNoKGZ1bmN0aW9uKHQpe3RbJ2Z1bmN0aW9uJ10mJmNvbnNvbGUud2FybignYG1vZGlmaWVyLmZ1bmN0aW9uYCBpcyBkZXByZWNhdGVkLCB1c2UgYG1vZGlmaWVyLmZuYCEnKTt2YXIgYT10WydmdW5jdGlvbiddfHx0LmZuO3QuZW5hYmxlZCYmZShhKSYmKHIub2Zmc2V0cy5wb3BwZXI9YihyLm9mZnNldHMucG9wcGVyKSxyLm9mZnNldHMucmVmZXJlbmNlPWIoci5vZmZzZXRzLnJlZmVyZW5jZSkscj1hKHIsdCkpfSkscn1mdW5jdGlvbiBQKCl7aWYoIXRoaXMuc3RhdGUuaXNEZXN0cm95ZWQpe3ZhciBlPXtpbnN0YW5jZTp0aGlzLHN0eWxlczp7fSxhcnJvd1N0eWxlczp7fSxhdHRyaWJ1dGVzOnt9LGZsaXBwZWQ6ITEsb2Zmc2V0czp7fX07ZS5vZmZzZXRzLnJlZmVyZW5jZT1DKHRoaXMuc3RhdGUsdGhpcy5wb3BwZXIsdGhpcy5yZWZlcmVuY2UsdGhpcy5vcHRpb25zLnBvc2l0aW9uRml4ZWQpLGUucGxhY2VtZW50PUUodGhpcy5vcHRpb25zLnBsYWNlbWVudCxlLm9mZnNldHMucmVmZXJlbmNlLHRoaXMucG9wcGVyLHRoaXMucmVmZXJlbmNlLHRoaXMub3B0aW9ucy5tb2RpZmllcnMuZmxpcC5ib3VuZGFyaWVzRWxlbWVudCx0aGlzLm9wdGlvbnMubW9kaWZpZXJzLmZsaXAucGFkZGluZyksZS5vcmlnaW5hbFBsYWNlbWVudD1lLnBsYWNlbWVudCxlLnBvc2l0aW9uRml4ZWQ9dGhpcy5vcHRpb25zLnBvc2l0aW9uRml4ZWQsZS5vZmZzZXRzLnBvcHBlcj1UKHRoaXMucG9wcGVyLGUub2Zmc2V0cy5yZWZlcmVuY2UsZS5wbGFjZW1lbnQpLGUub2Zmc2V0cy5wb3BwZXIucG9zaXRpb249dGhpcy5vcHRpb25zLnBvc2l0aW9uRml4ZWQ/J2ZpeGVkJzonYWJzb2x1dGUnLGU9WSh0aGlzLm1vZGlmaWVycyxlKSx0aGlzLnN0YXRlLmlzQ3JlYXRlZD90aGlzLm9wdGlvbnMub25VcGRhdGUoZSk6KHRoaXMuc3RhdGUuaXNDcmVhdGVkPSEwLHRoaXMub3B0aW9ucy5vbkNyZWF0ZShlKSl9fWZ1bmN0aW9uIEQoZSx0KXtyZXR1cm4gZS5zb21lKGZ1bmN0aW9uKGUpe3ZhciByPWUubmFtZSxhPWUuZW5hYmxlZDtyZXR1cm4gYSYmcj09PXR9KX1mdW5jdGlvbiBYKGUpe2Zvcih2YXIgdD1bITEsJ21zJywnV2Via2l0JywnTW96JywnTyddLHI9ZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKStlLnNsaWNlKDEpLGE9MDthPHQubGVuZ3RoO2ErKyl7dmFyIHA9dFthXSxvPXA/JycrcCtyOmU7aWYoJ3VuZGVmaW5lZCchPXR5cGVvZiBkb2N1bWVudC5ib2R5LnN0eWxlW29dKXJldHVybiBvfXJldHVybiBudWxsfWZ1bmN0aW9uIEkoKXtyZXR1cm4gdGhpcy5zdGF0ZS5pc0Rlc3Ryb3llZD0hMCxEKHRoaXMubW9kaWZpZXJzLCdhcHBseVN0eWxlJykmJih0aGlzLnBvcHBlci5yZW1vdmVBdHRyaWJ1dGUoJ3gtcGxhY2VtZW50JyksdGhpcy5wb3BwZXIuc3R5bGUucG9zaXRpb249JycsdGhpcy5wb3BwZXIuc3R5bGUudG9wPScnLHRoaXMucG9wcGVyLnN0eWxlLmxlZnQ9JycsdGhpcy5wb3BwZXIuc3R5bGUucmlnaHQ9JycsdGhpcy5wb3BwZXIuc3R5bGUuYm90dG9tPScnLHRoaXMucG9wcGVyLnN0eWxlLndpbGxDaGFuZ2U9JycsdGhpcy5wb3BwZXIuc3R5bGVbWCgndHJhbnNmb3JtJyldPScnKSx0aGlzLmRpc2FibGVFdmVudExpc3RlbmVycygpLHRoaXMub3B0aW9ucy5yZW1vdmVPbkRlc3Ryb3kmJnRoaXMucG9wcGVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5wb3BwZXIpLHRoaXN9ZnVuY3Rpb24gTihlKXt2YXIgdD1lLm93bmVyRG9jdW1lbnQ7cmV0dXJuIHQ/dC5kZWZhdWx0Vmlldzp3aW5kb3d9ZnVuY3Rpb24gSChlLHQscixwKXt2YXIgbz0nQk9EWSc9PT1lLm5vZGVOYW1lLGk9bz9lLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc6ZTtpLmFkZEV2ZW50TGlzdGVuZXIodCxyLHtwYXNzaXZlOiEwfSksb3x8SChhKGkucGFyZW50Tm9kZSksdCxyLHApLHAucHVzaChpKX1mdW5jdGlvbiBXKGUsdCxyLHApe3IudXBkYXRlQm91bmQ9cCxOKGUpLmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsci51cGRhdGVCb3VuZCx7cGFzc2l2ZTohMH0pO3ZhciBvPWEoZSk7cmV0dXJuIEgobywnc2Nyb2xsJyxyLnVwZGF0ZUJvdW5kLHIuc2Nyb2xsUGFyZW50cyksci5zY3JvbGxFbGVtZW50PW8sci5ldmVudHNFbmFibGVkPSEwLHJ9ZnVuY3Rpb24gTSgpe3RoaXMuc3RhdGUuZXZlbnRzRW5hYmxlZHx8KHRoaXMuc3RhdGU9Vyh0aGlzLnJlZmVyZW5jZSx0aGlzLm9wdGlvbnMsdGhpcy5zdGF0ZSx0aGlzLnNjaGVkdWxlVXBkYXRlKSl9ZnVuY3Rpb24gQihlLHQpe3JldHVybiBOKGUpLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsdC51cGRhdGVCb3VuZCksdC5zY3JvbGxQYXJlbnRzLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLHQudXBkYXRlQm91bmQpfSksdC51cGRhdGVCb3VuZD1udWxsLHQuc2Nyb2xsUGFyZW50cz1bXSx0LnNjcm9sbEVsZW1lbnQ9bnVsbCx0LmV2ZW50c0VuYWJsZWQ9ITEsdH1mdW5jdGlvbiBSKCl7dGhpcy5zdGF0ZS5ldmVudHNFbmFibGVkJiYoY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5zY2hlZHVsZVVwZGF0ZSksdGhpcy5zdGF0ZT1CKHRoaXMucmVmZXJlbmNlLHRoaXMuc3RhdGUpKX1mdW5jdGlvbiB6KGUpe3JldHVybicnIT09ZSYmIWlzTmFOKHBhcnNlRmxvYXQoZSkpJiZpc0Zpbml0ZShlKX1mdW5jdGlvbiBGKGUsdCl7T2JqZWN0LmtleXModCkuZm9yRWFjaChmdW5jdGlvbihyKXt2YXIgYT0nJzstMSE9PVsnd2lkdGgnLCdoZWlnaHQnLCd0b3AnLCdyaWdodCcsJ2JvdHRvbScsJ2xlZnQnXS5pbmRleE9mKHIpJiZ6KHRbcl0pJiYoYT0ncHgnKSxlLnN0eWxlW3JdPXRbcl0rYX0pfWZ1bmN0aW9uIF8oZSx0KXtPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGZ1bmN0aW9uKHIpe3ZhciBhPXRbcl07ITE9PT1hP2UucmVtb3ZlQXR0cmlidXRlKHIpOmUuc2V0QXR0cmlidXRlKHIsdFtyXSl9KX1mdW5jdGlvbiBVKGUsdCl7dmFyIHI9ZS5vZmZzZXRzLGE9ci5wb3BwZXIscD1yLnJlZmVyZW5jZSxvPVFlLGk9ZnVuY3Rpb24oZSl7cmV0dXJuIGV9LG49byhhLndpZHRoKSxzPW8ocC53aWR0aCksbD0tMSE9PVsnbGVmdCcsJ3JpZ2h0J10uaW5kZXhPZihlLnBsYWNlbWVudCksZD0tMSE9PWUucGxhY2VtZW50LmluZGV4T2YoJy0nKSxjPXQ/bHx8ZHx8cyUyPT1uJTI/bzpKZTppLG09dD9vOmk7cmV0dXJue2xlZnQ6YygxPT1zJTImJjE9PW4lMiYmIWQmJnQ/YS5sZWZ0LTE6YS5sZWZ0KSx0b3A6bShhLnRvcCksYm90dG9tOm0oYS5ib3R0b20pLHJpZ2h0OmMoYS5yaWdodCl9fWZ1bmN0aW9uIFYoZSx0LHIpe3ZhciBhPVMoZSxmdW5jdGlvbihlKXt2YXIgcj1lLm5hbWU7cmV0dXJuIHI9PT10fSkscD0hIWEmJmUuc29tZShmdW5jdGlvbihlKXtyZXR1cm4gZS5uYW1lPT09ciYmZS5lbmFibGVkJiZlLm9yZGVyPGEub3JkZXJ9KTtpZighcCl7dmFyIG89J2AnK3QrJ2AnO2NvbnNvbGUud2FybignYCcrcisnYCcrJyBtb2RpZmllciBpcyByZXF1aXJlZCBieSAnK28rJyBtb2RpZmllciBpbiBvcmRlciB0byB3b3JrLCBiZSBzdXJlIHRvIGluY2x1ZGUgaXQgYmVmb3JlICcrbysnIScpfXJldHVybiBwfWZ1bmN0aW9uIHEoZSl7cmV0dXJuJ2VuZCc9PT1lPydzdGFydCc6J3N0YXJ0Jz09PWU/J2VuZCc6ZX1mdW5jdGlvbiBqKGUpe3ZhciB0PSEhKDE8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzFdKSYmYXJndW1lbnRzWzFdLHI9RXQuaW5kZXhPZihlKSxhPUV0LnNsaWNlKHIrMSkuY29uY2F0KEV0LnNsaWNlKDAscikpO3JldHVybiB0P2EucmV2ZXJzZSgpOmF9ZnVuY3Rpb24gSyhlLHQscixhKXt2YXIgcD1lLm1hdGNoKC8oKD86XFwtfFxcKyk/XFxkKlxcLj9cXGQqKSguKikvKSxvPStwWzFdLGk9cFsyXTtpZighbylyZXR1cm4gZTtpZigwPT09aS5pbmRleE9mKCclJykpe3ZhciBuO3N3aXRjaChpKXtjYXNlJyVwJzpuPXI7YnJlYWs7Y2FzZSclJzpjYXNlJyVyJzpkZWZhdWx0Om49YTt9dmFyIHM9YihuKTtyZXR1cm4gc1t0XS8xMDAqb31pZigndmgnPT09aXx8J3Z3Jz09PWkpe3ZhciBsO3JldHVybiBsPSd2aCc9PT1pP1plKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQsd2luZG93LmlubmVySGVpZ2h0fHwwKTpaZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgsd2luZG93LmlubmVyV2lkdGh8fDApLGwvMTAwKm99cmV0dXJuIG99ZnVuY3Rpb24gRyhlLHQscixhKXt2YXIgcD1bMCwwXSxvPS0xIT09WydyaWdodCcsJ2xlZnQnXS5pbmRleE9mKGEpLGk9ZS5zcGxpdCgvKFxcK3xcXC0pLykubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBlLnRyaW0oKX0pLG49aS5pbmRleE9mKFMoaSxmdW5jdGlvbihlKXtyZXR1cm4tMSE9PWUuc2VhcmNoKC8sfFxccy8pfSkpO2lbbl0mJi0xPT09aVtuXS5pbmRleE9mKCcsJykmJmNvbnNvbGUud2FybignT2Zmc2V0cyBzZXBhcmF0ZWQgYnkgd2hpdGUgc3BhY2UocykgYXJlIGRlcHJlY2F0ZWQsIHVzZSBhIGNvbW1hICgsKSBpbnN0ZWFkLicpO3ZhciBzPS9cXHMqLFxccyp8XFxzKy8sbD0tMT09PW4/W2ldOltpLnNsaWNlKDAsbikuY29uY2F0KFtpW25dLnNwbGl0KHMpWzBdXSksW2lbbl0uc3BsaXQocylbMV1dLmNvbmNhdChpLnNsaWNlKG4rMSkpXTtyZXR1cm4gbD1sLm1hcChmdW5jdGlvbihlLGEpe3ZhciBwPSgxPT09YT8hbzpvKT8naGVpZ2h0Jzond2lkdGgnLGk9ITE7cmV0dXJuIGUucmVkdWNlKGZ1bmN0aW9uKGUsdCl7cmV0dXJuJyc9PT1lW2UubGVuZ3RoLTFdJiYtMSE9PVsnKycsJy0nXS5pbmRleE9mKHQpPyhlW2UubGVuZ3RoLTFdPXQsaT0hMCxlKTppPyhlW2UubGVuZ3RoLTFdKz10LGk9ITEsZSk6ZS5jb25jYXQodCl9LFtdKS5tYXAoZnVuY3Rpb24oZSl7cmV0dXJuIEsoZSxwLHQscil9KX0pLGwuZm9yRWFjaChmdW5jdGlvbihlLHQpe2UuZm9yRWFjaChmdW5jdGlvbihyLGEpe3oocikmJihwW3RdKz1yKignLSc9PT1lW2EtMV0/LTE6MSkpfSl9KSxwfWZ1bmN0aW9uIEooZSx0KXt2YXIgcj10Lm9mZnNldCxhPWUucGxhY2VtZW50LHA9ZS5vZmZzZXRzLG89cC5wb3BwZXIsaT1wLnJlZmVyZW5jZSxuPWEuc3BsaXQoJy0nKVswXSxzPXZvaWQgMDtyZXR1cm4gcz16KCtyKT9bK3IsMF06RyhyLG8saSxuKSwnbGVmdCc9PT1uPyhvLnRvcCs9c1swXSxvLmxlZnQtPXNbMV0pOidyaWdodCc9PT1uPyhvLnRvcCs9c1swXSxvLmxlZnQrPXNbMV0pOid0b3AnPT09bj8oby5sZWZ0Kz1zWzBdLG8udG9wLT1zWzFdKTonYm90dG9tJz09PW4mJihvLmxlZnQrPXNbMF0sby50b3ArPXNbMV0pLGUucG9wcGVyPW8sZX1mdW5jdGlvbiBRKGUpe3JldHVybltdLnNsaWNlLmNhbGwoZSl9ZnVuY3Rpb24gWihlLHQpe3JldHVybihUdC5jbG9zZXN0fHxmdW5jdGlvbihlKXtmb3IodmFyIHQ9dGhpczt0Oyl7aWYoU3QuY2FsbCh0LGUpKXJldHVybiB0O3Q9dC5wYXJlbnRFbGVtZW50fX0pLmNhbGwoZSx0KX1mdW5jdGlvbiAkKGUsdCl7Zm9yKDtlOyl7aWYodChlKSlyZXR1cm4gZTtlPWUucGFyZW50RWxlbWVudH19ZnVuY3Rpb24gZWUoKXtyZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyl9ZnVuY3Rpb24gdGUoZSx0KXtlW1l0LngmJidpbm5lckhUTUwnXT10IGluc3RhbmNlb2YgRWxlbWVudD90W1l0LngmJidpbm5lckhUTUwnXTp0fWZ1bmN0aW9uIHJlKGUsdCl7dC5jb250ZW50IGluc3RhbmNlb2YgRWxlbWVudD8odGUoZSwnJyksZS5hcHBlbmRDaGlsZCh0LmNvbnRlbnQpKTplW3QuYWxsb3dIVE1MPydpbm5lckhUTUwnOid0ZXh0Q29udGVudCddPXQuY29udGVudH1mdW5jdGlvbiBhZShlKXtyZXR1cm57dG9vbHRpcDplLnF1ZXJ5U2VsZWN0b3IoT3QuVE9PTFRJUCksYmFja2Ryb3A6ZS5xdWVyeVNlbGVjdG9yKE90LkJBQ0tEUk9QKSxjb250ZW50OmUucXVlcnlTZWxlY3RvcihPdC5DT05URU5UKSxhcnJvdzplLnF1ZXJ5U2VsZWN0b3IoT3QuQVJST1cpfHxlLnF1ZXJ5U2VsZWN0b3IoT3QuUk9VTkRfQVJST1cpfX1mdW5jdGlvbiBwZShlKXtlLnNldEF0dHJpYnV0ZSgnZGF0YS1pbmVydGlhJywnJyl9ZnVuY3Rpb24gb2UoZSl7ZS5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtaW5lcnRpYScpfWZ1bmN0aW9uIGllKGUpe3ZhciB0PWVlKCk7cmV0dXJuJ3JvdW5kJz09PWU/KHQuY2xhc3NOYW1lPSd0aXBweS1yb3VuZGFycm93Jyx0ZSh0LCc8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgOFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTMgOHMyLjAyMS0uMDE1IDUuMjUzLTQuMjE4QzkuNTg0IDIuMDUxIDEwLjc5NyAxLjAwNyAxMiAxYzEuMjAzLS4wMDcgMi40MTYgMS4wMzUgMy43NjEgMi43ODJDMTkuMDEyIDguMDA1IDIxIDggMjEgOEgzelwiLz48L3N2Zz4nKSk6dC5jbGFzc05hbWU9J3RpcHB5LWFycm93Jyx0fWZ1bmN0aW9uIG5lKCl7dmFyIGU9ZWUoKTtyZXR1cm4gZS5jbGFzc05hbWU9J3RpcHB5LWJhY2tkcm9wJyxlLnNldEF0dHJpYnV0ZSgnZGF0YS1zdGF0ZScsJ2hpZGRlbicpLGV9ZnVuY3Rpb24gc2UoZSx0KXtlLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCctMScpLHQuc2V0QXR0cmlidXRlKCdkYXRhLWludGVyYWN0aXZlJywnJyl9ZnVuY3Rpb24gbGUoZSx0KXtlLnJlbW92ZUF0dHJpYnV0ZSgndGFiaW5kZXgnKSx0LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1pbnRlcmFjdGl2ZScpfWZ1bmN0aW9uIGRlKGUsdCl7ZS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UmJihlLnN0eWxlLnRyYW5zaXRpb25EdXJhdGlvbj10KydtcycpfSl9ZnVuY3Rpb24gY2UoZSx0LHIpe2VbdCsnRXZlbnRMaXN0ZW5lciddKCd0cmFuc2l0aW9uZW5kJyxyKX1mdW5jdGlvbiBtZShlKXt2YXIgdD1lLmdldEF0dHJpYnV0ZSgneC1wbGFjZW1lbnQnKTtyZXR1cm4gdD90LnNwbGl0KCctJylbMF06Jyd9ZnVuY3Rpb24gZmUoZSx0KXtlLmZvckVhY2goZnVuY3Rpb24oZSl7ZSYmZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3RhdGUnLHQpfSl9ZnVuY3Rpb24gaGUoZSl7dm9pZCBlLm9mZnNldEhlaWdodH1mdW5jdGlvbiBiZShlLHQpe3ZhciByPWVlKCk7ci5jbGFzc05hbWU9J3RpcHB5LXBvcHBlcicsci5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCd0b29sdGlwJyksci5pZD0ndGlwcHktJytlLHIuc3R5bGUuekluZGV4PXQuekluZGV4O3ZhciBhPWVlKCk7YS5jbGFzc05hbWU9J3RpcHB5LXRvb2x0aXAnLGEuc3R5bGUubWF4V2lkdGg9dC5tYXhXaWR0aCsoJ251bWJlcic9PXR5cGVvZiB0Lm1heFdpZHRoPydweCc6JycpLGEuc2V0QXR0cmlidXRlKCdkYXRhLXNpemUnLHQuc2l6ZSksYS5zZXRBdHRyaWJ1dGUoJ2RhdGEtYW5pbWF0aW9uJyx0LmFuaW1hdGlvbiksYS5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3RhdGUnLCdoaWRkZW4nKSx0LnRoZW1lLnNwbGl0KCcgJykuZm9yRWFjaChmdW5jdGlvbihlKXthLmNsYXNzTGlzdC5hZGQoZSsnLXRoZW1lJyl9KTt2YXIgcD1lZSgpO3JldHVybiBwLmNsYXNzTmFtZT0ndGlwcHktY29udGVudCcscC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3RhdGUnLCdoaWRkZW4nKSx0LmludGVyYWN0aXZlJiZzZShyLGEpLHQuYXJyb3cmJmEuYXBwZW5kQ2hpbGQoaWUodC5hcnJvd1R5cGUpKSx0LmFuaW1hdGVGaWxsJiYoYS5hcHBlbmRDaGlsZChuZSgpKSxhLnNldEF0dHJpYnV0ZSgnZGF0YS1hbmltYXRlZmlsbCcsJycpKSx0LmluZXJ0aWEmJnBlKGEpLHJlKHAsdCksYS5hcHBlbmRDaGlsZChwKSxyLmFwcGVuZENoaWxkKGEpLHIuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLGZ1bmN0aW9uKHQpe3QucmVsYXRlZFRhcmdldCYmci5fdGlwcHkmJiEkKHQucmVsYXRlZFRhcmdldCxmdW5jdGlvbihlKXtyZXR1cm4gZT09PXJ9KSYmdC5yZWxhdGVkVGFyZ2V0IT09ci5fdGlwcHkucmVmZXJlbmNlJiZyLl90aXBweS5wcm9wcy5zaG91bGRQb3BwZXJIaWRlT25CbHVyKHQpJiZyLl90aXBweS5oaWRlKCl9KSxyfWZ1bmN0aW9uIHllKGUsdCxyKXt2YXIgYT1hZShlKSxwPWEudG9vbHRpcCxvPWEuY29udGVudCxpPWEuYmFja2Ryb3Asbj1hLmFycm93O2Uuc3R5bGUuekluZGV4PXIuekluZGV4LHAuc2V0QXR0cmlidXRlKCdkYXRhLXNpemUnLHIuc2l6ZSkscC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYW5pbWF0aW9uJyxyLmFuaW1hdGlvbikscC5zdHlsZS5tYXhXaWR0aD1yLm1heFdpZHRoKygnbnVtYmVyJz09dHlwZW9mIHIubWF4V2lkdGg/J3B4JzonJyksdC5jb250ZW50IT09ci5jb250ZW50JiZyZShvLHIpLCF0LmFuaW1hdGVGaWxsJiZyLmFuaW1hdGVGaWxsPyhwLmFwcGVuZENoaWxkKG5lKCkpLHAuc2V0QXR0cmlidXRlKCdkYXRhLWFuaW1hdGVmaWxsJywnJykpOnQuYW5pbWF0ZUZpbGwmJiFyLmFuaW1hdGVGaWxsJiYocC5yZW1vdmVDaGlsZChpKSxwLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1hbmltYXRlZmlsbCcpKSwhdC5hcnJvdyYmci5hcnJvdz9wLmFwcGVuZENoaWxkKGllKHIuYXJyb3dUeXBlKSk6dC5hcnJvdyYmIXIuYXJyb3cmJnAucmVtb3ZlQ2hpbGQobiksdC5hcnJvdyYmci5hcnJvdyYmdC5hcnJvd1R5cGUhPT1yLmFycm93VHlwZSYmcC5yZXBsYWNlQ2hpbGQoaWUoci5hcnJvd1R5cGUpLG4pLCF0LmludGVyYWN0aXZlJiZyLmludGVyYWN0aXZlP3NlKGUscCk6dC5pbnRlcmFjdGl2ZSYmIXIuaW50ZXJhY3RpdmUmJmxlKGUscCksIXQuaW5lcnRpYSYmci5pbmVydGlhP3BlKHApOnQuaW5lcnRpYSYmIXIuaW5lcnRpYSYmb2UocCksdC50aGVtZSE9PXIudGhlbWUmJih0LnRoZW1lLnNwbGl0KCcgJykuZm9yRWFjaChmdW5jdGlvbihlKXtwLmNsYXNzTGlzdC5yZW1vdmUoZSsnLXRoZW1lJyl9KSxyLnRoZW1lLnNwbGl0KCcgJykuZm9yRWFjaChmdW5jdGlvbihlKXtwLmNsYXNzTGlzdC5hZGQoZSsnLXRoZW1lJyl9KSl9ZnVuY3Rpb24gdWUoZSx0KXt2YXIgcj1lLnBvcHBlcixhPWUub3B0aW9ucyxwPWEub25DcmVhdGUsbz1hLm9uVXBkYXRlO2Eub25DcmVhdGU9YS5vblVwZGF0ZT1mdW5jdGlvbigpe2hlKHIpLHQoKSxvKCksYS5vbkNyZWF0ZT1wLGEub25VcGRhdGU9b319ZnVuY3Rpb24gZ2UoZSl7UShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKE90LlBPUFBFUikpLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIHI9dC5fdGlwcHk7ciYmITA9PT1yLnByb3BzLmhpZGVPbkNsaWNrJiYoIWV8fHQhPT1lLnBvcHBlcikmJnIuaGlkZSgpfSl9ZnVuY3Rpb24geGUoZSx0LHIsYSl7aWYoIWUpcmV0dXJuITA7dmFyIHA9ci5jbGllbnRYLG89ci5jbGllbnRZLGk9YS5pbnRlcmFjdGl2ZUJvcmRlcixuPWEuZGlzdGFuY2Uscz10LnRvcC1vPigndG9wJz09PWU/aStuOmkpLGw9by10LmJvdHRvbT4oJ2JvdHRvbSc9PT1lP2krbjppKSxkPXQubGVmdC1wPignbGVmdCc9PT1lP2krbjppKSxjPXAtdC5yaWdodD4oJ3JpZ2h0Jz09PWU/aStuOmkpO3JldHVybiBzfHxsfHxkfHxjfWZ1bmN0aW9uIHdlKGUsdCl7cmV0dXJuLShlLXQpKydweCd9ZnVuY3Rpb24gdmUoZSl7cmV0dXJuJ1tvYmplY3QgT2JqZWN0XSc9PT17fS50b1N0cmluZy5jYWxsKGUpfWZ1bmN0aW9uIGtlKGUsdCl7cmV0dXJue30uaGFzT3duUHJvcGVydHkuY2FsbChlLHQpfWZ1bmN0aW9uIEVlKGUpe3JldHVybiFpc05hTihlKSYmIWlzTmFOKHBhcnNlRmxvYXQoZSkpfWZ1bmN0aW9uIENlKGUpe2lmKGUgaW5zdGFuY2VvZiBFbGVtZW50fHx2ZShlKSlyZXR1cm5bZV07aWYoZSBpbnN0YW5jZW9mIE5vZGVMaXN0KXJldHVybiBRKGUpO2lmKEFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIGU7dHJ5e3JldHVybiBRKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoZSkpfWNhdGNoKHQpe3JldHVybltdfX1mdW5jdGlvbiBMZShlLHQscil7aWYoQXJyYXkuaXNBcnJheShlKSl7dmFyIGE9ZVt0XTtyZXR1cm4gbnVsbD09YT9yOmF9cmV0dXJuIGV9ZnVuY3Rpb24gT2UoZSl7dmFyIHQ9d2luZG93LnNjcm9sbFh8fHdpbmRvdy5wYWdlWE9mZnNldCxyPXdpbmRvdy5zY3JvbGxZfHx3aW5kb3cucGFnZVlPZmZzZXQ7ZS5mb2N1cygpLHNjcm9sbCh0LHIpfWZ1bmN0aW9uIFRlKGUpe3NldFRpbWVvdXQoZSwxKX1mdW5jdGlvbiBTZShlLHQpe3ZhciByO3JldHVybiBmdW5jdGlvbigpe3ZhciBhPXRoaXMscD1hcmd1bWVudHM7Y2xlYXJUaW1lb3V0KHIpLHI9c2V0VGltZW91dChmdW5jdGlvbigpe3JldHVybiBlLmFwcGx5KGEscCl9LHQpfX1mdW5jdGlvbiBBZShlLHQpe3JldHVybiBlJiZlLm1vZGlmaWVycyYmZS5tb2RpZmllcnNbdF19ZnVuY3Rpb24gWWUoZSx0KXtyZXR1cm4tMTxlLmluZGV4T2YodCl9ZnVuY3Rpb24gUGUoKXtQdHx8KFB0PSEwLGl0JiZkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ3RpcHB5LWlPUycpLHdpbmRvdy5wZXJmb3JtYW5jZSYmZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJyxEZSkpfWZ1bmN0aW9uIERlKCl7dmFyIGU9cGVyZm9ybWFuY2Uubm93KCk7MjA+ZS1EdCYmKFB0PSExLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsRGUpLCFpdCYmZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCd0aXBweS1pT1MnKSksRHQ9ZX1mdW5jdGlvbiBYZShlKXt2YXIgdD1lLnRhcmdldDtpZighKHQgaW5zdGFuY2VvZiBFbGVtZW50KSlyZXR1cm4gZ2UoKTt2YXIgcj1aKHQsT3QuUE9QUEVSKTtpZighKHImJnIuX3RpcHB5JiZyLl90aXBweS5wcm9wcy5pbnRlcmFjdGl2ZSkpe3ZhciBhPSQodCxmdW5jdGlvbihlKXtyZXR1cm4gZS5fdGlwcHkmJmUuX3RpcHB5LnJlZmVyZW5jZT09PWV9KTtpZihhKXt2YXIgcD1hLl90aXBweSxvPVllKHAucHJvcHMudHJpZ2dlciwnY2xpY2snKTtpZihQdHx8bylyZXR1cm4gZ2UocCk7aWYoITAhPT1wLnByb3BzLmhpZGVPbkNsaWNrfHxvKXJldHVybjtwLmNsZWFyRGVsYXlUaW1lb3V0cygpfWdlKCl9fWZ1bmN0aW9uIEllKCl7dmFyIGU9ZG9jdW1lbnQsdD1lLmFjdGl2ZUVsZW1lbnQ7dCYmdC5ibHVyJiZ0Ll90aXBweSYmdC5ibHVyKCl9ZnVuY3Rpb24gTmUoKXtRKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoT3QuUE9QUEVSKSkuZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD1lLl90aXBweTt0LnByb3BzLmxpdmVQbGFjZW1lbnR8fHQucG9wcGVySW5zdGFuY2Uuc2NoZWR1bGVVcGRhdGUoKX0pfWZ1bmN0aW9uIEhlKCl7ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLFhlLCEwKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JyxQZSxBdCksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLEllKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJyxOZSksIW50JiYobmF2aWdhdG9yLm1heFRvdWNoUG9pbnRzfHxuYXZpZ2F0b3IubXNNYXhUb3VjaFBvaW50cykmJmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJkb3duJyxQZSl9ZnVuY3Rpb24gV2UoZSl7cmV0dXJuIShlIGluc3RhbmNlb2YgRWxlbWVudCl8fFN0LmNhbGwoZSwnYVtocmVmXSxhcmVhW2hyZWZdLGJ1dHRvbixkZXRhaWxzLGlucHV0LHRleHRhcmVhLHNlbGVjdCxpZnJhbWUsW3RhYmluZGV4XScpJiYhZS5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJyl9ZnVuY3Rpb24gTWUoZSl7cmV0dXJuIFh0LnJlZHVjZShmdW5jdGlvbih0LHIpe3ZhciBhPShlLmdldEF0dHJpYnV0ZSgnZGF0YS10aXBweS0nK3IpfHwnJykudHJpbSgpO3JldHVybiBhPyh0W3JdPSdjb250ZW50Jz09PXI/YTondHJ1ZSc9PT1hfHwnZmFsc2UnIT09YSYmKEVlKGEpPythOidbJz09PWFbMF18fCd7Jz09PWFbMF0/SlNPTi5wYXJzZShhKTphKSx0KTp0fSx7fSl9ZnVuY3Rpb24gQmUoZSl7dmFyIHQ9e2lzVmlydHVhbDohMCxhdHRyaWJ1dGVzOmUuYXR0cmlidXRlc3x8e30sc2V0QXR0cmlidXRlOmZ1bmN0aW9uKHQscil7ZS5hdHRyaWJ1dGVzW3RdPXJ9LGdldEF0dHJpYnV0ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5hdHRyaWJ1dGVzW3RdfSxyZW1vdmVBdHRyaWJ1dGU6ZnVuY3Rpb24odCl7ZGVsZXRlIGUuYXR0cmlidXRlc1t0XX0saGFzQXR0cmlidXRlOmZ1bmN0aW9uKHQpe3JldHVybiB0IGluIGUuYXR0cmlidXRlc30sYWRkRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbigpe30scmVtb3ZlRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbigpe30sY2xhc3NMaXN0OntjbGFzc05hbWVzOnt9LGFkZDpmdW5jdGlvbih0KXtlLmNsYXNzTGlzdC5jbGFzc05hbWVzW3RdPSEwfSxyZW1vdmU6ZnVuY3Rpb24odCl7ZGVsZXRlIGUuY2xhc3NMaXN0LmNsYXNzTmFtZXNbdF19LGNvbnRhaW5zOmZ1bmN0aW9uKHQpe3JldHVybiB0IGluIGUuY2xhc3NMaXN0LmNsYXNzTmFtZXN9fX07Zm9yKHZhciByIGluIHQpZVtyXT10W3JdfWZ1bmN0aW9uIFJlKGUsdCl7dmFyIHI9SXQoe30sdCx0LnBlcmZvcm1hbmNlP3t9Ok1lKGUpKTtyZXR1cm4gci5hcnJvdyYmKHIuYW5pbWF0ZUZpbGw9ITEpLCdmdW5jdGlvbic9PXR5cGVvZiByLmFwcGVuZFRvJiYoci5hcHBlbmRUbz10LmFwcGVuZFRvKGUpKSwnZnVuY3Rpb24nPT10eXBlb2Ygci5jb250ZW50JiYoci5jb250ZW50PXQuY29udGVudChlKSkscn1mdW5jdGlvbiB6ZSgpe3ZhciBlPTA8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTp7fSx0PWFyZ3VtZW50c1sxXTtPYmplY3Qua2V5cyhlKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2lmKCFrZSh0LGUpKXRocm93IG5ldyBFcnJvcignW3RpcHB5XTogYCcrZSsnYCBpcyBub3QgYSB2YWxpZCBvcHRpb24nKX0pfWZ1bmN0aW9uIEZlKGUsdCl7cmV0dXJuKHQ/ZTp7WDonWScsWTonWCd9W2VdKXx8Jyd9ZnVuY3Rpb24gX2UoZSx0LHIscCl7dmFyIG89dFswXSxpPXRbMV07aWYoIW8mJiFpKXJldHVybicnO3ZhciBuPXtzY2FsZTpmdW5jdGlvbigpe3JldHVybiBpP3I/bysnLCAnK2k6aSsnLCAnK286Jycrb30oKSx0cmFuc2xhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gaT9yP3A/bysncHgsICcrLWkrJ3B4JzpvKydweCwgJytpKydweCc6cD8taSsncHgsICcrbysncHgnOmkrJ3B4LCAnK28rJ3B4JzpwPy1vKydweCc6bysncHgnfSgpfTtyZXR1cm4gbltlXX1mdW5jdGlvbiBVZShlLHQpe3ZhciByPWUubWF0Y2gobmV3IFJlZ0V4cCh0KycoW1hZXSknKSk7cmV0dXJuIHI/clsxXTonJ31mdW5jdGlvbiBWZShlLHQpe3ZhciByPWUubWF0Y2godCk7cmV0dXJuIHI/clsxXS5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gcGFyc2VGbG9hdChlLDEwKX0pOltdfWZ1bmN0aW9uIHFlKGUsdCl7dmFyIHI9bWUoWihlLE90LlBPUFBFUikpLGE9WWUoWyd0b3AnLCdib3R0b20nXSxyKSxwPVllKFsncmlnaHQnLCdib3R0b20nXSxyKSxvPXt0cmFuc2xhdGU6e2F4aXM6VWUodCwndHJhbnNsYXRlJyksbnVtYmVyczpWZSh0LE50LnRyYW5zbGF0ZSl9LHNjYWxlOntheGlzOlVlKHQsJ3NjYWxlJyksbnVtYmVyczpWZSh0LE50LnNjYWxlKX19LGk9dC5yZXBsYWNlKE50LnRyYW5zbGF0ZSwndHJhbnNsYXRlJytGZShvLnRyYW5zbGF0ZS5heGlzLGEpKycoJytfZSgndHJhbnNsYXRlJyxvLnRyYW5zbGF0ZS5udW1iZXJzLGEscCkrJyknKS5yZXBsYWNlKE50LnNjYWxlLCdzY2FsZScrRmUoby5zY2FsZS5heGlzLGEpKycoJytfZSgnc2NhbGUnLG8uc2NhbGUubnVtYmVycyxhLHApKycpJyk7ZS5zdHlsZVsndW5kZWZpbmVkJz09dHlwZW9mIGRvY3VtZW50LmJvZHkuc3R5bGUudHJhbnNmb3JtPyd3ZWJraXRUcmFuc2Zvcm0nOid0cmFuc2Zvcm0nXT1pfWZ1bmN0aW9uIGplKGUsdCl7ZnVuY3Rpb24gcigpe1RlKGZ1bmN0aW9uKCl7ej0hMX0pfWZ1bmN0aW9uIGEoKXtYPW5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uKCl7cS5wb3BwZXJJbnN0YW5jZS51cGRhdGUoKX0pLFgub2JzZXJ2ZShVLHtjaGlsZExpc3Q6ITAsc3VidHJlZTohMCxjaGFyYWN0ZXJEYXRhOiEwfSl9ZnVuY3Rpb24gcChlKXt2YXIgdD1OPWUscj10LmNsaWVudFgsYT10LmNsaWVudFk7aWYocS5wb3BwZXJJbnN0YW5jZSl7dmFyIHA9bWUocS5wb3BwZXIpLG89cS5wb3BwZXJDaGlsZHJlbi5hcnJvdz8yMDo1LGk9WWUoWyd0b3AnLCdib3R0b20nXSxwKSxuPVllKFsnbGVmdCcsJ3JpZ2h0J10scCksbD1pP1plKG8scik6cixkPW4/WmUobyxhKTphO2kmJmw+byYmKGw9R2Uocix3aW5kb3cuaW5uZXJXaWR0aC1vKSksbiYmZD5vJiYoZD1HZShhLHdpbmRvdy5pbm5lckhlaWdodC1vKSk7dmFyIGM9cS5yZWZlcmVuY2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksbT1xLnByb3BzLmZvbGxvd0N1cnNvcixmPSdob3Jpem9udGFsJz09PW0saD0ndmVydGljYWwnPT09bTtxLnBvcHBlckluc3RhbmNlLnJlZmVyZW5jZT17Z2V0Qm91bmRpbmdDbGllbnRSZWN0OmZ1bmN0aW9uKCl7cmV0dXJue3dpZHRoOjAsaGVpZ2h0OjAsdG9wOmY/Yy50b3A6ZCxib3R0b206Zj9jLmJvdHRvbTpkLGxlZnQ6aD9jLmxlZnQ6bCxyaWdodDpoP2MucmlnaHQ6bH19LGNsaWVudFdpZHRoOjAsY2xpZW50SGVpZ2h0OjB9LHEucG9wcGVySW5zdGFuY2Uuc2NoZWR1bGVVcGRhdGUoKSwnaW5pdGlhbCc9PT1tJiZxLnN0YXRlLmlzVmlzaWJsZSYmcygpfX1mdW5jdGlvbiBvKGUpe3ZhciB0PVooZS50YXJnZXQscS5wcm9wcy50YXJnZXQpO3QmJiF0Ll90aXBweSYmKGplKHQsSXQoe30scS5wcm9wcyx7dGFyZ2V0OicnLHNob3dPbkluaXQ6ITB9KSksaShlKSl9ZnVuY3Rpb24gaShlKXtpZihUKCksIXEuc3RhdGUuaXNWaXNpYmxlKXtpZihxLnByb3BzLnRhcmdldClyZXR1cm4gbyhlKTtpZihNPSEwLHEucHJvcHMud2FpdClyZXR1cm4gcS5wcm9wcy53YWl0KHEsZSk7eCgpJiYhcS5zdGF0ZS5pc01vdW50ZWQmJmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScscCk7dmFyIHQ9TGUocS5wcm9wcy5kZWxheSwwLHN0LmRlbGF5KTt0P0g9c2V0VGltZW91dChmdW5jdGlvbigpe0EoKX0sdCk6QSgpfX1mdW5jdGlvbiBuKCl7aWYoVCgpLCFxLnN0YXRlLmlzVmlzaWJsZSlyZXR1cm4gcygpO009ITE7dmFyIGU9TGUocS5wcm9wcy5kZWxheSwxLHN0LmRlbGF5KTtlP1c9c2V0VGltZW91dChmdW5jdGlvbigpe3Euc3RhdGUuaXNWaXNpYmxlJiZZKCl9LGUpOlkoKX1mdW5jdGlvbiBzKCl7ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJyxwKSxOPW51bGx9ZnVuY3Rpb24gbCgpe2RvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsbiksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJyxGKX1mdW5jdGlvbiBkKGUpeyFxLnN0YXRlLmlzRW5hYmxlZHx8eShlKXx8KCFxLnN0YXRlLmlzVmlzaWJsZSYmKEk9ZSksJ2NsaWNrJz09PWUudHlwZSYmITEhPT1xLnByb3BzLmhpZGVPbkNsaWNrJiZxLnN0YXRlLmlzVmlzaWJsZT9uKCk6aShlKSl9ZnVuY3Rpb24gYyhlKXt2YXIgdD0kKGUudGFyZ2V0LGZ1bmN0aW9uKGUpe3JldHVybiBlLl90aXBweX0pLHI9WihlLnRhcmdldCxPdC5QT1BQRVIpPT09cS5wb3BwZXIsYT10PT09cS5yZWZlcmVuY2U7cnx8YXx8eGUobWUocS5wb3BwZXIpLHEucG9wcGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGUscS5wcm9wcykmJihsKCksbigpKX1mdW5jdGlvbiBtKGUpe3JldHVybiB5KGUpP3ZvaWQgMDpxLnByb3BzLmludGVyYWN0aXZlPyhkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLG4pLHZvaWQgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJyxGKSk6dm9pZCBuKCl9ZnVuY3Rpb24gZihlKXtpZihlLnRhcmdldD09PXEucmVmZXJlbmNlKXtpZihxLnByb3BzLmludGVyYWN0aXZlKXtpZighZS5yZWxhdGVkVGFyZ2V0KXJldHVybjtpZihaKGUucmVsYXRlZFRhcmdldCxPdC5QT1BQRVIpKXJldHVybn1uKCl9fWZ1bmN0aW9uIGgoZSl7WihlLnRhcmdldCxxLnByb3BzLnRhcmdldCkmJmkoZSl9ZnVuY3Rpb24gYihlKXtaKGUudGFyZ2V0LHEucHJvcHMudGFyZ2V0KSYmbigpfWZ1bmN0aW9uIHkoZSl7dmFyIHQ9WWUoZS50eXBlLCd0b3VjaCcpLHI9bnQmJlB0JiZxLnByb3BzLnRvdWNoSG9sZCYmIXQsYT1QdCYmIXEucHJvcHMudG91Y2hIb2xkJiZ0O3JldHVybiByfHxhfWZ1bmN0aW9uIHUoKXt2YXIgZT1xLnByb3BzLnBvcHBlck9wdGlvbnMsdD1xLnBvcHBlckNoaWxkcmVuLHI9dC50b29sdGlwLGE9dC5hcnJvdztyZXR1cm4gbmV3IEx0KHEucmVmZXJlbmNlLHEucG9wcGVyLEl0KHtwbGFjZW1lbnQ6cS5wcm9wcy5wbGFjZW1lbnR9LGUse21vZGlmaWVyczpJdCh7fSxlP2UubW9kaWZpZXJzOnt9LHtwcmV2ZW50T3ZlcmZsb3c6SXQoe2JvdW5kYXJpZXNFbGVtZW50OnEucHJvcHMuYm91bmRhcnl9LEFlKGUsJ3ByZXZlbnRPdmVyZmxvdycpKSxhcnJvdzpJdCh7ZWxlbWVudDphLGVuYWJsZWQ6ISFhfSxBZShlLCdhcnJvdycpKSxmbGlwOkl0KHtlbmFibGVkOnEucHJvcHMuZmxpcCxwYWRkaW5nOnEucHJvcHMuZGlzdGFuY2UrNSxiZWhhdmlvcjpxLnByb3BzLmZsaXBCZWhhdmlvcn0sQWUoZSwnZmxpcCcpKSxvZmZzZXQ6SXQoe29mZnNldDpxLnByb3BzLm9mZnNldH0sQWUoZSwnb2Zmc2V0JykpfSksb25DcmVhdGU6ZnVuY3Rpb24oKXtyLnN0eWxlW21lKHEucG9wcGVyKV09d2UocS5wcm9wcy5kaXN0YW5jZSxzdC5kaXN0YW5jZSksYSYmcS5wcm9wcy5hcnJvd1RyYW5zZm9ybSYmcWUoYSxxLnByb3BzLmFycm93VHJhbnNmb3JtKX0sb25VcGRhdGU6ZnVuY3Rpb24oKXt2YXIgZT1yLnN0eWxlO2UudG9wPScnLGUuYm90dG9tPScnLGUubGVmdD0nJyxlLnJpZ2h0PScnLGVbbWUocS5wb3BwZXIpXT13ZShxLnByb3BzLmRpc3RhbmNlLHN0LmRpc3RhbmNlKSxhJiZxLnByb3BzLmFycm93VHJhbnNmb3JtJiZxZShhLHEucHJvcHMuYXJyb3dUcmFuc2Zvcm0pfX0pKX1mdW5jdGlvbiBnKGUpe3EucG9wcGVySW5zdGFuY2U/IXgoKSYmKHEucG9wcGVySW5zdGFuY2Uuc2NoZWR1bGVVcGRhdGUoKSxxLnByb3BzLmxpdmVQbGFjZW1lbnQmJnEucG9wcGVySW5zdGFuY2UuZW5hYmxlRXZlbnRMaXN0ZW5lcnMoKSk6KHEucG9wcGVySW5zdGFuY2U9dSgpLGEoKSwoIXEucHJvcHMubGl2ZVBsYWNlbWVudHx8eCgpKSYmcS5wb3BwZXJJbnN0YW5jZS5kaXNhYmxlRXZlbnRMaXN0ZW5lcnMoKSkscS5wb3BwZXJJbnN0YW5jZS5yZWZlcmVuY2U9cS5yZWZlcmVuY2U7dmFyIHQ9cS5wb3BwZXJDaGlsZHJlbi5hcnJvdztpZih4KCkpe3QmJih0LnN0eWxlLm1hcmdpbj0nMCcpO3ZhciByPUxlKHEucHJvcHMuZGVsYXksMCxzdC5kZWxheSk7SS50eXBlJiZwKHImJk4/TjpJKX1lbHNlIHQmJih0LnN0eWxlLm1hcmdpbj0nJyk7dWUocS5wb3BwZXJJbnN0YW5jZSxlKSxxLnByb3BzLmFwcGVuZFRvLmNvbnRhaW5zKHEucG9wcGVyKXx8KHEucHJvcHMuYXBwZW5kVG8uYXBwZW5kQ2hpbGQocS5wb3BwZXIpLHEucHJvcHMub25Nb3VudChxKSxxLnN0YXRlLmlzTW91bnRlZD0hMCl9ZnVuY3Rpb24geCgpe3JldHVybiBxLnByb3BzLmZvbGxvd0N1cnNvciYmIVB0JiYnZm9jdXMnIT09SS50eXBlfWZ1bmN0aW9uIHcoKXtkZShbcS5wb3BwZXJdLG90PzA6cS5wcm9wcy51cGRhdGVEdXJhdGlvbik7KGZ1bmN0aW9uIGUoKXtxLnBvcHBlckluc3RhbmNlJiZxLnBvcHBlckluc3RhbmNlLnNjaGVkdWxlVXBkYXRlKCkscS5zdGF0ZS5pc01vdW50ZWQ/cmVxdWVzdEFuaW1hdGlvbkZyYW1lKGUpOmRlKFtxLnBvcHBlcl0sMCl9KSgpfWZ1bmN0aW9uIHYoZSx0KXtFKGUsZnVuY3Rpb24oKXshcS5zdGF0ZS5pc1Zpc2libGUmJnEucHJvcHMuYXBwZW5kVG8uY29udGFpbnMocS5wb3BwZXIpJiZ0KCl9KX1mdW5jdGlvbiBrKGUsdCl7RShlLHQpfWZ1bmN0aW9uIEUoZSx0KXtpZigwPT09ZSlyZXR1cm4gdCgpO3ZhciByPXEucG9wcGVyQ2hpbGRyZW4udG9vbHRpcCxhPWZ1bmN0aW9uIGEocCl7cC50YXJnZXQ9PT1yJiYoY2UociwncmVtb3ZlJyxhKSx0KCkpfTtjZShyLCdyZW1vdmUnLEIpLGNlKHIsJ2FkZCcsYSksQj1hfWZ1bmN0aW9uIEMoZSx0KXt2YXIgcj0hISgyPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1syXSkmJmFyZ3VtZW50c1syXTtxLnJlZmVyZW5jZS5hZGRFdmVudExpc3RlbmVyKGUsdCxyKSxSLnB1c2goe2V2ZW50VHlwZTplLGhhbmRsZXI6dCxvcHRpb25zOnJ9KX1mdW5jdGlvbiBMKCl7cS5wcm9wcy50b3VjaEhvbGQmJiFxLnByb3BzLnRhcmdldCYmKEMoJ3RvdWNoc3RhcnQnLGQsQXQpLEMoJ3RvdWNoZW5kJyxtLEF0KSkscS5wcm9wcy50cmlnZ2VyLnRyaW0oKS5zcGxpdCgnICcpLmZvckVhY2goZnVuY3Rpb24oZSl7J21hbnVhbCc9PT1lfHwocS5wcm9wcy50YXJnZXQ/J21vdXNlZW50ZXInPT09ZT8oQygnbW91c2VvdmVyJyxoKSxDKCdtb3VzZW91dCcsYikpOidmb2N1cyc9PT1lPyhDKCdmb2N1c2luJyxoKSxDKCdmb2N1c291dCcsYikpOidjbGljayc9PT1lP0MoZSxoKTp2b2lkIDA6KEMoZSxkKSwnbW91c2VlbnRlcic9PT1lP0MoJ21vdXNlbGVhdmUnLG0pOidmb2N1cyc9PT1lP0Mob3Q/J2ZvY3Vzb3V0JzonYmx1cicsZik6dm9pZCAwKSl9KX1mdW5jdGlvbiBPKCl7Ui5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciB0PWUuZXZlbnRUeXBlLHI9ZS5oYW5kbGVyLGE9ZS5vcHRpb25zO3EucmVmZXJlbmNlLnJlbW92ZUV2ZW50TGlzdGVuZXIodCxyLGEpfSksUj1bXX1mdW5jdGlvbiBUKCl7Y2xlYXJUaW1lb3V0KEgpLGNsZWFyVGltZW91dChXKX1mdW5jdGlvbiBTKCl7dmFyIGU9MDxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOnt9O3plKGUsc3QpO3ZhciB0PXEucHJvcHMscj1SZShxLnJlZmVyZW5jZSxJdCh7fSxxLnByb3BzLGUse3BlcmZvcm1hbmNlOiEwfSkpO3IucGVyZm9ybWFuY2U9a2UoZSwncGVyZm9ybWFuY2UnKT9lLnBlcmZvcm1hbmNlOnQucGVyZm9ybWFuY2UscS5wcm9wcz1yLChrZShlLCd0cmlnZ2VyJyl8fGtlKGUsJ3RvdWNoSG9sZCcpKSYmKE8oKSxMKCkpLGtlKGUsJ2ludGVyYWN0aXZlRGVib3VuY2UnKSYmKGwoKSxGPVNlKGMsZS5pbnRlcmFjdGl2ZURlYm91bmNlKSkseWUocS5wb3BwZXIsdCxyKSxxLnBvcHBlckNoaWxkcmVuPWFlKHEucG9wcGVyKSxxLnBvcHBlckluc3RhbmNlJiZsdC5zb21lKGZ1bmN0aW9uKHQpe3JldHVybiBrZShlLHQpfSkmJihxLnBvcHBlckluc3RhbmNlLmRlc3Ryb3koKSxxLnBvcHBlckluc3RhbmNlPXUoKSwhcS5zdGF0ZS5pc1Zpc2libGUmJnEucG9wcGVySW5zdGFuY2UuZGlzYWJsZUV2ZW50TGlzdGVuZXJzKCkscS5wcm9wcy5mb2xsb3dDdXJzb3ImJk4mJnAoTikpfWZ1bmN0aW9uIEEoKXt2YXIgZT0wPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06TGUocS5wcm9wcy5kdXJhdGlvbiwwLHN0LmR1cmF0aW9uWzBdKTtyZXR1cm4gcS5zdGF0ZS5pc0Rlc3Ryb3llZHx8IXEuc3RhdGUuaXNFbmFibGVkfHxQdCYmIXEucHJvcHMudG91Y2g/dm9pZCAwOnEucmVmZXJlbmNlLmlzVmlydHVhbHx8ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNvbnRhaW5zKHEucmVmZXJlbmNlKT9xLnJlZmVyZW5jZS5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk/dm9pZCAwOno/dm9pZCh6PSExKTp2b2lkKCExPT09cS5wcm9wcy5vblNob3cocSl8fChxLnBvcHBlci5zdHlsZS52aXNpYmlsaXR5PSd2aXNpYmxlJyxxLnN0YXRlLmlzVmlzaWJsZT0hMCxkZShbcS5wb3BwZXIscS5wb3BwZXJDaGlsZHJlbi50b29sdGlwLHEucG9wcGVyQ2hpbGRyZW4uYmFja2Ryb3BdLDApLGcoZnVuY3Rpb24oKXtxLnN0YXRlLmlzVmlzaWJsZSYmKCF4KCkmJnEucG9wcGVySW5zdGFuY2UudXBkYXRlKCksZGUoW3EucG9wcGVyQ2hpbGRyZW4udG9vbHRpcCxxLnBvcHBlckNoaWxkcmVuLmJhY2tkcm9wLHEucG9wcGVyQ2hpbGRyZW4uY29udGVudF0sZSkscS5wb3BwZXJDaGlsZHJlbi5iYWNrZHJvcCYmKHEucG9wcGVyQ2hpbGRyZW4uY29udGVudC5zdHlsZS50cmFuc2l0aW9uRGVsYXk9UWUoZS82KSsnbXMnKSxxLnByb3BzLmludGVyYWN0aXZlJiZxLnJlZmVyZW5jZS5jbGFzc0xpc3QuYWRkKCd0aXBweS1hY3RpdmUnKSxxLnByb3BzLnN0aWNreSYmdygpLGZlKFtxLnBvcHBlckNoaWxkcmVuLnRvb2x0aXAscS5wb3BwZXJDaGlsZHJlbi5iYWNrZHJvcCxxLnBvcHBlckNoaWxkcmVuLmNvbnRlbnRdLCd2aXNpYmxlJyksayhlLGZ1bmN0aW9uKCl7MD09PXEucHJvcHMudXBkYXRlRHVyYXRpb24mJnEucG9wcGVyQ2hpbGRyZW4udG9vbHRpcC5jbGFzc0xpc3QuYWRkKCd0aXBweS1ub3RyYW5zaXRpb24nKSxxLnByb3BzLmF1dG9Gb2N1cyYmcS5wcm9wcy5pbnRlcmFjdGl2ZSYmWWUoWydmb2N1cycsJ2NsaWNrJ10sSS50eXBlKSYmT2UocS5wb3BwZXIpLHEucHJvcHMuYXJpYSYmcS5yZWZlcmVuY2Uuc2V0QXR0cmlidXRlKCdhcmlhLScrcS5wcm9wcy5hcmlhLHEucG9wcGVyLmlkKSxxLnByb3BzLm9uU2hvd24ocSkscS5zdGF0ZS5pc1Nob3duPSEwfSkpfSkpKTpQKCl9ZnVuY3Rpb24gWSgpe3ZhciBlPTA8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTpMZShxLnByb3BzLmR1cmF0aW9uLDEsc3QuZHVyYXRpb25bMV0pO3Euc3RhdGUuaXNEZXN0cm95ZWR8fCFxLnN0YXRlLmlzRW5hYmxlZHx8ITE9PT1xLnByb3BzLm9uSGlkZShxKXx8KDA9PT1xLnByb3BzLnVwZGF0ZUR1cmF0aW9uJiZxLnBvcHBlckNoaWxkcmVuLnRvb2x0aXAuY2xhc3NMaXN0LnJlbW92ZSgndGlwcHktbm90cmFuc2l0aW9uJykscS5wcm9wcy5pbnRlcmFjdGl2ZSYmcS5yZWZlcmVuY2UuY2xhc3NMaXN0LnJlbW92ZSgndGlwcHktYWN0aXZlJykscS5wb3BwZXIuc3R5bGUudmlzaWJpbGl0eT0naGlkZGVuJyxxLnN0YXRlLmlzVmlzaWJsZT0hMSxxLnN0YXRlLmlzU2hvd249ITEsZGUoW3EucG9wcGVyQ2hpbGRyZW4udG9vbHRpcCxxLnBvcHBlckNoaWxkcmVuLmJhY2tkcm9wLHEucG9wcGVyQ2hpbGRyZW4uY29udGVudF0sZSksZmUoW3EucG9wcGVyQ2hpbGRyZW4udG9vbHRpcCxxLnBvcHBlckNoaWxkcmVuLmJhY2tkcm9wLHEucG9wcGVyQ2hpbGRyZW4uY29udGVudF0sJ2hpZGRlbicpLHEucHJvcHMuYXV0b0ZvY3VzJiZxLnByb3BzLmludGVyYWN0aXZlJiYheiYmWWUoWydmb2N1cycsJ2NsaWNrJ10sSS50eXBlKSYmKCdmb2N1cyc9PT1JLnR5cGUmJih6PSEwKSxPZShxLnJlZmVyZW5jZSkpLHYoZSxmdW5jdGlvbigpe018fHMoKSxxLnByb3BzLmFyaWEmJnEucmVmZXJlbmNlLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS0nK3EucHJvcHMuYXJpYSkscS5wb3BwZXJJbnN0YW5jZS5kaXNhYmxlRXZlbnRMaXN0ZW5lcnMoKSxxLnByb3BzLmFwcGVuZFRvLnJlbW92ZUNoaWxkKHEucG9wcGVyKSxxLnN0YXRlLmlzTW91bnRlZD0hMSxxLnByb3BzLm9uSGlkZGVuKHEpfSkpfWZ1bmN0aW9uIFAoZSl7cS5zdGF0ZS5pc0Rlc3Ryb3llZHx8KHEuc3RhdGUuaXNNb3VudGVkJiZZKDApLE8oKSxxLnJlZmVyZW5jZS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsciksZGVsZXRlIHEucmVmZXJlbmNlLl90aXBweSxxLnByb3BzLnRhcmdldCYmZSYmUShxLnJlZmVyZW5jZS5xdWVyeVNlbGVjdG9yQWxsKHEucHJvcHMudGFyZ2V0KSkuZm9yRWFjaChmdW5jdGlvbihlKXtyZXR1cm4gZS5fdGlwcHkmJmUuX3RpcHB5LmRlc3Ryb3koKX0pLHEucG9wcGVySW5zdGFuY2UmJnEucG9wcGVySW5zdGFuY2UuZGVzdHJveSgpLFgmJlguZGlzY29ubmVjdCgpLHEuc3RhdGUuaXNEZXN0cm95ZWQ9ITApfXZhciBEPVJlKGUsdCk7aWYoIUQubXVsdGlwbGUmJmUuX3RpcHB5KXJldHVybiBudWxsO3ZhciBYPW51bGwsST17fSxOPW51bGwsSD0wLFc9MCxNPSExLEI9ZnVuY3Rpb24oKXt9LFI9W10sej0hMSxGPTA8RC5pbnRlcmFjdGl2ZURlYm91bmNlP1NlKGMsRC5pbnRlcmFjdGl2ZURlYm91bmNlKTpjLF89SHQrKyxVPWJlKF8sRCk7VS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJyxmdW5jdGlvbihlKXtxLnByb3BzLmludGVyYWN0aXZlJiZxLnN0YXRlLmlzVmlzaWJsZSYmJ21vdXNlZW50ZXInPT09SS50eXBlJiZpKGUpfSksVS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJyxmdW5jdGlvbihlKXtxLnByb3BzLmludGVyYWN0aXZlJiYnbW91c2VlbnRlcic9PT1JLnR5cGUmJjA9PT1xLnByb3BzLmludGVyYWN0aXZlRGVib3VuY2UmJnhlKG1lKFUpLFUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksZSxxLnByb3BzKSYmbigpfSk7dmFyIFY9YWUoVSkscT17aWQ6XyxyZWZlcmVuY2U6ZSxwb3BwZXI6VSxwb3BwZXJDaGlsZHJlbjpWLHBvcHBlckluc3RhbmNlOm51bGwscHJvcHM6RCxzdGF0ZTp7aXNFbmFibGVkOiEwLGlzVmlzaWJsZTohMSxpc0Rlc3Ryb3llZDohMSxpc01vdW50ZWQ6ITEsaXNTaG93bjohMX0sY2xlYXJEZWxheVRpbWVvdXRzOlQsc2V0OlMsc2V0Q29udGVudDpmdW5jdGlvbihlKXtTKHtjb250ZW50OmV9KX0sc2hvdzpBLGhpZGU6WSxlbmFibGU6ZnVuY3Rpb24oKXtxLnN0YXRlLmlzRW5hYmxlZD0hMH0sZGlzYWJsZTpmdW5jdGlvbigpe3Euc3RhdGUuaXNFbmFibGVkPSExfSxkZXN0cm95OlB9O3JldHVybiBMKCksZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsciksRC5sYXp5fHwocS5wb3BwZXJJbnN0YW5jZT11KCkscS5wb3BwZXJJbnN0YW5jZS5kaXNhYmxlRXZlbnRMaXN0ZW5lcnMoKSksRC5zaG93T25Jbml0JiZpKCksIUQuYTExeXx8RC50YXJnZXR8fFdlKGUpfHxlLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCcwJyksZS5fdGlwcHk9cSxVLl90aXBweT1xLHF9ZnVuY3Rpb24gS2UoZSx0LHIpe3plKHQsc3QpLFd0fHwoSGUoKSxXdD0hMCk7dmFyIGE9SXQoe30sc3QsdCk7dmUoZSkmJkJlKGUpO3ZhciBwPUNlKGUpLG89cFswXSxpPShyJiZvP1tvXTpwKS5yZWR1Y2UoZnVuY3Rpb24oZSx0KXt2YXIgcj10JiZqZSh0LGEpO3JldHVybiByJiZlLnB1c2gociksZX0sW10pLG49e3RhcmdldHM6ZSxwcm9wczphLGluc3RhbmNlczppLGRlc3Ryb3lBbGw6ZnVuY3Rpb24oKXtuLmluc3RhbmNlcy5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UuZGVzdHJveSgpfSksbi5pbnN0YW5jZXM9W119fTtyZXR1cm4gbn1mb3IodmFyIEdlPU1hdGgubWluLEplPU1hdGguZmxvb3IsUWU9TWF0aC5yb3VuZCxaZT1NYXRoLm1heCwkZT0nLnRpcHB5LWlPU3tjdXJzb3I6cG9pbnRlciFpbXBvcnRhbnR9LnRpcHB5LW5vdHJhbnNpdGlvbnt0cmFuc2l0aW9uOm5vbmUhaW1wb3J0YW50fS50aXBweS1wb3BwZXJ7LXdlYmtpdC1wZXJzcGVjdGl2ZTo3MDBweDtwZXJzcGVjdGl2ZTo3MDBweDt6LWluZGV4Ojk5OTk7b3V0bGluZTowO3RyYW5zaXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllciguMTY1LC44NCwuNDQsMSk7cG9pbnRlci1ldmVudHM6bm9uZTtsaW5lLWhlaWdodDoxLjQ7bWF4LXdpZHRoOmNhbGMoMTAwJSAtIDEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gLnRpcHB5LWJhY2tkcm9we2JvcmRlci1yYWRpdXM6NDAlIDQwJSAwIDB9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSAudGlwcHktcm91bmRhcnJvd3tib3R0b206LThweDstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46NTAlIDA7dHJhbnNmb3JtLW9yaWdpbjo1MCUgMH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIC50aXBweS1yb3VuZGFycm93IHN2Z3twb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDE4MGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgxODBkZWcpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gLnRpcHB5LWFycm93e2JvcmRlci10b3A6OHB4IHNvbGlkICMzMzM7Ym9yZGVyLXJpZ2h0OjhweCBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItbGVmdDo4cHggc29saWQgdHJhbnNwYXJlbnQ7Ym90dG9tOi03cHg7bWFyZ2luOjAgNnB4Oy13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjo1MCUgMDt0cmFuc2Zvcm0tb3JpZ2luOjUwJSAwfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gLnRpcHB5LWJhY2tkcm9wey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjowIDI1JTt0cmFuc2Zvcm0tb3JpZ2luOjAgMjUlfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gLnRpcHB5LWJhY2tkcm9wW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMSkgdHJhbnNsYXRlKC01MCUsLTU1JSk7dHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgtNTAlLC01NSUpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gLnRpcHB5LWJhY2tkcm9wW2RhdGEtc3RhdGU9aGlkZGVuXXstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSguMikgdHJhbnNsYXRlKC01MCUsLTQ1JSk7dHJhbnNmb3JtOnNjYWxlKC4yKSB0cmFuc2xhdGUoLTUwJSwtNDUlKTtvcGFjaXR5OjB9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSBbZGF0YS1hbmltYXRpb249c2hpZnQtdG93YXJkXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1zaGlmdC10b3dhcmRdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgtMjBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTIwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPXBlcnNwZWN0aXZlXXstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46Ym90dG9tO3RyYW5zZm9ybS1vcmlnaW46Ym90dG9tfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPXBlcnNwZWN0aXZlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpIHJvdGF0ZVgoMCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpIHJvdGF0ZVgoMCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgwKSByb3RhdGVYKDYwZGVnKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgwKSByb3RhdGVYKDYwZGVnKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1mYWRlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1mYWRlXVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1zaGlmdC1hd2F5XVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj10b3BdIFtkYXRhLWFuaW1hdGlvbj1zaGlmdC1hd2F5XVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49dG9wXSBbZGF0YS1hbmltYXRpb249c2NhbGVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTBweCkgc2NhbGUoMSk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTEwcHgpIHNjYWxlKDEpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXRvcF0gW2RhdGEtYW5pbWF0aW9uPXNjYWxlXVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCkgc2NhbGUoLjUpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApIHNjYWxlKC41KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIC50aXBweS1iYWNrZHJvcHtib3JkZXItcmFkaXVzOjAgMCAzMCUgMzAlfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWJvdHRvbV0gLnRpcHB5LXJvdW5kYXJyb3d7dG9wOi04cHg7LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOjUwJSAxMDAlO3RyYW5zZm9ybS1vcmlnaW46NTAlIDEwMCV9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktcm91bmRhcnJvdyBzdmd7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowOy13ZWJraXQtdHJhbnNmb3JtOnJvdGF0ZSgwKTt0cmFuc2Zvcm06cm90YXRlKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWJvdHRvbV0gLnRpcHB5LWFycm93e2JvcmRlci1ib3R0b206OHB4IHNvbGlkICMzMzM7Ym9yZGVyLXJpZ2h0OjhweCBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItbGVmdDo4cHggc29saWQgdHJhbnNwYXJlbnQ7dG9wOi03cHg7bWFyZ2luOjAgNnB4Oy13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjo1MCUgMTAwJTt0cmFuc2Zvcm0tb3JpZ2luOjUwJSAxMDAlfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWJvdHRvbV0gLnRpcHB5LWJhY2tkcm9wey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjowIC01MCU7dHJhbnNmb3JtLW9yaWdpbjowIC01MCV9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYmFja2Ryb3BbZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNDUlKTt0cmFuc2Zvcm06c2NhbGUoMSkgdHJhbnNsYXRlKC01MCUsLTQ1JSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSAudGlwcHktYmFja2Ryb3BbZGF0YS1zdGF0ZT1oaWRkZW5dey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKC4yKSB0cmFuc2xhdGUoLTUwJSk7dHJhbnNmb3JtOnNjYWxlKC4yKSB0cmFuc2xhdGUoLTUwJSk7b3BhY2l0eTowfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWJvdHRvbV0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LXRvd2FyZF1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKDEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWJvdHRvbV0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LXRvd2FyZF1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKDIwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDIwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWJvdHRvbV0gW2RhdGEtYW5pbWF0aW9uPXBlcnNwZWN0aXZlXXstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46dG9wO3RyYW5zZm9ybS1vcmlnaW46dG9wfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWJvdHRvbV0gW2RhdGEtYW5pbWF0aW9uPXBlcnNwZWN0aXZlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCkgcm90YXRlWCgwKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KSByb3RhdGVYKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWJvdHRvbV0gW2RhdGEtYW5pbWF0aW9uPXBlcnNwZWN0aXZlXVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCkgcm90YXRlWCgtNjBkZWcpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApIHJvdGF0ZVgoLTYwZGVnKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIFtkYXRhLWFuaW1hdGlvbj1mYWRlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249ZmFkZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKDEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWJvdHRvbV0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LWF3YXldW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIFtkYXRhLWFuaW1hdGlvbj1zaGlmdC1hd2F5XVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49Ym90dG9tXSBbZGF0YS1hbmltYXRpb249c2NhbGVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KSBzY2FsZSgxKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KSBzY2FsZSgxKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1ib3R0b21dIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVZKDApIHNjYWxlKC41KTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgwKSBzY2FsZSguNSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LWJhY2tkcm9we2JvcmRlci1yYWRpdXM6NTAlIDAgMCA1MCV9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LXJvdW5kYXJyb3d7cmlnaHQ6LTE2cHg7LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOjMzLjMzMzMzMzMzJSA1MCU7dHJhbnNmb3JtLW9yaWdpbjozMy4zMzMzMzMzMyUgNTAlfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIC50aXBweS1yb3VuZGFycm93IHN2Z3twb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDkwZGVnKTt0cmFuc2Zvcm06cm90YXRlKDkwZGVnKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYXJyb3d7Ym9yZGVyLWxlZnQ6OHB4IHNvbGlkICMzMzM7Ym9yZGVyLXRvcDo4cHggc29saWQgdHJhbnNwYXJlbnQ7Ym9yZGVyLWJvdHRvbTo4cHggc29saWQgdHJhbnNwYXJlbnQ7cmlnaHQ6LTdweDttYXJnaW46M3B4IDA7LXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOjAgNTAlO3RyYW5zZm9ybS1vcmlnaW46MCA1MCV9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gLnRpcHB5LWJhY2tkcm9wey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjo1MCUgMDt0cmFuc2Zvcm0tb3JpZ2luOjUwJSAwfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgtNTAlLC01MCUpO3RyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNTAlKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSAudGlwcHktYmFja2Ryb3BbZGF0YS1zdGF0ZT1oaWRkZW5dey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKC4yKSB0cmFuc2xhdGUoLTc1JSwtNTAlKTt0cmFuc2Zvcm06c2NhbGUoLjIpIHRyYW5zbGF0ZSgtNzUlLC01MCUpO29wYWNpdHk6MH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249c2hpZnQtdG93YXJkXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249c2hpZnQtdG93YXJkXVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTIwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0yMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjpyaWdodDt0cmFuc2Zvcm0tb3JpZ2luOnJpZ2h0fS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KSByb3RhdGVZKDApO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KSByb3RhdGVZKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIFtkYXRhLWFuaW1hdGlvbj1wZXJzcGVjdGl2ZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDApIHJvdGF0ZVkoLTYwZGVnKTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgwKSByb3RhdGVZKC02MGRlZyl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPWZhZGVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTBweCk7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIFtkYXRhLWFuaW1hdGlvbj1mYWRlXVtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249c2hpZnQtYXdheV1bZGF0YS1zdGF0ZT12aXNpYmxlXXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKC0xMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTBweCl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49bGVmdF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LWF3YXldW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgwKTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgwKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1sZWZ0XSBbZGF0YS1hbmltYXRpb249c2NhbGVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgtMTBweCkgc2NhbGUoMSk7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwcHgpIHNjYWxlKDEpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePWxlZnRdIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDApIHNjYWxlKC41KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgwKSBzY2FsZSguNSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1iYWNrZHJvcHtib3JkZXItcmFkaXVzOjAgNTAlIDUwJSAwfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSAudGlwcHktcm91bmRhcnJvd3tsZWZ0Oi0xNnB4Oy13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjo2Ni42NjY2NjY2NiUgNTAlO3RyYW5zZm9ybS1vcmlnaW46NjYuNjY2NjY2NjYlIDUwJX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gLnRpcHB5LXJvdW5kYXJyb3cgc3Zne3Bvc2l0aW9uOmFic29sdXRlO2xlZnQ6MDstd2Via2l0LXRyYW5zZm9ybTpyb3RhdGUoLTkwZGVnKTt0cmFuc2Zvcm06cm90YXRlKC05MGRlZyl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1hcnJvd3tib3JkZXItcmlnaHQ6OHB4IHNvbGlkICMzMzM7Ym9yZGVyLXRvcDo4cHggc29saWQgdHJhbnNwYXJlbnQ7Ym9yZGVyLWJvdHRvbTo4cHggc29saWQgdHJhbnNwYXJlbnQ7bGVmdDotN3B4O21hcmdpbjozcHggMDstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46MTAwJSA1MCU7dHJhbnNmb3JtLW9yaWdpbjoxMDAlIDUwJX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gLnRpcHB5LWJhY2tkcm9wey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjotNTAlIDA7dHJhbnNmb3JtLW9yaWdpbjotNTAlIDB9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIC50aXBweS1iYWNrZHJvcFtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEpIHRyYW5zbGF0ZSgtNTAlLC01MCUpO3RyYW5zZm9ybTpzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNTAlKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gLnRpcHB5LWJhY2tkcm9wW2RhdGEtc3RhdGU9aGlkZGVuXXstd2Via2l0LXRyYW5zZm9ybTpzY2FsZSguMikgdHJhbnNsYXRlKC0yNSUsLTUwJSk7dHJhbnNmb3JtOnNjYWxlKC4yKSB0cmFuc2xhdGUoLTI1JSwtNTAlKTtvcGFjaXR5OjB9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIFtkYXRhLWFuaW1hdGlvbj1zaGlmdC10b3dhcmRdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LXRvd2FyZF1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDIwcHgpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKDIwcHgpfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdey13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjpsZWZ0O3RyYW5zZm9ybS1vcmlnaW46bGVmdH0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gW2RhdGEtYW5pbWF0aW9uPXBlcnNwZWN0aXZlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTBweCkgcm90YXRlWSgwKTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KSByb3RhdGVZKDApfS50aXBweS1wb3BwZXJbeC1wbGFjZW1lbnRePXJpZ2h0XSBbZGF0YS1hbmltYXRpb249cGVyc3BlY3RpdmVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgwKSByb3RhdGVZKDYwZGVnKTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgwKSByb3RhdGVZKDYwZGVnKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gW2RhdGEtYW5pbWF0aW9uPWZhZGVdW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gW2RhdGEtYW5pbWF0aW9uPWZhZGVdW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LWF3YXldW2RhdGEtc3RhdGU9dmlzaWJsZV17LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gW2RhdGEtYW5pbWF0aW9uPXNoaWZ0LWF3YXldW2RhdGEtc3RhdGU9aGlkZGVuXXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgwKTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgwKX0udGlwcHktcG9wcGVyW3gtcGxhY2VtZW50Xj1yaWdodF0gW2RhdGEtYW5pbWF0aW9uPXNjYWxlXVtkYXRhLXN0YXRlPXZpc2libGVdey13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTBweCkgc2NhbGUoMSk7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoMTBweCkgc2NhbGUoMSl9LnRpcHB5LXBvcHBlclt4LXBsYWNlbWVudF49cmlnaHRdIFtkYXRhLWFuaW1hdGlvbj1zY2FsZV1bZGF0YS1zdGF0ZT1oaWRkZW5de29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDApIHNjYWxlKC41KTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgwKSBzY2FsZSguNSl9LnRpcHB5LXRvb2x0aXB7cG9zaXRpb246cmVsYXRpdmU7Y29sb3I6I2ZmZjtib3JkZXItcmFkaXVzOjRweDtmb250LXNpemU6LjlyZW07cGFkZGluZzouM3JlbSAuNnJlbTttYXgtd2lkdGg6MzUwcHg7dGV4dC1hbGlnbjpjZW50ZXI7d2lsbC1jaGFuZ2U6dHJhbnNmb3JtOy13ZWJraXQtZm9udC1zbW9vdGhpbmc6YW50aWFsaWFzZWQ7LW1vei1vc3gtZm9udC1zbW9vdGhpbmc6Z3JheXNjYWxlO2JhY2tncm91bmQtY29sb3I6IzMzM30udGlwcHktdG9vbHRpcFtkYXRhLXNpemU9c21hbGxde3BhZGRpbmc6LjJyZW0gLjRyZW07Zm9udC1zaXplOi43NXJlbX0udGlwcHktdG9vbHRpcFtkYXRhLXNpemU9bGFyZ2Vde3BhZGRpbmc6LjRyZW0gLjhyZW07Zm9udC1zaXplOjFyZW19LnRpcHB5LXRvb2x0aXBbZGF0YS1hbmltYXRlZmlsbF17b3ZlcmZsb3c6aGlkZGVuO2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnR9LnRpcHB5LXRvb2x0aXBbZGF0YS1pbnRlcmFjdGl2ZV0sLnRpcHB5LXRvb2x0aXBbZGF0YS1pbnRlcmFjdGl2ZV0gcGF0aHtwb2ludGVyLWV2ZW50czphdXRvfS50aXBweS10b29sdGlwW2RhdGEtaW5lcnRpYV1bZGF0YS1zdGF0ZT12aXNpYmxlXXt0cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjU0LDEuNSwuMzgsMS4xMSl9LnRpcHB5LXRvb2x0aXBbZGF0YS1pbmVydGlhXVtkYXRhLXN0YXRlPWhpZGRlbl17dHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb246ZWFzZX0udGlwcHktYXJyb3csLnRpcHB5LXJvdW5kYXJyb3d7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MDtoZWlnaHQ6MH0udGlwcHktcm91bmRhcnJvd3t3aWR0aDoyNHB4O2hlaWdodDo4cHg7ZmlsbDojMzMzO3BvaW50ZXItZXZlbnRzOm5vbmV9LnRpcHB5LWJhY2tkcm9we3Bvc2l0aW9uOmFic29sdXRlO3dpbGwtY2hhbmdlOnRyYW5zZm9ybTtiYWNrZ3JvdW5kLWNvbG9yOiMzMzM7Ym9yZGVyLXJhZGl1czo1MCU7d2lkdGg6Y2FsYygxMTAlICsgMnJlbSk7bGVmdDo1MCU7dG9wOjUwJTt6LWluZGV4Oi0xO3RyYW5zaXRpb246YWxsIGN1YmljLWJlemllciguNDYsLjEsLjUyLC45OCk7LXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OmhpZGRlbjtiYWNrZmFjZS12aXNpYmlsaXR5OmhpZGRlbn0udGlwcHktYmFja2Ryb3A6YWZ0ZXJ7Y29udGVudDpcIlwiO2Zsb2F0OmxlZnQ7cGFkZGluZy10b3A6MTAwJX0udGlwcHktYmFja2Ryb3ArLnRpcHB5LWNvbnRlbnR7dHJhbnNpdGlvbi1wcm9wZXJ0eTpvcGFjaXR5O3dpbGwtY2hhbmdlOm9wYWNpdHl9LnRpcHB5LWJhY2tkcm9wKy50aXBweS1jb250ZW50W2RhdGEtc3RhdGU9dmlzaWJsZV17b3BhY2l0eToxfS50aXBweS1iYWNrZHJvcCsudGlwcHktY29udGVudFtkYXRhLXN0YXRlPWhpZGRlbl17b3BhY2l0eTowfScsZXQ9JzMuNC4xJyx0dD0ndW5kZWZpbmVkJyE9dHlwZW9mIHdpbmRvdyxydD10dD9uYXZpZ2F0b3I6e30sYXQ9dHQ/d2luZG93Ont9LHB0PSgnTXV0YXRpb25PYnNlcnZlcidpbiBhdCksb3Q9L01TSUUgfFRyaWRlbnRcXC8vLnRlc3QocnQudXNlckFnZW50KSxpdD0vaVBob25lfGlQYWR8aVBvZC8udGVzdChydC5wbGF0Zm9ybSkmJiFhdC5NU1N0cmVhbSxudD0oJ29udG91Y2hzdGFydCdpbiBhdCksc3Q9e2ExMXk6ITAsYWxsb3dIVE1MOiEwLGFuaW1hdGVGaWxsOiEwLGFuaW1hdGlvbjonc2hpZnQtYXdheScsYXBwZW5kVG86ZnVuY3Rpb24oKXtyZXR1cm4gZG9jdW1lbnQuYm9keX0sYXJpYTonZGVzY3JpYmVkYnknLGFycm93OiExLGFycm93VHJhbnNmb3JtOicnLGFycm93VHlwZTonc2hhcnAnLGF1dG9Gb2N1czohMCxib3VuZGFyeTonc2Nyb2xsUGFyZW50Jyxjb250ZW50OicnLGRlbGF5OlswLDIwXSxkaXN0YW5jZToxMCxkdXJhdGlvbjpbMzI1LDI3NV0sZmxpcDohMCxmbGlwQmVoYXZpb3I6J2ZsaXAnLGZvbGxvd0N1cnNvcjohMSxoaWRlT25DbGljazohMCxpbmVydGlhOiExLGludGVyYWN0aXZlOiExLGludGVyYWN0aXZlQm9yZGVyOjIsaW50ZXJhY3RpdmVEZWJvdW5jZTowLGxhenk6ITAsbGl2ZVBsYWNlbWVudDohMCxtYXhXaWR0aDonJyxtdWx0aXBsZTohMSxvZmZzZXQ6MCxvbkhpZGRlbjpmdW5jdGlvbigpe30sb25IaWRlOmZ1bmN0aW9uKCl7fSxvbk1vdW50OmZ1bmN0aW9uKCl7fSxvblNob3c6ZnVuY3Rpb24oKXt9LG9uU2hvd246ZnVuY3Rpb24oKXt9LHBlcmZvcm1hbmNlOiExLHBsYWNlbWVudDondG9wJyxwb3BwZXJPcHRpb25zOnt9LHNob3VsZFBvcHBlckhpZGVPbkJsdXI6ZnVuY3Rpb24oKXtyZXR1cm4hMH0sc2hvd09uSW5pdDohMSxzaXplOidyZWd1bGFyJyxzdGlja3k6ITEsdGFyZ2V0OicnLHRoZW1lOidkYXJrJyx0b3VjaDohMCx0b3VjaEhvbGQ6ITEsdHJpZ2dlcjonbW91c2VlbnRlciBmb2N1cycsdXBkYXRlRHVyYXRpb246MjAwLHdhaXQ6bnVsbCx6SW5kZXg6OTk5OX0sbHQ9WydhcnJvdycsJ2Fycm93VHlwZScsJ2Rpc3RhbmNlJywnZmxpcCcsJ2ZsaXBCZWhhdmlvcicsJ29mZnNldCcsJ3BsYWNlbWVudCcsJ3BvcHBlck9wdGlvbnMnXSxkdD0ndW5kZWZpbmVkJyE9dHlwZW9mIHdpbmRvdyYmJ3VuZGVmaW5lZCchPXR5cGVvZiBkb2N1bWVudCxjdD1bJ0VkZ2UnLCdUcmlkZW50JywnRmlyZWZveCddLG10PTAsZnQ9MDtmdDxjdC5sZW5ndGg7ZnQrPTEpaWYoZHQmJjA8PW5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihjdFtmdF0pKXttdD0xO2JyZWFrfXZhciBpPWR0JiZ3aW5kb3cuUHJvbWlzZSxodD1pP2Z1bmN0aW9uKGUpe3ZhciB0PSExO3JldHVybiBmdW5jdGlvbigpe3R8fCh0PSEwLHdpbmRvdy5Qcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCl7dD0hMSxlKCl9KSl9fTpmdW5jdGlvbihlKXt2YXIgdD0hMTtyZXR1cm4gZnVuY3Rpb24oKXt0fHwodD0hMCxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dD0hMSxlKCl9LG10KSl9fSxidD1kdCYmISEod2luZG93Lk1TSW5wdXRNZXRob2RDb250ZXh0JiZkb2N1bWVudC5kb2N1bWVudE1vZGUpLHl0PWR0JiYvTVNJRSAxMC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSx1dD1mdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpfSxndD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIHIsYT0wO2E8dC5sZW5ndGg7YSsrKXI9dFthXSxyLmVudW1lcmFibGU9ci5lbnVtZXJhYmxlfHwhMSxyLmNvbmZpZ3VyYWJsZT0hMCwndmFsdWUnaW4gciYmKHIud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHIua2V5LHIpfXJldHVybiBmdW5jdGlvbih0LHIsYSl7cmV0dXJuIHImJmUodC5wcm90b3R5cGUsciksYSYmZSh0LGEpLHR9fSgpLHh0PWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gdCBpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOnIsZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPXIsZX0sd3Q9T2JqZWN0LmFzc2lnbnx8ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LHI9MTtyPGFyZ3VtZW50cy5sZW5ndGg7cisrKWZvcih2YXIgYSBpbiB0PWFyZ3VtZW50c1tyXSx0KU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LGEpJiYoZVthXT10W2FdKTtyZXR1cm4gZX0sdnQ9ZHQmJi9GaXJlZm94L2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSxrdD1bJ2F1dG8tc3RhcnQnLCdhdXRvJywnYXV0by1lbmQnLCd0b3Atc3RhcnQnLCd0b3AnLCd0b3AtZW5kJywncmlnaHQtc3RhcnQnLCdyaWdodCcsJ3JpZ2h0LWVuZCcsJ2JvdHRvbS1lbmQnLCdib3R0b20nLCdib3R0b20tc3RhcnQnLCdsZWZ0LWVuZCcsJ2xlZnQnLCdsZWZ0LXN0YXJ0J10sRXQ9a3Quc2xpY2UoMyksQ3Q9e0ZMSVA6J2ZsaXAnLENMT0NLV0lTRTonY2xvY2t3aXNlJyxDT1VOVEVSQ0xPQ0tXSVNFOidjb3VudGVyY2xvY2t3aXNlJ30sTHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHIsYSl7dmFyIHA9dGhpcyxvPTI8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXTp7fTt1dCh0aGlzLHQpLHRoaXMuc2NoZWR1bGVVcGRhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHAudXBkYXRlKX0sdGhpcy51cGRhdGU9aHQodGhpcy51cGRhdGUuYmluZCh0aGlzKSksdGhpcy5vcHRpb25zPXd0KHt9LHQuRGVmYXVsdHMsbyksdGhpcy5zdGF0ZT17aXNEZXN0cm95ZWQ6ITEsaXNDcmVhdGVkOiExLHNjcm9sbFBhcmVudHM6W119LHRoaXMucmVmZXJlbmNlPXImJnIuanF1ZXJ5P3JbMF06cix0aGlzLnBvcHBlcj1hJiZhLmpxdWVyeT9hWzBdOmEsdGhpcy5vcHRpb25zLm1vZGlmaWVycz17fSxPYmplY3Qua2V5cyh3dCh7fSx0LkRlZmF1bHRzLm1vZGlmaWVycyxvLm1vZGlmaWVycykpLmZvckVhY2goZnVuY3Rpb24oZSl7cC5vcHRpb25zLm1vZGlmaWVyc1tlXT13dCh7fSx0LkRlZmF1bHRzLm1vZGlmaWVyc1tlXXx8e30sby5tb2RpZmllcnM/by5tb2RpZmllcnNbZV06e30pfSksdGhpcy5tb2RpZmllcnM9T2JqZWN0LmtleXModGhpcy5vcHRpb25zLm1vZGlmaWVycykubWFwKGZ1bmN0aW9uKGUpe3JldHVybiB3dCh7bmFtZTplfSxwLm9wdGlvbnMubW9kaWZpZXJzW2VdKX0pLnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5vcmRlci10Lm9yZGVyfSksdGhpcy5tb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbih0KXt0LmVuYWJsZWQmJmUodC5vbkxvYWQpJiZ0Lm9uTG9hZChwLnJlZmVyZW5jZSxwLnBvcHBlcixwLm9wdGlvbnMsdCxwLnN0YXRlKX0pLHRoaXMudXBkYXRlKCk7dmFyIGk9dGhpcy5vcHRpb25zLmV2ZW50c0VuYWJsZWQ7aSYmdGhpcy5lbmFibGVFdmVudExpc3RlbmVycygpLHRoaXMuc3RhdGUuZXZlbnRzRW5hYmxlZD1pfXJldHVybiBndCh0LFt7a2V5Oid1cGRhdGUnLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIFAuY2FsbCh0aGlzKX19LHtrZXk6J2Rlc3Ryb3knLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIEkuY2FsbCh0aGlzKX19LHtrZXk6J2VuYWJsZUV2ZW50TGlzdGVuZXJzJyx2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBNLmNhbGwodGhpcyl9fSx7a2V5OidkaXNhYmxlRXZlbnRMaXN0ZW5lcnMnLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIFIuY2FsbCh0aGlzKX19XSksdH0oKTtMdC5VdGlscz0oJ3VuZGVmaW5lZCc9PXR5cGVvZiB3aW5kb3c/Z2xvYmFsOndpbmRvdykuUG9wcGVyVXRpbHMsTHQucGxhY2VtZW50cz1rdCxMdC5EZWZhdWx0cz17cGxhY2VtZW50Oidib3R0b20nLHBvc2l0aW9uRml4ZWQ6ITEsZXZlbnRzRW5hYmxlZDohMCxyZW1vdmVPbkRlc3Ryb3k6ITEsb25DcmVhdGU6ZnVuY3Rpb24oKXt9LG9uVXBkYXRlOmZ1bmN0aW9uKCl7fSxtb2RpZmllcnM6e3NoaWZ0OntvcmRlcjoxMDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbihlKXt2YXIgdD1lLnBsYWNlbWVudCxyPXQuc3BsaXQoJy0nKVswXSxhPXQuc3BsaXQoJy0nKVsxXTtpZihhKXt2YXIgcD1lLm9mZnNldHMsbz1wLnJlZmVyZW5jZSxpPXAucG9wcGVyLG49LTEhPT1bJ2JvdHRvbScsJ3RvcCddLmluZGV4T2Yocikscz1uPydsZWZ0JzondG9wJyxsPW4/J3dpZHRoJzonaGVpZ2h0JyxkPXtzdGFydDp4dCh7fSxzLG9bc10pLGVuZDp4dCh7fSxzLG9bc10rb1tsXS1pW2xdKX07ZS5vZmZzZXRzLnBvcHBlcj13dCh7fSxpLGRbYV0pfXJldHVybiBlfX0sb2Zmc2V0OntvcmRlcjoyMDAsZW5hYmxlZDohMCxmbjpKLG9mZnNldDowfSxwcmV2ZW50T3ZlcmZsb3c6e29yZGVyOjMwMCxlbmFibGVkOiEwLGZuOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dC5ib3VuZGFyaWVzRWxlbWVudHx8byhlLmluc3RhbmNlLnBvcHBlcik7ZS5pbnN0YW5jZS5yZWZlcmVuY2U9PT1yJiYocj1vKHIpKTt2YXIgYT1YKCd0cmFuc2Zvcm0nKSxwPWUuaW5zdGFuY2UucG9wcGVyLnN0eWxlLGk9cC50b3Asbj1wLmxlZnQscz1wW2FdO3AudG9wPScnLHAubGVmdD0nJyxwW2FdPScnO3ZhciBsPXYoZS5pbnN0YW5jZS5wb3BwZXIsZS5pbnN0YW5jZS5yZWZlcmVuY2UsdC5wYWRkaW5nLHIsZS5wb3NpdGlvbkZpeGVkKTtwLnRvcD1pLHAubGVmdD1uLHBbYV09cyx0LmJvdW5kYXJpZXM9bDt2YXIgZD10LnByaW9yaXR5LGM9ZS5vZmZzZXRzLnBvcHBlcixtPXtwcmltYXJ5OmZ1bmN0aW9uKGUpe3ZhciByPWNbZV07cmV0dXJuIGNbZV08bFtlXSYmIXQuZXNjYXBlV2l0aFJlZmVyZW5jZSYmKHI9WmUoY1tlXSxsW2VdKSkseHQoe30sZSxyKX0sc2Vjb25kYXJ5OmZ1bmN0aW9uKGUpe3ZhciByPSdyaWdodCc9PT1lPydsZWZ0JzondG9wJyxhPWNbcl07cmV0dXJuIGNbZV0+bFtlXSYmIXQuZXNjYXBlV2l0aFJlZmVyZW5jZSYmKGE9R2UoY1tyXSxsW2VdLSgncmlnaHQnPT09ZT9jLndpZHRoOmMuaGVpZ2h0KSkpLHh0KHt9LHIsYSl9fTtyZXR1cm4gZC5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciB0PS0xPT09WydsZWZ0JywndG9wJ10uaW5kZXhPZihlKT8nc2Vjb25kYXJ5JzoncHJpbWFyeSc7Yz13dCh7fSxjLG1bdF0oZSkpfSksZS5vZmZzZXRzLnBvcHBlcj1jLGV9LHByaW9yaXR5OlsnbGVmdCcsJ3JpZ2h0JywndG9wJywnYm90dG9tJ10scGFkZGluZzo1LGJvdW5kYXJpZXNFbGVtZW50OidzY3JvbGxQYXJlbnQnfSxrZWVwVG9nZXRoZXI6e29yZGVyOjQwMCxlbmFibGVkOiEwLGZuOmZ1bmN0aW9uKGUpe3ZhciB0PWUub2Zmc2V0cyxyPXQucG9wcGVyLGE9dC5yZWZlcmVuY2UscD1lLnBsYWNlbWVudC5zcGxpdCgnLScpWzBdLG89SmUsaT0tMSE9PVsndG9wJywnYm90dG9tJ10uaW5kZXhPZihwKSxuPWk/J3JpZ2h0JzonYm90dG9tJyxzPWk/J2xlZnQnOid0b3AnLGw9aT8nd2lkdGgnOidoZWlnaHQnO3JldHVybiByW25dPG8oYVtzXSkmJihlLm9mZnNldHMucG9wcGVyW3NdPW8oYVtzXSktcltsXSkscltzXT5vKGFbbl0pJiYoZS5vZmZzZXRzLnBvcHBlcltzXT1vKGFbbl0pKSxlfX0sYXJyb3c6e29yZGVyOjUwMCxlbmFibGVkOiEwLGZuOmZ1bmN0aW9uKGUscil7dmFyIGE7aWYoIVYoZS5pbnN0YW5jZS5tb2RpZmllcnMsJ2Fycm93Jywna2VlcFRvZ2V0aGVyJykpcmV0dXJuIGU7dmFyIHA9ci5lbGVtZW50O2lmKCdzdHJpbmcnPT10eXBlb2YgcCl7aWYocD1lLmluc3RhbmNlLnBvcHBlci5xdWVyeVNlbGVjdG9yKHApLCFwKXJldHVybiBlO31lbHNlIGlmKCFlLmluc3RhbmNlLnBvcHBlci5jb250YWlucyhwKSlyZXR1cm4gY29uc29sZS53YXJuKCdXQVJOSU5HOiBgYXJyb3cuZWxlbWVudGAgbXVzdCBiZSBjaGlsZCBvZiBpdHMgcG9wcGVyIGVsZW1lbnQhJyksZTt2YXIgbz1lLnBsYWNlbWVudC5zcGxpdCgnLScpWzBdLGk9ZS5vZmZzZXRzLG49aS5wb3BwZXIscz1pLnJlZmVyZW5jZSxsPS0xIT09WydsZWZ0JywncmlnaHQnXS5pbmRleE9mKG8pLGQ9bD8naGVpZ2h0Jzond2lkdGgnLGM9bD8nVG9wJzonTGVmdCcsbT1jLnRvTG93ZXJDYXNlKCksZj1sPydsZWZ0JzondG9wJyxoPWw/J2JvdHRvbSc6J3JpZ2h0Jyx5PUwocClbZF07c1toXS15PG5bbV0mJihlLm9mZnNldHMucG9wcGVyW21dLT1uW21dLShzW2hdLXkpKSxzW21dK3k+bltoXSYmKGUub2Zmc2V0cy5wb3BwZXJbbV0rPXNbbV0reS1uW2hdKSxlLm9mZnNldHMucG9wcGVyPWIoZS5vZmZzZXRzLnBvcHBlcik7dmFyIHU9c1ttXStzW2RdLzIteS8yLGc9dChlLmluc3RhbmNlLnBvcHBlcikseD1wYXJzZUZsb2F0KGdbJ21hcmdpbicrY10sMTApLHc9cGFyc2VGbG9hdChnWydib3JkZXInK2MrJ1dpZHRoJ10sMTApLHY9dS1lLm9mZnNldHMucG9wcGVyW21dLXgtdztyZXR1cm4gdj1aZShHZShuW2RdLXksdiksMCksZS5hcnJvd0VsZW1lbnQ9cCxlLm9mZnNldHMuYXJyb3c9KGE9e30seHQoYSxtLFFlKHYpKSx4dChhLGYsJycpLGEpLGV9LGVsZW1lbnQ6J1t4LWFycm93XSd9LGZsaXA6e29yZGVyOjYwMCxlbmFibGVkOiEwLGZuOmZ1bmN0aW9uKGUsdCl7aWYoRChlLmluc3RhbmNlLm1vZGlmaWVycywnaW5uZXInKSlyZXR1cm4gZTtpZihlLmZsaXBwZWQmJmUucGxhY2VtZW50PT09ZS5vcmlnaW5hbFBsYWNlbWVudClyZXR1cm4gZTt2YXIgcj12KGUuaW5zdGFuY2UucG9wcGVyLGUuaW5zdGFuY2UucmVmZXJlbmNlLHQucGFkZGluZyx0LmJvdW5kYXJpZXNFbGVtZW50LGUucG9zaXRpb25GaXhlZCksYT1lLnBsYWNlbWVudC5zcGxpdCgnLScpWzBdLHA9TyhhKSxvPWUucGxhY2VtZW50LnNwbGl0KCctJylbMV18fCcnLGk9W107c3dpdGNoKHQuYmVoYXZpb3Ipe2Nhc2UgQ3QuRkxJUDppPVthLHBdO2JyZWFrO2Nhc2UgQ3QuQ0xPQ0tXSVNFOmk9aihhKTticmVhaztjYXNlIEN0LkNPVU5URVJDTE9DS1dJU0U6aT1qKGEsITApO2JyZWFrO2RlZmF1bHQ6aT10LmJlaGF2aW9yO31yZXR1cm4gaS5mb3JFYWNoKGZ1bmN0aW9uKG4scyl7aWYoYSE9PW58fGkubGVuZ3RoPT09cysxKXJldHVybiBlO2E9ZS5wbGFjZW1lbnQuc3BsaXQoJy0nKVswXSxwPU8oYSk7dmFyIGw9ZS5vZmZzZXRzLnBvcHBlcixkPWUub2Zmc2V0cy5yZWZlcmVuY2UsYz1KZSxtPSdsZWZ0Jz09PWEmJmMobC5yaWdodCk+YyhkLmxlZnQpfHwncmlnaHQnPT09YSYmYyhsLmxlZnQpPGMoZC5yaWdodCl8fCd0b3AnPT09YSYmYyhsLmJvdHRvbSk+YyhkLnRvcCl8fCdib3R0b20nPT09YSYmYyhsLnRvcCk8YyhkLmJvdHRvbSksZj1jKGwubGVmdCk8YyhyLmxlZnQpLGg9YyhsLnJpZ2h0KT5jKHIucmlnaHQpLGI9YyhsLnRvcCk8YyhyLnRvcCkseT1jKGwuYm90dG9tKT5jKHIuYm90dG9tKSx1PSdsZWZ0Jz09PWEmJmZ8fCdyaWdodCc9PT1hJiZofHwndG9wJz09PWEmJmJ8fCdib3R0b20nPT09YSYmeSxnPS0xIT09Wyd0b3AnLCdib3R0b20nXS5pbmRleE9mKGEpLHg9ISF0LmZsaXBWYXJpYXRpb25zJiYoZyYmJ3N0YXJ0Jz09PW8mJmZ8fGcmJidlbmQnPT09byYmaHx8IWcmJidzdGFydCc9PT1vJiZifHwhZyYmJ2VuZCc9PT1vJiZ5KTsobXx8dXx8eCkmJihlLmZsaXBwZWQ9ITAsKG18fHUpJiYoYT1pW3MrMV0pLHgmJihvPXEobykpLGUucGxhY2VtZW50PWErKG8/Jy0nK286JycpLGUub2Zmc2V0cy5wb3BwZXI9d3Qoe30sZS5vZmZzZXRzLnBvcHBlcixUKGUuaW5zdGFuY2UucG9wcGVyLGUub2Zmc2V0cy5yZWZlcmVuY2UsZS5wbGFjZW1lbnQpKSxlPVkoZS5pbnN0YW5jZS5tb2RpZmllcnMsZSwnZmxpcCcpKX0pLGV9LGJlaGF2aW9yOidmbGlwJyxwYWRkaW5nOjUsYm91bmRhcmllc0VsZW1lbnQ6J3ZpZXdwb3J0J30saW5uZXI6e29yZGVyOjcwMCxlbmFibGVkOiExLGZuOmZ1bmN0aW9uKGUpe3ZhciB0PWUucGxhY2VtZW50LHI9dC5zcGxpdCgnLScpWzBdLGE9ZS5vZmZzZXRzLHA9YS5wb3BwZXIsbz1hLnJlZmVyZW5jZSxpPS0xIT09WydsZWZ0JywncmlnaHQnXS5pbmRleE9mKHIpLG49LTE9PT1bJ3RvcCcsJ2xlZnQnXS5pbmRleE9mKHIpO3JldHVybiBwW2k/J2xlZnQnOid0b3AnXT1vW3JdLShuP3BbaT8nd2lkdGgnOidoZWlnaHQnXTowKSxlLnBsYWNlbWVudD1PKHQpLGUub2Zmc2V0cy5wb3BwZXI9YihwKSxlfX0saGlkZTp7b3JkZXI6ODAwLGVuYWJsZWQ6ITAsZm46ZnVuY3Rpb24oZSl7aWYoIVYoZS5pbnN0YW5jZS5tb2RpZmllcnMsJ2hpZGUnLCdwcmV2ZW50T3ZlcmZsb3cnKSlyZXR1cm4gZTt2YXIgdD1lLm9mZnNldHMucmVmZXJlbmNlLHI9UyhlLmluc3RhbmNlLm1vZGlmaWVycyxmdW5jdGlvbihlKXtyZXR1cm4ncHJldmVudE92ZXJmbG93Jz09PWUubmFtZX0pLmJvdW5kYXJpZXM7aWYodC5ib3R0b208ci50b3B8fHQubGVmdD5yLnJpZ2h0fHx0LnRvcD5yLmJvdHRvbXx8dC5yaWdodDxyLmxlZnQpe2lmKCEwPT09ZS5oaWRlKXJldHVybiBlO2UuaGlkZT0hMCxlLmF0dHJpYnV0ZXNbJ3gtb3V0LW9mLWJvdW5kYXJpZXMnXT0nJ31lbHNle2lmKCExPT09ZS5oaWRlKXJldHVybiBlO2UuaGlkZT0hMSxlLmF0dHJpYnV0ZXNbJ3gtb3V0LW9mLWJvdW5kYXJpZXMnXT0hMX1yZXR1cm4gZX19LGNvbXB1dGVTdHlsZTp7b3JkZXI6ODUwLGVuYWJsZWQ6ITAsZm46ZnVuY3Rpb24oZSx0KXt2YXIgcj10LngsYT10LnkscD1lLm9mZnNldHMucG9wcGVyLGk9UyhlLmluc3RhbmNlLm1vZGlmaWVycyxmdW5jdGlvbihlKXtyZXR1cm4nYXBwbHlTdHlsZSc9PT1lLm5hbWV9KS5ncHVBY2NlbGVyYXRpb247dm9pZCAwIT09aSYmY29uc29sZS53YXJuKCdXQVJOSU5HOiBgZ3B1QWNjZWxlcmF0aW9uYCBvcHRpb24gbW92ZWQgdG8gYGNvbXB1dGVTdHlsZWAgbW9kaWZpZXIgYW5kIHdpbGwgbm90IGJlIHN1cHBvcnRlZCBpbiBmdXR1cmUgdmVyc2lvbnMgb2YgUG9wcGVyLmpzIScpO3ZhciBuPXZvaWQgMD09PWk/dC5ncHVBY2NlbGVyYXRpb246aSxzPW8oZS5pbnN0YW5jZS5wb3BwZXIpLGw9dShzKSxkPXtwb3NpdGlvbjpwLnBvc2l0aW9ufSxjPVUoZSwyPndpbmRvdy5kZXZpY2VQaXhlbFJhdGlvfHwhdnQpLG09J2JvdHRvbSc9PT1yPyd0b3AnOidib3R0b20nLGY9J3JpZ2h0Jz09PWE/J2xlZnQnOidyaWdodCcsaD1YKCd0cmFuc2Zvcm0nKSxiPXZvaWQgMCx5PXZvaWQgMDtpZih5PSdib3R0b20nPT1tPydIVE1MJz09PXMubm9kZU5hbWU/LXMuY2xpZW50SGVpZ2h0K2MuYm90dG9tOi1sLmhlaWdodCtjLmJvdHRvbTpjLnRvcCxiPSdyaWdodCc9PWY/J0hUTUwnPT09cy5ub2RlTmFtZT8tcy5jbGllbnRXaWR0aCtjLnJpZ2h0Oi1sLndpZHRoK2MucmlnaHQ6Yy5sZWZ0LG4mJmgpZFtoXT0ndHJhbnNsYXRlM2QoJytiKydweCwgJyt5KydweCwgMCknLGRbbV09MCxkW2ZdPTAsZC53aWxsQ2hhbmdlPSd0cmFuc2Zvcm0nO2Vsc2V7dmFyIGc9J2JvdHRvbSc9PW0/LTE6MSx4PSdyaWdodCc9PWY/LTE6MTtkW21dPXkqZyxkW2ZdPWIqeCxkLndpbGxDaGFuZ2U9bSsnLCAnK2Z9dmFyIHc9e1wieC1wbGFjZW1lbnRcIjplLnBsYWNlbWVudH07cmV0dXJuIGUuYXR0cmlidXRlcz13dCh7fSx3LGUuYXR0cmlidXRlcyksZS5zdHlsZXM9d3Qoe30sZCxlLnN0eWxlcyksZS5hcnJvd1N0eWxlcz13dCh7fSxlLm9mZnNldHMuYXJyb3csZS5hcnJvd1N0eWxlcyksZX0sZ3B1QWNjZWxlcmF0aW9uOiEwLHg6J2JvdHRvbScseToncmlnaHQnfSxhcHBseVN0eWxlOntvcmRlcjo5MDAsZW5hYmxlZDohMCxmbjpmdW5jdGlvbihlKXtyZXR1cm4gRihlLmluc3RhbmNlLnBvcHBlcixlLnN0eWxlcyksXyhlLmluc3RhbmNlLnBvcHBlcixlLmF0dHJpYnV0ZXMpLGUuYXJyb3dFbGVtZW50JiZPYmplY3Qua2V5cyhlLmFycm93U3R5bGVzKS5sZW5ndGgmJkYoZS5hcnJvd0VsZW1lbnQsZS5hcnJvd1N0eWxlcyksZX0sb25Mb2FkOmZ1bmN0aW9uKGUsdCxyLGEscCl7dmFyIG89QyhwLHQsZSxyLnBvc2l0aW9uRml4ZWQpLGk9RShyLnBsYWNlbWVudCxvLHQsZSxyLm1vZGlmaWVycy5mbGlwLmJvdW5kYXJpZXNFbGVtZW50LHIubW9kaWZpZXJzLmZsaXAucGFkZGluZyk7cmV0dXJuIHQuc2V0QXR0cmlidXRlKCd4LXBsYWNlbWVudCcsaSksRih0LHtwb3NpdGlvbjpyLnBvc2l0aW9uRml4ZWQ/J2ZpeGVkJzonYWJzb2x1dGUnfSkscn0sZ3B1QWNjZWxlcmF0aW9uOnZvaWQgMH19fTt2YXIgT3Q9e1BPUFBFUjonLnRpcHB5LXBvcHBlcicsVE9PTFRJUDonLnRpcHB5LXRvb2x0aXAnLENPTlRFTlQ6Jy50aXBweS1jb250ZW50JyxCQUNLRFJPUDonLnRpcHB5LWJhY2tkcm9wJyxBUlJPVzonLnRpcHB5LWFycm93JyxST1VORF9BUlJPVzonLnRpcHB5LXJvdW5kYXJyb3cnfSxUdD10dD9FbGVtZW50LnByb3RvdHlwZTp7fSxTdD1UdC5tYXRjaGVzfHxUdC5tYXRjaGVzU2VsZWN0b3J8fFR0LndlYmtpdE1hdGNoZXNTZWxlY3Rvcnx8VHQubW96TWF0Y2hlc1NlbGVjdG9yfHxUdC5tc01hdGNoZXNTZWxlY3RvcixBdD17cGFzc2l2ZTohMH0sWXQ9e3g6ITB9LFB0PSExLER0PTAsWHQ9T2JqZWN0LmtleXMoc3QpLEl0PU9iamVjdC5hc3NpZ258fGZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxyPTE7cjxhcmd1bWVudHMubGVuZ3RoO3IrKylmb3IodmFyIGEgaW4gdD1hcmd1bWVudHNbcl0sdClPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxhKSYmKGVbYV09dFthXSk7cmV0dXJuIGV9LE50PXt0cmFuc2xhdGU6L3RyYW5zbGF0ZVg/WT9cXCgoW14pXSspXFwpLyxzY2FsZTovc2NhbGVYP1k/XFwoKFteKV0rKVxcKS99LEh0PTEsV3Q9ITE7S2UudmVyc2lvbj1ldCxLZS5kZWZhdWx0cz1zdCxLZS5vbmU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gS2UoZSx0LCEwKS5pbnN0YW5jZXNbMF19LEtlLnNldERlZmF1bHRzPWZ1bmN0aW9uKGUpe09iamVjdC5rZXlzKGUpLmZvckVhY2goZnVuY3Rpb24odCl7c3RbdF09ZVt0XX0pfSxLZS5kaXNhYmxlQW5pbWF0aW9ucz1mdW5jdGlvbigpe0tlLnNldERlZmF1bHRzKHtkdXJhdGlvbjowLHVwZGF0ZUR1cmF0aW9uOjAsYW5pbWF0ZUZpbGw6ITF9KX0sS2UuaGlkZUFsbFBvcHBlcnM9Z2UsS2UudXNlQ2FwdHVyZT1mdW5jdGlvbigpe307cmV0dXJuIHR0JiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7UShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS10aXBweV0nKSkuZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD1lLmdldEF0dHJpYnV0ZSgnZGF0YS10aXBweScpO3QmJktlKGUse2NvbnRlbnQ6dH0pfSl9KSxmdW5jdGlvbihlKXtpZihwdCl7dmFyIHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTt0LnR5cGU9J3RleHQvY3NzJyx0LnRleHRDb250ZW50PWUsZG9jdW1lbnQuaGVhZC5pbnNlcnRCZWZvcmUodCxkb2N1bWVudC5oZWFkLmZpcnN0Q2hpbGQpfX0oJGUpLEtlfSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10aXBweS5hbGwubWluLmpzLm1hcFxuIiwiLyoqXG4gKiBCcyBJbnB1dCBWYWxpZGF0ZSAoYW5jaG9yKVxuICovXG52YXIgQnNBY3RpdmF0aW9uQ29kZVZhbGlkYXRlID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gRWxlbWVudHNcbiAgdmFyIGVsZW1lbnRzID0ge307XG4gIHZhciAkID0gZWxlbWVudHM7XG5cbiAgJC5mb3JtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy12YWxpZGF0ZScpO1xuXG4gIGlmICghJC5mb3Jtcy5sZW5ndGgpIHJldHVybjtcblxuICAvLyBDb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICB2YWxpZGF0ZToge1xuICAgICAgdG9rZW46IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICByZXR1cm4gaW5wdXQudmFsdWUgPT09IGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS10ZXN0LXZhbGlkYXRpb24nKTtcbiAgICAgIH0sXG4gICAgICBjcGY6IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICByZXR1cm4gaW5wdXQudmFsdWUucmVwbGFjZSgvW14wLTldL2csICcnKSA9PT0gaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLXRlc3QtdmFsaWRhdGlvbicpO1xuICAgICAgfSxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChmb3JtKSB7XG4gICAgICAgIHZhciBpbnB1dHMgPSBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Jyk7XG4gICAgICAgIHZhciBmb3JtU2VuaGEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtZm9ybS1hY2Vzc28tY3JpYXItc2VuaGEnKTtcbiAgICAgICAgdmFyIGZvcm1TZW5oYUlucHV0cyA9IGZvcm1TZW5oYS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpO1xuICAgICAgICB2YXIgdG9rZW5FcnJvck1lc3NhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtZm9ybS1hY2Vzc28tdG9rZW4tbWVzc2FnZScpO1xuXG4gICAgICAgIGZvcm0uY2xhc3NMaXN0LmFkZCgnYnMtaXMtdmFsaWQnKTtcblxuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGlucHV0cywgZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgICAgIGZvcm0ucXVlcnlTZWxlY3RvcignYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKS5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRva2VuRXJyb3JNZXNzYWdlLmNsYXNzTGlzdC5hZGQoJ2JzLWlzLWhpZGRlbicpO1xuICAgICAgICBmb3JtU2VuaGEuY2xhc3NMaXN0LnJlbW92ZSgnYnMtaXMtaGlkZGVuJyk7XG4gICAgICAgIGZvcm1TZW5oYUlucHV0c1swXS5mb2N1cygpO1xuICAgICAgfSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbiAoZm9ybSkge1xuICAgICAgICB2YXIgaW5wdXRzID0gZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpO1xuICAgICAgICB2YXIgZm9ybVNlbmhhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLWZvcm0tYWNlc3NvLWNyaWFyLXNlbmhhJyk7XG4gICAgICAgIHZhciB0b2tlbkVycm9yTWVzc2FnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1mb3JtLWFjZXNzby10b2tlbi1tZXNzYWdlJyk7XG5cbiAgICAgICAgdG9rZW5FcnJvck1lc3NhZ2UuY2xhc3NMaXN0LnJlbW92ZSgnYnMtaXMtaGlkZGVuJyk7XG4gICAgICAgIGZvcm1TZW5oYS5jbGFzc0xpc3QuYWRkKCdicy1pcy1oaWRkZW4nKTtcblxuICAgICAgICBpbnB1dHNbMF0uZm9jdXMoKTtcbiAgICAgIH0sXG4gICAgfSxcbiAgICB2YWxpZGF0ZU9uSW5wdXQ6IHRydWUsXG4gICAgY2xlYW5PbklucHV0OiB0cnVlLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoJC5mb3JtcywgZnVuY3Rpb24gKGZvcm0pIHtcbiAgICAgIHZhciBpbnB1dHMgPSBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Jyk7XG4gICAgICBpZiAoaW5wdXRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBpbnB1dHNbMF0uYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB2YWxpZGF0ZUZvcm0uYmluZChudWxsLCBmb3JtKSk7XG4gICAgICB9XG4gICAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ2Zvcm1Jc1ZhbGlkJywgdmFsaWRhdGVGb3JtLmJpbmQobnVsbCwgZm9ybSkpO1xuXG4gICAgICAvLyBpZiAoY29uZmlnLnZhbGlkYXRlT25JbnB1dCkge1xuICAgICAgLy8gICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHZhbGlkYXRlLmJpbmQobnVsbCwgaW5wdXQpKTtcbiAgICAgIC8vIH0gZWxzZSBpZiAoY29uZmlnLmNsZWFuT25JbnB1dCkge1xuICAgICAgLy8gICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGNsZWFuU3RhdGUuYmluZChudWxsLCBpbnB1dCkpO1xuICAgICAgLy8gfVxuXG4gICAgICAvLyB2YXIgdGVzdGUgPSBCc0Zvcm1WYWxpZGF0ZS52YWxpZGF0ZUZvcm0oZm9ybSk7XG5cbiAgICAgIC8vIENvbW8gYWdvcmEgw6kgdW0gZm9ybS9zdWJtaXQsIG7Do28gcHJlY2lzYSBkbyBrZXl1cFxuICAgICAgLy8gaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgLy8gICBpZiAoZS5rZXlDb2RlID09PSAxMykgdmFsaWRhdGUoZWwpO1xuICAgICAgLy8gfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIHZhbGlkYXRlRm9ybSA9IGZ1bmN0aW9uIChmb3JtKSB7XG4gICAgdmFyIGlucHV0cyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKTtcbiAgICB2YXIgaXNGb3JtVmFsaWQgPSBmYWxzZTtcblxuICAgIGlzRm9ybVZhbGlkID0gdmFsaWRhdGVJbnB1dHMoaW5wdXRzKTtcblxuICAgIGlmIChpc0Zvcm1WYWxpZCkge1xuICAgICAgY29uZmlnLnZhbGlkYXRlLnN1Y2Nlc3MoZm9ybSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbmZpZy52YWxpZGF0ZS5lcnJvcihmb3JtKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHZhbGlkYXRlSW5wdXRzID0gZnVuY3Rpb24gKGlucHV0cykge1xuICAgIHZhciBvdXRwdXQgPSB0cnVlO1xuICAgIHZhciBpbnB1dENvbmZpZyA9IGNvbmZpZy52YWxpZGF0ZTtcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaW5wdXRzLCBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgIHZhciBpbnB1dE5hbWUgPSBpbnB1dC5uYW1lO1xuICAgICAgdmFyIHBhdHRlcm5Jc1ZhbGlkID0gQnNGb3JtVmFsaWRhdGUudmFsaWRhdGVJbnB1dChpbnB1dCk7XG4gICAgICB2YXIgdmFsdWVJc1ZhbGlkID0gaW5wdXRDb25maWdbaW5wdXROYW1lXTtcbiAgICAgIGlmICghcGF0dGVybklzVmFsaWQgfHwgIXZhbHVlSXNWYWxpZChpbnB1dCkpIG91dHB1dCA9IGZhbHNlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgQnNBY3RpdmF0aW9uQ29kZVZhbGlkYXRlIENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXZhbGlkYXRlJykubGVuZ3RoKSB7XG4gICAgQnNBY3RpdmF0aW9uQ29kZVZhbGlkYXRlLmluaXQoKTtcbiAgfVxufSk7XG4iLCIvKipcbiAqIEJhY2sgVG8gVG9wXG4gKiBTbW9vdGggc2Nyb2xsIHRvIHRvcCBvZiB0aGUgcGFnZVxuICogQGxpbmsgaHR0cHM6Ly9jb2RlcGVuLmlvL1FicmlkL3Blbi9FZ0FZTmdcbiAqL1xudmFyIEJzQmFja1RvVG9wID0gKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBpbnRlcnZhbDogbnVsbCxcbiAgfTtcblxuICAvKipcbiAgICogSW5pY2lhbGl6YSBhIGZ1bsOnw6NvXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlbCBhIERPTSBlbGVtZW50XG4gICovXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgaWYgKGVsKSB7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uZmlnLmludGVydmFsID0gc2V0SW50ZXJ2YWwoc2Nyb2xsU3RlcCwgMik7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHNjcm9sbFN0ZXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gQ2hlY2sgaWYgd2UncmUgYXQgdGhlIHRvcCBhbHJlYWR5LiBJZiBzbywgc3RvcCBzY3JvbGxpbmcgYnkgY2xlYXJpbmcgdGhlIGludGVydmFsXG4gICAgaWYgKHdpbmRvdy5wYWdlWU9mZnNldCA9PT0gMCkge1xuICAgICAgY2xlYXJJbnRlcnZhbChjb25maWcuaW50ZXJ2YWwpO1xuICAgIH1cbiAgICB3aW5kb3cuc2Nyb2xsKDAsIHdpbmRvdy5wYWdlWU9mZnNldCAtIDUwKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gIH07XG59KCkpO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgYnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1iYWNrLXRvLXRvcCcpO1xuXG4gIGlmIChidXR0b25zLmxlbmd0aCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYnV0dG9ucywgZnVuY3Rpb24gKGVsKSB7XG4gICAgICBCc0JhY2tUb1RvcC5pbml0KGVsKTtcbiAgICB9KTtcbiAgfVxufSk7XG4iLCJuYXZpZ2F0b3IudmVyc2lvbiA9IChmdW5jdGlvbiAoKSB7XG4gIC8vIGJyaW5nIGFsbCBicm93c2VyXG4gIHZhciB1YT0gbmF2aWdhdG9yLnVzZXJBZ2VudCwgdGVtLFxuICBNID0gdWEubWF0Y2goLyhvcGVyYXxjaHJvbWV8c2FmYXJpfGZpcmVmb3h8aWV8dHJpZGVudCg/PVxcLykpXFwvP1xccyooXFxkKykvaSkgfHwgW107XG4gIGlmKC90cmlkZW50L2kudGVzdChNWzFdKSl7XG4gICAgICB0ZW09ICAvXFxicnZbIDpdKyhcXGQrKS9nLmV4ZWModWEpIHx8IFtdO1xuICAgICAgcmV0dXJuICdJRSAnKyh0ZW1bMV0gfHwgJycpO1xuICB9XG4gIGlmKE1bMV09PT0gJ0Nocm9tZScpe1xuICAgICAgdGVtPSB1YS5tYXRjaCgvXFxiKE9QUnxFZGdlKVxcLyhcXGQrKS8pO1xuICAgICAgaWYodGVtIT0gbnVsbCkgcmV0dXJuIHRlbS5zbGljZSgxKS5qb2luKCcgJykucmVwbGFjZSgnT1BSJywgJ09wZXJhJyk7XG4gIH1cbiAgLy8gZ2V0IHZlcnNpb25cbiAgTT0gTVsyXT8gW01bMV0sIE1bMl1dOiBbbmF2aWdhdG9yLmFwcE5hbWUsIG5hdmlnYXRvci5hcHBWZXJzaW9uLCAnLT8nXTtcbiAgaWYoKHRlbT0gdWEubWF0Y2goL3ZlcnNpb25cXC8oXFxkKykvaSkpIT0gbnVsbCkgTS5zcGxpY2UoMSwgMSwgdGVtWzFdKTtcbiAgcmV0dXJuIE0uam9pbignICcpO1xufSgpKTtcblxuaWYgKG5hdmlnYXRvci52ZXJzaW9uID09PSAnSUUgOScgfHwgbmF2aWdhdG9yLnZlcnNpb24gPT09ICdJRSAxMCcgfHwgbmF2aWdhdG9yLnZlcnNpb24gPT09ICdNU0lFIDEwJyB8fCBuYXZpZ2F0b3IudmVyc2lvbiA9PT0gJ01TSUUgOScpIHtcblxuICAvLyBjcmVhdGUgZWxlbVxuICB2YXIgYnJvd3NlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB2YXIgYnJvd3NlckNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgdmFyIGJyb3dzZXJUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICB2YXIgYnJvd3NlclRleHREZXNjcmlwdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgdmFyIGJ1dHRvbkNsb3NlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG5cbiAgLy8gYWRkIGNsYXNzXG4gIGJyb3dzZXIuY2xhc3NMaXN0LmFkZCgnYnMtYnJvd3Nlci11cGRhdGUnKTtcbiAgYnJvd3NlckNvbnRlbnQuY2xhc3NMaXN0LmFkZCgnYnMtYnJvd3Nlci11cGRhdGVfX2NvbnRlbnQnKTtcbiAgYnJvd3NlclRleHQuY2xhc3NMaXN0LmFkZCgnYnMtYnJvd3Nlci11cGRhdGVfX3RleHQnKTtcbiAgYnJvd3NlclRleHREZXNjcmlwdGlvbi5jbGFzc0xpc3QuYWRkKCdicy1icm93c2VyLXVwZGF0ZV9fdGV4dC1kZXNjcmlwdGlvbicpO1xuICBidXR0b25DbG9zZS5jbGFzc0xpc3QuYWRkKCdicy1idXR0b24nKTtcbiAgYnV0dG9uQ2xvc2UuY2xhc3NMaXN0LmFkZCgnYnMtYnV0dG9uLS1naG9zdCcpO1xuICBidXR0b25DbG9zZS5jbGFzc0xpc3QuYWRkKCdicy1idXR0b24tLXByaW1hcnknKTtcblxuICAvLyBhcHBlbmQgY3JlYXRlXG4gIGJyb3dzZXIuYXBwZW5kQ2hpbGQoYnJvd3NlckNvbnRlbnQpO1xuICBicm93c2VyQ29udGVudC5hcHBlbmRDaGlsZChicm93c2VyVGV4dCk7XG4gIGJyb3dzZXJDb250ZW50LmFwcGVuZENoaWxkKGJyb3dzZXJUZXh0RGVzY3JpcHRpb24pO1xuICBicm93c2VyQ29udGVudC5hcHBlbmRDaGlsZChidXR0b25DbG9zZSk7XG5cbiAgLy8gVGV4dCBjcmVhdGVcbiAgdmFyIHRleHRub2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ1NldSBuYXZlZ2Fkb3IgJyArIG5hdmlnYXRvci52ZXJzaW9uICsgJyBlc3TDoSBkZXNhdHVhbGl6YWRvJyk7XG4gIHZhciBkZXNjcmlwdGlvbk5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnQXR1YWxpemUgc2V1IG5hdmVnYWRvciBwYXJhIHRlciBtYWlzIHNlZ3VyYW7Dp2EgZSB2ZWxvY2lkYWRlLCBhbMOpbSBkYSBtZWxob3IgZXhwZXJpw6puY2lhIG5lc3RlIHNpdGUuJyk7XG4gIHZhciBidXR0b250ZXh0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ0NvbnRpbnVhciBtZXNtbyBhc3NpbScpO1xuXG4gIC8vIGluc2VydCB0ZXh0XG4gIGJyb3dzZXJUZXh0LmFwcGVuZENoaWxkKHRleHRub2RlKTtcbiAgYnJvd3NlclRleHREZXNjcmlwdGlvbi5hcHBlbmRDaGlsZChkZXNjcmlwdGlvbk5vZGUpO1xuICBidXR0b25DbG9zZS5hcHBlbmRDaGlsZChidXR0b250ZXh0KTtcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChicm93c2VyKTtcblxuICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG5cbiAgLy8gb25seSBjbG9zZSBlbGVtIGJyb3dzZXJcbiAgYnV0dG9uQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICcnO1xuICAgIGJyb3dzZXIucmVtb3ZlKCk7XG4gIH0pO1xufVxuXG4iLCIvKipcbiAqIFdyYXAgSFRNTCBlbGVtZW50IHdpdGhpbiBhbm90aGVyIGVsZW1lbnRcbiAqIGUuZy4gV3JhcCBhIHRhYmxlIHdpdGhpbiBkaXYuYnMtdGFibGUgdG8gbWFrZSBpdCByZXNwb25zaXZlXG4gKlxuICovXG52YXIgQnNGaXhQb3J0YWxIVE1MID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gQ29uZmlnXG4gIHZhciBjb25maWcgPSB7XG4gICAgZWxlbWVudHM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1wb3J0YWwtY29udGVudCB0YWJsZScpLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmVsZW1lbnRzLCBmdW5jdGlvbiAodGFibGUpIHtcbiAgICAgIHZhciB0YWJsZVdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIHRhYmxlV3JhcHBlci5jbGFzc0xpc3QuYWRkKCdicy10YWJsZScpO1xuICAgICAgd3JhcEVsZW1lbnQodGFibGUsIHRhYmxlV3JhcHBlcik7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IEJzRml4UG9ydGFsSFRNTCBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gQnNGaXhQb3J0YWxIVE1MLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1wb3J0YWwtY29udGVudCcpLmxlbmd0aCkge1xuICAgIEJzRml4UG9ydGFsSFRNTC5pbml0KCk7XG4gIH1cbn0pO1xuIiwidmFyIGdldFBhcmVudHMgPSBmdW5jdGlvbiAoZWxlbSwgcGFyZW50Q2xhc3MsIGZpcnN0T2N1cnJlbmN5T25seSkge1xuICB2YXIgcGFyZW50cyA9IFtdO1xuXG4gIGZvciAoOyBlbGVtICYmIGVsZW0gIT09IGRvY3VtZW50OyBlbGVtID0gZWxlbS5wYXJlbnROb2RlKSB7XG4gICAgaWYgKGVsZW0uY2xhc3NMaXN0LmNvbnRhaW5zKHBhcmVudENsYXNzKSkge1xuICAgICAgcGFyZW50cy5wdXNoKGVsZW0pO1xuXG4gICAgICBpZiAoZmlyc3RPY3VycmVuY3lPbmx5KSBicmVhaztcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhcmVudHM7XG59O1xuXG52YXIgZ2V0UGFyZW50ID0gZnVuY3Rpb24gKGVsZW0sIHBhcmVudENsYXNzKSB7XG4gIHJldHVybiBnZXRQYXJlbnRzKGVsZW0sIHBhcmVudENsYXNzLCB0cnVlKVswXTtcbn07XG5cblxuLyoqXG4gKiBDbGljayBPdXRzaWRlXG4gKlxuICogT2JzOiBuw6NvIGZ1bmNpb25hIGFpbmRhIDooXG4gKlxuICovXG52YXIgb3V0c2lkZSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIG5vdFRhcmdldHMgPSBmdW5jdGlvbiAoZWxlbWVudHMsIGV2ZW50VGFyZ2V0KSB7XG4gICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuICAgIGVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgIHJlc3VsdCA9ICFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhldmVudFRhcmdldCk7XG4gICAgfSk7XG4gICAgcmV0dXJuICFyZXN1bHQ7XG4gIH07XG5cbiAgdmFyIGNsaWNrT3V0c2lkZSA9IGZ1bmN0aW9uIChlbGVtZW50QWN0aXZlLCBhbGxvd2VkVGFyZ2V0cywgY2FsbGJhY2spIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdib2R5LCBodG1sJykuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBpZiAoZWxlbWVudEFjdGl2ZSgpICYmIG5vdFRhcmdldHMoYWxsb3dlZFRhcmdldHMsIGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gQ2xvc2Ugc2VhcmNoIG9uIGNsaWNrIG91dHNpZGVcbiAgLy8gVXNlOlxuICAvLyBjbGlja091dHNpZGUoc2VhcmNoQWN0aXZlLCBbY29uZmlnLnNlYXJjaCwgY29uZmlnLnNlYXJjaFRvZ2dsZV0sIGNsb3NlU2VhcmNoKTtcbn07XG5cbi8qKlxuICogV3JhcCBIVE1MIGVsZW1lbnQgd2l0aGluIGFub3RoZXIgZWxlbWVudFxuICogZS5nLiBXcmFwIGEgdGFibGUgd2l0aGluIGRpdi5icy10YWJsZSB0byBtYWtlIGl0IHJlc3BvbnNpdmVcbiAqIEBwYXJhbSB7RWxlbWVudH0gdG9XcmFwIGVsZW1lbnQgdG8gYmUgd3JhcHBlZFxuICogQHBhcmFtIHtFbGVtZW50fSB3cmFwcGVyIGRvbSBlbGVtZW50IHRoYXQnbGwgd3JhcCB0b1dyYXBcbiAqIEByZXR1cm5zIHtFbGVtZW50fVxuICovXG52YXIgd3JhcEVsZW1lbnQgPSBmdW5jdGlvbiAodG9XcmFwLCB3cmFwcGVyKSB7XG4gIHdyYXBwZXIgPSB3cmFwcGVyIHx8IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB0b1dyYXAucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUod3JhcHBlciwgdG9XcmFwKTtcbiAgcmV0dXJuIHdyYXBwZXIuYXBwZW5kQ2hpbGQodG9XcmFwKTtcbn07XG5cbi8qKlxuICogQ2hlY2tzIGFsbCBjaGVja2JveGVzIHdpdGggdGhlIGdpdmVuIG5hbWVcbiAqIEBwYXJhbSB7RWxlbWVudH0gY2hlY2tib3hUYXJnZXQgdGhlIGNoZWNrYm94IHRoYXQnbGwgc2VsZWN0IGFsbCB0aGUgb3RoZXIgY2hlY2tib3hlc1xuICogQHBhcmFtIHtFbGVtZW50fSBuYW1lIGNoZWNrYm94ZXMgbmFtZVxuICovXG52YXIgc2VsZWN0QWxsQ2hlY2tib3hlcyA9IGZ1bmN0aW9uIChjaGVja2JveFRhcmdldCwgbmFtZSkge1xuICBjaGVja2JveGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUobmFtZSk7XG5cbiAgaWYgKGNoZWNrYm94ZXMpIHtcbiAgICBjaGVja2JveGVzLmZvckVhY2goZnVuY3Rpb24gKGNoZWNrYm94KSB7XG4gICAgICBjaGVja2JveC5jaGVja2VkID0gY2hlY2tib3hUYXJnZXQuY2hlY2tlZDtcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIGdyYXlzY2FsZUltYWdlXG4gKiBHZW5lcmF0ZXMgYW5kIGJhc2U2NCB1cmwgZ3JheXNjYWxlIGltYWdlIGZyb20gYW4gaW1hZ2Ugc291cmNlXG4gKlxuICogUmVmZXJlbmNlOlxuICogQGxpbms6IGh0dHBzOi8vd3d3Lm1hamFzLWxhcHUtaXpzdHJhZGUubHYvY3Jvc3MtYnJvd3Nlci1ncmF5c2NhbGUtaW1hZ2UtZXhhbXBsZS11c2luZy1jc3MzLWpzL1xuICpcbiAqIEBwYXJhbSAge3N0cmluZ30gIHNyYyBUaGUgc3JjIGltYWdlXG4gKiBAcmV0dXJuIHtib29sZWFufSAgICAgRGF0YVVSTCBvZiB0aGUgc3JjIGltYWdlXG4gKi9cbnZhciBncmF5c2NhbGVJbWFnZSA9IGZ1bmN0aW9uIChzcmMpIHtcbiAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICB2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gIHZhciBpbWdPYmogPSBuZXcgSW1hZ2UoKTtcbiAgaW1nT2JqLnNyYyA9IHNyYztcbiAgY2FudmFzLndpZHRoID0gaW1nT2JqLndpZHRoO1xuICBjYW52YXMuaGVpZ2h0ID0gaW1nT2JqLmhlaWdodDtcbiAgY3R4LmRyYXdJbWFnZShpbWdPYmosIDAsIDApO1xuICB2YXIgaW1nUGl4ZWxzID0gY3R4LmdldEltYWdlRGF0YSgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuICBmb3IgKHZhciB5ID0gMDsgeSA8IGltZ1BpeGVscy5oZWlnaHQ7IHkrKykge1xuICAgIGZvciAodmFyIHggPSAwOyB4IDwgaW1nUGl4ZWxzLndpZHRoOyB4KyspIHtcbiAgICAgIC8vIHZhciBpID0gKHkgKiA0KSAqIGltZ1BpeGVscy53aWR0aCArIHggKiA0O1xuICAgICAgdmFyIGkgPSAoKHkgKiA0KSAqIGltZ1BpeGVscy53aWR0aCkgKyAoeCAqIDQpO1xuICAgICAgdmFyIGF2ZyA9IChpbWdQaXhlbHMuZGF0YVtpXSArIGltZ1BpeGVscy5kYXRhW2kgKyAxXSArIGltZ1BpeGVscy5kYXRhW2kgKyAyXSkgLyAzO1xuICAgICAgaW1nUGl4ZWxzLmRhdGFbaV0gPSBhdmc7XG4gICAgICBpbWdQaXhlbHMuZGF0YVtpICsgMV0gPSBhdmc7XG4gICAgICBpbWdQaXhlbHMuZGF0YVtpICsgMl0gPSBhdmc7XG4gICAgfVxuICB9XG4gIGN0eC5wdXRJbWFnZURhdGEoaW1nUGl4ZWxzLCAwLCAwLCAwLCAwLCBpbWdQaXhlbHMud2lkdGgsIGltZ1BpeGVscy5oZWlnaHQpO1xuICByZXR1cm4gY2FudmFzLnRvRGF0YVVSTCgpO1xufTtcblxuLyoqXG4gKiBSZXBsYWNlIEFsbFxuICogUmVwbGFjZSBhbGwgb2N1cnJlbmNlcyBvZiBhbiBzdHJpbmcgaW50byBhbm90aGVyXG4gKiBAbGluayBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTc2MDYyODlcbiAqXG4gKiBVc2U6IHN0cmluZy5yZXBsYWNlQWxsKHN0cmluZ1RvU2VhcmNoLCBzdHJpbmdUb1JlcGxhY2UpXG4gKlxuICogQHBhcmFtICB7c3RyaW5nfSBzZWFyY2ggICAgICB0aGUgdGVybSB0byBzZWFyY2ggaW4gc3RyaW5nXG4gKiBAcGFyYW0gIHtzdHJpbmd9IHJlcGxhY2VtZW50IHRoZSB2YWx1ZSB0byByZXBsYWNlIHRlcm0ncyBieVxuICogQHJldHVybiB7c3RyaW5nfSAgICAgICAgICAgICBhIHN0cmluZyB1cGRhdGVkIGJ5IHJlcGxhY2VzXG4gKi9cblN0cmluZy5wcm90b3R5cGUucmVwbGFjZUFsbCA9IGZ1bmN0aW9uIChzZWFyY2gsIHJlcGxhY2VtZW50KSB7XG4gIHZhciB0YXJnZXQgPSB0aGlzO1xuICByZXR1cm4gdGFyZ2V0LnNwbGl0KHNlYXJjaCkuam9pbihyZXBsYWNlbWVudCk7XG59O1xuXG4vKipcbiAqIGNvbnZlcnRBY2NlbnRlZENoYXJhY3RlcnNcbiAqICBjb252ZXJ0IGFjY2VudGVkIGNoYXJhY3RlcnMgdG8gbm9uLWFjY2VudGVkXG4gKiBAcGFyYW0gIHtzdHJpbmd9IHN0ciBzb21lIHN0cmluZ1xuICogQHJldHVybiB7c3RyaW5nfSAgICAgYSBzdHJpbmcgd2l0aCBub24gYWNjZW50ZWQgY2hhcmFjdGVyc1xuICovXG52YXIgY29udmVydEFjY2VudGVkQ2hhcmFjdGVycyA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgdmFyIGNvbnZlcnNpb25zID0ge1xuICAgICdhZSc6ICfDpHzDpnzHvScsXG4gICAgJ29lJzogJ8O2fMWTJyxcbiAgICAndWUnOiAnw7wnLFxuICAgICdBZSc6ICfDhCcsXG4gICAgJ1VlJzogJ8OcJyxcbiAgICAnT2UnOiAnw5YnLFxuICAgICdBJzogJ8OAfMOBfMOCfMODfMOEfMOFfMe6fMSAfMSCfMSEfMeNJyxcbiAgICAnYSc6ICfDoHzDoXzDonzDo3zDpXzHu3zEgXzEg3zEhXzHjnzCqicsXG4gICAgJ0MnOiAnw4d8xIZ8xIh8xIp8xIwnLFxuICAgICdjJzogJ8OnfMSHfMSJfMSLfMSNJyxcbiAgICAnRCc6ICfDkHzEjnzEkCcsXG4gICAgJ2QnOiAnw7B8xI98xJEnLFxuICAgICdFJzogJ8OIfMOJfMOKfMOLfMSSfMSUfMSWfMSYfMSaJyxcbiAgICAnZSc6ICfDqHzDqXzDqnzDq3zEk3zElXzEl3zEmXzEmycsXG4gICAgJ0cnOiAnxJx8xJ58xKB8xKInLFxuICAgICdnJzogJ8SdfMSffMShfMSjJyxcbiAgICAnSCc6ICfEpHzEpicsXG4gICAgJ2gnOiAnxKV8xKcnLFxuICAgICdJJzogJ8OMfMONfMOOfMOPfMSofMSqfMSsfMePfMSufMSwJyxcbiAgICAnaSc6ICfDrHzDrXzDrnzDr3zEqXzEq3zErXzHkHzEr3zEsScsXG4gICAgJ0onOiAnxLQnLFxuICAgICdqJzogJ8S1JyxcbiAgICAnSyc6ICfEticsXG4gICAgJ2snOiAnxLcnLFxuICAgICdMJzogJ8S5fMS7fMS9fMS/fMWBJyxcbiAgICAnbCc6ICfEunzEvHzEvnzFgHzFgicsXG4gICAgJ04nOiAnw5F8xYN8xYV8xYcnLFxuICAgICduJzogJ8OxfMWEfMWGfMWIfMWJJyxcbiAgICAnTyc6ICfDknzDk3zDlHzDlXzFjHzFjnzHkXzFkHzGoHzDmHzHvicsXG4gICAgJ28nOiAnw7J8w7N8w7R8w7V8xY18xY98x5J8xZF8xqF8w7h8x798wronLFxuICAgICdSJzogJ8WUfMWWfMWYJyxcbiAgICAncic6ICfFlXzFl3zFmScsXG4gICAgJ1MnOiAnxZp8xZx8xZ58xaAnLFxuICAgICdzJzogJ8WbfMWdfMWffMWhfMW/JyxcbiAgICAnVCc6ICfFonzFpHzFpicsXG4gICAgJ3QnOiAnxaN8xaV8xacnLFxuICAgICdVJzogJ8OZfMOafMObfMWofMWqfMWsfMWufMWwfMWyfMavfMeTfMeVfMeXfMeZfMebJyxcbiAgICAndSc6ICfDuXzDunzDu3zFqXzFq3zFrXzFr3zFsXzFs3zGsHzHlHzHlnzHmHzHmnzHnCcsXG4gICAgJ1knOiAnw518xbh8xbYnLFxuICAgICd5JzogJ8O9fMO/fMW3JyxcbiAgICAnVyc6ICfFtCcsXG4gICAgJ3cnOiAnxbUnLFxuICAgICdaJzogJ8W5fMW7fMW9JyxcbiAgICAneic6ICfFunzFvHzFvicsXG4gICAgJ0FFJzogJ8OGfMe8JyxcbiAgICAnc3MnOiAnw58nLFxuICAgICdJSic6ICfEsicsXG4gICAgJ2lqJzogJ8SzJyxcbiAgICAnT0UnOiAnxZInLFxuICAgICdmJzogJ8aSJyxcbiAgfVxuXG4gIGZvciAodmFyIGkgaW4gY29udmVyc2lvbnMpIHtcbiAgICBpZiAoaSkge1xuICAgICAgdmFyIHJlID0gbmV3IFJlZ0V4cChjb252ZXJzaW9uc1tpXSwgJ2cnKTtcbiAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKHJlLCBpKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gc3RyO1xufTtcblxuLyoqXG4gKiBpbmRleE9mIFNwZWNpYWxcbiAqIExpa2UgaW5kZXhPZiwgYnV0IHRha2luZyBhY2NlbnRlZCBjaGFyYWN0ZXJzIGludG8gYWNjb3VudFxuICogQHBhcmFtICB7c3RyaW5nfSBzdHIgICAgc3RyaW5nIHdoZXJlIHNlYXJjaFxuICogQHBhcmFtICB7c3RyaW5nfSBzZWFyY2ggc3RyaW5nIHRvIHNlYXJjaFxuICogQHBhcmFtICB7bnVtYmVyfSBpbmRleCAgaW5kZXggdG8gc3RhcnRcbiAqIEByZXR1cm4ge3N0cmluZ30gICAgICAgIGluZGV4IG9mIHNlYXJjaCBpbiBzdHJcbiAqL1xudmFyIGluZGV4T2ZTcGVjaWFsID0gZnVuY3Rpb24gKHN0ciwgc2VhcmNoLCBpbmRleCkge1xuICB2YXIgY29tcGFyZVN0cmluZztcbiAgdmFyIGNvbXBhcmVSZXBsYWNlO1xuICAvLyBDaGVjayByZXF1aXJlZCBwYXJhbXNcbiAgaWYgKHR5cGVvZiBzdHIgPT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiBzZWFyY2ggPT09ICd1bmRlZmluZWQnKSB7XG4gICAgLy8gdGhyb3cgbmV3IEVycm9yKCdib3RoIHN0ciBhbmQgc2VhcmNoIHBhcmFtZXRlcnMgYXJlIHJlcXVpcmVkJyk7XG4gICAgY29uc29sZS5lcnJvcignYm90aCBzdHIgYW5kIHNlYXJjaCBwYXJhbWV0ZXJzIGFyZSByZXF1aXJlZCcpO1xuICB9XG4gIC8vIElmIHN0cmluZ3MgYXJlIGVtcHR5LCB0aGVyZSdzIG5vIGluZGV4XG4gIGlmICghc3RyLnJlcGxhY2UoL1xccy9nLCAnJykubGVuZ3RoIHx8ICFzZWFyY2gucmVwbGFjZSgvXFxzL2csICcnKS5sZW5ndGgpIHJldHVybiAtMTtcbiAgaWYgKHR5cGVvZiBpbmRleCA9PT0gJ3VuZGVmaW5lZCcpIGluZGV4ID0gMDtcblxuICAvLyBSZW1vdmUgc3BlY2lhbCBjaGFyYWN0ZXJzIGFuZCBjYXNlIHNpemVcbiAgY29tcGFyZVN0cmluZyA9IGNvbnZlcnRBY2NlbnRlZENoYXJhY3RlcnMoc3RyLnRvTG93ZXJDYXNlKCkpO1xuICBjb21wYXJlUmVwbGFjZSA9IGNvbnZlcnRBY2NlbnRlZENoYXJhY3RlcnMoc2VhcmNoLnRvTG93ZXJDYXNlKCkpO1xuXG4gIC8vIHJldHVybiBpbmRleCBvZiBjb21wYXJlUmVwbGFjZSBpbiBjb21wYXJlU3RyaW5nXG4gIHJldHVybiBjb21wYXJlU3RyaW5nLmluZGV4T2YoY29tcGFyZVJlcGxhY2UsIGluZGV4KTtcbn07XG5cbi8qKlxuICogaHR0cEdldFxuICpcbiAqIGdldCBkYXRhIGZyb20gdXJsXG4gKiBVUkwgZXhhbXBsZTogaHR0cHM6Ly9zd2FwaS5jby9hcGkvcGVvcGxlLz9mb3JtYXQ9anNvblxuICpcbiAqIEBwYXJhbSAge3N0cmluZ30gICB1cmwgICAgICB2YWxpZCBBUEkgdXJsXG4gKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2FsbGJhY2sgY2FsbGJhY2tcbiAqIEByZXR1cm4ge3ZvaWR9ICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2sgZnVuY3Rpb25cbiAqL1xudmFyIGh0dHBHZXQgPSBmdW5jdGlvbiAodXJsLCBjYWxsYmFjaywgc3luYykge1xuICB2YXIgeG1sSHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICBpZiAoc3luYyAhPT0gdHJ1ZSAmJiBzeW5jICE9PSAxKSBzeW5jID0gMDtcbiAgaWYgKCFzeW5jKSB7XG4gICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoeG1sSHR0cC5yZWFkeVN0YXRlID09PSA0ICYmIHhtbEh0dHAuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgY2FsbGJhY2soeG1sSHR0cC5yZXNwb25zZVRleHQpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgeG1sSHR0cC5vcGVuKCdHRVQnLCB1cmwsICFzeW5jKTsgLy8gdHJ1ZSBmb3IgYXN5bmNocm9ub3VzXG4gIHhtbEh0dHAuc2VuZChudWxsKTtcbiAgaWYgKHN5bmMpIHJldHVybiB4bWxIdHRwLnJlc3BvbnNlVGV4dDtcbn07XG5cbi8qKlxuICogdG9nZ2xlQm9keU92ZXJmbG93SGlkZGVuXG4gKiBBZGQgb3IgcmVtb3ZlIG92ZXJmbG93IGhpZGRlbiB0byBib2R5IGFuZCBodG1sIHRhZ3NcbiAqXG4gKiBAcGFyYW0ge0Jvb2xlYW59IGhpZGRlbiBJZiBzaG91bGQgc2V0IG92ZXJmbG93IGFzIGhpZGRlblxuICovXG52YXIgdG9nZ2xlQm9keU92ZXJmbG93SGlkZGVuID0gZnVuY3Rpb24gKGhpZGRlbikge1xuICB2YXIgaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2JvZHksIGh0bWwnKTtcbiAgdmFyIG92ZXJmbG93SXNIaWRkZW4gPSBmYWxzZTtcblxuICAvLyBDaGVjayBpZiBoaWRkZW4gaXMgcGFzc2VkIGFuZCBpdHMgdHlwZW9mIGlzIGJvb2xlYW5cbiAgaWYgKHR5cGVvZiBoaWRkZW4gIT09ICdib29sZWFuJykge1xuICAgIC8vIElmIG5vdCwgY2hlY2sgaWYgYm9keSBvciBodG1sIGhhcyBvdmVyZmxvdyBoaWRkZW5cbiAgICBBcnJheS5wcm90b3R5cGUuc29tZS5jYWxsKGh0bWwsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgdmFyIHN0eWxlcyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKTtcbiAgICAgIHZhciBvdmVyZmxvdyA9IHN0eWxlcy5nZXRQcm9wZXJ0eVZhbHVlKCdvdmVyZmxvdycpO1xuXG4gICAgICAvLyBJZiBodG1sIG9yIGJvZHkgaGFzIG92ZXJmbG93IGhpZGRlblxuICAgICAgaWYgKG92ZXJmbG93ID09PSAnaGlkZGVuJykge1xuICAgICAgICAvLyBzZXQgb3ZlcmZsb3dJc0hpZGRlbiBhcyB0cnVlXG4gICAgICAgIG92ZXJmbG93SXNIaWRkZW4gPSB0cnVlO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgLy8gaWYgaGlkZGVuIGlzIHBhc3NlZCwgc2V0IG92ZXJmbG93SXNIaWRkZW4gYXMgb3Bwb3NpdGUgb2YgaGlkZGVuXG4gICAgb3ZlcmZsb3dJc0hpZGRlbiA9ICFoaWRkZW47XG4gIH1cblxuICAvLyBUb2dnbGUgb3ZlcmZsb3cgaGlkZGVuXG4gIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaHRtbCwgZnVuY3Rpb24gKGVsKSB7XG4gICAgaWYgKG92ZXJmbG93SXNIaWRkZW4pIGVsLnN0eWxlLm92ZXJmbG93ID0gJyc7XG4gICAgZWxzZSBlbC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuICB9KTtcbn07XG5cbi8qKlxuICogSW5pdCBHb29nbGUgTWFwXG4gKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2IgICAgICAgIENhbGxiYWNrIEZ1bmN0aW9uXG4gKiBAcGFyYW0gIHtTdHJpbmd9ICAgY3VzdG9tS2V5IGEgY3VzdG9tIG1hcHMgYXBpIGtleVxuICovXG5pbml0R29vZ2xlTWFwID0gZnVuY3Rpb24gKGNiLCBjdXN0b21LZXkpIHtcbiAgdmFyIGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG4gIHZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgdmFyIG1hcEtleSA9IGN1c3RvbUtleSB8fCAnQUl6YVN5REo2eVMyWUgxOS1zbmRTaHpQaEcxTzI5TGlVOUpNb2Y4JztcbiAgdmFyIGJhc2VTcmMgPSAnaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2pzP3Y9My4zMyZsaWJyYXJpZXM9cGxhY2VzJmtleT0nICsgbWFwS2V5O1xuICB2YXIgaGFzTWFwU2NyaXB0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc2NyaXB0W3NyYz1cIicgKyBiYXNlU3JjICsgJ1wiXScpO1xuXG4gIGlmICh0eXBlb2YgY2IgIT09ICdmdW5jdGlvbicpIGNiID0gZnVuY3Rpb24gKCkge31cblxuICBpZiAoaGFzTWFwU2NyaXB0KSByZXR1cm4gY2IoKTtcblxuICAvLyBJbnNlcnQgc2NyaXB0IHRhZyBvbiBkb2N1bWVudFxuICBzY3JpcHQuc3JjID0gYmFzZVNyYztcbiAgc2NyaXB0LmRlZmVyID0gdHJ1ZTtcbiAgYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpO1xuXG4gIC8vIGNhbGwgY2FsbGJhY2sgZnVuY3Rpb25cbiAgc2NyaXB0Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY2IoKTtcbiAgfTtcbn07XG5cbi8qKlxuICogT2J0w6ltIGEgaGFzaCBhIHBhcnRpciBkYSBVUkwgZGEgcMOhZ2luYVxuICogQHJldHVybiB7U3RyaW5nfSBIYXNoIHRyYXRhZGEgKHNlbSAjKVxuKi9cbnZhciBnZXRIYXNoID0gZnVuY3Rpb24gKCkge1xuICB2YXIgY29udGFpbmVySWQgPSB3aW5kb3cubG9jYXRpb24uaGFzaDtcbiAgcmV0dXJuIChjb250YWluZXJJZCkgPyBjb250YWluZXJJZC5yZXBsYWNlKCcjJywgJycpIDogbnVsbDtcbn07XG5cbi8qKlxuICogT2J0w6ltIGEgaGFzaCBjb21vIHVtIHNlbGV0b3IgSUQgYSBwYXJ0aXIgZGUgdW0gVVJMIGNvbW8gc3RyaW5nXG4gKiBAcGFyYW0gIHtbdHlwZV19IHVybCBhIFVSTCBjb21wbGV0YVxuICogQHJldHVybiB7U3RyaW5nfSAgICAgSGFzaCB0cmF0YWRhIGNvbW8gSUQgKHNlbSAjIGUgZGVtYWlzIGNhcmFjdGVyZXMgZXNwZWNpYWlzKVxuICovXG52YXIgZ2V0SGFzaEFzSWRGcm9tVXJsU3RyaW5nID0gZnVuY3Rpb24gKHVybCkge1xuICB2YXIgaGFzaCA9IHVybC5zdWJzdHIodXJsLmluZGV4T2YoJyMnKSkucmVwbGFjZSgvLiooPz0jKXxcXD8uKnxbXmEtekEtWjAtOS1fI10vZywgJycpO1xuICByZXR1cm4gKGhhc2gubGVuZ3RoID4gMSkgPyBoYXNoIDogJyc7XG59XG5cbi8qKlxuICogVmVyaWZpY2Egc2UgbyBlbGVtZW50byBwYXNzYWRvIGVzdMOhIGRlbnRybyBkYSB2aWV3cG9ydFxuICogaHR0cHM6Ly9nb21ha2V0aGluZ3MuY29tL2hvdy10by10ZXN0LWlmLWFuLWVsZW1lbnQtaXMtaW4tdGhlLXZpZXdwb3J0LXdpdGgtdmFuaWxsYS1qYXZhc2NyaXB0L1xuICogQHBhcmFtIHtFbGVtZW50fSBlbGVtIGVsZW1lbnRvIGEgc2VyIHZlcmlmaWNhZG9cbiAqIEByZXR1cm4ge0Jvb2xlYW59XG4qL1xudmFyIGlzSW5WaWV3cG9ydCA9IGZ1bmN0aW9uIChlbGVtKSB7XG4gIHZhciBib3VuZGluZyA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIHJldHVybiAoXG4gICAgYm91bmRpbmcudG9wID49IDAgJiZcbiAgICBib3VuZGluZy5sZWZ0ID49IDAgJiZcbiAgICBib3VuZGluZy5ib3R0b20gPD0gKHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KSAmJlxuICAgIGJvdW5kaW5nLnJpZ2h0IDw9ICh3aW5kb3cuaW5uZXJXaWR0aCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgpXG4gICk7XG59O1xuXG4vKipcbiAqIFJldG9ybmEgYSB2ZXJzw6NvIGRvIElFIG91IC0xIGNhc28gc2VqYSBvdXRybyBuYXZlZ2Fkb3JcbiAqIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE5OTk5Mzg4L2NoZWNrLWlmLXVzZXItaXMtdXNpbmctaWUtd2l0aC1qcXVlcnkvMjE3MTIzNTYjMjE3MTIzNTZcbiAqIEByZXR1cm4ge0Jvb2xlYW59XG4qL1xudmFyIGRldGVjdElFID0gZnVuY3Rpb24gKCkge1xuICB2YXIgdWEgPSB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudDtcblxuICB2YXIgbXNpZSA9IHVhLmluZGV4T2YoJ01TSUUgJyk7XG4gIHZhciB0cmlkZW50ID0gdWEuaW5kZXhPZignVHJpZGVudC8nKTtcbiAgdmFyIGVkZ2UgPSB1YS5pbmRleE9mKCdFZGdlLycpO1xuXG4gIC8vIElFXG4gIGlmICgobXNpZSA+IDApIHx8ICh0cmlkZW50ID4gMCkgfHwgKGVkZ2UgPiAwKSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLy8gT3V0cm8gbmF2ZWdhZG9yXG4gIHJldHVybiBmYWxzZTtcbn07XG5cbi8qKlxuICogR2V0XG4gKiBSZXF1ZXN0IFhNTEh0dHAgZnJvbSB1cmxcbiAqXG4gKiBAcGFyYW0gIHtTdHJpbmd9IHVybCAgVVJMIHdoZXJlXG4gKiBAcmV0dXJuIHtQcm9taXNlfSAgICAgcmVzcG9uc2Ugb2YgcmVxdWVzdFxuICovXG52YXIgZ2V0ID0gZnVuY3Rpb24gKHVybCwgcHJvZ3Jlc3NDYWxsYmFjaykge1xuICAvLyBSZXR1cm4gYSBuZXcgcHJvbWlzZS5cbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAvLyBEbyB0aGUgdXN1YWwgWEhSIHN0dWZmXG4gICAgdmFyIHJlcSA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHJlcS5vcGVuKCdHRVQnLCB1cmwpO1xuXG4gICAgcmVxLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgcHJvZ3Jlc3NDYWxsYmFjaywgZmFsc2UpO1xuXG4gICAgcmVxLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIFRoaXMgaXMgY2FsbGVkIGV2ZW4gb24gNDA0IGV0Y1xuICAgICAgLy8gc28gY2hlY2sgdGhlIHN0YXR1c1xuICAgICAgaWYgKHJlcS5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgIC8vIFJlc29sdmUgdGhlIHByb21pc2Ugd2l0aCB0aGUgcmVzcG9uc2UgdGV4dFxuICAgICAgICByZXNvbHZlKHJlcS5yZXNwb25zZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBPdGhlcndpc2UgcmVqZWN0IHdpdGggdGhlIHN0YXR1cyB0ZXh0XG4gICAgICAgIC8vIHdoaWNoIHdpbGwgaG9wZWZ1bGx5IGJlIGEgbWVhbmluZ2Z1bCBlcnJvclxuICAgICAgICByZWplY3QoRXJyb3IocmVxLnN0YXR1c1RleHQpKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIG5ldHdvcmsgZXJyb3JzXG4gICAgcmVxLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZWplY3QoRXJyb3IoJ05ldHdvcmsgRXJyb3InKSk7XG4gICAgfTtcblxuICAgIHJlcS5yZXNwb25zZVR5cGUgPSAnYmxvYic7XG5cbiAgICAvLyBNYWtlIHRoZSByZXF1ZXN0XG4gICAgcmVxLnNlbmQoKTtcbiAgfSk7XG59O1xuXG4vKipcbiAqIGZvckVhY2ggUHJvbWlzZVxuICogQHBhcmFtICB7QXJyYXl9ICAgICBpdGVtcyAgQW4gYXJyYXkgb2YgaXRlbXMgdG8gcmV0dXJuIGZyb20gcHJvbWlzZVxuICogQHBhcmFtICB7RnVuY3Rpb259ICBmbiAgICAgQSBmdW5jdGlvbiB0aGF0IGFjY2VwdHMgYW4gaXRlbSBmcm9tIHRoZSBhcnJheSBhbmQgcmV0dXJucyBhIHByb21pc2UuXG4gKiBAcmV0dXJucyB7UHJvbWlzZX1cbiAqL1xudmFyIGZvckVhY2hQcm9taXNlID0gZnVuY3Rpb24gKGl0ZW1zLCBmbikge1xuICByZXR1cm4gaXRlbXMucmVkdWNlKGZ1bmN0aW9uIChwcm9taXNlLCBpdGVtKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ3Byb21pc2UgZSBpdGVtOiAnKTtcbiAgICAvLyBjb25zb2xlLmxvZyhwcm9taXNlKTtcbiAgICAvLyBjb25zb2xlLmxvZyhpdGVtKTtcbiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBmbihpdGVtKTtcbiAgICB9KTtcbiAgfSwgUHJvbWlzZS5yZXNvbHZlKCkpO1xufTtcblxuLyoqXG4gKiBnZXRGaWxlbmFtZUZyb21QYXRoXG4gKlxuICogVGVzdDpcbiAgIHZhciBhcnJheSA9IFtcbiAgICAgJ2ZpbGVuYW1lLmV4dCcsXG4gICAgICdmaWxlbmFtZS5leHQ/cGFyYW0nLFxuICAgICAnZmlsZW5hbWUuZXh0I2hhc2gnLFxuICAgICAncGF0aC90by9maWxlbmFtZS5leHQnLFxuICAgICAncGF0aC90by9maWxlbmFtZS5leHQ/cGFyYW0nLFxuICAgICAncGF0aC90by9maWxlbmFtZS5leHQjaGFzaD9wYXJhbScsXG4gICAgICdwYXRoL3RvL2ZpbGVuYW1lLmV4dD9wYXJhbSNoYXNoJyxcbiAgIF1cbiAgIGFycmF5Lm1hcChzdHIgPT4gZ2V0RmlsZW5hbWVGcm9tUGF0aChzdHIpKVxuICpcbiAqIEBwYXJhbSAge1N0cmluZ30gcGF0aCB0aGUgcGF0aCdzIHN0cmluZ1xuICogQHJldHVybiB7U3RyaW5nfSAgICAgIGZpbGVuYW1lIHJldHVybmVkIHBhdGhcbiAqL1xudmFyIGdldEZpbGVuYW1lRnJvbVBhdGggPSBmdW5jdGlvbiAocGF0aCkge1xuICByZXR1cm4gcGF0aC5yZXBsYWNlKC9eLipbXFxcXFxcL118XFw/Lip8XFwjLiovZywgJycpO1xufVxuXG4vKipcbiAqIEV4dGVuZFxuICogQHVzZSBleHRlbmQoe30sIGRlZmF1bHRPYmplY3QsIG5ld09iamVjdCk7XG4gKiBAcGFyYW0gIHtPYmplY3R9IHRhcmdldCBhbiBvYmplY3RcbiAqIEByZXR1cm4ge09iamVjdH0gICAgICAgIGEgbmV3IG9iamVjdCB3aXRoIHZhbHVlcyBvZiBhbGwgYXJndW1lbnQgb2JqZWN0c1xuICovXG52YXIgZXh0ZW5kID0gZnVuY3Rpb24gKHRhcmdldCkge1xuICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7XG4gICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0YXJnZXQ7XG59O1xuXG5cbi8qKlxuICogRGVib3VuY2VcbiAqIEB1c2UgZGVib3VuY2Uoe30sIGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSk7XG4gKiBAcGFyYW0gIHtPYmplY3R9IHRhcmdldCBhbiBvYmplY3RcbiAqIEByZXR1cm4ge09iamVjdH0gICAgICAgIGEgbmV3IG9iamVjdCB3aXRoIHZhbHVlcyBvZiBhbGwgYXJndW1lbnQgb2JqZWN0c1xuICovXG52YXIgZGVib3VuY2UgPSBmdW5jdGlvbiAoZnVuYywgd2FpdCkge1xuICB2YXIgdGltZW91dDtcblxuICBpZiAodHlwZW9mIHdhaXQgPT09ICd1bmRlZmluZWQnKSB3YWl0ID0gMzAwO1xuXG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29udGV4dCA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgdmFyIGxhdGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICAgIC8vIGlmICghaW1tZWRpYXRlKSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgIH07XG4gIC8vIHZhciBjYWxsTm93ID0gaW1tZWRpYXRlICYmICF0aW1lb3V0O1xuICBjbGVhclRpbWVvdXQodGltZW91dCk7XG4gIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTtcbiAgLy8gaWYgKGNhbGxOb3cpIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gIH07XG59O1xuXG4vKipcbiAqIGlkZW50aWZ5Tm90TG9hZGVkSW1hZ2VzXG4gKiBAcGFyYW0gIHtPYmplY3R9IGNvbmZpZyBhIGN1c3RvbSB2YWxpZCBjbGFzc05hbWU7XG4gKi9cbnZhciBpZGVudGlmeU5vdExvYWRlZEltYWdlcyA9IGZ1bmN0aW9uIChjb25maWcpIHtcbiAgdmFyIGNmZyA9IHR5cGVvZiBjb25maWcgPT09ICdvYmplY3QnID8gY29uZmlnIDoge307XG4gIHZhciBlcnJvckNsYXNzID0gdHlwZW9mIGNmZy5lcnJvckNsYXNzID09PSAnc3RyaW5nJyA/IGNmZy5lcnJvckNsYXNzIDogJ2JzLW5vdC1sb2FkZWQnO1xuICB2YXIgaW1nU2VsZWN0b3IgPSB0eXBlb2YgY2ZnLmltZ1NlbGVjdG9yID09PSAnc3RyaW5nJyA/IGNmZy5pbWdTZWxlY3RvciA6ICdpbWcnO1xuXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGltZ1NlbGVjdG9yKSwgZnVuY3Rpb24gKGltZykge1xuICAgICAgdmFyIHRlc3RJbWcgPSBuZXcgSW1hZ2UoKTtcbiAgICAgIHRlc3RJbWcuc3JjID0gaW1nLnNyYztcbiAgICAgIHRlc3RJbWcub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpbWcuY2xhc3NMaXN0LnJlbW92ZShlcnJvckNsYXNzKTtcbiAgICAgIH07XG4gICAgICB0ZXN0SW1nLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGltZy5jbGFzc0xpc3QuYWRkKGVycm9yQ2xhc3MpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG4vKipcbiAqIFJlbG9hZCBGbGlja2l0eVxuICogQHBhcmFtICB7T2JqZWN0fSBmbGt0eSAgIGEgZmxpY2tpdHkgaW5zdGFuY2VcbiAqIEBwYXJhbSAge051bWJlcn0gdGltZW91dCB0aW1lb3V0IHRvIHJlbG9hZFxuICovXG52YXIgcmVsb2FkRmxrdHkgPSBmdW5jdGlvbiAoZmxrdHksIHRpbWVvdXQpIHtcbiAgdGltZW91dCA9IHR5cGVvZiB0aW1lb3V0ICE9PSAnbnVtYmVyJyA/IDEwMCA6IHRpbWVvdXQ7XG5cbiAgaWYgKHR5cGVvZiBmbGt0eSA9PT0gJ29iamVjdCcpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGZsa3R5LnJlbG9hZENlbGxzKCk7XG4gICAgICBmbGt0eS5yZXNpemUoKTtcbiAgICB9LCB0aW1lb3V0KTtcbiAgfVxufVxuIiwiLyoqXG4gKiBCcyBDb250ZW50Q2hhbmdlclxuICovXG52YXIgQnNDb250ZW50Q2hhbmdlciA9IChmdW5jdGlvbiAoKSB7XG4gIC8vIEVsZW1lbnRzXG4gIHZhciBlbGVtZW50cyA9IHt9O1xuICB2YXIgJCA9IGVsZW1lbnRzO1xuICAkLmJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG4gICQuc2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtY29udGVudC1jaGFuZ2VyLS1zZWxlY3RvcicpO1xuICAkLndyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtY29udGVudC1jaGFuZ2VyLS13cmFwcGVyJyk7XG5cbiAgaWYgKCEkLnNlbGVjdG9yIHx8ICEkLndyYXBwZXIpIHJldHVybjtcblxuICAkLmNvbnRlbnRzID0gJC53cmFwcGVyLmNoaWxkcmVuO1xuXG4gIC8vIENvbmZpZ1xuICB2YXIgY29uZmlnID0ge1xuICAgIGNvbnRlbnRIaWRkZW5DbGFzczogJ2JzLWlzLWhpZGRlbicsXG4gICAgY29udGVudERhdGFBY3RpdmU6ICdkYXRhLWNvbnRlbnQtY2hhbmdlci1hY3RpdmUnLFxuICAgIGNvbnRlbnREYXRhVGl0bGU6ICdkYXRhLWNvbnRlbnQtY2hhbmdlci10aXRsZScsXG4gICAgY29udGVudERhdGFJZDogJ2RhdGEtY29udGVudC1jaGFuZ2VyLWlkJyxcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBidWlsZFNlbGVjdE9wdGlvbnMoKTtcbiAgICAkLnNlbGVjdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHNob3dDb250ZW50KHRoaXMudmFsdWUpO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBidWlsZFNlbGVjdE9wdGlvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9wdGlvbnNTdHIgPSAkLnNlbGVjdG9yLmlubmVySFRNTDtcbiAgICB2YXIgb3B0aW9uc0FyciA9IFtdO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCgkLmNvbnRlbnRzLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIHZhciB0aXRsZSA9IGVsLmdldEF0dHJpYnV0ZShjb25maWcuY29udGVudERhdGFUaXRsZSk7XG4gICAgICB2YXIgaWQgPSBlbC5nZXRBdHRyaWJ1dGUoY29uZmlnLmNvbnRlbnREYXRhSWQpO1xuICAgICAgb3B0aW9uc0Fyci5wdXNoKCc8b3B0aW9uIHZhbHVlPVwiJyArIGlkICsgJ1wiPicgKyB0aXRsZSArICc8L29wdGlvbj4nKTtcbiAgICB9KTtcblxuICAgIG9wdGlvbnNTdHIgKz0gb3B0aW9uc0Fyci5qb2luKCcnKTtcbiAgICAkLnNlbGVjdG9yLmlubmVySFRNTCA9IG9wdGlvbnNTdHI7XG4gIH07XG5cbiAgdmFyIHNob3dDb250ZW50ID0gZnVuY3Rpb24gKGNvbnRlbnRJZCkge1xuICAgIHZhciBjb250ZW50ID0gJC53cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJ1snICsgY29uZmlnLmNvbnRlbnREYXRhSWQgKyAnPVwiJyArIGNvbnRlbnRJZCArICdcIl0nKTtcbiAgICB2YXIgY3VycmVudEFjdGl2ZSA9ICQud3JhcHBlci5xdWVyeVNlbGVjdG9yKCdbJyArIGNvbmZpZy5jb250ZW50RGF0YUFjdGl2ZSArICddJyk7XG5cbiAgICBjb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNvbnRlbnRIaWRkZW5DbGFzcyk7XG4gICAgY29udGVudC5zZXRBdHRyaWJ1dGUoY29uZmlnLmNvbnRlbnREYXRhQWN0aXZlLCAnJyk7XG5cbiAgICBpZiAoY3VycmVudEFjdGl2ZSkge1xuICAgICAgY3VycmVudEFjdGl2ZS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jb250ZW50SGlkZGVuQ2xhc3MpO1xuICAgICAgY3VycmVudEFjdGl2ZS5yZW1vdmVBdHRyaWJ1dGUoY29uZmlnLmNvbnRlbnREYXRhQWN0aXZlKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IENvbnRlbnRDaGFuZ2VyIENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWNvbnRlbnQtY2hhbmdlci0td3JhcHBlcicpLmxlbmd0aCkge1xuICAgIEJzQ29udGVudENoYW5nZXIuaW5pdCgpO1xuICB9XG59KTtcbiIsIi8qKlxuICogQnMgRHJvcGRvd25cbiAqIEByZXR1cm4gaW5pdCBmdW5jdGlvblxuICovXG52YXIgQnNEcm9wZG93biA9IGZ1bmN0aW9uICgpIHtcbiAgLy8gRWxlbWVudHNcbiAgdmFyIGVsZW1lbnRzID0ge307XG4gIHZhciAkID0gZWxlbWVudHM7XG4gICQuYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcbiAgJC50b2dnbGUgPSBudWxsO1xuICAkLmRyb3Bkb3duID0gbnVsbDtcblxuICAvLyBDb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBkcm9wZG93blR5cGU6IG51bGwsXG4gICAgZHJvcGRvd25FbGVtZW50OiBudWxsLFxuICAgIHRvZ2dsZUFjdGl2ZUNsYXNzOiAnYnMtaXMtYWN0aXZlJyxcbiAgICBkcm9wZG93bkFjdGl2ZUNsYXNzOiAnYnMtaXMtb3BlbicsXG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAodG9nZ2xlLCBvcHRpb25zKSB7XG4gICAgLy8gQ2hlY2sgaWYgYW4gZWxlbWVudCB0b2dnbGUgd2FzIHBhc3NlZFxuICAgIGlmICh0eXBlb2YgdG9nZ2xlICE9PSAndW5kZWZpbmVkJykgJC50b2dnbGUgPSB0b2dnbGU7XG4gICAgZWxzZSByZXR1cm47XG5cbiAgICAvLyBCeSBkZWZhdWx0LCBkcm9wZG93biBlbGVtZW50IGlzIG5leHQgZWxlbWVudCBzaWJsaW5nIG9mIHRvZ2dsZVxuICAgICQuZHJvcGRvd24gPSAkLnRvZ2dsZS5uZXh0RWxlbWVudFNpYmxpbmc7XG5cbiAgICAvLyBDaGVjayBpZiBvcHRpb25zIHdlcmUgcGFzc2VkXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgLy8gY29uZmlnXG4gICAgICBpZiAob3B0aW9ucy5kcm9wZG93blR5cGUpIGNvbmZpZy5kcm9wZG93blR5cGUgPSBvcHRpb25zLmRyb3Bkb3duVHlwZTtcbiAgICAgIGlmIChvcHRpb25zLnRvZ2dsZUFjdGl2ZUNsYXNzKSBjb25maWcudG9nZ2xlQWN0aXZlQ2xhc3MgPSBvcHRpb25zLnRvZ2dsZUFjdGl2ZUNsYXNzO1xuICAgICAgaWYgKG9wdGlvbnMuZHJvcGRvd25BY3RpdmVDbGFzcykgY29uZmlnLmRyb3Bkb3duQWN0aXZlQ2xhc3MgPSBvcHRpb25zLmRyb3Bkb3duQWN0aXZlQ2xhc3M7XG4gICAgICAvLyBlbGVtZW50c1xuICAgICAgaWYgKG9wdGlvbnMuZHJvcGRvd25FbGVtZW50KSAkLmRyb3Bkb3duID0gb3B0aW9ucy5kcm9wZG93bkVsZW1lbnQ7XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIGlmIHRvZ2dsZSBvciBkcm9wZG93biBub3QgZXhpc3RzXG4gICAgaWYgKCEkLnRvZ2dsZSkgcmV0dXJuO1xuICAgICQudG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlRHJvcGRvd24pO1xuXG4gICAgLy8gQ2xvc2UgZHJvcGRvd24gb24gY2xpY2sgb3V0c2lkZVxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYm9keSwgaHRtbCcpLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBkcm9wZG93bkFjdGl2ZSgpICYmXG4gICAgICAgICAgLy8gKCEkLmRyb3Bkb3duLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkgJiYgZHJvcGRvd25UeXBlICE9PSAnZmlsdGVyJykgJiZcbiAgICAgICAgICAhJC50b2dnbGUuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgIGNsb3NlRHJvcGRvd24oKTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciB0b2dnbGVEcm9wZG93biA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIWRyb3Bkb3duQWN0aXZlKCkpIG9wZW5Ecm9wZG93bigpO1xuICAgIGVsc2UgY2xvc2VEcm9wZG93bigpO1xuICB9O1xuXG4gIHZhciBvcGVuRHJvcGRvd24gPSBmdW5jdGlvbiAoKSB7XG4gICAgJC5kcm9wZG93bi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5kcm9wZG93bkFjdGl2ZUNsYXNzKTtcbiAgICAkLnRvZ2dsZS5jbGFzc0xpc3QuYWRkKGNvbmZpZy50b2dnbGVBY3RpdmVDbGFzcyk7XG4gIH07XG5cbiAgdmFyIGNsb3NlRHJvcGRvd24gPSBmdW5jdGlvbiAoKSB7XG4gICAgJC5kcm9wZG93bi5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5kcm9wZG93bkFjdGl2ZUNsYXNzKTtcbiAgICAkLnRvZ2dsZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy50b2dnbGVBY3RpdmVDbGFzcyk7XG4gIH07XG5cbiAgdmFyIGRyb3Bkb3duQWN0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAkLmRyb3Bkb3duLmNsYXNzTGlzdC5jb250YWlucyhjb25maWcuZHJvcGRvd25BY3RpdmVDbGFzcyk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufTtcblxuLyoqXG4gKiBJbml0IERyb3Bkb3duIENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfVxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgZHJvcGRvd25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWRyb3Bkb3duLS10b2dnbGUnKTtcbiAgaWYgKGRyb3Bkb3ducy5sZW5ndGgpIHtcbiAgICB2YXIgZHJvcGRvd24gPSBudWxsO1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZHJvcGRvd25zLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIGRyb3Bkb3duID0gbmV3IEJzRHJvcGRvd24oKTtcbiAgICAgIGRyb3Bkb3duLmluaXQoZWwpO1xuICAgIH0pO1xuICB9XG59KTtcbiIsIi8qKlxuICogRnVuw6fDo28gcGFyYSBjbGljYXIgZW0gYm90w7VlcyBlIGV4aWJpciBvIGNvbnRlw7pkbyByZWxhY2lvbmFkb1xuKi9cbnZhciBCc0V4cGFuZENvbnRlbnQgPSAoZnVuY3Rpb24gKCkge1xuICB2YXIgY29uZmlnID0ge1xuICAgIGVsOiBudWxsLFxuICAgIGJ1dHRvbjogbnVsbCxcbiAgICBjb2xsYXBzZUhlaWdodDogMzAwLFxuICAgIG1heEhlaWdodDogMTAwMCxcbiAgICBjb250ZW50SGVpZ2h0OiAwLFxuICAgIGNvbGxhcHNlQ2xhc3M6ICdicy1pcy1jb2xsYXBzZWQnLFxuICAgIGJ1dHRvbkNsYXNzOiAnYnMtcG9ydGFsLWNvbnRlbnRfX2V4cGFuZC1idXR0b24nLFxuICAgIGJ1dHRvblRleHQ6ICdWZXIgdHVkbycsXG4gIH07XG5cbiAgLyoqXG4gICAqIEluaWNpYWxpemEgYSBmdW7Dp8Ojb1xuICAgKiBAcGFyYW0ge09iamVjdH0gZWwgYSBET00gZWxlbWVudFxuICAqL1xuICB2YXIgaW5pdCA9IGZ1bmN0aW9uIChlbCkge1xuICAgIC8vIGNoZWNrIGlmIGVsZW1lbnQgZXhpc3RcbiAgICBpZiAoIWVsIHx8IHR5cGVvZiBlbCAhPT0gJ29iamVjdCcpIHJldHVybjtcbiAgICAvLyBjaGVjayBpZiBoZWlnaHQgaXMgZ3JlYXRlciB0aGFuIGNvbmZpZyBtYXhIZWlnaHRcbiAgICBpZiAoZWwub2Zmc2V0SGVpZ2h0IDwgY29uZmlnLm1heEhlaWdodCkgcmV0dXJuO1xuXG4gICAgLy8gc2V0IGNvbnRlbnQgYW5kIGJ1dHRvbiBlbGVtZW50cyB0byBjb25maWdcbiAgICBjb25maWcuZWwgPSBlbDtcbiAgICBjb25maWcuYnV0dG9uID0gY3JlYXRlRXhwYW5kQnV0dG9uKCk7XG5cbiAgICAvLyBzZXQgY29udGVudCBhbmQgYnV0dG9uIGVsZW1lbnRzIHRvIGNvbmZpZ1xuICAgIGVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNvbGxhcHNlQ2xhc3MpO1xuICAgIGVsLnN0eWxlLmhlaWdodCA9IGNvbmZpZy5jb2xsYXBzZUhlaWdodCArICdweCc7XG4gICAgY29uZmlnLmNvbnRlbnRIZWlnaHQgPSBlbC5oZWlnaHQ7XG5cbiAgICAvLyBhcHBlbmQgYnV0dG9uIHRvIGVsZW1lbnRcbiAgICBlbC5hcHBlbmRDaGlsZChjb25maWcuYnV0dG9uKTtcbiAgfTtcblxuICAvKipcbiAgICogQ3JlYXRlIGV4cGFuZCBCdXR0b25cbiAgICogQHJldHVybiB7W3R5cGVdfSBbZGVzY3JpcHRpb25dXG4gICAqL1xuICB2YXIgY3JlYXRlRXhwYW5kQnV0dG9uID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcblxuICAgIC8vIHNldCBidXR0b24gYXR0cmlidXRlc1xuICAgIGJ1dHRvbi50eXBlID0gJ2J1dHRvbic7XG4gICAgYnV0dG9uLmlubmVySFRNTCA9IGNvbmZpZy5idXR0b25UZXh0O1xuICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5idXR0b25DbGFzcyk7XG5cbiAgICAvLyBhZGQgbGlzdGVuZXIgdG8gZXhwYW5kIENvbnRlbnQgb25DbGlja1xuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV4cGFuZENvbnRlbnQpO1xuXG4gICAgcmV0dXJuIGJ1dHRvbjtcbiAgfTtcblxuICAvKipcbiAgICogRXhwYW5kIENvbnRlbnRcbiAgICovXG4gIHZhciBleHBhbmRDb250ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIHZhciBoZWlnaHQgPSBjb25maWcuZWwuc2Nyb2xsSGVpZ2h0O1xuICAgIGNvbmZpZy5lbC5zdHlsZS5oZWlnaHQgPSAnYXV0byc7XG4gICAgY29uZmlnLmVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNvbGxhcHNlQ2xhc3MpO1xuICAgIGNvbmZpZy5idXR0b24ucmVtb3ZlKCk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgZWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtZXhwYW5kYWJsZS1jb250ZW50Jyk7XG5cbiAgaWYgKGVsZW1lbnRzLmxlbmd0aCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZWxlbWVudHMsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgQnNFeHBhbmRDb250ZW50LmluaXQoZWwpO1xuICAgIH0pO1xuICB9XG59KTtcbiIsIihmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG4gIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IGZhY3RvcnkoKSA6XG4gIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6XG4gIChmYWN0b3J5KCkpO1xufSh0aGlzLCAoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbiAgLyoqXG4gICAqIEFwcGxpZXMgdGhlIDpmb2N1cy12aXNpYmxlIHBvbHlmaWxsIGF0IHRoZSBnaXZlbiBzY29wZS5cbiAgICogQSBzY29wZSBpbiB0aGlzIGNhc2UgaXMgZWl0aGVyIHRoZSB0b3AtbGV2ZWwgRG9jdW1lbnQgb3IgYSBTaGFkb3cgUm9vdC5cbiAgICpcbiAgICogQHBhcmFtIHsoRG9jdW1lbnR8U2hhZG93Um9vdCl9IHNjb3BlXG4gICAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL1dJQ0cvZm9jdXMtdmlzaWJsZVxuICAgKi9cbiAgZnVuY3Rpb24gYXBwbHlGb2N1c1Zpc2libGVQb2x5ZmlsbChzY29wZSkge1xuICAgIHZhciBoYWRLZXlib2FyZEV2ZW50ID0gdHJ1ZTtcbiAgICB2YXIgaGFkRm9jdXNWaXNpYmxlUmVjZW50bHkgPSBmYWxzZTtcbiAgICB2YXIgaGFkRm9jdXNWaXNpYmxlUmVjZW50bHlUaW1lb3V0ID0gbnVsbDtcblxuICAgIHZhciBpbnB1dFR5cGVzV2hpdGVsaXN0ID0ge1xuICAgICAgdGV4dDogdHJ1ZSxcbiAgICAgIHNlYXJjaDogdHJ1ZSxcbiAgICAgIHVybDogdHJ1ZSxcbiAgICAgIHRlbDogdHJ1ZSxcbiAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgcGFzc3dvcmQ6IHRydWUsXG4gICAgICBudW1iZXI6IHRydWUsXG4gICAgICBkYXRlOiB0cnVlLFxuICAgICAgbW9udGg6IHRydWUsXG4gICAgICB3ZWVrOiB0cnVlLFxuICAgICAgdGltZTogdHJ1ZSxcbiAgICAgIGRhdGV0aW1lOiB0cnVlLFxuICAgICAgJ2RhdGV0aW1lLWxvY2FsJzogdHJ1ZVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgZnVuY3Rpb24gZm9yIGxlZ2FjeSBicm93c2VycyBhbmQgaWZyYW1lcyB3aGljaCBzb21ldGltZXMgZm9jdXNcbiAgICAgKiBlbGVtZW50cyBsaWtlIGRvY3VtZW50LCBib2R5LCBhbmQgbm9uLWludGVyYWN0aXZlIFNWRy5cbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNWYWxpZEZvY3VzVGFyZ2V0KGVsKSB7XG4gICAgICBpZiAoXG4gICAgICAgIGVsICYmXG4gICAgICAgIGVsICE9PSBkb2N1bWVudCAmJlxuICAgICAgICBlbC5ub2RlTmFtZSAhPT0gJ0hUTUwnICYmXG4gICAgICAgIGVsLm5vZGVOYW1lICE9PSAnQk9EWScgJiZcbiAgICAgICAgJ2NsYXNzTGlzdCcgaW4gZWwgJiZcbiAgICAgICAgJ2NvbnRhaW5zJyBpbiBlbC5jbGFzc0xpc3RcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB3aGV0aGVyIHRoZSBnaXZlbiBlbGVtZW50IHNob3VsZCBhdXRvbWF0aWNhbGx5IHRyaWdnZXIgdGhlXG4gICAgICogYGZvY3VzLXZpc2libGVgIGNsYXNzIGJlaW5nIGFkZGVkLCBpLmUuIHdoZXRoZXIgaXQgc2hvdWxkIGFsd2F5cyBtYXRjaFxuICAgICAqIGA6Zm9jdXMtdmlzaWJsZWAgd2hlbiBmb2N1c2VkLlxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZvY3VzVHJpZ2dlcnNLZXlib2FyZE1vZGFsaXR5KGVsKSB7XG4gICAgICB2YXIgdHlwZSA9IGVsLnR5cGU7XG4gICAgICB2YXIgdGFnTmFtZSA9IGVsLnRhZ05hbWU7XG5cbiAgICAgIGlmICh0YWdOYW1lID09PSAnSU5QVVQnICYmIGlucHV0VHlwZXNXaGl0ZWxpc3RbdHlwZV0gJiYgIWVsLnJlYWRPbmx5KSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAodGFnTmFtZSA9PT0gJ1RFWFRBUkVBJyAmJiAhZWwucmVhZE9ubHkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChlbC5pc0NvbnRlbnRFZGl0YWJsZSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCB0aGUgYGZvY3VzLXZpc2libGVgIGNsYXNzIHRvIHRoZSBnaXZlbiBlbGVtZW50IGlmIGl0IHdhcyBub3QgYWRkZWQgYnlcbiAgICAgKiB0aGUgYXV0aG9yLlxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZGRGb2N1c1Zpc2libGVDbGFzcyhlbCkge1xuICAgICAgaWYgKGVsLmNsYXNzTGlzdC5jb250YWlucygnZm9jdXMtdmlzaWJsZScpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2ZvY3VzLXZpc2libGUnKTtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0YS1mb2N1cy12aXNpYmxlLWFkZGVkJywgJycpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGUgYGZvY3VzLXZpc2libGVgIGNsYXNzIGZyb20gdGhlIGdpdmVuIGVsZW1lbnQgaWYgaXQgd2FzIG5vdFxuICAgICAqIG9yaWdpbmFsbHkgYWRkZWQgYnkgdGhlIGF1dGhvci5cbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVtb3ZlRm9jdXNWaXNpYmxlQ2xhc3MoZWwpIHtcbiAgICAgIGlmICghZWwuaGFzQXR0cmlidXRlKCdkYXRhLWZvY3VzLXZpc2libGUtYWRkZWQnKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdmb2N1cy12aXNpYmxlJyk7XG4gICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtZm9jdXMtdmlzaWJsZS1hZGRlZCcpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElmIHRoZSBtb3N0IHJlY2VudCB1c2VyIGludGVyYWN0aW9uIHdhcyB2aWEgdGhlIGtleWJvYXJkO1xuICAgICAqIGFuZCB0aGUga2V5IHByZXNzIGRpZCBub3QgaW5jbHVkZSBhIG1ldGEsIGFsdC9vcHRpb24sIG9yIGNvbnRyb2wga2V5O1xuICAgICAqIHRoZW4gdGhlIG1vZGFsaXR5IGlzIGtleWJvYXJkLiBPdGhlcndpc2UsIHRoZSBtb2RhbGl0eSBpcyBub3Qga2V5Ym9hcmQuXG4gICAgICogQXBwbHkgYGZvY3VzLXZpc2libGVgIHRvIGFueSBjdXJyZW50IGFjdGl2ZSBlbGVtZW50IGFuZCBrZWVwIHRyYWNrXG4gICAgICogb2Ygb3VyIGtleWJvYXJkIG1vZGFsaXR5IHN0YXRlIHdpdGggYGhhZEtleWJvYXJkRXZlbnRgLlxuICAgICAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9uS2V5RG93bihlKSB7XG4gICAgICBpZiAoZS5tZXRhS2V5IHx8IGUuYWx0S2V5IHx8IGUuY3RybEtleSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChpc1ZhbGlkRm9jdXNUYXJnZXQoc2NvcGUuYWN0aXZlRWxlbWVudCkpIHtcbiAgICAgICAgYWRkRm9jdXNWaXNpYmxlQ2xhc3Moc2NvcGUuYWN0aXZlRWxlbWVudCk7XG4gICAgICB9XG5cbiAgICAgIGhhZEtleWJvYXJkRXZlbnQgPSB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElmIGF0IGFueSBwb2ludCBhIHVzZXIgY2xpY2tzIHdpdGggYSBwb2ludGluZyBkZXZpY2UsIGVuc3VyZSB0aGF0IHdlIGNoYW5nZVxuICAgICAqIHRoZSBtb2RhbGl0eSBhd2F5IGZyb20ga2V5Ym9hcmQuXG4gICAgICogVGhpcyBhdm9pZHMgdGhlIHNpdHVhdGlvbiB3aGVyZSBhIHVzZXIgcHJlc3NlcyBhIGtleSBvbiBhbiBhbHJlYWR5IGZvY3VzZWRcbiAgICAgKiBlbGVtZW50LCBhbmQgdGhlbiBjbGlja3Mgb24gYSBkaWZmZXJlbnQgZWxlbWVudCwgZm9jdXNpbmcgaXQgd2l0aCBhXG4gICAgICogcG9pbnRpbmcgZGV2aWNlLCB3aGlsZSB3ZSBzdGlsbCB0aGluayB3ZSdyZSBpbiBrZXlib2FyZCBtb2RhbGl0eS5cbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBlXG4gICAgICovXG4gICAgZnVuY3Rpb24gb25Qb2ludGVyRG93bihlKSB7XG4gICAgICBoYWRLZXlib2FyZEV2ZW50ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT24gYGZvY3VzYCwgYWRkIHRoZSBgZm9jdXMtdmlzaWJsZWAgY2xhc3MgdG8gdGhlIHRhcmdldCBpZjpcbiAgICAgKiAtIHRoZSB0YXJnZXQgcmVjZWl2ZWQgZm9jdXMgYXMgYSByZXN1bHQgb2Yga2V5Ym9hcmQgbmF2aWdhdGlvbiwgb3JcbiAgICAgKiAtIHRoZSBldmVudCB0YXJnZXQgaXMgYW4gZWxlbWVudCB0aGF0IHdpbGwgbGlrZWx5IHJlcXVpcmUgaW50ZXJhY3Rpb25cbiAgICAgKiAgIHZpYSB0aGUga2V5Ym9hcmQgKGUuZy4gYSB0ZXh0IGJveClcbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBlXG4gICAgICovXG4gICAgZnVuY3Rpb24gb25Gb2N1cyhlKSB7XG4gICAgICAvLyBQcmV2ZW50IElFIGZyb20gZm9jdXNpbmcgdGhlIGRvY3VtZW50IG9yIEhUTUwgZWxlbWVudC5cbiAgICAgIGlmICghaXNWYWxpZEZvY3VzVGFyZ2V0KGUudGFyZ2V0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChoYWRLZXlib2FyZEV2ZW50IHx8IGZvY3VzVHJpZ2dlcnNLZXlib2FyZE1vZGFsaXR5KGUudGFyZ2V0KSkge1xuICAgICAgICBhZGRGb2N1c1Zpc2libGVDbGFzcyhlLnRhcmdldCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT24gYGJsdXJgLCByZW1vdmUgdGhlIGBmb2N1cy12aXNpYmxlYCBjbGFzcyBmcm9tIHRoZSB0YXJnZXQuXG4gICAgICogQHBhcmFtIHtFdmVudH0gZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9uQmx1cihlKSB7XG4gICAgICBpZiAoIWlzVmFsaWRGb2N1c1RhcmdldChlLnRhcmdldCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZm9jdXMtdmlzaWJsZScpIHx8XG4gICAgICAgIGUudGFyZ2V0Lmhhc0F0dHJpYnV0ZSgnZGF0YS1mb2N1cy12aXNpYmxlLWFkZGVkJylcbiAgICAgICkge1xuICAgICAgICAvLyBUbyBkZXRlY3QgYSB0YWIvd2luZG93IHN3aXRjaCwgd2UgbG9vayBmb3IgYSBibHVyIGV2ZW50IGZvbGxvd2VkXG4gICAgICAgIC8vIHJhcGlkbHkgYnkgYSB2aXNpYmlsaXR5IGNoYW5nZS5cbiAgICAgICAgLy8gSWYgd2UgZG9uJ3Qgc2VlIGEgdmlzaWJpbGl0eSBjaGFuZ2Ugd2l0aGluIDEwMG1zLCBpdCdzIHByb2JhYmx5IGFcbiAgICAgICAgLy8gcmVndWxhciBmb2N1cyBjaGFuZ2UuXG4gICAgICAgIGhhZEZvY3VzVmlzaWJsZVJlY2VudGx5ID0gdHJ1ZTtcbiAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChoYWRGb2N1c1Zpc2libGVSZWNlbnRseVRpbWVvdXQpO1xuICAgICAgICBoYWRGb2N1c1Zpc2libGVSZWNlbnRseVRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBoYWRGb2N1c1Zpc2libGVSZWNlbnRseSA9IGZhbHNlO1xuICAgICAgICB9LCAxMDApO1xuICAgICAgICByZW1vdmVGb2N1c1Zpc2libGVDbGFzcyhlLnRhcmdldCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWYgdGhlIHVzZXIgY2hhbmdlcyB0YWJzLCBrZWVwIHRyYWNrIG9mIHdoZXRoZXIgb3Igbm90IHRoZSBwcmV2aW91c2x5XG4gICAgICogZm9jdXNlZCBlbGVtZW50IGhhZCAuZm9jdXMtdmlzaWJsZS5cbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBlXG4gICAgICovXG4gICAgZnVuY3Rpb24gb25WaXNpYmlsaXR5Q2hhbmdlKGUpIHtcbiAgICAgIGlmIChkb2N1bWVudC52aXNpYmlsaXR5U3RhdGUgPT09ICdoaWRkZW4nKSB7XG4gICAgICAgIC8vIElmIHRoZSB0YWIgYmVjb21lcyBhY3RpdmUgYWdhaW4sIHRoZSBicm93c2VyIHdpbGwgaGFuZGxlIGNhbGxpbmcgZm9jdXNcbiAgICAgICAgLy8gb24gdGhlIGVsZW1lbnQgKFNhZmFyaSBhY3R1YWxseSBjYWxscyBpdCB0d2ljZSkuXG4gICAgICAgIC8vIElmIHRoaXMgdGFiIGNoYW5nZSBjYXVzZWQgYSBibHVyIG9uIGFuIGVsZW1lbnQgd2l0aCBmb2N1cy12aXNpYmxlLFxuICAgICAgICAvLyByZS1hcHBseSB0aGUgY2xhc3Mgd2hlbiB0aGUgdXNlciBzd2l0Y2hlcyBiYWNrIHRvIHRoZSB0YWIuXG4gICAgICAgIGlmIChoYWRGb2N1c1Zpc2libGVSZWNlbnRseSkge1xuICAgICAgICAgIGhhZEtleWJvYXJkRXZlbnQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGFkZEluaXRpYWxQb2ludGVyTW92ZUxpc3RlbmVycygpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhIGdyb3VwIG9mIGxpc3RlbmVycyB0byBkZXRlY3QgdXNhZ2Ugb2YgYW55IHBvaW50aW5nIGRldmljZXMuXG4gICAgICogVGhlc2UgbGlzdGVuZXJzIHdpbGwgYmUgYWRkZWQgd2hlbiB0aGUgcG9seWZpbGwgZmlyc3QgbG9hZHMsIGFuZCBhbnl0aW1lXG4gICAgICogdGhlIHdpbmRvdyBpcyBibHVycmVkLCBzbyB0aGF0IHRoZXkgYXJlIGFjdGl2ZSB3aGVuIHRoZSB3aW5kb3cgcmVnYWluc1xuICAgICAqIGZvY3VzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZEluaXRpYWxQb2ludGVyTW92ZUxpc3RlbmVycygpIHtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG9uSW5pdGlhbFBvaW50ZXJNb3ZlKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIG9uSW5pdGlhbFBvaW50ZXJNb3ZlKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbkluaXRpYWxQb2ludGVyTW92ZSk7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIG9uSW5pdGlhbFBvaW50ZXJNb3ZlKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJkb3duJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIG9uSW5pdGlhbFBvaW50ZXJNb3ZlKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZUluaXRpYWxQb2ludGVyTW92ZUxpc3RlbmVycygpIHtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG9uSW5pdGlhbFBvaW50ZXJNb3ZlKTtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIG9uSW5pdGlhbFBvaW50ZXJNb3ZlKTtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBvbkluaXRpYWxQb2ludGVyTW92ZSk7XG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIG9uSW5pdGlhbFBvaW50ZXJNb3ZlKTtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJkb3duJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIG9uSW5pdGlhbFBvaW50ZXJNb3ZlKTtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgb25Jbml0aWFsUG9pbnRlck1vdmUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdoZW4gdGhlIHBvbGZ5aWxsIGZpcnN0IGxvYWRzLCBhc3N1bWUgdGhlIHVzZXIgaXMgaW4ga2V5Ym9hcmQgbW9kYWxpdHkuXG4gICAgICogSWYgYW55IGV2ZW50IGlzIHJlY2VpdmVkIGZyb20gYSBwb2ludGluZyBkZXZpY2UgKGUuZy4gbW91c2UsIHBvaW50ZXIsXG4gICAgICogdG91Y2gpLCB0dXJuIG9mZiBrZXlib2FyZCBtb2RhbGl0eS5cbiAgICAgKiBUaGlzIGFjY291bnRzIGZvciBzaXR1YXRpb25zIHdoZXJlIGZvY3VzIGVudGVycyB0aGUgcGFnZSBmcm9tIHRoZSBVUkwgYmFyLlxuICAgICAqIEBwYXJhbSB7RXZlbnR9IGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBvbkluaXRpYWxQb2ludGVyTW92ZShlKSB7XG4gICAgICAvLyBXb3JrIGFyb3VuZCBhIFNhZmFyaSBxdWlyayB0aGF0IGZpcmVzIGEgbW91c2Vtb3ZlIG9uIDxodG1sPiB3aGVuZXZlciB0aGVcbiAgICAgIC8vIHdpbmRvdyBibHVycywgZXZlbiBpZiB5b3UncmUgdGFiYmluZyBvdXQgb2YgdGhlIHBhZ2UuIMKvXFxfKOODhClfL8KvXG4gICAgICBpZiAoZS50YXJnZXQubm9kZU5hbWUgJiYgZS50YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2h0bWwnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaGFkS2V5Ym9hcmRFdmVudCA9IGZhbHNlO1xuICAgICAgcmVtb3ZlSW5pdGlhbFBvaW50ZXJNb3ZlTGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgLy8gRm9yIHNvbWUga2luZHMgb2Ygc3RhdGUsIHdlIGFyZSBpbnRlcmVzdGVkIGluIGNoYW5nZXMgYXQgdGhlIGdsb2JhbCBzY29wZVxuICAgIC8vIG9ubHkuIEZvciBleGFtcGxlLCBnbG9iYWwgcG9pbnRlciBpbnB1dCwgZ2xvYmFsIGtleSBwcmVzc2VzIGFuZCBnbG9iYWxcbiAgICAvLyB2aXNpYmlsaXR5IGNoYW5nZSBzaG91bGQgYWZmZWN0IHRoZSBzdGF0ZSBhdCBldmVyeSBzY29wZTpcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgb25LZXlEb3duLCB0cnVlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBvblBvaW50ZXJEb3duLCB0cnVlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsIG9uUG9pbnRlckRvd24sIHRydWUpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBvblBvaW50ZXJEb3duLCB0cnVlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd2aXNpYmlsaXR5Y2hhbmdlJywgb25WaXNpYmlsaXR5Q2hhbmdlLCB0cnVlKTtcblxuICAgIGFkZEluaXRpYWxQb2ludGVyTW92ZUxpc3RlbmVycygpO1xuXG4gICAgLy8gRm9yIGZvY3VzIGFuZCBibHVyLCB3ZSBzcGVjaWZpY2FsbHkgY2FyZSBhYm91dCBzdGF0ZSBjaGFuZ2VzIGluIHRoZSBsb2NhbFxuICAgIC8vIHNjb3BlLiBUaGlzIGlzIGJlY2F1c2UgZm9jdXMgLyBibHVyIGV2ZW50cyB0aGF0IG9yaWdpbmF0ZSBmcm9tIHdpdGhpbiBhXG4gICAgLy8gc2hhZG93IHJvb3QgYXJlIG5vdCByZS1kaXNwYXRjaGVkIGZyb20gdGhlIGhvc3QgZWxlbWVudCBpZiBpdCB3YXMgYWxyZWFkeVxuICAgIC8vIHRoZSBhY3RpdmUgZWxlbWVudCBpbiBpdHMgb3duIHNjb3BlOlxuICAgIHNjb3BlLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgb25Gb2N1cywgdHJ1ZSk7XG4gICAgc2NvcGUuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIG9uQmx1ciwgdHJ1ZSk7XG5cbiAgICAvLyBXZSBkZXRlY3QgdGhhdCBhIG5vZGUgaXMgYSBTaGFkb3dSb290IGJ5IGVuc3VyaW5nIHRoYXQgaXQgaXMgYVxuICAgIC8vIERvY3VtZW50RnJhZ21lbnQgYW5kIGFsc28gaGFzIGEgaG9zdCBwcm9wZXJ0eS4gVGhpcyBjaGVjayBjb3ZlcnMgbmF0aXZlXG4gICAgLy8gaW1wbGVtZW50YXRpb24gYW5kIHBvbHlmaWxsIGltcGxlbWVudGF0aW9uIHRyYW5zcGFyZW50bHkuIElmIHdlIG9ubHkgY2FyZWRcbiAgICAvLyBhYm91dCB0aGUgbmF0aXZlIGltcGxlbWVudGF0aW9uLCB3ZSBjb3VsZCBqdXN0IGNoZWNrIGlmIHRoZSBzY29wZSB3YXNcbiAgICAvLyBhbiBpbnN0YW5jZSBvZiBhIFNoYWRvd1Jvb3QuXG4gICAgaWYgKHNjb3BlLm5vZGVUeXBlID09PSBOb2RlLkRPQ1VNRU5UX0ZSQUdNRU5UX05PREUgJiYgc2NvcGUuaG9zdCkge1xuICAgICAgLy8gU2luY2UgYSBTaGFkb3dSb290IGlzIGEgc3BlY2lhbCBraW5kIG9mIERvY3VtZW50RnJhZ21lbnQsIGl0IGRvZXMgbm90XG4gICAgICAvLyBoYXZlIGEgcm9vdCBlbGVtZW50IHRvIGFkZCBhIGNsYXNzIHRvLiBTbywgd2UgYWRkIHRoaXMgYXR0cmlidXRlIHRvIHRoZVxuICAgICAgLy8gaG9zdCBlbGVtZW50IGluc3RlYWQ6XG4gICAgICBzY29wZS5ob3N0LnNldEF0dHJpYnV0ZSgnZGF0YS1qcy1mb2N1cy12aXNpYmxlJywgJycpO1xuICAgIH0gZWxzZSBpZiAoc2NvcGUubm9kZVR5cGUgPT09IE5vZGUuRE9DVU1FTlRfTk9ERSkge1xuICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2pzLWZvY3VzLXZpc2libGUnKTtcbiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtanMtZm9jdXMtdmlzaWJsZScsICcnKTtcbiAgICB9XG4gIH1cblxuICAvLyBJdCBpcyBpbXBvcnRhbnQgdG8gd3JhcCBhbGwgcmVmZXJlbmNlcyB0byBnbG9iYWwgd2luZG93IGFuZCBkb2N1bWVudCBpblxuICAvLyB0aGVzZSBjaGVja3MgdG8gc3VwcG9ydCBzZXJ2ZXItc2lkZSByZW5kZXJpbmcgdXNlIGNhc2VzXG4gIC8vIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL1dJQ0cvZm9jdXMtdmlzaWJsZS9pc3N1ZXMvMTk5XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgLy8gTWFrZSB0aGUgcG9seWZpbGwgaGVscGVyIGdsb2JhbGx5IGF2YWlsYWJsZS4gVGhpcyBjYW4gYmUgdXNlZCBhcyBhIHNpZ25hbFxuICAgIC8vIHRvIGludGVyZXN0ZWQgbGlicmFyaWVzIHRoYXQgd2lzaCB0byBjb29yZGluYXRlIHdpdGggdGhlIHBvbHlmaWxsIGZvciBlLmcuLFxuICAgIC8vIGFwcGx5aW5nIHRoZSBwb2x5ZmlsbCB0byBhIHNoYWRvdyByb290OlxuICAgIHdpbmRvdy5hcHBseUZvY3VzVmlzaWJsZVBvbHlmaWxsID0gYXBwbHlGb2N1c1Zpc2libGVQb2x5ZmlsbDtcblxuICAgIC8vIE5vdGlmeSBpbnRlcmVzdGVkIGxpYnJhcmllcyBvZiB0aGUgcG9seWZpbGwncyBwcmVzZW5jZSwgaW4gY2FzZSB0aGVcbiAgICAvLyBwb2x5ZmlsbCB3YXMgbG9hZGVkIGxhemlseTpcbiAgICB2YXIgZXZlbnQ7XG5cbiAgICB0cnkge1xuICAgICAgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2ZvY3VzLXZpc2libGUtcG9seWZpbGwtcmVhZHknKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gSUUxMSBkb2VzIG5vdCBzdXBwb3J0IHVzaW5nIEN1c3RvbUV2ZW50IGFzIGEgY29uc3RydWN0b3IgZGlyZWN0bHk6XG4gICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgICAgZXZlbnQuaW5pdEN1c3RvbUV2ZW50KCdmb2N1cy12aXNpYmxlLXBvbHlmaWxsLXJlYWR5JywgZmFsc2UsIGZhbHNlLCB7fSk7XG4gICAgfVxuXG4gICAgd2luZG93LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyBBcHBseSB0aGUgcG9seWZpbGwgdG8gdGhlIGdsb2JhbCBkb2N1bWVudCwgc28gdGhhdCBubyBKYXZhU2NyaXB0XG4gICAgLy8gY29vcmRpbmF0aW9uIGlzIHJlcXVpcmVkIHRvIHVzZSB0aGUgcG9seWZpbGwgaW4gdGhlIHRvcC1sZXZlbCBkb2N1bWVudDpcbiAgICBhcHBseUZvY3VzVmlzaWJsZVBvbHlmaWxsKGRvY3VtZW50KTtcbiAgfVxuXG59KSkpO1xuIiwiLyoqXG4gKiBCcyBGb3Jtc1xuICogQHJldHVybiBpbml0IGZ1bmN0aW9uXG4gKi9cbnZhciBCc0Zvcm1zID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gRWxlbWVudHNcbiAgdmFyIGVsZW1lbnRzID0ge307XG4gIHZhciAkID0gZWxlbWVudHM7XG4gICQuYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcbiAgJC5mb3JtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2Zvcm0nKTtcbiAgJC50b2dnbGVQYXNzd29yZFZhbHVlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXRvZ2dsZS1wYXNzd29yZC12YWx1ZScpO1xuICAkLnRvZ2dsZUluZm9WYWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy10b2dnbGUtaW5mby12YWx1ZScpO1xuICAkLnRvZ2dsZUluZm9Db250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWluZm8tdmFsdWUnKTtcbiAgJC5vdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLW92ZXJsYXknKTtcbiAgJC50b2dnbGVUZWxNYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0W2RhdGEtdGVsXScpO1xuICAkLnJldmVhbFRlbGVwaG9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1yZXZlYWwtdGVsZXBob25lJyk7XG4gIC8vICQuZm9jdXNDYWxlbmRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W2RhdGEtdHlwZT1cImRhdGVwaWNrZXJcIl0nKTtcbiAgJC5hZGFwdGl2ZVBsYWNlaG9sZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWZvcm1fX2xhYmVsLS1hZGFwdGl2ZSBpbnB1dCwgYnMtZm9ybV9fbGFiZWwtLWFkYXB0aXZlIHRleHRhcmVhJyk7XG4gICQuaW5wdXRGaWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWZvcm1fX2NvbnRyb2wtLWZpbGUnKTtcbiAgJC5maWxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtaW5wdXQtZmlsZScpO1xuICAkLmluZm9BY3RpdmUgPSAnYnMtYWN0aXZlJztcbiAgJC5vdmVybGF5QWN0aXZlID0gJ2JzLWlzLXZpc2libGUnO1xuICAkLmhhc0ZpbGUgPSAnYnMtaGFzLWZpbGUnO1xuICAkLnJlbW92ZUZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtcmVtb3ZlLWZpbGUnKTtcblxuICAvLyBDb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBwYXNzd29yZFZpc2libGVDbGFzczogJ2JzLWZvcm1fX3Bhc3N3b3JkLS1pcy12aXNpYmxlJyxcbiAgICBhZGFwdGl2ZVBsYWNlaG9sZGVyVmFsaWRDbGFzczogJ2JzLWZvcm1fX2ZpZWxkLS1ub3QtZW1wdHknLFxuICAgIGRhdGVwaWNrZXI6IHt9LFxuICAgIGRhdGVwaWNrZXJPcHRpb25zOiB7fSxcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIGlmICgkLnRvZ2dsZVBhc3N3b3JkVmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCgkLnRvZ2dsZVBhc3N3b3JkVmFsdWUsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZUlucHV0UGFzc3dvcmRWYWx1ZSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoJC50b2dnbGVJbmZvVmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCgkLnRvZ2dsZUluZm9WYWx1ZSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlVGl0bGVJbmZvVmFsdWUpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKCQub3ZlcmxheSkge1xuICAgICAgJC5vdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VUaXRsZUluZm9WYWx1ZSk7XG4gICAgfVxuXG4gICAgaWYgKCQucmV2ZWFsVGVsZXBob25lKSAkLnJldmVhbFRlbGVwaG9uZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJldmVhbFRlbGVwaG9uZUZpZWxkKTtcblxuICAgIGlmICgkLnRvZ2dsZVRlbE1hc2subGVuZ3RoID4gMCkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCgkLnRvZ2dsZVRlbE1hc2ssIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBkYXRhVGVsID0gdGhpcy5kYXRhc2V0LnRlbDtcbiAgICAgICAgICB2YXIgdmFsdWVUZWwgPSBlLnZhbHVlO1xuICAgICAgICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W2RhdGEtdGVsPScgKyBkYXRhVGVsICsgJ10nKTtcblxuICAgICAgICAgIGlmICh2YWx1ZVRlbCAhPT0gNTUpIHtcbiAgICAgICAgICAgIElucHV0TWFza3MuZGVzdHJveShpbnB1dCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIElucHV0TWFza3MudXBkYXRlKGlucHV0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gaWYgKCQuZm9jdXNDYWxlbmRhci5sZW5ndGggPiAwKSB7XG4gICAgLy8gICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKCQuZm9jdXNDYWxlbmRhciwgZnVuY3Rpb24gKGVsKSB7XG4gICAgLy8gICAgIHZhciBpbnB1dElkID0gZWwuZ2V0QXR0cmlidXRlKCdpZCcpO1xuICAgIC8vICAgICB2YXIgdG9nZ2xlQ2FsZW5kYXIgPSBlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy10b2dnbGUtZGF0ZXBpY2tlcicpO1xuXG4gICAgLy8gICAgIGNvbmZpZy5kYXRlcGlja2VyW2lucHV0SWRdID0gbmV3IFBpa2FkYXkoe1xuICAgIC8vICAgICAgIGJvdW5kOiB0cnVlLFxuICAgIC8vICAgICAgIGZpZWxkOiBlbCxcbiAgICAvLyAgICAgICBmaXJzdERheTogMSxcbiAgICAvLyAgICAgICBmb3JtYXQ6ICdERC9NTS9ZWVlZJyxcbiAgICAvLyAgICAgICBpMThuOiB7XG4gICAgLy8gICAgICAgICBwcmV2aW91c01vbnRoOiAnTcOqcyBBbnRlcmlvcicsXG4gICAgLy8gICAgICAgICBuZXh0TW9udGg6ICdQcsOzeGltbyBNw6pzJyxcbiAgICAvLyAgICAgICAgIG1vbnRoczogWydKYW5laXJvJywgJ0ZldmVyZWlybycsICdNYXLDp28nLCAnQWJyaWwnLCAnTWFpbycsICdKdW5obycsICdKdWxobycsICdBZ29zdG8nLCAnU2V0ZW1icm8nLCAnT3V0dWJybycsICdOb3ZlbWJybycsICdEZXplbWJybyddLFxuICAgIC8vICAgICAgICAgd2Vla2RheXM6IFsnRG9taW5nbycsICdTZWd1bmRhLUZlaXJhJywgJ1RlcsOnYS1GZWlyYScsICdRdWFydGEtRmVpcmEnLCAnUXVpbnRhLUZlaXJhJywgJ1NleHRhLUZlaXJhJywgJ1PDoWJhZG8nXSxcbiAgICAvLyAgICAgICAgIHdlZWtkYXlzU2hvcnQ6IFsnRG9tJywgJ1NlZycsICdUZXInLCAnUXVhJywgJ1F1aScsICdTZXgnLCAnU8OhYiddLFxuICAgIC8vICAgICAgIH0sXG4gICAgLy8gICAgICAgcG9zaXRpb246ICdib3R0b20gcmlnaHQnLFxuICAgIC8vICAgICAgIHRyaWdnZXI6IHRvZ2dsZUNhbGVuZGFyLFxuICAgIC8vICAgICAgIG1pbkRhdGU6IG5ldyBEYXRlKDE5MDAsIDEsIDEpLFxuICAgIC8vICAgICAgIG1heERhdGU6IG5ldyBEYXRlKDIwMjAsIDEyLCAzMSksXG4gICAgLy8gICAgICAgeWVhclJhbmdlOiBbMTkwMCwgMjAyMF0sXG4gICAgLy8gICAgIH0pO1xuICAgIC8vICAgICAvLyBlbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHRvZ2dsZUNhbGVuZGFyLmJpbmQobnVsbCwgZWwpKTtcbiAgICAvLyAgIH0pO1xuICAgIC8vIH1cblxuICAgIGlmICgkLmFkYXB0aXZlUGxhY2Vob2xkZXIubGVuZ3RoID4gMCkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCgkLmFkYXB0aXZlUGxhY2Vob2xkZXIsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmICh0aGlzLnZhbHVlKSB0aGlzLmNsYXNzTGlzdC5hZGQoY29uZmlnLmFkYXB0aXZlUGxhY2Vob2xkZXJWYWxpZENsYXNzKTtcbiAgICAgICAgICBlbHNlIHRoaXMuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuYWRhcHRpdmVQbGFjZWhvbGRlclZhbGlkQ2xhc3MpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICgkLmZvcm1zLmxlbmd0aCA+IDApIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoJC5mb3JtcywgZnVuY3Rpb24gKGZvcm0pIHtcbiAgICAgICAgb25Gb3JtUmVzZXQoZm9ybSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoJC5maWxlSW5wdXQubGVuZ3RoID4gMCkge1xuICAgICAgXG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKCQuZmlsZUlucHV0LCBmdW5jdGlvbiAoaW5wdXRfZm9ybSkge1xuICAgICAgICBpbnB1dF9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBmYWtlRmlsZVBhdGgoaW5wdXRfZm9ybSwgaW5wdXRfZm9ybS52YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGlmICgkLnJlbW92ZUZpbGUubGVuZ3RoID4gMCApIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCgkLnJlbW92ZUZpbGUsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSB0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgICAgICAgICAgdmFyIGlucHV0X2ZpbGUgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmJzLWpzLWlucHV0LWZpbGUnKTtcblxuICAgICAgICAgICAgaW5wdXRfZmlsZS52YWx1ZSA9IG51bGw7XG5cbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGZha2VGaWxlUGF0aChpbnB1dF9maWxlLCBcIlwiKTtcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICB2YXIgZmFrZUZpbGVQYXRoID0gZnVuY3Rpb24gKGlucHV0LCBpbnB1dF92YWx1ZSkge1xuICAgIHZhciBjb250YWluZXIgPSBpbnB1dC5wYXJlbnROb2RlO1xuICAgIHZhciBjdXN0b21faW5wdXQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmJzLWpzLWlucHV0LWZpbGUtZmFrZScpO1xuICAgIHZhciBjdXN0b21fYnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1pbnB1dC1maWxlLXRvZ2dsZScpO1xuXG4gICAgdmFyIGZpbGVwYXRoID0gaW5wdXRfdmFsdWU7XG4gICAgaWYgKGZpbGVwYXRoKSB7XG4gICAgICBjdXN0b21faW5wdXQuaW5uZXJUZXh0ID0gZmlsZXBhdGgucmVwbGFjZSgvXi4qXFxcXC8sICcnKTtcbiAgICAgIGN1c3RvbV9pbnB1dC5jbGFzc0xpc3QuYWRkKCQuaGFzRmlsZSk7XG4gICAgICBjdXN0b21fYnV0dG9uLmlubmVySFRNTCA9ICdBbHRlcmFyIGFycXVpdm8nO1xuICAgIH0gZWxzZSB7XG4gICAgICBjdXN0b21faW5wdXQuaW5uZXJUZXh0ID0gY3VzdG9tX2lucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS1wbGFjZWhvbGRlcicpO1xuICAgICAgY3VzdG9tX2lucHV0LmNsYXNzTGlzdC5yZW1vdmUoJC5oYXNGaWxlKTtcbiAgICAgIGN1c3RvbV9idXR0b24uaW5uZXJIVE1MID0gJ0FuZXhhciBhcnF1aXZvJztcbiAgICB9XG4gIH1cblxuICB2YXIgdG9nZ2xlVGl0bGVJbmZvVmFsdWUgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICB2YXIgY2xpY2tlZEVsZW0gPSBldmVudC50YXJnZXQ7XG4gICAgY2xpY2tlZEVsZW0uY2hpbGRyZW5bMF0uY2xhc3NMaXN0LnRvZ2dsZSgkLmluZm9BY3RpdmUpO1xuICAgICQub3ZlcmxheS5jbGFzc0xpc3QuYWRkKCQub3ZlcmxheUFjdGl2ZSk7XG4gIH1cblxuICB2YXIgY2xvc2VUaXRsZUluZm9WYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoJC50b2dnbGVJbmZvQ29udGVudCkge1xuICAgICAgJC50b2dnbGVJbmZvQ29udGVudC5jbGFzc0xpc3QucmVtb3ZlKCQuaW5mb0FjdGl2ZSk7XG4gICAgICAkLm92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZSgkLm92ZXJsYXlBY3RpdmUpO1xuICAgIH1cbiAgfVxuXG4gIHZhciB0b2dnbGVJbnB1dFBhc3N3b3JkVmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50Tm9kZTtcbiAgICB2YXIgaW5wdXQgPSBwYXJlbnQucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcblxuICAgIGlmIChpbnB1dC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSA9PT0gJ3RleHQnKSB7XG4gICAgICBwYXJlbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcucGFzc3dvcmRWaXNpYmxlQ2xhc3MpO1xuICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3Bhc3N3b3JkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBhcmVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5wYXNzd29yZFZpc2libGVDbGFzcyk7XG4gICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dCcpO1xuICAgIH1cblxuICAgIGlucHV0LmZvY3VzKCk7XG4gIH07XG5cbiAgLyogdmFyIHRvZ2dsZU1hc2tEREkgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZGF0YVRlbCA9IGVsLmRhdGFzZXQudGVsO1xuICAgIHZhciB0ZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtkYXRhLXRlbD0nKyBkYXRhVGVsICsnXScpO1xuICAgIGNvbnNvbGUubG9nKCdhc2QnKTtcblxuICAgIGlmKGRhdGFUZWwgIT0gNTUpIHtcbiAgICAgIGRlc3Ryb3kgbWFza1xuICAgICAgY29uc29sZS5sb2coJ0RJRkVSRU5URScpO1xuICAgIH1cbiAgfSAqL1xuXG4gIHZhciByZXZlYWxUZWxlcGhvbmVGaWVsZCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYWRpdGlvbmFsVGVsZXBob25lcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1mb3JtX190ZWxlcGhvbmUtYWRpdGlvbmFsLmJzLWlzLWhpZGRlbicpO1xuICAgIGlmIChhZGl0aW9uYWxUZWxlcGhvbmVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgYWRpdGlvbmFsVGVsZXBob25lc1swXS5jbGFzc0xpc3QucmVtb3ZlKCdicy1pcy1oaWRkZW4nKTtcbiAgICAgICQucmV2ZWFsVGVsZXBob25lLmNsYXNzTGlzdC5hZGQoJ2JzLWlzLWRpc2FibGVkJyk7XG4gICAgfSBlbHNlIGlmIChhZGl0aW9uYWxUZWxlcGhvbmVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGFkaXRpb25hbFRlbGVwaG9uZXNbMF0uY2xhc3NMaXN0LnJlbW92ZSgnYnMtaXMtaGlkZGVuJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciB0b2dnbGVNYXNrRERJID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIHZhciBkYXRhVGVsID0gZWwuZGF0YXNldC50ZWw7XG4gICAgLy8gdmFyIHRlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W2RhdGEtdGVsPScrIGRhdGFUZWwgKyddJyk7XG4gICAgLy8gY29uc29sZS5sb2coJ2FzZCcpO1xuXG4gICAgLy8gaWYgKGRhdGFUZWwgIT0gNTUpIHtcbiAgICAvLyAgIGRlc3Ryb3kgbWFza1xuICAgIC8vICAgY29uc29sZS5sb2coJ0RJRkVSRU5URScpO1xuICAgIC8vIH1cbiAgfTtcblxuICB2YXIgdG9nZ2xlQ2FsZW5kYXIgPSBmdW5jdGlvbiAoaW5wdXQpIHt9XG5cbiAgdmFyIG9uRm9ybVJlc2V0ID0gZnVuY3Rpb24gKGZvcm0pIHtcbiAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2V0JywgZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGZha2VGaWxlSW5wdXRzID0gZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdzcGFuLmJzLWZvcm1fX2ZpZWxkJyk7XG4gICAgICBpZiAoZmFrZUZpbGVJbnB1dHMubGVuZ3RoKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZmFrZUZpbGVJbnB1dHMsIGZ1bmN0aW9uIChmYWtlKSB7XG4gICAgICAgICAgZmFrZS5pbm5lclRleHQgPSBmYWtlLmdldEF0dHJpYnV0ZSgnZGF0YS1wbGFjZWhvbGRlcicpIHx8ICcnO1xuICAgICAgICAgIGZha2UuY2xhc3NMaXN0LnJlbW92ZSgkLmhhc0ZpbGUpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBGb3JtcyBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH1cbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKSkge1xuICAgIEJzRm9ybXMuaW5pdCgpO1xuICB9XG59KTtcbiIsInZhciBCc2Zvcm1TdGVwcyA9IChmdW5jdGlvbiAoKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgYnV0dG9uczoge1xuICAgICAgbmV4dDogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWZvcm0tLXN0ZXBzIC5icy1qcy1mb3JtLW5leHQnKSxcbiAgICAgIHByZXY6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1mb3JtLS1zdGVwcyAuYnMtanMtZm9ybS1wcmV2JyksXG4gICAgfSxcbiAgICBjbGFzc2VzOiB7XG4gICAgICBhY3RpdmVGaWVsZHNldDogJ2JzLWZvcm1fX2ZpZWxkc2V0LS1hY3RpdmUnLFxuICAgIH0sXG4gICAgY3VycmVudFN0ZXA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1mb3JtLWN1cnJlbnQtc3RlcCcpLFxuICAgIGN1cnJlbnRTdGVwSW50OiAwLFxuICAgIGZpZWxkc2V0czogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWZvcm0tLXN0ZXBzIC5icy1mb3JtX19maWVsZHNldCcpLFxuICAgIGZvcm06IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1mb3JtLS1zdGVwcycpLFxuICAgIHBlcmNlbnRhZ2U6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1mb3JtLXBlcmNlbnRhZ2UnKSxcbiAgICBwcm9ncmVzc0JhcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWZvcm0tLXN0ZXBzIC5icy1qcy1wcm9ncmVzcy1iYXInKSxcbiAgICB0b3RhbFN0ZXBzOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtZm9ybS10b3RhbC1zdGVwcycpLFxuICAgIHRvdGFsU3RlcHNJbnQ6IDAsXG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgX3NldFRvdGFsU3RlcHMoKTtcbiAgICBfdXBkYXRlQ3VycmVudFN0ZXAoKTtcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmJ1dHRvbnMubmV4dCwgZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBfbmV4dFN0ZXAoYnV0dG9uKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuYnV0dG9ucy5wcmV2LCBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIF9wcmV2U3RlcChidXR0b24pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICogQXR1YWxpemEgbyBwYXNzbyBhdHVhbCBkbyBmb3JtdWzDoXJpb1xuICAqL1xuICB2YXIgX3VwZGF0ZUN1cnJlbnRTdGVwID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBhY3RpdmVGaWVsZHNldCA9IGNvbmZpZy5mb3JtLnF1ZXJ5U2VsZWN0b3IoJy4nICsgY29uZmlnLmNsYXNzZXMuYWN0aXZlRmllbGRzZXQpO1xuXG4gICAgLy8gVHJhbnNmb3JtbyBvIE5vZGVMaXN0IGVtIHVtIEFycmF5XG4gICAgdmFyIGZpZWxkc2V0cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGNvbmZpZy5maWVsZHNldHMpO1xuXG4gICAgaWYgKGZpZWxkc2V0cykge1xuICAgICAgLy8gT2J0ZW5obyBhIHBvc2nDp8OjbyAoaW5kZXgpIGRvIGZpZWxkc2V0XG4gICAgICB2YXIgY3VycmVudFN0ZXBJbnQgPSBmaWVsZHNldHMuaW5kZXhPZihhY3RpdmVGaWVsZHNldCkgKyAxO1xuXG4gICAgICAvLyBBdHVhbGl6byBvIHBhc3NvIGRvIGZvcm11bMOhcmlvXG4gICAgICBjb25maWcuY3VycmVudFN0ZXBJbnQgPSBjdXJyZW50U3RlcEludDtcbiAgICAgIGNvbmZpZy5jdXJyZW50U3RlcC50ZXh0Q29udGVudCA9IGN1cnJlbnRTdGVwSW50O1xuICAgICAgX3VwZGF0ZVBlcmNlbnRhZ2UoKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICogRGVmaW5lIG8gdG90YWwgZGUgcGFzc29zIGRvIGZvcm11bMOhcmlvXG4gICovXG4gIHZhciBfc2V0VG90YWxTdGVwcyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZmllbGRzZXRzID0gY29uZmlnLmZpZWxkc2V0cztcbiAgICBpZiAoZmllbGRzZXRzICYmIGZpZWxkc2V0cy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25maWcudG90YWxTdGVwc0ludCA9IGZpZWxkc2V0cy5sZW5ndGg7XG4gICAgICBjb25maWcudG90YWxTdGVwcy50ZXh0Q29udGVudCA9IGZpZWxkc2V0cy5sZW5ndGg7XG4gICAgICBfdXBkYXRlUGVyY2VudGFnZSgpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogVmFsaWRhIG8gZm9ybXVsw6FyaW8gZSBhdmFuw6dhIHBhcmEgbyBwcsOzeGltbyBwYXNzb1xuICAgKiBAcGFyYW0gIHtFbGVtZW50fSBidXR0b24gQm90w6NvIHBhcmEgYXZhbsOnYXIgdW0gcGFzc29cbiAgICovXG4gIHZhciBfbmV4dFN0ZXAgPSBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgdmFyIGN1cnJlbnRGaWVsZHNldCA9IGdldFBhcmVudHMoYnV0dG9uLCAnYnMtZm9ybV9fZmllbGRzZXQnLCB0cnVlKVswXTtcbiAgICB2YXIgbmV4dEZpZWxkc2V0ID0gY3VycmVudEZpZWxkc2V0Lm5leHRFbGVtZW50U2libGluZztcbiAgICB2YXIgaXNGb3JtT2sgPSBCc0Zvcm1WYWxpZGF0ZS52YWxpZGF0ZUZvcm0oY3VycmVudEZpZWxkc2V0KTtcbiAgICBpZiAoaXNGb3JtT2spIF9zd2l0Y2hGaWVsZHNldChuZXh0RmllbGRzZXQpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBWb2x0YSB1bSBwYXNzbyBubyBmb3JtdWzDoXJpb1xuICAgKiBAcGFyYW0gIHtFbGVtZW50fSBidXR0b24gQm90w6NvIHBhcmEgdm9sdGFyIHVtIHBhc3NvXG4gICAqL1xuICB2YXIgX3ByZXZTdGVwID0gZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgIHZhciBjdXJyZW50RmllbGRzZXQgPSBnZXRQYXJlbnRzKGJ1dHRvbiwgJ2JzLWZvcm1fX2ZpZWxkc2V0JywgdHJ1ZSlbMF07XG4gICAgdmFyIHByZXZGaWVsZHNldCA9IGN1cnJlbnRGaWVsZHNldC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuICAgIGlmIChwcmV2RmllbGRzZXQpIF9zd2l0Y2hGaWVsZHNldChwcmV2RmllbGRzZXQpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBFc2NvbmRlIG9zIGZpZWxkc2V0cyBlIGV4aWJlIGFwZW5hcyBvIGF0dWFsXG4gICAqIEBwYXJhbSAge0VsZW1lbnR9IGZpZWxkc2V0IEZpZWxkc2V0IHF1ZSBzZXLDoSBleGliaWRvXG4gICAqL1xuICB2YXIgX3N3aXRjaEZpZWxkc2V0ID0gZnVuY3Rpb24gKGZpZWxkc2V0KSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuZmllbGRzZXRzLCBmdW5jdGlvbiAoZnMpIHtcbiAgICAgIGZzLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMuYWN0aXZlRmllbGRzZXQpO1xuICAgIH0pO1xuICAgIGZpZWxkc2V0LmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMuYWN0aXZlRmllbGRzZXQpO1xuICAgIF91cGRhdGVDdXJyZW50U3RlcCgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBdHVhbGl6YSBvIHBlcmNlbnR1YWwgZGUgcHJvZ3Jlc3NvXG4gICAqL1xuICB2YXIgX3VwZGF0ZVBlcmNlbnRhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGNvbmZpZy50b3RhbFN0ZXBzSW50ID4gMCkge1xuICAgICAgLy8gQ2FsY3VsbyBvIHBlcmNlbnR1YWwgZGUgcHJvZ3Jlc3NvXG4gICAgICAvLyBEaW1pbnVpIDEgcGFyYSBpbmljaWFyIGNvbSAwJVxuICAgICAgdmFyIHBlcmNlbnRhZ2UgPSBwYXJzZUludCgoKChjb25maWcuY3VycmVudFN0ZXBJbnQgLSAxKSAqIDEwMCkgLyBjb25maWcudG90YWxTdGVwc0ludCksIDEwKTtcbiAgICAgIGNvbmZpZy5wZXJjZW50YWdlLnRleHRDb250ZW50ID0gcGVyY2VudGFnZTtcbiAgICAgIGNvbmZpZy5wcm9ncmVzc0Jhci52YWx1ZSA9IHBlcmNlbnRhZ2U7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBCc2Zvcm1TdGVwcyBjb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gQnNmb3JtU3RlcHMuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWZvcm0tLXN0ZXBzJykubGVuZ3RoKSB7XG4gICAgQnNmb3JtU3RlcHMuaW5pdCgpO1xuICB9XG59KTtcbiIsIi8qKlxuICogRm9ybSBWYWxpZGF0ZSAoYW5jaG9yKVxuICovXG52YXIgQnNGb3JtVmFsaWRhdGUgPSAoZnVuY3Rpb24gKCkge1xuICAvLyBFbGVtZW50c1xuICB2YXIgZWxlbWVudHMgPSB7fTtcbiAgdmFyICQgPSBlbGVtZW50cztcblxuICAkLmZvcm1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZm9ybScpO1xuXG4gIGlmICghJC5mb3Jtcy5sZW5ndGgpIHJldHVybjtcblxuICAvLyBDb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBlcnJvck1lc3NhZ2VDbGFzczogJ2JzLWZvcm0tZXJyb3JfX21lc3NhZ2UnLFxuICAgIGxhYmVsQ2xhc3M6ICdicy1mb3JtX19sYWJlbCcsXG4gICAgdmFsaWRhdGU6IHtcbiAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgcGF0dGVybjogLyg/IV4gKyQpXi4rJC9nLFxuICAgICAgICBlcnJvcjogJ0Vzc2UgY2FtcG8gw6kgb2JyaWdhdMOzcmlvLicsXG4gICAgICB9LFxuICAgICAgbm9tZToge1xuICAgICAgICBwYXR0ZXJuOiAvW1xcd1xcc10rL2csXG4gICAgICAgIGVycm9yOiAnVm9jw6ogZGV2ZSBkaWdpdGFyIHNldSBub21lIGNvbXBsZXRvLicsXG4gICAgICB9LFxuICAgICAgY3BmOiB7XG4gICAgICAgIHBhdHRlcm46IC8oWzAtOV17M31bLl0/WzAtOV17M31bLl0/WzAtOV17M31bLV0/WzAtOV17Mn0pL2csXG4gICAgICAgIGVycm9yOiAnTyBDUEYgw6kgaW52w6FsaWRvJyxcbiAgICAgIH0sXG4gICAgICBjbnBqOiB7XG4gICAgICAgIHBhdHRlcm46IC8oWzAtOV17Mn1bLl0/WzAtOV17M31bLl0/WzAtOV17M31bL10/WzAtOV17NH1bLV0/WzAtOV17Mn0pL2csXG4gICAgICAgIGVycm9yOiAnTyBDTlBKIMOpIGludsOhbGlkbycsXG4gICAgICB9LFxuICAgICAgdGVsOiB7XG4gICAgICAgIC8vIGh0dHBzOi8vcmVnZXhyLmNvbS8zbTNzMlxuICAgICAgICBwYXR0ZXJuOiAvWyhdP1sxLTldezJ9WyldP1tcXHNdP1syLTldWzAtOV17Myw0fVstXFxzXT9bMS05XXs0fS9nLFxuICAgICAgICBlcnJvcjogJ08gdGVsZWZvbmUgw6kgaW52w6FsaWRvJyxcbiAgICAgIH0sXG4gICAgICAnYWN0aXZhdGlvbi1jb2RlJzoge1xuICAgICAgICBwYXR0ZXJuOiAvWzAtOV17Nn0vZyxcbiAgICAgICAgZXJyb3I6ICdPIGPDs2RpZ28gw6kgaW52w6FsaWRvJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgICB2YWxpZGF0ZWRDdXN0b21FdmVudDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIG5ldyBFdmVudCgnZm9ybUlzVmFsaWQnKVxuICAgIH0sXG4gICAgdmFsaWRJbnB1dHM6ICdpbnB1dCwgdGV4dGFyZWEnLFxuICAgIGlucHV0T3B0aW9uczoge1xuICAgICAgLy8gc3RyaW5nXG4gICAgICBlcnJvcjogbnVsbCxcbiAgICAgIC8vIHJlZ2V4XG4gICAgICBwYXR0ZXJuOiBudWxsLFxuICAgICAgLy8gc3RyaW5nXG4gICAgICB0eXBlOiBudWxsLFxuICAgICAgLy8gZnVuY3Rpb25cbiAgICAgIHZhbGlkYXRpb246IG51bGwsXG4gICAgICAvLyBib29sZWFuXG4gICAgICBub1N0YXRlOiBmYWxzZSxcbiAgICAgIC8vIC8vIGJvb2xlYW5cbiAgICAgIC8vIHZhbGlkYXRlT25JbnB1dDogZmFsc2UsXG4gICAgICAvLyAvLyBib29sZWFuXG4gICAgICAvLyBjbGVhbk9uSW5wdXQ6IGZhbHNlLFxuICAgIH0sXG4gIH07XG5cbiAgLyoqXG4gICAqIFtkZXNjcmlwdGlvbl1cbiAgICovXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoJC5mb3JtcywgZnVuY3Rpb24gKGZvcm0pIHtcbiAgICAgIHZhciB2YWxpZGF0ZUNhbGxiYWNrID0gZm9ybS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsaWRhdGUtY2FsbGJhY2snKTtcbiAgICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIC8vIFNlIG8gZm9ybXVsw6FyaW8gbsOjbyBmb3IgdsOhbGlkbywgcHJldmluZSBvIHN1Ym1pdFxuICAgICAgICBpZiAoIXZhbGlkYXRlRm9ybSh0aGlzKSkge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgLy8gZGVidWdnZXI7XG4gICAgICAgICAgLy8gU2UgbyBmb3JtdWzDoXJpbyBmb3IgdsOhbGlkbyBlIHRpdmVyIHVtIGNhbGxiYWNrXG4gICAgICAgICAgLy8gY3VzdG9taXphZG8sIHRhbWLDqW0gcHJldmluZSBvIHN1Ym1pdFxuICAgICAgICB9IGVsc2UgaWYgKHZhbGlkYXRlQ2FsbGJhY2spIHtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChjb25maWcudmFsaWRhdGVkQ3VzdG9tRXZlbnQpO1xuICAgICAgICAgIC8vIGRlYnVnZ2VyO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogW2Rlc2NyaXB0aW9uXVxuICAgKiBAcGFyYW0gIHtbdHlwZV19IGZvcm0gW2Rlc2NyaXB0aW9uXVxuICAgKiBAcmV0dXJuIHtbdHlwZV19ICAgICAgW2Rlc2NyaXB0aW9uXVxuICAgKi9cbiAgdmFyIHZhbGlkYXRlRm9ybSA9IGZ1bmN0aW9uIChmb3JtKSB7XG4gICAgdmFyIGlucHV0cyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbChjb25maWcudmFsaWRJbnB1dHMpO1xuICAgIHZhciBvdXRwdXQgPSB0cnVlO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChpbnB1dHMsIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgY2xlYW5TdGF0ZShpbnB1dCk7XG4gICAgICBpZiAoIXZhbGlkYXRlSW5wdXQoaW5wdXQpKSBvdXRwdXQgPSBmYWxzZTtcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB2YWxpZGF0ZUlucHV0LmJpbmQobnVsbCwgaW5wdXQpKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBvdXRwdXQ7XG4gIH07XG5cbiAgLyoqXG4gICAqIFtkZXNjcmlwdGlvbl1cbiAgICogQHBhcmFtICB7W3R5cGVdfSBpbnB1dCAgIFtkZXNjcmlwdGlvbl1cbiAgICogQHBhcmFtICB7W3R5cGVdfSBvcHRpb25zIFtkZXNjcmlwdGlvbl1cbiAgICogQHJldHVybiB7W3R5cGVdfSAgICAgICAgIFtkZXNjcmlwdGlvbl1cbiAgICovXG4gIHZhciB2YWxpZGF0ZUlucHV0ID0gZnVuY3Rpb24gKGlucHV0LCBvcHRpb25zKSB7XG4gICAgLy8gY3VzdG9tIHNldHRpbmdzXG4gICAgdmFyIHNldHRpbmdzID0ge307XG4gICAgdmFyIGlubGluZVNldHRpbmdzID0gaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLXZhbGlkYXRlLW9wdGlvbnMnKSB8fCBudWxsO1xuXG4gICAgLy8gaWYgZXhpc3RzLCBleHRlbmQgaW5saW5lIG9wdGlvbnMgaW4gZGVmYXVsdCBzZXR0aW5nc1xuICAgIGlmIChpbmxpbmVTZXR0aW5ncykgc2V0dGluZ3MgPSBleHRlbmQoY29uZmlnLmlucHV0T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgICAvLyBjaGVjayBpZiBvcHRpb25zIGhhcyBhbiBvYmplY3RcbiAgICBpZiAodHlwZW9mIG9wdGlvbnMgIT09ICdvYmplY3QnKSBvcHRpb25zID0ge307XG4gICAgLy8gZXh0ZW5kIG9wdGlvbnMgb2JqZWN0IHByb3BlcnRpZXMgaW4gc2V0dGluZ3NcbiAgICBlbHNlIHNldHRpbmdzID0gZXh0ZW5kKGNvbmZpZy5pbnB1dE9wdGlvbnMsIG9wdGlvbnMpO1xuXG4gICAgLy8gc2V0IGxvYWRpbmcgc3RhdGUgaWYgc2V0dGluZ3MgaGFzIGN1c3RvbSB2YWxpZGF0aW9uIGZ1bmN0aW9uXG4gICAgaWYgKHNldHRpbmdzLnZhbGlkYXRpb24gPT09ICdmdW5jdGlvbicpIHNldFN0YXRlKGlucHV0LCAnbG9hZGluZycpO1xuXG4gICAgLy8gU2V0IGVycm9yIHN0YXRlIGlmIGlucHV0IGlzIGludmFsaWRcbiAgICBpZiAoIWlucHV0SXNWYWxpZChpbnB1dCwgc2V0dGluZ3MpICYmICFzZXR0aW5ncy5ub1N0YXRlKSB7XG4gICAgICAvLyBkZWJ1Z2dlcjtcbiAgICAgIHNldFN0YXRlKGlucHV0LCAnaW52YWxpZCcsIHNldHRpbmdzLmVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoIXNldHRpbmdzLm5vU3RhdGUpIHtcbiAgICAgIC8vIGRlYnVnZ2VyO1xuICAgICAgLy8gU2V0IHN1Y2Nlc3Mgc3RhdGUgaWYgaW5wdXQgaXMgdmFsaWRcbiAgICAgIHNldFN0YXRlKGlucHV0LCAndmFsaWQnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICAvKipcbiAgICogW2Rlc2NyaXB0aW9uXVxuICAgKiBAcGFyYW0gIHtbdHlwZV19IGlucHV0ICAgIFtkZXNjcmlwdGlvbl1cbiAgICogQHBhcmFtICB7W3R5cGVdfSBzZXR0aW5ncyBbZGVzY3JpcHRpb25dXG4gICAqIEByZXR1cm4ge1t0eXBlXX0gICAgICAgICAgW2Rlc2NyaXB0aW9uXVxuICAgKi9cbiAgdmFyIGlucHV0SXNWYWxpZCA9IGZ1bmN0aW9uIChpbnB1dCwgc2V0dGluZ3MpIHtcbiAgICAvLyBpZiBpbnB1dCBpcyByZXF1aXJlZFxuICAgIHZhciBpc1JlcXVpcmVkID1cbiAgICAgIGlucHV0LmdldEF0dHJpYnV0ZSgncmVxdWlyZWQnKSA9PT0gJycgfHxcbiAgICAgIGlucHV0LmdldEF0dHJpYnV0ZSgncmVxdWlyZWQnKSA9PT0gJ3JlcXVpcmVkJztcblxuICAgIGlmICghaXNSZXF1aXJlZCkgcmV0dXJuIHRydWU7XG5cbiAgICAvLyB0eXBlIG9mIHRoZSB2YWxpZGF0aW9uXG4gICAgdmFyIHR5cGUgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsaWRhdGUtdHlwZScpIHx8IHNldHRpbmdzLnR5cGU7XG5cbiAgICAvLyBjdXN0b20gcGF0dGVybiAocmVnZXgpXG4gICAgdmFyIHBhdHRlcm4gPVxuICAgICAgaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLXZhbGlkYXRlLXBhdHRlcm4nKSB8fFxuICAgICAgaW5wdXQuZ2V0QXR0cmlidXRlKCdwYXR0ZXJuJykgfHxcbiAgICAgIHNldHRpbmdzLnBhdHRlcm47XG5cbiAgICAvLyBpbnB1dCB2YWx1ZVxuICAgIHZhciB2YWx1ZSA9IGlucHV0LnZhbHVlO1xuXG4gICAgLy8gZGVmYXVsdCBwYXR0ZXJuIGJ5IHR5cGVcbiAgICB2YXIgdHlwZVZhbGlkYXRlID0gY29uZmlnLnZhbGlkYXRlW3R5cGVdIHx8IFtdO1xuXG4gICAgLy8gaWYgaW5wdXQgaXMgdmFsaWQgb3Igbm90XG4gICAgdmFyIG91dHB1dCA9IGZhbHNlO1xuXG4gICAgLy8gY2hlY2sgaWYgYSBzdHJpbmcgbWF0Y2hlcyBhIHJlZ2V4IHBhdHRlcm5cbiAgICB2YXIgY2hlY2tSZWdleCA9IGZ1bmN0aW9uIChzdHJpbmcsIHJlZ2V4KSB7XG4gICAgICByZXR1cm4gc3RyaW5nLm1hdGNoKHJlZ2V4KTtcbiAgICB9O1xuXG4gICAgLy8gaWYgaXMgbm90IHJlcXVpcmVkLCB2YWxpZGF0aW9uIGlzIG5vdCBuZWVkZWRcbiAgICAvLyBpZiBoYXMgbm90IHZhbHVlLCB2YWxpZGF0aW9uIGlzIG5vdCBwb3NzaWJsZVxuICAgIGlmICghaXNSZXF1aXJlZCB8fCAhdmFsdWUpIHJldHVybjtcblxuICAgIC8vIGlmIGlucHV0IGhhcyBjdXN0b20gZGF0YSB0byB2YWxpZGF0ZVxuICAgIGlmIChzZXR0aW5ncy52YWxpZGF0aW9uKSB7XG4gICAgICBvdXRwdXQgPSBzZXR0aW5ncy52YWxpZGF0aW9uKHZhbHVlKTtcbiAgICAgIC8vIGlmIGlucHV0IGhhcyBhIHR5cGUgZGVmaW5lZCBhbmQgdGhhdCBoYXMgYSBkZWZhdWx0IHBhdHRlcm5cbiAgICB9IGVsc2UgaWYgKHR5cGVWYWxpZGF0ZS5wYXR0ZXJuKSB7XG4gICAgICBvdXRwdXQgPSBjaGVja1JlZ2V4KHZhbHVlLCB0eXBlVmFsaWRhdGUucGF0dGVybik7XG4gICAgLy8gaWYgaW5wdXQgaGFzIG5vdCBhIHR5cGUgZGVmaW5lZCBidXQgYSBjdXN0b20gcGF0dGVyblxuICAgIH0gZWxzZSBpZiAocGF0dGVybikge1xuICAgICAgb3V0cHV0ID0gY2hlY2tSZWdleCh2YWx1ZSwgcGF0dGVybik7XG4gICAgLy8gaWYgaW5wdXQgaXMgY2hlY2tib3hcbiAgICB9IGVsc2UgaWYgKGlucHV0LnR5cGUgPT09ICdjaGVja2JveCcpIHtcbiAgICAgIG91dHB1dCA9IGlucHV0LmNoZWNrZWQ7XG4gICAgLy8gaWYgaW5wdXQgaGFzIG5vdCBhIHR5cGUgb3IgYSBwYXR0ZXJuLCBidXQgZXZlbiBzbyBpcyByZXF1aXJlZFxuICAgIH0gZWxzZSB7XG4gICAgICBvdXRwdXQgPSB2YWx1ZS50cmltKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfTtcblxuICAvKipcbiAgICogW2Rlc2NyaXB0aW9uXVxuICAgKiBAcGFyYW0gIHtbdHlwZV19IGlucHV0ICAgW2Rlc2NyaXB0aW9uXVxuICAgKiBAcGFyYW0gIHtbdHlwZV19IHN0YXRlICAgW2Rlc2NyaXB0aW9uXVxuICAgKiBAcGFyYW0gIHtbdHlwZV19IG1lc3NhZ2UgW2Rlc2NyaXB0aW9uXVxuICAgKi9cbiAgdmFyIHNldFN0YXRlID0gZnVuY3Rpb24gKGlucHV0LCBzdGF0ZSwgbWVzc2FnZSkge1xuICAgIC8vIHZhciBsYWJlbCA9IGdldFBhcmVudHMoaW5wdXQsIGNvbmZpZy5sYWJlbENsYXNzKTtcbiAgICB2YXIgaW5wdXRUeXBlID0gaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLXZhbGlkYXRlLXR5cGUnKTtcbiAgICB2YXIgZXJyb3JNZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuXG4gICAgaWYgKHR5cGVvZiBtZXNzYWdlICE9PSAnc3RyaW5nJykgbWVzc2FnZSA9IG51bGw7XG5cbiAgICBjbGVhblN0YXRlKGlucHV0KTtcblxuICAgIGVycm9yTWVzc2FnZS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5lcnJvck1lc3NhZ2VDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlLmlubmVySFRNTCA9IChcbiAgICAgIGNvbmZpZy52YWxpZGF0ZVtpbnB1dFR5cGVdKSA/XG4gICAgICBjb25maWcudmFsaWRhdGVbaW5wdXRUeXBlXS5lcnJvciA6XG4gICAgICBjb25maWcudmFsaWRhdGUuZGVmYXVsdC5lcnJvcjtcblxuICAgIGVycm9yTWVzc2FnZS5pbm5lckhUTUwgPSBtZXNzYWdlIHx8IGVycm9yTWVzc2FnZS5pbm5lckhUTUw7XG5cbiAgICAvLyBkZWJ1Z2dlcjtcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsaWRhdGlvbi1zdGF0ZScsIHN0YXRlKTtcblxuICAgIGlmIChzdGF0ZSA9PT0gJ2ludmFsaWQnKSB7XG4gICAgICBpZiAoaW5wdXQudHlwZSA9PT0gJ2NoZWNrYm94JyB8fCBpbnB1dC50eXBlID09PSAncmFkaW8nKSB7XG4gICAgICAgIGlucHV0Lm5leHRFbGVtZW50U2libGluZy5hcHBlbmRDaGlsZChlcnJvck1lc3NhZ2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5zZXJ0QWZ0ZXIoZXJyb3JNZXNzYWdlLCBpbnB1dCk7XG4gICAgICB9XG4gICAgICAvLyBkZWJ1Z2dlcjtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFtkZXNjcmlwdGlvbl1cbiAgICogQHBhcmFtICB7W3R5cGVdfSBpbnB1dCBbZGVzY3JpcHRpb25dXG4gICAqIEByZXR1cm4ge1t0eXBlXX0gICAgICAgW2Rlc2NyaXB0aW9uXVxuICAgKi9cbiAgdmFyIGdldFN0YXRlID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgcmV0dXJuIGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS12YWxpZGF0aW9uLXN0YXRlJyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFtkZXNjcmlwdGlvbl1cbiAgICogQHBhcmFtICB7W3R5cGVdfSBpbnB1dCBbZGVzY3JpcHRpb25dXG4gICAqL1xuICB2YXIgY2xlYW5TdGF0ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgIHZhciBwYXJlbnQgPSBpbnB1dC5wYXJlbnROb2RlO1xuICAgIHZhciBtZXNzYWdlID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1mb3JtLWVycm9yX19tZXNzYWdlJyk7XG4gICAgaW5wdXQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXZhbGlkYXRpb24tc3RhdGUnKTtcblxuICAgIGlmIChtZXNzYWdlKSBwYXJlbnQucmVtb3ZlQ2hpbGQobWVzc2FnZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIGluc2VydEFmdGVyXG4gICAqIEBwYXJhbSAge1t0eXBlXX0gbmV3Tm9kZSAgICAgICBbZGVzY3JpcHRpb25dXG4gICAqIEBwYXJhbSAge1t0eXBlXX0gcmVmZXJlbmNlTm9kZSBbZGVzY3JpcHRpb25dXG4gICAqL1xuICB2YXIgaW5zZXJ0QWZ0ZXIgPSBmdW5jdGlvbiAobmV3Tm9kZSwgcmVmZXJlbmNlTm9kZSkge1xuICAgIHJlZmVyZW5jZU5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobmV3Tm9kZSwgcmVmZXJlbmNlTm9kZS5uZXh0U2libGluZyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEV4dGVuZCBvYmplY3RzXG4gICAqIEBwYXJhbSAge09iamVjdH0gb2JqQSBBbiBvYmplY3RcbiAgICogQHBhcmFtICB7T2JqZWN0fSBvYmpCIEFub3RoZXIgb2JqZWN0XG4gICAqIEByZXR1cm4ge09iamVjdH0gICAgICBBIGNvcHkgb2Ygb2JqZWN0QSBleHRlbmRlZCB3aXRoIHRoZSBwcm9wZXJ0aWVzIGZyb20gb2JqZWN0QlxuICAgKi9cbiAgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChvYmpBLCBvYmpCKSB7XG4gICAgdmFyIG9iakMgPSB7fTtcbiAgICBmb3IgKHZhciBrZXlBIGluIG9iakEpIHtcbiAgICAgIGlmIChvYmpBLmhhc093blByb3BlcnR5KGtleUEpKSB7XG4gICAgICAgIG9iakNba2V5QV0gPSBvYmpBW2tleUFdO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAodmFyIGtleUIgaW4gb2JqQikge1xuICAgICAgaWYgKG9iakIuaGFzT3duUHJvcGVydHkoa2V5QikpIHtcbiAgICAgICAgb2JqQ1trZXlCXSA9IG9iakJba2V5Ql07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmpDO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICB2YWxpZGF0ZUlucHV0OiB2YWxpZGF0ZUlucHV0LFxuICAgIHZhbGlkYXRlRm9ybTogdmFsaWRhdGVGb3JtLFxuICAgIGdldFN0YXRlOiBnZXRTdGF0ZSxcbiAgICBzZXRTdGF0ZTogc2V0U3RhdGUsXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgQnNGb3JtVmFsaWRhdGUgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtdmFsaWRhdGUnKS5sZW5ndGgpIHtcbiAgICBCc0Zvcm1WYWxpZGF0ZS5pbml0KCk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBCcyBQaWN0dXJlIFBhcmFsbGF4IEVmZmVjdFxuICogUGFyYWxsYXggZWZmZWN0IGZvciBmdWxsIGJhY2tncm91bmQgaW1hZ2VzIHdpdGggaHRtbCBwaWN0dXJlL2ltZyB0YWdcbiAqXG4gKiBVc2UgZXhlbXBsZTpcbiAqIDxwaWN0dXJlIGNsYXNzPVwiaW1hZ2UtY29udGFpbmVyLWNsYXNzXCI+XG4gKiAgIDxpbWcgc3JjPVwicGF0aC90by9pbWFnZS5qcGdcIj5cbiAqIDwvcGljdHVyZT5cbiAqXG4gKiBUT0RPOiBqcXVlcnkgZXh0ZW5kIGxpa2UgZnVuY3Rpb24gdG8gbWVyZ2UgZGVmYXVsdC9vcHRpb25zXG4gKlxuICovXG52YXIgQnNQaWN0dXJlUGFyYWxsYXggPSAoZnVuY3Rpb24gKGRvY3VtZW50KSB7XG4gIC8vIEVsZW1lbnRzXG4gIHZhciBlbGVtZW50cyA9IHt9O1xuICB2YXIgJCA9IGVsZW1lbnRzO1xuICAkLnBhcmFsbGF4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXBpY3R1cmUtcGFyYWxsYXgnKTtcbiAgaWYgKCEkLnBhcmFsbGF4Lmxlbmd0aCkgcmV0dXJuO1xuXG4gIC8vIENvbmZpZ1xuICB2YXIgY29uZmlnID0ge1xuICAgIHNwZWVkOiAxLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnNwZWVkKSBjb25maWcuc3BlZWQgPSBvcHRpb25zLnNwZWVkO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCgkLnBhcmFsbGF4LCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHBhcmFsbGF4LmJpbmQobnVsbCwgZWwpKTtcbiAgICB9KTtcbiAgfTtcbiAgdmFyIHBhcmFsbGF4ID0gZnVuY3Rpb24gKGltYWdlQ29udGFpbmVyKSB7XG4gICAgdmFyIHNwZWVkID0gKGNvbmZpZy5zcGVlZCA+IDEgfHwgY29uZmlnLnNwZWVkIDw9IDApID8gMSA6IGNvbmZpZy5zcGVlZDtcbiAgICB2YXIgaW1hZ2UgPSBpbWFnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdpbWcnKTtcbiAgICB2YXIgaW1hZ2VIID0gaW1hZ2Uub2Zmc2V0SGVpZ2h0O1xuICAgIHZhciBpbWFnZUNvbnRhaW5lclkgPSBpbWFnZUNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XG4gICAgdmFyIGltYWdlQ29udGFpbmVySCA9IGltYWdlQ29udGFpbmVyLm9mZnNldEhlaWdodDtcbiAgICB2YXIgd2luWSA9IChcbiAgICAgIHdpbmRvdy5wYWdlWU9mZnNldCAhPT0gdW5kZWZpbmVkXG4gICAgKSA/XG4gICAgICB3aW5kb3cucGFnZVlPZmZzZXQgOlxuICAgICAgKFxuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgfHxcbiAgICAgICAgZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlIHx8IGRvY3VtZW50LmJvZHlcbiAgICAgICkuc2Nyb2xsVG9wO1xuICAgIHZhciB3aW5IID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgIHZhciBzY3JvbGxEaXN0YW5jZSA9IHdpbkggKyBpbWFnZUNvbnRhaW5lckg7XG4gICAgdmFyIGltYWdlU2FuZ3JpYSA9IGltYWdlSCAtIGltYWdlQ29udGFpbmVySDtcbiAgICB2YXIgdG9wUHhQZXJTY3JvbGxQeCA9IGltYWdlU2FuZ3JpYSAvIHNjcm9sbERpc3RhbmNlO1xuICAgIHZhciBpbWFnZVRvcFBvc2l0aW9uID0gKHRvcFB4UGVyU2Nyb2xsUHggKiAoaW1hZ2VDb250YWluZXJZIC0gd2luSCkpICogc3BlZWQ7XG5cbiAgICAvLyBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XG4gICAgLy8gY29uc29sZS5sb2coJ2ltYWdlQ29udGFpbmVyWTogJyArIGltYWdlQ29udGFpbmVyWSk7XG4gICAgLy8gY29uc29sZS5sb2coJ3dpblk6ICcgKyB3aW5ZKTtcbiAgICAvLyBjb25zb2xlLmxvZygnd2luSDogJyArIHdpbkgpO1xuICAgIC8vIGNvbnNvbGUubG9nKCdpbWFnZUNvbnRhaW5lckg6ICcgKyBpbWFnZUNvbnRhaW5lckgpO1xuICAgIC8vIGNvbnNvbGUubG9nKCdzY3JvbGxEaXN0YW5jZTogJyArIHNjcm9sbERpc3RhbmNlKTtcbiAgICAvLyBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XG4gICAgLy8gY29uc29sZS5sb2coJ3NwZWVkOiAnICsgc3BlZWQpO1xuICAgIC8vIGNvbnNvbGUubG9nKCdpbWFnZVNhbmdyaWE6ICcgKyBpbWFnZVNhbmdyaWEpO1xuICAgIC8vIGNvbnNvbGUubG9nKCd0b3BQeFBlclNjcm9sbFB4OiAnICsgdG9wUHhQZXJTY3JvbGxQeCk7XG4gICAgLy8gY29uc29sZS5sb2coJ2ltYWdlVG9wUG9zaXRpb246ICcgKyBpbWFnZVRvcFBvc2l0aW9uKTtcblxuICAgIGltYWdlLnN0eWxlLnRvcCA9IGltYWdlVG9wUG9zaXRpb24gKyAncHgnO1xuICB9O1xuXG4gIHZhciBvZmZzZXQgPSBmdW5jdGlvbiAoZWwpIHtcbiAgICB2YXIgcmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvcDogcmVjdC50b3AgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCxcbiAgICAgIGxlZnQ6IHJlY3QubGVmdCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCxcbiAgICB9O1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oZG9jdW1lbnQpKTtcblxuLyoqXG4gKiBJbml0IEhlYWRlciBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1waWN0dXJlLXBhcmFsbGF4JykpIHtcbiAgICBCc1BpY3R1cmVQYXJhbGxheC5pbml0KCk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBCcyBJbnB1dCBNYXNrcyAoYW5jaG9yKVxuICovXG52YXIgSW5wdXRNYXNrcyA9IChmdW5jdGlvbiAoKSB7XG4gIC8vIEVsZW1lbnRzXG4gIHZhciBlbGVtZW50cyA9IHt9O1xuICB2YXIgJCA9IGVsZW1lbnRzO1xuICAkLmJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG4gICQuaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtaW5wdXRtYXNrLCBpbnB1dCcpO1xuXG4gIC8vIENvbmZpZ1xuICB2YXIgY29uZmlnID0ge1xuICAgIG1hc2tzOiB7XG4gICAgICBjcGY6IHtcbiAgICAgICAgbWFzazogJzAwMC4wMDAuMDAwLTAwJyxcbiAgICAgIH0sXG4gICAgICBjbnBqOiB7XG4gICAgICAgIG1hc2s6ICcwMC4wMDAuMDAwLzAwMDAtMDAnLFxuICAgICAgfSxcbiAgICAgICdjcGYtY25waic6IHtcbiAgICAgICAgbWFzazogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIG1hc2s6ICcwMDAuMDAwLjAwMC0wMCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBtYXNrOiAnMDAuMDAwLjAwMC8wMDAwLTAwJyxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICAgIHJnOiB7XG4gICAgICAgIG1hc2s6ICcwMC4wMDAuMDAwLVsqXScsXG4gICAgICB9LFxuICAgICAgYmluOiB7XG4gICAgICAgIG1hc2s6ICcwMDAwIDAwJyxcbiAgICAgIH0sXG4gICAgICAnYWN0aXZhdGlvbi1jb2RlJzoge1xuICAgICAgICBtYXNrOiAnMDAwMDAwJyxcbiAgICAgIH0sXG4gICAgICBjYXJ0YW86IHtcbiAgICAgICAgbWFzazogJzAwMDAgMDAwMCAwMDAwIDAwMDAnLFxuICAgICAgfSxcbiAgICAgIGNlcDoge1xuICAgICAgICBtYXNrOiAnMDAuMDAwLTAwMCcsXG4gICAgICB9LFxuICAgICAgdGVsOiB7XG4gICAgICAgIG1hc2s6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBtYXNrOiAnKDAwKSAwMDAwLTAwMDAnLFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgbWFzazogJygwMCkgWzBdMDAwMC0wMDAwJyxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgbWFzazogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIG1hc2s6ICcwMC8wMC8wMDAwJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIC8vIHtcbiAgICAgICAgICAvLyAgIG1hc2s6IERhdGUsXG4gICAgICAgICAgLy8gICAvLyBuw6NvIGZ1bmNpb25hIGNvbSAvIG91IC1cbiAgICAgICAgICAvLyAgIHBhdHRlcm46ICdkLm0uWScsXG4gICAgICAgICAgLy8gICBncm91cHM6IHtcbiAgICAgICAgICAvLyAgICAgZDogbmV3IElNYXNrLk1hc2tlZFBhdHRlcm4uR3JvdXAuUmFuZ2UoWzEsIDMxXSksXG4gICAgICAgICAgLy8gICAgIG06IG5ldyBJTWFzay5NYXNrZWRQYXR0ZXJuLkdyb3VwLlJhbmdlKFsxLCAxMl0pLFxuICAgICAgICAgIC8vICAgICBZOiBuZXcgSU1hc2suTWFza2VkUGF0dGVybi5Hcm91cC5SYW5nZShbMTkwMCwgOTk5OV0pLFxuICAgICAgICAgIC8vICAgfSxcbiAgICAgICAgICAvLyAgIGxhenk6IGZhbHNlLFxuICAgICAgICAgIC8vIH0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgICAgZGF0YXJhbmdlOiB7XG4gICAgICAgIG1hc2s6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBtYXNrOiAnMDAvMDAvMDAwMCAtIDAwLzAwLzAwMDAnLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgLy8ge1xuICAgICAgICAgIC8vICAgbWFzazogRGF0ZSxcbiAgICAgICAgICAvLyAgIC8vIG7Do28gZnVuY2lvbmEgY29tIC8gb3UgLVxuICAgICAgICAgIC8vICAgcGF0dGVybjogJ2QubS5ZJyxcbiAgICAgICAgICAvLyAgIGdyb3Vwczoge1xuICAgICAgICAgIC8vICAgICBkOiBuZXcgSU1hc2suTWFza2VkUGF0dGVybi5Hcm91cC5SYW5nZShbMSwgMzFdKSxcbiAgICAgICAgICAvLyAgICAgbTogbmV3IElNYXNrLk1hc2tlZFBhdHRlcm4uR3JvdXAuUmFuZ2UoWzEsIDEyXSksXG4gICAgICAgICAgLy8gICAgIFk6IG5ldyBJTWFzay5NYXNrZWRQYXR0ZXJuLkdyb3VwLlJhbmdlKFsxOTAwLCA5OTk5XSksXG4gICAgICAgICAgLy8gICB9LFxuICAgICAgICAgIC8vICAgbGF6eTogZmFsc2UsXG4gICAgICAgICAgLy8gfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgICBkaWE6IHtcbiAgICAgICAgbWFzazogTnVtYmVyLFxuICAgICAgICBtaW46IDAsXG4gICAgICAgIG1heDogMzEsXG4gICAgICB9LFxuICAgICAgbWVzOiB7XG4gICAgICAgIG1hc2s6IE51bWJlcixcbiAgICAgICAgbWluOiAwLFxuICAgICAgICBtYXg6IDEyLFxuICAgICAgfSxcbiAgICAgIGFubzoge1xuICAgICAgICBtYXNrOiBOdW1iZXIsXG4gICAgICAgIG1pbjogMCxcbiAgICAgICAgbWF4OiA5OTk5LFxuICAgICAgfSxcbiAgICAgIC8qIE7Do28gdXRpbGl6YWRvLCB2ZXJzw6NvIGNvbSBjYW1wbyBkZSBkaWdpdGHDp8OjbyBlcnJhZGFcbiAgICAgICAgZGltZGltOiB7XG4gICAgICAgICAgbWFzazogJ1swMDAuMDAwLjAwMC4wMDAuMDBdMCwwMCcsXG4gICAgICAgIH0sXG4gICAgICAqL1xuICAgICAgZGluaGVpcm86IHtcbiAgICAgICAgcHJlZmZpeDogJycsXG4gICAgICAgIHN1ZmZpeDogJycsXG4gICAgICAgIGZpeGVkOiB0cnVlLFxuICAgICAgICBmcmFjdGlvbkRpZ2l0czogMixcbiAgICAgICAgZGVjaW1hbFNlcGFyYXRvcjogJywnLFxuICAgICAgICB0aG91c2FuZHNTZXBhcmF0b3I6ICcuJyxcbiAgICAgICAgYXV0b0NvbXBsZXRlRGVjaW1hbDogZmFsc2UsXG4gICAgICB9LFxuICAgICAgbnVtOiB7XG4gICAgICAgIG1hc2s6ICcwJyxcbiAgICAgIH0sXG4gICAgICBwb3JjZW50YWdlbToge1xuICAgICAgICBtYXNrOiAnMFswMF0lJyxcbiAgICAgIH0sXG4gICAgICBhbHR1cmE6IHtcbiAgICAgICAgbWFzazogJ1swMDBdLGBbMDBdJyxcbiAgICAgIH0sXG4gICAgICBwZXNvOiB7XG4gICAgICAgIG1hc2s6ICdbMDAwXSxgWzAwXScsXG4gICAgICB9LFxuICAgICAgcGxhY2FjYXJybzoge1xuICAgICAgICBtYXNrOiAnYWFhey19MDAwMCcsXG4gICAgICB9LFxuICAgICAgZGRkOiB7XG4gICAgICAgIG1hc2s6ICcwMCcsXG4gICAgICB9LFxuICAgIH0sXG4gICAgdGVzdGU6IHt9XG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCgkLmlucHV0LCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIG1hc2tQYXR0ZXJuKGVsKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgbWFza1BhdHRlcm4gPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgIHZhciBtYXNrQ29uZmlnID0gY29uZmlnLm1hc2tzW2VsZW1lbnQuZGF0YXNldC5tYXNrXTtcbiAgICB2YXIgY2I7XG4gICAgdmFyIG1hc2s7XG5cbiAgICBpZiAoIW1hc2tDb25maWcpIHJldHVybjtcblxuICAgIGNiID0gbWFza0NvbmZpZy5jYiA/IG1hc2tDb25maWcuY2IgOiBudWxsO1xuXG4gICAgaWYgKGVsZW1lbnQuZGF0YXNldC5tYXNrID09PSAnZGluaGVpcm8nKSB7XG4gICAgICBlbGVtZW50LnZhbHVlID0gU2ltcGxlTWFza01vbmV5LnNldE1hc2soZWxlbWVudCwgbWFza0NvbmZpZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICghbWFza0NvbmZpZy5tYXNrKSByZXR1cm47XG4gICAgICBtYXNrID0gbmV3IElNYXNrKGVsZW1lbnQsIG1hc2tDb25maWcpO1xuICAgIH1cblxuICAgIGNvbmZpZy50ZXN0ZVtlbGVtZW50LmdldEF0dHJpYnV0ZSgnaWQnKV0gPSBtYXNrO1xuXG4gICAgaWYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykgY2IoZWxlbWVudCwgbWFzaywgbWFza0NvbmZpZyk7XG4gIH07XG5cbiAgdmFyIGRlc3Ryb3lNYXNrID0gZnVuY3Rpb24oZWwpIHtcbiAgICB2YXIgaWQgPSBlbC5nZXRBdHRyaWJ1dGUoJ2lkJyk7XG4gICAgdmFyIHVubWFza2VkID0gIGNvbmZpZy50ZXN0ZVtpZF0udW5tYXNrZWRWYWx1ZTtcblxuICAgIGNvbmZpZy50ZXN0ZVtpZF0uZGVzdHJveSgpO1xuICAgIGVsLnZhbHVlID0gdW5tYXNrZWQ7XG4gIH1cblxuICB2YXIgdXBkYXRlTWFzayA9IGZ1bmN0aW9uKGVsKSB7XG4gICAgbWFza1BhdHRlcm4oZWwpO1xuICB9XG5cbiAgdmFyIGNyZWF0ZU1hc2sgPSBmdW5jdGlvbihlbCkge1xuICAgIG1hc2tQYXR0ZXJuKGVsKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgY29uZmlnOiBjb25maWcsXG4gICAgY3JlYXRlOiBjcmVhdGVNYXNrLFxuICAgIGRlc3Ryb3k6IGRlc3Ryb3lNYXNrLFxuICAgIGluaXQ6IGluaXQsXG4gICAgdXBkYXRlOiB1cGRhdGVNYXNrXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgSW5wdXRNYXNrcyBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1pbnB1dG1hc2ssIGlucHV0JykubGVuZ3RoKSB7XG4gICAgSW5wdXRNYXNrcy5pbml0KCk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBDcmlhIHVtYSBub3ZhIGluc3TDom5jaWEgZG8gR29vZ2xlIE1hcHMgcGFyYSBzZXIgZXhpYmlkbyBuYSBww6FnaW5hXG4gKiBAcGFyYW0ge0VsZW1lbnR9IG1hcEVsZW1lbnQgRWxlbWVudG8gcXVlIGlyw6EgZXhpYmlyIG8gbWFwYS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIE9iamV0byBjb20gYXMgb3DDp8O1ZXMgZGUgY29uZmlndXJhw6fDo28gZG8gbWFwYS5cbiAqIENvbnTDqW0gbG9jYXRpb25zIGUgbWFwT3B0aW9uc1xuICovXG5cbi8qIHZhciBvcHRpb25zID0ge1xuICAvLyBhbHR1cmEgZG8gbWFwYSBlbSBwaXhlbHNcbiAgbWFwSGVpZ2h0OiA1MDAsXG4gIGxvY2F0aW9uczogW1xuICAgIHtcbiAgICAgIC8vIGlkIGRvIGVsZW1lbnRvIEhUTUwgcmVsYWNpb25hZG8gw6AgbG9jYWxpZGFkZSBleGliaWRhIG5vIG1hcGFcbiAgICAgIGlkOiAwLFxuICAgICAgLy8gbGF0aXR1ZGUgZGEgbG9jYWxpZGFkZVxuICAgICAgbGF0OiAtMjUuNDI4MTgzLFxuICAgICAgLy8gbG9uZ2l0dWRlIGRhIGxvY2FsaWRhZGVcbiAgICAgIGxuZzogLTQ5LjI2NzA3MyxcbiAgICAgIC8vIGZ1bsOnw6NvIHVzYWRhIGFvIGNsaWNhciBubyBtYXJrZXIgbm8gbWFwYVxuICAgICAgZm46IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNvbWVGdW5jdGlvbigpOyB9LFxuICAgICAgLy8gcGVxdWVubyBtb2RhbCBleGliaWRvIGFvIGNsaWNhciBubyBtYXJrZXIgbm8gbWFwYVxuICAgICAgaW5mb1dpbmRvdzoge1xuICAgICAgICBzaG93OiBmYWxzZSxcbiAgICAgICAgdGl0bGU6ICdUw610dWxvIDEnLFxuICAgICAgfSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAxLFxuICAgICAgbGF0OiAtMjUuNDMwMjA5LFxuICAgICAgbG5nOiAtNDkuMjY0NjQ2LFxuICAgICAgZm46IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNvbWVGdW5jdGlvbigwKTsgfSxcbiAgICAgIGluZm9XaW5kb3c6IHtcbiAgICAgICAgc2hvdzogZmFsc2UsXG4gICAgICAgIHRpdGxlOiAnVMOtdHVsbyAyJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogMixcbiAgICAgIGxhdDogLTI1LjQzMTc2MixcbiAgICAgIGxuZzogLTQ5LjI3MDM4NSxcbiAgICAgIGZuOiBmdW5jdGlvbiAoKSB7IHJldHVybiBzb21lRnVuY3Rpb24oMCk7IH0sXG4gICAgICBpbmZvV2luZG93OiB7XG4gICAgICAgIHNob3c6IGZhbHNlLFxuICAgICAgICB0aXRsZTogJ1TDrXR1bG8gMycsXG4gICAgICB9LFxuICAgIH0sXG4gIF0sXG4gIC8vIG9iamV0byBjb20gb3DDp8O1ZXMgZG8gR29vZ2xlIE1hcHNcbiAgbWFwT3B0aW9uczoge1xuICAgIHpvb206IDE0LFxuICAgIGNlbnRlcjogbmV3IGdvb2dsZS5tYXBzLkxhdExuZygtMjUuNDI3NzAyLCAtNDkuMjY1MTU5KSxcbiAgICBtYXBUeXBlSWQ6IGdvb2dsZS5tYXBzLk1hcFR5cGVJZC5ST0FETUFQLFxuICB9LFxufTtcblxuQnNNYXBzLmluaXQobWFwRWxlbWVudCwgb3B0aW9ucyk7ICovXG5cbnZhciBCc01hcHMgPSAoZnVuY3Rpb24gKCkge1xuICB2YXIgY29uZmlnID0ge1xuICAgIC8vIGluZGljYSBzZSBvIG1hcmtlciBlc3TDoSBzZWxlY2lvbmFkb1xuICAgIHNlbGVjdGVkTWFya2VyOiBmYWxzZSxcbiAgICBpbmZvV2luZG93OiBudWxsLFxuICAgIGljb25zOiB7XG4gICAgICBwYXRoOiAnYXNzZXRzL2ltZy9pY29ucy8nLFxuICAgICAgbWFya2VyOiAnbWFwLW1hcmtlci5zdmcnLFxuICAgICAgc2VsZWN0ZWRNYXJrZXI6ICdtYXAtbWFya2VyLXNlbGVjdGVkLnN2ZycsXG4gICAgICBzaXplOiB7XG4gICAgICAgIGhlaWdodDogMzIsXG4gICAgICAgIHdpZHRoOiAyMCxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBtYXA6IG51bGwsXG4gICAgb3B0aW9uczogbnVsbCxcbiAgICBib3VuZHM6IG51bGwsXG4gICAgZ2VvY29kZXI6IG51bGwsXG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAobWFwRWxlbWVudCwgb3B0aW9ucykge1xuXG4gICAgaWYgKG9wdGlvbnMpIGNvbmZpZy5vcHRpb25zID0gb3B0aW9ucztcbiAgICBpZiAobWFwRWxlbWVudCkge1xuICAgICAgLy8gQ3JpYSB1bWEgbm92YSBpbnN0w6JuY2lhIGRvIEdvb2dsZSBNYXBzXG4gICAgICBjb25maWcubWFwID0gY3JlYXRlTWFwKG1hcEVsZW1lbnQsIG9wdGlvbnMubWFwT3B0aW9ucyk7XG4gICAgICBjb25maWcuYm91bmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZ0JvdW5kcygpO1xuICAgICAgY29uZmlnLmdlb2NvZGVyID0gbmV3IGdvb2dsZS5tYXBzLkdlb2NvZGVyKCk7XG4gICAgICB3aW5kb3cubWFwVGVzdGUgPSBjb25maWcubWFwO1xuXG4gICAgICAvLyBEZWZpbmUgYSBhbHR1cmEgZG8gbWFwYVxuICAgICAgaWYgKG9wdGlvbnMubWFwSGVpZ2h0KSB7XG4gICAgICAgIG1hcEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gb3B0aW9ucy5tYXBIZWlnaHQgKyAncHgnO1xuICAgICAgfVxuXG4gICAgICAvLyBJbnNlcmUgb3MgbWFyY2Fkb3Jlc1xuICAgICAgaWYgKG9wdGlvbnMubG9jYXRpb25zLmxlbmd0aCkge1xuICAgICAgICBvcHRpb25zLmxvY2F0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChsb2NhdGlvbikge1xuICAgICAgICAgIGlmIChsb2NhdGlvbi5hZGRyZXNzKSB7XG4gICAgICAgICAgICBjb25maWcuZ2VvY29kZXIuZ2VvY29kZSh7XG4gICAgICAgICAgICAgIGFkZHJlc3M6IGxvY2F0aW9uLmFkZHJlc3MgKyAnLCBCcmFzaWwnLFxuICAgICAgICAgICAgICByZWdpb246ICdCUicsXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzdWx0cywgc3RhdHVzKSB7XG4gICAgICAgICAgICAgIGlmIChzdGF0dXMgPT0gZ29vZ2xlLm1hcHMuR2VvY29kZXJTdGF0dXMuT0spIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBsYXRpdHVkZSA9IHJlc3VsdHNbMF0uZ2VvbWV0cnkubG9jYXRpb24ubGF0KCk7XG4gICAgICAgICAgICAgICAgICB2YXIgbG9uZ2l0dWRlID0gcmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKTtcblxuICAgICAgICAgICAgICAgICAgbG9jYXRpb24ubGF0ID0gbGF0aXR1ZGU7XG4gICAgICAgICAgICAgICAgICBsb2NhdGlvbi5sbmcgPSBsb25naXR1ZGU7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgYWRkTWFya2VyKGNvbmZpZy5tYXAsIGxvY2F0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhZGRNYXJrZXIoY29uZmlnLm1hcCwgbG9jYXRpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHZhciBhanVzdENlbnRlclpvb20gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxvY2F0aW9ucyA9IGNvbmZpZy5vcHRpb25zLmxvY2F0aW9ucztcbiAgICBpZiAobG9jYXRpb25zLmxlbmd0aCA+IDEpIHtcbiAgICAgIGlmIChjb25maWcuYm91bmRzKSB7XG4gICAgICAgIGNvbmZpZy5tYXAuZml0Qm91bmRzKGNvbmZpZy5ib3VuZHMpOyAvLyBhdXRvLXpvb21cbiAgICAgICAgY29uZmlnLm1hcC5wYW5Ub0JvdW5kcyhjb25maWcuYm91bmRzKTsgLy8gYXV0by1jZW50ZXJcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uZmlnLm1hcC5zZXRDZW50ZXIobmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbnNbMF0ubGF0LCBsb2NhdGlvbnNbMF0ubG5nKSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBDcmlhIHVtYSBub3ZhIGluc3TDom5jaWEgZG8gbWFwYVxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IG1hcEVsZW1lbnQgRE9NIGVsZW1lbnQgZG8gbWFwYVxuICAgKiBAcGFyYW0ge09iamVjdH0gbWFwT3B0aW9ucyBPcMOnw7VlcyBkZSBpbmljaWFsaXphw6fDo28gZG8gR29vZ2xlIE1hcHNcbiAgICogaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vbWFwcy9kb2N1bWVudGF0aW9uL2phdmFzY3JpcHQvdHV0b3JpYWwjTWFwT3B0aW9uc1xuICAgKiBAcmV0dXJuIHtPYmplY3R9IEluc3TDom5jaWEgZG8gR29vZ2xlIE1hcHNcbiAgKi9cbiAgdmFyIGNyZWF0ZU1hcCA9IGZ1bmN0aW9uIChtYXBFbGVtZW50LCBtYXBPcHRpb25zKSB7XG4gICAgcmV0dXJuIG5ldyBnb29nbGUubWFwcy5NYXAobWFwRWxlbWVudCwgbWFwT3B0aW9ucyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkaWNpb25hIHVtIG1hcmtlciAocGluKSBubyBtYXBhXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBtYXAgICAgICBJbnN0w6JuY2lhIGRvIEdvb2dsZSBNYXBzXG4gICAqIEBwYXJhbSB7QXJyYXl9ICBsb2NhdGlvbiBUw610dWxvLCBsYXRpdHVkZSBlIGxvbmdpdHVkZSBkbyBtYXJrZXJcbiAgICogQHBhcmFtIHtTdHJpbmd9IGljb24gICAgIEltYWdlbVxuICAqL1xuICB2YXIgYWRkTWFya2VyID0gZnVuY3Rpb24gKG1hcCwgbG9jYXRpb24sIGljb24pIHtcbiAgICB2YXIgbWFya2VyO1xuICAgIHZhciBpbmZvV2luZG93ID0gbnVsbDtcblxuICAgIGlmIChpY29uKSBjb25maWcuaWNvbnMubWFya2VyID0gaWNvbjtcblxuICAgIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgcG9zaXRpb246IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobG9jYXRpb24ubGF0LCBsb2NhdGlvbi5sbmcpLFxuICAgICAgbWFwOiBtYXAsXG4gICAgICBpY29uOiB7XG4gICAgICAgIHVybDogY29uZmlnLmljb25zLnBhdGggKyBjb25maWcuaWNvbnMubWFya2VyLFxuICAgICAgICAvLyB1c2FyIHNjYWxlZFNpemUgZW0gdG9kbyBzZXRJY29uKClcbiAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoY29uZmlnLmljb25zLnNpemUud2lkdGgsIGNvbmZpZy5pY29ucy5zaXplLmhlaWdodCksXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgY29uZmlnLmJvdW5kcy5leHRlbmQobmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxuZykpO1xuICAgIGFqdXN0Q2VudGVyWm9vbSgpO1xuXG4gICAgaWYgKGxvY2F0aW9uLmluZm9XaW5kb3cpIHtcbiAgICAgIGluZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7XG4gICAgICAgIGNvbnRlbnQ6IGxvY2F0aW9uLmluZm9XaW5kb3cudGl0bGUsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAobG9jYXRpb24uZm4gfHwgaW5mb1dpbmRvdykge1xuICAgICAgbWFya2VyLmFkZExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGluZm9XaW5kb3cpIHtcbiAgICAgICAgICB1cGRhdGVBY3RpdmVJbmZvV2luZG93KGluZm9XaW5kb3cpO1xuICAgICAgICAgIGluZm9XaW5kb3cuY2xvc2UoKTtcbiAgICAgICAgICBpbmZvV2luZG93Lm9wZW4obWFwLCBtYXJrZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxvY2F0aW9uLmZuKSB7XG4gICAgICAgICAgbG9jYXRpb24uZm4oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIF90b2dnbGVTZWxlY3RlZE1hcmtlckljb24odGhpcyk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgLy8gRGVpeGEgb3UgcmV0aXJhIG8gTWFya2VyIGNvbW8gc2VsZWNpb25hZG9cbiAgdmFyIF90b2dnbGVTZWxlY3RlZE1hcmtlckljb24gPSBmdW5jdGlvbiAobWFya2VyKSB7XG4gICAgaWYgKGNvbmZpZy5zZWxlY3RlZE1hcmtlcikge1xuICAgICAgY29uZmlnLnNlbGVjdGVkTWFya2VyLnNldEljb24oe1xuICAgICAgICB1cmw6IGNvbmZpZy5pY29ucy5wYXRoICsgY29uZmlnLmljb25zLm1hcmtlcixcbiAgICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoY29uZmlnLmljb25zLnNpemUud2lkdGgsIGNvbmZpZy5pY29ucy5zaXplLmhlaWdodCksXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBtYXJrZXIuc2V0SWNvbih7XG4gICAgICB1cmw6IGNvbmZpZy5pY29ucy5wYXRoICsgY29uZmlnLmljb25zLnNlbGVjdGVkTWFya2VyLFxuICAgICAgc2NhbGVkU2l6ZTogbmV3IGdvb2dsZS5tYXBzLlNpemUoY29uZmlnLmljb25zLnNpemUud2lkdGgsIGNvbmZpZy5pY29ucy5zaXplLmhlaWdodCksXG4gICAgfSk7XG4gICAgY29uZmlnLnNlbGVjdGVkTWFya2VyID0gbWFya2VyO1xuICB9O1xuXG4gIC8vIENyaWEgdW1hIG5vdmEgSW5mb1dpbmRvd1xuICB2YXIgdXBkYXRlQWN0aXZlSW5mb1dpbmRvdyA9IGZ1bmN0aW9uIChpbmZvV2luZG93KSB7XG4gICAgaWYgKGNvbmZpZy5pbmZvV2luZG93KSBjb25maWcuaW5mb1dpbmRvdy5jbG9zZSgpO1xuICAgIGNvbmZpZy5pbmZvV2luZG93ID0gaW5mb1dpbmRvdztcbiAgfTtcblxuICAvKipcbiAgIEdldCBVc2VyIExvY2F0aW9uIENvb3Jkc1xuICAgKiBAcmV0dXJuIHtPYmplY3R9IENvb3JkcyAobGF0LCBsbmcpIG9mIHVzZXIgbG9jYXRpb25cbiAgICovXG4gIHZhciBnZXRVc2VyTG9jYXRpb25Db29yZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGdldFVzZXJMb2NhdGlvbihmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGxhdDogcG9zaXRpb24uY29vcmRzLmxhdGl0dWRlLFxuICAgICAgICBsbmc6IHBvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGUsXG4gICAgICB9O1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIG5lZWQgbW9yZSB0ZXN0c1xuICB2YXIgZ2V0Q29vcmRpbmF0ZXNGcm9tQWRkcmVzcyA9IGZ1bmN0aW9uIChhZGRyZXNzKSB7XG4gICAgdmFyIGdlb2NvZGVyID0gbmV3IGdvb2dsZS5tYXBzLkdlb2NvZGVyKCk7XG5cbiAgICBnZW9jb2Rlci5nZW9jb2RlKHsgYWRkcmVzczogYWRkcmVzcyB9LCBmdW5jdGlvbiAocmVzdWx0cywgc3RhdHVzKSB7XG4gICAgICBpZiAoc3RhdHVzID09PSBnb29nbGUubWFwcy5HZW9jb2RlclN0YXR1cy5PSykge1xuICAgICAgICB2YXIgcG9zID0ge1xuICAgICAgICAgIGxhdDogcmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKSxcbiAgICAgICAgICBsbmc6IHJlc3VsdHNbMF0uZ2VvbWV0cnkubG9jYXRpb24ubG5nKCksXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBwb3M7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIGdldCBBZGRyZXNzIEZyb20gQ29vcmRpbmF0ZXNcbiAgICogQHBhcmFtICB7TnVtYmVyfSAgIGxhdCBsYXRpdHVkZVxuICAgKiBAcGFyYW0gIHtOdW1iZXJ9ICAgbG5nIGxvbmdpdHVkZVxuICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2IgIGNhbGJhY2sgZm5jdGlvblxuICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gICAgIGNhbGxiYWNrIGZ1bmNpb24gd2l0aCBhZGRyZXNzZXMgYXMgcGFyYW1ldGVyXG4gICAqL1xuICB2YXIgZ2V0QWRkcmVzc0Zyb21Db29yZGluYXRlcyA9IGZ1bmN0aW9uIChsYXQsIGxuZywgY2IpIHtcbiAgICB2YXIgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcbiAgICB2YXIgbGF0bG5nID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsYXQsIGxuZyk7XG5cbiAgICBpZiAodHlwZW9mIGNiICE9PSAnZnVuY3Rpb24nKSBjYiA9IGZ1bmN0aW9uICgpIHt9O1xuXG4gICAgcmV0dXJuIGdlb2NvZGVyLmdlb2NvZGUoeyBsYXRMbmc6IGxhdGxuZyB9LCBmdW5jdGlvbiAocmVzdWx0cywgc3RhdHVzKSB7XG4gICAgICBpZiAoc3RhdHVzID09PSBnb29nbGUubWFwcy5HZW9jb2RlclN0YXR1cy5PSykge1xuICAgICAgICByZXR1cm4gY2IocmVzdWx0cyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdldCBVc2VyIExvY2F0aW9uXG4gICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYiAgY2FsYmFjayBmbmN0aW9uXG4gICAqIEByZXR1cm4ge0Z1bmN0aW9ufSAgICAgY2FsbGJhY2sgZnVuY2lvbiB3aXRoIGFkZHJlc3NlcyBhcyBwYXJhbWV0ZXJcbiAgICovXG4gIHZhciBnZXRVc2VyTG9jYXRpb24gPSBmdW5jdGlvbiAoY2IpIHtcbiAgICBpZiAodHlwZW9mIGNiICE9PSAnZnVuY3Rpb24nKSBjYiA9IGZ1bmN0aW9uICgpIHt9O1xuXG4gICAgaWYgKG5hdmlnYXRvci5nZW9sb2NhdGlvbiAmJiB0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGNiLCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGNiKCdFcnJvOiBPIHNlcnZpw6dvIGRlIGdlb2xvY2FsaXphw6fDo28gZmFsaG91LicsIGVycm9yKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IEdlb2xvY2F0aW9uXG4gICAgcmV0dXJuIGNiKG51bGwsICdFcnJvOiBPIHNldSBuYXZlZ2Fkb3IgbsOjbyBwb3NzdWkgc3Vwb3J0ZSDDoCBnZW9sb2NhbGl6YcOnw6NvLicpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBnZXRMb2NhdGlvbkJ5VHlwZUZyb21HZW9jb2RlckFkZHJlc3Nlc1xuICAgKlxuICAgKiBAbGluayBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9tYXBzL2RvY3VtZW50YXRpb24vZ2VvY29kaW5nL2ludHJvI1R5cGVzXG4gICAqXG4gICAqIEBwYXJhbSAge0FycmF5fSAgICByZXN1bHRzIExpc3Qgb2YgR29vZ2xlIEdlb2NvZGVyJ3MgYWRkcmVzc2VzIGJ5IGNvb3Jkc1xuICAgKiBAcGFyYW0gIHtTdHJpbmd9ICB0eXBlICAgIFR5cGUgb2YgdGhlIHJlc3VsdFxuICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gY2IgICAgICBhIGNhbGxiYWNrIGZ1bmN0aW9uXG4gICAqL1xuICB2YXIgZ2V0TG9jYXRpb25CeVR5cGVGcm9tR2VvY29kZXJBZGRyZXNzZXMgPSBmdW5jdGlvbiAocmVzdWx0cywgdHlwZSwgY2IpIHtcbiAgICB2YXIgcmVzdWx0QnlUeXBlID0gbnVsbDtcbiAgICB2YXIgY29tcG9uZW50c0J5VHlwZSA9IG51bGw7XG4gICAgdmFyIGZpbHRlclR5cGUgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICByZXR1cm4gcmVzdWx0LnR5cGVzICYmIHJlc3VsdC50eXBlcy5pbmNsdWRlcyh0eXBlKTtcbiAgICB9O1xuXG4gICAgaWYgKHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykgY2IgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICBpZiAodHlwZW9mIHR5cGUgIT09ICdmdW5jdGlvbicpIHR5cGUgPSAnYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8xJztcblxuICAgIGlmIChyZXN1bHRzICYmIHJlc3VsdHMubGVuZ3RoKSB7XG4gICAgICByZXN1bHRCeVR5cGUgPSByZXN1bHRzLmZpbHRlcihmaWx0ZXJUeXBlKTtcblxuICAgICAgY29tcG9uZW50c0J5VHlwZSA9IHJlc3VsdEJ5VHlwZVswXS5hZGRyZXNzX2NvbXBvbmVudHMuZmlsdGVyKGZpbHRlclR5cGUpO1xuXG4gICAgICBpZiAoY29tcG9uZW50c0J5VHlwZS5sZW5ndGgpIHtcbiAgICAgICAgY2Ioe1xuICAgICAgICAgIG5hbWU6IGNvbXBvbmVudHNCeVR5cGVbMF0ubG9uZ19uYW1lLFxuICAgICAgICAgIGluaXRpYWxzOiBjb21wb25lbnRzQnlUeXBlWzBdLnNob3J0X25hbWUsXG4gICAgICAgIH0sIGNvbXBvbmVudHNCeVR5cGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2Ioe30sICdFcnJvOiBOZW5odW0gY29tcG9uZW50ZSBlbmNvbnRyYWRvIHBhcmEgXCInICsgdHlwZSArICdcIi4nKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY2Ioe30sICdFcnJvOiBOZW5odW0gcmVzdWx0YWRvIGVuY29udHJhZG8gcGFyYSBcIicgKyB0eXBlICsgJ1wiLicpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogR2V0IExvY2F0aW9uIFN0YXRlXG4gICAqXG4gICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYiBjYWxsYmFjayBmdW5jdGlvblxuICAgKi9cbiAgdmFyIGdldExvY2F0aW9uU3RhdGUgPSBmdW5jdGlvbiAoY2IpIHtcbiAgICB2YXIgdHlwZSA9ICdhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzEnO1xuICAgIGlmICh0eXBlb2YgY2IgIT09ICdmdW5jdGlvbicpIGNiID0gZnVuY3Rpb24gKCkge307XG5cbiAgICBpbml0R29vZ2xlTWFwKGZ1bmN0aW9uICgpIHtcbiAgICAgIGdldFVzZXJMb2NhdGlvbihmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgICAgZ2V0QWRkcmVzc0Zyb21Db29yZGluYXRlcyhcbiAgICAgICAgICBwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGUsXG4gICAgICAgICAgcG9zaXRpb24uY29vcmRzLmxvbmdpdHVkZSxcbiAgICAgICAgICBmdW5jdGlvbiAocmVzdWx0cykge1xuICAgICAgICAgICAgZ2V0TG9jYXRpb25CeVR5cGVGcm9tR2VvY29kZXJBZGRyZXNzZXMocmVzdWx0cywgdHlwZSwgY2IpO1xuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICBhZGRNYXJrZXI6IGFkZE1hcmtlcixcbiAgICBjcmVhdGVNYXA6IGNyZWF0ZU1hcCxcbiAgICBnZXRDb29yZGluYXRlc0Zyb21BZGRyZXNzOiBnZXRDb29yZGluYXRlc0Zyb21BZGRyZXNzLFxuICAgIGdldEFkZHJlc3NGcm9tQ29vcmRpbmF0ZXM6IGdldEFkZHJlc3NGcm9tQ29vcmRpbmF0ZXMsXG4gICAgZ2V0VXNlckxvY2F0aW9uOiBnZXRVc2VyTG9jYXRpb24sXG4gICAgZ2V0TG9jYXRpb25TdGF0ZTogZ2V0TG9jYXRpb25TdGF0ZSxcbiAgfTtcbn0oKSk7XG4iLCJpZiAoIU9iamVjdC52YWx1ZXMpIHtcbiAgT2JqZWN0LnZhbHVlcyA9IGZ1bmN0aW9uIChvKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG8pLm1hcChmdW5jdGlvbiAoaykge1xuICAgICAgcmV0dXJuIG9ba107XG4gICAgfSk7XG4gIH07XG59XG4iLCIvLyBVc2UgaW4gTGlnaHRQaWNrXG5pZiAoIU9iamVjdC5hc3NpZ24pIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE9iamVjdCwgJ2Fzc2lnbicsIHtcbiAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgd3JpdGFibGU6IHRydWUsXG4gICAgdmFsdWU6IGZ1bmN0aW9uKHRhcmdldCkge1xuICAgICAgJ3VzZSBzdHJpY3QnO1xuICAgICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkIHx8IHRhcmdldCA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCBmaXJzdCBhcmd1bWVudCB0byBvYmplY3QnKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHRvID0gT2JqZWN0KHRhcmdldCk7XG4gICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgbmV4dFNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgaWYgKG5leHRTb3VyY2UgPT09IHVuZGVmaW5lZCB8fCBuZXh0U291cmNlID09PSBudWxsKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgbmV4dFNvdXJjZSA9IE9iamVjdChuZXh0U291cmNlKTtcblxuICAgICAgICB2YXIga2V5c0FycmF5ID0gT2JqZWN0LmtleXMoT2JqZWN0KG5leHRTb3VyY2UpKTtcbiAgICAgICAgZm9yICh2YXIgbmV4dEluZGV4ID0gMCwgbGVuID0ga2V5c0FycmF5Lmxlbmd0aDsgbmV4dEluZGV4IDwgbGVuOyBuZXh0SW5kZXgrKykge1xuICAgICAgICAgIHZhciBuZXh0S2V5ID0ga2V5c0FycmF5W25leHRJbmRleF07XG4gICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG5leHRTb3VyY2UsIG5leHRLZXkpO1xuICAgICAgICAgIGlmIChkZXNjICE9PSB1bmRlZmluZWQgJiYgZGVzYy5lbnVtZXJhYmxlKSB7XG4gICAgICAgICAgICB0b1tuZXh0S2V5XSA9IG5leHRTb3VyY2VbbmV4dEtleV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdG87XG4gICAgfVxuICB9KTtcbn07XG5cbihmdW5jdGlvbiAoYXJyKSB7XG4gIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaWYgKGl0ZW0uaGFzT3duUHJvcGVydHkoJ3JlbW92ZScpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdGVtLCAncmVtb3ZlJywge1xuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgICAgdGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn0pKFtFbGVtZW50LnByb3RvdHlwZSwgQ2hhcmFjdGVyRGF0YS5wcm90b3R5cGUsIERvY3VtZW50VHlwZS5wcm90b3R5cGVdKTtcblxuaWYgKCFBcnJheS5wcm90b3R5cGUuaW5jbHVkZXMpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2luY2x1ZGVzJywge1xuICAgIHZhbHVlOiBmdW5jdGlvbihzZWFyY2hFbGVtZW50LCBmcm9tSW5kZXgpIHtcblxuICAgICAgLy8gMS4gTGV0IE8gYmUgPyBUb09iamVjdCh0aGlzIHZhbHVlKS5cbiAgICAgIGlmICh0aGlzID09IG51bGwpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJ0aGlzXCIgaXMgbnVsbCBvciBub3QgZGVmaW5lZCcpO1xuICAgICAgfVxuXG4gICAgICB2YXIgbyA9IE9iamVjdCh0aGlzKTtcblxuICAgICAgLy8gMi4gTGV0IGxlbiBiZSA/IFRvTGVuZ3RoKD8gR2V0KE8sIFwibGVuZ3RoXCIpKS5cbiAgICAgIHZhciBsZW4gPSBvLmxlbmd0aCA+Pj4gMDtcblxuICAgICAgLy8gMy4gSWYgbGVuIGlzIDAsIHJldHVybiBmYWxzZS5cbiAgICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyA0LiBMZXQgbiBiZSA/IFRvSW50ZWdlcihmcm9tSW5kZXgpLlxuICAgICAgLy8gICAgKElmIGZyb21JbmRleCBpcyB1bmRlZmluZWQsIHRoaXMgc3RlcCBwcm9kdWNlcyB0aGUgdmFsdWUgMC4pXG4gICAgICB2YXIgbiA9IGZyb21JbmRleCB8IDA7XG5cbiAgICAgIC8vIDUuIElmIG4g4omlIDAsIHRoZW5cbiAgICAgIC8vICBhLiBMZXQgayBiZSBuLlxuICAgICAgLy8gNi4gRWxzZSBuIDwgMCxcbiAgICAgIC8vICBhLiBMZXQgayBiZSBsZW4gKyBuLlxuICAgICAgLy8gIGIuIElmIGsgPCAwLCBsZXQgayBiZSAwLlxuICAgICAgdmFyIGsgPSBNYXRoLm1heChuID49IDAgPyBuIDogbGVuIC0gTWF0aC5hYnMobiksIDApO1xuXG4gICAgICAvLyA3LiBSZXBlYXQsIHdoaWxlIGsgPCBsZW5cbiAgICAgIHdoaWxlIChrIDwgbGVuKSB7XG4gICAgICAgIC8vIGEuIExldCBlbGVtZW50SyBiZSB0aGUgcmVzdWx0IG9mID8gR2V0KE8sICEgVG9TdHJpbmcoaykpLlxuICAgICAgICAvLyBiLiBJZiBTYW1lVmFsdWVaZXJvKHNlYXJjaEVsZW1lbnQsIGVsZW1lbnRLKSBpcyB0cnVlLCByZXR1cm4gdHJ1ZS5cbiAgICAgICAgLy8gYy4gSW5jcmVhc2UgayBieSAxLlxuICAgICAgICAvLyBOT1RFOiA9PT0gcHJvdmlkZXMgdGhlIGNvcnJlY3QgXCJTYW1lVmFsdWVaZXJvXCIgY29tcGFyaXNvbiBuZWVkZWQgaGVyZS5cbiAgICAgICAgaWYgKG9ba10gPT09IHNlYXJjaEVsZW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBrKys7XG4gICAgICB9XG5cbiAgICAgIC8vIDguIFJldHVybiBmYWxzZVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSk7XG59XG5cbi8vIC8vIFVzZSBpbiBMaWdodFBpY2tcbi8vIGlmICghU3RyaW5nLnByb3RvdHlwZS5zdGFydHNXaXRoKSB7XG4vLyAgIFN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aCA9IGZ1bmN0aW9uKHNlYXJjaFN0cmluZywgcG9zaXRpb24pIHtcbi8vICAgICBwb3NpdGlvbiA9IHBvc2l0aW9uIHx8IDA7XG4vLyAgICAgcmV0dXJuIHRoaXMuaW5kZXhPZihzZWFyY2hTdHJpbmcsIHBvc2l0aW9uKSA9PT0gcG9zaXRpb247XG4vLyAgIH07XG4vLyB9OyIsIi8qKlxuICogU2hpZnQtc2VsZWN0IE11bHRpcGxlIEl0ZW1zXG4gKiBTZWxlY3QgYWxsIGNoZWNrYm94ZXMgYmV0d2VlbiBsYXN0Q2hlY2tlZCBhbmQgY3VycmVudENoZWNrZWQgaWZcbiAqIHNoaWZ0S2V5IGlzIHByZXNzZWQgZHVyaW5nIGNsaWNrXG4gKlxuICogQFVzZSB0aGUgZnVuY3Rpb24gcmVjZWl2ZSBhbiBhcnJheSBvZiBjaGVja2JveGVzXG4gKiBhbmQgYWN0aXZlIHRoZSBzaGlmdFNlbGVjdCBvbmx5IGZvciB0aGlzIGFycmF5XG4gKlxuICogQHBhcmFtIHtBcnJheX0gY2hlY2tib3hlcyAgYW4gYXJyYXkgb2YgY2hlY2tib3ggRE9NIGVsZW1lbnRzXG4gKi9cbnZhciBzaGlmdFNlbGVjdE11bHRpcGxlQ2hlY2tib3hlcyA9IGZ1bmN0aW9uIChjaGVja2JveGVzKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgbGFzdElucHV0Q2hlY2tlZDogbnVsbCxcbiAgfTtcblxuICAvKipcbiAgICogSW5pdFxuICAgKi9cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGNoZWNrYm94ZXMubGVuZ3RoKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNoZWNrYm94ZXMsIGZ1bmN0aW9uIChjaGVja2JveCkge1xuICAgICAgICBjaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNoaWZ0U2VsZWN0KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogc2hpZnQgU2VsZWN0IG9uIENoYW5nZVxuICAgKiBAcGFyYW0gIHtPYmplY3R9IGUgIGEgY2xpY2sgZXZlbnQgaW4gYSBjaGVja2JveFxuICAgKi9cbiAgdmFyIHNoaWZ0U2VsZWN0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICB2YXIgaW5wdXQgPSBlLnRhcmdldDtcbiAgICB2YXIgc3RhcnQgPSBudWxsO1xuICAgIHZhciBlbmQgPSBudWxsO1xuXG4gICAgaWYgKChpbnB1dCB8fCB7fSkudHlwZSAhPT0gJ2NoZWNrYm94JykgcmV0dXJuO1xuXG4gICAgaWYgKCFjb25maWcubGFzdElucHV0Q2hlY2tlZCkge1xuICAgICAgY29uZmlnLmxhc3RJbnB1dENoZWNrZWQgPSBpbnB1dDtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoZS5zaGlmdEtleSkge1xuICAgICAgc3RhcnQgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGNoZWNrYm94ZXMsIGNvbmZpZy5sYXN0SW5wdXRDaGVja2VkKTtcbiAgICAgIGVuZCA9IEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoY2hlY2tib3hlcywgaW5wdXQpO1xuXG4gICAgICBpZiAoTWF0aC5hYnMoc3RhcnQgLSBlbmQpID4gMSkge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoY2hlY2tib3hlcywgW1xuICAgICAgICAgIE1hdGgubWluKHN0YXJ0LCBlbmQpLFxuICAgICAgICAgIE1hdGgubWF4KHN0YXJ0LCBlbmQpICsgMSxcbiAgICAgICAgXSkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbmZpZy5sYXN0SW5wdXRDaGVja2VkID0gaW5wdXQ7XG4gIH07XG5cbiAgaW5pdCgpO1xufTtcblxuLyoqXG4gKiBJbml0IE1vZGFsIENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgc2VsZWN0b3JzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXNoaWZ0LXNlbGVjdCcpO1xuICBpZiAoc2VsZWN0b3JzLmxlbmd0aCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoc2VsZWN0b3JzLCBmdW5jdGlvbiAoc2VsZWN0aW9uKSB7XG4gICAgICB2YXIgY2hlY2tib3hlcyA9IHNlbGVjdGlvbi5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKTtcbiAgICAgIGlmIChjaGVja2JveGVzLmxlbmd0aCkge1xuICAgICAgICBzaGlmdFNlbGVjdE11bHRpcGxlQ2hlY2tib3hlcyhjaGVja2JveGVzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSk7XG4iLCIvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9wdC1CUi9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9TdHJpbmcvaW5jbHVkZXMjSW1wbGVtZW50YSVDMyVBNyVDMyVBM29cbmlmICghU3RyaW5nLnByb3RvdHlwZS5pbmNsdWRlcykge1xuICBTdHJpbmcucHJvdG90eXBlLmluY2x1ZGVzID0gZnVuY3Rpb24oKSB7J3VzZSBzdHJpY3QnO1xuICAgIHJldHVybiBTdHJpbmcucHJvdG90eXBlLmluZGV4T2YuYXBwbHkodGhpcywgYXJndW1lbnRzKSAhPT0gLTE7XG4gIH07XG59XG4iLCIvKipcbiAqIFNvcnQgdGFibGVcbiAqXG4gKiBSZWZlcmVuY2U6XG4gKiBodHRwczovL2dpdGh1Yi5jb20vdHJpc3Rlbi90YWJsZXNvcnRcbiAqL1xudmFyIEJzVGFibGVTb3J0ID0gKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAodGFibGUpIHtcbiAgICBpZiAodGFibGUpIFRhYmxlc29ydCh0YWJsZSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcbiIsIi8qKlxuICogTXVsdGlsaW5lIHRleHQgRWxsaXBzaXMgKHNoYXZlLmpzKVxuICpcbiAqIFJlZmVyZW5jZTpcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9kb2xsYXJzaGF2ZWNsdWIvc2hhdmVcbiAqL1xudmFyIEJzVGV4dEVsbGlwc2lzID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gQ29uZmlnXG4gIHZhciBjb25maWcgPSB7XG4gICAgZWxlbWVudDogJycsXG4gICAgbWF4SGVpZ2h0OiBudWxsLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICBjb25maWcuZWxlbWVudCA9IG9wdGlvbnMuZWxlbWVudDtcbiAgICBjb25maWcubWF4SGVpZ2h0ID0gb3B0aW9ucy5tYXhIZWlnaHQ7XG4gICAgZWxsaXBzaXMoKTtcbiAgfTtcblxuICB2YXIgZWxsaXBzaXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgc2hhdmUoY29uZmlnLmVsZW1lbnQsIGNvbmZpZy5tYXhIZWlnaHQpO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG4iLCIvKipcbiAqIEJzIFRleHQgVHlwZXJcbiAqXG4gKiBSZWZlcmVuY2U6XG4gKiBodHRwczovL2NvZGVwZW4uaW8vaGktaW0tc2kvcGVuL0RIb3VwXG4gKiBbVE9ET10gSW1wcm92ZTogaHR0cHM6Ly9jb2RlcGVuLmlvL2RhbmllbGdyb2VuL3Blbi9WZVJQT3FcbiAqIFtUT0RPXSBFeHRlbmQ6IGh0dHBzOi8vZ2l0aHViLmNvbS9uay1vL2phcmFsbGF4L2Jsb2IvbWFzdGVyL3NyYy9qYXJhbGxheC5qcyNMMjA2XG4gKi9cbnZhciBCc1RleHRUeXBlID0gZnVuY3Rpb24gKCkge1xuICAvLyBDb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICB0ZXh0QXJyOiBudWxsLFxuICAgIGVsOiBudWxsLFxuICAgIGxvb3BOdW06IDAsXG4gICAgcGF1c2VUaW1lOiAyMDAwLFxuICAgIHdyaXRlVGltZTogMTAwLFxuICAgIGRlbFRpbWU6IDUwLFxuICAgIHR4dDogJycsXG4gICAgdGljazogdGljayxcbiAgICBpc0RlbGV0aW5nOiBmYWxzZSxcbiAgICBmdWxsVHh0OiAnJyxcbiAgICB0YWc6ICcnLFxuICAgIHRhZ05hbWU6ICdzcGFuJyxcbiAgICB0YWdDbGFzczogJycsXG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgIGNvbmZpZy50ZXh0QXJyID0gb3B0aW9ucy50ZXh0QXJyO1xuICAgIGNvbmZpZy5lbCA9IG9wdGlvbnMuZWw7XG4gICAgY29uZmlnLnBhdXNlVGltZSA9IG9wdGlvbnMucGF1c2VUaW1lO1xuICAgIGNvbmZpZy5lbC5pbm5lckhUTUwgPSAnPCcgKyBjb25maWcudGFnTmFtZSArICcgY2xhc3M9XCJicy10ZXh0dHlwZSAnICsgY29uZmlnLnRhZ0NsYXNzICsgJ1wiPjwvJyArIGNvbmZpZy50YWdOYW1lICsgJz4nO1xuICAgIGNvbmZpZy50YWcgPSBjb25maWcuZWwucXVlcnlTZWxlY3RvcignLmJzLXRleHR0eXBlJyk7XG4gICAgdGljaygpO1xuICB9O1xuXG4gIHZhciB0aWNrID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBkZWx0YSA9IGNvbmZpZy53cml0ZVRpbWU7XG4gICAgdmFyIGkgPSBjb25maWcubG9vcE51bSAlIGNvbmZpZy50ZXh0QXJyLmxlbmd0aDtcblxuICAgIGNvbmZpZy5mdWxsVHh0ID0gY29uZmlnLnRleHRBcnJbaV07XG5cbiAgICBpZiAoY29uZmlnLmlzRGVsZXRpbmcpIHtcbiAgICAgIGNvbmZpZy50eHQgPSBjb25maWcuZnVsbFR4dC5zdWJzdHJpbmcoMCwgY29uZmlnLnR4dC5sZW5ndGggLSAxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uZmlnLnR4dCA9IGNvbmZpZy5mdWxsVHh0LnN1YnN0cmluZygwLCBjb25maWcudHh0Lmxlbmd0aCArIDEpO1xuICAgIH1cblxuICAgIGNvbmZpZy50YWcuaW5uZXJIVE1MID0gY29uZmlnLnR4dDtcblxuICAgIGlmIChjb25maWcuaXNEZWxldGluZykgeyBkZWx0YSA9IGNvbmZpZy5kZWxUaW1lOyB9XG5cbiAgICBpZiAoIWNvbmZpZy5pc0RlbGV0aW5nICYmIGNvbmZpZy50eHQgPT09IGNvbmZpZy5mdWxsVHh0KSB7XG4gICAgICBkZWx0YSA9IGNvbmZpZy5wYXVzZVRpbWU7XG4gICAgICBjb25maWcuaXNEZWxldGluZyA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChjb25maWcuaXNEZWxldGluZyAmJiBjb25maWcudHh0ID09PSAnJykge1xuICAgICAgY29uZmlnLmlzRGVsZXRpbmcgPSBmYWxzZTtcbiAgICAgIGNvbmZpZy5sb29wTnVtKys7XG4gICAgICBkZWx0YSA9IGNvbmZpZy53cml0ZVRpbWU7XG4gICAgfVxuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICB0aWNrKCk7XG4gICAgfSwgZGVsdGEpO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn07XG4iLCIvKipcbiAqIEZ1bsOnw6NvIHBhcmEgY2xpY2FyIGVtIGJvdMO1ZXMgZSBleGliaXIgbyBjb250ZcO6ZG8gcmVsYWNpb25hZG9cbiovXG52YXIgQnNUb2dnbGVDb250ZW50ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgY29uZmlnID0ge1xuICAgIG9wdGlvbnM6IHtcbiAgICAgIC8vIEJvdMO1ZXMgcXVlLCBhbyBzZXJlbSBjbGljYWRvcywgZXhpYmlyw6NvIG8gcmVzcGVjdGl2byBjb250YWluZXIgZGUgY29udGXDumRvXG4gICAgICBidXR0b25zOiBbXSxcbiAgICAgIC8vIENvbnRhaW5lcmVzIGRlIGNvbnRlw7pkb1xuICAgICAgY29udGFpbmVyczogW10sXG4gICAgICAvLyBDbGFzc2UgQ1NTIGluZGljYW5kbyBxdWUgbyBib3TDo28gZXN0w6EgYXRpdm9cbiAgICAgIGFjdGl2ZUJ1dHRvbkNsYXNzOiAnJyxcbiAgICAgIC8vIENsYXNzZSBDU1MgcGFyYSBleGliaXIgbyBjb250YWluZXJcbiAgICAgIGFjdGl2ZUNvbnRhaW5lckNsYXNzOiAnJyxcbiAgICAgIC8vIE3DqXRvZG8gZGUgYXRpdmHDp8OjbyBkYSBmdW7Dp8OjbzogJ2NsaWNrJyBvdSAnaGFzaENoYW5nZSdcbiAgICAgIG1ldGhvZDogJycsXG4gICAgICAvLyBTZSB2ZXJkYWRlaXJvLCBhIHDDoWdpbmEgaXLDoSBkYXIgc2Nyb2xsIGF0w6kgb1xuICAgICAgLy8gY29udGXDumRvIGFvIGRpc3BhcmFyIG8gZXZlbnRvIGRlIHNob3dDb250YWluZXJDb250ZW50XG4gICAgICBzY3JvbGxUb0NvbnRlbnQ6IGZhbHNlLFxuICAgIH0sXG4gIH07XG5cbiAgLyoqXG4gICAqIEluaWNpYWxpemEgYSBmdW7Dp8Ojb1xuICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBvcMOnw7VlcyBkZSBjb25maWd1cmHDp8Ojb1xuICAqL1xuICB2YXIgaW5pdCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMuYnV0dG9ucy5sZW5ndGggPiAwICYmIG9wdGlvbnMuY29udGFpbmVycy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25maWcgPSBvcHRpb25zO1xuICAgICAgX3Nob3dDb250ZW50T25QYWdlTG9hZCgpO1xuXG4gICAgICBpZiAoY29uZmlnLm1ldGhvZCA9PT0gJ2NsaWNrJykge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5idXR0b25zLCBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHZhciBhdHRySHJlZiA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuICAgICAgICAgICAgdmFyIGF0dHJMaW5rID0gKGF0dHJIcmVmKSA/IGF0dHJIcmVmLnNwbGl0KCcjJylbMV0gOiBudWxsO1xuICAgICAgICAgICAgdmFyIGNvbnRhaW5lcklkID0gYnV0dG9uLmRhdGFzZXQuY29udGVudEJ1dHRvbiB8fCBhdHRyTGluaztcbiAgICAgICAgICAgIGlmIChjb250YWluZXJJZCkge1xuICAgICAgICAgICAgICBfZGVhY3RpdmF0ZUJ1dHRvbnMoKTtcbiAgICAgICAgICAgICAgX2FjdGl2YXRlQnV0dG9uKGJ1dHRvbik7XG4gICAgICAgICAgICAgIHNob3dDb250YWluZXJDb250ZW50KGNvbnRhaW5lcklkKTtcbiAgICAgICAgICAgICAgaWYgKGNvbmZpZy5zY3JvbGxUb0NvbnRlbnQpIF9zY3JvbGxUb0NvbnRlbnQoY29udGFpbmVySWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoY29uZmlnLm1ldGhvZCA9PT0gJ2hhc2hDaGFuZ2UnKSB7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBjb250YWluZXJJZCA9IGdldEhhc2goKTtcbiAgICAgICAgICBpZiAoY29udGFpbmVySWQpIHtcbiAgICAgICAgICAgIHNob3dDb250YWluZXJDb250ZW50KGNvbnRhaW5lcklkKTtcbiAgICAgICAgICAgIGlmIChjb25maWcuc2Nyb2xsVG9Db250ZW50KSBfc2Nyb2xsVG9Db250ZW50KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgdmFyIF9zY3JvbGxUb0NvbnRlbnQgPSBmdW5jdGlvbiAoY29udGFpbmVySWQpIHtcbiAgICB2YXIgc2Nyb2xsID0gbmV3IFNtb290aFNjcm9sbCgpO1xuICAgIHZhciBoYXNoID0gZ2V0SGFzaCgpO1xuICAgIHZhciBhdHRyTGluayA9IGNvbnRhaW5lcklkO1xuXG4gICAgdmFyIGFuY2hvciA9IGhhc2ggfHwgYXR0ckxpbms7XG5cbiAgICBpZiAoYW5jaG9yKSB7XG4gICAgICB2YXIgY29udGFpbmVyQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWNvbnRlbnQtY29udGFpbmVyPVwiJyArIGFuY2hvciArICdcIl0nKTtcbiAgICAgIGlmIChjb250YWluZXJDb250ZW50KSB7XG4gICAgICAgIHNjcm9sbC5hbmltYXRlU2Nyb2xsKGNvbnRhaW5lckNvbnRlbnQsIDMwMCwge1xuICAgICAgICAgIHVwZGF0ZVVSTDogZmFsc2UsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogRXhpYmUgbyBjb250ZcO6ZG8gY2FzbyBhIGhhc2ggZGEgVVJMIGNvcnJlc3BvbmRhIGEgdW0gY29udGXDumRvIGV4aXN0ZW50ZSBuYSBww6FnaW5hXG4gICovXG4gIHZhciBfc2hvd0NvbnRlbnRPblBhZ2VMb2FkID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBjb250YWluZXJJZCA9IGdldEhhc2goKTtcbiAgICBpZiAoY29udGFpbmVySWQpIHtcbiAgICAgIHZhciBjb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtY29udGVudC1jb250YWluZXI9XCInICsgY29udGFpbmVySWQgKyAnXCJdJyk7XG4gICAgICBpZiAoY29udGVudCkge1xuICAgICAgICBoaWRlQ29udGFpbmVyQ29udGVudChjb25maWcuY29udGFpbmVycyk7XG4gICAgICAgIHNob3dDb250YWluZXJDb250ZW50KGNvbnRhaW5lcklkKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEF0aXZhIG8gYm90YW8gY2xpY2Fkb1xuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGJ1dHRvbiBCb3TDo28gcXVlIHJlY2ViZXLDoSBhIGNsYXNzZSBhdGl2YVxuICAgKiBAcGFyYW0ge1N0cmluZ30gYWN0aXZlQnV0dG9uQ2xhc3MgQ2xhc3NlIENTUyBpbmRpY2FuZG8gcXVlIG8gYm90w6NvIGVzdMOhIGF0aXZvXG4gICovXG4gIHZhciBfYWN0aXZhdGVCdXR0b24gPSBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoY29uZmlnLmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlIGNsYXNzZSBkZSBhdGl2YSBkZSB0b2RvcyBvcyBib3TDtWVzXG4gICAqIEBwYXJhbSB7QXJyYXl9IGJ1dHRvbnMgQm90w7VlcyBxdWUsIGFvIHNlcmVtIGNsaWNhZG9zLCBleGliaXLDo28gbyByZXNwZWN0aXZvXG4gICAqIGNvbnRhaW5lciBkZSBjb250ZcO6ZG9cbiAgICogQHBhcmFtIHtTdHJpbmd9IGFjdGl2ZUJ1dHRvbkNsYXNzIENsYXNzZSBDU1MgaW5kaWNhbmRvIHF1ZSBvIGJvdMOjbyBlc3TDoSBhdGl2b1xuICAqL1xuICB2YXIgX2RlYWN0aXZhdGVCdXR0b25zID0gZnVuY3Rpb24gKCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmJ1dHRvbnMsIGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEV4aWJlIG8gY29udGXDumRvIGRvIGNvbnRhaW5lclxuICAgKiBAcGFyYW0ge1N0cmluZ30gY29udGFpbmVySWQgSWQgZG8gY29udGFpbmVyIGEgc2VyIGV4aWJpZG9cbiAgKi9cbiAgdmFyIHNob3dDb250YWluZXJDb250ZW50ID0gZnVuY3Rpb24gKGNvbnRhaW5lcklkKSB7XG4gICAgaWYgKGNvbnRhaW5lcklkKSB7XG4gICAgICBoaWRlQ29udGFpbmVyQ29udGVudChjb25maWcuY29udGFpbmVycywgY29uZmlnLmFjdGl2ZUNvbnRhaW5lckNsYXNzKTtcblxuICAgICAgdmFyIGNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1jb250ZW50LWNvbnRhaW5lcj1cIicgKyBjb250YWluZXJJZCArICdcIl0nKTtcbiAgICAgIGlmIChjb250ZW50KSBjb250ZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmFjdGl2ZUNvbnRhaW5lckNsYXNzKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEVzY29uZGUgdG9kb3Mgb3MgY29udGFpbmVyZXMgZGUgY29udGXDumRvXG4gICAqIEBwYXJhbSB7QXJyYXl9IGNvbnRhaW5lcnMgQ29udGFpbmVyZXMgZGUgY29udGXDumRvXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBhY3RpdmVDb250YWluZXJDbGFzcyBDbGFzc2UgQ1NTIHV0aWxpemFkYSBwYXJhIGV4aWJpciBvIGNvbnRlw7pkb1xuICAqL1xuICB2YXIgaGlkZUNvbnRhaW5lckNvbnRlbnQgPSBmdW5jdGlvbiAoY29udGFpbmVycykge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29udGFpbmVycywgZnVuY3Rpb24gKGNvbnRhaW5lcikge1xuICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmFjdGl2ZUNvbnRhaW5lckNsYXNzKTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gICAgaGlkZUNvbnRhaW5lcnM6IGhpZGVDb250YWluZXJDb250ZW50LFxuICAgIHNob3dDb250YWluZXI6IHNob3dDb250YWluZXJDb250ZW50LFxuICB9O1xufTtcblxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgZWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy10YWItLWRlZmF1bHQnKTtcblxuICBpZiAoZWxlbSkge1xuICAgIHZhciBidXR0b25zID0gZWxlbS5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1jb250ZW50LWJ1dHRvbl0nKTtcbiAgICB2YXIgY29udGFpbmVycyA9IGVsZW0ucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtY29udGVudC1jb250YWluZXJdJyk7XG5cbiAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgIGJ1dHRvbnM6IGJ1dHRvbnMsXG4gICAgICBjb250YWluZXJzOiBjb250YWluZXJzLFxuICAgICAgYWN0aXZlQnV0dG9uQ2xhc3M6ICdicy1pcy1hY3RpdmUnLFxuICAgICAgYWN0aXZlQ29udGFpbmVyQ2xhc3M6ICdicy1pcy1hY3RpdmUnLFxuICAgICAgbWV0aG9kOiAnY2xpY2snLFxuICAgIH07XG5cbiAgICB2YXIgbmV3VG9nZ2xlQ29udGVudCA9IG5ldyBCc1RvZ2dsZUNvbnRlbnQoKTtcbiAgICBuZXdUb2dnbGVDb250ZW50LmluaXQob3B0aW9ucyk7XG4gIH1cbn0pO1xuIiwiIiwiLyoqXG4gKiBZb3V0dWJlIFBsYXllciBJZnJhbWUgQVBJXG4gKi9cbnZhciBCc1lUUGxheWVycyA9IChmdW5jdGlvbiAoKSB7XG4gIC8vIEVsZW1lbnRzXG4gIHZhciBjb25maWcgPSB7XG4gICAgdmlkZW9zOiB7fSxcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICh2aWRlb3MpIHtcbiAgICBpZiAoIXZpZGVvcy5sZW5ndGgpIHJldHVybjtcbiAgICBjb25maWcudmlkZW9zID0gQXJyYXkucHJvdG90eXBlLnJlZHVjZS5jYWxsKHZpZGVvcywgZnVuY3Rpb24gKG9iaiwgdmlkZW8pIHtcbiAgICAgIHZhciBjcnlwdG9PYmogPSB3aW5kb3cuY3J5cHRvIHx8IHdpbmRvdy5tc0NyeXB0bzsgLy8gZm9yIElFIDExXG4gICAgICB2aWRlby5pZCA9IGNyeXB0b09iai5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQzMkFycmF5KDEpKVswXTtcbiAgICAgIG9ialt2aWRlby5pZF0gPSB7XG4gICAgICAgIGVsOiB2aWRlbyxcbiAgICAgICAgcGxheWVyOiBudWxsLFxuICAgICAgfTtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfSwge30pO1xuXG4gICAgaW5jbHVkZUlmcmFtZUFQSSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJbmNsdWRlIElmcmFtZSBBUElcbiAgICogTG9hZHMgdGhlIElGcmFtZSBQbGF5ZXIgQVBJIGNvZGUgYXN5bmNocm9ub3VzbHkuXG4gICAqL1xuICB2YXIgaW5jbHVkZUlmcmFtZUFQSSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgdGFnLnNyYyA9ICdodHRwczovL3d3dy55b3V0dWJlLmNvbS9pZnJhbWVfYXBpJztcbiAgICB2YXIgZmlyc3RTY3JpcHRUYWcgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07XG4gICAgZmlyc3RTY3JpcHRUYWcucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodGFnLCBmaXJzdFNjcmlwdFRhZyk7XG4gIH07XG5cbiAgd2luZG93Lm9uWW91VHViZUlmcmFtZUFQSVJlYWR5ID0gZnVuY3Rpb24gKCkge1xuICAgIEJzWVRQbGF5ZXJzLnNldFBsYXllcnMoKTtcbiAgfTtcblxuICB2YXIgc2V0UGxheWVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICBPYmplY3Qua2V5cyhjb25maWcudmlkZW9zKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIHZhciBpdGVtID0gY29uZmlnLnZpZGVvc1trZXldO1xuICAgICAgaXRlbS5wbGF5ZXIgPSBuZXcgWVQuUGxheWVyKGtleSwge1xuICAgICAgICAvLyBldmVudHM6IHtcbiAgICAgICAgLy8gICBvblJlYWR5OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy8gICAgIGRlYnVnZ2VyO1xuICAgICAgICAvLyAgIH1cbiAgICAgICAgLy8gfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIGdldFBsYXllciA9IGZ1bmN0aW9uICh2aWRlb0lkKSB7XG4gICAgaWYgKGNvbmZpZy52aWRlb3NbdmlkZW9JZF0pIHtcbiAgICAgIHJldHVybiBjb25maWcudmlkZW9zW3ZpZGVvSWRdLnBsYXllcjtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICAgIHNldFBsYXllcnM6IHNldFBsYXllcnMsXG4gICAgZ2V0UGxheWVyOiBnZXRQbGF5ZXIsXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgQnNGb3JtVmFsaWRhdGUgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciB2aWRlb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtdmlkZW8nKTtcbiAgaWYgKHZpZGVvcy5sZW5ndGgpIHtcbiAgICBCc1lUUGxheWVycy5pbml0KHZpZGVvcyk7XG4gIH1cbn0pO1xuIiwidmFyIEJzQWJhTmF2ID0gKGZ1bmN0aW9uICgpIHtcblxuICAgdmFyIGNvbmZpZyA9IHtcbiAgICBhYmE6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1hYmEtbmF2JyksXG4gICAgY29udGVudDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWFiYS1uYXZfX2NvbnRlbnQnKSxcbiAgICBuYXZDb250ZW50OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtYWJhLW5hdl9fbmF2aWdhdGlvbicpLFxuICAgIG5hdkZha2U6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1hYmEtbmF2X19mYWtlLXNlbGVjdGlvbicpLFxuICAgIG5hdkl0ZW06IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1hYmEtbmF2X19uYXZpZ2F0aW9uLWl0ZW0nKSxcbiAgICBjb250ZW50SXRlbTogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWFiYS1uYXZfX2NvbnRlbnQtaXRlbScpLFxuICAgIG5hdkNvbnRlbnRBY3RpdmU6ICdicy1hYmEtbmF2X19uYXZpZ2F0aW9uLS1hY3RpdmUnLFxuICAgIG5hdkFjdGl2ZTogJ2JzLWFiYS1uYXZfX25hdmlnYXRpb24taXRlbS0tYWN0aXZlJyxcbiAgICBjb250ZW50QWN0aXZlOiAnYnMtYWJhLW5hdl9fY29udGVudC1pdGVtLS1hY3RpdmUnLFxuICB9O1xuXG4gIHZhciBicm93c2VyVHlwZSA9IC9UcmlkZW50Ly50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuXG4gICAgbmF2U2l6ZUFjdGl2ZSh3aWR0aCwgY29uZmlnLmNvbnRlbnRJdGVtLCBjb25maWcuY29udGVudEFjdGl2ZSk7XG4gICAgbmF2U2l6ZUFjdGl2ZSh3aWR0aCwgY29uZmlnLm5hdkl0ZW0sIGNvbmZpZy5uYXZBY3RpdmUpO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHdpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICBuYXZTaXplQWN0aXZlKHdpZHRoLCBjb25maWcuY29udGVudEl0ZW0sIGNvbmZpZy5jb250ZW50QWN0aXZlKTtcbiAgICAgIG5hdlNpemVBY3RpdmUod2lkdGgsIGNvbmZpZy5uYXZJdGVtLCBjb25maWcubmF2QWN0aXZlKTtcbiAgICB9KTtcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLm5hdkl0ZW0sIGZ1bmN0aW9uIChlLCBpbmRleCkge1xuICAgICAgZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgdmFyIHRvcEVsZW1lbnQgPSBjb25maWcuYWJhLm9mZnNldFRvcDtcbiAgICAgICAgdmFyIHNlbGVjdGVkID0gaXRlbS5jdXJyZW50VGFyZ2V0O1xuXG4gICAgICAgIGNvbmZpZy5uYXZGYWtlLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgwLCAnICsgaW5kZXggKyAnMDAlLCAwKSc7XG5cbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcubmF2SXRlbSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcubmF2QWN0aXZlKTtcbiAgICAgICAgICBlbC50YWJJbmRleCA9IC0xO1xuICAgICAgICB9KTtcblxuICAgICAgICBzZWxlY3RlZC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5uYXZBY3RpdmUpO1xuICAgICAgICBzZWxlY3RlZC50YWJJbmRleCA9IDA7XG4gICAgICAgIHZhciBkYXRhTmF2ID0gc2VsZWN0ZWQuZ2V0QXR0cmlidXRlKCdkYXRhLXJlZicpO1xuICAgICAgICBpdGVtLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuY29udGVudEl0ZW0sIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgIHZhciBkYXRhQ29udGVudCA9IGVsLmlkO1xuICAgICAgICAgIHZhciBjbG9zZSA9IGVsLnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1hYmEtbmF2LWNsb3NlJyk7XG5cbiAgICAgICAgICBpZiAod2lkdGggPCAnNTc2Jykge1xuXG4gICAgICAgICAgICBjb25maWcubmF2Q29udGVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5uYXZDb250ZW50QWN0aXZlKTtcbiAgICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCB0b3BFbGVtZW50IC0gMjApO1xuXG4gICAgICAgICAgICBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgY2xvc2VDb250ZW50KGVsLCBlKTtcbiAgICAgICAgICAgICAgY29uZmlnLm5hdkNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcubmF2Q29udGVudEFjdGl2ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cblxuICAgICAgICAgIGlmIChkYXRhQ29udGVudCAhPT0gZGF0YU5hdikge1xuICAgICAgICAgICAgY2xvc2VDb250ZW50KGVsKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb3BlbkNvbnRlbnQoZWwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgZS5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIGZ1bmN0aW9uIChpdGVtKSB7XG5cbiAgICAgICAgdmFyIHNlbGVjdGVkID0gaXRlbS5jdXJyZW50VGFyZ2V0LnRhYkluZGV4O1xuXG4gICAgICAgIGlmIChzZWxlY3RlZCA9PT0gMCkge1xuICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLm5hdkl0ZW0sIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgZWwudGFiSW5kZXggPSAxO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG5cbiAgdmFyIGNsb3NlQ29udGVudCA9IGZ1bmN0aW9uIChlbCwgZSkge1xuICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNvbnRlbnRBY3RpdmUpO1xuICAgIGVsLnNldEF0dHJpYnV0ZSgnYXJpYS1tb2RhbCcsICdmYWxzZScpO1xuICAgIGVsLnRhYkluZGV4ID0gLTE7XG4gIH07XG5cbiAgdmFyIG9wZW5Db250ZW50ID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgZWwuY2xhc3NMaXN0LmFkZChjb25maWcuY29udGVudEFjdGl2ZSk7XG4gICAgZWwudGFiSW5kZXggPSAwO1xuICAgIGVsLnNldEF0dHJpYnV0ZSgnYXJpYS1tb2RhbCcsICd0cnVlJyk7XG5cbiAgICBpZiAoIWJyb3dzZXJUeXBlKSB7XG4gICAgICBlbC5mb2N1cyh7IHByZXZlbnRTY3JvbGw6IHRydWUgfSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBuYXZTaXplQWN0aXZlID0gZnVuY3Rpb24gKHdpZHRoLCBpdGVtLCBhY3RpdmUpIHtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGl0ZW0sIGZ1bmN0aW9uIChlLCBpbmRleCkge1xuICAgICAgZS5jbGFzc0xpc3QucmVtb3ZlKGFjdGl2ZSk7XG5cbiAgICAgIGlmICh3aWR0aCA8ICc1NzYnICYmIGUuY2xhc3NMaXN0LmNvbnRhaW5zKGFjdGl2ZSkpIHtcbiAgICAgICAgZS5jbGFzc0xpc3QucmVtb3ZlKGFjdGl2ZSk7XG4gICAgICB9IGVsc2UgaWYgKHdpZHRoID49ICc1NzYnICYmIGluZGV4ID09PSAwKSB7XG4gICAgICAgIGUuY2xhc3NMaXN0LmFkZChhY3RpdmUpO1xuICAgICAgfVxuXG4gICAgICBjb25maWcubmF2RmFrZS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoMCwgMCUsIDApJztcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgQWJhIENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWFiYS1uYXYnKS5sZW5ndGgpIHtcbiAgICBCc0FiYU5hdi5pbml0KCk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBCcyBBY2Nlc3NpYmlsaXR5XG4gKlxuICovXG52YXIgQnNBY2Nlc3NpYmlsaXR5ID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gQ29uZmlnXG4gIHZhciBjb25maWcgPSB7XG4gICAgaHRtbDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpLFxuICAgIGJvZHk6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKSxcbiAgICBpbmNyZWFzZUJ1dHRvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWluY3JlYXNlLWZvbnQnKSxcbiAgICBkZWNyZWFzZUJ1dHRvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWRlY3JlYXNlLWZvbnQnKSxcbiAgICBjb250cmFzdEJ1dHRvbnM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1jaGFuZ2UtY29udHJhc3QnKSxcbiAgICBsaWJyYXNCdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1saWJyYXMnKSxcbiAgICBhbGxJbWFnZXM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZycpLFxuICAgIGZvbnRTaXplQmFzZTogMTYsXG4gICAgZm9udFNpemVNaW46IDE0LFxuICAgIGZvbnRTaXplTWF4OiAxOCxcbiAgICBoZWlnaHRNYXg6IDM2NSxcbiAgICBoZWlnaHRNaW46IDMxNSxcbiAgICBjb250cmFzdDoge1xuICAgICAgLy8gZ3JheXNjYWxlOiAnYnMtY29udHJhc3QtLWdyYXlzY2FsZScsXG4gICAgICBoaWdoQ29sb3I6ICdicy1jb250cmFzdC0taGlnaCcsXG4gICAgfSxcbiAgICBncmF5c2NhbGVDbGFzczogJ2JzLWNvbnRyYXN0X19pbWFnZScsXG4gICAgaXNJRTogL1RyaWRlbnQvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksXG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNvbnRyYXN0QXJyID0gW107XG5cbiAgICBmb3IgKGtleSBpbiBjb25maWcuY29udHJhc3QpIHtcbiAgICAgIGlmIChjb25maWcuY29udHJhc3QuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAvLyBTZSBuw6NvIGZvciBJRSwgYWRpY2lvbmEgdG9kb3NcbiAgICAgICAgaWYgKCFkZXRlY3RJRSgpKSB7XG4gICAgICAgICAgY29udHJhc3RBcnIucHVzaChjb25maWcuY29udHJhc3Rba2V5XSk7XG4gICAgICAgIH0gZWxzZSBpZiAoa2V5ICE9PSAnZ3JheXNjYWxlJykge1xuICAgICAgICAgIGNvbnRyYXN0QXJyLnB1c2goY29uZmlnLmNvbnRyYXN0W2tleV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG5cbiAgICAvLyBIYXZlIHByb2JsZW1zIHdpdGggY3Jvc3Mgb3JpZ2luIGltYWdlc1xuICAgIC8vIGlmIChnZXRJRVZlcnNpb24oKSA+PSAxMCkge1xuICAgIC8vICAgZ2VuZXJhdGVHcmF5c2NhbGVJbWFnZXMoKTtcbiAgICAvLyB9XG5cbiAgICBjbGljayhjb25maWcuaW5jcmVhc2VCdXR0b24sIGluY3JlYXNlRm9udFNpemUpO1xuICAgIGNsaWNrKGNvbmZpZy5kZWNyZWFzZUJ1dHRvbiwgZGVjcmVhc2VGb250U2l6ZSk7XG4gICAgY2xpY2soY29uZmlnLmNvbnRyYXN0QnV0dG9ucywgdG9nZ2xlQ29udHJhc3QpO1xuICAgIGNsaWNrKGNvbmZpZy5saWJyYXNCdXR0b24sIG9wZW5MaWJyYXMpO1xuICAgIGNsaWNrKGNvbmZpZy5saWJyYXNCdXR0b24sIG9wZW5MaWJyYXMpO1xuXG4gICAgY2hlY2tDb250cmFzdE9uTG9hZCgpO1xuICAgIHNldFRhYkluZGV4TG9nbygpO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuY29udHJhc3RCdXR0b25zLCBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICBpZiAoY29uZmlnLmlzSUUpIHNob3dIaWdoQ29udHJhc3RJRU1lc3NhZ2VPbkZpcnN0Q2xpY2soYnV0dG9uKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgaW5jcmVhc2VGb250U2l6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoZ2V0Q3VycmVudEZvbnRTaXplKCkgPT09IGNvbmZpZy5mb250U2l6ZU1heCkgcmV0dXJuO1xuICAgIGNvbmZpZy5odG1sLnN0eWxlLmZvbnRTaXplID0gKGdldEN1cnJlbnRGb250U2l6ZSgpICsgMSkgKyAncHgnO1xuXG5cbiAgICAvLyBSZWxvYWQgQ2Fycm91c3NlbCBkZSBQcm9kdXRvc1xuICAgIHZhciBjYXJvdXNlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1jYXJyb3VzZWwtcHJvZCAuYnMtbWVkaWFfX2xpc3QtLWxpbmVhcicpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBjYXJvdXNlbC5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGVsX3ZpZXdwb3J0ID0gY2Fyb3VzZWxbaV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImZsaWNraXR5LXZpZXdwb3J0XCIpO1xuXG4gICAgICB2YXIgZmxrdHkgPSBGbGlja2l0eS5kYXRhKGNhcm91c2VsW2ldKTtcblxuICAgICAgZm9yIChqID0gMDsgaiA8IGVsX3ZpZXdwb3J0Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgIHZhciBjYXJkID0gZWxfdmlld3BvcnRbal0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW1lZGlhX19pdGVtXCIpO1xuXG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgY2FyZC5sZW5ndGg7IHgrKykge1xuICAgICAgICAgIHZhciBjYXJkX2ltZyA9IGNhcmRbeF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW1lZGlhX19maWd1cmVcIilcbiAgICAgICAgICB2YXIgY2FyZF9kZXNjID0gY2FyZFt4XS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtbWVkaWFfX3RleHRcIilcblxuICAgICAgICAgIGlmICh4ID09IDApIHtcbiAgICAgICAgICAgIHZhciBjYWxjID0gY2FyZF9pbWdbMF0uY2xpZW50SGVpZ2h0ICsgY2FyZF9kZXNjWzBdLmNsaWVudEhlaWdodDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGNhbGMgPCBjYXJkX2ltZ1swXS5jbGllbnRIZWlnaHQgKyBjYXJkX2Rlc2NbMF0uY2xpZW50SGVpZ2h0KSB7XG4gICAgICAgICAgICAgIGNhbGMgPSBjYXJkX2ltZ1swXS5jbGllbnRIZWlnaHQgKyBjYXJkX2Rlc2NbMF0uY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uZmlnLmlzSUUpIHtcbiAgICAgICAgICBlbF92aWV3cG9ydFtqXS5zdHlsZS5oZWlnaHQgPSAoY2FsYyArIDMwKSArICdweCc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWxfdmlld3BvcnRbal0uc3R5bGUuaGVpZ2h0ID0gY2FsYyArICgncHgnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG5cbiAgICAgIGlmIChmbGt0eSkge1xuICAgICAgICBmbGt0eS5yZWxvYWRDZWxscygpO1xuICAgICAgICBmbGt0eS5yZXNpemUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZWxvYWQgQWJhcyBDYXJkXG4gICAgdmFyIGNhcm91c2VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXRhYnNfX3BhbmVsLS1zbGlkZXInKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgY2Fyb3VzZWwubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBmbGt0eSA9IEZsaWNraXR5LmRhdGEoY2Fyb3VzZWxbaV0pO1xuXG4gICAgICBpZiAoZmxrdHkpIHtcbiAgICAgICAgZmxrdHkucmVsb2FkQ2VsbHMoKTtcbiAgICAgICAgZmxrdHkucmVzaXplKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUmVsb2FkIEFiYXMgQ2FyZFxuICAgIHZhciBjYXJvdXNlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy10YWJzX19saXN0Jyk7XG4gICAgZm9yIChpID0gMDsgaSA8IGNhcm91c2VsLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgZmxrdHkgPSBGbGlja2l0eS5kYXRhKGNhcm91c2VsW2ldKTtcblxuICAgICAgaWYgKGZsa3R5KSB7XG4gICAgICAgIGZsa3R5LnJlc2l6ZSgpO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBmbGt0eS5yZWxvYWRDZWxscygpO1xuICAgICAgICB9LCAxMDAwKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfTtcblxuICB2YXIgZGVjcmVhc2VGb250U2l6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoZ2V0Q3VycmVudEZvbnRTaXplKCkgPT09IGNvbmZpZy5mb250U2l6ZU1pbikgcmV0dXJuO1xuICAgIGNvbmZpZy5odG1sLnN0eWxlLmZvbnRTaXplID0gKGdldEN1cnJlbnRGb250U2l6ZSgpIC0gMSkgKyAncHgnO1xuICAgIC8vIFJlbG9hZCBBYmFzIENhcmRcbiAgICB2YXIgY2Fyb3VzZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtdGFic19fcGFuZWwtLXNsaWRlcicpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBjYXJvdXNlbC5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGZsa3R5ID0gRmxpY2tpdHkuZGF0YShjYXJvdXNlbFtpXSk7XG5cbiAgICAgIGlmIChmbGt0eSkge1xuICAgICAgICBmbGt0eS5yZWxvYWRDZWxscygpO1xuICAgICAgICBmbGt0eS5yZXNpemUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZWxvYWQgQ2Fycm91c3NlbCBkZSBQcm9kdXRvc1xuICAgIHZhciBjYXJvdXNlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1jYXJyb3VzZWwtcHJvZCAuYnMtbWVkaWFfX2xpc3QtLWxpbmVhcicpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBjYXJvdXNlbC5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGVsX3ZpZXdwb3J0ID0gY2Fyb3VzZWxbaV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImZsaWNraXR5LXZpZXdwb3J0XCIpO1xuXG4gICAgICB2YXIgZmxrdHkgPSBGbGlja2l0eS5kYXRhKGNhcm91c2VsW2ldKTtcblxuICAgICAgZm9yIChqID0gMDsgaiA8IGVsX3ZpZXdwb3J0Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgIHZhciBjYXJkID0gZWxfdmlld3BvcnRbal0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW1lZGlhX19pdGVtXCIpO1xuXG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgY2FyZC5sZW5ndGg7IHgrKykge1xuICAgICAgICAgIHZhciBjYXJkX2ltZyA9IGNhcmRbeF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW1lZGlhX19maWd1cmVcIilcbiAgICAgICAgICB2YXIgY2FyZF9kZXNjID0gY2FyZFt4XS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtbWVkaWFfX3RleHRcIilcblxuICAgICAgICAgIGlmICh4ID09IDApIHtcbiAgICAgICAgICAgIHZhciBjYWxjID0gY2FyZF9pbWdbMF0uY2xpZW50SGVpZ2h0ICsgY2FyZF9kZXNjWzBdLmNsaWVudEhlaWdodDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGNhbGMgPCBjYXJkX2ltZ1swXS5jbGllbnRIZWlnaHQgKyBjYXJkX2Rlc2NbMF0uY2xpZW50SGVpZ2h0KSB7XG4gICAgICAgICAgICAgIGNhbGMgPSBjYXJkX2ltZ1swXS5jbGllbnRIZWlnaHQgKyBjYXJkX2Rlc2NbMF0uY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uZmlnLmlzSUUpIHtcbiAgICAgICAgICBlbF92aWV3cG9ydFtqXS5zdHlsZS5oZWlnaHQgPSAoY2FsYyArIDMwKSArICdweCc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZWxfdmlld3BvcnRbal0uc3R5bGUuaGVpZ2h0ID0gY2FsYyArICgncHgnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG5cbiAgICAgIGlmIChmbGt0eSkge1xuICAgICAgICBmbGt0eS5yZWxvYWRDZWxscygpO1xuICAgICAgICBmbGt0eS5yZXNpemUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBSZWxvYWQgQWJhcyBDYXJkXG4gICAgdmFyIGNhcm91c2VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXRhYnNfX2xpc3QnKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgY2Fyb3VzZWwubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBmbGt0eSA9IEZsaWNraXR5LmRhdGEoY2Fyb3VzZWxbaV0pO1xuXG4gICAgICBpZiAoZmxrdHkpIHtcbiAgICAgICAgZmxrdHkucmVsb2FkQ2VsbHMoKTtcbiAgICAgICAgZmxrdHkucmVzaXplKCk7XG4gICAgICB9XG4gICAgfVxuXG4gIH07XG5cblxuICB2YXIgY2hlY2tDb250cmFzdE9uTG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc3RvcmFnZUNvbnRyYXN0ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2JzSGlnaENvbnRyYXN0T3B0aW9uJyk7XG4gICAgaWYgKHN0b3JhZ2VDb250cmFzdCkgc2V0Q29udHJhc3Qoc3RvcmFnZUNvbnRyYXN0KTtcbiAgfTtcblxuICB2YXIgc2V0Q29udHJhc3QgPSBmdW5jdGlvbiAoY29udHJhc3RLZXkpIHtcbiAgICAvLyByZW1vdmUgYm9keSBjb250cmFzdCBjbGFzc2VzXG4gICAgT2JqZWN0LmtleXMoY29uZmlnLmNvbnRyYXN0KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jb250cmFzdFtrZXldKTtcbiAgICB9KTtcblxuICAgIC8vIHNldCBhIG5ldyBjb250cmFzdCBrZXkgdG8gYm9keVxuICAgIGlmIChjb250cmFzdEtleSAmJiBjb25maWcuY29udHJhc3RbY29udHJhc3RLZXldKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5jb250cmFzdEJ1dHRvbnMsIGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2JzLWlzLWFjdGl2ZScpO1xuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLXByZXNzZWQnLCAndHJ1ZScpO1xuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdkYXRhLWNvbnRyYXN0JywgY29udHJhc3RLZXkpO1xuICAgICAgfSk7XG4gICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuY29udHJhc3RbY29udHJhc3RLZXldKTtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdic0hpZ2hDb250cmFzdE9wdGlvbicsIGNvbnRyYXN0S2V5KTtcbiAgICAgIC8vIHNldCBhIG5ldyBjb250cmFzdCBrZXkgdG8gYm9keVxuICAgIH0gZWxzZSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5jb250cmFzdEJ1dHRvbnMsIGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2JzLWlzLWFjdGl2ZScpO1xuICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLXByZXNzZWQnLCAnZmFsc2UnKTtcbiAgICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1jb250cmFzdCcsICcnKTtcbiAgICAgIH0pO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2JzSGlnaENvbnRyYXN0T3B0aW9uJywgJycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgdG9nZ2xlQ29udHJhc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGN1cnJlbnRLZXkgPSBjb25maWcuY29udHJhc3RCdXR0b25zWzBdLmdldEF0dHJpYnV0ZSgnZGF0YS1jb250cmFzdCcpO1xuICAgIHZhciBjb250cmFzdEFycmF5ID0gT2JqZWN0LmtleXMoY29uZmlnLmNvbnRyYXN0KS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgcmV0dXJuIGtleTtcbiAgICB9KTtcbiAgICB2YXIgY3VycmVudElkeCA9IGNvbnRyYXN0QXJyYXkuaW5kZXhPZihjdXJyZW50S2V5KTtcbiAgICB2YXIgbmV4dElkeDtcbiAgICB2YXIgbmV4dEtleTtcblxuICAgIGlmIChjdXJyZW50SWR4IDwgMCkge1xuICAgICAgbmV4dElkeCA9IDA7XG4gICAgfSBlbHNlIGlmIChjdXJyZW50SWR4IDwgY29udHJhc3RBcnJheS5sZW5ndGgpIHtcbiAgICAgIG5leHRJZHggPSBjdXJyZW50SWR4ICsgMTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmV4dElkeCA9IC0xO1xuICAgIH1cblxuICAgIG5leHRLZXkgPSBuZXh0SWR4ID4gLTEgPyBjb250cmFzdEFycmF5W25leHRJZHhdIDogJyc7XG5cbiAgICBzZXRDb250cmFzdChuZXh0S2V5KTtcbiAgfTtcblxuICB2YXIgZ2VuZXJhdGVHcmF5c2NhbGVJbWFnZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuYWxsSW1hZ2VzLCBmdW5jdGlvbiAoaW1hZ2UpIHtcbiAgICAgIHZhciBpbWdTcmMgPSBpbWFnZS5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuICAgICAgdmFyIGdyYXlzY2FsZURhdGEgPSBncmF5c2NhbGVJbWFnZShpbWdTcmMpO1xuICAgICAgdmFyIG5ld0ltYWdlID0gaW1hZ2UuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgbmV3SW1hZ2Uuc2V0QXR0cmlidXRlKCdzcmMnLCBncmF5c2NhbGVEYXRhKTtcbiAgICAgIG5ld0ltYWdlLmNsYXNzTGlzdC5hZGQoY29uZmlnLmdyYXlzY2FsZUNsYXNzKTtcbiAgICAgIGltYWdlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5ld0ltYWdlLCBpbWFnZSk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gRXNjb25kZXIgw41jb25lIGluaWNpYWxpemFyIGxpYnJhc1xuICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaGFuZHRhbGsgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiaHQtc2tpcFwiKVswXTtcblxuICAgIGlmIChoYW5kdGFsayAhPSBudWxsKSB7XG4gICAgICB2YXIgaXNPcGVuZWQgPSBoYW5kdGFsay5xdWVyeVNlbGVjdG9yQWxsKCdbeD1cIi0xMFwiXScpO1xuICAgICAgaWYgKGlzT3BlbmVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIGJ0bl9saWJyYXNfY2xvc2UgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiaHQtc2tpcFwiKVswXS5jaGlsZHJlblswXS5jaGlsZHJlblswXS5jaGlsZHJlblsxXS5jaGlsZHJlblswXTtcbiAgICAgICAgICBidG5fbGlicmFzX2Nsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImh0LXNraXBcIilbMF0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICB9KVxuICAgICAgICB9LCA1MDApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaGFuZHRhbGsuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgfVxuICAgIH1cbiAgfSwgMTAwKTtcblxuXG4gIHZhciBvcGVuTGlicmFzID0gZnVuY3Rpb24gKCkge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJodC1za2lwXCIpWzBdLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLmNsaWNrKCk7XG5cbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBidG5fbGlicmFzX2Nsb3NlID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImh0LXNraXBcIilbMF0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bMV0uY2hpbGRyZW5bMF07XG4gICAgICBidG5fbGlicmFzX2Nsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJodC1za2lwXCIpWzBdLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgfSwgMTAwKTtcbiAgICAgIH0pXG4gICAgfSwgNTAwKTtcbiAgfTtcblxuICB2YXIgZ2V0Q3VycmVudEZvbnRTaXplID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBwYXJzZUZsb2F0KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGNvbmZpZy5odG1sLCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKCdmb250LXNpemUnKSk7XG4gIH07XG5cbiAgdmFyIGNsaWNrID0gZnVuY3Rpb24gKGVsZW1lbnRzLCBjYWxsYmFjaykge1xuICAgIHZhciBpID0gMDtcbiAgICB2YXIgbCA9IGVsZW1lbnRzLmxlbmd0aDtcblxuICAgIGZvciAoOyBpIDwgbDsgaSArPSAxKSB7XG4gICAgICBlbGVtZW50c1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNhbGxiYWNrKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEhpZ2ggQ29udHJhc3QgTWVzc2FnZSBmb3IgSUUxMVxuICAgKiBTaG93IGEgdG9vbHRpcCBtZXNzYWdlIHRoZSBmaXJzdCB0aW1lIHRoZSBoaWdoIGNvbnN0cmFzdCBidXR0b24gaXMgY2xpY2tlZCBvbiBJRTExXG4gICAqIEBwYXJhbSAge1t0eXBlXX0gZWwgW2Rlc2NyaXB0aW9uXVxuICAgKi9cbiAgdmFyIHNob3dIaWdoQ29udHJhc3RJRU1lc3NhZ2VPbkZpcnN0Q2xpY2sgPSBmdW5jdGlvbiAoZWwpIHtcbiAgICAvLyB2YXIgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtY2hhbmdlLWNvbnRyYXN0Jyk7XG4gICAgdmFyIHN0b3JhZ2VLZXkgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYnNJbnN0SGlnaENvbnRyYXN0SUVNZXNzYWdlUmVhZCcpO1xuICAgIHZhciB0aXBweU9wdGlvbnMgPSB7XG4gICAgICBjb250ZW50OiAnPGRpdj5QYXJhIHVtYSBtZWxob3IgZXhwZXJpw6puY2lhLCByZWNvbWVuZGFtb3MgbyB1c28gZG9zIG5hdmVnYWRvcmVzIDxiPkNocm9tZTwvYj4sIDxiPkVkZ2U8L2I+IG91IDxiPkZpcmVmb3g8L2I+LjwvZGl2PicsXG4gICAgICB0cmlnZ2VyOiAnbWFudWFsbHknLFxuICAgICAgaW50ZXJhY3RpdmU6IHRydWUsXG4gICAgICB6SW5kZXg6IDk5OTksXG4gICAgICBib3VuZGFyeTogJ3dpbmRvdycsXG4gICAgfTtcbiAgICB2YXIgdGlwcHlJbnN0YW5jZXMgPSB0aXBweShlbCwgdGlwcHlPcHRpb25zKTtcbiAgICB2YXIgdGlwcHlJbnN0YW5jZSA9IHRpcHB5SW5zdGFuY2VzLmluc3RhbmNlc1swXTtcbiAgICB2YXIgY2xpY2tlZCA9IGZhbHNlO1xuXG4gICAgaWYgKGVsICYmIGNvbmZpZy5pc0lFKSB7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFjbGlja2VkICYmICFzdG9yYWdlS2V5KSB7XG4gICAgICAgICAgdGlwcHlJbnN0YW5jZS5zaG93KCk7XG4gICAgICAgICAgY2xpY2tlZCA9IHRydWU7XG4gICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2JzSW5zdEhpZ2hDb250cmFzdElFTWVzc2FnZVJlYWQnLCAxKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBzZXRUYWJJbmRleExvZ28gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGhlYWRlcl9sb2dvID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLWhlYWRlcl9fbG9nb1wiKTtcbiAgICBpZiAoaGVhZGVyX2xvZ29bMF0gIT0gbnVsbCkge1xuICAgICAgdmFyIHN2ZyA9IGhlYWRlcl9sb2dvWzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzdmcnKTtcbiAgICAgIHZhciBzdmdfZyA9IGhlYWRlcl9sb2dvWzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdnJyk7XG4gICAgICB2YXIgc3ZnX3BhdGggPSBoZWFkZXJfbG9nb1swXS5nZXRFbGVtZW50c0J5VGFnTmFtZSgncGF0aCcpO1xuICAgICAgdmFyIHN2Z19yZWN0ID0gaGVhZGVyX2xvZ29bMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3JlY3QnKTtcblxuICAgICAgaWYgKHN2ZyAhPSBudWxsKSB7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBzdmcubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBzdmdbaV0udGFiSW5kZXggPSAtMTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHN2Z19nICE9IG51bGwpIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHN2Z19nLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgc3ZnX2dbaV0udGFiSW5kZXggPSAtMTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHN2Z19wYXRoICE9IG51bGwpIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHN2Z19wYXRoLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgc3ZnX3BhdGhbaV0udGFiSW5kZXggPSAtMTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHN2Z19yZWN0ICE9IG51bGwpIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHN2Z19yZWN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgc3ZnX3JlY3RbaV0udGFiSW5kZXggPSAtMTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICBjdXJyZW50Rm9udDogZ2V0Q3VycmVudEZvbnRTaXplLFxuICAgIGluY3JlYXNlRm9udDogaW5jcmVhc2VGb250U2l6ZSxcbiAgICBkZWNyZWFzZUZvbnQ6IGRlY3JlYXNlRm9udFNpemUsXG4gICAgdG9nZ2xlQ29udHJhc3Q6IHRvZ2dsZUNvbnRyYXN0LFxuICAgIGdlbmVyYXRlR3JheXNjYWxlSW1hZ2VzOiBnZW5lcmF0ZUdyYXlzY2FsZUltYWdlcyxcbiAgICBzZXRUYWJJbmRleExvZ286IHNldFRhYkluZGV4TG9nb1xuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IEFjY2Vzc2liaWxpdHkgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIEJzQWNjZXNzaWJpbGl0eS5pbml0KCk7XG59KTtcbiIsInZhciBCc0FjY29yZGlvbiA9IChmdW5jdGlvbiAoKSB7XG5cbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBhY2NvcmRpb25CdXR0b246ICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1vcGVuLWFjY29yZGlvbicpLFxuICAgIGFjY29yZGlvbjogICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWFjY29yZGlvbicpLFxuICAgIGFjY29yZGlvbkNvbnRlbnQ6ICAgJy5icy1qcy1hY2NvcmRpb24tY29udGVudCcsXG4gICAgYm9keTogICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5JyksXG4gICAgZGlzYWJsZWRPbkRlc2t0b3A6ICAnYnMtanMtYWNjb3JkaW9uLWRpc2FibGVkLWRlc2t0b3AnXG4gIH1cblxuICB2YXIgbW9kQ2xhc3MgPSB7XG4gICAgYWNjb3JkaW9uT3BlbkNsYXNzOiAnYnMtYWNjb3JkaW9uX19pdGVtLS1vcGVuJ1xuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy8gQ2hlY2sgaWYgYWNjb3JkaW9uIHNob3VkIGJlIGRpc2FibGVkIG9uIGRlc2t0b3BcbiAgICBkaXNhYmxlQWNjb3JkaW9uT25EZXNrdG9wKCk7XG5cbiAgICAvLyBUb2dnbGUgYWNjb3JkaW9uIGl0ZW0gb24gY2xpY2tcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbmZpZy5hY2NvcmRpb25CdXR0b24ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIGNvbmZpZy5hY2NvcmRpb25CdXR0b25baV0uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgJ2NsaWNrJyxcbiAgICAgICAgdG9nZ2xlQWNjb3JkaW9uSXRlbS5iaW5kKG51bGwsIGNvbmZpZy5hY2NvcmRpb25CdXR0b25baV0pXG4gICAgICApO1xuICAgIH1cblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB1cGRhdGVDb250ZW50SGVpZ2h0KCk7XG4gICAgICBkaXNhYmxlQWNjb3JkaW9uT25EZXNrdG9wKCk7XG4gICAgfSk7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5hY2NvcmRpb24sIGZ1bmN0aW9uIChlbCkge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUFjY29yZGlvbktleWJvYXJkKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgdG9nZ2xlQWNjb3JkaW9uSXRlbSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgaWYgKGlzQWNjb3JkaW9uT3BlbihlbGVtZW50KSkgY2xvc2VBY2NvcmRpb25JdGVtKGVsZW1lbnQpO1xuICAgIGVsc2Ugb3BlbkFjY29yZGlvbkl0ZW0oZWxlbWVudCk7XG4gIH07XG5cbiAgdmFyIGlzQWNjb3JkaW9uT3BlbiA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgdmFyIGl0ZW0gPSBnZXRQYXJlbnQoZWxlbWVudCwgJ2JzLWFjY29yZGlvbl9faXRlbScpO1xuICAgIHJldHVybiBpdGVtLmNsYXNzTGlzdC5jb250YWlucyhtb2RDbGFzcy5hY2NvcmRpb25PcGVuQ2xhc3MpO1xuICB9O1xuXG4gIHZhciBvcGVuQWNjb3JkaW9uSXRlbSA9IGZ1bmN0aW9uIChvcGVuRWxlbWVudCkge1xuICAgIHZhciBpdGVtID0gZ2V0UGFyZW50KG9wZW5FbGVtZW50LCAnYnMtYWNjb3JkaW9uX19pdGVtJyk7XG4gICAgdmFyIGNvbnRlbnQgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLmFjY29yZGlvbkNvbnRlbnQpO1xuICAgIHZhciBjb250ZW50SGVpZ2h0ID0gY29udGVudC5zY3JvbGxIZWlnaHQ7XG5cbiAgICBvcGVuRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xuICAgIGNvbnRlbnQuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICdmYWxzZScpO1xuXG4gICAgaXRlbS5jbGFzc0xpc3QuYWRkKG1vZENsYXNzLmFjY29yZGlvbk9wZW5DbGFzcyk7XG4gICAgY29udGVudC5zdHlsZS5oZWlnaHQgPSBjb250ZW50SGVpZ2h0ICsgJ3B4JztcbiAgfTtcblxuICB2YXIgY2xvc2VBY2NvcmRpb25JdGVtID0gZnVuY3Rpb24gKGNsb3NlRWxlbWVudCkge1xuICAgIHZhciBpdGVtID0gZ2V0UGFyZW50KGNsb3NlRWxlbWVudCwgJ2JzLWFjY29yZGlvbl9faXRlbScpO1xuICAgIHZhciBjb250ZW50ID0gaXRlbS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5hY2NvcmRpb25Db250ZW50KTtcbiAgICB2YXIgY29udGVudEhlaWdodCA9IGNvbnRlbnQuc2Nyb2xsSGVpZ2h0O1xuXG4gICAgY2xvc2VFbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgIGNvbnRlbnQuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7XG5cbiAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUobW9kQ2xhc3MuYWNjb3JkaW9uT3BlbkNsYXNzKTtcbiAgICBjb250ZW50LnN0eWxlLmhlaWdodCA9IDA7XG5cbiAgICBmaXhFbGVtZW50U2Nyb2xsKGl0ZW0pO1xuICB9O1xuXG4gIC8vIFVwZGF0ZXMgY29udGVudCBoZWlnaHQgb24gd2luZG93IHJlc2l6ZVxuICB2YXIgdXBkYXRlQ29udGVudEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtYWNjb3JkaW9uX19pdGVtJyk7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGl0ZW1zLCBmdW5jdGlvbihlbGVtZW50LCBpKXtcbiAgICAgIHZhciBjb250ZW50ICAgICAgID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5hY2NvcmRpb25Db250ZW50KTtcbiAgICAgIHZhciBjb250ZW50SGVpZ2h0ID0gY29udGVudC5xdWVyeVNlbGVjdG9yKCcuYnMtYWNjb3JkaW9uX19ib3gnKS5zY3JvbGxIZWlnaHQgKyAncHgnO1xuICAgICAgdmFyIGFjY29yZGlvbiAgICAgPSBnZXRQYXJlbnRzKGVsZW1lbnQsIGNvbmZpZy5kaXNhYmxlZE9uRGVza3RvcClbMF07XG5cbiAgICAgIC8vIElmIHRoZSAuYnMtanMtYWNjb3JkaW9uLWNvbnRlbnQgaGVpZ2h0IGlzIGRpZmZlcmVudCBmcm9tIGl0cyBjb250ZW50LCB1cGRhdGVzIGl0cyBoZWlnaHRcbiAgICAgIGlmKCBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhtb2RDbGFzcy5hY2NvcmRpb25PcGVuQ2xhc3MpICYmIHBhcnNlSW50KGNvbnRlbnQuc3R5bGUuaGVpZ2h0KSAhPSBjb250ZW50SGVpZ2h0ICkge1xuICAgICAgICBjb250ZW50LnN0eWxlLmhlaWdodCA9IGNvbnRlbnRIZWlnaHQ7XG4gICAgICB9XG5cblxuICAgICAgLy8gSWYgYWNjb3JkaW9uIGlzIHNldCB0byBiZSBkaXNhYmxlZCBvbiBkZXNrdG9wLCB1cGRhdGUgaXRlbXMgaGVpZ2h0XG4gICAgICBpZihhY2NvcmRpb24pIHtcbiAgICAgICAgaWYoXG4gICAgICAgICAgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKG1vZENsYXNzLmFjY29yZGlvbk9wZW5DbGFzcykgJiYgcGFyc2VJbnQoY29udGVudC5zdHlsZS5oZWlnaHQpICE9IGNvbnRlbnRIZWlnaHQpIHx8XG4gICAgICAgICAgKCFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhtb2RDbGFzcy5hY2NvcmRpb25PcGVuQ2xhc3MpICYmIHdpbmRvdy5pbm5lcldpZHRoID49IDEyMDApXG4gICAgICAgICkge1xuICAgICAgICAgIGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gY29udGVudEhlaWdodDtcbiAgICAgICAgfSBlbHNlIGlmKCAhZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMobW9kQ2xhc3MuYWNjb3JkaW9uT3BlbkNsYXNzKSAmJiB3aW5kb3cuaW5uZXJXaWR0aCA8IDEyMDAgKSB7XG4gICAgICAgICAgY29udGVudC5zdHlsZS5oZWlnaHQgPSAwO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvLyBDaGVja3MgaWYgdGhlIGFjY29yZGlvbiBzaG91bGQgYmUgZGlzYWJsZWQgb24gZGVza3RvcFxuICAvLyBhbmQgdGhlbiBkaXNhYmxlIGl0cyBidXR0b25zXG4gIHZhciBkaXNhYmxlQWNjb3JkaW9uT25EZXNrdG9wID0gZnVuY3Rpb24gKCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmFjY29yZGlvbiwgZnVuY3Rpb24oZWxlbWVudCwgaSl7XG4gICAgICBpZihlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjb25maWcuZGlzYWJsZWRPbkRlc2t0b3ApKSB0b2dnbGVCdXR0b25zKGVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gRGlzYWJsZSB0aGUgYWNjb3JkaW9uIGJ1dHRvbnNcbiAgdmFyIHRvZ2dsZUJ1dHRvbnMgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgIHZhciBpdGVtcyA9IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLW9wZW4tYWNjb3JkaW9uJyk7XG5cbiAgICBpZih3aW5kb3cuaW5uZXJXaWR0aCA+PSAxMjAwKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGl0ZW1zLCBmdW5jdGlvbihlbCwgaSl7XG4gICAgICAgIGVsLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGl0ZW1zLCBmdW5jdGlvbihlbCwgaSl7XG4gICAgICAgIGVsLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvLyBGaXggc2Nyb2xsIG9mIGFuIGVsZW1lbnQgd2hlbiB0YWJiaW5nIGZvY3VzXG4gIC8vIG9uIGFuIGVsZW1lbnQgaW5zaWRlIGEgZGl2IHdobyB3aWxsIGJlIGhpZGRlblxuICAvLyBhZnRlciBhIHRyYW5zaXRpb25cbiAgdmFyIGZpeEVsZW1lbnRTY3JvbGwgPSBmdW5jdGlvbiAoZWwpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGVsLnNjcm9sbFRvKDAsIDApO1xuICAgIH0sIDMwMCk7XG4gIH07XG5cbiAgdmFyIGhhbmRsZUFjY29yZGlvbktleWJvYXJkID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgdmFyIGFjY29yZGlvbiA9IGV2LmN1cnJlbnRUYXJnZXQ7XG4gICAgdmFyIGN1cnJlbnRFbCA9IGV2LnRhcmdldDtcbiAgICB2YXIga2V5ID0gZXYua2V5O1xuICAgIHZhciBidXR0b25zTm9kZSA9IGFjY29yZGlvbi5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtb3Blbi1hY2NvcmRpb24nKTtcbiAgICB2YXIgYnV0dG9ucyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGJ1dHRvbnNOb2RlKTtcbiAgICB2YXIgY3VycmVudEJ1dHRvbiA9IChcbiAgICAgIGN1cnJlbnRFbC5jbGFzc0xpc3QuY29udGFpbnMoJ2JzLWpzLW9wZW4tYWNjb3JkaW9uJykpXG4gICAgICA/IGN1cnJlbnRFbCA6IGN1cnJlbnRFbC5jbG9zZXN0KCcuYnMtanMtb3Blbi1hY2NvcmRpb24nKTtcbiAgICB2YXIgZmlyc3RCdXR0b24gPSBidXR0b25zWzBdO1xuICAgIHZhciBsYXN0QnV0dG9uID0gYnV0dG9uc1tidXR0b25zLmxlbmd0aCAtIDFdO1xuICAgIHZhciBwcmV2QnV0dG9uID0gYnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pXG4gICAgICA/IGJ1dHRvbnNbYnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pIC0gMV1cbiAgICAgIDogbGFzdEJ1dHRvbjtcbiAgICB2YXIgbmV4dEJ1dHRvbiA9IGJ1dHRvbnMuaW5kZXhPZihjdXJyZW50QnV0dG9uKSA8IGJ1dHRvbnMubGVuZ3RoIC0gMVxuICAgICAgPyBidXR0b25zW2J1dHRvbnMuaW5kZXhPZihjdXJyZW50QnV0dG9uKSArIDFdXG4gICAgICA6IGZpcnN0QnV0dG9uO1xuXG4gICAgaWYgKGN1cnJlbnRCdXR0b24pIHtcbiAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOlxuICAgICAgICAgIG9wZW5BY2NvcmRpb25JdGVtKGN1cnJlbnRCdXR0b24pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdBcnJvd0xlZnQnOlxuICAgICAgICAgIGNsb3NlQWNjb3JkaW9uSXRlbShjdXJyZW50QnV0dG9uKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnQXJyb3dEb3duJzpcbiAgICAgICAgICBuZXh0QnV0dG9uLmZvY3VzKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICAgIHByZXZCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnSG9tZSc6XG4gICAgICAgICAgZmlyc3RCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRW5kJzpcbiAgICAgICAgICBsYXN0QnV0dG9uLmZvY3VzKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBNb2RhbCBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1hY2NvcmRpb24nKS5sZW5ndGgpIHtcbiAgICBCc0FjY29yZGlvbi5pbml0KCk7XG4gIH1cbn0pO1xuIiwidmFyIEJzQWNlc3NvUmFwaWRvID0gKGZ1bmN0aW9uICgpIHtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciAkYm94R2VuZXJhbENvbXBvbmVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1uYXYtbWVudV9fYm94LS1hY2Vzc28tcmFwaWRvJyk7XG4gICAgdmFyICRidXR0b25BY2Vzc29SYXBpZG8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtbmF2LW1lbnVfX3ByaW1hcnkgYnV0dG9uJyk7XG4gICAgdmFyICRidXR0b25BY2Vzc29SYXBpZG9MaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLW5hdi1tZW51X19wcmltYXJ5IGJ1dHRvbicpO1xuXG4gICAgJGJ1dHRvbkFjZXNzb1JhcGlkby5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgICRib3hHZW5lcmFsQ29tcG9uZW50LmNsYXNzTGlzdC50b2dnbGUoXCJvcGVuXCIpO1xuXG4gICAgICBpZigkYm94R2VuZXJhbENvbXBvbmVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJvcGVuXCIpKXtcbiAgICAgICAgJGJ1dHRvbkFjZXNzb1JhcGlkb0xpbmsuc2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiLCBcInRydWVcIik7XG4gICAgICB9ZWxzZSB7XG4gICAgICAgICRidXR0b25BY2Vzc29SYXBpZG9MaW5rLnNldEF0dHJpYnV0ZShcImFyaWEtZXhwYW5kZWRcIiwgXCJmYWxzZVwiKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICB2YXIgYWRqdXN0SGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgIGxldCBhY2Vzc29SYXBpZG8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJzLW5hdi1tZW51X19ib3gtLWFjZXNzby1yYXBpZG9cIik7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFjZXNzb1JhcGlkby5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgQUNFU1NPX1JBUElET19VTCA9IGFjZXNzb1JhcGlkb1tpXS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInVsXCIpXG5cbiAgICAgIGlmICh3aW5kb3cub3V0ZXJXaWR0aCA+IDEwMjQpIHtcbiAgICAgICAgQUNFU1NPX1JBUElET19VTFswXS5yZW1vdmVBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcbiAgICAgICAgQUNFU1NPX1JBUElET19VTFswXS5zdHlsZS5oZWlnaHQgPSBBQ0VTU09fUkFQSURPX1VMWzBdLm9mZnNldEhlaWdodCArIFwicHhcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIEFDRVNTT19SQVBJRE9fVUxbMF0ucmVtb3ZlQXR0cmlidXRlKFwic3R5bGVcIik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdmFyIGFkanVzdEFycm93UG9zaXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICBsZXQgYWNlc3NvUmFwaWRvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5icy1uYXYtbWVudV9fYm94LS1hY2Vzc28tcmFwaWRvXCIpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhY2Vzc29SYXBpZG8ubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IEFDRVNTT19SQVBJRE9fQSA9IGFjZXNzb1JhcGlkb1tpXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtbmF2LW1lbnVfX2xpbmtcIilbMF07XG4gICAgICBjb25zdCBBQ0VTU09fUkFQSURPX0JUTiA9IGFjZXNzb1JhcGlkb1tpXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtbmF2LW1lbnVfX2J1dHRvbnNcIik7XG4gICAgICBjb25zdCBBQ0VTU09fUkFQSURPX0xJU1QgPSBhY2Vzc29SYXBpZG9baV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW5hdi1tZW51X19saXN0XCIpWzBdO1xuXG4gICAgICBpZiAoQUNFU1NPX1JBUElET19CVE4ubGVuZ3RoID09IDApIHtcbiAgICAgICAgQUNFU1NPX1JBUElET19BLmNsYXNzTGlzdC5hZGQoXCJuby1idXR0b25cIik7XG4gICAgICAgIGlmICh3aW5kb3cub3V0ZXJXaWR0aCA8PSA2MDApIHtcbiAgICAgICAgICBBQ0VTU09fUkFQSURPX0xJU1Quc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFjZXNzb1JhcGlkb1swXS5jbGFzc0xpc3QuYWRkKCdoYXMtYnV0dG9uJyk7XG4gICAgICB9ICAgICAgXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICAgIGFkanVzdEhlaWdodDogYWRqdXN0SGVpZ2h0LFxuICAgIGFkanVzdEFycm93UG9zaXRpb246IGFkanVzdEFycm93UG9zaXRpb25cbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBBY2Vzc28gUsOhcGlkbyBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1uYXYtbWVudV9fYm94LS1hY2Vzc28tcmFwaWRvJykubGVuZ3RoKSB7XG4gICAgQnNBY2Vzc29SYXBpZG8uaW5pdCgpO1xuICAgIEJzQWNlc3NvUmFwaWRvLmFkanVzdEhlaWdodCgpO1xuICAgIEJzQWNlc3NvUmFwaWRvLmFkanVzdEFycm93UG9zaXRpb24oKTtcbiAgfVxufSk7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbigpIHtcbiAgQnNBY2Vzc29SYXBpZG8uYWRqdXN0SGVpZ2h0KCk7XG4gIEJzQWNlc3NvUmFwaWRvLmFkanVzdEFycm93UG9zaXRpb24oKTtcbn0pXG4iLCIvKipcbiAqIEJzIEF1ZGlvXG4gKi9cbnZhciBCc0F1ZGlvID0gZnVuY3Rpb24gKGVsZW0sIHNldHRpbmdzKSB7XG4gIC8qKlxuICAgKiBHZW5lcmFsIGNvbmZpZ1xuICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgKi9cbiAgdmFyIGNvbmZpZyA9IHt9O1xuXG4gIC8qKlxuICAgKiBTZXQgQ29uZmlnXG4gICAqIEBwYXJhbSAge09iamVjdH0gZWwgICAgICBlbGVtZW50XG4gICAqIEBwYXJhbSAge09iamVjdH0gb3B0aW9ucyBDdXN0b20gb3B0aW9uc1xuICAgKiBAcmV0dXJuIHtPYmplY3R9ICAgICAgICAgRGVmYXVsdCBvcHRpb25zIGV4dGVuZCBieSBjdXN0b21cbiAgICovXG4gIHZhciBzZXRDb25maWcgPSBmdW5jdGlvbiAoZWwsIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gZXh0ZW5kKHtcbiAgICAgIGVsOiBlbCxcbiAgICAgIGF1ZGlvOiBlbC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtYXVkaW8tc3JjJyksXG4gICAgICBwbGF5QnV0dG9uOiBlbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtYXVkaW8tcGxheScpLFxuICAgICAgcGF1c2VCdXR0b246IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1hdWRpby1wYXVzZScpLFxuICAgICAgdG9nZ2xlQnV0dG9uOiBlbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtYXVkaW8tcGxheS1wYXVzZScpLFxuICAgICAgc3RvcEJ1dHRvbjogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWF1ZGlvLXN0b3AnKSxcbiAgICAgIGZvcndhcmRCdXR0b246IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1hdWRpby1mb3J3YXJkJyksXG4gICAgICBiYWNrd2FyZEJ1dHRvbjogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWF1ZGlvLWJhY2t3YXJkJyksXG4gICAgICBzdGFydEJ1dHRvbjogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWF1ZGlvLXN0YXJ0JyksXG4gICAgICBlbmRCdXR0b246IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1hdWRpby1lbmQnKSxcbiAgICAgIGluY3JlYXNlVm9sdW1lQnV0dG9uOiBlbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtYXVkaW8tdm9sdW1lLWluY3JlYXNlJyksXG4gICAgICBkZWNyZWFzZVZvbHVtZUJ1dHRvbjogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWF1ZGlvLXZvbHVtZS1kZWNyZWFzZScpLFxuICAgICAgbXV0ZVZvbHVtZUJ1dHRvbjogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWF1ZGlvLXZvbHVtZS1tdXRlJyksXG4gICAgICBwcm9ncmVzc0JhcjogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWF1ZGlvLXByb2dyZXNzJyksXG4gICAgICBwcm9ncmVzc1JhbmdlOiBlbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtYXVkaW8tcHJvZ3Jlc3MtcmFuZ2UnKSxcbiAgICAgIHByb2dyZXNzT3V0cHV0OiBlbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtYXVkaW8tcHJvZ3Jlc3Mtb3V0cHV0JyksXG4gICAgICBkdXJhdGlvbk91dHB1dDogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWF1ZGlvLWR1cmF0aW9uLW91dHB1dCcpLFxuICAgICAgdm9sdW1lUmFuZ2U6IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1hdWRpby12b2x1bWUnKSxcbiAgICAgIHZvbHVtZU91dHB1dDogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWF1ZGlvLXZvbHVtZS1vdXRwdXQnKSxcbiAgICAgIHN0YXR1c091dHB1dDogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWF1ZGlvLXN0YXR1cycpLFxuICAgICAgYXV0b3BsYXk6IGZhbHNlLFxuICAgIH0sIG9wdGlvbnMsIHtcbiAgICAgIGlzUGxheWluZzogaXNQbGF5aW5nLFxuICAgICAgbGFzdFZvbHVtZTogMCxcbiAgICAgIGR1cmF0aW9uOiAwLFxuICAgICAgZHVyYXRpb25Gb3JtYXRlZDogMCxcbiAgICAgIHRpbWVJbnRlcnZhbDogbnVsbCxcbiAgICAgIHNob3VsZFBsYXk6IG51bGwsXG4gICAgICBldmVudHM6IHtcbiAgICAgICAgcGxheToge30sXG4gICAgICAgIHN0b3A6IHt9LFxuICAgICAgICBwYXVzZToge30sXG4gICAgICAgIGNoYW5nZVZvbHVtZToge30sXG4gICAgICAgIGNoYW5nZVRpbWU6IHt9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25maWcgPSBzZXRDb25maWcoZWxlbSwgc2V0dGluZ3MpO1xuXG4gICAgY29uZmlnLmF1ZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZGRhdGEnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25maWcuZHVyYXRpb24gPSBjb25maWcuYXVkaW8uZHVyYXRpb247XG4gICAgICBjb25maWcuZHVyYXRpb25Gb3JtYXRlZCA9IHNlY29uZHNUb1RpbWUoY29uZmlnLmR1cmF0aW9uLCB0cnVlKS50aW1lO1xuXG4gICAgICBpZiAoY29uZmlnLnByb2dyZXNzQmFyKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLnByb2dyZXNzQmFyLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICBzZXRQcm9ncmVzcyhlbCwgMCwgMCwgY29uZmlnLmR1cmF0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjb25maWcucHJvZ3Jlc3NSYW5nZSkge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5wcm9ncmVzc1JhbmdlLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICBzZXRQcm9ncmVzcyhlbCwgMCwgMCwgY29uZmlnLmR1cmF0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjb25maWcucHJvZ3Jlc3NPdXRwdXQpIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcucHJvZ3Jlc3NPdXRwdXQsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IGNvbmZpZy5hdWRpby5jdXJyZW50VGltZTtcbiAgICAgICAgICB2YXIgY3VycmVudFRpbWVGb3JtYXRlZCA9IHNlY29uZHNUb1RpbWUoY3VycmVudFRpbWUsIHRydWUpLnRpbWU7XG4gICAgICAgICAgdmFyIGN1cnJlbnRUaW1lVGV4dCA9IHNlY29uZHNUb1RpbWUoY3VycmVudFRpbWUsIHRydWUpLnRpbWVUZXh0O1xuXG4gICAgICAgICAgZWwudGV4dENvbnRlbnQgPSBjdXJyZW50VGltZUZvcm1hdGVkO1xuICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0ZXRpbWUnLCBjdXJyZW50VGltZUZvcm1hdGVkKTtcbiAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCAnVGVtcG8gYXR1YWw6ICcgKyBjdXJyZW50VGltZVRleHQpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbmZpZy5kdXJhdGlvbk91dHB1dCkge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5kdXJhdGlvbk91dHB1dCwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgdmFyIHRleHREdXJhdGlvbiA9IHNlY29uZHNUb1RpbWUoY29uZmlnLmR1cmF0aW9uLCB0cnVlKS50aW1lVGV4dDtcbiAgICAgICAgICBlbC50ZXh0Q29udGVudCA9IGNvbmZpZy5kdXJhdGlvbkZvcm1hdGVkO1xuICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0ZXRpbWUnLCBjb25maWcuZHVyYXRpb25Gb3JtYXRlZCk7XG4gICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1RlbXBvIHRvdGFsOiAnICsgdGV4dER1cmF0aW9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGhhbmRsZVZvbHVtZVVwZGF0ZSgpO1xuXG4gICAgICBpZiAoY29uZmlnLnBsYXlCdXR0b24pIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcucGxheUJ1dHRvbiwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwbGF5KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjb25maWcucGF1c2VCdXR0b24pIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcucGF1c2VCdXR0b24sIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcGF1c2UpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbmZpZy50b2dnbGVCdXR0b24pIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcudG9nZ2xlQnV0dG9uLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHBsYXlQYXVzZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoY29uZmlnLnN0b3BCdXR0b24pIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuc3RvcEJ1dHRvbiwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdG9wKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjb25maWcuZm9yd2FyZEJ1dHRvbikge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5mb3J3YXJkQnV0dG9uLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZvcndhcmQpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbmZpZy5iYWNrd2FyZEJ1dHRvbikge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5iYWNrd2FyZEJ1dHRvbiwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBiYWNrd2FyZCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoY29uZmlnLnN0YXJ0QnV0dG9uKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLnN0YXJ0QnV0dG9uLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvU3RhcnQpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbmZpZy5lbmRCdXR0b24pIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuZW5kQnV0dG9uLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvRW5kKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjb25maWcuaW5jcmVhc2VWb2x1bWVCdXR0b24pIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuaW5jcmVhc2VWb2x1bWVCdXR0b24sIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaW5jcmVhc2VWb2x1bWUpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbmZpZy5kZWNyZWFzZVZvbHVtZUJ1dHRvbikge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5kZWNyZWFzZVZvbHVtZUJ1dHRvbiwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWNyZWFzZVZvbHVtZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoY29uZmlnLm11dGVWb2x1bWVCdXR0b24pIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcubXV0ZVZvbHVtZUJ1dHRvbiwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBtdXRlVm9sdW1lKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjb25maWcudm9sdW1lUmFuZ2UpIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcudm9sdW1lUmFuZ2UsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZvbHVtZSA9IHBhcnNlRmxvYXQoZWwudmFsdWUpIC8gMTA7XG4gICAgICAgICAgICBzZXRWb2x1bWUodm9sdW1lKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdm9sdW1lID0gcGFyc2VGbG9hdChlbC52YWx1ZSkgLyAxMDtcbiAgICAgICAgICAgIHNldFZvbHVtZSh2b2x1bWUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbmZpZy5wcm9ncmVzc1JhbmdlKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLnByb2dyZXNzUmFuZ2UsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2V0VGltZShwYXJzZUZsb2F0KGVsLnZhbHVlKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2V0VGltZShwYXJzZUZsb2F0KGVsLnZhbHVlKSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25maWcuYXVkaW8uYWRkRXZlbnRMaXN0ZW5lcigndGltZXVwZGF0ZScsIGhhbmRsZVRpbWVVcGRhdGUpO1xuXG4gICAgICBjb25maWcuYXVkaW8uYWRkRXZlbnRMaXN0ZW5lcigndm9sdW1lY2hhbmdlJywgaGFuZGxlVm9sdW1lVXBkYXRlKTtcblxuICAgICAgaWYgKGNvbmZpZy5hdXRvcGxheSkge1xuICAgICAgICBwbGF5KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIElzIFBsYXlpbmdcbiAgICogQHJldHVybiB7Qm9vbGVhbn0gdHJ1ZSBpZiBhdWRpbyBpcyBwbGF5aW5nXG4gICAqL1xuICB2YXIgaXNQbGF5aW5nID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAhY29uZmlnLmF1ZGlvLnBhdXNlZDtcbiAgICAvLyByZXR1cm4gY29uZmlnLmF1ZGlvXG4gICAgLy8gICAmJiBjb25maWcuYXVkaW8uY3VycmVudFRpbWUgPiAwXG4gICAgLy8gICAmJiAhY29uZmlnLmF1ZGlvLnBhdXNlZFxuICAgIC8vICAgJiYgIWNvbmZpZy5hdWRpby5lbmRlZFxuICAgIC8vICAgJiYgY29uZmlnLmF1ZGlvLnJlYWR5U3RhdGUgPiAyO1xuICB9O1xuXG4gIC8qKlxuICAgKiBUb2dnbGUgcGxheS9wYXVzZVxuICAgKi9cbiAgdmFyIHBsYXlQYXVzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoaXNQbGF5aW5nKCkpIGNvbmZpZy5hdWRpby5wYXVzZSgpO1xuICAgIGVsc2UgY29uZmlnLmF1ZGlvLnBsYXkoKTtcbiAgfTtcblxuICAvKipcbiAgICogUGxheVxuICAgKi9cbiAgdmFyIHBsYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgY29uZmlnLmF1ZGlvLnBsYXkoKTtcbiAgICBydW5FdmVudEZ1bmN0aW9ucygncGxheScpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQYXVzZVxuICAgKi9cbiAgdmFyIHBhdXNlID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbmZpZy5hdWRpby5wYXVzZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTdG9wXG4gICAqL1xuICB2YXIgc3RvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25maWcuYXVkaW8ucGF1c2UoKTtcbiAgICBjb25maWcuYXVkaW8uY3VycmVudFRpbWUgPSAwO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTa2lwIEZvcndhcmRcbiAgICogQHBhcmFtICB7TnVtYmVyfSBzZWNvbmRzIGhvdyBtYW55IHNlY29uZHMgc2tpcCAoZGVmYXVsdDogMTApXG4gICAqL1xuICB2YXIgZm9yd2FyZCA9IGZ1bmN0aW9uIChzZWNvbmRzKSB7XG4gICAgaWYgKHR5cGVvZiBzZWNvbmRzICE9PSAnbnVtYmVyJyB8fCAhc2Vjb25kcykgc2Vjb25kcyA9IDEwO1xuICAgIGNoYW5nZVRpbWUoc2Vjb25kcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNraXAgQmFja3dhcmRcbiAgICogQHBhcmFtICB7TnVtYmVyfSBzZWNvbmRzIGhvdyBtYW55IHNlY29uZHMgc2tpcCAoZGVmYXVsdDogMTApXG4gICAqL1xuICB2YXIgYmFja3dhcmQgPSBmdW5jdGlvbiAoc2Vjb25kcykge1xuICAgIGlmICh0eXBlb2Ygc2Vjb25kcyAhPT0gJ251bWJlcicgfHwgIXNlY29uZHMpIHNlY29uZHMgPSAxMDtcbiAgICBjaGFuZ2VUaW1lKC1zZWNvbmRzKTtcbiAgfTtcblxuICAvKipcbiAgICogVG8gU3RhcnRcbiAgICovXG4gIHZhciB0b1N0YXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbmZpZy5hdWRpby5jdXJyZW50VGltZSA9IDA7XG4gICAgaGFuZGxlVGltZVVwZGF0ZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBUbyBFbmRcbiAgICovXG4gIHZhciB0b0VuZCA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoY29uZmlnLmR1cmF0aW9uKSBjb25maWcuYXVkaW8uY3VycmVudFRpbWUgPSBjb25maWcuZHVyYXRpb247XG4gICAgaGFuZGxlVGltZVVwZGF0ZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDaGFuZ2UgVGltZVxuICAgKiBAcGFyYW0gIHtOdW1iZXJ9IHNlY29uZHMgaG93IG1hbnkgc2Vjb25kcyBza2lwIChkZWZhdWx0OiAxMClcbiAgICovXG4gIHZhciBjaGFuZ2VUaW1lID0gZnVuY3Rpb24gKHNlY29uZHMpIHtcbiAgICB2YXIgY3VycmVudFRpbWUgPSBjb25maWcuYXVkaW8uY3VycmVudFRpbWU7XG4gICAgaWYgKHR5cGVvZiBzZWNvbmRzICE9PSAnbnVtYmVyJyB8fCAhc2Vjb25kcykgcmV0dXJuO1xuICAgIGNvbmZpZy5hdWRpby5jdXJyZW50VGltZSA9IGN1cnJlbnRUaW1lICsgc2Vjb25kcztcbiAgICBoYW5kbGVUaW1lVXBkYXRlKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldCBBdWRpbyBUaW1lXG4gICAqIEBwYXJhbSAge051bWJlcn0gdGltZSBzcGVjaWZpYyBhdWRpbyB0aW1lIGluIHNlY29uZHNcbiAgICovXG4gIHZhciBzZXRUaW1lID0gZnVuY3Rpb24gKHRpbWUpIHtcbiAgICBjbGVhclRpbWVvdXQoY29uZmlnLnRpbWVJbnRlcnZhbCk7XG5cbiAgICBpZiAoY29uZmlnLnNob3VsZFBsYXkgPT09IG51bGwpIGNvbmZpZy5zaG91bGRQbGF5ID0gaXNQbGF5aW5nKCk7XG5cbiAgICBwYXVzZSgpO1xuICAgIGNoYW5nZVByb2dyZXNzQmFyKHRpbWUpO1xuICAgIGNoYW5nZVByb2dyZXNzT3V0cHV0KHRpbWUpO1xuXG4gICAgY29uZmlnLnRpbWVJbnRlcnZhbCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgY29uZmlnLmF1ZGlvLmN1cnJlbnRUaW1lID0gdGltZTtcbiAgICAgIGhhbmRsZVRpbWVVcGRhdGUoKTtcbiAgICAgIGlmIChjb25maWcuc2hvdWxkUGxheSkgcGxheSgpO1xuICAgICAgY29uZmlnLnNob3VsZFBsYXkgPSBudWxsO1xuICAgIH0sIDApO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJbmNyZWFzZSBWb2x1bWVcbiAgICogQHBhcmFtICB7TnVtYmVyfSBzdGVwIGhvdyBtYW55IGRlY2liZWxzIHRvIGluY3JlYXNlICgxIC0gOSlcbiAgICovXG4gIHZhciBpbmNyZWFzZVZvbHVtZSA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgaWYgKHR5cGVvZiBzdGVwICE9PSAnbnVtYmVyJyB8fCAhc3RlcCkgc3RlcCA9IDE7XG4gICAgY2hhbmdlVm9sdW1lKHN0ZXApO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEZWNyZWFzZSBWb2x1bWVcbiAgICogQHBhcmFtICB7TnVtYmVyfSBzdGVwIGhvdyBtYW55IGRlY2liZWxzIHRvIGRlY3JlYXNlICgxIC0gOSlcbiAgICovXG4gIHZhciBkZWNyZWFzZVZvbHVtZSA9IGZ1bmN0aW9uIChzdGVwKSB7XG4gICAgaWYgKHR5cGVvZiBzdGVwICE9PSAnbnVtYmVyJyB8fCAhc3RlcCkgc3RlcCA9IDE7XG4gICAgY2hhbmdlVm9sdW1lKC1zdGVwKTtcbiAgfTtcblxuICAvKipcbiAgICogTXV0ZSBWb2x1bWVcbiAgICogQHBhcmFtICB7TnVtYmVyfSB2b2x1bWUgaG93IG1hbnkgZGVjaWJlbHMgdG8gZGVjcmVhc2UgKDEgLSA5KVxuICAgKi9cbiAgdmFyIG11dGVWb2x1bWUgPSBmdW5jdGlvbiAodm9sdW1lKSB7XG4gICAgdmFyIGN1cnJlbnREZWNpYmVscyA9IGNvbmZpZy5hdWRpby52b2x1bWU7XG4gICAgaWYgKHR5cGVvZiB2b2x1bWUgIT09ICdudW1iZXInIHx8ICF2b2x1bWUpIHZvbHVtZSA9IDE7XG4gICAgaWYgKGN1cnJlbnREZWNpYmVscykge1xuICAgICAgY29uZmlnLmxhc3RWb2x1bWUgPSBNYXRoLmZsb29yKGN1cnJlbnREZWNpYmVscyAqIDEwKTtcbiAgICAgIHNldFZvbHVtZSgwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2V0Vm9sdW1lKGNvbmZpZy5sYXN0Vm9sdW1lKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENoYW5nZSBWb2x1bWVcbiAgICogQHBhcmFtICB7TnVtYmVyfSBzdGVwIGhvdyBtYW55IGRlY2liZWxzIHRvIGluY3JlYXNlICgxIHRvIDkpIG9yIGRlY3JlYXNlICgtMSB0byAtOSlcbiAgICovXG4gIHZhciBjaGFuZ2VWb2x1bWUgPSBmdW5jdGlvbiAoc3RlcCkge1xuICAgIHZhciBjdXJyZW50RGVjaWJlbHMgPSBjb25maWcuYXVkaW8udm9sdW1lO1xuICAgIHZhciBkZWNpYmVscyA9IDA7XG5cbiAgICBpZiAodHlwZW9mIHN0ZXAgIT09ICdudW1iZXInIHx8ICFzdGVwKSBzdGVwID0gMTtcblxuICAgIGRlY2liZWxzID0gY3VycmVudERlY2liZWxzICsgKE1hdGguZmxvb3Ioc3RlcCkgLyAxMCk7XG5cbiAgICBpZiAoZGVjaWJlbHMgPiAxKSBkZWNpYmVscyA9IDE7XG4gICAgaWYgKGRlY2liZWxzIDwgMCkgZGVjaWJlbHMgPSAwO1xuXG4gICAgaWYgKGRlY2liZWxzID49IDAgJiYgZGVjaWJlbHMgPD0gMSkge1xuICAgICAgY29uZmlnLmF1ZGlvLnZvbHVtZSA9IHBhcnNlRmxvYXQoZGVjaWJlbHMudG9GaXhlZCgxKSk7XG4gICAgICBoYW5kbGVWb2x1bWVVcGRhdGUoKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldCBWb2x1bWVcbiAgICogQHBhcmFtICB7TnVtYmVyfSB2b2x1bWUgc3BlY2lmaWMgdm9sdW1lIGRlY2liZWxzICgwIC0gMTApXG4gICAqL1xuICB2YXIgc2V0Vm9sdW1lID0gZnVuY3Rpb24gKHZvbHVtZSkge1xuICAgIHZhciBkZWNpYmVscyA9IE1hdGguZmxvb3Iodm9sdW1lKSAvIDEwO1xuICAgIGNvbmZpZy5hdWRpby52b2x1bWUgPSBkZWNpYmVscztcbiAgfTtcblxuICB2YXIgY2hhbmdlUHJvZ3Jlc3NCYXIgPSBmdW5jdGlvbiAodGltZSkge1xuICAgIGlmIChjb25maWcucHJvZ3Jlc3NCYXIpIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLnByb2dyZXNzQmFyLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgZWwudmFsdWUgPSB0aW1lO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBjaGFuZ2VQcm9ncmVzc1JhbmdlID0gZnVuY3Rpb24gKHRpbWUpIHtcbiAgICBpZiAoY29uZmlnLnByb2dyZXNzUmFuZ2UpIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLnByb2dyZXNzUmFuZ2UsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICBlbC52YWx1ZSA9IHRpbWU7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGNoYW5nZVByb2dyZXNzT3V0cHV0ID0gZnVuY3Rpb24gKHRpbWUpIHtcbiAgICB2YXIgY3VycmVudFRpbWVGb3JtYXRlZCA9IHNlY29uZHNUb1RpbWUodGltZSwgdHJ1ZSkudGltZTtcbiAgICBpZiAoY29uZmlnLnByb2dyZXNzT3V0cHV0KSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5wcm9ncmVzc091dHB1dCwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgIGVsLnRleHRDb250ZW50ID0gY3VycmVudFRpbWVGb3JtYXRlZDtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICB2YXIgaGFuZGxlVGltZVVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY3VycmVudFRpbWUgPSBjb25maWcuYXVkaW8uY3VycmVudFRpbWU7XG4gICAgY2hhbmdlUHJvZ3Jlc3NCYXIoY3VycmVudFRpbWUpO1xuICAgIGNoYW5nZVByb2dyZXNzUmFuZ2UoY3VycmVudFRpbWUpO1xuICAgIGNoYW5nZVByb2dyZXNzT3V0cHV0KGN1cnJlbnRUaW1lKTtcbiAgfTtcblxuICB2YXIgaGFuZGxlVm9sdW1lVXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB2b2x1bWUgPSBjb25maWcuYXVkaW8udm9sdW1lICogMTAwO1xuXG4gICAgaWYgKGNvbmZpZy52b2x1bWVSYW5nZSkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcudm9sdW1lUmFuZ2UsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICBlbC52YWx1ZSA9IHZvbHVtZTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChjb25maWcudm9sdW1lT3V0cHV0KSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy52b2x1bWVPdXRwdXQsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICBlbC50ZXh0Q29udGVudCA9IHZvbHVtZTtcbiAgICAgICAgZWwudmFsdWUgPSB2b2x1bWU7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHNldFByb2dyZXNzID0gZnVuY3Rpb24gKGVsZW1lbnQsIGN1cnJlbnQsIG1pbiwgbWF4KSB7XG4gICAgaWYgKHR5cGVvZiBjdXJyZW50ID09PSAnbnVtYmVyJykgZWxlbWVudC52YWx1ZSA9IGN1cnJlbnQ7XG4gICAgaWYgKHR5cGVvZiBtaW4gPT09ICdudW1iZXInKSBlbGVtZW50Lm1pbiA9IG1pbjtcbiAgICBpZiAodHlwZW9mIG1heCA9PT0gJ251bWJlcicpIGVsZW1lbnQubWF4ID0gbWF4O1xuICB9O1xuXG4gIHZhciBzZWNvbmRzVG9UaW1lID0gZnVuY3Rpb24gKHB1cmVTZWNvbmRzLCBoaWRlWmVyb0hvdXIpIHtcbiAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKG51bGwpO1xuICAgIHZhciB0b0xlYWRpbmdaZXJvID0gZnVuY3Rpb24gKHRpbWUpIHtcbiAgICAgIHJldHVybiAodGltZSA8IDEwID8gJzAnIDogJycpICsgdGltZS50b1N0cmluZygpO1xuICAgIH07XG4gICAgdmFyIHRvVGV4dCA9IGZ1bmN0aW9uICh0aW1lLCBzaW5ndWxhclRleHQpIHtcbiAgICAgIGlmICh0aW1lICYmIHNpbmd1bGFyVGV4dCkge1xuICAgICAgICByZXR1cm4gdGltZS50b1N0cmluZygpICsgJyAnICsgc2luZ3VsYXJUZXh0ICsgKHRpbWUgPiAxID8gJ3MnIDogJycpO1xuICAgICAgfVxuICAgICAgcmV0dXJuICcnO1xuICAgIH07XG4gICAgdmFyIHNlY29uZHMgPSBwYXJzZUludChwdXJlU2Vjb25kcywgMTApO1xuICAgIHZhciBob3VyID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gMzYwMCk7XG4gICAgdmFyIG1pbnV0ZSA9IE1hdGguZmxvb3IoKHNlY29uZHMgLSAoaG91ciAqIDM2MDApKSAvIDYwKTtcbiAgICB2YXIgc2Vjb25kID0gTWF0aC5mbG9vcihzZWNvbmRzIC0gKGhvdXIgKiAzNjAwKSAtIChtaW51dGUgKiA2MCkpO1xuICAgIHZhciBob3VyU3RyID0gdG9MZWFkaW5nWmVybyhob3VyKTtcbiAgICB2YXIgbWludXRlU3RyID0gdG9MZWFkaW5nWmVybyhtaW51dGUpO1xuICAgIHZhciBzZWNvbmRTdHIgPSB0b0xlYWRpbmdaZXJvKHNlY29uZCk7XG4gICAgdmFyIGhvdXJUZXh0ID0gdG9UZXh0KGhvdXIsICdob3JhJyk7XG4gICAgdmFyIG1pbnV0ZVRleHQgPSB0b1RleHQobWludXRlLCAnbWludXRvJyk7XG4gICAgdmFyIHNlY29uZFRleHQgPSB0b1RleHQoc2Vjb25kLCAnc2VndW5kbycpO1xuICAgIHZhciB0aW1lID0gbWludXRlU3RyICsgJzonICsgc2Vjb25kU3RyO1xuICAgIHZhciB0aW1lVGV4dCA9ICcnXG4gICAgICArIChob3VyVGV4dCB8fCAnJylcbiAgICAgICsgKGhvdXJUZXh0ICYmIChtaW51dGVUZXh0IHx8IHNlY29uZFRleHQpID8gJywgJyA6ICcnKVxuICAgICAgKyAobWludXRlVGV4dCB8fCAnJylcbiAgICAgICsgKG1pbnV0ZVRleHQgJiYgc2Vjb25kVGV4dCA/ICcsICcgOiAnJylcbiAgICAgICsgKHNlY29uZFRleHQgfHwgJycpO1xuXG4gICAgaWYgKGhvdXIgfHwgIWhpZGVaZXJvSG91cikgdGltZSA9IGhvdXJTdHIgKyAnOicgKyB0aW1lO1xuXG4gICAgZGF0ZS5zZXRTZWNvbmRzKHNlY29uZHMpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGU6IGRhdGUsXG4gICAgICB0aW1lOiB0aW1lLFxuICAgICAgdGltZVRleHQ6IHRpbWVUZXh0LFxuICAgICAgdGltZUxvY2FsZTogZGF0ZS50b0xvY2FsZVRpbWVTdHJpbmcoJ3B0LWJyJyksXG4gICAgICBob3VyOiBob3VyLFxuICAgICAgbWludXRlOiBtaW51dGUsXG4gICAgICBzZWNvbmQ6IHNlY29uZCxcbiAgICAgIGhvdXJUZXh0OiBob3VyVGV4dCxcbiAgICAgIG1pbnV0ZVRleHQ6IG1pbnV0ZVRleHQsXG4gICAgICBzZWNvbmRUZXh0OiBzZWNvbmRUZXh0LFxuICAgIH07XG4gIH07XG5cbiAgLyoqXG4gICAqIE9uXG4gICAqIEFkZCBhIGZ1bmN0aW9uIChjYikgdG8gcnVuIGR1cmluZyBhIHNwZWNpZmljIGV2ZW50IChldilcbiAgICogQHBhcmFtICB7U3RyaW5nfSAgIGV2IGV2ZW50IG5hbWVcbiAgICogQHBhcmFtICB7RnVuY3Rpb259IGNiIGNhbGxiYWNrXG4gICAqL1xuICB2YXIgb24gPSBmdW5jdGlvbiAoZXYsIGNiKSB7XG4gICAgaWYgKHR5cGVvZiBldiAhPT0gJ3N0cmluZycgfHwgIWNvbmZpZy5ldmVudHNbZXZdKSByZXR1cm47XG4gICAgaWYgKHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykgcmV0dXJuO1xuXG4gICAgaWYgKGNiLm5hbWUpIHtcbiAgICAgIGNvbmZpZy5ldmVudHNbZXZdW2NiLm5hbWVdID0gY2I7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChjb25maWcuZXZlbnRzW2V2XS51bm5hbWVkIHx8ICFBcnJheS5pc0FycmF5KGNvbmZpZy5ldmVudHNbZXZdLnVubmFtZWQpKSB7XG4gICAgICAgIGNvbmZpZy5ldmVudHNbZXZdLnVubmFtZWQgPSBbXTtcbiAgICAgIH1cbiAgICAgIGNvbmZpZy5ldmVudHNbZXZdLnVubmFtZWQucHVzaChjYik7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBPZmZcbiAgICogcmVtb3ZlIGEgZnVuY3Rpb24gKGNiKSBmcm9tIGEgc3BlY2lmaWMgZXZlbnQgKGV2KVxuICAgKiBAcGFyYW0gIHtTdHJpbmd9ICBldiAgICAgICAgICAgZXZlbnQgbmFtZVxuICAgKiBAcGFyYW0gIHtTdHJpbmd9ICBmdW5jdGlvbk5hbWUgZnVuY3Rpb24gbmFtZVxuICAgKi9cbiAgdmFyIG9mZiA9IGZ1bmN0aW9uIChldiwgZnVuY3Rpb25OYW1lKSB7XG4gICAgaWYgKHR5cGVvZiBldiAhPT0gJ3N0cmluZycgfHwgIWNvbmZpZy5ldmVudHNbZXZdKSByZXR1cm47XG4gICAgaWYgKHR5cGVvZiBmdW5jdGlvbk5hbWUgIT09ICdzdHJpbmcnKSByZXR1cm47XG5cbiAgICBjb25maWcuZXZlbnRzW2V2XVtmdW5jdGlvbk5hbWVdID0gbnVsbDtcbiAgfTtcblxuICAvKipcbiAgICogUnVuIEV2ZW50IEZ1bmN0aW9uc1xuICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgZXYgZXZlbnQgbmFtZVxuICAgKi9cbiAgdmFyIHJ1bkV2ZW50RnVuY3Rpb25zID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgaWYgKHR5cGVvZiBldiAhPT0gJ3N0cmluZycgfHwgIWNvbmZpZy5ldmVudHNbZXZdKSByZXR1cm47XG4gICAgaWYgKE9iamVjdC5rZXlzKGNvbmZpZy5ldmVudHNbZXZdKS5sZW5ndGgpIHtcbiAgICAgIE9iamVjdC5rZXlzKGNvbmZpZy5ldmVudHNbZXZdKS5mb3JFYWNoKGZ1bmN0aW9uIChldmVudEtleSkge1xuICAgICAgICBpZiAoZXZlbnRLZXkgPT09ICd1bm5hbWVkJ1xuICAgICAgICAgICYmIGNvbmZpZy5ldmVudHNbZXZdLnVubmFtZWRcbiAgICAgICAgICAmJiBBcnJheS5pc0FycmF5KGNvbmZpZy5ldmVudHNbZXZdLnVubmFtZWQpKSB7XG4gICAgICAgICAgY29uZmlnLmV2ZW50c1tldl0udW5uYW1lZC5mb3JFYWNoKGZ1bmN0aW9uIChmbikge1xuICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25maWcuZXZlbnRzW2V2XVtldmVudEtleV0oKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICBvbjogb24sXG4gICAgb2ZmOiBvZmYsXG4gICAgaXNQbGF5aW5nOiBpc1BsYXlpbmcsXG4gICAgcGxheVBhdXNlOiBwbGF5UGF1c2UsXG4gICAgcGxheTogcGxheSxcbiAgICBwYXVzZTogcGF1c2UsXG4gICAgc3RvcDogc3RvcCxcbiAgICBmb3J3YXJkOiBmb3J3YXJkLFxuICAgIGJhY2t3YXJkOiBiYWNrd2FyZCxcbiAgICB0b1N0YXJ0OiB0b1N0YXJ0LFxuICAgIHRvRW5kOiB0b0VuZCxcbiAgICBjaGFuZ2VUaW1lOiBjaGFuZ2VUaW1lLFxuICAgIHNldFRpbWU6IHNldFRpbWUsXG4gICAgaW5jcmVhc2VWb2x1bWU6IGluY3JlYXNlVm9sdW1lLFxuICAgIGRlY3JlYXNlVm9sdW1lOiBkZWNyZWFzZVZvbHVtZSxcbiAgICBjaGFuZ2VWb2x1bWU6IGNoYW5nZVZvbHVtZSxcbiAgICBzZXRWb2x1bWU6IHNldFZvbHVtZSxcbiAgICBjaGFuZ2VQcm9ncmVzc0JhcjogY2hhbmdlUHJvZ3Jlc3NCYXIsXG4gICAgY2hhbmdlUHJvZ3Jlc3NSYW5nZTogY2hhbmdlUHJvZ3Jlc3NSYW5nZSxcbiAgICBjaGFuZ2VQcm9ncmVzc091dHB1dDogY2hhbmdlUHJvZ3Jlc3NPdXRwdXQsXG4gICAgaGFuZGxlVGltZVVwZGF0ZTogaGFuZGxlVGltZVVwZGF0ZSxcbiAgICBoYW5kbGVWb2x1bWVVcGRhdGU6IGhhbmRsZVZvbHVtZVVwZGF0ZSxcbiAgICBzZXRQcm9ncmVzczogc2V0UHJvZ3Jlc3MsXG4gICAgc2Vjb25kc1RvVGltZTogc2Vjb25kc1RvVGltZSxcbiAgfTtcbn07XG5cbi8qKlxuICogSW5pdCBBdWRpbyBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgdmFyIGF1ZGlvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1hdWRpbycpO1xuICBpZiAoYXVkaW9zLmxlbmd0aCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYXVkaW9zLCBmdW5jdGlvbiAoYXVkaW8pIHtcbiAgICAgIHZhciBhdWRpb0NvbnN0cnVjdG9yID0gbmV3IEJzQXVkaW8oYXVkaW8pO1xuICAgICAgYXVkaW9Db25zdHJ1Y3Rvci5pbml0KCk7XG4gICAgfSk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBCcyBBdWRpbyBCdXR0b25zXG4gKi9cbnZhciBCc0F1ZGlvQnV0dG9ucyA9IChmdW5jdGlvbiAoKSB7XG5cbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBidXR0b25QbGF5OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtYXVkaW8tcGxheScpLFxuICAgIGJ1dHRvblBhdXNlOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtYXVkaW8tcGF1c2UnKSxcbiAgICBidXR0b25Wb2x1bWU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1hdWRpby12b2x1bWUtbXV0ZScpLFxuICAgIGF1ZGlvVm9sdW1lOiAnLmJzLWpzLWF1ZGlvLXZvbHVtZS1tdXRlJyxcbiAgICBhdWRpb1ZvbHVtZUluY3JlYXNlOiAnLmJzLWpzLXZvbHVtZS1pbmNyZWFzZScsXG4gICAgYXVkaW9Wb2x1bWVNdXRlOiAnLmJzLWpzLXZvbHVtZS1tdXRlJyxcbiAgICByYW5nZUlucHV0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtYXVkaW8tY29udHJvbHNfX3ZvbHVtZSBpbnB1dCcpLFxuICAgIG91dHB1dDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWF1ZGlvLWNvbnRyb2xzX192b2x1bWUgb3V0cHV0JyksXG4gICAgdm9sdW1lSWNvbnM6ICcuaWNvbicsXG4gICAgY29udHJvbE9mZjogJ2JzLWF1ZGlvLWNvbnRyb2xzLS1vZmYnLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgY29uZmlnLnJhbmdlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oZSkge1xuICAgICAgcmFuZ2VWb2x1bWUoKTtcbiAgICAgIHZvbHVtZUNvbnRyb2xSYW5nZShlKTtcbiAgICB9KTtcbiAgICBjb25maWcucmFuZ2VJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGZ1bmN0aW9uKCkge1xuICAgICAgcmFuZ2VWb2x1bWUoKTtcbiAgICB9KTtcbiAgICBjb25maWcuYnV0dG9uUGxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgcGxheSgpO1xuICAgIH0pO1xuICAgIGNvbmZpZy5idXR0b25QYXVzZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgcGF1c2UoKTtcbiAgICB9KTtcbiAgICBjb25maWcuYnV0dG9uVm9sdW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oYnV0dG9uKSB7XG4gICAgICB2b2x1bWVDb250cm9sKGJ1dHRvbik7XG4gICAgICAvLyBTZXQgcmFuZ2Ugd2l0aCBmYWtlIHN0eWxlIC0gdGltZW91dCBwcmV2ZW50IHBhZ2Vsb2FkXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmFuZ2VWb2x1bWUoKTtcbiAgICAgIH0sIDUwKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgcmFuZ2VWb2x1bWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHZhbHVlID0gY29uZmlnLnJhbmdlSW5wdXQudmFsdWU7XG4gICAgY29uZmlnLm91dHB1dC5zdHlsZS53aWR0aD0gdmFsdWUgKyAnJSc7XG4gIH1cblxuICB2YXIgcGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25maWcuYnV0dG9uUGxheS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jb250cm9sT2ZmKTtcbiAgICBjb25maWcuYnV0dG9uUGF1c2UuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY29udHJvbE9mZik7XG4gIH07XG5cbiAgdmFyIHBhdXNlID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbmZpZy5idXR0b25QbGF5LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNvbnRyb2xPZmYpO1xuICAgIGNvbmZpZy5idXR0b25QYXVzZS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jb250cm9sT2ZmKTtcbiAgfTtcblxuICB2YXIgdm9sdW1lQ29udHJvbCA9IGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICB2YXIgYnV0dG9uVm9sdW1lSWNvbiA9IGJ1dHRvbi5jdXJyZW50VGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLnZvbHVtZUljb25zKTtcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYnV0dG9uVm9sdW1lSWNvbiwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICB2YXIgYnRuT2ZmID0gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5jb250cm9sT2ZmKTtcblxuICAgICAgaWYgKGJ0bk9mZikgZWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY29udHJvbE9mZik7XG4gICAgICBlbHNlIGVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNvbnRyb2xPZmYpO1xuXG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIHZvbHVtZUNvbnRyb2xSYW5nZSA9IGZ1bmN0aW9uIChlKSB7XG5cbiAgICAvLyBSZWNlaXZlIGJ1dHRvbiBtdXRlLCB0byBnZXQgaXRlbXNcbiAgICB2YXIgYnV0dG9uID0gZS5jdXJyZW50VGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5hdWRpb1ZvbHVtZSk7XG4gICAgdmFyIGluY3JlYXNlID0gYnV0dG9uLnBhcmVudE5vZGUucXVlcnlTZWxlY3Rvcihjb25maWcuYXVkaW9Wb2x1bWVJbmNyZWFzZSk7XG4gICAgdmFyIG11dGUgPSBidXR0b24ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5hdWRpb1ZvbHVtZU11dGUpO1xuICAgIFxuICAgIHZhciB2YWx1ZSA9IGNvbmZpZy5yYW5nZUlucHV0LnZhbHVlO1xuXG4gICAgaWYgKHZhbHVlICE9PSAnMCcpIHtcbiAgICAgIGluY3JlYXNlLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNvbnRyb2xPZmYpO1xuICAgICAgbXV0ZS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jb250cm9sT2ZmKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW5jcmVhc2UuY2xhc3NMaXN0LmFkZChjb25maWcuY29udHJvbE9mZik7XG4gICAgICBtdXRlLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNvbnRyb2xPZmYpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gIH07XG5cbn0oKSk7XG5cblxuXG4vKipcbiAqIEluaXQgQXVkaW8gQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtYXVkaW8tY29udHJvbHMnKSkge1xuICAgIEJzQXVkaW9CdXR0b25zLmluaXQoKTtcbiAgfVxufSk7IiwiLyoqXG4gKiBCYW5uZXIgVG9wb1xuICogQHJldHVybiBNb2R1bGUgY29uZmlnXG4gKi9cbnZhciBCc0Jhbm5lclRvcG8gPSAoZnVuY3Rpb24gKCkge1xuICAvKipcbiAgICogSW5pdCBmdW5jdGlvblxuICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gTW9kdWxlJ3Mgc2NvcGUgZnVuY3Rpb25zXG4gICAqL1xuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyB2YXIgYmFubmVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1iYW5uZXInKTtcbiAgICB2YXIgaGlnaGxpZ2h0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1iYW5uZXItdGl0bGUtaGlnaGxpZ2h0Jyk7XG4gICAgaWYgKGhpZ2hsaWdodHMgJiYgaGlnaGxpZ2h0cy5sZW5ndGgpIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaGlnaGxpZ2h0cywgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgIHZhciBkYXRhID0gZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWhpZ2hsaWdodCcpO1xuICAgICAgICBoaWdobGlnaHQoZWwsIGRhdGEpO1xuICAgICAgfSlcbiAgICB9XG5cbiAgICBzZXRTbGlkZXIoKTtcbiAgfTtcblxuICB2YXIgaGlnaGxpZ2h0ID0gZnVuY3Rpb24gKGVsLCBkYXRhKSB7XG4gICAgLy8gdmFyIHRleHRWZWxvY2l0eSA9IDEwMDtcbiAgICB2YXIgcGF1c2VUaW1lID0gMjAwMDtcbiAgICAvLyB2YXIgZGF0YUFyciA9IGRhdGEuc3BsaXQoL1sgLF0rLyk7XG4gICAgdmFyIGRhdGFBcnIgPSBkYXRhLnNwbGl0KCcsJyk7XG4gICAgLy8gdmFyIGRhdGFMZW4gPSBkYXRhQXJyLmxlbmd0aDtcbiAgICAvLyB2YXIgaSA9IDA7XG4gICAgdmFyIHRleHRUeXBlID0gbmV3IEJzVGV4dFR5cGUoKTtcblxuICAgIGlmIChkYXRhQXJyKSB7XG4gICAgICB0ZXh0VHlwZS5pbml0KHtcbiAgICAgICAgZWw6IGVsLFxuICAgICAgICB0ZXh0QXJyOiBkYXRhQXJyLFxuICAgICAgICBwYXVzZVRpbWU6IHBhdXNlVGltZSxcbiAgICAgIH0pO1xuICAgICAgLy8gbmV3IFR4dFR5cGUoZWwsIGRhdGFBcnIsIHBhdXNlVGltZSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBzZXRTbGlkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGJhbm5lckxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtYmFubmVyX19saXN0Jyk7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChiYW5uZXJMaXN0LCBmdW5jdGlvbiAobGlzdCkge1xuICAgICAgdmFyIGJhbm5lckl0ZW1zID0gbGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtYmFubmVyX19pdGVtJyk7XG4gICAgICB2YXIgYnV0dG9uUHJldiA9IGxpc3QucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtYmFubmVyX19zbGlkZXItYnV0dG9uLnByZXYnKTtcbiAgICAgIHZhciBidXR0b25OZXh0ID0gbGlzdC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1iYW5uZXJfX3NsaWRlci1idXR0b24ubmV4dCcpO1xuICAgICAgdmFyIGZsa3R5ID0gbnVsbDtcbiAgICAgIC8vIHNldCBwcmV2L25leHQgdGh1bWJuYWlscyBmcm9tIGFjdGl2ZSBzbGlkZSBpbmRleFxuICAgICAgdmFyIHNldFByZXZOZXh0VGh1bWJuYWlsID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHZhciBzbGlkZXMgPSBmbGt0eS5jZWxscztcbiAgICAgICAgdmFyIHByZXZTbGlkZSA9IChcbiAgICAgICAgICAoaW5kZXggLSAxKSA+IC0xXG4gICAgICAgICkgPyBzbGlkZXNbaW5kZXggLSAxXS5lbGVtZW50XG4gICAgICAgICAgOiBzbGlkZXNbc2xpZGVzLmxlbmd0aCAtIDFdLmVsZW1lbnQ7XG4gICAgICAgIHZhciBuZXh0U2xpZGUgPSAoXG4gICAgICAgICAgKGluZGV4ICsgMSkgPCBzbGlkZXMubGVuZ3RoXG4gICAgICAgICkgPyBzbGlkZXNbaW5kZXggKyAxXS5lbGVtZW50XG4gICAgICAgICAgOiBzbGlkZXNbMF0uZWxlbWVudDtcbiAgICAgICAgdmFyIHByZXZUaHVtYlNyYyA9IHByZXZTbGlkZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGh1bWJuYWlsLXNyYycpO1xuICAgICAgICB2YXIgbmV4dFRodW1iU3JjID0gbmV4dFNsaWRlLmdldEF0dHJpYnV0ZSgnZGF0YS10aHVtYm5haWwtc3JjJyk7XG4gICAgICAgIHZhciBidXR0b25QcmV2SW1nID0gYnV0dG9uUHJldi5xdWVyeVNlbGVjdG9yKCdpbWcnKTtcbiAgICAgICAgdmFyIGJ1dHRvbk5leHRJbWcgPSBidXR0b25OZXh0LnF1ZXJ5U2VsZWN0b3IoJ2ltZycpO1xuICAgICAgICB2YXIgcHJldlRodW1iTGFiZWwgPSBwcmV2U2xpZGUuZ2V0QXR0cmlidXRlKCdkYXRhLXRodW1ibmFpbC1sYWJlbCcpO1xuICAgICAgICB2YXIgbmV4dFRodW1iTGFiZWwgPSBuZXh0U2xpZGUuZ2V0QXR0cmlidXRlKCdkYXRhLXRodW1ibmFpbC1sYWJlbCcpO1xuICAgICAgICB2YXIgYnV0dG9uUHJldkxhYmVsID0gYnV0dG9uUHJldi5xdWVyeVNlbGVjdG9yKCcuYnMtYmFubmVyX19zbGlkZXItcHJldmlldy1sYWJlbCcpO1xuICAgICAgICB2YXIgYnV0dG9uTmV4dExhYmVsID0gYnV0dG9uTmV4dC5xdWVyeVNlbGVjdG9yKCcuYnMtYmFubmVyX19zbGlkZXItcHJldmlldy1sYWJlbCcpO1xuXG4gICAgICAgIGJ1dHRvblByZXZJbWcuc3JjID0gcHJldlRodW1iU3JjO1xuICAgICAgICBidXR0b25OZXh0SW1nLnNyYyA9IG5leHRUaHVtYlNyYztcbiAgICAgICAgYnV0dG9uUHJldkxhYmVsLmlubmVySFRNTCA9IHByZXZUaHVtYkxhYmVsO1xuICAgICAgICBidXR0b25OZXh0TGFiZWwuaW5uZXJIVE1MID0gbmV4dFRodW1iTGFiZWw7XG4gICAgICB9O1xuICAgICAgLy8gaW5kaWNhdGUgYSBjaGFuZ2UgaW4gc2xpZGVyIHdhcyBtYWRlIG1hbnVhbGx5IChtYWRlIGJ5IHVzZXIgaW50ZXJhY3Rpb24pXG4gICAgICB2YXIgbWFudWFsQ2hhbmdlID0gZmFsc2U7XG5cbiAgICAgIC8vIGlmIGJhbm5lciBoYXMgaXRlbXNcbiAgICAgIGlmIChiYW5uZXJJdGVtcyAmJiBiYW5uZXJJdGVtcy5sZW5ndGggPiAxKSB7XG4gICAgICAgIC8vIHNldCBmbGlja2l0eSBjb25zdHJ1Y3RvclxuICAgICAgICBmbGt0eSA9IG5ldyBGbGlja2l0eShsaXN0LCB7XG4gICAgICAgICAgLy8gd2UgbWFkZSBvciBvd24gY3VzdG9tIGFjY2Vzc2liaWxpdHkgZmVhdHVyZXNcbiAgICAgICAgICBhY2Nlc3NpYmlsaXR5OiBmYWxzZSxcbiAgICAgICAgICB3cmFwQXJvdW5kOiB0cnVlLFxuICAgICAgICAgIHBhZ2VEb3RzOiB0cnVlLFxuICAgICAgICAgIC8vIHdlIG1hZGUgY3VzdG9tIHByZXYvbmV4dCBidXR0b25zXG4gICAgICAgICAgcHJldk5leHRCdXR0b25zOiBmYWxzZSxcbiAgICAgICAgICBhZGFwdGl2ZUhlaWdodDogdHJ1ZSxcbiAgICAgICAgICBhdXRvUGxheTogNTAwMCxcbiAgICAgICAgICBvbjoge1xuICAgICAgICAgICAgcmVhZHk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgLy8gYWRkIGFyaWEgaGlkZGVuIHRvIGlnbm9yZSBkb3RzIGZvciBzY3JlZW4gcmVhZGVyc1xuICAgICAgICAgICAgICBsaXN0LnF1ZXJ5U2VsZWN0b3IoJy5mbGlja2l0eS1wYWdlLWRvdHMnKS5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gZm9yIGRlYnVnXG4gICAgICAgIC8vIHdpbmRvdy5iYW5uZXJTbGlkZXIgPSBmbGt0eTtcbiAgICAgICAgLy8gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsIGZ1bmN0aW9uIChldikge2NvbnNvbGUubG9nKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpfSk7XG5cbiAgICAgICAgLy8gaGFuZGxlIHByZXYvbmV4dCB0aHVtYm5haWxzIG9uIHNsaWRlIGNoYW5nZXNcbiAgICAgICAgc2V0UHJldk5leHRUaHVtYm5haWwoMCk7XG4gICAgICAgIGZsa3R5Lm9uKCdzZWxlY3QnLCBzZXRQcmV2TmV4dFRodW1ibmFpbCk7XG5cbiAgICAgICAgLy8gYWRkIGxpc3RlbmVyIGZvciBjdXN0b20gcHJldiBidXR0b25cbiAgICAgICAgYnV0dG9uUHJldi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBmbGt0eS5wcmV2aW91cygpO1xuICAgICAgICAgIC8vIHR1cm4gZm9jdXMgYmFjayB0byBiYW5uZXIgbGlzdCB0byBhdm9pZCBiYW5uZXIgbGF5b3V0J3MgYnJlYWtcbiAgICAgICAgICBsaXN0LmZvY3VzKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGFkZCBsaXN0ZW5lciBmb3IgY3VzdG9tIHByZXYgYnV0dG9uXG4gICAgICAgIGJ1dHRvbk5leHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZmxrdHkubmV4dCgpO1xuICAgICAgICAgIC8vIHR1cm4gZm9jdXMgYmFjayB0byBiYW5uZXIgbGlzdCB0byBhdm9pZCBiYW5uZXIgbGF5b3V0J3MgYnJlYWtcbiAgICAgICAgICBsaXN0LmZvY3VzKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGhhbmRsZSBrZXlib2FyZCBuYXZpZ2F0aW9uXG4gICAgICAgIHZhciBoYW5kbGVLZXlib2FyZCA9IGZ1bmN0aW9uIChldikge1xuICAgICAgICAgIHZhciBrZXkgPSBldi5rZXk7XG4gICAgICAgICAgdmFyIHRhcmdldCA9IGV2LnRhcmdldDtcblxuICAgICAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgICAgICBjYXNlICdBcnJvd1JpZ2h0JzpcbiAgICAgICAgICAgIGNhc2UgJ1JpZ2h0JzpcbiAgICAgICAgICAgICAgbWFudWFsQ2hhbmdlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgZmxrdHkubmV4dCh0cnVlLCB0cnVlKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdBcnJvd0xlZnQnOlxuICAgICAgICAgICAgY2FzZSAnTGVmdCc6XG4gICAgICAgICAgICAgIG1hbnVhbENoYW5nZSA9IHRydWU7XG4gICAgICAgICAgICAgIGZsa3R5LnByZXZpb3VzKHRydWUsIHRydWUpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzZXQga2V5Ym9hcmQgbmF2aWdhdGlvbidzIGxpc3RlbmVyc1xuICAgICAgICBsaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVLZXlib2FyZCk7XG4gICAgICAgIGJ1dHRvblByZXYuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUtleWJvYXJkKTtcbiAgICAgICAgYnV0dG9uTmV4dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlS2V5Ym9hcmQpO1xuXG4gICAgICAgIC8vIGVuYWJsZSB0YWJpbmRleCBvbiBzbGlkZXMgYW5kIGl0cyBhbmNob3Igd2hlbiBmb2N1c2luXG4gICAgICAgIGZsa3R5LmNlbGxzLmZvckVhY2goZnVuY3Rpb24gKGNlbGwsIGluZGV4KSB7XG4gICAgICAgICAgY2VsbC5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYW5jaG9yID0gY2VsbC5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2EsIGJ1dHRvbicpO1xuICAgICAgICAgICAgY2VsbC5lbGVtZW50LnRhYkluZGV4ID0gJzAnO1xuICAgICAgICAgICAgaWYgKGFuY2hvcikgYW5jaG9yLnRhYkluZGV4ID0gJzAnO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBmb3JjZSBmaWNraXR5IHNlbGVjdGlvbiBhbmQgZm9jdXMgb24gYSBzbGlkZSBvbiBzbGlkZSBjbGlja1xuICAgICAgICBmbGt0eS5vbignc3RhdGljQ2xpY2snLCBmdW5jdGlvbihldmVudCwgcG9pbnRlciwgY2VsbEVsZW1lbnQsIGNlbGxJbmRleCkge1xuICAgICAgICAgIG1hbnVhbENoYW5nZSA9IHRydWU7XG4gICAgICAgICAgZmxrdHkuc2VsZWN0KGNlbGxJbmRleCwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgICAgLy8gZm9jdXMgaXMgc2V0dGVkIHRvIGNsaWNrZWQgZWxlbWVudFxuICAgICAgICAgIGV2ZW50LnRhcmdldC5mb2N1cygpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBkaXNhYmxlIHNsaWRlcidzIGF1dG9wbGF5IG9uIGZvY3VzIGluIGFueSBlbGVtZW50IGluIHNsaWRlclxuICAgICAgICBsaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICBmbGt0eS5zdG9wUGxheWVyKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGRpc2FibGUgc2xpZGVyJ3MgYXV0b3BsYXkgb24gZm9jdXMgb3V0IGZyb20gc2xpZGVyXG4gICAgICAgIGxpc3QuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICBmbGt0eS5wbGF5UGxheWVyKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGhhbmRsZSBmb2N1cyBhbmQgdGFiaW5kZXhlcyBvbiBzbGlkZSBjaGFuZ2VzXG4gICAgICAgIGZsa3R5Lm9uKCdzZWxlY3QnLCBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICBmbGt0eS5jZWxscy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsLCBjZWxsSW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBhbmNob3IgPSBjZWxsLmVsZW1lbnQucXVlcnlTZWxlY3RvcignYSwgYnV0dG9uJyk7XG4gICAgICAgICAgICBpZiAoYW5jaG9yKSB7XG4gICAgICAgICAgICAgIC8vIGVuYWJsZSB0YWJpbmRleCBvbiBjdXJyZW50IHNlbGVjdGVkIHNsaWRlXG4gICAgICAgICAgICAgIGlmIChjZWxsSW5kZXggPT09IGluZGV4KSB7XG4gICAgICAgICAgICAgICAgY2VsbC5lbGVtZW50LnRhYkluZGV4ID0gJzAnO1xuICAgICAgICAgICAgICAgIGFuY2hvci50YWJJbmRleCA9ICcwJztcblxuICAgICAgICAgICAgICAgIC8vIHNldCBmb2N1cyB0byBzbGlkZSBpZiBpdCdzIGEgbWFudWFsIGNoYW5nZVxuICAgICAgICAgICAgICAgIGlmIChtYW51YWxDaGFuZ2UpIHtcbiAgICAgICAgICAgICAgICAgIGNlbGwuZWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgbWFudWFsQ2hhbmdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvLyBkaXNhYmxlIHRhYmluZGV4IG9uIG5vdCBzZWxlY3RlZCBzbGlkZXNcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjZWxsLmVsZW1lbnQudGFiSW5kZXggPSAnLTEnO1xuICAgICAgICAgICAgICAgIGFuY2hvci50YWJJbmRleCA9ICctMSc7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IEhlYWRlciBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1iYW5uZXInKSkge1xuICAgIEJzQmFubmVyVG9wby5pbml0KCk7XG4gIH1cbn0pO1xuIiwidmFyIEJzQm94RHJvcGRvd24gPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgYm94OiBudWxsLFxuICAgIGJveENvbnRlbnQ6IG51bGwsXG4gICAgdG9nZ2xlQnV0dG9uOiBudWxsLFxuICAgIGludGVydmFsOiBudWxsLFxuICAgIGFjdGl2ZUNsYXNzOiAnYnMtYm94LS1pcy1leHBhbmRlZCcsXG4gICAgaXNWaWV3cG9ydDogZnVuY3Rpb24gKGJwKSB7XG4gICAgICB2YXIgYnBzID0geyB4czogNzY4LCBzbTogOTkyLCBtZDogMTIwMCB9O1xuICAgICAgcmV0dXJuICFicCB8fCAhYnBzW2JwXSB8fCB3aW5kb3cuaW5uZXJXaWR0aCA8IGJwc1ticF07XG4gICAgfSxcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uIChib3gpIHtcbiAgICBpZiAoIWJveCkgcmV0dXJuO1xuXG4gICAgY29uZmlnLmJveCA9IGJveDtcbiAgICBjb25maWcuYm94Q29udGVudCA9IGJveC5xdWVyeVNlbGVjdG9yKCcuYnMtYm94X19jb250ZW50Jyk7XG4gICAgY29uZmlnLnRvZ2dsZUJ1dHRvbiA9IGJveC5xdWVyeVNlbGVjdG9yKCcuYnMtYm94X19tZW51Jyk7XG5cbiAgICBpZiAoIWNvbmZpZy50b2dnbGVCdXR0b24pIHtcbiAgICAgIGNvbmZpZy50b2dnbGVCdXR0b24gPSBidWlsZE1lbnVMYWJlbChib3gpO1xuICAgIH1cblxuICAgIGNvbmZpZy50b2dnbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVCb3hDb250ZW50KTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgcmVzaXplVGltZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXNpemVNZW51Qm94KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIENsb3NlIG1vZGFsIG9uIGNsaWNrIG91dHNpZGVcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2JvZHksIGh0bWwnKSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpZiAoaXNFeHBhbmRlZCgpICYmICFjb25maWcuYm94LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICB0b2dnbGVCb3hDb250ZW50KCk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgaXNFeHBhbmRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY29uZmlnLmJveC5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmFjdGl2ZUNsYXNzKTtcbiAgfTtcblxuICB2YXIgdG9nZ2xlQm94Q29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYm94Q29udGVudEhlaWdodCA9IGNvbmZpZy5ib3hDb250ZW50LnNjcm9sbEhlaWdodDtcblxuICAgIGlmICghaXNFeHBhbmRlZCgpKSB7XG4gICAgICBjb25maWcuYm94LmNsYXNzTGlzdC5hZGQoY29uZmlnLmFjdGl2ZUNsYXNzKTtcbiAgICAgIGNvbmZpZy5ib3hDb250ZW50LnN0eWxlLmhlaWdodCA9IGJveENvbnRlbnRIZWlnaHQgKyAncHgnO1xuICAgICAgY29uZmlnLnRvZ2dsZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25maWcuYm94LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmFjdGl2ZUNsYXNzKTtcbiAgICAgIGNvbmZpZy5ib3hDb250ZW50LnN0eWxlLmhlaWdodCA9ICcnO1xuICAgICAgY29uZmlnLnRvZ2dsZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGJ1aWxkTWVudUxhYmVsID0gZnVuY3Rpb24gKHBhcmVudCkge1xuICAgIHZhciBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICB2YXIgYm94VGl0bGUgPSBjb25maWcuYm94LnF1ZXJ5U2VsZWN0b3IoJy5icy1ib3hfX3RpdGxlJyk7XG4gICAgdmFyIHRpdGxlID0gYm94VGl0bGUgPyBib3hUaXRsZS50ZXh0Q29udGVudCA6ICdNZW51JztcblxuICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdicy1ib3hfX21lbnUnKTtcbiAgICBidXR0b24uaW5uZXJIVE1MID0gdGl0bGU7XG4gICAgYnV0dG9uLnR5cGUgPSAnYnV0dG9uJztcbiAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWhhc3BvcHVwJywgJ3RydWUnKTtcbiAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG5cbiAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGJ1dHRvbiwgcGFyZW50LmZpcnN0Q2hpbGQpO1xuICAgIHJldHVybiBidXR0b247XG4gIH07XG5cbiAgLy8gZGVib3VuY2Ugc2V0VGltZSBvZmZzZXQgZWxlbSBhbmQgc2hvdWxkIHJlbW92ZSBlbGVtZW50cyBhY3RpdmVzIHdoZW4gcmVzaXplXG4gIHZhciByZXNpemVNZW51Qm94ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBib3hDb250ZW50SGVpZ2h0ID0gY29uZmlnLmJveENvbnRlbnQub2Zmc2V0SGVpZ2h0O1xuICAgIHZhciBib3hDb250ZW50Q2hpbGQgPSBjb25maWcuYm94Q29udGVudC5jaGlsZHJlblswXTtcbiAgICB2YXIgYm94Q29udGVudENoaWxkSGVpZ2h0ID0gYm94Q29udGVudENoaWxkID8gYm94Q29udGVudENoaWxkLm9mZnNldEhlaWdodCA6IDA7XG4gICAgdmFyIGJveEhlaWdodCA9IChcbiAgICAgIGNvbmZpZy5ib3hDb250ZW50LmNoaWxkcmVuLmxlbmd0aCA+IDEpXG4gICAgICA/IGJveENvbnRlbnRIZWlnaHRcbiAgICAgIDogYm94Q29udGVudENoaWxkSGVpZ2h0O1xuICAgIHZhciBicmVha3BvaW50ID0gY29uZmlnLmJveC5kYXRhc2V0LmRyb3Bkb3duQnA7XG5cbiAgICBpZiAoIWNvbmZpZy5pc1ZpZXdwb3J0KGJyZWFrcG9pbnQpKSB7XG4gICAgICBjb25maWcuYm94Q29udGVudC5zdHlsZS5oZWlnaHQgPSAnJztcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoaXNFeHBhbmRlZCgpKSB7XG4gICAgICBjb25maWcuYm94Q29udGVudC5zdHlsZS5oZWlnaHQgPSBib3hIZWlnaHQgKyAncHgnO1xuICAgIH1cbiAgfTtcblxuICB2YXIgcmVzaXplVGltZXIgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICBjbGVhclRpbWVvdXQoY29uZmlnLmludGVydmFsKTtcbiAgICBjb25maWcuaW50ZXJ2YWwgPSBzZXRUaW1lb3V0KGNhbGxiYWNrLCAzMDApO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn07XG5cbi8qKlxuKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciBkcm9wZG93bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtYm94LS1kcm9wZG93bicpO1xuICBpZiAoZHJvcGRvd25zLmxlbmd0aCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZHJvcGRvd25zLCBmdW5jdGlvbiAoZHJvcGRvd24pIHtcbiAgICAgIHZhciBkcm9wZG93bkJveCA9IG5ldyBCc0JveERyb3Bkb3duKCk7XG4gICAgICBkcm9wZG93bkJveC5pbml0KGRyb3Bkb3duKTtcbiAgICB9KTtcbiAgfVxufSk7XG4iLCJ2YXIgQnNCb3hNZW51ID0gKGZ1bmN0aW9uICgpIHtcblxuICB2YXIgY29uZmlnID0ge1xuICAgIG1lbnVCdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1ib3gtLW1lbnUnKSxcbiAgICBtZW51QnV0dG9uQ2xhc3M6ICdicy1ib3hfX21lbnUnLFxuICAgIGFjdGl2ZUNvbnRlbnRDbGFzczogJ2JzLWJveF9fY29udGVudC0tYWN0aXZlJyxcbiAgICBhY3RpdmVNZW51Q2xhc3M6ICdicy1ib3hfX21lbnUtLWFjdGl2ZScsXG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAvLyB2YXIgcmVzaXplTWVudSA9IGRlYm91bmNlKHRvZG8sIDUwMCk7XG4gICAgLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHJlc2l6ZU1lbnUpO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcubWVudUJ1dHRvbiwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICB2YXIgYm94TGlua3MgPSBlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1ib3hfX2NvbnRlbnQnKTtcbiAgICAgIHZhciBib3hMaW5rc0xpc3QgPSBib3hMaW5rcy5xdWVyeVNlbGVjdG9yKCcuYnMtYm94X19saXN0Jykub2Zmc2V0SGVpZ2h0O1xuXG4gICAgICAvLyBkZWJvdW5jZSBzZXRUaW1lIG9mZnNldCBlbGVtIGFuZCBzaG91bGQgcmVtb3ZlIGVsZW1lbnRzIGFjdGl2ZXMgd2hlbiByZXNpemVcbiAgICAgIHZhciByZXNpemVNZW51Qm94ID0gZGVib3VuY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICBib3hMaW5rc0xpc3QgPSBib3hMaW5rcy5xdWVyeVNlbGVjdG9yKCcuYnMtYm94X19saXN0Jykub2Zmc2V0SGVpZ2h0O1xuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5hY3RpdmVNZW51Q2xhc3MpO1xuICAgICAgICBib3hMaW5rcy5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5hY3RpdmVDb250ZW50Q2xhc3MpO1xuICAgICAgICBib3hMaW5rcy5zdHlsZSA9ICcnO1xuICAgICAgICAvLyBtZW51IGJ1dHRvbiBhY3RpdmUgYnkgYnJlYWtwb2ludFxuICAgICAgICBtZW51Qm94QWN0aXZhdGVkKGVsKTtcbiAgICAgIH0pO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHJlc2l6ZU1lbnVCb3gpO1xuICAgICAgXG4gICAgICAvLyBtZW51IGJ1dHRvbiBhY3RpdmUgYnkgYnJlYWtwb2ludFxuICAgICAgbWVudUJveEFjdGl2YXRlZChlbCk7XG5cbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHZhciBjb250ZW50VG9nZ2xlID0gYm94TGlua3MuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5hY3RpdmVDb250ZW50Q2xhc3MpO1xuXG4gICAgICAgIGlmICghY29udGVudFRvZ2dsZSkge1xuICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmFjdGl2ZU1lbnVDbGFzcyk7XG4gICAgICAgICAgYm94TGlua3MuY2xhc3NMaXN0LmFkZChjb25maWcuYWN0aXZlQ29udGVudENsYXNzKTtcbiAgICAgICAgICBib3hMaW5rcy5zdHlsZS5oZWlnaHQgPSBib3hMaW5rc0xpc3QgKyAncHgnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmFjdGl2ZU1lbnVDbGFzcyk7XG4gICAgICAgICAgYm94TGlua3MuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuYWN0aXZlQ29udGVudENsYXNzKTtcbiAgICAgICAgICBib3hMaW5rcy5zdHlsZS5oZWlnaHQgPSAnMCc7XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuXG4gIHZhciBtZW51Qm94QWN0aXZhdGVkID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgdmFyIHdpdGRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgaWYgKHdpdGRoID4gNzY4KSB7XG4gICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5tZW51QnV0dG9uQ2xhc3MpO1xuICAgICAgZWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9IGVsc2Uge1xuICAgICAgZWwuY2xhc3NMaXN0LmFkZChjb25maWcubWVudUJ1dHRvbkNsYXNzKTtcbiAgICAgIGVsLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4qIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4qL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWJveC0tbWVudScpLmxlbmd0aCkge1xuICAgIEJzQm94TWVudS5pbml0KCk7XG4gIH1cbn0pO1xuIiwidmFyIEJzQm94TGlzdFJlZiA9IChmdW5jdGlvbiAoKSB7XG5cbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBhY2NvcmRpb25CdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1vcGVuLWFjY29yZGlvbicpLFxuICAgIGFjY29yZGlvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWJveGxpc3QtZm9uZS1yZWZhY3RvcmVkJyksXG4gICAgYWNjb3JkaW9uQ29udGVudDogJy5icy1qcy1hY2NvcmRpb24tY29udGVudC1yZWYnLFxuICAgIGJvZHk6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKSxcbiAgICBkaXNhYmxlZE9uRGVza3RvcDogJ2JzLWpzLWFjY29yZGlvbi1kaXNhYmxlZC1kZXNrdG9wJ1xuICB9XG5cbiAgdmFyIG1vZENsYXNzID0ge1xuICAgIGFjY29yZGlvbk9wZW5DbGFzczogJ2JzLWJveGxpc3QtZm9uZS1yZWZhY3RvcmVkX19pdGVtLS1vcGVuJ1xuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy8gQ2hlY2sgaWYgYWNjb3JkaW9uIHNob3VkIGJlIGRpc2FibGVkIG9uIGRlc2t0b3BcbiAgICBkaXNhYmxlQWNjb3JkaW9uT25EZXNrdG9wKCk7XG5cbiAgICAvLyBUb2dnbGUgYWNjb3JkaW9uIGl0ZW0gb24gY2xpY2tcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbmZpZy5hY2NvcmRpb25CdXR0b24ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIGNvbmZpZy5hY2NvcmRpb25CdXR0b25baV0uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgJ2NsaWNrJyxcbiAgICAgICAgdG9nZ2xlQWNjb3JkaW9uSXRlbS5iaW5kKG51bGwsIGNvbmZpZy5hY2NvcmRpb25CdXR0b25baV0pXG4gICAgICApO1xuICAgIH1cblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB1cGRhdGVDb250ZW50SGVpZ2h0KCk7XG4gICAgICBkaXNhYmxlQWNjb3JkaW9uT25EZXNrdG9wKCk7XG4gICAgfSk7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5hY2NvcmRpb24sIGZ1bmN0aW9uIChlbCkge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUFjY29yZGlvbktleWJvYXJkKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgdG9nZ2xlQWNjb3JkaW9uSXRlbSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgaWYgKGlzQWNjb3JkaW9uT3BlbihlbGVtZW50KSkgY2xvc2VBY2NvcmRpb25JdGVtKGVsZW1lbnQpO1xuICAgIGVsc2Ugb3BlbkFjY29yZGlvbkl0ZW0oZWxlbWVudCk7XG4gIH07XG5cbiAgdmFyIGlzQWNjb3JkaW9uT3BlbiA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgdmFyIGl0ZW0gPSBnZXRQYXJlbnQoZWxlbWVudCwgJ2JzLWJveGxpc3QtZm9uZS1yZWZhY3RvcmVkX19pdGVtJyk7XG4gICAgcmV0dXJuIGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKG1vZENsYXNzLmFjY29yZGlvbk9wZW5DbGFzcyk7XG4gIH07XG5cbiAgdmFyIG9wZW5BY2NvcmRpb25JdGVtID0gZnVuY3Rpb24gKG9wZW5FbGVtZW50KSB7XG4gICAgdmFyIGl0ZW0gPSBnZXRQYXJlbnQob3BlbkVsZW1lbnQsICdicy1ib3hsaXN0LWZvbmUtcmVmYWN0b3JlZF9faXRlbScpO1xuICAgIHZhciBjb250ZW50ID0gaXRlbS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5hY2NvcmRpb25Db250ZW50KTtcbiAgICB2YXIgY29udGVudEhlaWdodCA9IGNvbnRlbnQuc2Nyb2xsSGVpZ2h0O1xuXG4gICAgb3BlbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcbiAgICBjb250ZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAnZmFsc2UnKTtcblxuICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChtb2RDbGFzcy5hY2NvcmRpb25PcGVuQ2xhc3MpO1xuICAgIGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gY29udGVudEhlaWdodCArICdweCc7XG4gIH07XG5cbiAgdmFyIGNsb3NlQWNjb3JkaW9uSXRlbSA9IGZ1bmN0aW9uIChjbG9zZUVsZW1lbnQpIHtcbiAgICB2YXIgaXRlbSA9IGdldFBhcmVudChjbG9zZUVsZW1lbnQsICdicy1ib3hsaXN0LWZvbmUtcmVmYWN0b3JlZF9faXRlbScpO1xuICAgIHZhciBjb250ZW50ID0gaXRlbS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5hY2NvcmRpb25Db250ZW50KTtcbiAgICB2YXIgY29udGVudEhlaWdodCA9IGNvbnRlbnQuc2Nyb2xsSGVpZ2h0O1xuXG4gICAgY2xvc2VFbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgIGNvbnRlbnQuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7XG5cbiAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUobW9kQ2xhc3MuYWNjb3JkaW9uT3BlbkNsYXNzKTtcbiAgICBjb250ZW50LnN0eWxlLmhlaWdodCA9IDA7XG5cbiAgICBmaXhFbGVtZW50U2Nyb2xsKGl0ZW0pO1xuICB9O1xuXG4gIC8vIFVwZGF0ZXMgY29udGVudCBoZWlnaHQgb24gd2luZG93IHJlc2l6ZVxuICB2YXIgdXBkYXRlQ29udGVudEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtYm94bGlzdC1mb25lLXJlZmFjdG9yZWRfX2l0ZW0nKTtcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaXRlbXMsIGZ1bmN0aW9uIChlbGVtZW50LCBpKSB7XG4gICAgICB2YXIgY29udGVudCA9IGVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuYWNjb3JkaW9uQ29udGVudCk7XG4gICAgICB2YXIgY29udGVudEhlaWdodCA9IGNvbnRlbnQucXVlcnlTZWxlY3RvcignLmJzLWJveGxpc3QtZm9uZS1yZWZhY3RvcmVkX19ib3gnKS5zY3JvbGxIZWlnaHQgKyAncHgnO1xuICAgICAgdmFyIGFjY29yZGlvbiA9IGdldFBhcmVudHMoZWxlbWVudCwgY29uZmlnLmRpc2FibGVkT25EZXNrdG9wKVswXTtcblxuICAgICAgLy8gSWYgdGhlIC5icy1qcy1hY2NvcmRpb24tY29udGVudCBoZWlnaHQgaXMgZGlmZmVyZW50IGZyb20gaXRzIGNvbnRlbnQsIHVwZGF0ZXMgaXRzIGhlaWdodFxuICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKG1vZENsYXNzLmFjY29yZGlvbk9wZW5DbGFzcykgJiYgcGFyc2VJbnQoY29udGVudC5zdHlsZS5oZWlnaHQpICE9IGNvbnRlbnRIZWlnaHQpIHtcbiAgICAgICAgY29udGVudC5zdHlsZS5oZWlnaHQgPSBjb250ZW50SGVpZ2h0O1xuICAgICAgfVxuXG5cbiAgICAgIC8vIElmIGFjY29yZGlvbiBpcyBzZXQgdG8gYmUgZGlzYWJsZWQgb24gZGVza3RvcCwgdXBkYXRlIGl0ZW1zIGhlaWdodFxuICAgICAgaWYgKGFjY29yZGlvbikge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKG1vZENsYXNzLmFjY29yZGlvbk9wZW5DbGFzcykgJiYgcGFyc2VJbnQoY29udGVudC5zdHlsZS5oZWlnaHQpICE9IGNvbnRlbnRIZWlnaHQpIHx8XG4gICAgICAgICAgKCFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhtb2RDbGFzcy5hY2NvcmRpb25PcGVuQ2xhc3MpICYmIHdpbmRvdy5pbm5lcldpZHRoID49IDEyMDApXG4gICAgICAgICkge1xuICAgICAgICAgIGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gY29udGVudEhlaWdodDtcbiAgICAgICAgfSBlbHNlIGlmICghZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMobW9kQ2xhc3MuYWNjb3JkaW9uT3BlbkNsYXNzKSAmJiB3aW5kb3cuaW5uZXJXaWR0aCA8IDEyMDApIHtcbiAgICAgICAgICBjb250ZW50LnN0eWxlLmhlaWdodCA9IDA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8vIENoZWNrcyBpZiB0aGUgYWNjb3JkaW9uIHNob3VsZCBiZSBkaXNhYmxlZCBvbiBkZXNrdG9wXG4gIC8vIGFuZCB0aGVuIGRpc2FibGUgaXRzIGJ1dHRvbnNcbiAgdmFyIGRpc2FibGVBY2NvcmRpb25PbkRlc2t0b3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuYWNjb3JkaW9uLCBmdW5jdGlvbiAoZWxlbWVudCwgaSkge1xuICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5kaXNhYmxlZE9uRGVza3RvcCkpIHRvZ2dsZUJ1dHRvbnMoZWxlbWVudCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBEaXNhYmxlIHRoZSBhY2NvcmRpb24gYnV0dG9uc1xuICB2YXIgdG9nZ2xlQnV0dG9ucyA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgdmFyIGl0ZW1zID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtb3Blbi1hY2NvcmRpb24nKTtcblxuICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSAxMjAwKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGl0ZW1zLCBmdW5jdGlvbiAoZWwsIGkpIHtcbiAgICAgICAgZWwuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaXRlbXMsIGZ1bmN0aW9uIChlbCwgaSkge1xuICAgICAgICBlbC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gRml4IHNjcm9sbCBvZiBhbiBlbGVtZW50IHdoZW4gdGFiYmluZyBmb2N1c1xuICAvLyBvbiBhbiBlbGVtZW50IGluc2lkZSBhIGRpdiB3aG8gd2lsbCBiZSBoaWRkZW5cbiAgLy8gYWZ0ZXIgYSB0cmFuc2l0aW9uXG4gIHZhciBmaXhFbGVtZW50U2Nyb2xsID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBlbC5zY3JvbGxUbygwLCAwKTtcbiAgICB9LCAzMDApO1xuICB9O1xuXG4gIHZhciBoYW5kbGVBY2NvcmRpb25LZXlib2FyZCA9IGZ1bmN0aW9uIChldikge1xuICAgIHZhciBhY2NvcmRpb24gPSBldi5jdXJyZW50VGFyZ2V0O1xuICAgIHZhciBjdXJyZW50RWwgPSBldi50YXJnZXQ7XG4gICAgdmFyIGtleSA9IGV2LmtleTtcbiAgICB2YXIgYnV0dG9uc05vZGUgPSBhY2NvcmRpb24ucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLW9wZW4tYWNjb3JkaW9uJyk7XG4gICAgdmFyIGJ1dHRvbnMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChidXR0b25zTm9kZSk7XG4gICAgdmFyIGN1cnJlbnRCdXR0b24gPSAoXG4gICAgICAgIGN1cnJlbnRFbC5jbGFzc0xpc3QuY29udGFpbnMoJ2JzLWpzLW9wZW4tYWNjb3JkaW9uJykpID9cbiAgICAgIGN1cnJlbnRFbCA6IGN1cnJlbnRFbC5jbG9zZXN0KCcuYnMtanMtb3Blbi1hY2NvcmRpb24nKTtcbiAgICB2YXIgZmlyc3RCdXR0b24gPSBidXR0b25zWzBdO1xuICAgIHZhciBsYXN0QnV0dG9uID0gYnV0dG9uc1tidXR0b25zLmxlbmd0aCAtIDFdO1xuICAgIHZhciBwcmV2QnV0dG9uID0gYnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pID9cbiAgICAgIGJ1dHRvbnNbYnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pIC0gMV0gOlxuICAgICAgbGFzdEJ1dHRvbjtcbiAgICB2YXIgbmV4dEJ1dHRvbiA9IGJ1dHRvbnMuaW5kZXhPZihjdXJyZW50QnV0dG9uKSA8IGJ1dHRvbnMubGVuZ3RoIC0gMSA/XG4gICAgICBidXR0b25zW2J1dHRvbnMuaW5kZXhPZihjdXJyZW50QnV0dG9uKSArIDFdIDpcbiAgICAgIGZpcnN0QnV0dG9uO1xuXG4gICAgaWYgKGN1cnJlbnRCdXR0b24pIHtcbiAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgIGNhc2UgXCJSaWdodFwiOiAvLyBJRS9FZGdlIHNwZWNpZmljIHZhbHVlXG4gICAgICAgIGNhc2UgXCJBcnJvd1JpZ2h0XCI6XG4gICAgICAgICAgb3BlbkFjY29yZGlvbkl0ZW0oY3VycmVudEJ1dHRvbik7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJMZWZ0XCI6IC8vIElFL0VkZ2Ugc3BlY2lmaWMgdmFsdWVcbiAgICAgICAgY2FzZSBcIkFycm93TGVmdFwiOlxuICAgICAgICAgIGNsb3NlQWNjb3JkaW9uSXRlbShjdXJyZW50QnV0dG9uKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIkRvd25cIjogLy8gSUUvRWRnZSBzcGVjaWZpYyB2YWx1ZVxuICAgICAgICBjYXNlIFwiQXJyb3dEb3duXCI6XG4gICAgICAgICAgbmV4dEJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiVXBcIjogLy8gSUUvRWRnZSBzcGVjaWZpYyB2YWx1ZVxuICAgICAgICBjYXNlIFwiQXJyb3dVcFwiOlxuICAgICAgICAgIHByZXZCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnSG9tZSc6XG4gICAgICAgICAgZmlyc3RCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRW5kJzpcbiAgICAgICAgICBsYXN0QnV0dG9uLmZvY3VzKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBNb2RhbCBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1ib3hsaXN0LWZvbmUtcmVmYWN0b3JlZCcpLmxlbmd0aCkge1xuICAgIEJzQm94TGlzdFJlZi5pbml0KCk7XG4gIH1cbn0pO1xuIiwidmFyIEJzQm94TGlzdFJlZmFjdG9yZWQgPSAoZnVuY3Rpb24gKCkge1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgbGV0ICRnZW5lcmFsQm94Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWJveC1yZWZhY3RvcmVkJyk7XG4gICAgbGV0ICRidXR0b25Cb3hMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWJveC1yZWZhY3RvcmVkIC5icy1ib3hfX21lbnUnKTtcblxuICAgICRidXR0b25Cb3hMaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAkZ2VuZXJhbEJveENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdvcGVuJyk7XG5cbiAgICAgIGlmKCRnZW5lcmFsQm94Q29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucyhcIm9wZW5cIikpe1xuICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImFyaWEtZXhwYW5kZWRcIiwgXCJ0cnVlXCIpO1xuICAgICAgfWVsc2Uge1xuICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImFyaWEtZXhwYW5kZWRcIiwgXCJmYWxzZVwiKTtcbiAgICAgIH1cblxuICAgIH0pXG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0XG4gIH07XG59KCkpO1xuXG4vKipcbiogQHJldHVybiB7dm9pZH0gQnNCb3hMaXN0UmVmYWN0b3JlZC5pbml0KCk7XG4qL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWJveC1yZWZhY3RvcmVkJykubGVuZ3RoKSB7XG4gICAgQnNCb3hMaXN0UmVmYWN0b3JlZC5pbml0KCk7XG4gIH1cbn0pO1xuIiwiZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIG1haW5DYXJkRmxpcFJlYWR5KTtcblxuLyoqXG4gKiBbbWFpbkNhcmRGbGlwUmVhZHkgZGVzY3JpcHRpb25dXG4gKiBAcmV0dXJuIHt2b2lkfSBNYWluQ2FyZC5pbml0KClcbiAqL1xuZnVuY3Rpb24gbWFpbkNhcmRGbGlwUmVhZHkoKSB7XG4gIHZhciBtYWluQ2FyZCA9IG5ldyBCc0NhcmRGbGlwKCk7XG4gIG1haW5DYXJkLmluaXQoKTtcbn1cblxuLyoqXG4gKiBCc0NhcmRGbGlwXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuZnVuY3Rpb24gQnNDYXJkRmxpcCgpIHtcbiAgdGhpcy5jYXJkU2VydmljZXNUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWJzLWNhcmQtc2VydmljZXNfX3RleHQnKTtcbn1cblxuQnNDYXJkRmxpcC5wcm90b3R5cGUgPSB7XG4gIGNvbnN0cnVjdG9yOiBCc0NhcmRGbGlwLFxuICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGk7XG4gICAgdmFyIF8gPSB0aGlzO1xuICAgIHZhciBpdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmpzLWJzLW9wZW4tZmxpcC1jYXJkJyk7XG4gICAgLy8gdmFyIGNhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtZmxpcC1jYXJkJyk7XG4gICAgdmFyIGNsb3NlRmxpcENhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuanMtYnMtY2xvc2UtZmxpcC1jYXJkJyk7XG4gICAgdmFyIGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG5cbiAgICBpZiAod2luZG93LmlubmVyV2lkdGggPCA3NjgpIGJvZHkuY2xhc3NMaXN0LmFkZCgnYnMtaXMtbW9iaWxlJyk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8IDc2OCkgYm9keS5jbGFzc0xpc3QuYWRkKCdicy1pcy1tb2JpbGUnKTtcbiAgICAgIGVsc2UgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdicy1pcy1tb2JpbGUnKTtcbiAgICB9KTtcblxuICAgIGlmIChpdGVtKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgaXRlbS5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBpdGVtW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF8uX29wZW5GbGlwQ2FyZCh0aGlzKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBjbG9zZUZsaXBDYXJkLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNsb3NlRmxpcENhcmRbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgdmFyIF8gPSB0aGlzO1xuICAgICAgICAgIHRoaXMucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdicy1mbGlwLWNhcmQtLWlzLW9wZW4nKTtcbiAgICAgICAgICB0aGlzLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYnMtZmxpcC1jYXJkLS1pcy1yZW1vdmVkJyk7XG4gICAgICAgICAgdGhpcy5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnYnMtY2FyZC1zZXJ2aWNlc19faXRlbS0tbm8taG92ZXInKTtcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF8ucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdicy1mbGlwLWNhcmQtLWlzLXJlbW92ZWQnKTtcbiAgICAgICAgICAgIF8ucGFyZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdicy1mbGlwLWNhcmQtLWlzLWZpeGVkJyk7XG4gICAgICAgICAgfSwgMzAwKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIF9vcGVuRmxpcENhcmQ6IGZ1bmN0aW9uIChlbCkge1xuICAgIGVsLm5leHRFbGVtZW50U2libGluZy5jbGFzc0xpc3QuYWRkKCdicy1mbGlwLWNhcmQtLWlzLWZpeGVkJyk7XG4gICAgZWwubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC5hZGQoJ2JzLWZsaXAtY2FyZC0taXMtb3BlbicpO1xuICAgIGVsLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYnMtY2FyZC1zZXJ2aWNlc19faXRlbS0tbm8taG92ZXInKTtcbiAgfSxcbn07XG4iLCIiLCIvKipcbiAqIENvbXBhcmUgU2VsZWN0b3JcbiAqIEByZXR1cm4gTW9kdWxlIGNvbmZpZ1xuICovXG52YXIgQnNDb21wYXJlU2VsZWN0b3IgPSAoZnVuY3Rpb24gKCkge1xuICAvKipcbiAgICogSW5pdCBmdW5jdGlvblxuICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gTW9kdWxlJ3Mgc2NvcGUgZnVuY3Rpb25zXG4gICAqL1xuXG4gICB2YXIgY29uZmlnID0ge1xuICAgIGNoZWNrYm94SXRlbXMgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtY29tcGFyZV9fc2VsZWN0LWNhcmRzJyksXG4gICAgbGlzdEl0ZW0gOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtY29tcGFyZV9fc2VsZWN0LWNhcmQnKSxcbiAgICByZXN1bHRMaXN0SXRlbSA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1jb21wYXJlX19yZXN1bHQgLmJzLW1lZGlhX19pdGVtJyksXG4gICAgYnV0dG9uQ29tcGFyZSA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1jb21wYXJlJyksXG4gICAgYnV0dG9uTmV3Q29tcGFyZSA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1uZXctY29tcGFyZScpLFxuICAgIGNvbXBhcmVSZXN1bHQgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtY29tcGFyZV9fcmVzdWx0JyksXG4gICAgY29tcGFyZUxpc3QgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtY29tcGFyZV9fd3JhcHBlcicpLFxuICAgIGJ1dHRvbkl0ZW0gOiAnJyxcbiAgICBjaGVjayA6ICcnLFxuICAgIGNvdW50ZXIgOiAwLFxuICAgIGxpbWl0IDogMyxcbiAgICBtaW5TaXplTGltaXQgOiAyLFxuICAgfTtcblxuICAgdmFyIHJlc3VsdHMgPSB7XG4gICAgYnV0dG9uQW5jaG9yIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLW5ldy1jb21wYXJlJyksXG4gICAgc21vb3RoU2Nyb2xsU3RlcHMgOiAyNSxcbiAgICBzY3JvbGxBbmNob3JHdXR0ZXIgOiAxMjAsXG4gICAgbmV3Q29tcGFyZVJlc3VsdCA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1jb21wYXJlX19zZWxlY3QtY2FyZHMnKSxcbiAgIH07XG5cbiAgIGlmIChjb25maWcuY2hlY2tib3hJdGVtcykge1xuICAgIHZhciBzZWxlY3RvciA9IHtcbiAgICAgIGNoZWNrSXRlbSA6IGNvbmZpZy5jaGVja2JveEl0ZW1zLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXScpLFxuICAgICB9O1xuICAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHNlbGVjdG9yLmNoZWNrSXRlbSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGNvbmZpZy5idXR0b25JdGVtID0gZTtcbiAgICAgIGNvbmZpZy5idXR0b25JdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgIGNvbmZpZy5jaGVjayA9IGVsLnRhcmdldDtcbiAgICAgICAgbmV3Q2hlY2tlcihjb25maWcuY2hlY2spO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICByZXN1bHRzLmJ1dHRvbkFuY2hvci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgc2Nyb2xsID0gbmV3IFNtb290aFNjcm9sbCgpO1xuXG4gICAgICBpZiAoY29uZmlnLmNvbXBhcmVMaXN0KSB7XG4gICAgICAgIHNjcm9sbC5hbmltYXRlU2Nyb2xsKGNvbmZpZy5jb21wYXJlTGlzdCwgMCwge1xuICAgICAgICAgIHVwZGF0ZVVSTDogZmFsc2UsXG4gICAgICAgICAgaGVhZGVyOiAnLmJzLWhlYWRlcicsXG4gICAgICAgICAgb2Zmc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gMTAwO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gZGlzcGFyYSBhw6fDo28gZG8gY29tcGFyYXJcbiAgICBjb25maWcuYnV0dG9uQ29tcGFyZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGNvbmZpZy5jb21wYXJlUmVzdWx0LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXG4gICAgICB2YXIgZmlsdGVySXRlbXMgPSBPYmplY3QudmFsdWVzKHNlbGVjdG9yLmNoZWNrSXRlbSk7XG5cbiAgICAgIHZhciBmaWx0ZXJlZCA9IGZpbHRlckl0ZW1zLmZpbHRlcihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlLmNoZWNrZWQ7XG4gICAgICB9KTtcblxuICAgICAgdmFyIGNvbnRlbnRSZXN1bHQgPSBmaWx0ZXJlZC5tYXAoZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29tcGFyZScpO1xuICAgICAgfSk7XG5cbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLnJlc3VsdExpc3RJdGVtLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgdmFyIHNjcm9sbCA9IG5ldyBTbW9vdGhTY3JvbGwoKTtcbiAgICAgICAgdmFyIGl0ZW1Db21wYXJlZCA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1jb21wYXJlJyk7XG5cbiAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnYnMtY29tcGFyZV9fYWN0aXZlJyk7XG5cbiAgICAgICAgaWYgKGNvbnRlbnRSZXN1bHQuaW5jbHVkZXMoaXRlbUNvbXBhcmVkKSkge1xuICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ2JzLWNvbXBhcmVfX2FjdGl2ZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbmZpZy5jb21wYXJlUmVzdWx0KSB7XG4gICAgICAgICAgc2Nyb2xsLmFuaW1hdGVTY3JvbGwoY29uZmlnLmNvbXBhcmVSZXN1bHQsIDAsIHtcbiAgICAgICAgICAgIHVwZGF0ZVVSTDogZmFsc2UsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBuZXdDaGVja2VyID0gZnVuY3Rpb24gKGUpIHtcbiAgICBpZiAoZS5jaGVja2VkKSBjb25maWcuY291bnRlcisrO1xuICAgIGVsc2UgY29uZmlnLmNvdW50ZXItLTtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHNlbGVjdG9yLmNoZWNrSXRlbSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICBjb25maWcuYnV0dG9uSXRlbSA9IGVsO1xuICAgICAgaWYgKGNvbmZpZy5jb3VudGVyID09PSBjb25maWcubGltaXQpIHsgLy8tIDMgbGltaXQgZGVmYXVsdFxuICAgICAgICBpZiAoIWNvbmZpZy5idXR0b25JdGVtLmNoZWNrZWQpIHtcbiAgICAgICAgICBjb25maWcuYnV0dG9uSXRlbS5kaXNhYmxlZCA9IHRydWU7IC8vIGFuZCBkaXNhYmxlIHVuY2hlY2tlZCBjaGVja2JveGVzXG4gICAgICAgICAgY29uZmlnLmJ1dHRvbkNvbXBhcmUuY2xhc3NMaXN0LnJlbW92ZSgnYnMtYnV0dG9uLS1kaXNhYmxlZCcpO1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGNvbmZpZy5jb3VudGVyID09PSBjb25maWcubWluU2l6ZUxpbWl0KSB7XG4gICAgICAgICAgY29uZmlnLmJ1dHRvbkl0ZW0uZGlzYWJsZWQgPSBmYWxzZTsgLy8gZW5hYmxlIHVuY2hlY2tlZCBjaGVja2JveGVzXG4gICAgICAgICAgY29uZmlnLmJ1dHRvbkNvbXBhcmUuY2xhc3NMaXN0LnJlbW92ZSgnYnMtYnV0dG9uLS1kaXNhYmxlZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICghY29uZmlnLmJ1dHRvbkl0ZW0uY2hlY2tlZCkge1xuICAgICAgICAgICAgY29uZmlnLmJ1dHRvbkl0ZW0uZGlzYWJsZWQgPSBmYWxzZTsgLy8gZW5hYmxlIHVuY2hlY2tlZCBjaGVja2JveGVzXG4gICAgICAgICAgICBjb25maWcuYnV0dG9uQ29tcGFyZS5jbGFzc0xpc3QuYWRkKCdicy1idXR0b24tLWRpc2FibGVkJyk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IEhlYWRlciBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1jb21wYXJlX19zZWxlY3QtY2FyZHMnKSkge1xuICAgIEJzQ29tcGFyZVNlbGVjdG9yLmluaXQoKTtcbiAgfVxufSk7XG4iLCIvKipcbiAqIENvbnRleHQgTWVudVxuICogREVQUkVDQVRFRFxuICogUmVtb3ZlIGluIGZ1dHVyZVxuICovXG52YXIgQnNDb250ZXh0TWVudSA9IChmdW5jdGlvbiAoKSB7XG4gIC8vIENvbmZpZ1xuICB2YXIgY29uZmlnID0ge1xuICAgIGJ1dHRvbnM6IHtcbiAgICAgIHRyaWdnZXI6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy10cmlnZ2VyLWNvbnRleHQtbWVudScpLFxuICAgIH0sXG4gICAgY2xhc3Nlczoge1xuICAgICAgb3BlbjogJ2JzLWNvbnRleHQtbWVudS0tb3BlbicsXG4gICAgICBjb250ZXh0TWVudTogJ2JzLWNvbnRleHQtbWVudScsXG4gICAgfSxcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBBYnJlL2ZlY2hhIG8gQ29udGV4dCBNZW51XG4gICAgaWYgKGNvbmZpZy5idXR0b25zLnRyaWdnZXIpIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmJ1dHRvbnMudHJpZ2dlciwgZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgdG9nZ2xlQ29udGV4dE1lbnUoYnV0dG9uKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHRvZ2dsZUNvbnRleHRNZW51ID0gZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgIHZhciBpc09wZW4gPSBidXR0b24ucXVlcnlTZWxlY3RvcignLicgKyBjb25maWcuY2xhc3Nlcy5jb250ZXh0TWVudSkuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5jbGFzc2VzLm9wZW4pO1xuXG4gICAgaWYgKGlzT3BlbikgY2xvc2VDb250ZXh0TWVudShidXR0b24pO1xuICAgIGVsc2Ugb3BlbkNvbnRleHRNZW51KGJ1dHRvbik7XG4gIH07XG5cbiAgdmFyIG9wZW5Db250ZXh0TWVudSA9IGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICBjbG9zZUFsbENvbnRleHRNZW51KCk7XG4gICAgYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJy4nICsgY29uZmlnLmNsYXNzZXMuY29udGV4dE1lbnUpLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMub3Blbik7XG4gIH07XG5cbiAgdmFyIGNsb3NlQ29udGV4dE1lbnUgPSBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJy4nICsgY29uZmlnLmNsYXNzZXMuY29udGV4dE1lbnUpLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMub3Blbik7XG4gIH07XG5cbiAgdmFyIGNsb3NlQWxsQ29udGV4dE1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGNvbmZpZy5jbGFzc2VzLm9wZW4pLCBmdW5jdGlvbiAoY29udGV4dE1lbnUpIHtcbiAgICAgIGNvbnRleHRNZW51LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMub3Blbik7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gQ2xvc2UgbWVudSBvbiBjbGljayBvdXRzaWRlXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBjbG9zZUFsbENvbnRleHRNZW51KCk7XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICBjbG9zZUFsbENvbnRleHRNZW51OiBjbG9zZUFsbENvbnRleHRNZW51LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IEJzQ29udGV4dE1lbnUgY29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEJzQ29udGV4dE1lbnUuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWNvbnRleHQtbWVudScpLmxlbmd0aCkge1xuICAgIEJzQ29udGV4dE1lbnUuaW5pdCgpO1xuICB9XG59KTtcbiIsInZhciBCc0RhdGVQaWNrZXIgPSAoZnVuY3Rpb24gKCkge1xuXG4gIHZhciBjb25maWcgPSB7XG4gICAgc3RhcklucHV0RGVmYXVsdDogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbZGF0YS10eXBlPVwiZGF0ZXBpY2tlclwiXScpLFxuICAgIHN0YXJJbnB1dFJhbmdlOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFtkYXRhLXR5cGU9XCJkYXRlcGlja2VyLS1yYW5nZVwiXScpLFxuICAgIHNlbGVjdG9yOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtcGlja2VyX19pdGVtJyksXG4gICAgdWw6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1waWNrZXJMaXN0JyksXG4gICAgYnV0dG9uOiAnJyxcbiAgICBkYXRhSXRlbTogJycsXG4gICAgb2JqZWN0QXR0cmlidXRlOiAnJyxcbiAgICByZXNldFBpY2tlcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpZ2h0cGlja19fcmVzZXQtYWN0aW9uJyksXG4gICAgb3B0Rm9vdGVyOiAnJyxcbiAgICBsaWdodHBpY2s6ICcnLFxuICAgIHRvZ2dsZUNhbGVuZGFyOiAnJyxcbiAgfTtcblxuICB2YXIgc2V0ID0gZnVuY3Rpb24gKGVsKSB7XG5cbiAgICB2YXIgaXNSYW5nZSA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS10eXBlJykgPT09ICdkYXRlcGlja2VyLS1yYW5nZSc7XG5cbiAgICBpZiAoaXNSYW5nZSkgc2V0UGlja2VyUmFuZ2UoZWwpO1xuICAgIGVsc2Ugc2V0UGlja2VyKGVsKTtcbiAgfTtcblxuICB2YXIgc2V0UGlja2VyID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgdmFyIGVsUGFyZW50ID0gZWwucGFyZW50Tm9kZTtcbiAgICB2YXIgcGlja2VyID0gbnVsbDtcbiAgICB2YXIgZGF0ZVBlcmlvZCA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1kYXRlcGlja2VyLXBlcmlvZCcpIHx8ICcnO1xuICAgIHZhciBkYXRlTGltaXQgPSBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZGF0ZXBpY2tlci1saW1pdCcpIHx8ICcnO1xuXG4gICAgdmFyIHNldE1pbkRhdGVQZXJpb2QgPSBkYXRlUGVyaW9kID09PSAnc3RhcnRUb2RheScgPyBtb21lbnQoKS5lbmRPZignZGF5JykgOiBudWxsO1xuICAgIHZhciBzZXRNaW5EYXRlTGltaXQgPSBkYXRlTGltaXQgIT09ICcnID8gbW9tZW50KCkuc3VidHJhY3QoZGF0ZUxpbWl0LCAnZGF5JykgOiBudWxsO1xuXG4gICAgdmFyIHNldE1pbkRhdGUgPSBzZXRNaW5EYXRlUGVyaW9kICE9PSBudWxsICYmIHNldE1pbkRhdGVMaW1pdCA9PT0gbnVsbFxuICAgICAgPyBzZXRNaW5EYXRlUGVyaW9kIDogc2V0TWluRGF0ZUxpbWl0O1xuXG4gICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICBmaWVsZDogZWwsXG4gICAgICBwYXJlbnRFbDogZWxQYXJlbnQsXG4gICAgICBzdGFydERhdGU6IGVsLnZhbHVlIHx8IG51bGwsXG4gICAgICBsYW5nOiAncHQtQlInLFxuICAgICAgbWluRGF0ZTogc2V0TWluRGF0ZSxcbiAgICAgIG1heERhdGU6ICFkYXRlUGVyaW9kIHx8IGRhdGVQZXJpb2QgPT09ICdlbmRUb2RheScgPyBtb21lbnQoKS5lbmRPZignZGF5JykgOiBudWxsLFxuICAgIH07XG5cbiAgICBwaWNrZXIgPSBuZXcgTGlnaHRwaWNrKG9wdGlvbnMpO1xuXG4gICAgLy8gQ2xvc2UgcGlja2VyIG9uIGtleWRvd25cbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24gKCkge1xuICAgICAgcGlja2VyLmhpZGUoKTtcbiAgICB9KTtcblxuICAgIC8vIEZvY3VzXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBGaXggYnVnIElFMTEgdXNlIHNldFRpbWVvdXRcbiAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBzZWxlY3RvckRhdGUoKTtcbiAgICAgICAgZWwuZm9jdXMoKTtcbiAgICAgIH0sIDEwKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgc2V0UGlja2VyUmFuZ2UgPSBmdW5jdGlvbiAoZWwpIHtcbiAgICB2YXIgZWxQYXJlbnQgPSBlbC5wYXJlbnROb2RlO1xuXG4gICAgLy8gc3BsaXQgZGF0ZSByYW5nZSBpbnRvIGFuIGFycmF5XG4gICAgLy8gZGF0ZXMgcHJvdmlkZWQgbWFudWFsbHkgc2hvdWxkIGhhdmUgdGhlIGZvbGxvd2luZyBmb3JtYXQ6IFwiREQvTU0vWVlZWSAtIEREL01NL1lZWVlcIlxuICAgIHZhciBkYXRldmFsdWUgPSBlbC52YWx1ZS5zcGxpdChcIiAtIFwiKTtcbiAgICBcblxuICAgIHZhciBwaWNrZXIgPSBuZXcgTGlnaHRwaWNrKHtcbiAgICAgIGZpZWxkOiBlbCxcbiAgICAgIHBhcmVudEVsOiBlbFBhcmVudCxcbiAgICAgIHN0YXJ0RGF0ZTogZGF0ZXZhbHVlWzBdIHx8IG51bGwsXG4gICAgICBlbmREYXRlOiBkYXRldmFsdWVbMV0gfHwgbnVsbCxcbiAgICAgIHNlcGFyYXRvcjogKGVsLmRhdGFzZXQuc2VwYXJhdG9yKSB8fCAnIC0gJyxcbiAgICAgIGxhbmc6ICdwdC1CUicsXG4gICAgICBzaW5nbGVEYXRlOiBmYWxzZSxcbiAgICAgIG1heERhdGU6IG1vbWVudCgpLmVuZE9mKCdkYXknKSxcbiAgICAgIGZvb3RlcjogdHJ1ZSxcbiAgICAgIGxvY2FsZToge1xuICAgICAgICB0b29sdGlwOiB7XG4gICAgICAgICAgb25lOiAnRGlhJyxcbiAgICAgICAgICBvdGhlcjogJ0RpYXMnLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIG9uU2VsZWN0OiBmdW5jdGlvbiAoZGF0ZSkge1xuICAgICAgICB2YXIgc3RyID0gZGF0ZSA/IGRhdGUudG9TdHJpbmcoKSA6ICcnO1xuICAgICAgICBlbmFibGVDbGVhbkJ1dHRvbihzdHIpO1xuICAgICAgfSxcbiAgICB9KTtcbiAgICB2YXIgcmVzZXRQaWNrZXIgPSBwaWNrZXIuZWwucXVlcnlTZWxlY3RvcignLmxpZ2h0cGlja19fcmVzZXQtYWN0aW9uJyk7XG4gICAgdmFyIG9wdEZvb3RlciA9IHBpY2tlci5lbC5xdWVyeVNlbGVjdG9yKCcubGlnaHRwaWNrX19mb290ZXInKTtcbiAgICB2YXIgY29udHJvbCA9IGVsLmNsb3Nlc3QoJy5icy1mb3JtX19jb250cm9sJyk7XG4gICAgdmFyIHBpY2tlckxpc3QgPSBjb250cm9sLnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1waWNrZXJMaXN0Jyk7XG4gICAgdmFyIHBpY2tlckl0ZW1zID0gcGlja2VyTGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtcGlja2VyX19pdGVtJyk7XG4gICAgdmFyIHJhbmdlUGVyaW9kcyA9IFtcbiAgICAgIHsgYXR0cmlidXRlOiAndG9kYXknLCB2YWx1ZTogJycgfSxcbiAgICAgIHsgYXR0cmlidXRlOiAnbGFzdC13ZWVrJywgdmFsdWU6ICc3JyB9LFxuICAgICAgeyBhdHRyaWJ1dGU6ICdsYXN0LWZvcnRuaWdodCcsIHZhbHVlOiAnMTUnIH0sXG4gICAgICB7IGF0dHJpYnV0ZTogJ2xhc3QtbW9udGgnLCB2YWx1ZTogJzMwJyB9LFxuICAgICAgeyBhdHRyaWJ1dGU6ICdsYXN0LTNtb250aCcsIHZhbHVlOiAnOTAnIH0sXG4gICAgICB7IGF0dHJpYnV0ZTogJ2xhc3QtbW9yZScsIHZhbHVlOiAnOTAnIH0sXG4gICAgICB7IGF0dHJpYnV0ZTogJ2xhc3QtNm1vbnRoJywgdmFsdWU6ICcxODAnIH0sXG4gICAgXTtcbiAgICB2YXIgZW5hYmxlQ2xlYW5CdXR0b24gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmIHZhbHVlLmxlbmd0aCkge1xuICAgICAgICByZXNldFBpY2tlci5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNldFBpY2tlci5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG4gICAgICAgIHBpY2tlci5oaWRlKCk7XG4gICAgICAgIHBpY2tlci5zaG93KCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmIChvcHRGb290ZXIpIHtcbiAgICAgIC8vIEFwcGVuZCBGb290ZXIgKyBJRSAxMSBzdXBvcnRcbiAgICAgIG9wdEZvb3Rlci5pbnNlcnRCZWZvcmUocGlja2VyTGlzdCwgb3B0Rm9vdGVyLmZpcnN0Q2hpbGQpO1xuXG4gICAgICAvLyBDcmlhICBmdW7Dp8OjbyBwYXJhIGxpbXBhciBhcyBkYXRhcyBzZWxjaW9uYWRhc1xuICAgICAgcmVzZXRQaWNrZXIuaW5uZXJIVE1MID0gJ0xpbXBhcic7XG4gICAgICByZXNldFBpY2tlci5jbGFzc0xpc3QuYWRkKCdicy1waWNrZXJfX2l0ZW0nKTtcbiAgICAgIHJlc2V0UGlja2VyLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblxuICAgICAgLy8gRW5hYmxlIHJlc2V0UGlja2VyIGJ1dHRvbiBpZiBpbnB1dCBoYXMgdmFsdWVcbiAgICAgIGlmIChlbC52YWx1ZSAhPSAnJykge1xuICAgICAgICByZXNldFBpY2tlci5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy9pZiB2YWx1ZSBpcyBzZXQgbWFudWFsbHkgZW5hYmxlIENsZWFuQnV0dG9uXG4gICAgaWYgKGRhdGV2YWx1ZVswXSAhPSBcIlwiICYmIGRhdGV2YWx1ZVsxXSAhPSBcIlwiKSB7XG4gICAgICByZXNldFBpY2tlci5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgfVxuXG4gICAgLy8gRmlsdGVyIFNlbGVjdGlvbiBsYXN0IGRhdGVzXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChwaWNrZXJJdGVtcywgZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgIHZhciBidXR0b24gPSBlbGVtLnF1ZXJ5U2VsZWN0b3IoJ2EnKTtcblxuICAgICAgaWYgKCFidXR0b24pIHJldHVybjtcblxuICAgICAgdmFyIHNldFBlcmlvZExpc3RlbmVycyA9IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICAgICAgdmFyIGRhdGFJdGVtID0gZWxlbS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXBpY2tlcicpO1xuICAgICAgICB2YXIgZGF0YVBpY2tlclBlcmlvZCA9IGVsZW0udGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1waWNrZXItcGVyaW9kJyk7XG4gICAgICAgIHZhciBzZXRQaWNrZXJQZXJpb2QgPSBmdW5jdGlvbiAocGVyaW9kKSB7XG4gICAgICAgICAgdmFyIHN1YnRyYWN0RGF5cyA9IG1vbWVudCgpLnN1YnRyYWN0KHBlcmlvZCwgJ2RheScpO1xuICAgICAgICAgIHZhciBjdXJyZW50RGF5ID0gbW9tZW50KCkuZW5kT2YoJ2RheScpO1xuICAgICAgICAgIHBpY2tlci5zZXREYXRlUmFuZ2Uoc3VidHJhY3REYXlzLCBjdXJyZW50RGF5KTtcbiAgICAgICAgICBwaWNrZXIuaGlkZSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIElmIHBlcmlvZCBpcyBzZXQgbWFudWFsbHlcbiAgICAgICAgaWYgKGRhdGFQaWNrZXJQZXJpb2QpIHtcbiAgICAgICAgICBzZXRQaWNrZXJQZXJpb2QoZGF0YVBpY2tlclBlcmlvZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gR2V0IG9iamVjdHMgaW4gbGlzdCwgdG8gdXBkYXRlIGxhc3QgZGF5c1xuICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwocmFuZ2VQZXJpb2RzLCBmdW5jdGlvbiAocGVyaW9kKSB7XG4gICAgICAgICAgICBpZiAocGVyaW9kLmF0dHJpYnV0ZSA9PT0gZGF0YUl0ZW0pIHtcbiAgICAgICAgICAgICAgc2V0UGlja2VyUGVyaW9kKHBlcmlvZC52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgICAgICAgXG4gICAgICAvLyBwZXJtaXRlIHNlbGVjaW9uYXIgbyBkaWEsIG5vIGZpbHRyby8gbsOjbyDDqSBkZWZhdWx0IGRvIHBsdWdpblxuICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgc2V0UGVyaW9kTGlzdGVuZXJzKGVsZW0pO1xuICAgICAgfSk7XG4gICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICAgZWxlbS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgIGVsZW0ucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgIC8vc2V0VGltZW91dChmdW5jdGlvbigpIHsgLy8gcmVxdWlyZWQgYXMgYSB3b3JrIGFyb3VuZCBmb3IgdGhlIHRvdWNoZW5kIGV2ZW50LiBBdm9pZHMgY2xpY2sgb24gaXRlbnMgYmVoaW5kIHRoZSBjYWxlbmRhci4gXG4gICAgICAgICAgIHNldFBlcmlvZExpc3RlbmVycyhlbGVtKTtcbiAgICAgICAgIC8vfSwgMjAwKVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgICAgXG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAvLyBSYW5nZSArIEZpbHRlciBEYXRlXG4gICAgaWYgKGNvbmZpZy5zdGFySW5wdXRSYW5nZS5sZW5ndGggPiAwKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5zdGFySW5wdXRSYW5nZSwgZnVuY3Rpb24gKGVsKSB7XG5cbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2V0UGlja2VyUmFuZ2UoZWwpO1xuICAgICAgICB9LCAyMDApO1xuXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBTSU1QTEUgZGF0ZVxuICAgIGlmIChjb25maWcuc3RhcklucHV0RGVmYXVsdC5sZW5ndGggPiAwKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5zdGFySW5wdXREZWZhdWx0LCBmdW5jdGlvbiAoZWwpIHtcblxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBzZXRQaWNrZXIoZWwpO1xuICAgICAgICB9LCAyMDApO1xuXG4gICAgICB9KTtcbiAgICB9O1xuICAgIFxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgc2V0OiBzZXQsXG4gICAgc2V0UGlja2VyOiBzZXRQaWNrZXIsXG4gICAgc2V0UmFuZ2U6IHNldFBpY2tlclJhbmdlLFxuICAgIGluaXQ6IGluaXQsXG4gIH07XG59KCkpO1xuXG4vKipcbiogSW5pdCBNb2RhbCBDb25zdHJ1Y3RvclxuKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1saWdodHBpY2snKS5sZW5ndGgpIHtcbiAgICBCc0RhdGVQaWNrZXIuaW5pdCgpO1xuICB9XG59KTtcbiIsIi8vIEFiYWl4byBlc3TDoSBlc2NyaXRvIGEgaW50ZXJhdHZpZGFkZSByZWZlcmVudGUgw6AgZGlzY2FnZW0gVm9JUC5cblxuY29uc3QgdXBkYXRlID0gZnVuY3Rpb24gKHZhbHVlLCByZW1vdmUpIHtcbiAgY29uc3QgbnVtYmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3ZvaXAtZGlhbC1udW1iZXInKTtcbiAgaWYgKHJlbW92ZSkge1xuICAgIGxldCBhcnIgPSBudW1iZXIuaW5uZXJUZXh0LnNwbGl0KCcnKTtcbiAgICBsZXQgcXQgPSBhcnIubGVuZ3RoID4gMSA/IGFyci5sZW5ndGggLSAxIDogYXJyLmxlbmd0aDtcbiAgICBudW1iZXIuaW5uZXJUZXh0ID0gYXJyLnNwbGljZSgwLCBxdCkuam9pbignJyk7XG4gIH0gZWxzZSBudW1iZXIuaW5uZXJUZXh0ID0gbnVtYmVyLmlubmVyVGV4dCArIHZhbHVlO1xufVxuXG5jb25zdCBkaWFsZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGFkJyk7XG5cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vLyBBYmFpeG8gw6kgcGFyYSBjYXNvIHF1ZWlyYW0gdGVyIGEgb3DDp8OjbyBkZSBhcGFnYXIgbyBuw7ptZXJvIGRpc2NhZG8uXG5cbi8vIGNvbnN0IHJlbW92ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNudW1iZXInKTtcbi8vIHJlbW92ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbi8vICAgdXBkYXRlKCcnLCB0cnVlKTtcbi8vIH0pXG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZm9yIChsZXQgaSA9IDA7IGkgPCBkaWFsZXIubGVuZ3RoOyBpKyspIHtcbiAgY29uc29sZS5sb2coZGlhbGVyW2ldLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKS50ZXh0Q29udGVudClcbiAgZGlhbGVyW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgdXBkYXRlKHRoaXMucXVlcnlTZWxlY3Rvcignc3BhbicpLmlubmVyVGV4dCwgZmFsc2UpO1xuICB9KVxufVxuIiwiLyoqXG4gKiBEcm9wZG93biBtZW51XG4gKiBlLmcuOiBOb3RpZmljYXRpb24gYW5kIFN3aXRjaCBVc2VyIE1lbnVcbiAqL1xudmFyIEJzRHJvcGRvd25NZW51ID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gQ29uZmlnXG4gIHZhciBjb25maWcgPSB7XG4gICAgYnV0dG9uczoge1xuICAgICAgZHJvcGRvd25NZW51VHJpZ2dlcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXRvZ2dsZS1kcm9wZG93bi1tZW51JyksXG4gICAgICBtYXJrQWxsQXNSZWFkOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtbWFyay1hbGwtdW5yZWFkJyksXG4gICAgICBtYXJrQXNVbnJlYWQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1tYXJrLXVucmVhZCcpLFxuICAgICAgb3BlbkRyb3Bkb3duTWVudTogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXVzZXItbWVudV9fZHJvcGRvd24gLmJzLWpzLW9wZW4tbW9kYWwnKSxcbiAgICAgIHJlbW92ZU5vdGlmaWNhdGlvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXJlbW92ZS1ub3RpZmljYXRpb24nKSxcbiAgICB9LFxuICAgIGNsYXNzZXM6IHtcbiAgICAgIGRyb3Bkb3duSGFzTm90aWZpY2F0aW9uOiAnYnMtZHJvcGRvd24tbm90aWZpY2F0aW9uLS1oYXMtbm90aWZpY2F0aW9uJyxcbiAgICAgIGRyb3Bkb3duTWVudU9wZW46ICdicy1kcm9wZG93bi1tZW51LS1vcGVuJyxcbiAgICAgIGhhc05vdGlmaWNhdGlvbjogJ2JzLWRyb3Bkb3duLW5vdGlmaWNhdGlvbl9faXRlbS0taGFzLW5vdGlmaWNhdGlvbicsXG4gICAgICBpbkRvd246ICdicy1kcm9wZG93bi1ub3RpZmljYXRpb25fX251bWJlci0taW4tZG93bi1jb3VudCcsXG4gICAgICBpblVwOiAnYnMtZHJvcGRvd24tbm90aWZpY2F0aW9uX19udW1iZXItLWluLXVwLWNvdW50JyxcbiAgICAgIG91dERvd246ICdicy1kcm9wZG93bi1ub3RpZmljYXRpb25fX251bWJlci0tb3V0LWRvd24tY291bnQnLFxuICAgICAgb3V0VXA6ICdicy1kcm9wZG93bi1ub3RpZmljYXRpb25fX251bWJlci0tb3V0LXVwLWNvdW50JyxcbiAgICAgIG5vdGlmaWNhdGlvbk51bWJlcjogJ2JzLWRyb3Bkb3duLW5vdGlmaWNhdGlvbl9fbnVtYmVyJyxcbiAgICB9LFxuICAgIGRyb3Bkb3duTWVudTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWRyb3Bkb3duLW1lbnUnKSxcbiAgICBub3RpZmljYXRpb25NZW51OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtZHJvcGRvd24tbm90aWZpY2F0aW9uJyksXG4gICAgbm90aWZpY2F0aW9uQ291bnQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1kcm9wZG93bi1ub3RpZmljYXRpb25fX2NvdW50JyksXG4gICAgbm90aWZpY2F0aW9uQ291bnRJbnQ6IG51bGwsXG4gICAgbm90aWZpY2F0aW9uSXRlbXM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1kcm9wZG93bi1tZW51LWl0ZW0nKSxcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBJbmljaWFsaXphIG8gdmFsb3IgZGEgbm90aWZpY2HDp8Ojb1xuICAgIHZhciBoYXNOb3RpZmljYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5jbGFzc2VzLmRyb3Bkb3duSGFzTm90aWZpY2F0aW9uKTtcbiAgICBpZiAoaGFzTm90aWZpY2F0aW9uKSB7XG4gICAgICBjb25maWcubm90aWZpY2F0aW9uQ291bnRJbnQgPSBwYXJzZUludChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtZHJvcGRvd24tbm90aWZpY2F0aW9uX19jb3VudCcpLnRleHRDb250ZW50LCAxMCk7XG5cbiAgICAgIC8vIE1hcmNhIG5vdGlmaWNhw6fDo28gY29tbyBsaWRhXG4gICAgICBpZiAoY29uZmlnLm5vdGlmaWNhdGlvbkl0ZW1zKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLm5vdGlmaWNhdGlvbkl0ZW1zLCBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgICAgbm90aWZpY2F0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbWFya05vdGlmaWNhdGlvbkFzUmVhZChub3RpZmljYXRpb24pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gTWFyY2EgYSBub3RpZmljYcOnw6NvIGNvbW8gbsOjbyBsaWRhXG4gICAgICBpZiAoY29uZmlnLmJ1dHRvbnMubWFya0FzVW5yZWFkKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmJ1dHRvbnMubWFya0FzVW5yZWFkLCBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgICAgbm90aWZpY2F0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBtYXJrTm90aWZpY2F0aW9uQXNVbnJlYWQobm90aWZpY2F0aW9uKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIE1hcmNhIHRvZGFzIGFzIG5vdGlmaWNhw6fDtWVzIGxpZGFzXG4gICAgICBpZiAoY29uZmlnLmJ1dHRvbnMubWFya0FsbEFzUmVhZCkge1xuICAgICAgICBjb25maWcuYnV0dG9ucy5tYXJrQWxsQXNSZWFkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBoYXNOb3RpZmljYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGNvbmZpZy5jbGFzc2VzLmhhc05vdGlmaWNhdGlvbik7XG4gICAgICAgICAgdmFyIGRyb3Bkb3duID0gZ2V0UGFyZW50cyh0aGlzLCAnYnMtZHJvcGRvd24tbWVudScsIHRydWUpWzBdO1xuXG4gICAgICAgICAgY29uZmlnLm5vdGlmaWNhdGlvbkNvdW50SW50ID0gMDtcbiAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5jbGFzc2VzLm5vdGlmaWNhdGlvbk51bWJlcikudGV4dENvbnRlbnQgPSBjb25maWcubm90aWZpY2F0aW9uQ291bnRJbnQ7XG4gICAgICAgICAgZHJvcGRvd24uY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY2xhc3Nlcy5kcm9wZG93bkhhc05vdGlmaWNhdGlvbik7XG5cbiAgICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGhhc05vdGlmaWNhdGlvbiwgZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuICAgICAgICAgICAgbm90aWZpY2F0aW9uLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMuaGFzTm90aWZpY2F0aW9uKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlbW92ZSBub3RpZmljYcOnw6NvXG4gICAgICBpZiAoY29uZmlnLmJ1dHRvbnMucmVtb3ZlTm90aWZpY2F0aW9uKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmJ1dHRvbnMucmVtb3ZlTm90aWZpY2F0aW9uLCBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICByZW1vdmVOb3RpZmljYXRpb24oYnV0dG9uKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQWJyZS9mZWNoYSBvIERyb3Bkb3duIE1lbnVcbiAgICBpZiAoY29uZmlnLmJ1dHRvbnMuZHJvcGRvd25NZW51VHJpZ2dlcikge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuYnV0dG9ucy5kcm9wZG93bk1lbnVUcmlnZ2VyLCBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgdG9nZ2xlRHJvcGRvd25NZW51KGJ1dHRvbik7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFByZXZpbmUgYnVnIGFvIGNhcnJlZ2FyIG8gY29tcG9uZW50ZVxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIEJzVGV4dEVsbGlwc2lzLmluaXQoe1xuICAgICAgICAgIGVsZW1lbnQ6ICcuYnMtZHJvcGRvd24tbWVudV9fZGVzY3JpcHRpb24nLFxuICAgICAgICAgIG1heEhlaWdodDogNDIsXG4gICAgICAgIH0pO1xuICAgICAgfSwgMTAwKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHRvZ2dsZURyb3Bkb3duTWVudSA9IGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICB2YXIgaXNPcGVuID0gYnV0dG9uLnBhcmVudE5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5jbGFzc2VzLmRyb3Bkb3duTWVudU9wZW4pO1xuXG4gICAgaWYgKGlzT3BlbikgY2xvc2VEcm9wZG93bk1lbnUoKTtcbiAgICBlbHNlIG9wZW5Ecm9wZG93bk1lbnVCdXR0b24oYnV0dG9uKTtcbiAgfTtcblxuICB2YXIgb3BlbkRyb3Bkb3duTWVudUJ1dHRvbiA9IGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICBjbG9zZURyb3Bkb3duTWVudSgpO1xuICAgIGJ1dHRvbi5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMuZHJvcGRvd25NZW51T3Blbik7XG4gIH07XG5cbiAgdmFyIGNsb3NlRHJvcGRvd25NZW51ID0gZnVuY3Rpb24gKCkge1xuICAgIEJzQ29udGV4dE1lbnUuY2xvc2VBbGxDb250ZXh0TWVudSgpO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuYnV0dG9ucy5kcm9wZG93bk1lbnVUcmlnZ2VyLCBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICBidXR0b24ucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLmRyb3Bkb3duTWVudU9wZW4pO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBtYXJrTm90aWZpY2F0aW9uQXNVbnJlYWQgPSBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgdmFyIG5vdGlmaWNhdGlvbkl0ZW0gPSBnZXRQYXJlbnRzKG5vdGlmaWNhdGlvbiwgJ2JzLWRyb3Bkb3duLW1lbnVfX2l0ZW0nLCB0cnVlKVswXTtcblxuICAgIGlmICghbm90aWZpY2F0aW9uSXRlbS5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmNsYXNzZXMuaGFzTm90aWZpY2F0aW9uKSkge1xuICAgICAgbm90aWZpY2F0aW9uSXRlbS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jbGFzc2VzLmhhc05vdGlmaWNhdGlvbik7XG4gICAgICBpbmNyZWFzZU5vdGlmaWNhdGlvbkNvdW50KCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBtYXJrTm90aWZpY2F0aW9uQXNSZWFkID0gZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuICAgIGlmIChub3RpZmljYXRpb24uY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5jbGFzc2VzLmhhc05vdGlmaWNhdGlvbikpIHtcbiAgICAgIG5vdGlmaWNhdGlvbi5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLmhhc05vdGlmaWNhdGlvbik7XG4gICAgICBkZWNyZWFzZU5vdGlmaWNhdGlvbkNvdW50KCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciByZW1vdmVOb3RpZmljYXRpb24gPSBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgLy8gU2VsZWNpb25hIGEgbm90aWZpY2HDp8Ojb1xuICAgIHZhciBub3RpZmljYXRpb25JdGVtID0gZ2V0UGFyZW50cyhidXR0b24sICdicy1kcm9wZG93bi1tZW51X19pdGVtJywgdHJ1ZSlbMF07XG5cbiAgICAvLyBSZW1vdmUgYSBub3RpZmljYcOnw6NvIGRhIGxpc3RhXG4gICAgbm90aWZpY2F0aW9uSXRlbS5jbGFzc0xpc3QuYWRkKCdicy1kcm9wZG93bi1tZW51X19pdGVtLS1yZW1vdmluZycpO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgbm90aWZpY2F0aW9uSXRlbS5yZW1vdmUoKTtcbiAgICB9LCAyMDApO1xuXG4gICAgLy8gVmVyaWZpY2Egc2UgYSBub3RpZmnDp8OjbyB0ZW0gYSBjbGFzc2UgcGFyYSBhdHVhbGl6YXIgbyBjb250YWRvclxuICAgIGlmIChub3RpZmljYXRpb25JdGVtLmNsYXNzTGlzdC5jb250YWlucyhjb25maWcuY2xhc3Nlcy5oYXNOb3RpZmljYXRpb24pKSB7XG4gICAgICBkZWNyZWFzZU5vdGlmaWNhdGlvbkNvdW50KCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIEF1bWVudGEgbyBjb250YWRvciBkZSBub3RpZmljYcOnw7Vlc1xuICB2YXIgaW5jcmVhc2VOb3RpZmljYXRpb25Db3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25maWcubm90aWZpY2F0aW9uQ291bnRJbnQrKztcblxuICAgIC8vIHZlcmlmaWNhIHNlIG8gY29udGFkb3IgZXN0w6Egc2VuZG8gZXhpYmlkb1xuICAgIGlmIChcbiAgICAgIGNvbmZpZy5ub3RpZmljYXRpb25Db3VudEludCA+IDAgJiZcbiAgICAgICFjb25maWcubm90aWZpY2F0aW9uTWVudS5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmNsYXNzZXMuZHJvcGRvd25IYXNOb3RpZmljYXRpb24pXG4gICAgKSB7XG4gICAgICBjb25maWcubm90aWZpY2F0aW9uTWVudS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jbGFzc2VzLmRyb3Bkb3duSGFzTm90aWZpY2F0aW9uKTtcbiAgICB9XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5jbGFzc2VzLm5vdGlmaWNhdGlvbk51bWJlcikuY2xhc3NMaXN0LmFkZChjb25maWcuY2xhc3Nlcy5vdXRVcCk7XG4gICAgdXBkYXRlTm90aWZpY2F0aW9uKCdpbmNyZWFzZScpO1xuICB9O1xuXG4gIC8vIERpbWludWkgbyBjb250YWRvciBkZSBub3RpZmljYcOnw7Vlc1xuICB2YXIgZGVjcmVhc2VOb3RpZmljYXRpb25Db3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoY29uZmlnLm5vdGlmaWNhdGlvbkNvdW50SW50ID4gMCkge1xuICAgICAgY29uZmlnLm5vdGlmaWNhdGlvbkNvdW50SW50LS07XG5cbiAgICAgIC8vIHZlcmlmaWNhIHNlIG8gY29udGFkb3IgZXN0w6Egc2VuZG8gZXhpYmlkb1xuICAgICAgaWYgKGNvbmZpZy5ub3RpZmljYXRpb25Db3VudEludCA9PT0gMCkge1xuICAgICAgICBjb25maWcubm90aWZpY2F0aW9uTWVudS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLmRyb3Bkb3duSGFzTm90aWZpY2F0aW9uKTtcbiAgICAgIH1cblxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBjb25maWcuY2xhc3Nlcy5ub3RpZmljYXRpb25OdW1iZXIpLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMub3V0RG93bik7XG4gICAgICB1cGRhdGVOb3RpZmljYXRpb24oJ2RlY3JlYXNlJyk7XG4gICAgfVxuICB9O1xuXG4gIC8vIEF0dWFsaXphIG8gY29udGFkb3IgZGUgbm90aWZpY2HDp8O1ZXNcbiAgdmFyIHVwZGF0ZU5vdGlmaWNhdGlvbiA9IGZ1bmN0aW9uIChpbmNyZWFzZURlY3JlYXNlKSB7XG4gICAgLy8gZGVidWdnZXI7XG4gICAgdmFyIHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgdmFyIGFuaW1hdGlvbkNsYXNzZXMgPSBnZXROb3RpZmljYXRpb25DbGFzcyhpbmNyZWFzZURlY3JlYXNlKTtcblxuICAgIC8vIEluY2x1aSBvIG5vdm8gY29udGFkb3Igbm8gRE9NXG4gICAgLy8gQ29tbyBzZSBlc3RpdmVzc2UgZW1wdXJyYW5kbyBvIGNvbnRhZG9yIGFudGlnbyBwYXJhIGNpbWEvYmFpeG9cbiAgICBzcGFuLnRleHRDb250ZW50ID0gY29uZmlnLm5vdGlmaWNhdGlvbkNvdW50SW50O1xuICAgIHNwYW4uY2xhc3NMaXN0LmFkZCgnYnMtZHJvcGRvd24tbm90aWZpY2F0aW9uX19udW1iZXInLCBhbmltYXRpb25DbGFzc2VzWzBdKTtcbiAgICBjb25maWcubm90aWZpY2F0aW9uQ291bnQuYXBwZW5kQ2hpbGQoc3Bhbik7XG5cbiAgICAvLyBEZWxheSBwYXJhIHF1ZSBvIGNvbnRhZG9yIHNlamEgZW1wdXJyYWRvXG4gICAgLy8gRW50w6NvIHJlbW92ZW1vcyBvIGNvbnRhZG9yIGFudGlnbyBlIGEgY2xhc3NlIGRlIGFuaW1hw6fDo28gZG8gbm92byBjb250YWRvclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBhbmltYXRpb25DbGFzc2VzWzFdKS5yZW1vdmUoKTtcbiAgICAgIHNwYW4uY2xhc3NMaXN0LnJlbW92ZShhbmltYXRpb25DbGFzc2VzWzBdKTtcbiAgICB9LCAyMDApO1xuICB9O1xuXG4gIC8vIE9idMOpbSBhIGNsYXNzZSBkZSBhbmltYcOnw6NvIGRvIGNvbnRhZG9yIGRlIG5vdGlmaWNhw6fDtWVzXG4gIHZhciBnZXROb3RpZmljYXRpb25DbGFzcyA9IGZ1bmN0aW9uIChpbmNyZWFzZURlY3JlYXNlKSB7XG4gICAgdmFyIGNsYXNzSW4gPSAnJztcbiAgICB2YXIgY2xhc3NPdXQgPSAnJztcblxuICAgIC8vIEF0cmlidWkgYXMgY2xhc3NlcyBDU1MgZGUgYW5pbWHDp8Ojb1xuICAgIGlmIChpbmNyZWFzZURlY3JlYXNlID09PSAnaW5jcmVhc2UnKSB7XG4gICAgICBjbGFzc0luID0gY29uZmlnLmNsYXNzZXMuaW5VcDtcbiAgICAgIGNsYXNzT3V0ID0gY29uZmlnLmNsYXNzZXMub3V0VXA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNsYXNzSW4gPSBjb25maWcuY2xhc3Nlcy5pbkRvd247XG4gICAgICBjbGFzc091dCA9IGNvbmZpZy5jbGFzc2VzLm91dERvd247XG4gICAgfVxuXG4gICAgcmV0dXJuIFtjbGFzc0luLCBjbGFzc091dF07XG4gIH07XG5cbiAgLy8gQ2xvc2UgbWVudSBvbiBjbGljayBvdXRzaWRlXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmJ1dHRvbnMuZHJvcGRvd25NZW51VHJpZ2dlciwgZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgICAgaWYgKFxuICAgICAgICBidXR0b24ucGFyZW50Tm9kZS5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmNsYXNzZXMuZHJvcGRvd25NZW51T3BlbikgJiZcbiAgICAgICAgIWJ1dHRvbi5uZXh0RWxlbWVudFNpYmxpbmcuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICBjbG9zZURyb3Bkb3duTWVudSgpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBCc0Ryb3Bkb3duTWVudSBjb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gQnNEcm9wZG93bk1lbnUuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWRyb3Bkb3duLW1lbnUnKS5sZW5ndGgpIHtcbiAgICBCc0Ryb3Bkb3duTWVudS5pbml0KCk7XG4gIH1cbn0pO1xuIiwidmFyIEJzQWNjb3JkaW9uVm9pcCA9IChmdW5jdGlvbiAoKSB7XG5cbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBhY2NvcmRpb25CdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1vcGVuLWFjY29yZGlvbicpLFxuICAgIGFjY29yZGlvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWZhcS12b2lwJyksXG4gICAgYWNjb3JkaW9uQ29udGVudDogJy5icy1qcy1hY2NvcmRpb24tY29udGVudC1yZWYnLFxuICAgIGJvZHk6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKSxcbiAgICBkaXNhYmxlZE9uRGVza3RvcDogJ2JzLWpzLWFjY29yZGlvbi1kaXNhYmxlZC1kZXNrdG9wJ1xuICB9XG5cbiAgdmFyIG1vZENsYXNzID0ge1xuICAgIGFjY29yZGlvbk9wZW5DbGFzczogJ2JzLWZhcS12b2lwX19pdGVtLS1vcGVuJ1xuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy8gQ2hlY2sgaWYgYWNjb3JkaW9uIHNob3VkIGJlIGRpc2FibGVkIG9uIGRlc2t0b3BcbiAgICBkaXNhYmxlQWNjb3JkaW9uT25EZXNrdG9wKCk7XG5cbiAgICAvLyBUb2dnbGUgYWNjb3JkaW9uIGl0ZW0gb24gY2xpY2tcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbmZpZy5hY2NvcmRpb25CdXR0b24ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIGNvbmZpZy5hY2NvcmRpb25CdXR0b25baV0uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgJ2NsaWNrJyxcbiAgICAgICAgdG9nZ2xlQWNjb3JkaW9uSXRlbS5iaW5kKG51bGwsIGNvbmZpZy5hY2NvcmRpb25CdXR0b25baV0pXG4gICAgICApO1xuICAgIH1cblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB1cGRhdGVDb250ZW50SGVpZ2h0KCk7XG4gICAgICBkaXNhYmxlQWNjb3JkaW9uT25EZXNrdG9wKCk7XG4gICAgfSk7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5hY2NvcmRpb24sIGZ1bmN0aW9uIChlbCkge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZUFjY29yZGlvbktleWJvYXJkKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgdG9nZ2xlQWNjb3JkaW9uSXRlbSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgaWYgKGlzQWNjb3JkaW9uT3BlbihlbGVtZW50KSkgY2xvc2VBY2NvcmRpb25JdGVtKGVsZW1lbnQpO1xuICAgIGVsc2Ugb3BlbkFjY29yZGlvbkl0ZW0oZWxlbWVudCk7XG4gIH07XG5cbiAgdmFyIGlzQWNjb3JkaW9uT3BlbiA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgdmFyIGl0ZW0gPSBnZXRQYXJlbnQoZWxlbWVudCwgJ2JzLWZhcS12b2lwX19pdGVtJyk7XG4gICAgcmV0dXJuIGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKG1vZENsYXNzLmFjY29yZGlvbk9wZW5DbGFzcyk7XG4gIH07XG5cbiAgdmFyIG9wZW5BY2NvcmRpb25JdGVtID0gZnVuY3Rpb24gKG9wZW5FbGVtZW50KSB7XG4gICAgdmFyIGl0ZW0gPSBnZXRQYXJlbnQob3BlbkVsZW1lbnQsICdicy1mYXEtdm9pcF9faXRlbScpO1xuICAgIHZhciBjb250ZW50ID0gaXRlbS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5hY2NvcmRpb25Db250ZW50KTtcbiAgICB2YXIgY29udGVudEhlaWdodCA9IGNvbnRlbnQuc2Nyb2xsSGVpZ2h0O1xuXG4gICAgb3BlbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcbiAgICBjb250ZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAnZmFsc2UnKTtcblxuICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChtb2RDbGFzcy5hY2NvcmRpb25PcGVuQ2xhc3MpO1xuICAgIGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gY29udGVudEhlaWdodCArICdweCc7XG4gIH07XG5cbiAgdmFyIGNsb3NlQWNjb3JkaW9uSXRlbSA9IGZ1bmN0aW9uIChjbG9zZUVsZW1lbnQpIHtcbiAgICB2YXIgaXRlbSA9IGdldFBhcmVudChjbG9zZUVsZW1lbnQsICdicy1mYXEtdm9pcF9faXRlbScpO1xuICAgIHZhciBjb250ZW50ID0gaXRlbS5xdWVyeVNlbGVjdG9yKGNvbmZpZy5hY2NvcmRpb25Db250ZW50KTtcbiAgICB2YXIgY29udGVudEhlaWdodCA9IGNvbnRlbnQuc2Nyb2xsSGVpZ2h0O1xuXG4gICAgY2xvc2VFbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgIGNvbnRlbnQuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7XG5cbiAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUobW9kQ2xhc3MuYWNjb3JkaW9uT3BlbkNsYXNzKTtcbiAgICBjb250ZW50LnN0eWxlLmhlaWdodCA9IDA7XG5cbiAgICBmaXhFbGVtZW50U2Nyb2xsKGl0ZW0pO1xuICB9O1xuXG4gIC8vIFVwZGF0ZXMgY29udGVudCBoZWlnaHQgb24gd2luZG93IHJlc2l6ZVxuICB2YXIgdXBkYXRlQ29udGVudEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtZmFxLXZvaXBfX2l0ZW0nKTtcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaXRlbXMsIGZ1bmN0aW9uIChlbGVtZW50LCBpKSB7XG4gICAgICB2YXIgY29udGVudCA9IGVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuYWNjb3JkaW9uQ29udGVudCk7XG4gICAgICB2YXIgY29udGVudEhlaWdodCA9IGNvbnRlbnQucXVlcnlTZWxlY3RvcignLmJzLWZhcS12b2lwX19ib3gnKS5zY3JvbGxIZWlnaHQgKyAncHgnO1xuICAgICAgdmFyIGFjY29yZGlvbiA9IGdldFBhcmVudHMoZWxlbWVudCwgY29uZmlnLmRpc2FibGVkT25EZXNrdG9wKVswXTtcblxuICAgICAgLy8gSWYgdGhlIC5icy1qcy1hY2NvcmRpb24tY29udGVudCBoZWlnaHQgaXMgZGlmZmVyZW50IGZyb20gaXRzIGNvbnRlbnQsIHVwZGF0ZXMgaXRzIGhlaWdodFxuICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKG1vZENsYXNzLmFjY29yZGlvbk9wZW5DbGFzcykgJiYgcGFyc2VJbnQoY29udGVudC5zdHlsZS5oZWlnaHQpICE9IGNvbnRlbnRIZWlnaHQpIHtcbiAgICAgICAgY29udGVudC5zdHlsZS5oZWlnaHQgPSBjb250ZW50SGVpZ2h0O1xuICAgICAgfVxuXG5cbiAgICAgIC8vIElmIGFjY29yZGlvbiBpcyBzZXQgdG8gYmUgZGlzYWJsZWQgb24gZGVza3RvcCwgdXBkYXRlIGl0ZW1zIGhlaWdodFxuICAgICAgaWYgKGFjY29yZGlvbikge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKG1vZENsYXNzLmFjY29yZGlvbk9wZW5DbGFzcykgJiYgcGFyc2VJbnQoY29udGVudC5zdHlsZS5oZWlnaHQpICE9IGNvbnRlbnRIZWlnaHQpIHx8XG4gICAgICAgICAgKCFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhtb2RDbGFzcy5hY2NvcmRpb25PcGVuQ2xhc3MpICYmIHdpbmRvdy5pbm5lcldpZHRoID49IDEyMDApXG4gICAgICAgICkge1xuICAgICAgICAgIGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gY29udGVudEhlaWdodDtcbiAgICAgICAgfSBlbHNlIGlmICghZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMobW9kQ2xhc3MuYWNjb3JkaW9uT3BlbkNsYXNzKSAmJiB3aW5kb3cuaW5uZXJXaWR0aCA8IDEyMDApIHtcbiAgICAgICAgICBjb250ZW50LnN0eWxlLmhlaWdodCA9IDA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8vIENoZWNrcyBpZiB0aGUgYWNjb3JkaW9uIHNob3VsZCBiZSBkaXNhYmxlZCBvbiBkZXNrdG9wXG4gIC8vIGFuZCB0aGVuIGRpc2FibGUgaXRzIGJ1dHRvbnNcbiAgdmFyIGRpc2FibGVBY2NvcmRpb25PbkRlc2t0b3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuYWNjb3JkaW9uLCBmdW5jdGlvbiAoZWxlbWVudCwgaSkge1xuICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5kaXNhYmxlZE9uRGVza3RvcCkpIHRvZ2dsZUJ1dHRvbnMoZWxlbWVudCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBEaXNhYmxlIHRoZSBhY2NvcmRpb24gYnV0dG9uc1xuICB2YXIgdG9nZ2xlQnV0dG9ucyA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgdmFyIGl0ZW1zID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtb3Blbi1hY2NvcmRpb24nKTtcblxuICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSAxMjAwKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGl0ZW1zLCBmdW5jdGlvbiAoZWwsIGkpIHtcbiAgICAgICAgZWwuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaXRlbXMsIGZ1bmN0aW9uIChlbCwgaSkge1xuICAgICAgICBlbC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gRml4IHNjcm9sbCBvZiBhbiBlbGVtZW50IHdoZW4gdGFiYmluZyBmb2N1c1xuICAvLyBvbiBhbiBlbGVtZW50IGluc2lkZSBhIGRpdiB3aG8gd2lsbCBiZSBoaWRkZW5cbiAgLy8gYWZ0ZXIgYSB0cmFuc2l0aW9uXG4gIHZhciBmaXhFbGVtZW50U2Nyb2xsID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBlbC5zY3JvbGxUbygwLCAwKTtcbiAgICB9LCAzMDApO1xuICB9O1xuXG4gIHZhciBoYW5kbGVBY2NvcmRpb25LZXlib2FyZCA9IGZ1bmN0aW9uIChldikge1xuICAgIHZhciBhY2NvcmRpb24gPSBldi5jdXJyZW50VGFyZ2V0O1xuICAgIHZhciBjdXJyZW50RWwgPSBldi50YXJnZXQ7XG4gICAgdmFyIGtleSA9IGV2LmtleTtcbiAgICB2YXIgYnV0dG9uc05vZGUgPSBhY2NvcmRpb24ucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLW9wZW4tYWNjb3JkaW9uJyk7XG4gICAgdmFyIGJ1dHRvbnMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChidXR0b25zTm9kZSk7XG4gICAgdmFyIGN1cnJlbnRCdXR0b24gPSAoXG4gICAgICAgIGN1cnJlbnRFbC5jbGFzc0xpc3QuY29udGFpbnMoJ2JzLWpzLW9wZW4tYWNjb3JkaW9uJykpID9cbiAgICAgIGN1cnJlbnRFbCA6IGN1cnJlbnRFbC5jbG9zZXN0KCcuYnMtanMtb3Blbi1hY2NvcmRpb24nKTtcbiAgICB2YXIgZmlyc3RCdXR0b24gPSBidXR0b25zWzBdO1xuICAgIHZhciBsYXN0QnV0dG9uID0gYnV0dG9uc1tidXR0b25zLmxlbmd0aCAtIDFdO1xuICAgIHZhciBwcmV2QnV0dG9uID0gYnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pID9cbiAgICAgIGJ1dHRvbnNbYnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pIC0gMV0gOlxuICAgICAgbGFzdEJ1dHRvbjtcbiAgICB2YXIgbmV4dEJ1dHRvbiA9IGJ1dHRvbnMuaW5kZXhPZihjdXJyZW50QnV0dG9uKSA8IGJ1dHRvbnMubGVuZ3RoIC0gMSA/XG4gICAgICBidXR0b25zW2J1dHRvbnMuaW5kZXhPZihjdXJyZW50QnV0dG9uKSArIDFdIDpcbiAgICAgIGZpcnN0QnV0dG9uO1xuXG4gICAgaWYgKGN1cnJlbnRCdXR0b24pIHtcbiAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgIGNhc2UgXCJSaWdodFwiOiAvLyBJRS9FZGdlIHNwZWNpZmljIHZhbHVlXG4gICAgICAgIGNhc2UgXCJBcnJvd1JpZ2h0XCI6XG4gICAgICAgICAgb3BlbkFjY29yZGlvbkl0ZW0oY3VycmVudEJ1dHRvbik7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJMZWZ0XCI6IC8vIElFL0VkZ2Ugc3BlY2lmaWMgdmFsdWVcbiAgICAgICAgY2FzZSBcIkFycm93TGVmdFwiOlxuICAgICAgICAgIGNsb3NlQWNjb3JkaW9uSXRlbShjdXJyZW50QnV0dG9uKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIkRvd25cIjogLy8gSUUvRWRnZSBzcGVjaWZpYyB2YWx1ZVxuICAgICAgICBjYXNlIFwiQXJyb3dEb3duXCI6XG4gICAgICAgICAgbmV4dEJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiVXBcIjogLy8gSUUvRWRnZSBzcGVjaWZpYyB2YWx1ZVxuICAgICAgICBjYXNlIFwiQXJyb3dVcFwiOlxuICAgICAgICAgIHByZXZCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnSG9tZSc6XG4gICAgICAgICAgZmlyc3RCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRW5kJzpcbiAgICAgICAgICBsYXN0QnV0dG9uLmZvY3VzKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBNb2RhbCBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1mYXEtdm9pcCcpLmxlbmd0aCkge1xuICAgIEJzQWNjb3JkaW9uVm9pcC5pbml0KCk7XG4gIH1cbn0pO1xuIiwidmFyIEJzQWNjb3JkaW9uUmVmID0gKGZ1bmN0aW9uICgpIHtcblxuICB2YXIgY29uZmlnID0ge1xuICAgIGFjY29yZGlvbkJ1dHRvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLW9wZW4tYWNjb3JkaW9uJyksXG4gICAgYWNjb3JkaW9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtZmFxLXJlZmFjdG9yZWQnKSxcbiAgICBhY2NvcmRpb25Db250ZW50OiAnLmJzLWpzLWFjY29yZGlvbi1jb250ZW50LXJlZicsXG4gICAgYm9keTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLFxuICAgIGRpc2FibGVkT25EZXNrdG9wOiAnYnMtanMtYWNjb3JkaW9uLWRpc2FibGVkLWRlc2t0b3AnXG4gIH1cblxuICB2YXIgbW9kQ2xhc3MgPSB7XG4gICAgYWNjb3JkaW9uT3BlbkNsYXNzOiAnYnMtZmFxLXJlZmFjdG9yZWRfX2l0ZW0tLW9wZW4nXG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAvLyBDaGVjayBpZiBhY2NvcmRpb24gc2hvdWQgYmUgZGlzYWJsZWQgb24gZGVza3RvcFxuICAgIGRpc2FibGVBY2NvcmRpb25PbkRlc2t0b3AoKTtcblxuICAgIC8vIFRvZ2dsZSBhY2NvcmRpb24gaXRlbSBvbiBjbGlja1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29uZmlnLmFjY29yZGlvbkJ1dHRvbi5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgY29uZmlnLmFjY29yZGlvbkJ1dHRvbltpXS5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAnY2xpY2snLFxuICAgICAgICB0b2dnbGVBY2NvcmRpb25JdGVtLmJpbmQobnVsbCwgY29uZmlnLmFjY29yZGlvbkJ1dHRvbltpXSlcbiAgICAgICk7XG4gICAgfVxuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHVwZGF0ZUNvbnRlbnRIZWlnaHQoKTtcbiAgICAgIGRpc2FibGVBY2NvcmRpb25PbkRlc2t0b3AoKTtcbiAgICB9KTtcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmFjY29yZGlvbiwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlQWNjb3JkaW9uS2V5Ym9hcmQpO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciB0b2dnbGVBY2NvcmRpb25JdGVtID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICBpZiAoaXNBY2NvcmRpb25PcGVuKGVsZW1lbnQpKSBjbG9zZUFjY29yZGlvbkl0ZW0oZWxlbWVudCk7XG4gICAgZWxzZSBvcGVuQWNjb3JkaW9uSXRlbShlbGVtZW50KTtcbiAgfTtcblxuICB2YXIgaXNBY2NvcmRpb25PcGVuID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICB2YXIgaXRlbSA9IGdldFBhcmVudChlbGVtZW50LCAnYnMtZmFxLXJlZmFjdG9yZWRfX2l0ZW0nKTtcbiAgICByZXR1cm4gaXRlbS5jbGFzc0xpc3QuY29udGFpbnMobW9kQ2xhc3MuYWNjb3JkaW9uT3BlbkNsYXNzKTtcbiAgfTtcblxuICB2YXIgb3BlbkFjY29yZGlvbkl0ZW0gPSBmdW5jdGlvbiAob3BlbkVsZW1lbnQpIHtcbiAgICB2YXIgaXRlbSA9IGdldFBhcmVudChvcGVuRWxlbWVudCwgJ2JzLWZhcS1yZWZhY3RvcmVkX19pdGVtJyk7XG4gICAgdmFyIGNvbnRlbnQgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLmFjY29yZGlvbkNvbnRlbnQpO1xuICAgIHZhciBjb250ZW50SGVpZ2h0ID0gY29udGVudC5zY3JvbGxIZWlnaHQ7XG5cbiAgICBvcGVuRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAndHJ1ZScpO1xuICAgIGNvbnRlbnQuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICdmYWxzZScpO1xuXG4gICAgaXRlbS5jbGFzc0xpc3QuYWRkKG1vZENsYXNzLmFjY29yZGlvbk9wZW5DbGFzcyk7XG4gICAgY29udGVudC5zdHlsZS5oZWlnaHQgPSBjb250ZW50SGVpZ2h0ICsgJ3B4JztcbiAgfTtcblxuICB2YXIgY2xvc2VBY2NvcmRpb25JdGVtID0gZnVuY3Rpb24gKGNsb3NlRWxlbWVudCkge1xuICAgIHZhciBpdGVtID0gZ2V0UGFyZW50KGNsb3NlRWxlbWVudCwgJ2JzLWZhcS1yZWZhY3RvcmVkX19pdGVtJyk7XG4gICAgdmFyIGNvbnRlbnQgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLmFjY29yZGlvbkNvbnRlbnQpO1xuICAgIHZhciBjb250ZW50SGVpZ2h0ID0gY29udGVudC5zY3JvbGxIZWlnaHQ7XG5cbiAgICBjbG9zZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG4gICAgY29udGVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcblxuICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShtb2RDbGFzcy5hY2NvcmRpb25PcGVuQ2xhc3MpO1xuICAgIGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gMDtcblxuICAgIGZpeEVsZW1lbnRTY3JvbGwoaXRlbSk7XG4gIH07XG5cbiAgLy8gVXBkYXRlcyBjb250ZW50IGhlaWdodCBvbiB3aW5kb3cgcmVzaXplXG4gIHZhciB1cGRhdGVDb250ZW50SGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1mYXEtcmVmYWN0b3JlZF9faXRlbScpO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChpdGVtcywgZnVuY3Rpb24gKGVsZW1lbnQsIGkpIHtcbiAgICAgIHZhciBjb250ZW50ID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5hY2NvcmRpb25Db250ZW50KTtcbiAgICAgIHZhciBjb250ZW50SGVpZ2h0ID0gY29udGVudC5xdWVyeVNlbGVjdG9yKCcuYnMtZmFxLXJlZmFjdG9yZWRfX2JveCcpLnNjcm9sbEhlaWdodCArICdweCc7XG4gICAgICB2YXIgYWNjb3JkaW9uID0gZ2V0UGFyZW50cyhlbGVtZW50LCBjb25maWcuZGlzYWJsZWRPbkRlc2t0b3ApWzBdO1xuXG4gICAgICAvLyBJZiB0aGUgLmJzLWpzLWFjY29yZGlvbi1jb250ZW50IGhlaWdodCBpcyBkaWZmZXJlbnQgZnJvbSBpdHMgY29udGVudCwgdXBkYXRlcyBpdHMgaGVpZ2h0XG4gICAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMobW9kQ2xhc3MuYWNjb3JkaW9uT3BlbkNsYXNzKSAmJiBwYXJzZUludChjb250ZW50LnN0eWxlLmhlaWdodCkgIT0gY29udGVudEhlaWdodCkge1xuICAgICAgICBjb250ZW50LnN0eWxlLmhlaWdodCA9IGNvbnRlbnRIZWlnaHQ7XG4gICAgICB9XG5cblxuICAgICAgLy8gSWYgYWNjb3JkaW9uIGlzIHNldCB0byBiZSBkaXNhYmxlZCBvbiBkZXNrdG9wLCB1cGRhdGUgaXRlbXMgaGVpZ2h0XG4gICAgICBpZiAoYWNjb3JkaW9uKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAoZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMobW9kQ2xhc3MuYWNjb3JkaW9uT3BlbkNsYXNzKSAmJiBwYXJzZUludChjb250ZW50LnN0eWxlLmhlaWdodCkgIT0gY29udGVudEhlaWdodCkgfHxcbiAgICAgICAgICAoIWVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKG1vZENsYXNzLmFjY29yZGlvbk9wZW5DbGFzcykgJiYgd2luZG93LmlubmVyV2lkdGggPj0gMTIwMClcbiAgICAgICAgKSB7XG4gICAgICAgICAgY29udGVudC5zdHlsZS5oZWlnaHQgPSBjb250ZW50SGVpZ2h0O1xuICAgICAgICB9IGVsc2UgaWYgKCFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhtb2RDbGFzcy5hY2NvcmRpb25PcGVuQ2xhc3MpICYmIHdpbmRvdy5pbm5lcldpZHRoIDwgMTIwMCkge1xuICAgICAgICAgIGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gMDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLy8gQ2hlY2tzIGlmIHRoZSBhY2NvcmRpb24gc2hvdWxkIGJlIGRpc2FibGVkIG9uIGRlc2t0b3BcbiAgLy8gYW5kIHRoZW4gZGlzYWJsZSBpdHMgYnV0dG9uc1xuICB2YXIgZGlzYWJsZUFjY29yZGlvbk9uRGVza3RvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5hY2NvcmRpb24sIGZ1bmN0aW9uIChlbGVtZW50LCBpKSB7XG4gICAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmRpc2FibGVkT25EZXNrdG9wKSkgdG9nZ2xlQnV0dG9ucyhlbGVtZW50KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIERpc2FibGUgdGhlIGFjY29yZGlvbiBidXR0b25zXG4gIHZhciB0b2dnbGVCdXR0b25zID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICB2YXIgaXRlbXMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1vcGVuLWFjY29yZGlvbicpO1xuXG4gICAgaWYgKHdpbmRvdy5pbm5lcldpZHRoID49IDEyMDApIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaXRlbXMsIGZ1bmN0aW9uIChlbCwgaSkge1xuICAgICAgICBlbC5kaXNhYmxlZCA9IHRydWU7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChpdGVtcywgZnVuY3Rpb24gKGVsLCBpKSB7XG4gICAgICAgIGVsLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvLyBGaXggc2Nyb2xsIG9mIGFuIGVsZW1lbnQgd2hlbiB0YWJiaW5nIGZvY3VzXG4gIC8vIG9uIGFuIGVsZW1lbnQgaW5zaWRlIGEgZGl2IHdobyB3aWxsIGJlIGhpZGRlblxuICAvLyBhZnRlciBhIHRyYW5zaXRpb25cbiAgdmFyIGZpeEVsZW1lbnRTY3JvbGwgPSBmdW5jdGlvbiAoZWwpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGVsLnNjcm9sbFRvKDAsIDApO1xuICAgIH0sIDMwMCk7XG4gIH07XG5cbiAgdmFyIGhhbmRsZUFjY29yZGlvbktleWJvYXJkID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgdmFyIGFjY29yZGlvbiA9IGV2LmN1cnJlbnRUYXJnZXQ7XG4gICAgdmFyIGN1cnJlbnRFbCA9IGV2LnRhcmdldDtcbiAgICB2YXIga2V5ID0gZXYua2V5O1xuICAgIHZhciBidXR0b25zTm9kZSA9IGFjY29yZGlvbi5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtb3Blbi1hY2NvcmRpb24nKTtcbiAgICB2YXIgYnV0dG9ucyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGJ1dHRvbnNOb2RlKTtcbiAgICB2YXIgY3VycmVudEJ1dHRvbiA9IChcbiAgICAgICAgY3VycmVudEVsLmNsYXNzTGlzdC5jb250YWlucygnYnMtanMtb3Blbi1hY2NvcmRpb24nKSkgP1xuICAgICAgY3VycmVudEVsIDogY3VycmVudEVsLmNsb3Nlc3QoJy5icy1qcy1vcGVuLWFjY29yZGlvbicpO1xuICAgIHZhciBmaXJzdEJ1dHRvbiA9IGJ1dHRvbnNbMF07XG4gICAgdmFyIGxhc3RCdXR0b24gPSBidXR0b25zW2J1dHRvbnMubGVuZ3RoIC0gMV07XG4gICAgdmFyIHByZXZCdXR0b24gPSBidXR0b25zLmluZGV4T2YoY3VycmVudEJ1dHRvbikgP1xuICAgICAgYnV0dG9uc1tidXR0b25zLmluZGV4T2YoY3VycmVudEJ1dHRvbikgLSAxXSA6XG4gICAgICBsYXN0QnV0dG9uO1xuICAgIHZhciBuZXh0QnV0dG9uID0gYnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pIDwgYnV0dG9ucy5sZW5ndGggLSAxID9cbiAgICAgIGJ1dHRvbnNbYnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pICsgMV0gOlxuICAgICAgZmlyc3RCdXR0b247XG5cbiAgICBpZiAoY3VycmVudEJ1dHRvbikge1xuICAgICAgc3dpdGNoIChrZXkpIHtcbiAgICAgICAgY2FzZSBcIlJpZ2h0XCI6IC8vIElFL0VkZ2Ugc3BlY2lmaWMgdmFsdWVcbiAgICAgICAgY2FzZSBcIkFycm93UmlnaHRcIjpcbiAgICAgICAgICBvcGVuQWNjb3JkaW9uSXRlbShjdXJyZW50QnV0dG9uKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIkxlZnRcIjogLy8gSUUvRWRnZSBzcGVjaWZpYyB2YWx1ZVxuICAgICAgICBjYXNlIFwiQXJyb3dMZWZ0XCI6XG4gICAgICAgICAgY2xvc2VBY2NvcmRpb25JdGVtKGN1cnJlbnRCdXR0b24pO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiRG93blwiOiAvLyBJRS9FZGdlIHNwZWNpZmljIHZhbHVlXG4gICAgICAgIGNhc2UgXCJBcnJvd0Rvd25cIjpcbiAgICAgICAgICBuZXh0QnV0dG9uLmZvY3VzKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJVcFwiOiAvLyBJRS9FZGdlIHNwZWNpZmljIHZhbHVlXG4gICAgICAgIGNhc2UgXCJBcnJvd1VwXCI6XG4gICAgICAgICAgcHJldkJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdIb21lJzpcbiAgICAgICAgICBmaXJzdEJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdFbmQnOlxuICAgICAgICAgIGxhc3RCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IE1vZGFsIENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWZhcS1yZWZhY3RvcmVkJykubGVuZ3RoKSB7XG4gICAgQnNBY2NvcmRpb25SZWYuaW5pdCgpO1xuICB9XG59KTtcbiIsIi8qKlxuICogQnMgRmlsdGVyIChhbmNob3IpXG4gKi9cbnZhciBCc0ZpbHRlciA9IChmdW5jdGlvbiAoKSB7XG4gIC8vIEVsZW1lbnRzXG4gIHZhciBlbGVtZW50cyA9IHt9O1xuICB2YXIgJCA9IGVsZW1lbnRzO1xuICAkLmJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG4gICQuZmlsdGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLWZpbHRlcicpO1xuXG4gIGlmICghJC5maWx0ZXIpIHJldHVybjtcblxuICAkLm5hdiA9ICQuZmlsdGVyLnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1maWx0ZXItLW5hdicpO1xuICAkLnRvZ2dsZSA9ICQuZmlsdGVyLnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1maWx0ZXItLXRvZ2dsZScpO1xuICAvLyAkLmRyb3Bkb3duID0gbmV3IEJzRHJvcGRvd24oKTtcbiAgJC5saXN0ID0gJC5maWx0ZXIucXVlcnlTZWxlY3RvcignLmJzLWpzLWZpbHRlci0tbGlzdCcpO1xuICAkLmdyaWQgPSAkLmZpbHRlci5xdWVyeVNlbGVjdG9yKCcuZ3JpZCcpO1xuICAkLml0ZW1zID0gJC5saXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1maWx0ZXItLWl0ZW0nKTtcblxuICAvLyBDb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBmaWx0ZXI6IG51bGwsXG4gICAgaXRlbVNlbGVjdG9yOiAnLmJzLWpzLWZpbHRlci0taXRlbScsXG4gICAgaXRlbVNpemVyU2VsZWN0b3I6ICcuYnMtanMtZmlsdGVyLS1zaXplcicsXG4gICAgYnV0dG9uQWN0aXZlQ2xhc3M6ICdicy1maWx0ZXItbGluay0tYWN0aXZlJyxcbiAgICBpdGVtQWN0aXZlQ2xhc3M6ICdicy1maWx0ZXJfX2l0ZW0tLXZpc2libGUnLFxuICAgIGl0ZW1TZWxlY3Rvckxpc3Q6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1maWx0ZXItLWl0ZW0nKSxcbiAgICBidXR0b25zOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtZmlsdGVyLS1idXR0b24nKSxcbiAgICBzZWxlY3RzIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWZpbHRlci0tbmF2IHNlbGVjdCcpLFxuICAgIGNoZWNrYm94ZXMgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtZmlsdGVyLS1uYXYgaW5wdXQnKSxcbiAgICBzbGlkZXIgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtbW9kYWwtY2Fyb3VzZWwnKSxcbiAgICBzZWxlY3RzTm9kZSA6IFtdLFxuICAgIGNoZWNrYm94ZXNOb2RlIDogW11cbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBSZXRvcm5hIGl0ZW5zIGZpbHRyYWRvc1xuICAgIGZpbHRlck1hc29ucnkoKVxuXG4gICAgLy8gLSBQZXJjb3JyZSBuYXZlZ2HDp8OjbyBkZSBpY29uZXMgb3UgdGFicyBzdXBlcmlvciBzZSBleHNpdGlyXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuYnV0dG9ucywgZnVuY3Rpb24gKGVsKSB7XG4gICAgICB2YXIgdGFnID0gZWwuZGF0YXNldC5maWx0ZXI7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYWN0aXZlQnV0dG9uKGVsKVxuICAgICAgICBmaWx0ZXJJdGVtcyh0YWcpXG4gICAgICB9KVxuICAgIH0pXG4gICAgLy8tIHBlcmNvcnJlIHNlbGVjdHMgZSByZXRvcm5hXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuc2VsZWN0cywgZnVuY3Rpb24oZWxlbSkge1xuICAgICAgY29uZmlnLnNlbGVjdHNOb2RlLnB1c2goZWxlbSlcbiAgICB9KVxuICAgIC8vLSBwZXJjb3JyZSBjaGVja2JveCBwZWxvIGRhdGEgZmlsdGVyLCByZXRvcm5hIGUgYXR1YWxpemEgbyBjb21wb25lbnRlIHNlIGNoZWNrZWRcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5jaGVja2JveGVzLCBmdW5jdGlvbihlbGVtKSB7XG4gICAgICBjb25maWcuY2hlY2tib3hlc05vZGUucHVzaChlbGVtKTtcbiAgICAgIGlmIChlbGVtLmNoZWNrZWQpIHtcbiAgICAgICAgdmFyIHRhZyA9IGVsZW0uZ2V0QXR0cmlidXRlKCdkYXRhLWZpbHRlcicpXG4gICAgICAgIGZpbHRlckl0ZW1zKHRhZylcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gQ29udGFjYXRlbmEgb3MgZWxlbWVudG8gZGUgc2VsZWN0IGUgY2hlY2tib3ggcGFyYSByZWFsaXphciBvIGZpbHRybyBtdWx0aXBsbyBuYSBzZXF1ZW5jaWFcbiAgICB2YXIgcmV0dXJuQWxsRXZlbnQgPSBjb25maWcuc2VsZWN0c05vZGUuY29uY2F0KGNvbmZpZy5jaGVja2JveGVzTm9kZSlcblxuICAgIC8vIC1BcGxpY2EgY29uZGnDp8O1ZXMgcGFyYSBzZXRhciBmaWx0cm9zIGUgc3VhcyBjb21wYXJhw6fDtWVzIGEgcGFydGlyIGRvIGV2ZW50byBjaGFuZ2VcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHJldHVybkFsbEV2ZW50LCBmdW5jdGlvbihlbGVtKXtcbiAgICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgcnVuKVxuICAgIH0pXG5cbiAgICBydW4oKTtcbiAgfTtcblxuICB2YXIgcnVuID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIG1hcCBpbnB1dCB2YWx1ZXMgdG8gYW4gYXJyYXlcbiAgICB2YXIgZXhjbHVzaXZlcyA9IFtdXG4gICAgdmFyIGluY2x1c2l2ZXMgPSBbXVxuXG4gICAgLy8tIEF0cmlidWkgb3B0aW9ucyBkZSBjYWRhIHNlbGVjdFxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLnNlbGVjdHMsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgdmFyIGF0dHIgPSBlbC5vcHRpb25zW2VsLnNlbGVjdGVkSW5kZXhdLmdldEF0dHJpYnV0ZSgnZGF0YS1maWx0ZXInKVxuICAgICAgLy92YXIgYXR0clZhbHVlID0gZWwub3B0aW9uc1tlbC5zZWxlY3RlZEluZGV4XS52YWx1ZVxuICAgICAgaWYgKGF0dHIpXG4gICAgICAgIGV4Y2x1c2l2ZXMucHVzaChhdHRyKTtcblxuICAgICAgLy8gUGVyY29ycmUgTGlzdGEgYXBvcyBzZWxlY3QgY2hhbmdlIGUgcmVtb3ZlIGEgY2xhc3NlIHBhcmEgbyBmbGlja2l0eSwgYXDDs3MgY2hhbmdlIMOpIGFkaWNpb25hZG8gbm8gT04uYXJyYW5nZSBhIGNsYXNzZSBubyBpdGVtIHNlbGVjaW9uYVxuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuaXRlbVNlbGVjdG9yTGlzdCxmdW5jdGlvbihlbCkge1xuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdicy1qcy1maWx0ZXItLW1vZGFsJyk7XG4gICAgICB9KVxuICAgIH0pXG5cbiAgICAvLyBBdHJpYnVpIGFvIENoZWNrYm94IG8gaXRlbSBhIHNlciB2ZXJpZmljYWRvXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuY2hlY2tib3hlcywgZnVuY3Rpb24gKGVsKSB7XG4gICAgICBpZiAoZWwuY2hlY2tlZCkge1xuICAgICAgICB2YXIgYXR0ciA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1maWx0ZXInKTtcbiAgICAgICAgaW5jbHVzaXZlcy5wdXNoKGF0dHIpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQXJtYXplbmEgb3Mgb3B0aW9ucyBlIG9zIHNlcGFyYVxuICAgIGV4Y2x1c2l2ZXMgPSBleGNsdXNpdmVzLmpvaW4oJycpO1xuXG4gICAgdmFyIHRhZztcbiAgICAvLyBWZXJpZmljYcOnw6NvIHNlIGhvdXZlciBjaGVja2Vib3hcbiAgICBpZiAoaW5jbHVzaXZlcy5sZW5ndGgpe1xuICAgICAgLy8gTWFwIHBhcmEgcmV0b3JuYXIgb3MgZG9pcyB2YWxvcmVzIGUgb3Mgc2VwYXJhXG4gICAgICAvLyBkZWJ1Z2dlclxuICAgICAgdGFnID0gaW5jbHVzaXZlcy5tYXAoIGZ1bmN0aW9uKCB2YWx1ZSApIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICsgZXhjbHVzaXZlc1xuICAgICAgfSlcbiAgICAgIHRhZyA9IHRhZy5qb2luKCcsICcpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRhZyA9IGV4Y2x1c2l2ZXM7XG4gICAgfVxuICAgIGZpbHRlckl0ZW1zKHRhZylcbiAgfVxuXG4gIHZhciBmaWx0ZXJNYXNvbnJ5ID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbmZpZy5maWx0ZXIgPSBuZXcgSXNvdG9wZSgkLmxpc3QsIHtcbiAgICAgIGxheW91dE1vZGU6ICdwYWNrZXJ5JyxcbiAgICAgIGl0ZW1TZWxlY3RvcjogY29uZmlnLml0ZW1TZWxlY3RvcixcbiAgICAgIGNvbHVtbldpZHRoOiBjb25maWcuaXRlbVNpemVyU2VsZWN0b3IsXG4gICAgICBwZXJjZW50UG9zaXRpb246IHRydWUsXG4gICAgICByb3dIZWlnaHQ6IDMyMCxcbiAgICB9KTtcblxuICAgIC8vIEFwbGljYSBmdW7Dp8OjbyBkYSBjbGFzc2UgbW9kYWwgYSBpdGVucyByZXRvcm5hZG9zXG4gICAgY29uZmlnLmZpbHRlci5vbignYXJyYW5nZUNvbXBsZXRlJywgZnVuY3Rpb24gKGZpbHRlcmVkSXRlbXMpIHtcbiAgICAgIHZhciBmaWx0ZXJlZEl0ZW1zQXJyYXkgPSBmaWx0ZXJlZEl0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbS5lbGVtZW50O1xuICAgICAgfSk7XG5cblxuICAgICAgdmFyIGZpbHRlcmVkSXRlbXNJbmRleCA9IEFycmF5LnByb3RvdHlwZS5tYXAuY2FsbChjb25maWcuaXRlbVNlbGVjdG9yTGlzdCwgZnVuY3Rpb24gKGVsLCBpbmRleCkge1xuICAgICAgICAvLyBpZiAoZmlsdGVyZWRJdGVtc0FycmF5LmluZGV4T2YoZWwpKVxuICAgICAgICBpZiAoZmlsdGVyZWRJdGVtc0FycmF5LmluY2x1ZGVzKGVsKSlcbiAgICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICB9KTtcblxuICAgICAgdmFyIGl0ZW1zSW5kZXggPSBBcnJheS5wcm90b3R5cGUuZmlsdGVyLmNhbGwoZmlsdGVyZWRJdGVtc0luZGV4LCBmdW5jdGlvbiAoZWwsIGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgZWwgIT09ICd1bmRlZmluZWQnXG4gICAgICB9KTtcblxuICAgICAgLy9kZWJ1Z2dlclxuICAgICAgaWYgKGNvbmZpZy5zbGlkZXIpIEJzTW9kYWxMaXN0LmxvYWRTbGlkZXIoY29uZmlnLnNsaWRlciwgaXRlbXNJbmRleCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gLSBBcGxpY2EgZmlsdGVyIHRhZyBkYXMgY29uZmlndXJhw6fDtWVzIGUgY29uZGnDp8O1ZXNcbiAgdmFyIGZpbHRlckl0ZW1zID0gZnVuY3Rpb24gKHRhZykge1xuICAgIGlmICh0eXBlb2YgdGFnICE9PSAnc3RyaW5nJykgcmV0dXJuXG4gICAgaWYgKHRhZyAhPT0gJyonICYmIHRhZy5pbmRleE9mKCcuJykgIT09IDAgJiYgdGFnICE9PSAnJykge1xuICAgICAgdGFnID0gJy4nICsgdGFnO1xuICAgIH1cbiAgICBjb25maWcuZmlsdGVyLmFycmFuZ2UoeyBmaWx0ZXI6IHRhZyB9KVxuICB9XG5cbiAgdmFyIGFjdGl2ZUJ1dHRvbiA9IGZ1bmN0aW9uIChlbCkge1xuICAgIHZhciBpdGVtQWN0aXZlID0gJC5uYXYucXVlcnlTZWxlY3RvcignLicgKyBjb25maWcuYnV0dG9uQWN0aXZlQ2xhc3MpO1xuICAgIGlmIChpdGVtQWN0aXZlKSBpdGVtQWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmJ1dHRvbkFjdGl2ZUNsYXNzKTtcbiAgICBlbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5idXR0b25BY3RpdmVDbGFzcyk7XG4gICAgdXBkYXRlTGFiZWwoZWwuaW5uZXJIVE1MKTtcbiAgfTtcblxuICB2YXIgdXBkYXRlTGFiZWwgPSBmdW5jdGlvbiAobGFiZWwpIHtcbiAgICB2YXIgc3BhbiA9ICQudG9nZ2xlLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcbiAgICBzcGFuLmlubmVySFRNTCA9IGxhYmVsO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICBmaWx0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBjb25maWcuZmlsdGVyXG4gICAgfSxcbiAgICBydW46IHJ1bixcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBGaWx0ZXIgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtZmlsdGVyJykubGVuZ3RoKSB7XG4gICAgQnNGaWx0ZXIuaW5pdCgpO1xuICB9XG59KVxuIiwiLyoqXG4gKiBCYWNrIFRvIFRvcFxuICogU21vb3RoIHNjcm9sbCB0byB0b3Agb2YgdGhlIHBhZ2VcbiAqIEBsaW5rIGh0dHBzOi8vY29kZXBlbi5pby9RYnJpZC9wZW4vRWdBWU5nXG4gKi9cbnZhciBCc0Zvb3RlciA9IChmdW5jdGlvbiAoKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgaW50ZXJ2YWw6IG51bGwsXG4gICAgaXNNb2JpbGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJXaWR0aCA8IDc2ODtcbiAgICB9LFxuICAgIGRlZmF1bHRUaXRsZUhlaWdodDogNjAsXG4gICAgaW5pdGlhbGl6ZWQ6IGZhbHNlLFxuICAgIGl0ZW1zOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtZm9vdGVyLWFjY29yZGlvbi1pdGVtJyksXG4gICAgY29udGVudENsYXNzOiAnYnMtanMtZm9vdGVyLWFjY29yZGlvbi1pdGVtLS1jb250ZW50JyxcbiAgICB0aXRsZUNsYXNzOiAnYnMtanMtZm9vdGVyLWFjY29yZGlvbi1pdGVtLS10aXRsZScsXG4gICAgaXNPcGVuQ2xhc3M6ICdicy1mb290ZXItbmF2X19ncm91cC0taXMtb3BlbicsXG4gIH07XG5cbiAgLyoqXG4gICAqIEluaWNpYWxpemEgYSBmdW7Dp8Ojb1xuICAgKiBAcGFyYW0ge09iamVjdH0gZWwgYSBET00gZWxlbWVudFxuICAqL1xuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBoYW5kbGVCdWlsZERlc3Ryb3koKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgcmVzaXplVGltZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICBoYW5kbGVCdWlsZERlc3Ryb3koKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBoYW5kbGVCdWlsZERlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gZGVidWdnZXI7XG4gICAgLy8gQnVpbGQgbWVudSBhbmQgYWRkIGV2ZW50IGxpc3RlbmVyc1xuICAgIGlmIChjb25maWcuaXNNb2JpbGUoKSAmJiAhY29uZmlnLmluaXRpYWxpemVkKSB7XG4gICAgICBidWlsZCgpO1xuICAgIH0gZWxzZSBpZiAoIWNvbmZpZy5pc01vYmlsZSgpICYmIGNvbmZpZy5pbml0aWFsaXplZCkge1xuICAgICAgZGVzdHJveSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBldmVyeXRoaW5nJ3MgZmluZVxuICAgIH1cbiAgfTtcblxuICB2YXIgYnVpbGQgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gZGVidWdnZXI7XG4gICAgY29uZmlnLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5pdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIGFkanVzdEhlaWdodChpdGVtLCAnY29sbGFwc2UnKTtcbiAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGUpO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBkZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIGRlYnVnZ2VyO1xuICAgIGNvbmZpZy5pbml0aWFsaXplZCA9IGZhbHNlO1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgYWRqdXN0SGVpZ2h0KGl0ZW0pO1xuICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pc09wZW5DbGFzcyk7XG4gICAgICBpdGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgdG9nZ2xlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgdmFyIGl0ZW0gPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgIGlmICghaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmlzT3BlbkNsYXNzKSkge1xuICAgICAgb3BlbihpdGVtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2xvc2UoaXRlbSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvcGVuID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBhZGp1c3RIZWlnaHQoaXRlbSwgJ2V4cGFuZCcpO1xuICAgIGl0ZW0uY2xhc3NMaXN0LmFkZChjb25maWcuaXNPcGVuQ2xhc3MpO1xuICB9O1xuXG4gIHZhciBjbG9zZSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgYWRqdXN0SGVpZ2h0KGl0ZW0sICdjb2xsYXBzZScpO1xuICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaXNPcGVuQ2xhc3MpO1xuICB9O1xuXG4gIHZhciBhZGp1c3RIZWlnaHQgPSBmdW5jdGlvbiAoaXRlbSwgYWN0aW9uKSB7XG4gICAgdmFyIHRpdGxlID0gaXRlbS5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy50aXRsZUNsYXNzKTtcbiAgICB2YXIgdGl0bGVIZWlnaHQgPSAodGl0bGUgJiYgdGl0bGUub2Zmc2V0SGVpZ2h0KSB8fCBjb25maWcuZGVmYXVsdFRpdGxlSGVpZ2h0O1xuICAgIHZhciBpdGVtSGVpZ2h0ID0gaXRlbS5zY3JvbGxIZWlnaHQ7XG4gICAgaWYgKGFjdGlvbiA9PT0gJ2NvbGxhcHNlJykge1xuICAgICAgaXRlbS5zdHlsZS5oZWlnaHQgPSB0aXRsZUhlaWdodCArICdweCc7XG4gICAgfSBlbHNlIGlmIChhY3Rpb24gPT09ICdleHBhbmQnKSB7XG4gICAgICBpdGVtLnN0eWxlLmhlaWdodCA9IGl0ZW1IZWlnaHQgKyAncHgnO1xuICAgIH0gZWxzZSB7XG4gICAgICBpdGVtLnN0eWxlLmhlaWdodCA9ICcnO1xuICAgIH1cbiAgfTtcblxuICB2YXIgcmVzaXplVGltZXIgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICBjbGVhclRpbWVvdXQoY29uZmlnLmludGVydmFsKTtcbiAgICBjb25maWcuaW50ZXJ2YWwgPSBzZXRUaW1lb3V0KGNhbGxiYWNrLCAzMDApO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciBmb290ZXJMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWZvb3Rlci1hY2NvcmRpb24taXRlbScpO1xuXG4gIGlmIChmb290ZXJMaXN0Lmxlbmd0aCkge1xuICAgIEJzRm9vdGVyLmluaXQoKTtcbiAgfVxufSk7XG4iLCIvKipcbiAqIEJhY2sgVG8gVG9wXG4gKiBTbW9vdGggc2Nyb2xsIHRvIHRvcCBvZiB0aGUgcGFnZVxuICogQGxpbmsgaHR0cHM6Ly9jb2RlcGVuLmlvL1FicmlkL3Blbi9FZ0FZTmdcbiAqL1xudmFyIEJzRm9vdGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBpbnRlcnZhbDogbnVsbCxcbiAgICBpc01vYmlsZTogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHdpbmRvdy5pbm5lcldpZHRoIDwgNzY4O1xuICAgIH0sXG4gICAgZGVmYXVsdFRpdGxlSGVpZ2h0OiA2MCxcbiAgICBpbml0aWFsaXplZDogZmFsc2UsXG4gICAgaXRlbXM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1mb290ZXItYWNjb3JkaW9uLWl0ZW0nKSxcbiAgICBjb250ZW50Q2xhc3M6ICdicy1qcy1mb290ZXItYWNjb3JkaW9uLWl0ZW0tLWNvbnRlbnQnLFxuICAgIHRpdGxlQ2xhc3M6ICdicy1qcy1mb290ZXItYWNjb3JkaW9uLWl0ZW0tLXRpdGxlJyxcbiAgICBpc09wZW5DbGFzczogJ2JzLWZvb3Rlci1uYXZfX2dyb3VwLS1pcy1vcGVuJyxcbiAgfTtcblxuICAvKipcbiAgICogSW5pY2lhbGl6YSBhIGZ1bsOnw6NvXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlbCBhIERPTSBlbGVtZW50XG4gICovXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIGhhbmRsZUJ1aWxkRGVzdHJveSgpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICByZXNpemVUaW1lcihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGhhbmRsZUJ1aWxkRGVzdHJveSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIGhhbmRsZUJ1aWxkRGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBkZWJ1Z2dlcjtcbiAgICAvLyBCdWlsZCBtZW51IGFuZCBhZGQgZXZlbnQgbGlzdGVuZXJzXG4gICAgaWYgKGNvbmZpZy5pc01vYmlsZSgpICYmICFjb25maWcuaW5pdGlhbGl6ZWQpIHtcbiAgICAgIGJ1aWxkKCk7XG4gICAgfSBlbHNlIGlmICghY29uZmlnLmlzTW9iaWxlKCkgJiYgY29uZmlnLmluaXRpYWxpemVkKSB7XG4gICAgICBkZXN0cm95KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGV2ZXJ5dGhpbmcncyBmaW5lXG4gICAgfVxuICB9O1xuXG4gIHZhciBidWlsZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBkZWJ1Z2dlcjtcbiAgICBjb25maWcuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgYWRqdXN0SGVpZ2h0KGl0ZW0sICdjb2xsYXBzZScpO1xuICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZSk7XG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIGRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gZGVidWdnZXI7XG4gICAgY29uZmlnLmluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICBhZGp1c3RIZWlnaHQoaXRlbSk7XG4gICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlzT3BlbkNsYXNzKTtcbiAgICAgIGl0ZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGUpO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciB0b2dnbGUgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICB2YXIgaXRlbSA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgaWYgKCFpdGVtLmNsYXNzTGlzdC5jb250YWlucyhjb25maWcuaXNPcGVuQ2xhc3MpKSB7XG4gICAgICBvcGVuKGl0ZW0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjbG9zZShpdGVtKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9wZW4gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIGFkanVzdEhlaWdodChpdGVtLCAnZXhwYW5kJyk7XG4gICAgaXRlbS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pc09wZW5DbGFzcyk7XG4gIH07XG5cbiAgdmFyIGNsb3NlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBhZGp1c3RIZWlnaHQoaXRlbSwgJ2NvbGxhcHNlJyk7XG4gICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pc09wZW5DbGFzcyk7XG4gIH07XG5cbiAgdmFyIGFkanVzdEhlaWdodCA9IGZ1bmN0aW9uIChpdGVtLCBhY3Rpb24pIHtcbiAgICB2YXIgdGl0bGUgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJy4nICsgY29uZmlnLnRpdGxlQ2xhc3MpO1xuICAgIHZhciB0aXRsZUhlaWdodCA9ICh0aXRsZSAmJiB0aXRsZS5vZmZzZXRIZWlnaHQpIHx8IGNvbmZpZy5kZWZhdWx0VGl0bGVIZWlnaHQ7XG4gICAgdmFyIGl0ZW1IZWlnaHQgPSBpdGVtLnNjcm9sbEhlaWdodDtcblxuICAgIGlmIChhY3Rpb24gPT09ICdjb2xsYXBzZScpIHtcbiAgICAgIGl0ZW0uc3R5bGUuaGVpZ2h0ID0gdGl0bGVIZWlnaHQgKyAncHgnO1xuICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAnZXhwYW5kJykge1xuICAgICAgaXRlbS5zdHlsZS5oZWlnaHQgPSBpdGVtSGVpZ2h0ICsgJ3B4JztcbiAgICB9IGVsc2Uge1xuICAgICAgaXRlbS5zdHlsZS5oZWlnaHQgPSAnJztcbiAgICB9XG4gIH07XG5cbiAgdmFyIHJlc2l6ZVRpbWVyID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgY2xlYXJUaW1lb3V0KGNvbmZpZy5pbnRlcnZhbCk7XG4gICAgY29uZmlnLmludGVydmFsID0gc2V0VGltZW91dChjYWxsYmFjaywgMzAwKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gIH07XG59KCkpO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgZm9vdGVyTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1mb290ZXItYWNjb3JkaW9uLWl0ZW0nKTtcblxuICBpZiAoZm9vdGVyTGlzdC5sZW5ndGgpIHtcbiAgICBCc0Zvb3Rlci5pbml0KCk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBHYWxsZXJ5XG4gKiBAcmV0dXJuIE1vZHVsZSBjb25maWdcbiAqL1xudmFyIEJzR2FsbGVyeSA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7XG4gIHZhciBlbGVtID0gZWxlbWVudDtcbiAgdmFyIGNvbmZpZyA9IHt9O1xuXG4gIHZhciBzZXRDb25maWcgPSBmdW5jdGlvbiAoZWwpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZWw6IGVsLFxuICAgICAgbmF2SXRlbXM6IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1nYWxsZXJ5X190aHVtYicpLFxuICAgICAgaW1hZ2VzOiBlbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtZ2FsbGVyeV9faXRlbScpLFxuICAgICAgbmF2SXRlbUFjdGl2ZUNsYXNzOiAnYnMtZ2FsbGVyeV9fdGh1bWItLWFjdGl2ZScsXG4gICAgICBpbWFnZUFjdGl2ZUNsYXNzOiAnYnMtZ2FsbGVyeV9faXRlbS0tYWN0aXZlJyxcbiAgICAgIHBhZ1RvdGFsOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtZ2FsbGVyeV9fcGFnaW5hdGlvbi0tdG90YWwnKSxcbiAgICAgIHBhZ0NvdW50ZXI6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1nYWxsZXJ5X19wYWdpbmF0aW9uLS1jb3VudGVyJyksXG4gICAgICBuYXZJbmRleDogMCxcbiAgICAgIG5hdk1vbWVudDogMCxcbiAgICB9O1xuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghZWxlbSB8fCB0eXBlb2YgZWxlbSAhPT0gJ29iamVjdCcpIHJldHVybjtcbiAgICBjb25maWcgPSBzZXRDb25maWcoZWxlbSk7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5uYXZJdGVtcywgZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7XG5cbiAgICAgIC8vIHN1bSBpbmRleCwgYWZ0ZXIgZWFjaCAtIHByaW50IGRpdlxuICAgICAgY29uZmlnLm5hdkluZGV4ID0gaW5kZXggKyAxO1xuXG4gICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2V0SXRlbS5iaW5kKG51bGwsIGl0ZW0pKTtcblxuICAgIH0pO1xuXG4gICAgY29uZmlnLnBhZ1RvdGFsLmlubmVySFRNTCA9IGNvbmZpZy5uYXZJbmRleDtcbiAgfTtcblxuICB2YXIgc2V0SXRlbSA9IGZ1bmN0aW9uIChuYXZJdGVtKSB7XG4gICAgdmFyIHRhcmdldEluZGV4ID0gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChjb25maWcubmF2SXRlbXMsIG5hdkl0ZW0pO1xuICAgIHZhciBjdXJyZW50TmF2SXRlbUFjdGl2ZSA9IGNvbmZpZy5lbC5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5uYXZJdGVtQWN0aXZlQ2xhc3MpO1xuICAgIHZhciBjdXJyZW50SW1hZ2VBY3RpdmUgPSBjb25maWcuZWwucXVlcnlTZWxlY3RvcignLicgKyBjb25maWcuaW1hZ2VBY3RpdmVDbGFzcyk7XG5cbiAgICBjdXJyZW50TmF2SXRlbUFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5uYXZJdGVtQWN0aXZlQ2xhc3MpO1xuICAgIGN1cnJlbnRJbWFnZUFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbWFnZUFjdGl2ZUNsYXNzKTtcblxuICAgIG5hdkl0ZW0uY2xhc3NMaXN0LmFkZChjb25maWcubmF2SXRlbUFjdGl2ZUNsYXNzKTtcbiAgICBjb25maWcuaW1hZ2VzW3RhcmdldEluZGV4XS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbWFnZUFjdGl2ZUNsYXNzKTtcblxuICAgIC8vIHN1bSBpbmRleCAtIHByaW50IGRpdlxuICAgIGNvbmZpZy5uYXZNb21lbnQgPSB0YXJnZXRJbmRleCArIDE7XG4gICAgY29uZmlnLnBhZ0NvdW50ZXIuaW5uZXJIVE1MID0gY29uZmlnLm5hdk1vbWVudDtcblxuICAgIC8vIFBhdXNhIG9zIHbDrWRlb3MgcXVlIGVzdGVqYW0gcm9kYW5kbyBkZW50cm8gZG8gbW9kYWxcbiAgICBpZiAoY3VycmVudEltYWdlQWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJy5icy12aWRlbycpICYmIEJzWVRQbGF5ZXJzKSB7XG4gICAgICBCc1lUUGxheWVycy5nZXRQbGF5ZXIoY3VycmVudEltYWdlQWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJy5icy12aWRlbycpLmlkKS5zdG9wVmlkZW8oKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufTtcblxuLyoqXG4gKiBJbml0IEhlYWRlciBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgdmFyIGdhbGxlcmllcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1nYWxsZXJ5Jyk7XG4gIGlmIChnYWxsZXJpZXMubGVuZ3RoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChnYWxsZXJpZXMsIGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICB2YXIgZ2FsbGVyeSA9IEJzR2FsbGVyeShlbGVtZW50LCB7fSk7XG4gICAgICBnYWxsZXJ5LmluaXQoKTtcbiAgICB9KTtcbiAgfVxufSk7XG5cblxuXG5cblxuXG4vLyAvKipcbi8vICAqIEdhbGxlcnlcbi8vICAqIEByZXR1cm4gTW9kdWxlIGNvbmZpZ1xuLy8gICovXG4vLyB2YXIgQnNHYWxsZXJ5ID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMpIHtcbi8vICAgdmFyIGVsZW0gPSBlbGVtZW50O1xuLy8gICB2YXIgY29uZmlnID0ge307XG5cbi8vICAgdmFyIHNldENvbmZpZyA9IGZ1bmN0aW9uIChlbCkge1xuLy8gICAgIHJldHVybiB7XG4vLyAgICAgICBlbDogZWwsXG4vLyAgICAgICBuYXZJdGVtczogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWdhbGxlcnlfX3RodW1iJyksXG4vLyAgICAgICBuYXZJdGVtc1RodW1iOiBlbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtZ2FsbGVyeV9fbmF2JyksXG4vLyAgICAgICBpbWFnZXM6IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1nYWxsZXJ5X19pdGVtJyksXG4vLyAgICAgICBuYXZJdGVtQWN0aXZlQ2xhc3M6ICdicy1nYWxsZXJ5X190aHVtYi0tYWN0aXZlJyxcbi8vICAgICAgIGltYWdlQWN0aXZlQ2xhc3M6ICdicy1nYWxsZXJ5X19pdGVtLS1hY3RpdmUnLFxuLy8gICAgICAgcGFnVG90YWw6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1nYWxsZXJ5X19wYWdpbmF0aW9uLS10b3RhbCcpLFxuLy8gICAgICAgcGFnQ291bnRlcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWdhbGxlcnlfX3BhZ2luYXRpb24tLWNvdW50ZXInKSxcbi8vICAgICAgIG5hdkluZGV4OiAwLFxuLy8gICAgICAgbmF2TW9tZW50OiAwLFxuLy8gICAgIH07XG4vLyAgIH07XG5cbi8vICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG4vLyAgICAgaWYgKCFlbGVtIHx8IHR5cGVvZiBlbGVtICE9PSAnb2JqZWN0JykgcmV0dXJuO1xuLy8gICAgIGNvbmZpZyA9IHNldENvbmZpZyhlbGVtKTtcblxuLy8gICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLm5hdkl0ZW1zLCBmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHtcblxuLy8gICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNldEl0ZW0uYmluZChudWxsLCBpdGVtKSk7XG5cbi8vICAgICB9KTtcblxuLy8gICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLm5hdkl0ZW1zVGh1bWIsIGZ1bmN0aW9uIChpdGVtLCBpbmRleCkge1xuXG4vLyAgICAgICAvLyBzdW0gaW5kZXgsIGFmdGVyIGVhY2ggLSBwcmludCBkaXZcbi8vICAgICAgIGNvbmZpZy5uYXZJbmRleCA9IGluZGV4ICsgMTtcblxuLy8gICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNldEl0ZW1UaHVtYi5iaW5kKG51bGwsIGl0ZW0pKTtcblxuLy8gICAgIH0pO1xuXG4vLyAgICAgY29uZmlnLnBhZ1RvdGFsLmlubmVySFRNTCA9IGNvbmZpZy5uYXZJbmRleDtcbi8vICAgfTtcblxuLy8gICB2YXIgc2V0SXRlbSA9IGZ1bmN0aW9uIChuYXZJdGVtKSB7XG4vLyAgICAgdmFyIHRhcmdldEluZGV4ID0gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChjb25maWcubmF2SXRlbXMsIG5hdkl0ZW0pO1xuLy8gICAgIHZhciBjdXJyZW50TmF2SXRlbUFjdGl2ZSA9IGNvbmZpZy5lbC5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5uYXZJdGVtQWN0aXZlQ2xhc3MpO1xuLy8gICAgIHZhciBjdXJyZW50SW1hZ2VBY3RpdmUgPSBjb25maWcuZWwucXVlcnlTZWxlY3RvcignLicgKyBjb25maWcuaW1hZ2VBY3RpdmVDbGFzcyk7XG5cbi8vICAgICBjdXJyZW50TmF2SXRlbUFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5uYXZJdGVtQWN0aXZlQ2xhc3MpO1xuLy8gICAgIGN1cnJlbnRJbWFnZUFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbWFnZUFjdGl2ZUNsYXNzKTtcblxuLy8gICAgIG5hdkl0ZW0uY2xhc3NMaXN0LmFkZChjb25maWcubmF2SXRlbUFjdGl2ZUNsYXNzKTtcbi8vICAgICBjb25maWcuaW1hZ2VzW3RhcmdldEluZGV4XS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbWFnZUFjdGl2ZUNsYXNzKTtcblxuLy8gICAgIC8vIFBhdXNhIG9zIHbDrWRlb3MgcXVlIGVzdGVqYW0gcm9kYW5kbyBkZW50cm8gZG8gbW9kYWxcbi8vICAgICBpZiAoY3VycmVudEltYWdlQWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJy5icy12aWRlbycpKSB7XG4vLyAgICAgICBCc1lUUGxheWVycy5nZXRQbGF5ZXIoY3VycmVudEltYWdlQWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJy5icy12aWRlbycpLmlkKS5zdG9wVmlkZW8oKTtcbi8vICAgICB9XG4vLyAgIH07XG5cbi8vICAgdmFyIHNldEl0ZW1UaHVtYiA9IGZ1bmN0aW9uIChuYXZJdGVtKSB7XG4vLyAgICAgdmFyIHRhcmdldEluZGV4ID0gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChjb25maWcubmF2SXRlbXNUaHVtYiwgbmF2SXRlbSk7XG5cbi8vICAgICAvLyBzdW0gaW5kZXggLSBwcmludCBkaXZcbi8vICAgICBjb25maWcubmF2TW9tZW50ID0gdGFyZ2V0SW5kZXggKyAxO1xuLy8gICAgIGNvbmZpZy5wYWdDb3VudGVyLmlubmVySFRNTCA9IGNvbmZpZy5uYXZNb21lbnQ7XG4vLyAgIH07XG5cbi8vICAgcmV0dXJuIHtcbi8vICAgICBpbml0OiBpbml0LFxuLy8gICB9O1xuLy8gfTtcblxuLy8gLyoqXG4vLyAgKiBJbml0IEhlYWRlciBDb25zdHJ1Y3RvclxuLy8gICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbi8vICAqL1xuLy8gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbi8vICAgdmFyIGdhbGxlcmllcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1nYWxsZXJ5Jyk7XG4vLyAgIGlmIChnYWxsZXJpZXMubGVuZ3RoKSB7XG4vLyAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChnYWxsZXJpZXMsIGZ1bmN0aW9uIChlbGVtZW50KSB7XG4vLyAgICAgICB2YXIgZ2FsbGVyeSA9IEJzR2FsbGVyeShlbGVtZW50LCB7fSk7XG4vLyAgICAgICBnYWxsZXJ5LmluaXQoKTtcbi8vICAgICB9KTtcbi8vICAgfVxuLy8gfSk7XG4iLCIvKipcbiAqIEdyaWRcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgLyogR3JpZCBGaWx0ZXIgZHJvcGRvd24gKi9cbiAgdmFyIGdyaWRGb3JtYXRUb2dnbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtZ3JpZC10b2dnbGUtZm9ybWF0Jyk7XG4gIHZhciBkcm9wZG93blRvZ2dsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1ncmlkLXRvZ2dsZS1kcm9wZG93bicpO1xuICB2YXIgZ3JpZExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtZ3JpZF9fbGlzdCcpO1xuICB2YXIgZ3JpZERyb3Bkb3duID0gbmV3IEJzRHJvcGRvd24oKTtcbiAgdmFyIGdyaWRGb3JtYXRDbGFzc2VzID0ge1xuICAgIGdyaWQ6ICdicy1tZWRpYS0tY29sMycsXG4gICAgbGlzdDogJ2JzLW1lZGlhLS1ob3Jpem9udGFsIGJzLW1lZGlhLS1pbWFnZS1wcm9wLTEtNCBicy1tZWRpYS0taHInLFxuICB9O1xuXG4gIGlmIChkcm9wZG93blRvZ2dsZSkge1xuICAgIGdyaWREcm9wZG93bi5pbml0KGRyb3Bkb3duVG9nZ2xlLCB7XG4gICAgICBkcm9wZG93bkVsZW1lbnQ6IGRyb3Bkb3duVG9nZ2xlLnBhcmVudE5vZGUsXG4gICAgICBkcm9wZG93bkFjdGl2ZUNsYXNzOiAnYnMtaXMtZXhwYW5kZWQnLFxuICAgIH0pO1xuICB9XG5cbiAgaWYgKGdyaWRMaXN0ICYmIGdyaWRGb3JtYXRUb2dnbGUpIHtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGdyaWRGb3JtYXRUb2dnbGUsIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIHZhciB0eXBlID0gZXYuY3VycmVudFRhcmdldC52YWx1ZTtcbiAgICAgICAgZ3JpZExpc3QuY2xhc3NOYW1lID0gJ2JzLW1lZGlhIGJzLWdyaWRfX2xpc3QgJyArIGdyaWRGb3JtYXRDbGFzc2VzW3R5cGVdO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn0pO1xuIiwiLy8gLyoqXG4vLyAgKiBIZWFkZXJcbi8vICAqIEByZXR1cm4gTW9kdWxlIGNvbmZpZ1xuLy8gICovXG4vLyB2YXIgQnNIZWFkZXIgPSAoZnVuY3Rpb24gKCkge1xuLy8gICAvLyBDbGFzcyBNb2RpZmllcnNcbi8vICAgdmFyIG1vZENsYXNzID0ge1xuLy8gICAgIGhlYWRlckZpeGVkOiAnYnMtaGVhZGVyLS1maXhlZCcsXG4vLyAgICAgaGVhZGVyRmxvYXRpbmc6ICdicy1oZWFkZXItLWZsb2F0aW5nJyxcbi8vICAgICBoZWFkZXJBY2Nlc3NBY3RpdmU6ICdicy1oZWFkZXItLWFjY2Vzcy1vcGVuJyxcbi8vICAgICBhY2Nlc3NQYW5lbEFjdGl2ZTogJ2JzLWhlYWRlci1hY2Nlc3MtLW9wZW4nLFxuLy8gICAgIHRhYkFjdGl2ZTogJ2JzLXRhYnNfX2l0ZW0tLWFjdGl2ZScsXG4vLyAgICAgdGFiUGFuZWxBY3RpdmU6ICdicy10YWJzX19wYW5lbC0tYWN0aXZlJyxcbi8vICAgfTtcblxuLy8gICAvLyBET00gRWxlbWVudHNcbi8vICAgdmFyIGVsID0ge1xuLy8gICAgIGhlYWRlcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWhlYWRlcicpLFxuLy8gICAgIG5hdkxpbmtzOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtaGVhZGVyLWxpbmtzJyksXG4vLyAgICAgYWNjZXNzUGFuZWw6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1oZWFkZXItYWNjZXNzJyksXG4vLyAgICAgYWNjZXNzTW9kYWw6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1oZWFkZXItYWNjZXNzX19tb2RhbCcpLFxuLy8gICAgIGFjY2Vzc1RhYnM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy10YWJzJyksXG4vLyAgICAgYWNjZXNzVGFic05hdjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLXRhYnNfX25hdicpLFxuLy8gICAgIGFjY2Vzc1RhYnNJdGVtOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtdG9nZ2xlLXRhYicpLFxuLy8gICAgIGFjY2Vzc1RhYnNDb250YWluZXI6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy10YWJzX19jb250YWluZXInKSxcbi8vICAgICBhY2Nlc3NUYWJzUGFuZWw6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy10YWJzX19wYW5lbCcpLFxuLy8gICAgIC8vIFRyaWdnZXJzXG4vLyAgICAgYnRuVG9nZ2xlQWNjZXNzUGFuZWw6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy10b2dnbGUtYWNjZXNzLXBhbmVsJyksXG4vLyAgICAgYnRuQ2xvc2VBY2Nlc3NNb2RhbDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLWNsb3NlLWFjY2Vzcy1tb2RhbCcpLFxuLy8gICB9O1xuXG4vLyAgIC8qKlxuLy8gICAgKiBJbml0IGZ1bmN0aW9uXG4vLyAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBNb2R1bGUncyBzY29wZSBmdW5jdGlvbnNcbi8vICAgICovXG4vLyAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuLy8gICAgIC8vIFRvZ2dsZSBBY2Nlc3MgUGFuZWxcbi8vICAgICBpZiAoZWwuYnRuVG9nZ2xlQWNjZXNzUGFuZWwpIHtcbi8vICAgICAgIGVsLmJ0blRvZ2dsZUFjY2Vzc1BhbmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgX3RvZ2dsZUFjY2Vzc1BhbmVsKTtcbi8vICAgICB9XG5cbi8vICAgICAvLyBDbG9zZSBBY2Nlc3MgUGFuZWwgTW9iaWxlIChNb2RhbClcbi8vICAgICBpZiAoZWwuYnRuQ2xvc2VBY2Nlc3NNb2RhbCkge1xuLy8gICAgICAgZWwuYnRuQ2xvc2VBY2Nlc3NNb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIF9jbG9zZUFjY2Vzc1BhbmVsKTtcbi8vICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuLy8gICAgICAgICBpZiAoXG4vLyAgICAgICAgICAgIWVsLmFjY2Vzc1RhYnMuY29udGFpbnMoZXZlbnQudGFyZ2V0KSAmJlxuLy8gICAgICAgICAgICFlbC5idG5Ub2dnbGVBY2Nlc3NQYW5lbC5jb250YWlucyhldmVudC50YXJnZXQpKSB7XG4vLyAgICAgICAgICAgX2Nsb3NlQWNjZXNzUGFuZWwoKTtcbi8vICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4vLyAgICAgICAgIH1cbi8vICAgICAgIH0pO1xuLy8gICAgIH1cblxuLy8gICAgIC8vIENoYW5nZSBBY2Nlc3MgUGFuZWwgVGFic1xuLy8gICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWwuYWNjZXNzVGFic0l0ZW0ubGVuZ3RoOyBpICs9IDEpIHtcbi8vICAgICAgIGVsLmFjY2Vzc1RhYnNJdGVtW2ldLmFkZEV2ZW50TGlzdGVuZXIoXG4vLyAgICAgICAgICdjbGljaycsXG4vLyAgICAgICAgIF9jaGFuZ2VUYWIuYmluZChudWxsLCBlbC5hY2Nlc3NUYWJzSXRlbVtpXSlcbi8vICAgICAgICk7XG4vLyAgICAgfVxuXG4vLyAgICAgLy8gU2V0IGZsb2F0aW5nIGNsYXNzIHRvIGhlYWVyXG4vLyAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIF9zZXRIZWFkZXJGbG9hdGluZyk7XG4vLyAgIH07XG5cbi8vICAgdmFyIF90b2dnbGVBY2Nlc3NQYW5lbCA9IGZ1bmN0aW9uICgpIHtcbi8vICAgICB2YXIgYWNjZXNzSXNBY3RpdmUgPSAoXG4vLyAgICAgICAhZWwuaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucyhtb2RDbGFzcy5oZWFkZXJBY2Nlc3NBY3RpdmUpIHx8XG4vLyAgICAgICAhZWwuYWNjZXNzUGFuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKG1vZENsYXNzLmFjY2Vzc1BhbmVsQWN0aXZlKVxuLy8gICAgICk7XG4vLyAgICAgaWYgKGFjY2Vzc0lzQWN0aXZlKSBfb3BlbkFjY2Vzc1BhbmVsKCk7XG4vLyAgICAgZWxzZSBfY2xvc2VBY2Nlc3NQYW5lbCgpO1xuLy8gICB9O1xuXG4vLyAgIHZhciBfb3BlbkFjY2Vzc1BhbmVsID0gZnVuY3Rpb24gKCkge1xuLy8gICAgIGVsLmhlYWRlci5jbGFzc0xpc3QuYWRkKG1vZENsYXNzLmhlYWRlckFjY2Vzc0FjdGl2ZSk7XG4vLyAgICAgZWwuYWNjZXNzUGFuZWwuY2xhc3NMaXN0LmFkZChtb2RDbGFzcy5hY2Nlc3NQYW5lbEFjdGl2ZSk7XG4vLyAgIH07XG5cbi8vICAgdmFyIF9jbG9zZUFjY2Vzc1BhbmVsID0gZnVuY3Rpb24gKCkge1xuLy8gICAgIGVsLmhlYWRlci5jbGFzc0xpc3QucmVtb3ZlKG1vZENsYXNzLmhlYWRlckFjY2Vzc0FjdGl2ZSk7XG4vLyAgICAgZWwuYWNjZXNzUGFuZWwuY2xhc3NMaXN0LnJlbW92ZShtb2RDbGFzcy5hY2Nlc3NQYW5lbEFjdGl2ZSk7XG4vLyAgIH07XG5cbi8vICAgdmFyIF9jaGFuZ2VUYWIgPSBmdW5jdGlvbiAodGFiQWN0aXZlKSB7XG4vLyAgICAgdmFyIHRhYkluZGV4ID0gW10uc2xpY2UuY2FsbCh0YWJBY3RpdmUucGFyZW50Tm9kZS5jaGlsZHJlbikuaW5kZXhPZih0YWJBY3RpdmUpO1xuXG4vLyAgICAgLy8gQ2xlYW4gYWN0aXZlIHRhYiBjbGFzc1xuLy8gICAgIGVsLmFjY2Vzc1RhYnNOYXYucXVlcnlTZWxlY3RvcignLicgKyBtb2RDbGFzcy50YWJBY3RpdmUpXG4vLyAgICAgICAuY2xhc3NMaXN0LnJlbW92ZShtb2RDbGFzcy50YWJBY3RpdmUpO1xuXG4vLyAgICAgLy8gU2V0IGFjdGl2ZSBjbGFzcyB0byBjbGlja2VkIHRhYlxuLy8gICAgIHRhYkFjdGl2ZS5jbGFzc0xpc3QuYWRkKG1vZENsYXNzLnRhYkFjdGl2ZSk7XG5cbi8vICAgICAvLyBDbGVhbiBhY3RpdmUgdGFicycgcGFuZWwgY2xhc3Ncbi8vICAgICBlbC5hY2Nlc3NUYWJzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy4nICsgbW9kQ2xhc3MudGFiUGFuZWxBY3RpdmUpXG4vLyAgICAgICAuY2xhc3NMaXN0LnJlbW92ZShtb2RDbGFzcy50YWJQYW5lbEFjdGl2ZSk7XG5cbi8vICAgICAvLyBTZXQgYWN0aXZlIGNsYXNzIHRvIHBhbmVsIHRoYXQgcmVmZXJzIHRvIHRhYiBjbGlja2VkXG4vLyAgICAgZWwuYWNjZXNzVGFic1BhbmVsW3RhYkluZGV4XS5jbGFzc0xpc3QuYWRkKG1vZENsYXNzLnRhYlBhbmVsQWN0aXZlKTtcbi8vICAgfTtcblxuLy8gICB2YXIgX3NldEhlYWRlckZsb2F0aW5nID0gZnVuY3Rpb24gKCkge1xuLy8gICAgIGlmIChfd2luZG93U2Nyb2xsRGlyZWN0aW9uKCkgPT09ICdkb3duJykgZWwuaGVhZGVyLmNsYXNzTGlzdC5hZGQobW9kQ2xhc3MuaGVhZGVyRmxvYXRpbmcpO1xuLy8gICAgIGVsc2UgZWwuaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUobW9kQ2xhc3MuaGVhZGVyRmxvYXRpbmcpO1xuLy8gICB9O1xuXG4vLyAgIHZhciBfd2luZG93U2Nyb2xsRGlyZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuLy8gICAgIHZhciBsYXN0U2Nyb2xsVG9wID0gMDtcbi8vICAgICB2YXIgY3VycmVudFBvc2l0aW9uID0gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XG4vLyAgICAgdmFyIGRpcmVjdGlvbiA9ICcnO1xuXG4vLyAgICAgLy8gZG93blxuLy8gICAgIGlmIChjdXJyZW50UG9zaXRpb24gPiBsYXN0U2Nyb2xsVG9wKSB7XG4vLyAgICAgICBkaXJlY3Rpb24gPSAnZG93bic7XG4vLyAgICAgLy8gdXBcbi8vICAgICB9IGVsc2Uge1xuLy8gICAgICAgZGlyZWN0aW9uID0gJ3VwJztcbi8vICAgICB9XG5cbi8vICAgICBsYXN0U2Nyb2xsVG9wID0gY3VycmVudFBvc2l0aW9uO1xuXG4vLyAgICAgcmV0dXJuIGRpcmVjdGlvbjtcbi8vICAgfTtcblxuLy8gICByZXR1cm4ge1xuLy8gICAgIGluaXQ6IGluaXQsXG4vLyAgIH07XG4vLyB9KCkpO1xuXG4vLyAvKipcbi8vICAqIEluaXQgSGVhZGVyIENvbnN0cnVjdG9yXG4vLyAgKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuLy8gICovXG4vLyBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuLy8gICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWhlYWRlcicpKSB7XG4vLyAgICAgQnNIZWFkZXIuaW5pdCgpO1xuLy8gICB9XG4vLyB9KTtcbiIsIi8qKlxuICogQnMgSGVhZGVyXG4gKlxuICogW1RPRE9dOiBSZWZhdG9yYXIgcGFyYSBxdWUgb3MgZWxlbWVudG9zIGRvIGNvbmZpZyByZWZlcmVuY2llbSB1bSBjb21wb25lbnRlXG4gKiBoZWFkZXIgZXNwZWPDrWZpY28gYW8gaW52w6lzIGRlIHBlZ2FyIHRvZG9zIG9zIGV4aXN0ZW50ZXMgbm8gZG9jdW1lbnRvLlxuICovXG52YXIgQnNIZWFkZXIgPSAoZnVuY3Rpb24gKCkge1xuICAvLyBDb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBoZWFkZXJDb250YWluZXI6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1oZWFkZXJfX2NvbnRhaW5lcicpLFxuICAgIGhhc1RyYW5zcGFyZW5jeUNsYXNzOiAnYnMtanMtaGVhZGVyLWhhcy10cmFuc3BhcmVuY3knLFxuICAgIGhlYWRlcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWhlYWRlcicpLFxuICAgIGhlYWRlclRvcDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWhlYWRlcl9fdG9wJyksXG4gICAgaGVhZGVyTWFpbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWhlYWRlcl9fbWFpbicpLFxuICAgIGhlYWRlckZsb2F0aW5nQ2xhc3M6ICdicy1oZWFkZXItLWZsb2F0aW5nJyxcbiAgICBoZWFkZXJQaW5uZWRDbGFzczogJ2JzLWhlYWRlci0tcGlubmVkJyxcbiAgICBoZWFkZXJGcmVlemVDbGFzczogJ2JzLWhlYWRlci0tZnJlZXplZCcsXG4gICAgaGVhZGVyVG9wUG9zaXRpb25Ub0Zsb2F0OiAwLFxuICAgIGhlYWRlclRvcFBvc2l0aW9uVG9QaW46IDExMCxcbiAgICBoZWFkZXJUb3BQb3NpdGlvblRvVHJhbnNwYXJlbmN5OiAwLFxuICAgIGhlYWRlclRyYW5zcGFyZW50Q2xhc3M6ICdicy1oZWFkZXItLXRyYW5zcGFyZW50JyxcbiAgICBoZWFkZXJVbnBpbm5lZENsYXNzOiAnYnMtaGVhZGVyLS11bnBpbm5lZCcsXG4gICAgaXNGaXhlZENsYXNzOiAnYnMtaGVhZGVyLS1maXhlZCcsXG4gICAgaXNTdGF0aWNDbGFzczogJ2JzLWhlYWRlci0tc3RhdGljJyxcbiAgICBzY3JvbGxUb3BQb3NpdGlvbjogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgIH0sXG4gICAgc2Nyb2xsRGlyZWN0aW9uOiAwLFxuICAgIGxhc3RTY3JvbGxUb3A6IDAsXG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gU2V0IGhlYWRlciB0cmFuc3BhcmVudCBvbiBob21lIHBhZ2UgbG9hZFxuICAgIHNldEhlYWRlclRyYW5zcGFyZW50KCk7XG5cbiAgICBpZiAoY29uZmlnLmhlYWRlci5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmlzU3RhdGljQ2xhc3MpKSByZXR1cm47XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGhlYWRlcl9lbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtaGVhZGVyJyk7XG4gICAgICBpZiAoKFwiIFwiICsgaGVhZGVyX2VsbS5wYXJlbnROb2RlLmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIikuaW5kZXhPZihcIiBicy1yZWZhY3RvciBcIikgPT0gLTEgKSB7XG4gICAgICAgIHNldEhlYWRlclBpbm5lZCgpO1xuICAgICAgICBzZXRIZWFkZXJGbG9hdGluZygpO1xuICAgICAgICBzZXRIZWFkZXJUcmFuc3BhcmVudCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIHZhciBzZXRIZWFkZXJGbG9hdGluZyA9IGZ1bmN0aW9uIChmb3JjZSkge1xuXG4gICAgaWYgKGlzRnJlZXplZCgpKSByZXR1cm47XG5cbiAgICBpZiAodHlwZW9mIGZvcmNlID09PSAndW5kZWZpbmVkJykgZm9yY2UgPSBmYWxzZTtcbiAgICB2YXIgaGVhZGVySGVpZ2h0ID0gY29uZmlnLmhlYWRlck1haW4ub2Zmc2V0SGVpZ2h0ICsgY29uZmlnLmhlYWRlclRvcC5vZmZzZXRIZWlnaHQ7XG4gICAgaWYgKGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpID4gY29uZmlnLmhlYWRlclRvcFBvc2l0aW9uVG9GbG9hdCB8fCBmb3JjZSkge1xuICAgICAgYWRqdXN0Qm9keU1hcmdpbihoZWFkZXJIZWlnaHQpO1xuICAgICAgY29uZmlnLmhlYWRlci5jbGFzc0xpc3QuYWRkKGNvbmZpZy5oZWFkZXJGbG9hdGluZ0NsYXNzKTtcbiAgICB9IGVsc2UgaWYgKGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpIDwgMSkge1xuICAgICAgYWRqdXN0Qm9keU1hcmdpbigwKTtcbiAgICAgIGNvbmZpZy5oZWFkZXIuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaGVhZGVyRmxvYXRpbmdDbGFzcyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBzZXRIZWFkZXJQaW5uZWQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICBpZiAoaXNGcmVlemVkKCkpIHJldHVybjtcblxuICAgIGlmIChjb25maWcuc2Nyb2xsVG9wUG9zaXRpb24oKSA+IGNvbmZpZy5oZWFkZXJUb3BQb3NpdGlvblRvUGluKSB7XG4gICAgICBpZiAoQnNTZWFyY2hGb3JtLmlzT3BlbigpIHx8IEJzU2VhcmNoRm9ybS5oYXNGb2N1cygpKSByZXR1cm47XG4gICAgICBpZiAoZ2V0U2Nyb2xsRGlyZWN0aW9uKCkgPT09ICdkb3duJykge1xuICAgICAgICBjb25maWcuaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmhlYWRlclBpbm5lZENsYXNzKTtcbiAgICAgICAgY29uZmlnLmhlYWRlci5jbGFzc0xpc3QuYWRkKGNvbmZpZy5oZWFkZXJVbnBpbm5lZENsYXNzKTtcbiAgICAgICAgQnNTZWFyY2hGb3JtLmNsb3NlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25maWcuaGVhZGVyLmNsYXNzTGlzdC5hZGQoY29uZmlnLmhlYWRlclBpbm5lZENsYXNzKTtcbiAgICAgICAgY29uZmlnLmhlYWRlci5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5oZWFkZXJVbnBpbm5lZENsYXNzKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uZmlnLmhlYWRlci5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5oZWFkZXJVbnBpbm5lZENsYXNzKTtcblxuICAgICAgaWYgKGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpID4gMCkge1xuICAgICAgICBjb25maWcuaGVhZGVyLmNsYXNzTGlzdC5hZGQoY29uZmlnLmhlYWRlclBpbm5lZENsYXNzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbmZpZy5oZWFkZXIuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaGVhZGVyUGlubmVkQ2xhc3MpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICB2YXIgc2V0SGVhZGVyVW5waW5uZWQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICBpZiAoaXNGcmVlemVkKCkpIHJldHVybjtcblxuICAgIGNvbmZpZy5oZWFkZXIuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaGVhZGVyUGlubmVkQ2xhc3MpO1xuICAgIGNvbmZpZy5oZWFkZXIuY2xhc3NMaXN0LmFkZChjb25maWcuaGVhZGVyVW5waW5uZWRDbGFzcyk7XG4gIH07XG5cbiAgdmFyIHNldEhlYWRlckZyZWV6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25maWcuaGVhZGVyLmNsYXNzTGlzdC5hZGQoY29uZmlnLmhlYWRlckZyZWV6ZUNsYXNzKTtcbiAgfTtcblxuICB2YXIgdW5zZXRIZWFkZXJGcmVlemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgY29uZmlnLmhlYWRlci5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5oZWFkZXJGcmVlemVDbGFzcyk7XG4gIH07XG5cblxuICB2YXIgc2V0SGVhZGVyVHJhbnNwYXJlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFoZWFkZXJIYXNUcmFuc3BhcmVuY3koKSkgcmV0dXJuO1xuICAgIGlmIChcbiAgICAgIGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpID09PSAwIHx8XG4gICAgICBjb25maWcuc2Nyb2xsVG9wUG9zaXRpb24oKSA8IGNvbmZpZy5oZWFkZXJUb3BQb3NpdGlvblRvVHJhbnNwYXJlbmN5KSB7XG4gICAgICBjb25maWcuaGVhZGVyLmNsYXNzTGlzdC5hZGQoY29uZmlnLmhlYWRlclRyYW5zcGFyZW50Q2xhc3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25maWcuaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmhlYWRlclRyYW5zcGFyZW50Q2xhc3MpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgZ2V0U2Nyb2xsRGlyZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIGRvd25cbiAgICBpZiAoY29uZmlnLnNjcm9sbFRvcFBvc2l0aW9uKCkgPiBjb25maWcubGFzdFNjcm9sbFRvcCkge1xuICAgICAgY29uZmlnLnNjcm9sbERpcmVjdGlvbiA9ICdkb3duJztcbiAgICAvLyB1cFxuICAgIH0gZWxzZSBpZiAoY29uZmlnLnNjcm9sbFRvcFBvc2l0aW9uKCkgPT09IGNvbmZpZy5sYXN0U2Nyb2xsVG9wKSB7XG4gICAgICAvLyBjb25maWcuc2Nyb2xsRGlyZWN0aW9uID0gJyc7XG4gICAgfSBlbHNlIGlmIChjb25maWcuc2Nyb2xsVG9wUG9zaXRpb24oKSA8IGNvbmZpZy5sYXN0U2Nyb2xsVG9wKSB7XG4gICAgICBjb25maWcuc2Nyb2xsRGlyZWN0aW9uID0gJ3VwJztcbiAgICB9XG5cbiAgICBjb25maWcubGFzdFNjcm9sbFRvcCA9IGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpO1xuXG4gICAgcmV0dXJuIGNvbmZpZy5zY3JvbGxEaXJlY3Rpb247XG4gIH07XG5cbiAgdmFyIGlzRnJlZXplZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY29uZmlnLmhlYWRlci5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmhlYWRlckZyZWV6ZUNsYXNzKTtcbiAgfTtcblxuICB2YXIgaXNIZWFkZXJGbG9hdGluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY29uZmlnLmhlYWRlci5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmhlYWRlckZsb2F0aW5nQ2xhc3MpO1xuICB9O1xuXG4gIHZhciBoZWFkZXJIYXNUcmFuc3BhcmVuY3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5oYXNUcmFuc3BhcmVuY3lDbGFzcylcbiAgICAgIHx8IGNvbmZpZy5oZWFkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5oYXNUcmFuc3BhcmVuY3lDbGFzcylcbiAgICApO1xuICB9O1xuXG4gIHZhciBoZWFkZXJJc0ZpeGVkID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjb25maWcuaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucyhjb25maWcuaXNGaXhlZENsYXNzKTtcbiAgfTtcblxuICB2YXIgYWRqdXN0Qm9keU1hcmdpbiA9IGZ1bmN0aW9uIChtYXJnaW4pIHtcbiAgICBpZiAoY29uZmlnLmhlYWRlckNvbnRhaW5lcikge1xuICAgICAgaWYgKCFoZWFkZXJJc0ZpeGVkKCkgJiYgIWhlYWRlckhhc1RyYW5zcGFyZW5jeSgpICYmIG1hcmdpbikge1xuICAgICAgICBjb25maWcuaGVhZGVyQ29udGFpbmVyLnN0eWxlLmhlaWdodCA9IG1hcmdpbiArICdweCc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25maWcuaGVhZGVyQ29udGFpbmVyLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCFoZWFkZXJJc0ZpeGVkKCkpIHtcbiAgICAgIC8vIGRlcHJlY2F0ZWRcbiAgICAgIC8vIGhlYWRlciBtdXN0IGFsd2F5cyBoYXZlIGEgY29udGFpbmVyIGVsZW1lbnRcbiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUubWFyZ2luVG9wID0gbWFyZ2luICsgJ3B4JztcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICAgIGVsOiBjb25maWcuaGVhZGVyLFxuICAgIGlzRmxvYXRpbmc6IGlzSGVhZGVyRmxvYXRpbmcsXG4gICAgc2V0SGVhZGVyRmxvYXRpbmc6IHNldEhlYWRlckZsb2F0aW5nLFxuICAgIHNldFVucGlubmVkOiBzZXRIZWFkZXJVbnBpbm5lZCxcbiAgICBzZXRGcmVlemU6IHNldEhlYWRlckZyZWV6ZSxcbiAgICB1bnNldEZyZWV6ZTogdW5zZXRIZWFkZXJGcmVlemUsXG4gICAgaGVhZGVyUGlubmVkOiBjb25maWcuaGVhZGVyUGlubmVkQ2xhc3MsXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgSGVhZGVyIENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWhlYWRlcicpLmxlbmd0aCkge1xuICAgIEJzSGVhZGVyLmluaXQoKTtcbiAgfVxufSk7XG4iLCIvKiBKUyBOb3ZvIE1lbnUgaW5zdGl0dWNpb25hbCAqL1xudmFyIEJTSGVhZGVyTmV3ID0gKGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBoZWFkZXIgPSBbXTtcblxuICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIGhlYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1oZWFkZXJcIik7IC8vIC0tLSBlbGVtOiBoZWFkZXJcbiAgICAgICAgYnRuX21lbnVfZHJvcGRvd24gPSBoZWFkZXJbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImRyb3Bkb3duXCIpOyAvLyAtLS0gZWxlbTogbWVudSBwcmluY2lwYWwsIG9ww6fDtWVzIGNvbSBkcm9wZG93blxuICAgICAgICBidG5fbWVudV9kcm9wZG93bl9zdWJtZW51cyA9IGhlYWRlclswXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtb3B0aW9uLW1haW4tbWVudVwiKTsgLy8gLS0tIGVsZW06IG1lbnUgcHJpbmNpcGFsLCBzdWJtZW51c1xuICAgICAgICBidG5fbWVudV9tb2JpbGUgPSBoZWFkZXJbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW1vYmlsZS1oZWFkZXItbWFpbi1tZW51XCIpWzBdOyAvLyAtLS0gZWxlbTogbWVudSBwcmluY2lwYWwgaGFtYnVyZ2VyXG4gICAgICAgIGJ0bl9tZW51X2J1c2NhciA9IGhlYWRlclswXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtaGVhZGVyLWJ1c2NhclwiKTsgLy8gLS0tIGVsZW06IGJvdMOjbyBMdXNjYXJcbiAgICAgICAgbWVudV9pY29fc2VhcmNoID0gaGVhZGVyWzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJpY29uLW5hdi1idXNjYVwiKTsgLy8gLS0tIGVsZW06IGJvdMOjbyBMdXNjYXJcbiAgICAgICAgYnRuX21lbnVfbG9naW4gPSBoZWFkZXJbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLWJ1dHRvbi0tbG9naW5cIik7IC8vIC0tLSBlbGVtOiBib3TDo28gTG9naW5cblxuICAgICAgICAvLyBWZXJpZmljYSBxdWFsIGJyb3dzZXIgZSBxdWFsIHRpcG8gZGUgZGlzcG9zaXRpdm8gZXN0w6EgYWNlc3NhbmRvO1xuICAgICAgICBjaGtCcm93c2VyKCk7XG4gICAgICAgIGNoa0RldmljZShoZWFkZXIpO1xuXG4gICAgICAgIC8vIEluaWNpYWxpemFyIGNvbXBvcnRhbWVudG8gZG8gU2Nyb2xsIGNhc28gbyBtZW51IHNlamEgbW9iaWxlXG4gICAgICAgIHNjcm9sbEhlYWRlckN0cmwoKTtcblxuICAgICAgICAvLyBBw6fDo28gYm90w7VlcyBtZW51IHByaW5jaXBhbCAoRGVza3RvcClcblxuICAgICAgICAgIGJ0bl9tZW51X2Ryb3Bkb3duWzBdLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7IC8vIEZlY2hhciB0b2RvcyBvcyBtZW51cyBxdWFuZG8gbyBzaGlmdCt0YWIgZm9yIGV4ZWN1dGFkbyBuYSBwcmltZWlyYSBvcMOnw6NvXG4gICAgICAgICAgICAgIGlmIChlLndoaWNoID09PSA5ICYmIGUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgIGNsb3NlQWxsTWVudXMoaGVhZGVyKTtcbiAgICAgICAgICAgICAgICAgIHJlbW92ZUhlYWRlck92ZXJsYXkoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIGZvcihpID0gMDsgaTwgYnRuX21lbnVfZHJvcGRvd24ubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICBidG5fbWVudV9kcm9wZG93bltpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgICAgICAgICAgICAvLyBWZXJpZmljYXIgbyB0aXBvIGRlIGRpc3Bvc2l0aXZvIGVzdMOhIGFjZXNzYW5kb1xuICAgICAgICAgICAgICAgIHZhciBpc01vYmlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJoZWFkZXItbW9iaWxlXCIpO1xuICAgICAgICAgICAgICAgIGlmIChpc01vYmlsZS5sZW5ndGggPT0gMCkgeyAvLyBEZXNrdG9wXG4gICAgICAgICAgICAgICAgICAgIHZhciBvcHRpb25fbWVudV9kcm9wZG93biA9IHRoaXMucGFyZW50Tm9kZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwibWVudVwiKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBWZXJpZmljYSBvIGVzdGFkbyBhdHVhbCBkbyBtZW51IHBhcmEgZGV0ZXJtaW5hciBzZSBkZXZlIGFicmktbG8gb3UgZmVjaGEtbG9cbiAgICAgICAgICAgICAgICAgICAgaWYgKChcIiBcIiArIG9wdGlvbl9tZW51X2Ryb3Bkb3duWzBdLmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIikuaW5kZXhPZihcIiBvcGVuIFwiKSA+IC0xKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZlY2hhIG1lbnUgc2VsZWNpb25hZG9cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LnJlbW92ZShcImlzLW9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25fbWVudV9kcm9wZG93blswXS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZUhlYWRlckV4cGFuZGVkKGhlYWRlcik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBPdmVybGF5IGRvIGhlYWRlclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlSGVhZGVyT3ZlcmxheSgpO1xuICAgICAgICAgICAgICAgICAgICB9ICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZlY2hhIHRvZG9zIG9zIG1lbnVzIGF0dWFsbWVudGUgYWJlcnRvc1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VBbGxNZW51cyhoZWFkZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgT3ZlcmxheSBkbyBoZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUhlYWRlck92ZXJsYXkoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWJyZSBtZW51IHNlbGVjaW9uYWRvXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5hZGQoXCJpcy1vcGVuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uX21lbnVfZHJvcGRvd25bMF0uY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2dnbGVIZWFkZXJFeHBhbmRlZChoZWFkZXIsIFwiZXhwYW5kXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1NlIGZvciB1bHRpbW8gaXRlbSBuZXZhZ2FkbywgZmVjaGEgbWVudVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1zRWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5icy1yZWZhY3RvciAuYnMtaGVhZGVyIC5icy1oZWFkZXJfX2V4cC1jb250ZW50IC5tZW51Lm9wZW4gYVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZW51RWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2EuYnMtaGVhZGVyLW1lbnUtb3B0aW9uOm5vdCguYnMtaGVhZGVyLWJ1c2NhciknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZW51Q3VycmVudEVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdhLmJzLWhlYWRlci1tZW51LW9wdGlvbi5pcy1vcGVuJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpPTA7IGkgPCBpdGVtc0Vscy5sZW5ndGg7IGkrKyl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNFbHNbaV0uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGUpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudEl0ZW0gPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpcnN0SXRlbSA9IGl0ZW1zRWxzWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RJdGVtID0gaXRlbXNFbHNbaXRlbXNFbHMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudEVsZW1Qb3MgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDYXB0dXJhIHF1YWwgw6kgYSBwb3Npw6dhbyBkbyBlbGVtZW50byBxdWUgZXN0w6EgYWJlcnRvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1lbnVFbGVtLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1lbnVDdXJyZW50RWxlbSA9PSBtZW51RWxlbVtpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RWxlbVBvcyA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS53aGljaCA9PT0gOSAmJiBlLnNoaWZ0S2V5KSB7IC8vIENhcHR1cmEgU2hpZnQgKyBUYWJcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50SXRlbSA9PSBmaXJzdEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJTaGlmdCArIFRhYjogcHJpbWVpcm8gaXRlbVwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudEVsZW1Qb3MgPT0gMCkgeyAvLyBDb21wb3J0YW1lbnRvIHF1YW5kbyBmb3IgbyBwcmltZWlybyBpdGVtIGRvIG1lbnUgKGZvY2FyIG5hIGxvZ28gZGEgQlMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZUFsbE1lbnVzKGhlYWRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVIZWFkZXJPdmVybGF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKFwiIFwiICsgbWVudUVsZW1bY3VycmVudEVsZW1Qb3MtMV0uY2xhc3NOYW1lICsgXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csIFwiIFwiKS5pbmRleE9mKFwiIGRyb3Bkb3duIFwiKSA+IC0xKSB7IC8vIENvbXBvcnRhbWVudG8gcXVhbmRvIG8gaXRlbSBhbnRlcmlvciBmb3IgdW1hIGRyb3Bkb3duICh0cmF6ZXIgYWJlcnRvKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVudUVsZW1bY3VycmVudEVsZW1Qb3NdLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyAvLyBOZWNlc3PDoXJpbyBwYXJhIHByZXZpbmlyIHF1ZSBvIGZvY28gdsOhIHBhcmEgbyBpdGVtIGRvIHN1Ym1lbnVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZUFsbE1lbnVzKGhlYWRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlSGVhZGVyT3ZlcmxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbnVFbGVtW2N1cnJlbnRFbGVtUG9zLTFdLmNsaWNrKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7IC8vIENvbXBvcnRhbWVudG8gcXVhbmRvIG8gaXRlbSBhdGVyaW9yIG7Do28gZm9yIGRyb3Bkb3duIChmZWNoYXIgb3MgbWVudXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW51RWxlbVtjdXJyZW50RWxlbVBvc10uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlQWxsTWVudXMoaGVhZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUhlYWRlck92ZXJsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLndoaWNoID09PSA5KSB7IC8vIENhcHR1cmEgYXBlbmFzIFRhYlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRJdGVtID09IGxhc3RJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiVGFiOiDDumx0aW1vIGl0ZW1cIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChcIiBcIiArIG1lbnVFbGVtW2N1cnJlbnRFbGVtUG9zKzFdLmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIikuaW5kZXhPZihcIiBkcm9wZG93biBcIikgPiAtMSkgeyAvLyBBYnJpciBhIGRyb3Bkb3duIHNlIG8gcHLDs3hpbW8gbWVudSBmb3IgdW1hIGRyb3Bkb3duXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW51RWxlbVtjdXJyZW50RWxlbVBvcysxXS5jbGljaygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VBbGxNZW51cyhoZWFkZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlSGVhZGVyT3ZlcmxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGNpb25hIE92ZXJsYXkgZG8gaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRIZWFkZXJPdmVybGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7IC8vIE1vYmlsZVxuICAgICAgICAgICAgICAgICAgICB2YXIgYWxsX21lbnVfb3B0aW9ucyA9IHRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1tYWluLW1lbnUtb3B0aW9uXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWxsX3RvcF9tZW51X29wdGlvbnMgPSB0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtdG9wLW1lbnVfX29wdGlvblwiKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnNfYWNlc3NpYmlsaXR5ID0gdGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLWNvbnRhaW5lci1hY2Vzc2liaWxpdHlfX21vYmlsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbl9tZW51X2Ryb3Bkb3duID0gdGhpcy5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJtZW51XCIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFZlcmlmaWNhIG8gZXN0YWRvIGF0dWFsIGRvIG1lbnUgcGFyYSBkZXRlcm1pbmFyIHNlIGRldmUgYWJyaS1sbyBvdSBmZWNoYS1sb1xuICAgICAgICAgICAgICAgICAgICBpZiAoKFwiIFwiICsgb3B0aW9uX21lbnVfZHJvcGRvd25bMF0uY2xhc3NOYW1lICsgXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csIFwiIFwiKS5pbmRleE9mKFwiIG9wZW4gXCIpID4gLTEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmVjaGEgdG9kb3Mgb3Mgc3VibWVudXNcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaTwgYWxsX21lbnVfb3B0aW9ucy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxfbWVudV9vcHRpb25zW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpPCBhbGxfdG9wX21lbnVfb3B0aW9ucy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxfdG9wX21lbnVfb3B0aW9uc1tpXS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNfYWNlc3NpYmlsaXR5WzBdLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VBbGxTdWJNZW51cyhoZWFkZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGZWNoYSBtZW51IHNlbGVjaW9uYWRvXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25fbWVudV9kcm9wZG93blswXS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPY3VsdGEgYXMgZGVtYWlzIG9ww6fDtWVzIGUgbyBtZW51IGRlIGFjZXNzaWJpbGlkYWRlXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGk8IGFsbF9tZW51X29wdGlvbnMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsX21lbnVfb3B0aW9uc1tpXS5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaTwgYWxsX3RvcF9tZW51X29wdGlvbnMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsX3RvcF9tZW51X29wdGlvbnNbaV0uY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zX2FjZXNzaWJpbGl0eVswXS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWJyZSBtZW51IHNlbGVjaW9uYWRvXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25fbWVudV9kcm9wZG93blswXS5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNfYWNlc3NpYmlsaXR5WzBdLmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEHDp8OjbyBTdWJtZW51cyBtZW51IHByaW5jaXBhbCAoTW9iaWxlKVxuICAgICAgICBmb3IoaSA9IDA7IGk8IGJ0bl9tZW51X2Ryb3Bkb3duX3N1Ym1lbnVzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgYnRuX21lbnVfZHJvcGRvd25fc3VibWVudXNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIHZhciBvcGNvZXNfc3VibWVudSA9IHRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwibGlcIik7XG5cbiAgICAgICAgICAgICAgICAvLyBEZXNhYmlsaXRhciBvIGhyZWYgZG8gbGluayBxdWFuZG8gbW9iaWxlIGUgcXVhbmRvIGEgb3DDp8OjbyBuw6NvIHBvc3N1aXIgc3ViIGl0ZW5zXG4gICAgICAgICAgICAgICAgdmFyIGlzTW9iaWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImhlYWRlci1tb2JpbGVcIik7XG4gICAgICAgICAgICAgICAgaWYgKGlzTW9iaWxlLmxlbmd0aCAhPSAwICYmIG9wY29lc19zdWJtZW51Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBWZXJpZmljYSBvIGVzdGFkbyBhdHVhbCBkbyBzdWJtZW51IHBhcmEgZGV0ZXJtaW5hciBzZSBkZXZlIGFicmktbG8gb3UgZmVjaGEtbG9cbiAgICAgICAgICAgICAgICBpZiAoKFwiIFwiICsgdGhpcy5jbGFzc05hbWUgKyBcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZywgXCIgXCIpLmluZGV4T2YoXCIgb3BlbiBcIikgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBGZWNoYSB0b2RvcyBvcyBzdWJtZW51c1xuICAgICAgICAgICAgICAgICAgICBjbG9zZUFsbFN1Yk1lbnVzKGhlYWRlcik7XG5cbiAgICAgICAgICAgICAgICB9ICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRmVjaGEgdG9kb3Mgb3Mgc3VibWVudXNcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VBbGxTdWJNZW51cyhoZWFkZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEFicmUgbWVudSBzZWxlY2lvbmFkb1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5hZGQoXCJvcGVuXCIpO1xuICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGk8IG9wY29lc19zdWJtZW51Lmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChcIiBcIiArIG9wY29lc19zdWJtZW51W2ldLmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIikuaW5kZXhPZihcIiBvcGVuIFwiKSA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wY29lc19zdWJtZW51W2ldLmNsYXNzTGlzdC5hZGQoXCJvcGVuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEHDp8OjbyBib3TDo28gbWVudSBoYW1idXJnZXIgKG1vYmlsZSlcbiAgICAgICAgYnRuX21lbnVfbW9iaWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgbW9iaWxlX29wdGlvbl9tZW51X2Ryb3Bkb3duID0gdGhpcy5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1oZWFkZXJfX2V4cC1jb250ZW50LS1tYWluLW1lbnVcIik7XG4gICAgICAgICAgICB2YXIgb3B0aW9uc19hY2Vzc2liaWxpdHkgPSB0aGlzLnBhcmVudE5vZGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLWNvbnRhaW5lci1hY2Vzc2liaWxpdHlfX21vYmlsZVwiKTtcbiAgICAgICAgICAgIHZhciBhbGxfbWVudV9vcHRpb25zID0gdGhpcy5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1tYWluLW1lbnUtb3B0aW9uXCIpO1xuICAgICAgICAgICAgdmFyIGFsbF90b3BfbWVudV9vcHRpb25zID0gdGhpcy5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy10b3AtbWVudV9fb3B0aW9uXCIpO1xuXG4gICAgICAgICAgICBpZiAoKFwiIFwiICsgbW9iaWxlX29wdGlvbl9tZW51X2Ryb3Bkb3duWzBdLmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIikuaW5kZXhPZihcIiBvcGVuIFwiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gRmVjaGEgbWVudSBoYW1idXJnZXJcbiAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1vcGVuXCIpO1xuICAgICAgICAgICAgICAgIG1vYmlsZV9vcHRpb25fbWVudV9kcm9wZG93blswXS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcbiAgICAgICAgICAgICAgICB0b2dnbGVIZWFkZXJFeHBhbmRlZChoZWFkZXIpO1xuXG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIE92ZXJsYXkgZG8gaGVhZGVyXG4gICAgICAgICAgICAgICAgcmVtb3ZlSGVhZGVyT3ZlcmxheSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBGZWNoYSB0b2RvcyBvcyBtZW51cyBhdHVhbG1lbnRlIGFiZXJ0b3NcbiAgICAgICAgICAgICAgICBjbG9zZUFsbE1lbnVzKGhlYWRlcik7XG4gICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpPCBhbGxfbWVudV9vcHRpb25zLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgICAgICBhbGxfbWVudV9vcHRpb25zW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGk8IGFsbF90b3BfbWVudV9vcHRpb25zLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgICAgICBhbGxfdG9wX21lbnVfb3B0aW9uc1tpXS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb3B0aW9uc19hY2Vzc2liaWxpdHlbMF0uY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XG5cbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgT3ZlcmxheSBkbyBoZWFkZXJcbiAgICAgICAgICAgICAgICByZW1vdmVIZWFkZXJPdmVybGF5KCk7XG5cbiAgICAgICAgICAgICAgICAvLyBBYnJlIG1lbnUgaGFtYnVyZ2VyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGFzc0xpc3QuYWRkKFwiaXMtb3BlblwiKTtcbiAgICAgICAgICAgICAgICBtb2JpbGVfb3B0aW9uX21lbnVfZHJvcGRvd25bMF0uY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG4gICAgICAgICAgICAgICAgdG9nZ2xlSGVhZGVyRXhwYW5kZWQoaGVhZGVyLCBcImV4cGFuZFwiKTtcblxuICAgICAgICAgICAgICAgIC8vIEFkY2lvbmEgT3ZlcmxheSBkbyBoZWFkZXJcbiAgICAgICAgICAgICAgICBhZGRIZWFkZXJPdmVybGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gQcOnw6NvIGJvdMOjbyBCdXNjYVxuICAgICAgICBidG5fbWVudV9idXNjYXJbMF0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIG1lbnVfYnVzY2EgPSB0aGlzLnBhcmVudE5vZGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcIm1lbnVcIik7XG5cbiAgICAgICAgICAgIC8vIFZlcmlmaWNhIG8gZXN0YWRvIGF0dWFsIGRvIG1lbnUgcGFyYSBkZXRlcm1pbmFyIHNlIGRldmUgYWJyaS1sbyBvdSBmZWNoYS1sb1xuICAgICAgICAgICAgaWYgKChcIiBcIiArIG1lbnVfYnVzY2FbMF0uY2xhc3NOYW1lICsgXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csIFwiIFwiKS5pbmRleE9mKFwiIG9wZW4gXCIpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBGZWNoYSBtZW51IHNlbGVjaW9uYWRvXG4gICAgICAgICAgICAgICAgbWVudV9idXNjYVswXS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1vcGVuXCIpO1xuICAgICAgICAgICAgICAgIHRvZ2dsZUhlYWRlckV4cGFuZGVkKGhlYWRlcik7XG5cbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgT3ZlcmxheSBkbyBoZWFkZXJcbiAgICAgICAgICAgICAgICByZW1vdmVIZWFkZXJPdmVybGF5KCk7XG4gICAgICAgICAgICB9ICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBGZWNoYSB0b2RvcyBvcyBtZW51cyBhdHVhbG1lbnRlIGFiZXJ0b3NcbiAgICAgICAgICAgICAgICBjbG9zZUFsbE1lbnVzKGhlYWRlcik7XG5cbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgT3ZlcmxheSBkbyBoZWFkZXJcbiAgICAgICAgICAgICAgICByZW1vdmVIZWFkZXJPdmVybGF5KCk7XG5cbiAgICAgICAgICAgICAgICAvLyBBYnJlIG1lbnUgc2VsZWNpb25hZG9cbiAgICAgICAgICAgICAgICBtZW51X2J1c2NhWzBdLmNsYXNzTGlzdC5hZGQoXCJvcGVuXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LmFkZChcImlzLW9wZW5cIik7XG4gICAgICAgICAgICAgICAgdG9nZ2xlSGVhZGVyRXhwYW5kZWQoaGVhZGVyLCBcImV4cGFuZFwiKTtcblxuICAgICAgICAgICAgICAgIC8vIEFkY2lvbmEgT3ZlcmxheSBkbyBoZWFkZXJcbiAgICAgICAgICAgICAgICBhZGRIZWFkZXJPdmVybGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gQXRyaWJ1aSBldmVudG8gZGUgZm9ybSBzdWJtaXQgcGFyYSBvIGnCrWNvbmUgZGUgbHVwYSBkbyBjb21wb25lbnRlIGJ1c2NhXG4gICAgICAgIG1lbnVfaWNvX3NlYXJjaFswXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xuXG4gICAgICAgICAgICB2YXIgZm9ybV9idXNjYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnNfZm9ybV9idXNjYVwiKTtcblxuICAgICAgICAgICAgaWYgKGZvcm1fYnVzY2EgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGZvcm1fYnVzY2Euc3VibWl0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gQcOnw6NvIGJvdMOjbyBMb2dpblxuICAgICAgICBidG5fbWVudV9sb2dpblswXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgICAgICAgIHZhciBidG5fbWVudV9sb2dpbiA9IHRoaXMucGFyZW50Tm9kZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwibWVudVwiKTtcblxuICAgICAgICAgICAgLy8gVmVyaWZpY2EgbyBlc3RhZG8gYXR1YWwgZG8gbWVudSBwYXJhIGRldGVybWluYXIgc2UgZGV2ZSBhYnJpLWxvIG91IGZlY2hhLWxvXG4gICAgICAgICAgICBpZiAoKFwiIFwiICsgYnRuX21lbnVfbG9naW5bMF0uY2xhc3NOYW1lICsgXCIgXCIpLnJlcGxhY2UoL1tcXG5cXHRdL2csIFwiIFwiKS5pbmRleE9mKFwiIG9wZW4gXCIpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBGZWNoYSBtZW51IHNlbGVjaW9uYWRvXG4gICAgICAgICAgICAgICAgYnRuX21lbnVfbG9naW5bMF0uY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1vcGVuXCIpO1xuICAgICAgICAgICAgICAgIHRvZ2dsZUhlYWRlckV4cGFuZGVkKGhlYWRlcik7XG5cbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgT3ZlcmxheSBkbyBoZWFkZXJcbiAgICAgICAgICAgICAgICByZW1vdmVIZWFkZXJPdmVybGF5KCk7XG4gICAgICAgICAgICB9ICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBGZWNoYSB0b2RvcyBvcyBtZW51cyBhdHVhbG1lbnRlIGFiZXJ0b3NcbiAgICAgICAgICAgICAgICBjbG9zZUFsbE1lbnVzKGhlYWRlcik7XG5cbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgT3ZlcmxheSBkbyBoZWFkZXJcbiAgICAgICAgICAgICAgICByZW1vdmVIZWFkZXJPdmVybGF5KCk7XG5cbiAgICAgICAgICAgICAgICAvLyBSZXNldGEgYXMgc3Vib3DDp8O1ZXMgZGUgbG9naW4gcGFyYSBvIHNldSBlc3RhZG8gaW5pY2lhbCBwYWRyw6NvXG4gICAgICAgICAgICAgICAgbG9naW5EZWZhdWx0SW5pdCh0aGlzKTtcblxuICAgICAgICAgICAgICAgIC8vIEFicmUgbWVudSBzZWxlY2lvbmFkb1xuICAgICAgICAgICAgICAgIGJ0bl9tZW51X2xvZ2luWzBdLmNsYXNzTGlzdC5hZGQoXCJvcGVuXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKFwiaXMtb3BlblwiKTtcbiAgICAgICAgICAgICAgICB0b2dnbGVIZWFkZXJFeHBhbmRlZChoZWFkZXIsIFwiZXhwYW5kXCIpO1xuXG4gICAgICAgICAgICAgICAgLy8gQWRjaW9uYSBPdmVybGF5IGRvIGhlYWRlclxuICAgICAgICAgICAgICAgIGFkZEhlYWRlck92ZXJsYXkoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQWx0ZXJhIHBhcsOibWV0cm8gYWNlc3NpYmlsaWRhZGU6IGFyaWEtZXhwYW5kZWQgZG8gaXRlbVxuICAgICAgICAgICAgdmFyIHBhcmFtZXRlckFyaWFFeHBhbmRlZCA9IHRoaXMuZ2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiKTtcbiAgICAgICAgICAgIHZhciBwYXJhbWV0ZXJBcmlhRXhwYW5kZWQgPSBwYXJhbWV0ZXJBcmlhRXhwYW5kZWQgPT0gXCJmYWxzZVwiID8gcGFyYW1ldGVyQXJpYUV4cGFuZGVkID0gXCJ0cnVlXCIgOiBwYXJhbWV0ZXJBcmlhRXhwYW5kZWQgPSBcImZhbHNlXCI7XG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImFyaWEtZXhwYW5kZWRcIiwgcGFyYW1ldGVyQXJpYUV4cGFuZGVkKTtcbiAgICAgICAgfSlcblxuICAgICAgICAvLyBJbmljaWFsaXphciBhw6fDtWVzIGRvcyBzdWJpdGVucyBkZSBMb2dpblxuICAgICAgICBsb2dpbkJlaGF2aW91cihidG5fbWVudV9sb2dpbilcblxuICAgICAgICAvLyBDbG9uYSBlbGVtZW50b3MgbWVudSBzdXBlcmlvciBwYXJhIGRlbnRybyBkbyBtZW51IG1vYmlsZVxuICAgICAgICB0b3BNZW51TW9iaWxlKGhlYWRlcik7XG5cbiAgICAgICAgLy8gRmVjaGFyIG8gbWVudSBhbyBhcGVydGFyIGEgdGVjbGEgRVNDXG4gICAgICAgIGRvY3VtZW50Lm9ua2V5ZG93biA9IGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgZXZ0ID0gZXZ0IHx8IHdpbmRvdy5ldmVudDtcbiAgICAgICAgICAgIHZhciBpc0VzY2FwZSA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKFwia2V5XCIgaW4gZXZ0KSB7XG4gICAgICAgICAgICAgICAgaXNFc2NhcGUgPSAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIiB8fCBldnQua2V5ID09PSBcIkVzY1wiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaXNFc2NhcGUgPSAoZXZ0LmtleUNvZGUgPT09IDI3KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0VzY2FwZSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZUhlYWRlck92ZXJsYXkoKTtcblxuICAgICAgICAgICAgICAgIC8vIEZvY2FyIG5hIG9ww6fDo28gZG8gbWVudSByZWZlcmVudGUgYW8gZWxlbWVudG8gYXRpdm8gcXVhbmRvIGZlY2hhciBvIG1lbnUgZXhwYW5kaWRvXG4gICAgICAgICAgICAgICAgLy8gTWVudSBwcmluY2lhbFxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50LmNsb3Nlc3QoXCIuYnMtbWFpbi1tZW51LW9wdGlvblwiKSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtZW51X29wdGlvbiA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuY2xvc2VzdChcIi5icy1tYWluLW1lbnUtb3B0aW9uXCIpO1xuICAgICAgICAgICAgICAgICAgICBtZW51X29wdGlvbi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtaGVhZGVyLW1lbnUtb3B0aW9uXCIpWzBdLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQnVzY2FcbiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5jbG9zZXN0KFwiLm1lbnVfc2VhcmNoXCIpICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLWhlYWRlci1idXNjYXJcIilbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBMb2dpblxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50LmNsb3Nlc3QoXCIubWVudV9sb2dpblwiKSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLWJ1dHRvbi0tbG9naW5cIilbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9TZXRhbmRvIHZhbG9yIG7Do28gZm9jYWxpesOhdmVsIHBhcmEgU1ZHL1Byb2JsZW1hIElFMTFcbiAgICAgICAgdmFyIHJlbW92ZUZvY3VzYWJsZVN2ZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1sb2dvIHN2ZycpO1xuICAgICAgICByZW1vdmVGb2N1c2FibGVTdmcuc2V0QXR0cmlidXRlKCdmb2N1c2FibGUnLCAnZmFsc2UnKTtcbiAgICB9XG5cbiAgICAvLyBJbmljaWFsaXphw6fDo28gcGFkcsOjbyBzdWJtZW51cyBsb2dpblxuICAgIHZhciBsb2dpbkRlZmF1bHRJbml0ID0gZnVuY3Rpb24oYnRuX21lbnVfbG9naW4pIHtcbiAgICAgICAgLy8gQ29udGFpbnRlciBkbyBsb2dpblxuICAgICAgICB2YXIgbG9naW5fY29udGFpbmVyID0gYnRuX21lbnVfbG9naW4ucGFyZW50Tm9kZTtcbiAgICAgICAgLy8gTWVudSBleHBhbnPDrXZlbCBkbyBsb2dpblxuICAgICAgICB2YXIgbG9naW5fZXhwX21lbnUgPSBsb2dpbl9jb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLWhlYWRlcl9fZXhwLWNvbnRlbnRcIik7XG4gICAgICAgIC8vIEJvdMO1ZXMgb3DDp8O1ZXMgTG9naW5cbiAgICAgICAgdmFyIGJ0bl9vcHRpb25zX2xvZ2luID0gbG9naW5fZXhwX21lbnVbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInN1Yml0ZW1cIik7XG4gICAgICAgIC8vIFN1Ym9ww6fDtWVzIExvZ2luXG4gICAgICAgIHZhciBvcHRpb25zX2xvZ2luID0gbG9naW5fZXhwX21lbnVbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInN1YmNvbnRlbnRcIik7XG5cbiAgICAgICAgLy8gVmVyaWZpY2FyIG8gdGlwbyBkZSBkaXNwb3NpdGl2byBlc3TDoSBhY2Vzc2FuZG9cbiAgICAgICAgdmFyIGlzTW9iaWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImhlYWRlci1tb2JpbGVcIik7XG4gICAgICAgIGlmIChpc01vYmlsZS5sZW5ndGggPT0gMCkgeyAvLyBEZXNrdG9wXG4gICAgICAgICAgICAvLyBGZWNoYXIgb3Mgc3VibWVudXMgcXVlIGVzdMOjbyBhYmVydG9zIGUgZGVzbWFyY2FyIGFzIG9ww6fDtWVzIGRlIGxvZ2luIHNlbGVjaW9uYWRhc1xuICAgICAgICAgICAgZm9yKGkgPSAwOyBpPCBvcHRpb25zX2xvZ2luLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgIG9wdGlvbnNfbG9naW5baV0uY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IoaSA9IDA7IGk8IGJ0bl9vcHRpb25zX2xvZ2luLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgIGJ0bl9vcHRpb25zX2xvZ2luW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBidG5fb3B0aW9uc19sb2dpblswXS5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcbiAgICAgICAgICAgIG9wdGlvbnNfbG9naW5bMF0uY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG4gICAgICAgIH0gZWxzZSB7IC8vIE1vYmlsZVxuICAgICAgICAgICAgLy8gRmVjaGFyIG9zIHN1Ym1lbnVzIHF1ZSBlc3TDo28gYWJlcnRvcyBlIGRlc21hcmNhciBhcyBvcMOnw7VlcyBkZSBsb2dpbiBzZWxlY2lvbmFkYXNcbiAgICAgICAgICAgIGZvcihpID0gMDsgaTwgb3B0aW9uc19sb2dpbi5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICBvcHRpb25zX2xvZ2luW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yKGkgPSAwOyBpPCBidG5fb3B0aW9uc19sb2dpbi5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICBidG5fb3B0aW9uc19sb2dpbltpXS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcbiAgICAgICAgICAgICAgICBidG5fb3B0aW9uc19sb2dpbltpXS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZ1bsOnw6NvIGNvbXBvcnRhbWVudG8gTG9naW5cbiAgICB2YXIgbG9naW5CZWhhdmlvdXIgPSBmdW5jdGlvbihidG5fbWVudV9sb2dpbikge1xuXG4gICAgICAgIC8vIENvbnRhaW50ZXIgZG8gbG9naW5cbiAgICAgICAgdmFyIGxvZ2luX2NvbnRhaW5lciA9IGJ0bl9tZW51X2xvZ2luWzBdLnBhcmVudE5vZGU7XG4gICAgICAgIC8vIE1lbnUgZXhwYW5zw612ZWwgZG8gbG9naW5cbiAgICAgICAgdmFyIGxvZ2luX2V4cF9tZW51ID0gbG9naW5fY29udGFpbmVyLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1oZWFkZXJfX2V4cC1jb250ZW50XCIpO1xuICAgICAgICAvLyBCb3TDtWVzIG9ww6fDtWVzIExvZ2luXG4gICAgICAgIHZhciBidG5fb3B0aW9uc19sb2dpbiA9IGxvZ2luX2V4cF9tZW51WzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJzdWJpdGVtXCIpO1xuICAgICAgICAvLyBTdWJvcMOnw7VlcyBMb2dpblxuICAgICAgICB2YXIgb3B0aW9uc19sb2dpbiA9IGxvZ2luX2V4cF9tZW51WzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJzdWJjb250ZW50XCIpO1xuXG4gICAgICAgIC8vIEFicmlyIHN1Ym1lbnUgZGUgYWNvcmRvIGNvbSBhIG9ww6fDo28gc2VsZWNpb25hZGFcbiAgICAgICAgZm9yKGkgPSAwOyBpPCBidG5fb3B0aW9uc19sb2dpbi5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGlmIChvcHRpb25zX2xvZ2luW2ldLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1vcHRpb24tc3ViLWl0ZW1cIikubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICBidG5fb3B0aW9uc19sb2dpbltpXS5jbGFzc0xpc3QuYWRkKFwiYnMtb3B0aW9uLXRpdGxlLW5vc3ViaXRlbXNcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJ0bl9vcHRpb25zX2xvZ2luW2ldLmlkID0gXCJidG4tbG9naW4tXCIraTtcbiAgICAgICAgICAgIG9wdGlvbnNfbG9naW5baV0uaWQgPSBcInN1Ym1lbnUtbG9naW4tXCIraTtcblxuICAgICAgICAgICAgYnRuX29wdGlvbnNfbG9naW5baV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIC8vIFZlcmlmaWNhciBvIHRpcG8gZGUgZGlzcG9zaXRpdm8gZXN0w6EgYWNlc3NhbmRvXG4gICAgICAgICAgICAgICAgdmFyIGlzTW9iaWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImhlYWRlci1tb2JpbGVcIik7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNNb2JpbGUubGVuZ3RoID09IDApIHsgLy8gRGVza3RvcFxuICAgICAgICAgICAgICAgICAgICAvLyBQZWdhciBvIHN1Yml0ZW0gcmVmZXJlbnRlIGFvIGJvdMOjbyBkZSBhY29yZG8gY29tIG8gSUQgZG8gbWVzbW9cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Yml0ZW1fcG9zaXRpb24gPSB0aGlzLmlkLnJlcGxhY2UoIC9eXFxEKy9nLCAnJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRmVjaGFyIG9zIHN1Ym1lbnVzIHF1ZSBlc3TDo28gYWJlcnRvcyBlIGRlc21hcmNhciBhcyBvcMOnw7VlcyBkZSBsb2dpbiBzZWxlY2lvbmFkYXNcbiAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpPCBvcHRpb25zX2xvZ2luLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc19sb2dpbltpXS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGk8IGJ0bl9vcHRpb25zX2xvZ2luLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgYnRuX29wdGlvbnNfbG9naW5baV0uY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBBYnJpciBvIHN1Ym1lbnUgc2VsZWNpb25hZG8gZSBtYXJjYXIgYSBzdWJvcMOnw6NvIHNlbGVjaW9uYWRhXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnNfbG9naW5bc3ViaXRlbV9wb3NpdGlvbl0uY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgeyAvL01vYmlsZVxuICAgICAgICAgICAgICAgICAgICAvLyBQZWdhciBvIHN1Yml0ZW0gcmVmZXJlbnRlIGFvIGJvdMOjbyBkZSBhY29yZG8gY29tIG8gSUQgZG8gbWVzbW9cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Yml0ZW1fcG9zaXRpb24gPSB0aGlzLmlkLnJlcGxhY2UoIC9eXFxEKy9nLCAnJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVmFyaWZpY2FyIHNlIG8gc3VibWVudSBlc3TDoSBzZWxlY2lvbmFkbyBvdSBuw6NvIGUgYWJyaXIvZmVjaGFyIGEgc3Vib3DDp8Ojb1xuICAgICAgICAgICAgICAgICAgICBpZiAoKFwiIFwiICsgdGhpcy5jbGFzc05hbWUgKyBcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZywgXCIgXCIpLmluZGV4T2YoXCIgb3BlbiBcIikgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXhpYmlyIGFzIHN1Ym9ww6fDtWVzIG7Do28gc2VsZWNpb25hZGFzXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGk8IGJ0bl9vcHRpb25zX2xvZ2luLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0bl9vcHRpb25zX2xvZ2luW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBYnJpciBvIHN1Ym1lbnUgc2VsZWNpb25hZG8gZSBtYXJjYXIgYSBzdWJvcMOnw6NvIHNlbGVjaW9uYWRhXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zX2xvZ2luW3N1Yml0ZW1fcG9zaXRpb25dLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9jdWx0YXIgYXMgc3Vib3DDp8O1ZXMgbsOjbyBzZWxlY2lvbmFkYXNcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaTwgYnRuX29wdGlvbnNfbG9naW4ubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRuX29wdGlvbnNfbG9naW5baV0uY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFicmlyIG8gc3VibWVudSBzZWxlY2lvbmFkbyBlIG1hcmNhciBhIHN1Ym9ww6fDo28gc2VsZWNpb25hZGFcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNfbG9naW5bc3ViaXRlbV9wb3NpdGlvbl0uY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5hZGQoXCJvcGVuXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgYnRuX29wdGlvbnNfbG9naW5baV0uYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGtleVByZXNzZWQgPSBlLmtleUNvZGU7XG5cbiAgICAgICAgICAgICAgICAvLyBQZWdhciBvIHN1Yml0ZW0gcmVmZXJlbnRlIGFvIGJvdMOjbyBkZSBhY29yZG8gY29tIG8gSUQgZG8gbWVzbW9cbiAgICAgICAgICAgICAgICB2YXIgc3ViaXRlbV9wb3NpdGlvbiA9IHRoaXMuaWQucmVwbGFjZSggL15cXEQrL2csICcnKTtcblxuICAgICAgICAgICAgICAgIHN3aXRjaCAoa2V5UHJlc3NlZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTZXRhIHBhcmEgZGlyZWl0YVxuICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9jYXIgbm8gcHJpbWVpcm8gaXRlbSBkbyBzdWJtZW51IChBY2Vzc2liaWxpZGFkZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNfbG9naW5bc3ViaXRlbV9wb3NpdGlvbl0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW9wdGlvbi1zdWItaXRlbVwiKVswXS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0YSBwYXJhIGRpcmVpdGFcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvY2FyIG5vIHByaW1laXJvIGl0ZW0gZG8gc3VibWVudSAoQWNlc3NpYmlsaWRhZGUpXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zX2xvZ2luW3N1Yml0ZW1fcG9zaXRpb25dLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1vcHRpb24tc3ViLWl0ZW1cIilbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQXRyaWJ1aXIgY2xhc3NlcyBvcmRlbmFkYXMgcGFyYSBjYWRhIGxpbmsgKEFjZXNzaWJpbGlkYWRlKVxuICAgICAgICBmb3IoaSA9IDA7IGk8IG9wdGlvbnNfbG9naW4ubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICB2YXIgc3VibWVudUxpbmtzID0gb3B0aW9uc19sb2dpbltpXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtb3B0aW9uLXN1Yi1pdGVtXCIpO1xuICAgICAgICAgICAgZm9yKGogPSAwOyBqPCBzdWJtZW51TGlua3MubGVuZ3RoO2orKyl7XG4gICAgICAgICAgICAgICAgc3VibWVudUxpbmtzW2pdLmNsYXNzTGlzdC5hZGQoXCJpdGVtLVwiK2opO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHRvcE1lbnVNb2JpbGUgPSBmdW5jdGlvbihoZWFkZXIpIHtcbiAgICAgICAgdmFyIHRvcF9tZW51ID0gaGVhZGVyWzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1oZWFkZXJfX3RvcC1tZW51XCIpWzBdO1xuICAgICAgICB2YXIgdG9wX21lbnVfb3B0aW9uID0gdG9wX21lbnUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLXRvcC1tZW51X19vcHRpb25cIik7XG4gICAgICAgIHZhciB0b3BfbWVudV9tb2JpbGUgPSBoZWFkZXJbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLWhlYWRlcl9fbWVudS1zdXBlcmlvclwiKTtcblxuICAgICAgICAvLyBDbG9uYXIgYXMgb3DDp8O1ZXMgZG8gbWVudSBzdXBlcmlvclxuICAgICAgICB2YXIgdG9wX21lbnVfY2xvbmUgPSB0b3BfbWVudS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgIHRvcF9tZW51X21vYmlsZVswXS5hcHBlbmRDaGlsZCh0b3BfbWVudV9jbG9uZSk7XG5cbiAgICAgICAgLy8gUGVnYXIgYXMgb3DDp8O1ZXMgY2xvbmFkYXMgbm8gbWVudSBtb2JpbGUgZSBhdHJpYnVpciBzdWFzIGZ1bmNpb25hbGlkYWRlc1xuICAgICAgICB0b3BfbWVudV9vcHRpb24gPSB0b3BfbWVudV9tb2JpbGVbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLXRvcC1tZW51X19vcHRpb25cIik7XG5cbiAgICAgICAgZm9yKGkgPSAwOyBpPCB0b3BfbWVudV9vcHRpb24ubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICB2YXIgaXNfZHJvcGRvd24gPSB0b3BfbWVudV9vcHRpb25baV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLXRvcC1tZW51X19kcm9wZG93blwiKTtcblxuICAgICAgICAgICAgaWYgKGlzX2Ryb3Bkb3duLmxlbmd0aCA+IDAgKXtcbiAgICAgICAgICAgICAgICB2YXIgYnRuX2Ryb3Bkb3duID0gaXNfZHJvcGRvd25bMF0ucGFyZW50Tm9kZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtdG9wLW1lbnVfX2xpbmtcIilbMF07XG5cbiAgICAgICAgICAgICAgICBidG5fZHJvcGRvd24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZHJvcGRvd24gPSB0aGlzLnBhcmVudE5vZGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLXRvcC1tZW51X19kcm9wZG93blwiKVswXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRvcF9tZW51X2NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1oZWFkZXJfX21lbnUtc3VwZXJpb3JcIilbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbGxfbWVudV9vcHRpb25zID0gdG9wX21lbnVfY29udGFpbmVyLnBhcmVudE5vZGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW1haW4tbWVudS1vcHRpb25cIik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbGxfdG9wX21lbnVfb3B0aW9ucyA9IHRvcF9tZW51X2NvbnRhaW5lci5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy10b3AtbWVudV9fb3B0aW9uXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9uc19hY2Vzc2liaWxpdHkgPSB0b3BfbWVudV9jb250YWluZXIucGFyZW50Tm9kZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtY29udGFpbmVyLWFjZXNzaWJpbGl0eV9fbW9iaWxlXCIpWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICgoXCIgXCIgKyBkcm9wZG93bi5jbGFzc05hbWUgKyBcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZywgXCIgXCIpLmluZGV4T2YoXCIgb3BlbiBcIikgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXhpYmUgdG9kYXMgYXMgb3DDp8O1ZXMgZG8gbWVudSBlIGFzIG9ww6fDtWVzIGRlIGFjZXNzaWJpbGlkYWRlXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGk8IGFsbF9tZW51X29wdGlvbnMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsX21lbnVfb3B0aW9uc1tpXS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaTwgYWxsX3RvcF9tZW51X29wdGlvbnMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsX3RvcF9tZW51X29wdGlvbnNbaV0uY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zX2FjZXNzaWJpbGl0eS5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmVjaGEgb3DDp8O1ZXMgZHJvcGRvd25cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT2N1bHRhIHRvZGFzIGFzIG9ww6fDtWVzIGRvIG1lbnUgZSBhcyBvcMOnw7VlcyBkZSBhY2Vzc2liaWxpZGFkZVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpPCBhbGxfbWVudV9vcHRpb25zLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbF9tZW51X29wdGlvbnNbaV0uY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGk8IGFsbF90b3BfbWVudV9vcHRpb25zLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbF90b3BfbWVudV9vcHRpb25zW2ldLmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc19hY2Vzc2liaWxpdHkuY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFicmUgb3DDp8O1ZXMgZHJvcGRvd25cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmNsYXNzTGlzdC5hZGQoXCJvcGVuXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZ1bsOnw6NvIHJlc3BvbnPDoXZlbCBwb3IgZmVjaGFyIHRvZG9zIG9zIG1lbnVzIHF1ZSBlc3RpdmVyZW0gYWJlcnRvc1xuICAgIHZhciBjbG9zZUFsbE1lbnVzID0gZnVuY3Rpb24oaGVhZGVyKSB7XG4gICAgICAgIHZhciBvcGVuZWRfbWVudXMgPSBoZWFkZXJbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcIm9wZW5cIik7XG4gICAgICAgIHZhciBzZWxlY3RlZF9vcHRpb25zID0gaGVhZGVyWzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJpcy1vcGVuXCIpO1xuXG4gICAgICAgIGZvcihpID0gMDsgaTwgb3BlbmVkX21lbnVzLmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgb3BlbmVkX21lbnVzW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGZvcihpID0gMDsgaTwgc2VsZWN0ZWRfb3B0aW9ucy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIHNlbGVjdGVkX29wdGlvbnNbaV0uY2xhc3NMaXN0LnJlbW92ZShcImlzLW9wZW5cIik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGdW7Dp8OjbyByZXNwb25zw6F2ZWwgcG9yIGZlY2hhciB0b2RvcyBvcyBzdWJtZW51cyBxdWUgZXN0aXZlcmVtIGFiZXJ0b3MgKG1vYmlsZSlcbiAgICB2YXIgY2xvc2VBbGxTdWJNZW51cyA9IGZ1bmN0aW9uKGhlYWRlcikge1xuICAgICAgICB2YXIgYnRuX3N1Ym1lbnUgPSBoZWFkZXJbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW9wdGlvbi10aXRsZVwiKTtcblxuICAgICAgICBmb3IoaSA9IDA7IGk8IGJ0bl9zdWJtZW51Lmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgaWYgKChcIiBcIiArIGJ0bl9zdWJtZW51W2ldLmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIikuaW5kZXhPZihcIiBvcGVuIFwiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgYnRuX3N1Ym1lbnVbaV0uY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG5cbiAgICAgICAgICAgICAgICB2YXIgb3Bjb2VzX3N1Ym1lbnUgPSBidG5fc3VibWVudVtpXS5wYXJlbnROb2RlLnBhcmVudE5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJsaVwiKTtcblxuICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaTwgb3Bjb2VzX3N1Ym1lbnUubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgIGlmICgoXCIgXCIgKyBvcGNvZXNfc3VibWVudVtpXS5jbGFzc05hbWUgKyBcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZywgXCIgXCIpLmluZGV4T2YoXCIgb3BlbiBcIikgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3Bjb2VzX3N1Ym1lbnVbaV0uY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGdW7Dp8OjbyBwYXJhIGF0cmlidWlyIGVzdGFkbyBhdHVhbCBkbyBoZWFkZXIgKGV4cGFuZGlkby9uw6NvIGV4cGFuZGlkbylcbiAgICB2YXIgdG9nZ2xlSGVhZGVyRXhwYW5kZWQgPSBmdW5jdGlvbihoZWFkZXIsIGFjdGlvbikge1xuICAgICAgICAvLyB2YXIgb3BlbmVkX21lbnVzID0gaGVhZGVyWzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJvcGVuXCIpO1xuICAgICAgICBpZiAoYWN0aW9uID09IFwiZXhwYW5kXCIpIHtcbiAgICAgICAgICAgIGhlYWRlclswXS5jbGFzc0xpc3QuYWRkKFwiZXhwYW5kZWRcIilcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGhlYWRlclswXS5jbGFzc0xpc3QucmVtb3ZlKFwiZXhwYW5kZWRcIik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBZGljaW9uYXIgb3ZlcmxheSBkbyBoZWFkZXIgcGFyYSBjb250cm9sYXIgbyBjbGljayBmb3JhIGRhIMOhcmVhIGRvIGhlYWRlclxuICAgIHZhciBhZGRIZWFkZXJPdmVybGF5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBvdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcIm92ZXJsYXktb25cIik7XG5cbiAgICAgICAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKFwiaGVhZGVyLW92ZXJsYXlcIik7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQob3ZlcmxheSk7XG5cbiAgICAgICAgLy8gQXRyaWJ1aSBhIGFsdHVyYSBkbyBvdmVybGF5IGFwcmEgc2VyIGEgbWVzbWEgZG8gZG9jdW1lbnRvXG4gICAgICAgIG92ZXJsYXkuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJoZWlnaHQ6IFwiICsgZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQgKyBcInB4XCIpO1xuXG4gICAgICAgIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIHJlbW92ZUhlYWRlck92ZXJsYXkoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgbyBvdmVybGF5IGRvIGhlYWRlciBlIHJlYWJpbGl0YSBvIHNjcm9sbFxuICAgIHZhciByZW1vdmVIZWFkZXJPdmVybGF5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBoZWFkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtaGVhZGVyXCIpO1xuICAgICAgICB2YXIgb3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJoZWFkZXItb3ZlcmxheVwiKTtcblxuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJvdmVybGF5LW9uXCIpO1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBvdmVybGF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdmVybGF5W2ldLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQob3ZlcmxheVtpXSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGZWNoYSB0b2RhcyBhcyBvcMOnw7VlcyBhYmVydGFzXG4gICAgICAgIGNsb3NlQWxsTWVudXMoaGVhZGVyKTtcblxuICAgICAgICAvLyBSZW1vdmUgbyBlc3RhdG8gZXhwYW5zaWRvIGRvIGhlYWRlclxuICAgICAgICB0b2dnbGVIZWFkZXJFeHBhbmRlZChoZWFkZXIpO1xuICAgIH1cblxuICAgIHZhciBzY3JvbGxIZWFkZXJDdHJsID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIEdldCB3aW5kb3cgcG9zaXRpb25cbiAgICAgICAgdmFyIGxhc3RTY3JvbGxUb3AgPSB3aW5kb3cucGFnZVlPZmZzZXQ7XG4gICAgICAgIHZhciBoZWFkZXJUb3BQb3NpdGlvbjtcblxuICAgICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPCA5OTIpIHtcbiAgICAgICAgICAgIGhlYWRlclswXS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcInBvc2l0aW9uOiBmaXhlZDsgdG9wOiAwXCIpO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcIm1hcmdpbi10b3A6IDEyOHB4XCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHZhciBsb2dvTW9iaWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWhlYWRlcl9fbG9nbyAuYnMtbG9nbycpO1xuICAgICAgICAgICAgbGV0IGhlYWRlcl9tb2JpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaGVhZGVyLW1vYmlsZScpWzBdO1xuICAgICAgICAgICAgbGV0IGhlYWRlclN0YXR1cyA9IC0xO1xuXG4gICAgICAgICAgICBpZiAoaGVhZGVyX21vYmlsZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgaGVhZGVyU3RhdHVzID0gKFwiIFwiICsgaGVhZGVyX21vYmlsZS5jbGFzc05hbWUgKyBcIiBcIikucmVwbGFjZSgvW1xcblxcdF0vZywgXCIgXCIpLmluZGV4T2YoXCIgZXhwYW5kZWQgXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBkZXZpY2UgaXMgdW5kZXIgOTkycHggd2lkdGhcbiAgICAgICAgICAgIC8vIEdldCBpbml0aWFsIGhlYWRlciBwb3NpdGlvblxuICAgICAgICAgICAgaWYgKGhlYWRlclRvcFBvc2l0aW9uID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJUb3BQb3NpdGlvbiA9IGhlYWRlclswXS5vZmZzZXRUb3A7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8IDk5Mikge1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50U2Nyb2xsVG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICAgICAgICAgICAgdmFyIGJvZHkgPSBkb2N1bWVudC5ib2R5LFxuICAgICAgICAgICAgICAgICAgICBodG1sID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuXG4gICAgICAgICAgICAgICAgdmFyIHRvdGFsU2Nyb2xsSGVpZ2h0ID0gTWF0aC5tYXgoIGJvZHkuc2Nyb2xsSGVpZ2h0LCBib2R5Lm9mZnNldEhlaWdodCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sLmNsaWVudEhlaWdodCwgaHRtbC5zY3JvbGxIZWlnaHQsIGh0bWwub2Zmc2V0SGVpZ2h0ICk7XG5cbiAgICAgICAgICAgICAgICB0b3RhbFNjcm9sbEhlaWdodCA9IHRvdGFsU2Nyb2xsSGVpZ2h0IC0gd2luZG93LmlubmVySGVpZ2h0IC0gMTI4XG5cbiAgICAgICAgICAgICAgICAvLyBJZiBpcyBzY3JvbGxpbmcgZG93biBhbmQgaGVhZGVyIG5vdCBleHBhbmRlZFxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U2Nyb2xsVG9wID4gbGFzdFNjcm9sbFRvcCAmJiBjdXJyZW50U2Nyb2xsVG9wIDwgdG90YWxTY3JvbGxIZWlnaHQgJiYgaGVhZGVyU3RhdHVzID09IC0xICl7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlclswXS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcInBvc2l0aW9uOiBmaXhlZDsgdG9wOiAtMTQwcHhcIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuYm9keS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcIm1hcmdpbi10b3A6IDk2cHhcIik7XG4gICAgICAgICAgICAgICAgLy8gRWxzZSBzY3JvbGxpbmcgdXBcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiBjdXJyZW50IHNjcm9sbCBwb3NpdGlvbiBpcyBncmVhdGVyIHRoYW4gaW5pdGlhbCBoZWFkZXIgcG9zaXRpb24sIGZpeCB0byB0b3BcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhlYWRlclRvcFBvc2l0aW9uIDwgcGFnZVlPZmZzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlclswXS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcInBvc2l0aW9uOiBmaXhlZDsgdG9wOiAwXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudC5ib2R5LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwibWFyZ2luLXRvcDogMTI2cHhcIik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJbMF0uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJwb3NpdGlvbjogZml4ZWQ7IHRvcDogMFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuYm9keS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcIm1hcmdpbi10b3A6IDEyOHB4XCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxhc3RTY3JvbGxUb3AgPSBjdXJyZW50U2Nyb2xsVG9wIDw9IDAgPyAwIDogY3VycmVudFNjcm9sbFRvcDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGVhZGVyWzBdLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwicG9zaXRpb246IGZpeGVkOyB0b3A6IDBcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudC5ib2R5LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwibWFyZ2luLXRvcDogMTIwcHhcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGZhbHNlKTtcbiAgICB9XG5cbiAgICAvLyBGdW7Dp8OjbyBwYXJhIHZlcmlmaWNhciBzZSBvIGRpc3Bvc2l0aXZvIMOpIERlc2t0b3Agb3UgTW9iaWxlXG4gICAgdmFyIGNoa0RldmljZSA9IGZ1bmN0aW9uKGhlYWRlcikge1xuICAgICAgICBpZiAod2luZG93Lm91dGVyV2lkdGggPiA5OTEpIHtcbiAgICAgICAgICAgIGhlYWRlclswXS5jbGFzc0xpc3QucmVtb3ZlKFwiaGVhZGVyLW1vYmlsZVwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGhlYWRlclswXS5jbGFzc0xpc3QuYWRkKFwiaGVhZGVyLW1vYmlsZVwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vICMjIyBJbmljaW8gdHJhdGFtZW50byBkbyBlc3Bhw6dhbWVudG8gZG9zIGZpbGhvcyBkbyBtZW51XG5cbiAgICAvLyBGdW7Dp8OjbyBwYXJhIGNvbnRhciBlbGVtZW50b3MgZmlsaG9zIGRvIG1lbnVcbiAgICBmdW5jdGlvbiBjb250YXIoZWwpIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoZWwpLmxlbmd0aDtcbiAgICB9XG5cbiAgICAvLyBGdW7Dp8OjbyBxdWUgcmVtb3ZlIGEgY2xhc3NlIFwiLmJzLXNwYWNlLWVsZW1lbnRzXCJcbiAgICBmdW5jdGlvbiByZW1vdmVFbGVtKCl7XG4gICAgICAgIFtdLmZvckVhY2guY2FsbChlbGVtRGVsLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICAgIGVsLmNsYXNzTmFtZSA9IGVsLmNsYXNzTmFtZS5yZXBsYWNlKC9cXGJicy1zcGFjZS1lbGVtZW50c1xcYi8sIFwiXCIpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBGdW7Dp8OjbyBxdWUgYWRpY2lvbmEgYSBjbGFzc2UgXCIuYnMtc3BhY2UtZWxlbWVudHNcIlxuICAgIGZ1bmN0aW9uIGFkZEVsZW0oKXtcbiAgICAgICAgW10uZm9yRWFjaC5jYWxsKGVsZW1BZGQsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgZWwuY2xhc3NOYW1lID0gZWwuY2xhc3NOYW1lLnJlcGxhY2UoL1xcYmJzLWhlYWRlcl9fZXhwLWNvbnRlbnQtLW1haW4tbWVudVxcYi8sIFwiYnMtaGVhZGVyX19leHAtY29udGVudC0tbWFpbi1tZW51IGJzLXNwYWNlLWVsZW1lbnRzXCIpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB2YXIgcXRkID0gY29udGFyKCcuYnMtbWFpbi1tZW51LW9wdGlvbicpO1xuICAgIHZhciBlbGVtRGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5icy1oZWFkZXJfX2V4cC1jb250ZW50LS1tYWluLW1lbnUuYnMtc3BhY2UtZWxlbWVudHNcIik7XG4gICAgdmFyIGVsZW1BZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJzLWhlYWRlcl9fZXhwLWNvbnRlbnQtLW1haW4tbWVudVwiKTtcblxuICAgIC8vIFNlIGhvdXZlciBtZW5vcyBxdWUgMyBmaWxob3MsIGV4ZWN1dGEgYSByZW1vw6fDo28gZGEgY2xhc3NlIFwiLmJzLXNwYWNlLWVsZW1lbnRzXCIgZSBhdGl2YSBvIGZsZXgtc3RhcnRcbiAgICBpZiAocXRkIDwgMykge1xuICAgICAgICAgICAgcmVtb3ZlRWxlbSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWRkRWxlbSgpO1xuICAgIH1cblxuICAgIC8vICMjIyBGaW0gdHJhdGFtZW50byBkbyBlc3Bhw6dhbWVudG8gZG9zIGZpbGhvcyBkbyBtZW51XG5cblxuICAgIC8vIEZ1bsOnw6NvIHBhcmEgdmVyaWZpY2FyIG8gdGlwbyBkbyBicm93c2VyXG4gICAgdmFyIGNoa0Jyb3dzZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGlzT3BlcmEgPSAoISF3aW5kb3cub3ByICYmICEhb3ByLmFkZG9ucykgfHwgISF3aW5kb3cub3BlcmEgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCcgT1BSLycpID49IDA7IC8vIE9wZXJhIDguMCtcbiAgICAgICAgdmFyIGlzRmlyZWZveCA9IHR5cGVvZiBJbnN0YWxsVHJpZ2dlciAhPT0gJ3VuZGVmaW5lZCc7IC8vIEZpcmVmb3ggMS4wK1xuICAgICAgICB2YXIgaXNTYWZhcmkgPSAvY29uc3RydWN0b3IvaS50ZXN0KHdpbmRvdy5IVE1MRWxlbWVudCkgfHwgKGZ1bmN0aW9uIChwKSB7IHJldHVybiBwLnRvU3RyaW5nKCkgPT09IFwiW29iamVjdCBTYWZhcmlSZW1vdGVOb3RpZmljYXRpb25dXCI7IH0pKCF3aW5kb3dbJ3NhZmFyaSddIHx8ICh0eXBlb2Ygc2FmYXJpICE9PSAndW5kZWZpbmVkJyAmJiBzYWZhcmkucHVzaE5vdGlmaWNhdGlvbikpOyAvLyBTYWZhcmkgMy4wKyBcIltvYmplY3QgSFRNTEVsZW1lbnRDb25zdHJ1Y3Rvcl1cIlxuICAgICAgICB2YXIgaXNJRSA9IC8qQGNjX29uIUAqL2ZhbHNlIHx8ICEhZG9jdW1lbnQuZG9jdW1lbnRNb2RlOyAvLyBJbnRlcm5ldCBFeHBsb3JlciA2LTExXG4gICAgICAgIGlmIChpc0lFKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoXCJpcy1pZVwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXNFZGdlID0gIWlzSUUgJiYgISF3aW5kb3cuU3R5bGVNZWRpYTsgLy8gRWRnZSAyMCtcbiAgICAgICAgdmFyIGlzQ2hyb21lID0gISF3aW5kb3cuY2hyb21lICYmICghIXdpbmRvdy5jaHJvbWUud2Vic3RvcmUgfHwgISF3aW5kb3cuY2hyb21lLnJ1bnRpbWUpOyAvLyBDaHJvbWUgMSAtIDc5XG4gICAgICAgIHZhciBpc0VkZ2VDaHJvbWl1bSA9IGlzQ2hyb21lICYmIChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJFZGdcIikgIT0gLTEpOyAvLyBFZGdlIChiYXNlZCBvbiBjaHJvbWl1bSkgZGV0ZWN0aW9uXG4gICAgICAgIHZhciBpc0JsaW5rID0gKGlzQ2hyb21lIHx8IGlzT3BlcmEpICYmICEhd2luZG93LkNTUzsgLy8gQmxpbmsgZW5naW5lIGRldGVjdGlvblxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGluaXQ6IGluaXQsXG4gICAgICAgIGxvZ2luRGVmYXVsdEluaXQ6IGxvZ2luRGVmYXVsdEluaXQsXG4gICAgICAgIGxvZ2luQmVoYXZpb3VyOiBsb2dpbkJlaGF2aW91cixcbiAgICAgICAgY2xvc2VBbGxNZW51czogY2xvc2VBbGxNZW51cyxcbiAgICAgICAgdG9nZ2xlSGVhZGVyRXhwYW5kZWQ6IHRvZ2dsZUhlYWRlckV4cGFuZGVkLFxuICAgICAgICByZW1vdmVIZWFkZXJPdmVybGF5OiByZW1vdmVIZWFkZXJPdmVybGF5LFxuICAgICAgICBjaGtEZXZpY2U6IGNoa0RldmljZSxcbiAgICAgICAgY2hrQnJvd3NlcjogY2hrQnJvd3NlclxuICAgIH07XG5cbiAgfSgpKTtcblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCBmdW5jdGlvbigpe1xuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtcmVmYWN0b3InKS5sZW5ndGgpIHtcbiAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1oZWFkZXInKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBoZWFkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtaGVhZGVyXCIpO1xuXG4gICAgICAgICAgICBCU0hlYWRlck5ldy5jaGtEZXZpY2UoaGVhZGVyKTtcblxuICAgICAgICAgICAgLy8gQ29ycmXDp8OjbyBJTjU2MzQyOTJcbiAgICAgICAgICAgIGlmICgoXCIgXCIgKyBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmNsYXNzTmFtZSArIFwiIFwiKS5pbmRleE9mKFwiYnMtZm9ybV9fZmllbGRcIikgPCAtMSkge1xuICAgICAgICAgICAgICAgIEJTSGVhZGVyTmV3LnJlbW92ZUhlYWRlck92ZXJsYXkoKTtcbiAgICAgICAgICAgICAgICBCU0hlYWRlck5ldy5jbG9zZUFsbE1lbnVzKGhlYWRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAqIEluaXQgTmV3IEhlYWRlciBDb25zdHJ1Y3RvclxuICAqIEByZXR1cm4ge3ZvaWR9IEJTSGVhZGVyTmV3LmluaXQoKTtcbiAgKi9cbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXJlZmFjdG9yJykubGVuZ3RoKSB7XG4gICAgICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtaGVhZGVyJykubGVuZ3RoKSB7XG4gICAgICAgICAgICBCU0hlYWRlck5ldy5pbml0KCk7XG4gICAgICAgICAgICAvLyBCU0hlYWRlck5ldy5jaGtCcm93c2VyKCk7XG4gICAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIC8vIEFjZXNzaWJpbGlkYWRlXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIga2V5UHJlc3NlZCA9IGUua2V5Q29kZTtcblxuICAgIC8vIE5hdmVnYcOnw6NvIG1lbnUgTG9naW5cbiAgICB2YXIgbG9naW5NZW51cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJypbaWRePVwiYnRuLWxvZ2luLVwiXScpO1xuICAgIHZhciBsb2dpblN1Yk1lbnVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnKltpZF49XCJzdWJtZW51LWxvZ2luLVwiXScpO1xuXG4gICAgLy8gTWVudVxuICAgIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50LmlkLmluZGV4T2YoXCJidG4tbG9naW4tXCIpID4gLTEpIHtcblxuICAgICAgICB2YXIgY3VycmVudExvZ2luTWVudSA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuaWQ7XG4gICAgICAgIGN1cnJlbnRMb2dpbk1lbnUgPSBwYXJzZUludChjdXJyZW50TG9naW5NZW51LnJlcGxhY2UoL15cXEQrL2csICcnKSk7XG5cbiAgICAgICAgdmFyIGN1cnJlbnRJdGVtRWxzID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcblxuICAgICAgICAvL8OabHRpbW8gaXRlbSBkbyBtZW51OiBQcmVzdGFkb3IgZGUgU2VydmnDp29zXG4gICAgICAgIHZhciBsYXN0SXRlbUVscyA9IGxvZ2luTWVudXNbbG9naW5NZW51cy5sZW5ndGggLSAxXTtcblxuICAgICAgICAvL0JvdMOjbyBQcmluY2lwYWwgTG9naW5cbiAgICAgICAgdmFyIGJ0bl9sb2dpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1idXR0b24tLWxvZ2luXCIpWzBdO1xuXG4gICAgICAgIC8vSXRlbSBwZXNzb2FsIGbDrXNpY2FcbiAgICAgICAgLy92YXIgZmlyc3RJdGVtTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuLWxvZ2luLVwiICsgKGN1cnJlbnRMb2dpbk1lbnUgLSAxKSkuZm9jdXMoKTtcblxuICAgICAgICBzd2l0Y2ggKGtleVByZXNzZWQpIHtcblxuICAgICAgICAgICAgLy8gVGFiXG4gICAgICAgICAgICBjYXNlIDk6XG5cbiAgICAgICAgICAgICAgICAvL0l0ZW0gUGVzc29hIEbDrXNpY2FcbiAgICAgICAgICAgICAgICAvL2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuLWxvZ2luLVwiICsgKGN1cnJlbnRMb2dpbk1lbnUgLSAxKSkuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiTnVtZXJvIGRvIGl0ZW06IFwiLCBjdXJyZW50TG9naW5NZW51KTtcblxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgIC8vTmF2ZWdhw6fDo28gVEFCIHBvciBzaGlmdFxuICAgICAgICAgICAgICAgIGlmIChlLnNoaWZ0S2V5KSB7XG5cbiAgICAgICAgICAgICAgICAgIC8vU2UgZm9yIG8gaXRlbSBhbnRlcyBkbyDDumx0aW1vIGl0ZW1cbiAgICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRMb2dpbk1lbnUgLSAxID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIEJTSGVhZGVyTmV3LnJlbW92ZUhlYWRlck92ZXJsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgYnRuX2xvZ2luLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuLWxvZ2luLVwiICsgKGN1cnJlbnRMb2dpbk1lbnUgLSAxKSkuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL05hdmVnYcOnw6NvIFRBQiBub3JtYWxcbiAgICAgICAgICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRMb2dpbk1lbnUgKyAxIDwgbG9naW5NZW51cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidG4tbG9naW4tXCIgKyAoY3VycmVudExvZ2luTWVudSArIDEpKS5mb2N1cygpO1xuXG4gICAgICAgICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIEJTSGVhZGVyTmV3LnJlbW92ZUhlYWRlck92ZXJsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgYnRuX2xvZ2luLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TG9naW5NZW51ICsgMSA8IGxvZ2luTWVudXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJ0bi1sb2dpbi1cIiArIChjdXJyZW50TG9naW5NZW51ICsgMSkpLmZvY3VzKCk7XG5cbiAgICAgICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgICBCU0hlYWRlck5ldy5yZW1vdmVIZWFkZXJPdmVybGF5KCk7XG4gICAgICAgICAgICAgICAgICBidG5fbG9naW4uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAvLyBTZXRhIHBhcmEgY2ltYVxuICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudExvZ2luTWVudSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidG4tbG9naW4tXCIgKyAoY3VycmVudExvZ2luTWVudSAtIDEpKS5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuLWxvZ2luLVwiICsgKGxvZ2luTWVudXMubGVuZ3RoIC0gMSkpLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgLy8gU2V0YSBwYXJhIGRpcmVpdGFcbiAgICAgICAgICAgIGNhc2UgMzk6XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5jbGljaygpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgLy8gU2V0YSBwYXJhIGJhaXhvXG4gICAgICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50TG9naW5NZW51ICsgMSA8IGxvZ2luTWVudXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuLWxvZ2luLVwiICsgKGN1cnJlbnRMb2dpbk1lbnUgKyAxKSkuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJ0bi1sb2dpbi0wXCIpLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gU3VibWVudVxuICAgIGlmICgoXCIgXCIgKyBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmNsYXNzTmFtZSArIFwiIFwiKS5yZXBsYWNlKC9bXFxuXFx0XS9nLCBcIiBcIikuaW5kZXhPZihcIiBicy1vcHRpb24tc3ViLWl0ZW0gXCIpID4gLTEpIHtcbiAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQucGFyZW50Tm9kZS5pZC5pbmRleE9mKFwic3VibWVudS1sb2dpbi1cIikgPiAtMSkge1xuXG4gICAgICAgICAgICB2YXIgYnRuX2xvZ2luID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLWJ1dHRvbi0tbG9naW5cIilbMF07XG5cbiAgICAgICAgICAgIHZhciBjdXJyZW50TG9naW5TdWJtZW51ID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5wYXJlbnROb2RlLmlkO1xuICAgICAgICAgICAgY3VycmVudExvZ2luU3VibWVudSA9IHBhcnNlSW50KGN1cnJlbnRMb2dpblN1Ym1lbnUucmVwbGFjZSgvXlxcRCsvZywgJycpKTtcblxuICAgICAgICAgICAgdmFyIGN1cnJlbnRMaW5rU3VibWVudSA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuY2xhc3NOYW1lO1xuICAgICAgICAgICAgY3VycmVudExpbmtTdWJtZW51ID0gcGFyc2VJbnQoY3VycmVudExpbmtTdWJtZW51LnJlcGxhY2UoL15cXEQrL2csICcnKSk7XG5cbiAgICAgICAgICAgIHZhciBsb2dpblN1Ym1lbnVzID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1vcHRpb24tc3ViLWl0ZW1cIik7XG4gICAgICAgICAgICB2YXIgZmlyc3RGb2N1c2FibGVFbCA9IGxvZ2luU3VibWVudXNbMF07XG4gICAgICAgICAgICB2YXIgbGFzdEZvY3VzYWJsZUVsICA9IGxvZ2luU3VibWVudXNbbG9naW5TdWJtZW51cy5sZW5ndGggLTFdO1xuICAgICAgICAgICAgdmFyIGFjdGl2ZUZvY3VzYWJsZUVsID0gIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG5cbiAgICAgICAgICAgIHN3aXRjaCAoa2V5UHJlc3NlZCkge1xuXG4gICAgICAgICAgICAgICAgLy8gVGFiXG4gICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOdW1lcm8gZG8gaXRlbTogXCIsIGN1cnJlbnRMaW5rU3VibWVudSAtIDEpO1xuXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRMaW5rU3VibWVudSArIDEgPCBsb2dpblN1Ym1lbnVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQucGFyZW50Tm9kZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiaXRlbS1cIiArIChjdXJyZW50TGlua1N1Ym1lbnUgKyAxKSlbMF0uZm9jdXMoKTtcblxuICAgICAgICAgICAgICAgICAgICAgIGlmIChlLnNoaWZ0S2V5KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRMaW5rU3VibWVudSAtIDEgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZNZW51ID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuLWxvZ2luLVwiICsgKGN1cnJlbnRMb2dpblN1Ym1lbnUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldk1lbnUuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQucGFyZW50Tm9kZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiaXRlbS1cIiArIChjdXJyZW50TGlua1N1Ym1lbnUgLSAxKSlbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRNZW51ID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuLWxvZ2luLVwiICsgKGN1cnJlbnRMb2dpblN1Ym1lbnUgKyAxKSk7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQucGFyZW50Tm9kZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiaXRlbS1cIiArIChjdXJyZW50TGlua1N1Ym1lbnUgLSAxKSlbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRNZW51ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0TWVudS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJ0bi1sb2dpbi1cIiArIChjdXJyZW50TG9naW5TdWJtZW51ICsgMSkpLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBCU0hlYWRlck5ldy5yZW1vdmVIZWFkZXJPdmVybGF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGJ0bl9sb2dpbi5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAvLyBTZXRhIHBhcmEgZXNxdWVyZGFcbiAgICAgICAgICAgICAgICBjYXNlIDM3OlxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJ0bi1sb2dpbi1cIiArIChjdXJyZW50TG9naW5TdWJtZW51KSkuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0YSBwYXJhIGNpbWFcbiAgICAgICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudExpbmtTdWJtZW51ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJpdGVtLVwiICsgKGN1cnJlbnRMaW5rU3VibWVudSAtIDEpKVswXS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJpdGVtLVwiICsgKGxvZ2luU3VibWVudXMubGVuZ3RoIC0gMSkpWzBdLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0YSBwYXJhIGJhaXhvXG4gICAgICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRMaW5rU3VibWVudSArIDEgPCBsb2dpblN1Ym1lbnVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5wYXJlbnROb2RlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJpdGVtLVwiICsgKGN1cnJlbnRMaW5rU3VibWVudSArIDEpKVswXS5mb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRNZW51ID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuLWxvZ2luLVwiICsgKGN1cnJlbnRMb2dpblN1Ym1lbnUgKyAxKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dE1lbnUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuLWxvZ2luLVwiICsgKGN1cnJlbnRMb2dpblN1Ym1lbnUgKyAxKSkuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidG4tbG9naW4tXCIgKyAoY3VycmVudExvZ2luU3VibWVudSArIDEpKS5jbGFzc0xpc3QuY29udGFpbnMoJ2JzLW9wdGlvbi10aXRsZS1ub3N1Yml0ZW1zJykpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJ0bi1sb2dpbi1cIiArIChjdXJyZW50TG9naW5TdWJtZW51ICsgMSkpLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRTdWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN1Ym1lbnUtbG9naW4tXCIgKyAoY3VycmVudExvZ2luU3VibWVudSArIDEpKS5jaGlsZE5vZGVzWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRTdWIuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgQlNIZWFkZXJOZXcucmVtb3ZlSGVhZGVyT3ZlcmxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBidG5fbG9naW4uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICB9KTtcblxuIiwidmFyIEljb25NZWRpYVJlZmFjdG9yZWQgPSAoZnVuY3Rpb24gKCkge1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGJveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1tZWRpYV9faXRlbS0tbm9uZSAuYnMtbWVkaWFfX2JveC0tY29udGVudCcpO1xuXG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGJveC5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGl0ZW0gPSBib3hbaV07XG5cbiAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5icy1idXR0b24tbGluaycpLmNsaWNrKCk7XG4gICAgICB9KVxuXG4gICAgICAvL0FjZXNzYW5kbyBMaW5rIHZpYSB0YWJcbiAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCkge1xuXG4gICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzIHx8IGV2ZW50LmtleSA9PT0gXCJFbnRlclwiKSB7XG4gICAgICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5icy1idXR0b24tbGluaycpLmNsaWNrKCk7XG4gICAgICAgICAgfVxuXG4gICAgICB9KVxuXG5cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IE1vZGFsIENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmljb24tbWVkaWEtcmVmJykubGVuZ3RoKSB7XG4gICAgSWNvbk1lZGlhUmVmYWN0b3JlZC5pbml0KCk7XG4gIH1cbn0pO1xuIiwiLy8gLy8gSW5pY2lhIG1vZGFsIGRlIGNvbmZpZ3VyYcOnw6NvIGRvcyBjb29raWVzXG4vLyBmdW5jdGlvbiBjb25maWd1cmFyQ29va2llKCkge1xuLy8gICB2YXIgYnRuQ29uZmlndXJhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1jb25maWd1cmFyJyk7XG5cbi8vICAgYnRuQ29uZmlndXJhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4vLyAgICAgYWJyZU1vZGFsKFwianMtbW9kYWxcIik7XG4vLyAgIH0pXG4vLyB9XG5cbi8vIFZhcmlhdmVpcyBnbG9iYWlzXG52YXIgY3RhQ29va2llID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5qcy1jb29raWVcIik7XG52YXIgbm9tZUNsYXNzZSwgYXJyO1xuXG4vLyBGdW7Dp8OjbyBwYXJhIGdyYXZhciBjb29raWVcbmZ1bmN0aW9uIGFjZWl0YXJDb29raWUoKSB7XG4gIHZhciBidG5BY2VpdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5qcy1hY2VpdGFyXCIpO1xuXG4gIG5vbWVDbGFzc2UgPSBcImlzLWhpZGRlblwiO1xuICBub21lQ2xhc3NlSGlkZSA9IFwiaXMtdmlzaWJsZVwiO1xuICBhcnIgPSBjdGFDb29raWUuY2xhc3NOYW1lLnNwbGl0KFwiIFwiKTtcblxuICAvLyBWZXJpZmljYSBzZSBow6EgbyBub21lIGRvIGNvb2tpZSBzZSwgZXhpc3RpciBlbGUgbsOjbyBzZXLDoSBleGliaWRvIG5vIHByb3hpbW8gYWNlc3NvIG5vIHBlcmlvZG8gZGUgMTIgbWVzZXNcbiAgaWYgKCFDb29raWVzLmdldCgnbGdwZCcpKSB7XG4gICAgLy8gYWRpY2lvbmEgY2xhc3NlIGlzLWhpZGRlbiAoY29tcGF0aXZlbCBjb20gdG9kb3MgbmF2ZWdhZG9yZXMpXG4gICAgY3RhQ29va2llLmNsYXNzTmFtZSArPSBcIiBcIiArIG5vbWVDbGFzc2VIaWRlO1xufSBlbHNlIHtcbiAgICBjdGFDb29raWUuY2xhc3NOYW1lICs9IFwiIFwiICsgbm9tZUNsYXNzZTtcbiAgfVxuXG4gIGJ0bkFjZWl0YXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgLy8gRGVmaW5pw6fDo28gZG8gQ29va2llIC0gY2hhdmUgLCB2YWxvciBlIGV4cGlyZXMgKGRhdGEgZGUgZXhwaXJhw6fDo28pXG4gICAgQ29va2llcy5zZXQoJ2xncGQnLCB0cnVlLCB7XG4gICAgICBleHBpcmVzOiAzNjVcbiAgICB9KVxuXG4gICAgaWYgKCFhcnIuaW5kZXhPZihub21lQ2xhc3NlKSA9PSAtMSkge1xuICAgICAgY3RhQ29va2llLmNsYXNzTmFtZSArPSBcIiBcIiArIG5vbWVDbGFzc2VIaWRlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0ZXN0cmUnKTtcbiAgICAgIGN0YUNvb2tpZS5jbGFzc05hbWUgKz0gXCIgXCIgKyBub21lQ2xhc3NlO1xuICAgICAgICB2YXIgZWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvb2tpZXMuanMtY29va2llLmlzLXZpc2libGUnKVxuICAgICAgICBmdW5jdGlvbiByZW1vdmVFbGVtKCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBlbHNbaV0uY2xhc3NMaXN0LnJlbW92ZSgnaXMtdmlzaWJsZScpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVtb3ZlRWxlbSgpO1xuICAgIH1cbiAgfSk7XG5cbn07XG5cbi8vIEZ1bsOnw6NvIGFwZW5hcyBwYXJhIGZlY2hhciBvIGVsZW1udG8gY29va2llcyBjb21wbGV0b1xuZnVuY3Rpb24gZmVjaGFyQ29va2llKCkge1xuICB2YXIgYnRuRmVjaGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWZlY2hhcicpO1xuXG4gIG5vbWVDbGFzc2UgPSBcImlzLWhpZGRlblwiO1xuICBhcnIgPSBjdGFDb29raWUuY2xhc3NOYW1lLnNwbGl0KFwiIFwiKTtcblxuICBidG5GZWNoYXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcblxuICAgIGlmICghYXJyLmluZGV4T2Yobm9tZUNsYXNzZSkgPT0gLTEpIHtcbiAgICAgIGN0YUNvb2tpZS5jbGFzc05hbWUgKz0gXCIgXCIgKyBub21lQ2xhc3NlSGlkZTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3RhQ29va2llLmNsYXNzTmFtZSArPSBcIiBcIiArIG5vbWVDbGFzc2U7XG4gICAgICB2YXIgZWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvb2tpZXMuanMtY29va2llLmlzLXZpc2libGUnKVxuXG4gICAgICBmdW5jdGlvbiByZW1vdmVFbGVtKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGVsc1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdpcy12aXNpYmxlJylcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVtb3ZlRWxlbSgpO1xuICAgIH1cbiAgfSk7XG59O1xuXG4vLyBEZWZpbmkgY29va2llIG5vbWUsIHZhbG9yIGUgZGlhc1xuZnVuY3Rpb24gZGVmaW5pckNvb2tpZShub21lLCB2YWxvciwgZGlhcykge1xuICB2YXIgaG9qZSA9IG5ldyBEYXRlKCk7XG4gIGhvamUuc2V0VGltZShob2plLmdldFRpbWUoKSArIChkaWFzICogMjQgKiA2MCAqIDYwICogMTAwMCkpO1xuICB2YXIgZXhwaXJhID0gXCJleHBpcmVzPVwiICsgaG9qZS50b0dNVFN0cmluZygpO1xuICBkb2N1bWVudC5jb29raWUgPSBub21lICsgXCI9XCIgKyB2YWxvciArIFwiO1wiICsgZXhwaXJhICsgXCI7cGF0aD0vXCI7XG59O1xuXG4vLyBPYnRlbSBvIHZhbG9yIGRvIGNvb2tpZVxuZnVuY3Rpb24gb2J0ZXJDb29raWUoY25vbWUpIHtcblxuICB2YXIgbm9tZSA9IGNub21lICsgXCI9XCI7XG4gIHZhciBjYSA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGNhLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGMgPSBjYVtpXTtcbiAgICB3aGlsZSAoYy5jaGFyQXQoMCkgPT0gJyAnKSB7XG4gICAgICBjID0gYy5zdWJzdHJpbmcoMSk7XG4gICAgfVxuICAgIGlmIChjLmluZGV4T2Yobm9tZSkgPT0gMCkge1xuICAgICAgcmV0dXJuIGMgPSBjLnN1YnN0cmluZyhub21lLmxlbmd0aCwgYy5sZW5ndGgpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gXCIgXCI7XG59O1xuXG4vLyBJbmljaWxpemEgdG9kYXMgYXMgZnVuw6fDtWVzXG5mdW5jdGlvbiBpbml0KCkge1xuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuanMtY29va2llJykubGVuZ3RoKSB7XG4gICAgICAgIGZlY2hhckNvb2tpZSgpO1xuICAgICAgICBhY2VpdGFyQ29va2llKCk7XG4gICAgICAgIC8vIGNvbmZpZ3VyYXJDb29raWUoKTtcbiAgICAgICAgfVxufTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXQpO1xuIiwiLyoqXG4gKiBCc0xpc3RBY2NvcmRpb25cbiAqL1xudmFyIEJzTGlzdEFjY29yZGlvbiA9IChmdW5jdGlvbiAoKSB7XG4gIHZhciBjb25maWcgPSB7fTtcblxuICB2YXIgc2V0Q29uZmlnID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgICBsaXN0OiAnLmJzLWpzLWxpc3QtYWNjb3JkaW9uJyxcbiAgICAgIGl0ZW06ICcuYnMtanMtbGlzdC1hY2NvcmRpb25fX2l0ZW0nLFxuICAgICAgdG9nZ2xlQnV0dG9uOiAnLmJzLWpzLWxpc3QtYWNjb3JkaW9uX190b2dnbGUnLFxuICAgICAgaXRlbUV4cGFuZGVkQ2xhc3M6ICdicy1pcy1leHBhbmRlZCcsXG4gICAgfTtcblxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucyAhPT0gJ29iamVjdCcpIG9wdGlvbnMgPSB7fTtcbiAgICByZXR1cm4gZXh0ZW5kKHt9LCBkZWZhdWx0cywgb3B0aW9ucyk7XG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgIHZhciBsaXN0QWNjb3JkaW9uO1xuXG4gICAgY29uZmlnID0gc2V0Q29uZmlnKG9wdGlvbnMpO1xuICAgIGxpc3RBY2NvcmRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5saXN0KTtcblxuICAgIGlmICghbGlzdEFjY29yZGlvbi5sZW5ndGgpIHJldHVybjtcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwobGlzdEFjY29yZGlvbiwgZnVuY3Rpb24gKGxpc3QpIHtcbiAgICAgIHZhciBpdGVtcyA9IGxpc3QucXVlcnlTZWxlY3RvckFsbChjb25maWcuaXRlbSk7XG5cbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHZhciBidXR0b24gPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnRvZ2dsZUJ1dHRvbik7XG5cbiAgICAgICAgaWYgKGJ1dHRvbikge1xuICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRvZ2dsZUl0ZW0oaXRlbSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBleHRlbmQgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG5cbiAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfTtcblxuICB2YXIgZXhwYW5kSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaXRlbS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pdGVtRXhwYW5kZWRDbGFzcyk7XG4gIH07XG5cbiAgdmFyIGNvbGxhcHNlSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pdGVtRXhwYW5kZWRDbGFzcyk7XG4gIH07XG5cbiAgdmFyIHRvZ2dsZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIGlmIChpdGVtSXNFeHBhbmRlZChpdGVtKSkgY29sbGFwc2VJdGVtKGl0ZW0pO1xuICAgIGVsc2UgZXhwYW5kSXRlbShpdGVtKTtcbiAgfTtcblxuICB2YXIgaXRlbUlzRXhwYW5kZWQgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIHJldHVybiBpdGVtLmNsYXNzTGlzdC5jb250YWlucyhjb25maWcuaXRlbUV4cGFuZGVkQ2xhc3MpO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICBleHBhbmQ6IGV4cGFuZEl0ZW0sXG4gICAgY29sbGFwc2U6IGNvbGxhcHNlSXRlbSxcbiAgICB0b2dnbGU6IHRvZ2dsZUl0ZW0sXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgTGlzdEFjY29yZGlvbiBjb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gTGlzdEFjY29yZGlvbi5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtbGlzdC1kZXNjcmlwdGlvbi0tYWNjb3JkaW9uJykubGVuZ3RoKSB7XG4gICAgQnNMaXN0QWNjb3JkaW9uLmluaXQoe1xuICAgICAgaXRlbTogJy5icy1saXN0LWRlc2NyaXB0aW9uX19pdGVtJyxcbiAgICAgIHRvZ2dsZUJ1dHRvbjogJy5icy1saXN0LWRlc2NyaXB0aW9uX190aXRsZScsXG4gICAgfSk7XG4gIH1cbn0pO1xuIiwidmFyIEJzRG93bmxvYWRzTGlzdCA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7XG4gIC8vIENvbmZpZyBMaXN0IGFuZCBTZWxlY3RcbiAgdmFyIGVsZW0gPSBlbGVtZW50O1xuICB2YXIgY29uZmlnID0ge307XG4gIHZhciBzZXRDb25maWcgPSBmdW5jdGlvbiAoZWwpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZWw6IGVsLFxuICAgICAgYm9keTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLFxuICAgICAgaXRlbXM6IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1kb3dubG9hZF9faXRlbScpLFxuICAgICAgaXRlbXNJbnB1dDogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWRvd25sb2Fkcy1pbnB1dCcpLFxuICAgICAgZ3JvdXBJbnB1dDogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWRvd25sb2Fkcy1zZWxlY3QtYWxsJyksXG4gICAgICBmaWx0ZXJGb3JtOiBlbC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtZG93bmxvYWRzLWZpbHRlcicpLFxuICAgICAgZmlsdGVySW5wdXRzOiBlbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtZG93bmxvYWRzLWZpbHRlciAuYnMtZm9ybV9fZmllbGQnKSxcbiAgICAgIGNhdGVnb3JpZXM6IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1kb3dubG9hZF9fbGlzdCcpLFxuICAgICAgYWNjb3JkaW9uQnV0dG9uOiBlbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtb3Blbi1hY2NvcmRpb24nKSxcbiAgICAgIGFjY29yZGlvbjogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWRvd25sb2FkX19jb250ZW50LS1hY2NvcmRpb24nKSxcbiAgICAgIGFjY29yZGlvbkxpc3Q6IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1kb3dubG9hZF9fbGlzdCcpLFxuICAgICAgZG93bmxvYWRCdXR0b246IGVsLnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1kb3dubG9hZHMtYnV0dG9uJyksXG4gICAgICBhY2NvcmRpb25Db250ZW50Q2xhc3M6ICdicy1qcy1kb3dubG9hZF9fY29udGVudC0tYWNjb3JkaW9uJyxcbiAgICAgIG11bHRpRG93bmxvYWRGb3JtQ2xhc3M6ICdicy1qcy1kb3dubG9hZC1tdWx0aS1mb3JtJyxcbiAgICAgIGhhc0FjY29yZGlvbkNsYXNzOiAnYnMtZG93bmxvYWQtLWFjY29yZGlvbicsXG4gICAgICBpdGVtQWN0aXZlQ2xhc3M6ICdicy1kb3dubG9hZF9faXRlbS0tYWN0aXZlJyxcbiAgICAgIGNhdGVnb3J5QWN0aXZlQ2xhc3M6ICdicy1kb3dubG9hZF9fbGlzdC0tYWN0aXZlJyxcbiAgICAgIGFjY29yZGlvbk9wZW5DbGFzczogJ2JzLWRvd25sb2FkX19saXN0LS1vcGVuJyxcbiAgICAgIGFjY29yZGlvblJlc2l6ZXI6IG51bGwsXG4gICAgICBsYXN0SW5wdXRDaGVja2VkOiBudWxsLFxuICAgICAgemlwT25DbGllbnQ6IHRydWUsXG4gICAgICB6aXBGaWxlSWQ6IG51bGwsXG4gICAgICBkb3dubG9hZFByb2dyZXNzOiBuZXcgQnNTbmFja1Byb2dyZXNzKCksXG4gICAgICBkb3dubG9hZElzQWN0aXZlOiBmYWxzZSxcbiAgICAgIGtleU1hcDoge30sXG4gICAgfTtcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIWVsZW0gfHwgdHlwZW9mIGVsZW0gIT09ICdvYmplY3QnKSByZXR1cm47XG4gICAgY29uZmlnID0gc2V0Q29uZmlnKGVsZW0pO1xuXG4gICAgLy8gSWYgZWxlbWVudCBhbGxvdyBtdWx0aSBkb3dubG9hZFxuICAgIGlmIChoYXNNdWx0aURvd25sb2FkKCkpIHtcbiAgICAgIC8vIHByZXZlbnQgZm9ybSBzdWJtaXRcbiAgICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGFkZERvd25sb2FkTGlzdGVuZXIoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBJbml0IGRvd25sb2FkIHByb2dyZXNzXG4gICAgICBjb25maWcuZG93bmxvYWRQcm9ncmVzcy5pbml0KCk7XG4gICAgICBjb25maWcuZG93bmxvYWRQcm9ncmVzcy5lbGVtZW50cy5wcm9ncmVzcy5pZCA9IGVsZW0uaWQgKyAnLXByb2dyZXNzJztcbiAgICAgIGNvbmZpZy5kb3dubG9hZFByb2dyZXNzLm9uQ2FuY2VsKGFib3J0ZG93bmxvYWQpO1xuICAgIH1cblxuICAgIC8vIGhhbmRsZSBrZXlib2FyZFxuICAgIGlmIChoYXNBY2NvcmRpb24oKSkgY29uZmlnLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVBY2NvcmRpb25LZXlib2FyZCk7XG5cbiAgICAvLyBoYW5kbGUga2V5Ym9hcmRcbiAgICBpZiAoaGFzTXVsdGlEb3dubG9hZCgpKSB7XG4gICAgICBjb25maWcuZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZU11bHRpRG93bmxvYWRLZXlib2FyZCk7XG4gICAgICBjb25maWcuZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgY29uZmlnLmtleU1hcFtldi5rZXldID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoaGFzTXVsdGlEb3dubG9hZCgpICYmIGNvbmZpZy5kb3dubG9hZEJ1dHRvbikge1xuICAgICAgaWYgKGNvbmZpZy5kb3dubG9hZEJ1dHRvbi50eXBlICE9PSAnc3VibWl0Jykge1xuICAgICAgICBjb25maWcuZG93bmxvYWRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhZGREb3dubG9hZExpc3RlbmVyKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBZGQgZXZlbnQgZm9yIGZpbHRlcnNcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5maWx0ZXJJbnB1dHMsIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgaWYgKGlucHV0KSB7XG4gICAgICAgIGlmIChpbnB1dC5uYW1lID09PSAneWVhcicpIGJ1aWxkWWVhclNlbGVjdChpbnB1dCk7XG4gICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIGhhbmRsZUZpbHRlcnMoZXZlbnQudGFyZ2V0KTtcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHVuY2hlY2tBbGxJdGVtcyhnZXRJbmFjdGl2ZUl0ZW1zKCkpO1xuICAgICAgICAgICAgb3BlbkFsbEFjY29yZGlvbnMoKTtcbiAgICAgICAgICAgIGFkanVzdEFjY29yZGlvbkl0ZW1zSGVpZ2h0KCk7XG4gICAgICAgICAgfSwgMzAwKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBUb2dnbGUgYWNjb3JkaW9uIGl0ZW0gb24gY2xpY2tcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5hY2NvcmRpb25CdXR0b24sIGZ1bmN0aW9uIChlbCkge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgJ2NsaWNrJyxcbiAgICAgICAgdG9nZ2xlQWNjb3JkaW9uSXRlbS5iaW5kKG51bGwsIGVsKVxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIC8vIENoZWNrIGlmIHRoZXJlJ3MgYW4gYWNjb3JkaW9uIGl0ZW0gYWN0aXZlIGFuZCBhZGp1c3QgaXRzIGhlaWdodFxuICAgIGlmIChoYXNBY2NvcmRpb24oKSkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuYWNjb3JkaW9uTGlzdCwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgIHZhciBhY2NPcGVuID0gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5hY2NvcmRpb25PcGVuQ2xhc3MpO1xuXG4gICAgICAgIGlmIChhY2NPcGVuKSB7XG4gICAgICAgICAgdmFyIGNvbnRlbnQgPSBlbC5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5hY2NvcmRpb25Db250ZW50Q2xhc3MpO1xuICAgICAgICAgIHZhciBjb250ZW50SGVpZ2h0ID0gY29udGVudC5zY3JvbGxIZWlnaHQ7XG4gICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZChjb25maWcuYWNjb3JkaW9uT3BlbkNsYXNzKTtcbiAgICAgICAgICBjb250ZW50LnN0eWxlLmhlaWdodCA9IGNvbnRlbnRIZWlnaHQgKyAncHgnO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBBZGQgZXZlbnQgZm9yIGFsbCBjaGVja2JveGVzXG4gICAgaWYgKGNvbmZpZy5pdGVtc0lucHV0ICYmIGNvbmZpZy5pdGVtc0lucHV0Lmxlbmd0aCkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuaXRlbXNJbnB1dCwgZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlSXRlbXNDaGVja2JveCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLmdyb3VwSW5wdXQpIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmdyb3VwSW5wdXQsIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZVNlbGVjdEFsbENoZWNrYm94KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjbGVhclRpbWVvdXQoY29uZmlnLmFjY29yZGlvblJlc2l6ZXIpO1xuICAgICAgY29uZmlnLmFjY29yZGlvblJlc2l6ZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYWRqdXN0QWNjb3JkaW9uSXRlbXNIZWlnaHQoKTtcbiAgICAgIH0sIDMwMCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gQWNjb3JkaW9uXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLyoqXG4gICAqIEhhcyBBY2NvcmRpb24gQ2xhc3NcbiAgICogQHJldHVybiB7W3R5cGVdfSBbZGVzY3JpcHRpb25dXG4gICAqL1xuICB2YXIgaGFzQWNjb3JkaW9uID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjb25maWcuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5oYXNBY2NvcmRpb25DbGFzcylcbiAgICAgIHx8IChjb25maWcuYWNjb3JkaW9uQnV0dG9uICYmIGNvbmZpZy5hY2NvcmRpb25CdXR0b24ubGVuZ3RoKTtcbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2sgaWYgYWNjb3JkaW9uIGl0ZW0ncyBleHBhbmRlZFxuICAgKiBAcGFyYW0gIHtvYmplY3R9ICBlbCAgYW4gSFRNTCBlbGVtZW50IG9mIHRoZSBhY2NvcmRpb24gaXRlbVxuICAgKiBAcmV0dXJuIHtib29sZWFufSAgICAgdHJ1ZSBpZiBhY2NvcmRpb24gaXRlbSBpcyBvcGVuXG4gICAqL1xuICB2YXIgaXNBY2NvcmRpb25PcGVuID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgdmFyIGl0ZW0gPSBnZXRQYXJlbnQoZWwsICdicy1kb3dubG9hZF9fbGlzdCcpO1xuICAgIC8vIHZhciBpdGVtMiA9IGNsb3Nlc3QoZWwsICcuYnMtZG93bmxvYWRfX2xpc3QnKTtcbiAgICAvLyBkZWJ1Z2dlcjtcbiAgICByZXR1cm4gaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmFjY29yZGlvbk9wZW5DbGFzcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIHRvZ2dsZSBBY2NvcmRpb24gSXRlbVxuICAgKiBAcGFyYW0gIHtvYmplY3R9IGVsIEhUTUwgZWxlbWVudCBvZiB0aGUgYWNjb3JkaW9uIGl0ZW1cbiAgICogQHJldHVybiB7dm9pZH1cbiAgICovXG4gIHZhciB0b2dnbGVBY2NvcmRpb25JdGVtID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgaWYgKGlzQWNjb3JkaW9uT3BlbihlbCkpIGNsb3NlQWNjb3JkaW9uSXRlbShlbCk7XG4gICAgZWxzZSBvcGVuQWNjb3JkaW9uSXRlbShlbCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIG9wZW4gQWNjb3JkaW9uIEl0ZW1cbiAgICogQHBhcmFtICB7b2JqZWN0fSBlbCBIVE1MIGVsZW1lbnQgb2YgdGhlIGFjY29yZGlvbiBpdGVtXG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICB2YXIgb3BlbkFjY29yZGlvbkl0ZW0gPSBmdW5jdGlvbiAoZWwpIHtcbiAgICB2YXIgaXRlbSA9IGdldFBhcmVudChlbCwgJ2JzLWRvd25sb2FkX19saXN0Jyk7XG4gICAgdmFyIGNvbnRlbnQgPSBpdGVtLnF1ZXJ5U2VsZWN0b3IoJy4nICsgY29uZmlnLmFjY29yZGlvbkNvbnRlbnRDbGFzcyk7XG4gICAgdmFyIGNvbnRlbnRIZWlnaHQgPSBjb250ZW50LnNjcm9sbEhlaWdodDtcblxuICAgIGVsLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICd0cnVlJyk7XG4gICAgaXRlbS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5hY2NvcmRpb25PcGVuQ2xhc3MpO1xuICAgIGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gY29udGVudEhlaWdodCArICdweCc7XG4gIH07XG5cbiAgLyoqXG4gICAqIGNsb3NlIEFjY29yZGlvbiBJdGVtXG4gICAqIEBwYXJhbSAge29iamVjdH0gZWwgSFRNTCBlbGVtZW50IG9mIHRoZSBhY2NvcmRpb24gaXRlbVxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgdmFyIGNsb3NlQWNjb3JkaW9uSXRlbSA9IGZ1bmN0aW9uIChlbCkge1xuICAgIHZhciBpdGVtID0gZ2V0UGFyZW50KGVsLCAnYnMtZG93bmxvYWRfX2xpc3QnKTtcbiAgICB2YXIgY29udGVudCA9IGl0ZW0ucXVlcnlTZWxlY3RvcignLicgKyBjb25maWcuYWNjb3JkaW9uQ29udGVudENsYXNzKTtcblxuICAgIGVsLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShjb25maWcuYWNjb3JkaW9uT3BlbkNsYXNzKTtcbiAgICBjb250ZW50LnN0eWxlLmhlaWdodCA9IDA7XG4gIH07XG5cbiAgdmFyIG9wZW5BbGxBY2NvcmRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChjb25maWcuYWNjb3JkaW9uQnV0dG9uICYmIGNvbmZpZy5hY2NvcmRpb25CdXR0b24ubGVuZ3RoKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5hY2NvcmRpb25CdXR0b24sIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICBvcGVuQWNjb3JkaW9uSXRlbShlbCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGNsb3NlQWxsQWNjb3JkaW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoY29uZmlnLmFjY29yZGlvbkJ1dHRvbiAmJiBjb25maWcuYWNjb3JkaW9uQnV0dG9uLmxlbmd0aCkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuYWNjb3JkaW9uQnV0dG9uLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgY2xvc2VBY2NvcmRpb25JdGVtKGVsKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICB2YXIgaGFuZGxlQWNjb3JkaW9uS2V5Ym9hcmQgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICB2YXIgY3VycmVudEVsID0gZXYudGFyZ2V0O1xuICAgIHZhciBrZXkgPSBldi5rZXk7XG4gICAgdmFyIGJ1dHRvbnMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChjb25maWcuYWNjb3JkaW9uQnV0dG9uKTtcbiAgICB2YXIgaXNCdXR0b25Gb2N1c2VkID0gY3VycmVudEVsLmNsYXNzTGlzdC5jb250YWlucygnYnMtanMtb3Blbi1hY2NvcmRpb24nKTtcbiAgICB2YXIgY3VycmVudEJ1dHRvbiA9IChpc0J1dHRvbkZvY3VzZWQpID8gY3VycmVudEVsIDogY3VycmVudEVsLmNsb3Nlc3QoJy5icy1qcy1vcGVuLWFjY29yZGlvbicpO1xuICAgIHZhciBmaXJzdEJ1dHRvbiA9IGJ1dHRvbnNbMF07XG4gICAgdmFyIGxhc3RCdXR0b24gPSBidXR0b25zW2J1dHRvbnMubGVuZ3RoIC0gMV07XG4gICAgdmFyIHByZXZCdXR0b24gPSBidXR0b25zLmluZGV4T2YoY3VycmVudEJ1dHRvbilcbiAgICAgID8gYnV0dG9uc1tidXR0b25zLmluZGV4T2YoY3VycmVudEJ1dHRvbikgLSAxXVxuICAgICAgOiBsYXN0QnV0dG9uO1xuICAgIHZhciBuZXh0QnV0dG9uID0gYnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pIDwgYnV0dG9ucy5sZW5ndGggLSAxXG4gICAgICA/IGJ1dHRvbnNbYnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pICsgMV1cbiAgICAgIDogZmlyc3RCdXR0b247XG4gICAgdmFyIGN1cnJlbnRQYW5lbDtcbiAgICB2YXIgcHJldlBhbmVsO1xuICAgIHZhciBwcmV2QnV0dG9uO1xuICAgIHZhciBmaXJzdENoZWNrYm94O1xuICAgIHZhciBwcmV2UGFuZWxDaGVja2JveGVzO1xuICAgIHZhciBhbGxDaGVja2JveGVzO1xuICAgIHZhciBsYXN0Q2hlY2tib3g7XG5cbiAgICBpZiAoaXNCdXR0b25Gb2N1c2VkKSB7XG4gICAgICBhbGxDaGVja2JveGVzID0gY29uZmlnLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1kb3dubG9hZHMtaW5wdXQsIC5icy1qcy1kb3dubG9hZHMtc2VsZWN0LWFsbCcpO1xuICAgICAgbGFzdENoZWNrYm94ID0gYWxsQ2hlY2tib3hlcyAmJiBhbGxDaGVja2JveGVzLmxlbmd0aCAmJiBhbGxDaGVja2JveGVzW2FsbENoZWNrYm94ZXMubGVuZ3RoIC0gMV07XG4gICAgICBjdXJyZW50UGFuZWwgPSBjdXJyZW50QnV0dG9uLmNsb3Nlc3QoJy5icy1kb3dubG9hZF9fbGlzdCcpO1xuICAgICAgcHJldlBhbmVsID0gY3VycmVudFBhbmVsLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG4gICAgICBwcmV2QnV0dG9uID0gcHJldlBhbmVsICYmIHByZXZQYW5lbC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtb3Blbi1hY2NvcmRpb24nKTtcbiAgICAgIGZpcnN0Q2hlY2tib3ggPSBjdXJyZW50UGFuZWwucXVlcnlTZWxlY3RvcignLmJzLWpzLWRvd25sb2Fkcy1pbnB1dCwgLmJzLWpzLWRvd25sb2Fkcy1zZWxlY3QtYWxsJyk7XG4gICAgICBwcmV2UGFuZWxDaGVja2JveGVzID0gcHJldlBhbmVsICYmIHByZXZQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtZG93bmxvYWRzLWlucHV0LCAuYnMtanMtZG93bmxvYWRzLXNlbGVjdC1hbGwnKTtcbiAgICAgIHByZXZQYW5lbExhc3RDaGVja2JveCA9IHByZXZQYW5lbENoZWNrYm94ZXNcbiAgICAgICAgJiYgcHJldlBhbmVsQ2hlY2tib3hlcy5sZW5ndGhcbiAgICAgICAgJiYgcHJldlBhbmVsQ2hlY2tib3hlc1twcmV2UGFuZWxDaGVja2JveGVzLmxlbmd0aCAtIDFdXG5cbiAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOlxuICAgICAgICBjYXNlICdSaWdodCc6IC8vIGllXG4gICAgICAgICAgaWYgKCFpc0FjY29yZGlvbk9wZW4oY3VycmVudEJ1dHRvbikpIHtcbiAgICAgICAgICAgIG9wZW5BY2NvcmRpb25JdGVtKGN1cnJlbnRCdXR0b24pO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZmlyc3RDaGVja2JveCkge1xuICAgICAgICAgICAgZmlyc3RDaGVja2JveC5mb2N1cygpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdBcnJvd0xlZnQnOlxuICAgICAgICBjYXNlICdMZWZ0JzogLy8gaWVcbiAgICAgICAgICBpZiAoaXNBY2NvcmRpb25PcGVuKGN1cnJlbnRCdXR0b24pKSB7XG4gICAgICAgICAgICBjbG9zZUFjY29yZGlvbkl0ZW0oY3VycmVudEJ1dHRvbik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGZpcnN0Q2hlY2tib3guZm9jdXMoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnQXJyb3dEb3duJzpcbiAgICAgICAgY2FzZSAnRG93bic6IC8vIGllXG4gICAgICAgICAgaWYgKCFpc0FjY29yZGlvbk9wZW4oY3VycmVudEJ1dHRvbikpIHtcbiAgICAgICAgICAgIG5leHRCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGZpcnN0Q2hlY2tib3gpIHtcbiAgICAgICAgICAgIGZpcnN0Q2hlY2tib3guZm9jdXMoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV4dEJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdBcnJvd1VwJzpcbiAgICAgICAgY2FzZSAnVXAnOiAvLyBpZVxuICAgICAgICAgIGlmIChwcmV2QnV0dG9uICYmIGlzQWNjb3JkaW9uT3BlbihwcmV2QnV0dG9uKSAmJiBwcmV2UGFuZWxMYXN0Q2hlY2tib3gpIHtcbiAgICAgICAgICAgIHByZXZQYW5lbExhc3RDaGVja2JveC5mb2N1cygpO1xuICAgICAgICAgIH0gZWxzZSBpZiAocHJldkJ1dHRvbikge1xuICAgICAgICAgICAgcHJldkJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIH0gZWxzZSBpZiAobGFzdENoZWNrYm94ICYmIGlzQWNjb3JkaW9uT3BlbihsYXN0Q2hlY2tib3gpKSB7XG4gICAgICAgICAgICBsYXN0Q2hlY2tib3guZm9jdXMoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGFzdEJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdIb21lJzpcbiAgICAgICAgICBmaXJzdEJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0VuZCc6XG4gICAgICAgICAgbGFzdEJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHZhciBoYW5kbGVNdWx0aURvd25sb2FkS2V5Ym9hcmQgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICB2YXIgY3VycmVudEVsID0gZXYudGFyZ2V0O1xuICAgIHZhciBrZXkgPSBldi5rZXk7XG4gICAgdmFyIGNoZWNrYm94ZXNOb2RlID0gY29uZmlnLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1kb3dubG9hZHMtaW5wdXQsIC5icy1qcy1kb3dubG9hZHMtc2VsZWN0LWFsbCcpO1xuICAgIHZhciBjaGVja2JveGVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoY2hlY2tib3hlc05vZGUpO1xuICAgIHZhciBjdXJyZW50Q2hlY2tib3ggPSAoXG4gICAgICBjdXJyZW50RWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdicy1qcy1kb3dubG9hZHMtaW5wdXQnKVxuICAgICAgfHwgY3VycmVudEVsLmNsYXNzTGlzdC5jb250YWlucygnYnMtanMtZG93bmxvYWRzLXNlbGVjdC1hbGwnKSlcbiAgICAgID8gY3VycmVudEVsXG4gICAgICA6IG51bGw7IC8vIGN1cnJlbnRFbC5jbG9zZXN0KCcuYnMtanMtb3Blbi1hY2NvcmRpb24nKTtcbiAgICB2YXIgZmlyc3RDaGVja2JveCA9IGNoZWNrYm94ZXNbMF07XG4gICAgdmFyIGxhc3RDaGVja2JveCA9IGNoZWNrYm94ZXNbY2hlY2tib3hlcy5sZW5ndGggLSAxXTtcbiAgICB2YXIgcHJldkNoZWNrYm94ID0gY2hlY2tib3hlcy5pbmRleE9mKGN1cnJlbnRDaGVja2JveClcbiAgICAgID8gY2hlY2tib3hlc1tjaGVja2JveGVzLmluZGV4T2YoY3VycmVudENoZWNrYm94KSAtIDFdXG4gICAgICA6IGxhc3RDaGVja2JveDtcbiAgICB2YXIgbmV4dENoZWNrYm94ID0gY2hlY2tib3hlcy5pbmRleE9mKGN1cnJlbnRDaGVja2JveCkgPCBjaGVja2JveGVzLmxlbmd0aCAtIDFcbiAgICAgID8gY2hlY2tib3hlc1tjaGVja2JveGVzLmluZGV4T2YoY3VycmVudENoZWNrYm94KSArIDFdXG4gICAgICA6IGZpcnN0Q2hlY2tib3g7XG4gICAgdmFyIGZpcnN0QnV0dG9uID0gY29uZmlnLmVsLnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1vcGVuLWFjY29yZGlvbicpO1xuICAgIHZhciBjdXJyZW50UGFuZWw7XG4gICAgdmFyIG5leHRQYW5lbDtcbiAgICB2YXIgY3VycmVudEJ1dHRvbjtcbiAgICB2YXIgbmV4dEJ1dHRvbjtcbiAgICB2YXIgcGFuZWxDaGVja2JveGVzO1xuICAgIHZhciBwcmV2UGFuZWw7XG4gICAgdmFyIHByZXZQYW5lbENoZWNrYm94ZXM7XG4gICAgdmFyIHByZXZQYW5lbExhc3RDaGVja2JveDtcbiAgICB2YXIgYWN0aXZlQ2hlY2tib3hlcyA9IGdldEFjdGl2ZUl0ZW1zKCk7XG4gICAgdmFyIGlzQWxsQ2hlY2tlZCA9IGFjdGl2ZUNoZWNrYm94ZXMgJiYgYWN0aXZlQ2hlY2tib3hlcy5ldmVyeShmdW5jdGlvbiAoY2hlY2tJdGVtKSB7XG4gICAgICByZXR1cm4gY2hlY2tJdGVtLmNoZWNrZWQ7XG4gICAgfSk7XG4gICAgdmFyIGFsbEFjY29yZGlvbnM7XG4gICAgdmFyIGZpcnN0QWNjb3JkaW9uO1xuXG4gICAgY29uZmlnLmtleU1hcFtrZXldID0gdHJ1ZTtcblxuICAgIGlmIChjdXJyZW50Q2hlY2tib3gpIHtcbiAgICAgIGFsbEFjY29yZGlvbnMgPSBjb25maWcuZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLW9wZW4tYWNjb3JkaW9uJyk7XG4gICAgICBmaXJzdEFjY29yZGlvbiA9IGFsbEFjY29yZGlvbnMgJiYgYWxsQWNjb3JkaW9ucy5sZW5ndGggJiYgYWxsQWNjb3JkaW9uc1swXTtcbiAgICAgIGN1cnJlbnRQYW5lbCA9IGN1cnJlbnRDaGVja2JveC5jbG9zZXN0KCcuYnMtZG93bmxvYWRfX2xpc3QnKTtcbiAgICAgIG5leHRQYW5lbCA9IGN1cnJlbnRQYW5lbC5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICBwcmV2UGFuZWwgPSBjdXJyZW50UGFuZWwucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgICAgIGN1cnJlbnRCdXR0b24gPSBjdXJyZW50UGFuZWwgJiYgY3VycmVudFBhbmVsLnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1vcGVuLWFjY29yZGlvbicpO1xuICAgICAgbmV4dEJ1dHRvbiA9IG5leHRQYW5lbCAmJiBuZXh0UGFuZWwucXVlcnlTZWxlY3RvcignLmJzLWpzLW9wZW4tYWNjb3JkaW9uJyk7XG4gICAgICBwYW5lbENoZWNrYm94ZXMgPSBjdXJyZW50UGFuZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWRvd25sb2Fkcy1pbnB1dCwgLmJzLWpzLWRvd25sb2Fkcy1zZWxlY3QtYWxsJyk7XG4gICAgICBwcmV2UGFuZWxDaGVja2JveGVzID0gcHJldlBhbmVsICYmIHByZXZQYW5lbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtZG93bmxvYWRzLWlucHV0LCAuYnMtanMtZG93bmxvYWRzLXNlbGVjdC1hbGwnKTtcbiAgICAgIHByZXZQYW5lbExhc3RDaGVja2JveCA9IHByZXZQYW5lbENoZWNrYm94ZXNcbiAgICAgICAgJiYgcHJldlBhbmVsQ2hlY2tib3hlcy5sZW5ndGhcbiAgICAgICAgJiYgcHJldlBhbmVsQ2hlY2tib3hlc1twcmV2UGFuZWxDaGVja2JveGVzLmxlbmd0aCAtIDFdXG5cbiAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOlxuICAgICAgICBjYXNlICdSaWdodCc6XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0Fycm93TGVmdCc6XG4gICAgICAgIGNhc2UgJ0xlZnQnOlxuICAgICAgICAgIGlmIChjdXJyZW50QnV0dG9uKSB7XG4gICAgICAgICAgICBjdXJyZW50QnV0dG9uLmZvY3VzKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0Fycm93RG93bic6XG4gICAgICAgIGNhc2UgJ0Rvd24nOlxuICAgICAgICAgIGlmIChwYW5lbENoZWNrYm94ZXNbcGFuZWxDaGVja2JveGVzLmxlbmd0aCAtIDFdID09PSBjdXJyZW50Q2hlY2tib3ggJiYgbmV4dEJ1dHRvbikge1xuICAgICAgICAgICAgbmV4dEJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudENoZWNrYm94ID09PSBsYXN0Q2hlY2tib3ggJiYgbmV4dEJ1dHRvbikge1xuICAgICAgICAgICAgZmlyc3RCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRDaGVja2JveCA9PT0gbGFzdENoZWNrYm94ICYmIGZpcnN0QWNjb3JkaW9uKSB7XG4gICAgICAgICAgICBmaXJzdEFjY29yZGlvbi5mb2N1cygpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudENoZWNrYm94ID09PSBsYXN0Q2hlY2tib3gpIHtcbiAgICAgICAgICAgIGZpcnN0Q2hlY2tib3guZm9jdXMoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV4dENoZWNrYm94LmZvY3VzKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICBjYXNlICdVcCc6XG4gICAgICAgICAgaWYgKHBhbmVsQ2hlY2tib3hlc1swXSA9PT0gY3VycmVudENoZWNrYm94ICYmIGN1cnJlbnRCdXR0b24pIHtcbiAgICAgICAgICAgIGN1cnJlbnRCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHBhbmVsQ2hlY2tib3hlc1swXSA9PT0gY3VycmVudENoZWNrYm94ICYmIHByZXZQYW5lbExhc3RDaGVja2JveCkge1xuICAgICAgICAgICAgcHJldlBhbmVsTGFzdENoZWNrYm94LmZvY3VzKCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChwYW5lbENoZWNrYm94ZXNbMF0gPT09IGN1cnJlbnRDaGVja2JveCkge1xuICAgICAgICAgICAgbGFzdENoZWNrYm94LmZvY3VzKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByZXZDaGVja2JveC5mb2N1cygpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdIb21lJzpcbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGZpcnN0Q2hlY2tib3guZm9jdXMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRW5kJzpcbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGxhc3RDaGVja2JveC5mb2N1cygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdFc2NhcGUnOlxuICAgICAgICAgIGFib3J0ZG93bmxvYWQoKTtcbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdhJzpcbiAgICAgICAgICBpZiAoY29uZmlnLmtleU1hcC5Db250cm9sKSB7XG4gICAgICAgICAgICBpZiAoaXNBbGxDaGVja2VkKSB7XG4gICAgICAgICAgICAgIHVuY2hlY2tBbGxJdGVtcygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY2hlY2tBbGxJdGVtcygpO1xuICAgICAgICAgICAgICBvcGVuQWxsQWNjb3JkaW9ucygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQWRqdXN0IEhlaWdodCBvZiBhbGwgQWNjb3JkaW9uIEl0ZW1zXG4gICAqIFdoZW4gaXRlbXMgYXJlIGZpbHRlcmVkIG9yIHRoZSB2aWV3cG9ydCBjaGFuZ2VzLCB0aGUgaGVpZ2h0IG9mIGVhY2hcbiAgICogYWNjb3JkaW9uIGl0ZW0gbXVzdCBiZSBhZGp1c3RlZCBhY2NvcmRpbmcgdG8gaXRzIGNvbnRlbnQgaGVpZ2h0XG4gICAqXG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICB2YXIgYWRqdXN0QWNjb3JkaW9uSXRlbXNIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFjdGl2ZUl0ZW1zID0gQXJyYXkucHJvdG90eXBlLmZpbHRlci5jYWxsKGNvbmZpZy5hY2NvcmRpb25MaXN0LCBmdW5jdGlvbiAocGFuZWwpIHtcbiAgICAgIHJldHVybiBwYW5lbC5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmFjY29yZGlvbk9wZW5DbGFzcylcbiAgICAgICAgJiYgcGFuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5jYXRlZ29yeUFjdGl2ZUNsYXNzKTtcbiAgICB9KTtcblxuICAgIGlmIChoYXNBY2NvcmRpb24oKSAmJiBhY3RpdmVJdGVtcy5sZW5ndGgpIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYWN0aXZlSXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHZhciBpdGVtQ2hpbGRyZW4gPSBpdGVtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1kb3dubG9hZF9faXRlbScpO1xuICAgICAgICB2YXIgY29udGVudCA9IGl0ZW0ucXVlcnlTZWxlY3RvcignLicgKyBjb25maWcuYWNjb3JkaW9uQ29udGVudENsYXNzKTtcbiAgICAgICAgLy8gc3VtIG9mIGVhY2ggY2hpbGRyZW4gaGVpZ2h0XG4gICAgICAgIHZhciBjaGlsZHJlbkhlaWdodCA9IEFycmF5LnByb3RvdHlwZS5yZWR1Y2UuY2FsbChpdGVtQ2hpbGRyZW4sIGZ1bmN0aW9uICh0b3RhbCwgc3ViaXRlbSkge1xuICAgICAgICAgIHRvdGFsICs9IHN1Yml0ZW0uc2Nyb2xsSGVpZ2h0O1xuICAgICAgICAgIHJldHVybiB0b3RhbDtcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIC8vIHVwZGF0ZSBhY2NvcmRpb24gaXRlbSBoZWlnaHRcbiAgICAgICAgY29udGVudC5zdHlsZS5oZWlnaHQgPSBjaGlsZHJlbkhlaWdodCArICdweCc7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gRG93bmxvYWRzIG9mIG11bHRpcGxlIGl0ZW1zXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLyoqXG4gICAqIEhhcyBNdWx0aXBsZSBEb3dubG9hZFxuICAgKiBAcmV0dXJuIHtCb29sZWFufSB0cnVlIGlmIGRvd25sb2FkIGhhcyBtdWx0aURvd25sb2FkIG9wdGlvbnNcbiAgICovXG4gIHZhciBoYXNNdWx0aURvd25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjb25maWcuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5tdWx0aURvd25sb2FkRm9ybUNsYXNzKVxuICAgICAgfHwgKGNvbmZpZy5pdGVtc0lucHV0ICYmIGNvbmZpZy5pdGVtc0lucHV0Lmxlbmd0aCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBhY3RpdmUgY2hlY2tib3ggbGlzdFxuICAgKiBAcGFyYW0gIHtvYmplY3R9ICBldmVudCAgYSBjaGFuZ2UgZXZlbnRcbiAgICogQHJldHVybiB7dm9pZH1cbiAgICovXG4gIHZhciBoYW5kbGVTZWxlY3RlZEl0ZW1zID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxlY3RlZElucHV0cyA9IG51bGw7XG4gICAgdmFyIHByb2dyZXNzVGV4dCA9IGZ1bmN0aW9uIChpdGVtc0Ftb3VudCkge1xuICAgICAgdmFyIHRleHQgPSAnJztcbiAgICAgIHRleHQgKz0gaXRlbXNBbW91bnQgKyAnIGFycXVpdm8nICsgKGl0ZW1zQW1vdW50ID4gMSA/ICdzICcgOiAnJyk7XG4gICAgICB0ZXh0ICs9ICcgc2VsZWNpb25hZG8nICsgKGl0ZW1zQW1vdW50ID4gMSA/ICdzJyA6ICcnKTtcbiAgICAgIHJldHVybiB0ZXh0O1xuICAgIH07XG5cbiAgICAvLyBlbmFibGUvZGlzYWJsZSBkb3dubG9hZCBidXR0b25cbiAgICB0b2dnbGVEb3dubG9hZEJ1dHRvbigpO1xuXG4gICAgLy8gZ2V0IHRoZSB1cGRhdGVkIGxpc3Qgb2YgY2hlY2tlZFxuICAgIHNlbGVjdGVkSW5wdXRzID0gZ2V0Q2hlY2tlZEl0ZW1zKCk7XG5cbiAgICAvLyBpZiBoYXMgYSBzbmFja2JhclxuICAgIGlmIChjb25maWcuZG93bmxvYWRQcm9ncmVzcykge1xuICAgICAgLy8gaWYgdGhlcmUgYXJlIGNoZWNrZWQgaXRlbXMsIHNob3cgc25hY2tiYXJcbiAgICAgIGlmIChzZWxlY3RlZElucHV0cy5sZW5ndGgpIHtcbiAgICAgICAgY29uZmlnLmRvd25sb2FkUHJvZ3Jlc3Muc2hvdygpO1xuICAgICAgICBjb25maWcuZG93bmxvYWRQcm9ncmVzcy5zZXRQcm9ncmVzcygnJywgcHJvZ3Jlc3NUZXh0KHNlbGVjdGVkSW5wdXRzLmxlbmd0aCkpO1xuICAgICAgICBjb25maWcuZG93bmxvYWRQcm9ncmVzcy5hY3RpdmVCdXR0b24oJ2ljb24tbmF2LWJhaXhhcicsICdGYXplciBkb3dubG9hZCcsIGFkZERvd25sb2FkTGlzdGVuZXIpO1xuICAgICAgLy8gaWYgdGhlcmUgYWxsIGl0ZW1zIGFyZSB1bmNoZWNrZWQsIGhpZGUgc25hY2tiYXJcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbmZpZy5kb3dubG9hZFByb2dyZXNzLmhpZGUoKTtcbiAgICAgICAgY29uZmlnLmRvd25sb2FkUHJvZ3Jlc3MuZGlzYWJsZUJ1dHRvbigpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogaGFuZGxlIEl0ZW1zIENoZWNrYm94XG4gICAqIEBwYXJhbSAge29iamVjdH0gIGV2ZW50ICBhIGNoYW5nZSBldmVudFxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgdmFyIGhhbmRsZUl0ZW1zQ2hlY2tib3ggPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAvLyBoYW5kbGUgc2hpZnQtc2VsZWN0IG11bHRpcGxlIGl0ZW1zXG4gICAgc2hpZnRTZWxlY3RNdWx0aXBsZUl0ZW1zKGV2ZW50KTtcbiAgICAvLyB0b2dnbGUgYWN0aXZlIGl0ZW0gc3R5bGVcbiAgICB0b2dnbGVJdGVtQ2hlY2tib3goZXZlbnQudGFyZ2V0KTtcbiAgICAvLyBoYW5kbGUgbGlzdCBvZiBzZWxlY3RlZCBpdGVtc1xuICAgIGhhbmRsZVNlbGVjdGVkSXRlbXMoKTtcbiAgICAvL1xuICAgIGhhbmRsZVNlbGVjdEFsbEJ5Q2hpbGRDaGFuZ2UoZXZlbnQudGFyZ2V0KTtcbiAgfTtcblxuICAvKipcbiAgICogaGFuZGxlIEl0ZW1zIENoZWNrYm94XG4gICAqIEBwYXJhbSAge29iamVjdH0gIGV2ZW50ICBhIGNoYW5nZSBldmVudFxuICAgKiBAcmV0dXJuIHt2b2lkfVxuICAgKi9cbiAgdmFyIGhhbmRsZVNlbGVjdEFsbENoZWNrYm94ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgdmFyIGlucHV0RWwgPSBldmVudC50YXJnZXQ7XG4gICAgdmFyIGdyb3VwRWwgPSBpbnB1dEVsLmNsb3Nlc3QoJy5icy1kb3dubG9hZF9fZ3JvdXAnKTtcbiAgICB2YXIgY2hpbGRJbnB1dHM7XG5cbiAgICAvLyByZXR1cm4gaWYgZXZlbnQgaXMgbm90IHJlbGF0ZWQgdG8gYSBncm91cFxuICAgIGlmICghZ3JvdXBFbCkgcmV0dXJuO1xuXG4gICAgLy8gZ2V0IHRoZSBjaGlsZCBpbnB1dHMgb2YgdGhlIGN1cnJlbnQgZ3JvdXBcbiAgICBjaGlsZElucHV0cyA9IGdyb3VwRWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWRvd25sb2Fkcy1pbnB1dCcpO1xuXG4gICAgLy8gaWYgdGhlIGV2ZW50IGlzIGZyb20gc2VsZWN0QWxsIGNoZWNrYm94XG4gICAgaWYgKGlucHV0RWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdicy1qcy1kb3dubG9hZHMtc2VsZWN0LWFsbCcpKSB7XG4gICAgICAvLyBpZiBncm91cCBoYXZlIGNoaWxkcmVuXG4gICAgICBpZiAoY2hpbGRJbnB1dHMgJiYgY2hpbGRJbnB1dHMubGVuZ3RoKSB7XG4gICAgICAgIC8vIGhhbmRsZSBzaGlmdC1zZWxlY3QgbXVsdGlwbGUgaXRlbXNcbiAgICAgICAgaWYgKGV2ZW50KSBzaGlmdFNlbGVjdE11bHRpcGxlSXRlbXMoZXZlbnQsIGNoaWxkSW5wdXRzWzBdKTtcblxuICAgICAgICAvLyB0b2dnbGUgZWFjaCBjaGlsZCBiYXNlZCBpbiBzZWxlY3RBbGxJbnB1dCBzdGF0dXNcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjaGlsZElucHV0cywgZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgICAgaWYgKGlucHV0RWwuY2hlY2tlZCkge1xuICAgICAgICAgICAgdG9nZ2xlSXRlbUNoZWNrYm94KGlucHV0LCB0cnVlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdG9nZ2xlSXRlbUNoZWNrYm94KGlucHV0LCBmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBoYW5kbGUgbGlzdCBvZiBzZWxlY3RlZCBpdGVtc1xuICAgICAgICBoYW5kbGVTZWxlY3RlZEl0ZW1zKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8vIGlmIHRoZSBldmVudCBpcyBmcm9tIGEgc3BlY2lmaWMgZG93bmxvYWQgY2hlY2tib3hcbiAgdmFyIGhhbmRsZVNlbGVjdEFsbEJ5Q2hpbGRDaGFuZ2UgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICB2YXIgZ3JvdXBFbCA9IGlucHV0LmNsb3Nlc3QoJy5icy1kb3dubG9hZF9fZ3JvdXAnKTtcbiAgICB2YXIgYWxsSW5wdXRzQ2hlY2tlZCA9IGZhbHNlO1xuICAgIHZhciBjaGlsZElucHV0cztcbiAgICB2YXIgc2VsZWN0QWxsSW5wdXQ7XG5cbiAgICAvLyByZXR1cm4gaWYgZXZlbnQgaXMgbm90IHJlbGF0ZWQgdG8gYSBncm91cFxuICAgIGlmICghZ3JvdXBFbCkgcmV0dXJuO1xuXG4gICAgLy8gZ2V0IHRoZSBzZWxlY3RBbGwgaW5wdXQgb2YgdGhlIGN1cnJlbnQgZ3JvdXBcbiAgICBzZWxlY3RBbGxJbnB1dCA9IGdyb3VwRWwucXVlcnlTZWxlY3RvcignLmJzLWpzLWRvd25sb2Fkcy1zZWxlY3QtYWxsJyk7XG5cbiAgICAvLyBnZXQgdGhlIGNoaWxkIGlucHV0cyBvZiB0aGUgY3VycmVudCBncm91cFxuICAgIGNoaWxkSW5wdXRzID0gZ3JvdXBFbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtZG93bmxvYWRzLWlucHV0Jyk7XG5cbiAgICAvLyBjaGVjayBpZiBldmVyeSBjaGlsZCBpcyBjaGVja2VkIG9yIG5vdFxuICAgIGFsbElucHV0c0NoZWNrZWQgPSBBcnJheS5wcm90b3R5cGUuZXZlcnkuY2FsbChjaGlsZElucHV0cywgZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICByZXR1cm4gaW5wdXQuY2hlY2tlZDtcbiAgICB9KTtcblxuICAgIC8vIGNoZWNrIHNlbGVjdEFsbElucHV0IGlmIGFsbCBjaGlsZHMgaXMgY2hlY2tlZFxuICAgIGlmIChhbGxJbnB1dHNDaGVja2VkKSB7XG4gICAgICBzZWxlY3RBbGxJbnB1dC5jaGVja2VkID0gdHJ1ZTtcbiAgICAvLyB1bmNoZWNrIHNlbGVjdEFsbElucHV0IGlmIGFueSBjaGlsZHMgaXMgdW5jaGVja2VkXG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGVjdEFsbElucHV0LmNoZWNrZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICB2YXIgYWRkRG93bmxvYWRMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZmlsZW5hbWUgPSBjb25maWcuZG93bmxvYWRCdXR0b24uZGF0YXNldC56aXBGaWxlbmFtZTtcbiAgICBnZW5lcmF0ZVppcEZpbGUoZmlsZW5hbWUpO1xuICB9O1xuXG4gIHZhciBhYm9ydGRvd25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIFJlc2V0IHByb2dyZXNzXG4gICAgY29uZmlnLmRvd25sb2FkUHJvZ3Jlc3MuZWxlbWVudHMucHJvZ3Jlc3MuY2xhc3NMaXN0LnJlbW92ZSgnYnMtcHJvZ3Jlc3MtLWlzLWxvYWRpbmcnKTtcbiAgICBjb25maWcuZG93bmxvYWRQcm9ncmVzcy5zZXRQcm9ncmVzcygpO1xuICAgIGNvbmZpZy5kb3dubG9hZFByb2dyZXNzLmhpZGUoKTtcblxuICAgIC8vIERpc2FibGUgZG93bmxvYWQgYnV0dG9uIGFuZCB1bmNoZWNrIGl0ZW1zXG4gICAgdW5jaGVja0FsbEl0ZW1zKCk7XG5cbiAgICAvLyBBYm9ydCBpZiBvbiBkb3dubG9hZGluZyBvciB6aXBwaW5nIHByb2Nlc3NcbiAgICBjb25maWcuZG93bmxvYWRJc0FjdGl2ZSA9IGZhbHNlO1xuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBnZXQgY2hlY2tlZCBpdGVtc1xuICAgKiBAcmV0dXJuIHthcnJheX0gbGlzdCBvZiBjaGVja2VkIGlucHV0c1xuICAgKi9cbiAgdmFyIGdldENoZWNrZWRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY29uZmlnLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1kb3dubG9hZHMtaW5wdXQ6Y2hlY2tlZCcpO1xuICB9O1xuXG4gIHZhciBpc0FjdGl2ZUl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIHZhciBwYW5lbEFjdGl2ZSA9IGl0ZW0uY2xvc2VzdCgnLmJzLWRvd25sb2FkX19saXN0JykuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5jYXRlZ29yeUFjdGl2ZUNsYXNzKTtcbiAgICB2YXIgaXRlbUNvbnRhaW5lciA9IGl0ZW0uY2xvc2VzdCgnLmJzLWRvd25sb2FkX19pdGVtJyk7XG4gICAgcmV0dXJuIHBhbmVsQWN0aXZlICYmIGl0ZW1Db250YWluZXIuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnO1xuICB9XG5cbiAgdmFyIGdldEFjdGl2ZUl0ZW1zID0gZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5maWx0ZXIuY2FsbChpdGVtcyB8fCBjb25maWcuaXRlbXNJbnB1dCwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIHJldHVybiBpc0FjdGl2ZUl0ZW0oaXRlbSk7XG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIGdldEluYWN0aXZlSXRlbXMgPSBmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLmZpbHRlci5jYWxsKGl0ZW1zIHx8IGNvbmZpZy5pdGVtc0lucHV0LCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgcmV0dXJuICFpc0FjdGl2ZUl0ZW0oaXRlbSk7XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENoZWNrIGFsbCBpdGVtc1xuICAgKi9cbiAgdmFyIGNoZWNrQWxsSXRlbXMgPSBmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGl0ZW1zIHx8IGNvbmZpZy5pdGVtc0lucHV0LCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIHZhciBwYW5lbCA9IGVsLmNsb3Nlc3QoJy5icy1kb3dubG9hZF9fbGlzdCcpO1xuXG4gICAgICBpZiAoaGFzQWNjb3JkaW9uKCkgJiYgIXBhbmVsLmNsYXNzTGlzdC5jb250YWlucyhjb25maWcuY2F0ZWdvcnlBY3RpdmVDbGFzcykpIHJldHVybjtcbiAgICAgIGlmICghaXNBY3RpdmVJdGVtKGVsKSkgcmV0dXJuO1xuXG4gICAgICB0b2dnbGVJdGVtQ2hlY2tib3goZWwsIHRydWUpO1xuICAgICAgaGFuZGxlU2VsZWN0QWxsQnlDaGlsZENoYW5nZShlbCk7XG4gICAgfSk7XG4gICAgaGFuZGxlU2VsZWN0ZWRJdGVtcygpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBVbmNoZWNrIGFsbCBpdGVtc1xuICAgKi9cbiAgdmFyIHVuY2hlY2tBbGxJdGVtcyA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaXRlbXMgfHwgY29uZmlnLml0ZW1zSW5wdXQsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgdG9nZ2xlSXRlbUNoZWNrYm94KGVsLCBmYWxzZSk7XG4gICAgICBoYW5kbGVTZWxlY3RBbGxCeUNoaWxkQ2hhbmdlKGVsKTtcbiAgICB9KTtcblxuICAgIGlmIChjb25maWcuZ3JvdXBJbnB1dCkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuZ3JvdXBJbnB1dCwgZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIGlucHV0LmNoZWNrZWQgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGhhbmRsZVNlbGVjdGVkSXRlbXMoKTtcbiAgfTtcblxuICAvKipcbiAgICogdG9nZ2xlIEl0ZW0gQ2hlY2tib3hcbiAgICogQHBhcmFtICB7b2JqZWN0fSAgY2hlY2tib3ggIHRoZSBIVE1MIGVsZW1lbnQgb2YgdGhlIGNoZWNrYm94XG4gICAqIEBwYXJhbSAge2Jvb2xlYW59IGNoZWNrICAgICBmb3JjZSBjaGVjayB0cnVlL2ZhbHNlXG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICB2YXIgdG9nZ2xlSXRlbUNoZWNrYm94ID0gZnVuY3Rpb24gKGNoZWNrYm94LCBjaGVjaykge1xuICAgIC8vIEdldCBkaXYgcGFyZW50IHRvIGFwcGx5IGNvbmRpdGlvbnNcbiAgICB2YXIgaW5wdXRJdGVtID0gY2hlY2tib3guY2xvc2VzdCgnLmJzLWRvd25sb2FkX19pdGVtJyk7XG4gICAgdmFyIGNoZWNrZWQgPSAodHlwZW9mIGNoZWNrID09PSAnYm9vbGVhbicpID8gY2hlY2sgOiBjaGVja2JveC5jaGVja2VkO1xuXG4gICAgLy8gSWYgY2hlY2tib3ggaXMgY2hlY2tlZCBvciBzaG91bGQgYmUgZm9yY2VkIHRvXG4gICAgaWYgKGNoZWNrZWQgfHwgY2hlY2spIHtcbiAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSB0cnVlO1xuICAgICAgaW5wdXRJdGVtLmNsYXNzTGlzdC5hZGQoY29uZmlnLml0ZW1BY3RpdmVDbGFzcyk7XG4gICAgLy8gSWYgY2hlY2tib3ggaXMgdW5jaGVja2VkIG9yIHNob3VsZCBiZSBmb3JjZWQgdG9cbiAgICB9IGVsc2Uge1xuICAgICAgY2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgaW5wdXRJdGVtLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLml0ZW1BY3RpdmVDbGFzcyk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiB0b2dnbGUgRG93bmxvYWQgQnV0dG9uXG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICB2YXIgdG9nZ2xlRG93bmxvYWRCdXR0b24gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRvd25sb2FkQnV0dG9uID0gY29uZmlnLmRvd25sb2FkQnV0dG9uO1xuICAgIHZhciBkb3dubG9hZEJ1dHRvblRpdGxlID0gJyc7XG4gICAgdmFyIGhhc0lucHV0Q2hlY2tlZCA9IGdldENoZWNrZWRJdGVtcygpLmxlbmd0aDtcblxuICAgIGlmIChkb3dubG9hZEJ1dHRvbikge1xuICAgICAgLy8gZW5hYmxlIGRvd25sb2FkIGJ1dHRvbiBpZiBoYXMgc29tZSBpbnB1dCBjaGVja2VkXG4gICAgICBpZiAoIWhhc0lucHV0Q2hlY2tlZCkge1xuICAgICAgICBkb3dubG9hZEJ1dHRvblRpdGxlID0gZG93bmxvYWRCdXR0b24uZ2V0QXR0cmlidXRlKCdkYXRhLWRpc2FibGUtdGl0bGUnKSB8fCAnJztcbiAgICAgICAgZG93bmxvYWRCdXR0b24udGl0bGUgPSBkb3dubG9hZEJ1dHRvblRpdGxlO1xuICAgICAgICBkb3dubG9hZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdicy1idXR0b24tLWRpc2FibGVkJyk7XG4gICAgICAgIGRvd25sb2FkQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgIC8vIGRpc2FibGUgZG93bmxvYWQgYnV0dG9uIGlmIGhhc24ndCBhbnkgaW5wdXQgY2hlY2tlZFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZG93bmxvYWRCdXR0b25UaXRsZSA9IGRvd25sb2FkQnV0dG9uLmdldEF0dHJpYnV0ZSgnZGF0YS1hY3RpdmUtdGl0bGUnKSB8fCAnJztcbiAgICAgICAgZG93bmxvYWRCdXR0b24udGl0bGUgPSBkb3dubG9hZEJ1dHRvblRpdGxlO1xuICAgICAgICBkb3dubG9hZEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdicy1idXR0b24tLWRpc2FibGVkJyk7XG4gICAgICAgIGRvd25sb2FkQnV0dG9uLmRpc2FibGVkID0gJyc7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBTaGlmdC1zZWxlY3QgTXVsdGlwbGUgSXRlbXNcbiAgICogU2VsZWN0IGFsbCBjaGVja2JveGVzIGJldHdlZW4gbGFzdENoZWNrZWQgYW5kIGN1cnJlbnRDaGVja2VkIGlmXG4gICAqIHNoaWZ0S2V5IGlzIHByZXNzZWQgZHVyaW5nIGNsaWNrXG4gICAqXG4gICAqIEBwYXJhbSAge09iamVjdH0gZSAgYSBjbGljayBldmVudCBpbiBhIGNoZWNrYm94XG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICB2YXIgc2hpZnRTZWxlY3RNdWx0aXBsZUl0ZW1zID0gZnVuY3Rpb24gKGUsIGN1c3RvbUlucHV0KSB7XG4gICAgdmFyIGlucHV0ID0gY3VzdG9tSW5wdXQgfHwgZS50YXJnZXQ7XG4gICAgdmFyIHN0YXJ0ID0gbnVsbDtcbiAgICB2YXIgZW5kID0gbnVsbDtcbiAgICB2YXIgc2hpZnQgPSBlICYmIGUuc2hpZnRLZXk7XG5cbiAgICBpZiAoKGlucHV0IHx8IHt9KS50eXBlICE9PSAnY2hlY2tib3gnKSByZXR1cm47XG5cbiAgICBpZiAoIWNvbmZpZy5sYXN0SW5wdXRDaGVja2VkKSB7XG4gICAgICBjb25maWcubGFzdElucHV0Q2hlY2tlZCA9IGlucHV0O1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChzaGlmdCkge1xuICAgICAgc3RhcnQgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGNvbmZpZy5pdGVtc0lucHV0LCBjb25maWcubGFzdElucHV0Q2hlY2tlZCk7XG4gICAgICBlbmQgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGNvbmZpZy5pdGVtc0lucHV0LCBpbnB1dCk7XG5cbiAgICAgIGlmIChNYXRoLmFicyhzdGFydCAtIGVuZCkgPiAxKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShjb25maWcuaXRlbXNJbnB1dCwgW1xuICAgICAgICAgIE1hdGgubWluKHN0YXJ0LCBlbmQpLFxuICAgICAgICAgIE1hdGgubWF4KHN0YXJ0LCBlbmQpICsgMSxcbiAgICAgICAgXSkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgIHRvZ2dsZUl0ZW1DaGVja2JveChpdGVtLCB0cnVlKTtcblxuICAgICAgICAgIC8vIGhhbmRsZSBTZWxlY3RBbGwgQ2hlY2tib3hcbiAgICAgICAgICBoYW5kbGVTZWxlY3RBbGxCeUNoaWxkQ2hhbmdlKGl0ZW0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25maWcubGFzdElucHV0Q2hlY2tlZCA9IGlucHV0O1xuICB9O1xuXG4gIC8qKlxuICAgKiBaaXAgRmlsZSBHZW5lcmF0ZVxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IHppcE5hbWUgTmFtZSBvZiB0aGUgemlwIGZpbGVcbiAgICovXG4gIHZhciBnZW5lcmF0ZVppcEZpbGUgPSBmdW5jdGlvbiAoemlwTmFtZSkge1xuICAgIHZhciBjaGVja2VkSW5wdXRzID0gY29uZmlnLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1kb3dubG9hZHMtaW5wdXQ6Y2hlY2tlZCcpO1xuICAgIHZhciB6aXAgPSBudWxsO1xuICAgIHZhciBwcm9ncmVzcyA9IG51bGw7XG4gICAgdmFyIHBlcmNlbnRhZ2UgPSAtMTtcbiAgICB2YXIgcGFydGlhbFBlcmNlbnRhZ2UgPSAwO1xuICAgIHZhciB1cmxzID0gW107XG5cbiAgICAvLyBDaGVjayBpZiBhbGwgZGVwZW5kZW5jaWVzIGV4aXN0c1xuICAgIGlmIChcbiAgICAgICFjb25maWcuemlwT25DbGllbnQgfHxcbiAgICAgIHR5cGVvZiBKU1ppcCA9PT0gJ3VuZGVmaW5lZCcgfHxcbiAgICAgIHR5cGVvZiBzYXZlQXMgPT09ICd1bmRlZmluZWQnIHx8XG4gICAgICB0eXBlb2YgZm9yRWFjaFByb21pc2UgPT09ICd1bmRlZmluZWQnIHx8XG4gICAgICB0eXBlb2YgZ2V0ID09PSAndW5kZWZpbmVkJ1xuICAgICkgcmV0dXJuO1xuXG4gICAgLy8gU2V0IGRlZmF1bHQgdmFsdWUgZm9yIHppcE5hbWVcbiAgICBpZiAodHlwZW9mIHppcE5hbWUgIT09ICdzdHJpbmcnKSB6aXBOYW1lID0gJ2Rvd25sb2FkLnppcCc7XG5cbiAgICAvLyBJZiB0aGVyZSdzIG9uZSBvciBtb3JlIGlucHV0cyBjaGVja2VkXG4gICAgaWYgKGNoZWNrZWRJbnB1dHMubGVuZ3RoKSB7XG4gICAgICAvLyBjcmVhdGUgYW4gYXJyYXkgd2l0aCB0aGUgVVJMIG9mIHRoZSBmaWxlc1xuICAgICAgLy8gb2YgZWFjaCBjaGVja2VkIGlucHV0IHRvIFpJUFxuICAgICAgdXJscyA9IEFycmF5LnByb3RvdHlwZS5tYXAuY2FsbChjaGVja2VkSW5wdXRzLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICB2YXIgZG93bmxvYWRJdGVtID0gaXRlbS5jbG9zZXN0KCcuYnMtZG93bmxvYWRfX2l0ZW0nKTtcbiAgICAgICAgdmFyIGhyZWYgPSBkb3dubG9hZEl0ZW0ucXVlcnlTZWxlY3RvcignYScpLmhyZWY7XG4gICAgICAgIHJldHVybiBocmVmO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFN0YXJ0IEpTWmlwIGFuZCBCc1NuYWNrUHJvZ3Jlc3NcbiAgICAgIHppcCA9IG5ldyBKU1ppcCgpO1xuICAgICAgcHJvZ3Jlc3MgPSBjb25maWcuZG93bmxvYWRQcm9ncmVzcztcbiAgICAgIHByb2dyZXNzLmVsZW1lbnRzLnByb2dyZXNzLmNsYXNzTGlzdC5hZGQoJ2JzLXByb2dyZXNzLS1pcy1sb2FkaW5nJyk7XG4gICAgICBwcm9ncmVzcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICBwcm9ncmVzcy5zaG93KCk7XG4gICAgICAvLyBjb25zb2xlLmxvZygnc3RhcnRpbmcgZG93bmxvYWRzJyk7XG4gICAgICBwcm9ncmVzcy5zZXRQcm9ncmVzcygwLCAnQmFpeGFuZG8gJyArIHVybHMubGVuZ3RoICsgJyBhcnF1aXZvJyArICh1cmxzLmxlbmd0aCA+IDEgPyAncycgOiAnJykpO1xuXG4gICAgICAvLyBTZXQgdHJ1ZSB0byBkb3dubG9hZElzQWN0aXZlXG4gICAgICAvLyBJdCdzIHVzZWQgdG8gY2FuY2VsIHRoZSBwcm9jZXNzICh6aXBwaW5nIHByb2Nlc3MganVzdCBydW4gd2hlbiBpdCdzXG4gICAgICAvLyB0cnVlLCBzbyBhIGNhbmNlbCBhY3Rpb24ganVzdCBuZWVkIHRvIHNldCBpdCB0byBmYWxzZSkgc2luY2UgSlNaaXBcbiAgICAgIC8vIGhhdmUgbm8gYWJvcnQgbWV0aG9kXG4gICAgICBjb25maWcuZG93bmxvYWRJc0FjdGl2ZSA9IHRydWU7XG5cbiAgICAgIC8vIGxvb3AgZm9yIGVhY2ggVVJMIGFzIGEgcHJvbWlzZVxuICAgICAgZm9yRWFjaFByb21pc2UodXJscywgZnVuY3Rpb24gKGZpbGVwYXRoKSB7XG4gICAgICAgIHZhciBmaWxlbmFtZSA9IGdldEZpbGVuYW1lRnJvbVBhdGgoZmlsZXBhdGgpO1xuXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdzdGFydGluZyAnICsgZmlsZW5hbWUpO1xuICAgICAgICAvLyBwcm9ncmVzcy5zZXRQcm9ncmVzcygwKTtcblxuICAgICAgICBpZiAoIWNvbmZpZy5kb3dubG9hZElzQWN0aXZlKSByZXR1cm47XG5cbiAgICAgICAgLy8gUmVxdWVzdCBYTUxIdHRwIGZyb20gdXJsXG4gICAgICAgIHJldHVybiBnZXQoZmlsZXBhdGgsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIGlmIChldmVudC5sZW5ndGhDb21wdXRhYmxlKSB7XG4gICAgICAgICAgICB2YXIgZmlsZVBlcmNlbnRhZ2UgPSBwYXJzZUludCgoZXZlbnQubG9hZGVkIC8gZXZlbnQudG90YWwpICogMTAwLCAxMCk7XG4gICAgICAgICAgICB2YXIgcGFydGlhbEZpbGVQZXJjZW50YWdlID0gcGFyc2VJbnQoZmlsZVBlcmNlbnRhZ2UgLyB1cmxzLmxlbmd0aCwgMTApO1xuICAgICAgICAgICAgdmFyIG5ld1BlcmNlbnRhZ2UgPSBwYXJ0aWFsUGVyY2VudGFnZSArIHBhcnRpYWxGaWxlUGVyY2VudGFnZTtcbiAgICAgICAgICAgIHZhciBpbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgaWYgKG5ld1BlcmNlbnRhZ2UgPiBwZXJjZW50YWdlKSB7XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRvdGFsIHBlcmNlbnRhZ2VcbiAgICAgICAgICAgICAgICAvLyBUaGUgdG90YWwgdmFsdWUgaXMgdGhlIGhpZ2hlciBudW1iZXIgYmV0d2VlbiB0aGUgc3VtIG9mIHRoZVxuICAgICAgICAgICAgICAgIC8vIGxhc3QgcGFydGlhbCBwZXJjZW50YWdlIHdpdGggdGhlIGN1cnJlbnQgZmlsZSBwYXJ0aWFsIHBlcmNlbnRhZ2VcbiAgICAgICAgICAgICAgICAvLyBhbmQgdGhlIGN1cnJlbnQgcGVyY2VudGFnZVxuICAgICAgICAgICAgICAgIHBlcmNlbnRhZ2UgPSBuZXdQZXJjZW50YWdlO1xuXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHByb2dyZXNzXG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2Rvd25sb2FkaW5nICcgKyBmaWxlbmFtZSwgcGVyY2VudGFnZSk7XG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3Muc2V0UHJvZ3Jlc3MocGVyY2VudGFnZSk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAvLyB3aGVuIHRoZSBzaW5nbGUgZmlsZSBpcyBkb3dubG9hZGVkLCB1cGRhdGUgdGhlIHBhcnRpYWxcbiAgICAgICAgICAgICAgLy8gcGVyY2VudGFnZSB3aXRoIHRoZSBjdXJyZW50IHBlcmNlbnRhZ2UgdmFsdWVcbiAgICAgICAgICAgICAgaWYgKGZpbGVQZXJjZW50YWdlID49IDEwMCkge1xuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgIHBhcnRpYWxQZXJjZW50YWdlID0gcGVyY2VudGFnZTtcbiAgICAgICAgICAgICAgICBwcm9ncmVzcy5zZXRQcm9ncmVzcyhwZXJjZW50YWdlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTApO1xuXG4gICAgICAgICAgICBpZiAoIWNvbmZpZy5kb3dubG9hZElzQWN0aXZlKSB0aGlzLmFib3J0KCk7XG5cbiAgICAgICAgICAgIGlmIChmaWxlUGVyY2VudGFnZSA+PSAxMDApIHtcbiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgICAgICAgICAgIHBlcmNlbnRhZ2UgPSBuZXdQZXJjZW50YWdlO1xuICAgICAgICAgICAgICBwYXJ0aWFsUGVyY2VudGFnZSA9IHBlcmNlbnRhZ2U7XG4gICAgICAgICAgICAgIHByb2dyZXNzLnNldFByb2dyZXNzKHBlcmNlbnRhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBVbmFibGUgdG8gY29tcHV0ZSBwcm9ncmVzcyBpbmZvcm1hdGlvbiBzaW5jZSB0aGUgdG90YWwgc2l6ZSBpcyB1bmtub3duXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1VuYWJsZSB0byBjb21wdXRlIHByb2dyZXNzIGluZm9ybWF0aW9uIHNpbmNlIHRoZSB0b3RhbCBzaXplIGlzIHVua25vd24nKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC8vIGdldCB0aGVuXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnYWRkaW5nIHRvIHppcCcsIHBlcmNlbnRhZ2UpO1xuICAgICAgICAgICAgemlwLmZpbGUoZ2V0RmlsZW5hbWVGcm9tUGF0aChmaWxlcGF0aCksIHJlc3BvbnNlKTtcbiAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgIH0pO1xuICAgICAgfSlcbiAgICAgIC8vIGZvckVhY2hQcm9taXNlIHRoZW5cbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciB6aXBQZXJjZW50YWdlID0gMDtcblxuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdhbGwgZmlsZXMgZG93bmxvYWRlZCcpO1xuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdzdGFydGluZyB6aXBwaW5nJyk7XG5cbiAgICAgICAgICBwcm9ncmVzcy5zZXRQcm9ncmVzcygwLCAnQ29tcGFjdGFuZG8nKTtcblxuICAgICAgICAgIC8vIElmIHRoZXJlJ3Mgbm8gXCJ2YWxpZFwiIChzdGF0dXMgMjAwKSBmaWxlcyB0byB6aXBcbiAgICAgICAgICAvLyBBYm9ydCB6aXBwaW5nIGFuZCB0aHJvdyBlcnJvclxuICAgICAgICAgIGlmIChPYmplY3Qua2V5cyh6aXAuZmlsZXMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgYWJvcnRkb3dubG9hZCgpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBmaWxlcyBmb3VuZCB0byB6aXAnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBTdG9wIGlmIHppcCBpcyBubyBhY3RpdmVcbiAgICAgICAgICBpZiAoIWNvbmZpZy5kb3dubG9hZElzQWN0aXZlKSByZXR1cm47XG5cbiAgICAgICAgICAvLyBzdGFydCB6aXBwaW5nIHByb2Nlc3NcbiAgICAgICAgICB6aXAuZ2VuZXJhdGVBc3luYyh7IHR5cGU6ICdibG9iJyB9LCBmdW5jdGlvbiB1cGRhdGVDYWxsYmFjayhtZXRhZGF0YSkge1xuICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL0FtaW41MkovRG93bmxvYWQtUHJvZ3Jlc3MvYmxvYi9tYXN0ZXIvZGlzdC9kb3dubG9hZC1wcm9ncmVzcy5qc1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRaaXBQZXJjZW50YWdlID0gcGFyc2VJbnQobWV0YWRhdGEucGVyY2VudCwgMTApO1xuICAgICAgICAgICAgdmFyIG5ld1BlcmNlbnRhZ2UgPSAoXG4gICAgICAgICAgICAgIGN1cnJlbnRaaXBQZXJjZW50YWdlID4gemlwUGVyY2VudGFnZVxuICAgICAgICAgICAgKSA/IGN1cnJlbnRaaXBQZXJjZW50YWdlIDogemlwUGVyY2VudGFnZTtcblxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cobWV0YWRhdGEucGVyY2VudCk7XG4gICAgICAgICAgICAvLyBwcm9ncmVzcy5zZXRQcm9ncmVzcyhtZXRhZGF0YS5wZXJjZW50KTtcblxuICAgICAgICAgICAgaWYgKCFjb25maWcuZG93bmxvYWRJc0FjdGl2ZSkge1xuICAgICAgICAgICAgICBjbGVhckludGVydmFsKHppcEludGVydmFsKTtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgemlwSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGlmIChjdXJyZW50WmlwUGVyY2VudGFnZSA+PSAxMDApIHtcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHppcEludGVydmFsKTtcbiAgICAgICAgICAgICAgICBwcm9ncmVzcy5zZXRQcm9ncmVzcyhjdXJyZW50WmlwUGVyY2VudGFnZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgLy8gemlwUGVyY2VudGFnZSA9IG5ld1BlcmNlbnRhZ2U7O1xuICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh6aXBQZXJjZW50YWdlICsgJyUnKTtcbiAgICAgICAgICAgICAgcHJvZ3Jlc3Muc2V0UHJvZ3Jlc3MoY3VycmVudFppcFBlcmNlbnRhZ2UpO1xuXG4gICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoemlwSW50ZXJ2YWwpO1xuICAgICAgICAgICAgfSwgMTAwKTtcblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRaaXBQZXJjZW50YWdlID49IDEwMCkge1xuICAgICAgICAgICAgICAvLyBjbGVhckludGVydmFsKHppcEludGVydmFsKTtcbiAgICAgICAgICAgICAgLy8gcHJvZ3Jlc3Muc2V0UHJvZ3Jlc3MoY3VycmVudFppcFBlcmNlbnRhZ2UsICdjJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoY29udGVudCkge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2ZpbmlzaCB6aXBwaW5nJyk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnc2F2ZSBmaWxlJyk7XG4gICAgICAgICAgICAvLyBkZWJ1Z2dlcjtcblxuICAgICAgICAgICAgLy8gU3RvcCBpZiB6aXAgaXMgbm8gYWN0aXZlXG4gICAgICAgICAgICBpZiAoIWNvbmZpZy5kb3dubG9hZElzQWN0aXZlKSByZXR1cm47XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZmltJyk7XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBwcm9ncmVzcy5zZXRQcm9ncmVzcygnJywgJ0Rvd25sb2FkIGNvbmNsdcOtZG8hJyk7XG4gICAgICAgICAgICAgIHByb2dyZXNzLmVsZW1lbnRzLnByb2dyZXNzLmNsYXNzTGlzdC5yZW1vdmUoJ2JzLXByb2dyZXNzLS1pcy1sb2FkaW5nJyk7XG4gICAgICAgICAgICAgIHVuY2hlY2tBbGxJdGVtcygpO1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBwcm9ncmVzcy5oaWRlKCk7XG4gICAgICAgICAgICAgIH0sIDUwMDApO1xuXG4gICAgICAgICAgICAgIC8vIFN0b3AgaWYgemlwIGlzIG5vIGFjdGl2ZVxuICAgICAgICAgICAgICBpZiAoIWNvbmZpZy5kb3dubG9hZElzQWN0aXZlKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgLy8gcnVuIHNhdmVBcyBvbiBicm93c2VyXG4gICAgICAgICAgICAgIHNhdmVBcyhjb250ZW50LCB6aXBOYW1lKTtcbiAgICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHN0b3JlWmlwRmlsZSA9IGZ1bmN0aW9uIChjb250ZW50KSB7XG4gICAgY29uZmlnLnppcEZpbGVJZCA9IERhdGUubm93KCk7XG4gICAgLy8gU2FsdmEgb3MgZGFkb3MgbmEgc2Vzc2lvblN0b3JhZ2VcbiAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKGNvbmZpZy56aXBGaWxlSWQsIGNvbnRlbnQpO1xuICB9O1xuXG4gIHZhciBnZXRaaXBGaWxlID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIE9idMOpbSBvcyBkYWRvcyBkYSBzZXNzaW9uU3RvcmFnZVxuICAgIHJldHVybiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKGNvbmZpZy56aXBGaWxlSWQpO1xuICB9O1xuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vIEZpbHRlciBJdGVtc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8qKlxuICAgKiBSZXRvcm5hIHVtIGFycmF5IGNvbSB0b2RvcyBvcyBhbm9zIGRlIGFjb3JkbyBjb20gb3MgaXRlbnMgcGFyYSBkb3dubG9hZFxuICAgKlxuICAgKiBAcGFyYW0gIHtvYmplY3R9IHBhcmVudEVsIHVtIGVsZW1lbnRvIHBhaSBkZSB0b2RvcyBvcyBpdGVuc1xuICAgKiBAcmV0dXJuIHthcnJheX0gICAgICAgICAgIGFycmF5IGNvbSBvcyBhbm9zIGRpc3BvbsOtdmVpc1xuICAgKi9cbiAgdmFyIGdldEFjdGl2ZVllYXJzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBhcnJZZWFycyA9IFtdO1xuICAgIHZhciBjYXRlZ29yaWVzID0gY29uZmlnLmNhdGVnb3JpZXM7XG4gICAgLy8gdmFyIGNhdGVnb3JpZXMgPSBjb25maWcuZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLWRvd25sb2FkX19saXN0LS1hY3RpdmUnKTtcblxuICAgIGFyclllYXJzID0gQXJyYXkucHJvdG90eXBlLnJlZHVjZS5jYWxsKGNhdGVnb3JpZXMsIGZ1bmN0aW9uICh5ZWFycywgY2F0ZWdvcnkpIHtcbiAgICAgIHZhciBpdGVtWWVhcnMgPSBnZXRZZWFyc0J5Q2F0ZWdvcnkoY2F0ZWdvcnkpO1xuICAgICAgaWYgKGNhdGVnb3J5LnN0eWxlLmRpc3BsYXkgIT09ICdub25lJykge1xuICAgICAgICBpdGVtWWVhcnMuZm9yRWFjaChmdW5jdGlvbiAoeWVhcikge1xuICAgICAgICAgIGlmICgheWVhcnMuaW5jbHVkZXMoeWVhcikpIHllYXJzLnB1c2goeWVhcik7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHllYXJzO1xuICAgIH0sIFtdKTtcblxuICAgIHJldHVybiBhcnJZZWFycy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhIC0gYjsgfSkucmV2ZXJzZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDcmlhIHVtIGFycmF5IGNvbSB0b2RvcyBvcyBhbm9zIGRlIGFjb3JkbyBjb20gb3MgaXRlbnMgcGFyYSBkb3dubG9hZFxuICAgKlxuICAgKiBAcGFyYW0gIHtvYmplY3R9ICBjYXRlZ29yeSAgIHVtIGVsZW1lbnRvIHBhaSBkZSB0b2RvcyBvcyBpdGVuc1xuICAgKiBAcGFyYW0gIHtib29sZWFufSBvbmx5QWN0aXZlIC4uLlxuICAgKiBAcmV0dXJuIHthcnJheX0gICAgICAgICAgICAgIGFycmF5IGNvbSBvcyBhbm9zIGRpc3BvbsOtdmVpc1xuICAgKi9cbiAgdmFyIGdldFllYXJzQnlDYXRlZ29yeSA9IGZ1bmN0aW9uIChjYXRlZ29yeSwgb25seUFjdGl2ZSkge1xuICAgIHZhciBhcnJZZWFycyA9IFtdO1xuICAgIHZhciBpdGVtcyA9IG51bGw7XG5cbiAgICBpZiAoIWNhdGVnb3J5IHx8IHR5cGVvZiBjYXRlZ29yeSAhPT0gJ29iamVjdCcpIHJldHVybiBhcnJZZWFycztcbiAgICBpZiAodHlwZW9mIG9ubHlBY3RpdmUgIT09ICdib29sZWFuJykgb25seUFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgaXRlbXMgPSBjYXRlZ29yeS5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtZG93bmxvYWRfX2l0ZW1bZGF0YS1kb3dubG9hZC15ZWFyXScpO1xuXG4gICAgYXJyWWVhcnMgPSBBcnJheS5wcm90b3R5cGUucmVkdWNlLmNhbGwoaXRlbXMsIGZ1bmN0aW9uICh5ZWFycywgaXRlbSkge1xuICAgICAgdmFyIGl0ZW1ZZWFycyA9IGl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLWRvd25sb2FkLXllYXInKS5zcGxpdCgnICcpO1xuICAgICAgaWYgKG9ubHlBY3RpdmUpIHtcbiAgICAgICAgaWYgKGl0ZW0uc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnKSB7XG4gICAgICAgICAgaXRlbVllYXJzLmZvckVhY2goZnVuY3Rpb24gKHllYXIpIHtcbiAgICAgICAgICAgIGlmICgheWVhcnMuaW5jbHVkZXMoeWVhcikpIHllYXJzLnB1c2goeWVhcik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGl0ZW1ZZWFycy5mb3JFYWNoKGZ1bmN0aW9uICh5ZWFyKSB7XG4gICAgICAgICAgaWYgKCF5ZWFycy5pbmNsdWRlcyh5ZWFyKSkgeWVhcnMucHVzaCh5ZWFyKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4geWVhcnM7XG4gICAgfSwgW10pO1xuXG4gICAgcmV0dXJuIGFyclllYXJzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgLSBiOyB9KS5yZXZlcnNlKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENyaWEgdW0gYXJyYXkgY29tIHRvZG9zIG9zIGFub3MgZGUgYWNvcmRvIGNvbSBvcyBpdGVucyBwYXJhIGRvd25sb2FkXG4gICAqXG4gICAqIEBwYXJhbSAge3N0cmluZ30geWVhciB1bSBlbGVtZW50byBwYWkgZGUgdG9kb3Mgb3MgaXRlbnNcbiAgICogQHJldHVybiB7YXJyYXl9ICAgICAgIGFycmF5IGNvbSBvcyBhbm9zIGRpc3BvbsOtdmVpc1xuICAgKi9cbiAgdmFyIGdldENhdGVnb3JpZXNCeVllYXIgPSBmdW5jdGlvbiAoeWVhcikge1xuICAgIHZhciBhcnJDYXRlZ29yaWVzID0gW107XG5cbiAgICBpZiAodHlwZW9mIHllYXIgIT09ICdzdHJpbmcnIHx8IHllYXIgPT09ICcnKSByZXR1cm4gYXJyQ2F0ZWdvcmllcztcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmNhdGVnb3JpZXMsIGZ1bmN0aW9uIChjYXRlZ29yeSkge1xuICAgICAgdmFyIGl0ZW1zID0gY2F0ZWdvcnkucXVlcnlTZWxlY3RvckFsbCgnLmJzLWRvd25sb2FkX19pdGVtW2RhdGEtZG93bmxvYWQteWVhcl0nKTtcblxuICAgICAgQXJyYXkucHJvdG90eXBlLnNvbWUuY2FsbChpdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgdmFyIGl0ZW1ZZWFycyA9IGl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLWRvd25sb2FkLXllYXInKS5zcGxpdCgnICcpO1xuICAgICAgICBpZiAoaXRlbVllYXJzLmluY2x1ZGVzKHllYXIpKSByZXR1cm4gYXJyQ2F0ZWdvcmllcy5wdXNoKGNhdGVnb3J5KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGFyckNhdGVnb3JpZXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIENyaWEgbyBmaWx0cm8gZGUgYW5vXG4gICAqIFBvcHVsYSBvIHNlbGVjdCBkZSBmaWx0cm8gZGUgYW5vcyBkZSBhY29yZG8gY29tIG9zIGFub3MgY2FkYXN0cmFkb3Mgbm9zIGl0ZW5zXG4gICAqXG4gICAqIEBwYXJhbSAge29iamVjdH0gc2VsZWN0IGEgdGFnIHNlbGVjdCBxdWUgdmFpIHJlY2ViZXIgb3MgYW5vcyBjb21vIG9wdGlvbnNcbiAgICogQHJldHVybiB7dm9pZH1cbiAgICovXG4gIHZhciBidWlsZFllYXJTZWxlY3QgPSBmdW5jdGlvbiAoc2VsZWN0KSB7XG4gICAgdmFyIHllYXJzID0gZ2V0QWN0aXZlWWVhcnMoKTtcblxuICAgIHllYXJzLmZvckVhY2goZnVuY3Rpb24gKHllYXIpIHtcbiAgICAgIHZhciBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcbiAgICAgIG9wdGlvbi52YWx1ZSA9IHllYXI7XG4gICAgICBvcHRpb24udGV4dENvbnRlbnQgPSB5ZWFyO1xuICAgICAgc2VsZWN0LmFwcGVuZENoaWxkKG9wdGlvbik7XG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIGhhbmRsZUZpbHRlcnMgPSBmdW5jdGlvbiAoc2VsZWN0KSB7XG4gICAgdmFyIGNhdGVnb3J5SW5wdXQgPSBjb25maWcuZmlsdGVyRm9ybS5xdWVyeVNlbGVjdG9yKCcuYnMtZm9ybV9fZmllbGRbbmFtZT1cImNhdGVnb3J5XCJdJyk7XG4gICAgdmFyIHllYXJJbnB1dCA9IGNvbmZpZy5maWx0ZXJGb3JtLnF1ZXJ5U2VsZWN0b3IoJy5icy1mb3JtX19maWVsZFtuYW1lPVwieWVhclwiXScpO1xuICAgIHZhciBzZWxlY3RlZENhdGVnb3J5SWQgPSAoY2F0ZWdvcnlJbnB1dCAmJiBjYXRlZ29yeUlucHV0LnZhbHVlKSA/IGNhdGVnb3J5SW5wdXQudmFsdWUgOiBudWxsO1xuICAgIHZhciBzZWxlY3RlZENhdGVnb3J5ID0gY29uZmlnLmVsLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWRvd25sb2FkLWNhdGVnb3J5PVwiJyArIHNlbGVjdGVkQ2F0ZWdvcnlJZCArICdcIl0nKTtcbiAgICB2YXIgc2VsZWN0ZWRZZWFyID0gKHllYXJJbnB1dCAmJiB5ZWFySW5wdXQudmFsdWUpID8geWVhcklucHV0LnZhbHVlIDogbnVsbDtcbiAgICAvLyB2YXIgY2F0ZWdvcnlPcHRpb25zID0gKGNhdGVnb3J5SW5wdXQpID8gY2F0ZWdvcnlJbnB1dC5xdWVyeVNlbGVjdG9yQWxsKCdvcHRpb24nKSA6IG51bGw7XG4gICAgdmFyIHllYXJPcHRpb25zID0gKHllYXJJbnB1dCkgPyB5ZWFySW5wdXQucXVlcnlTZWxlY3RvckFsbCgnb3B0aW9uJykgOiBudWxsO1xuICAgIHZhciBjYXRlZ29yaWVzID0gY29uZmlnLmNhdGVnb3JpZXM7XG4gICAgdmFyIGFjdGl2ZUNhdGVnb3JpZXMgPSBudWxsO1xuICAgIHZhciBhY3RpdmVZZWFycyA9IFtdO1xuXG4gICAgLyoqXG4gICAgICogRmlsdHJhIGEgbGlzdGEgZGUgZG93bmxvYWRzIHBvciBjYXRlZ29yaWFzIGRlIGRvd25sb2Fkc1xuICAgICAqL1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY2F0ZWdvcmllcywgZnVuY3Rpb24gKGNhdGVnb3J5KSB7XG4gICAgICAvLyBJRCBkYSBjYXRlZ29yaWEgYXR1YWxcbiAgICAgIHZhciBjYXRlZ29yeUlkID0gY2F0ZWdvcnkuZ2V0QXR0cmlidXRlKCdkYXRhLWRvd25sb2FkLWNhdGVnb3J5Jyk7XG4gICAgICAvLyBJdGVucyBwYXJhIGRvd25sb2FkIGRhIGNhdGVnb3JpYSBhdHVhbFxuICAgICAgdmFyIGNhdGVnb3J5SXRlbXMgPSBjYXRlZ29yeS5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1kb3dubG9hZC15ZWFyXScpO1xuICAgICAgdmFyIGhpZGVHcm91cCA9IHRydWU7XG5cbiAgICAgIC8vIFNlIGjDoSB1bWEgY2F0ZWdvcmlhIHNlbGVjaW9uYSBubyBmaWx0cm8gZSBuw6NvIGZvciBlc3NhLCBlc2NvbmRlXG4gICAgICBpZiAoc2VsZWN0ZWRDYXRlZ29yeUlkKSB7XG4gICAgICAgIGlmIChzZWxlY3RlZENhdGVnb3J5SWQgPT09IGNhdGVnb3J5SWQpIGhpZGVHcm91cCA9IGZhbHNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaGlkZUdyb3VwID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIC8vIFNlIGjDoSB1bSBhbm8gc2VsZWNpb25hZG8gbm8gZmlsdHJvLCByZXNldGEgYSBoaWRlR3JvdXAgcGFyYSBvIGZpbHRyb1xuICAgICAgLy8gZGUgYW5vIHRyYXRhciBzZSBlc2NvbmRlIG91IG7Do28gbyBncnVwb1xuICAgICAgaWYgKHNlbGVjdGVkWWVhcikge1xuICAgICAgICBoaWRlR3JvdXAgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBTZSBuw6NvIGjDoSBjYXRlZ29yaWFzIHNlbGVjaW9uYWRhcyBvdSBzZSBhIGNhdGVnb3JpYSBzZWxlY2lvbmFkb1xuICAgICAgLy8gZm9yIGEgY2F0ZWdvcmlhIGF0dWFsIG5vIGxvb3BcbiAgICAgIGlmICghc2VsZWN0ZWRDYXRlZ29yeUlkIHx8IHNlbGVjdGVkQ2F0ZWdvcnlJZCA9PT0gY2F0ZWdvcnlJZCkge1xuICAgICAgICAvLyBTZSBow6EgaXRlbnMgZGVudHJvIGRlc3NhIGNhdGVnb3JpYVxuICAgICAgICBpZiAoY2F0ZWdvcnlJdGVtcyAmJiBjYXRlZ29yeUl0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgIC8qKlxuICAgICAgICAgICogRmlsdHJhIG9zIGl0ZW5zIGRhIGxpc3RhIGRlIGRvd25sb2FkcyBwb3IgYW5vXG4gICAgICAgICAgKi9cbiAgICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNhdGVnb3J5SXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAvLyBBbm9zIGNhZGFzdHJhZG9zIHBhcmEgbyBpdGVtXG4gICAgICAgICAgICB2YXIgaXRlbVllYXJzID0gaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZG93bmxvYWQteWVhcicpLnNwbGl0KCcgJyk7XG5cbiAgICAgICAgICAgIC8vIFNlIG8gZmlsdHJvIGRlIGFub3MgZXhpc3RlLCBuw6NvIGVzdMOhIHZhemlvIGUgZXN0ZSBpdGVtXG4gICAgICAgICAgICAvLyBOw4NPIHBvc3N1aSBvIGFubyBmaWx0cmFkbywgZXNjb25kZSBvIGl0ZW1cbiAgICAgICAgICAgIGlmICh5ZWFySW5wdXQgJiYgeWVhcklucHV0LnZhbHVlKSB7XG4gICAgICAgICAgICAgIGlmICghaXRlbVllYXJzLmluY2x1ZGVzKHllYXJJbnB1dC52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBpdGVtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaXRlbS5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgICAgICAgICAgICAgaGlkZUdyb3VwID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGl0ZW0uc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICAgICAgICBoaWRlR3JvdXAgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBFc2NvbmRlIGEgY2F0ZWdvcmlhXG4gICAgICBpZiAoaGlkZUdyb3VwKSB7XG4gICAgICAgIGNhdGVnb3J5LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNhdGVnb3J5QWN0aXZlQ2xhc3MpO1xuICAgICAgICBjYXRlZ29yeS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2F0ZWdvcnkuY2xhc3NMaXN0LmFkZChjb25maWcuY2F0ZWdvcnlBY3RpdmVDbGFzcyk7XG4gICAgICAgIGNhdGVnb3J5LnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChjYXRlZ29yeUlucHV0ICYmIHNlbGVjdCA9PT0geWVhcklucHV0KSB7XG4gICAgICBhY3RpdmVDYXRlZ29yaWVzID0gZ2V0Q2F0ZWdvcmllc0J5WWVhcihzZWxlY3RlZFllYXIpO1xuICAgICAgaWYgKGNhdGVnb3JpZXMpIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjYXRlZ29yaWVzLCBmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgICB2YXIgaWQgPSBjYXRlZ29yeS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZG93bmxvYWQtY2F0ZWdvcnknKTtcbiAgICAgICAgICB2YXIgb3B0aW9uID0gY2F0ZWdvcnlJbnB1dC5xdWVyeVNlbGVjdG9yKCdvcHRpb25bdmFsdWU9XCInICsgaWQgKyAnXCJdJyk7XG4gICAgICAgICAgaWYgKGFjdGl2ZUNhdGVnb3JpZXMubGVuZ3RoICYmICFhY3RpdmVDYXRlZ29yaWVzLmluY2x1ZGVzKGNhdGVnb3J5KSkge1xuICAgICAgICAgICAgb3B0aW9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICBvcHRpb24uc3R5bGUuY29sb3IgPSAncmVkJztcbiAgICAgICAgICAgIG9wdGlvbi5kaXNhYmxlZCA9ICdkaXNhYmxlZCc7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG9wdGlvbi5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgICAgICAgICBvcHRpb24uc3R5bGUuY29sb3IgPSAnJztcbiAgICAgICAgICAgIG9wdGlvbi5kaXNhYmxlZCA9ICcnO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHllYXJJbnB1dCAmJiBzZWxlY3QgPT09IGNhdGVnb3J5SW5wdXQpIHtcbiAgICAgIGFjdGl2ZVllYXJzID0gZ2V0WWVhcnNCeUNhdGVnb3J5KHNlbGVjdGVkQ2F0ZWdvcnkpO1xuICAgICAgeWVhck9wdGlvbnMgPSB5ZWFySW5wdXQucXVlcnlTZWxlY3RvckFsbCgnb3B0aW9uJyk7XG4gICAgICBpZiAoeWVhck9wdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoeWVhck9wdGlvbnMsIGZ1bmN0aW9uIChvcHRpb24pIHtcbiAgICAgICAgICBpZiAob3B0aW9uLnZhbHVlICYmIGFjdGl2ZVllYXJzLmxlbmd0aCAmJiAhYWN0aXZlWWVhcnMuaW5jbHVkZXMob3B0aW9uLnZhbHVlKSkge1xuICAgICAgICAgICAgb3B0aW9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICBvcHRpb24uc3R5bGUuY29sb3IgPSAncmVkJztcbiAgICAgICAgICAgIG9wdGlvbi5kaXNhYmxlZCA9ICdkaXNhYmxlZCc7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG9wdGlvbi5zdHlsZS5jb2xvciA9ICcnO1xuICAgICAgICAgICAgb3B0aW9uLnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICAgICAgICAgIG9wdGlvbi5kaXNhYmxlZCA9ICcnO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICBwcm9ncmVzczogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGNvbmZpZy5kb3dubG9hZFByb2dyZXNzXG4gICAgfSxcbiAgICBmaWx0ZXI6IGhhbmRsZUZpbHRlcnMsXG4gIH07XG59O1xuXG4vKipcbiAqIEluaXQgTW9kYWwgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHdpbmRvdy5kb3dubG9hZHNBcnIgPSBbXTtcbiAgdmFyIGRvd25sb2FkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1kb3dubG9hZCcpO1xuICBpZiAoZG93bmxvYWRzLmxlbmd0aCkge1xuICAgIHZhciBkb3dubG9hZCA9IG51bGw7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChkb3dubG9hZHMsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgZG93bmxvYWQgPSBuZXcgQnNEb3dubG9hZHNMaXN0KGVsKTtcbiAgICAgIGRvd25sb2FkLmluaXQoKTtcbiAgICAgIGRvd25sb2Fkc0Fyci5wdXNoKGRvd25sb2FkKTtcbiAgICB9KTtcbiAgfVxufSk7XG4iLCJ2YXIgQnNMb2dpblZpZGEgPSAoZnVuY3Rpb24gKCkge1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGVsSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXRlbmQtYXV0by1jcGYtY25waicpXG4gICAgZWxJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIHZhbGlkYXRlSW5wdXQpO1xuXG4gICAgZnVuY3Rpb24gdmFsaWRhdGVJbnB1dCgpIHtcbiAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdGVuZC1hdXRvLWNwZi1jbnBqJykudmFsdWU7XG4gICAgICB2YXIgdGV4dFJHRVggPSAvW2Etel0vaTtcbiAgICAgIHZhciB0ZXh0UmVzdWx0ID0gdGV4dFJHRVgudGVzdChlbCk7XG4gICAgICBpZiAodGV4dFJlc3VsdCA9PSB0cnVlIHx8IGVsID09ICcnKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2coJ3RleHRvJylcbiAgICAgICAgZWxJbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ21heGxlbmd0aCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnVuY3Rpb24gbWFzaygpIHtcbiAgICAgICAgICB2YXIgY3BmID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F0ZW5kLWF1dG8tY3BmLWNucGonKVxuICAgICAgICAgIGlmIChjcGYudmFsdWUubGVuZ3RoID09IDMgfHwgY3BmLnZhbHVlLmxlbmd0aCA9PSA3KSB7XG4gICAgICAgICAgICBjcGYudmFsdWUgKz0gXCIuXCJcbiAgICAgICAgICB9IGVsc2UgaWYgKGNwZi52YWx1ZS5sZW5ndGggPT0gMTEpIHtcbiAgICAgICAgICAgIGNwZi52YWx1ZSArPSBcIi1cIlxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBtYXNrKCk7XG4gICAgICAgIGVsSW5wdXQuc2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnLCAnMTQnKTtcblxuICAgICAgfVxuXG4gICAgfVxuXG4gICAgLy9TZXRhbmRvIHZhbG9yIG7Do28gZm9jYWxpesOhdmVsIHBhcmEgU1ZHL1Byb2JsZW1hIElFMTFcbiAgICB2YXIgcmVtb3ZlRm9jdXNhYmxlU3ZnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWhlYWRlcl9fbG9nbyBzdmcnKTtcbiAgICBpZiAocmVtb3ZlRm9jdXNhYmxlU3ZnICE9IG51bGwpIHtcbiAgICAgIHJlbW92ZUZvY3VzYWJsZVN2Zy5zZXRBdHRyaWJ1dGUoJ2ZvY3VzYWJsZScsICdmYWxzZScpO1xuICAgIH1cblxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcblxuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWJhbm5lci1mb3JtLWxvZ2luLXNpZ24nKS5sZW5ndGgpIHtcbiAgICBCc0xvZ2luVmlkYS5pbml0KCk7XG4gIH1cblxuICBpc0xvZ2luVmlkYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1sb2dpbi12aWRhJylcbiAgXG4gIGlmICgvaVBob25lL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSAmJiBpc0xvZ2luVmlkYSAhPSBudWxsKSB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWxvZ2luLXZpZGEnKS5jbGFzc0xpc3QuYWRkKCdpcy1pcGhvbmUnKTtcbiAgfSBlbHNlIGlmICgvaVBhZC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtbG9naW4tdmlkYScpLmNsYXNzTGlzdC5hZGQoJ2lzLWlwYWQnKTtcbiAgfTtcblxufSk7XG5cbiIsIi8qKlxuICogU2NyaXB0IG1hcGEgKyBjYXJkIHRlbGVmb25lXG4gKi9cbnZhciBNdWx0aU1hcmtlck1hcCA9IChmdW5jdGlvbiAoKSB7XG5cbiAgdmFyIG1hcEVsZW1lbnRBbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGktbWFwcycpO1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKG1hcFNlbGVjdG9yKSB7XG4gICAgdmFyIG1hcEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG1hcFNlbGVjdG9yKTtcbiAgICBcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKG1hcEVsZW1lbnRBbGwsIGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICBtYXBFbDogZWxlbSxcbiAgICAgICAgbWFwTG9jYXRpb25zOiBlbGVtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1tYXAtaW5mb19fbG9jYXRpb24nKSxcbiAgICAgICAgY2VudGVyUG9pbnRMYXQ6IGVsZW0uZ2V0QXR0cmlidXRlKCdkYXRhLW1hcC1sYXQnKSxcbiAgICAgICAgY2VudGVyUG9pbnRMbmc6IGVsZW0uZ2V0QXR0cmlidXRlKCdkYXRhLW1hcC1sbmcnKSxcbiAgICAgICAgaW5zaWRlVGl0bGU6ICcnLFxuICAgICAgICBpbnNpZGVBZGRyZXNzOiAnJyxcbiAgICAgICAgaW5zaWRlTGF0OiAnJyxcbiAgICAgICAgaW5zaWRlTG5nOiAnJyxcbiAgICAgICAgZmluYWxMaXN0OiBbXSxcbiAgICAgIH07XG4gICAgICBcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLm1hcExvY2F0aW9ucywgZnVuY3Rpb24gKGUsIGluZGV4KSB7XG4gICAgICAgIGNvbmZpZy5pbnNpZGVUaXRsZSA9IGUuZ2V0QXR0cmlidXRlKCdkYXRhLXRpdGxlJyk7XG4gICAgICAgIGNvbmZpZy5pbnNpZGVBZGRyZXNzID0gZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtYWRkcmVzcycpO1xuICAgICAgICBjb25maWcuaW5zaWRlTGF0ID0gZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtbGF0Jyk7XG4gICAgICAgIGNvbmZpZy5pbnNpZGVMbmcgPSBlLmdldEF0dHJpYnV0ZSgnZGF0YS1sbmcnKTtcbiAgXG4gICAgICAgIHZhciBsaXN0SW5zaWRlID0ge1xuICAgICAgICAgIGlkOiBpbmRleCxcbiAgICAgICAgICBhZGRyZXNzOiBjb25maWcuaW5zaWRlQWRkcmVzcyxcbiAgICAgICAgICBsYXQ6IGNvbmZpZy5pbnNpZGVMYXQsXG4gICAgICAgICAgbG5nOiBjb25maWcuaW5zaWRlTG5nLFxuICAgICAgICAgIGZuOiBmdW5jdGlvbiAoKSB7IHJldHVybiBzY3JvbGxUbyhpbmRleCk7IH0sXG4gICAgICAgICAgaW5mb1dpbmRvdzoge1xuICAgICAgICAgICAgc2hvdzogZmFsc2UsXG4gICAgICAgICAgICB0aXRsZTogY29uZmlnLmluc2lkZVRpdGxlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gIFxuICAgICAgICBjb25maWcuZmluYWxMaXN0LnB1c2gobGlzdEluc2lkZSk7XG4gIFxuICAgICAgfSk7XG4gIFxuICAgICAgaWYgKGNvbmZpZy5tYXBFbCAmJiBjb25maWcuZmluYWxMaXN0Lmxlbmd0aCkge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgICBtYXBIZWlnaHQ6IDUwMCxcbiAgICAgICAgICBsb2NhdGlvbnM6IGNvbmZpZy5maW5hbExpc3QsXG4gICAgICAgICAgbWFwT3B0aW9uczoge1xuICAgICAgICAgICAgem9vbTogMTQsXG4gICAgICAgICAgICBjZW50ZXI6IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoY29uZmlnLmNlbnRlclBvaW50TGF0LCBjb25maWcuY2VudGVyUG9pbnRMbmcpLFxuICAgICAgICAgICAgbWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCxcbiAgICAgICAgICB9LFxuICAgICAgICB9O1xuICBcbiAgICAgICAgQnNNYXBzLmluaXQoY29uZmlnLm1hcEVsLCBvcHRpb25zKTtcbiAgICAgIH0gXG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIHNjcm9sbFRvID0gZnVuY3Rpb24gKGVsZW1lbnRJZCkge1xuICAgIHZhciB0YXJnZXRBbmNob3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1zY3JvbGwtYW5jaG9yPVwiJyArIGVsZW1lbnRJZCArICdcIl0nKTtcblxuICAgIGlmICh0YXJnZXRBbmNob3IpIHtcbiAgICAgIHZhciBzY3JvbGwgPSBuZXcgU21vb3RoU2Nyb2xsKCk7XG4gICAgICB2YXIgY3VycmVudEFjdGl2ZSA9IHRhcmdldEFuY2hvci5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1pcy1hY3RpdmUnKTtcbiAgICAgIGlmIChjdXJyZW50QWN0aXZlKSBjdXJyZW50QWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2JzLWlzLWFjdGl2ZScpO1xuICAgICAgdGFyZ2V0QW5jaG9yLmNsYXNzTGlzdC5hZGQoJ2JzLWlzLWFjdGl2ZScpO1xuICAgICAgc2Nyb2xsLmFuaW1hdGVTY3JvbGwodGFyZ2V0QW5jaG9yLCAwLCB7IFxuICAgICAgICBzcGVlZDogMzAwLFxuICAgICAgICBvZmZzZXQ6IDE1LFxuICAgICAgfSk7XG5cbiAgICAgIEJzSGVhZGVyLnNldFVucGlubmVkKCk7XG4gICAgICBCc0hlYWRlci5zZXRGcmVlemUoKTtcbiAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICBCc0hlYWRlci51bnNldEZyZWV6ZSgpO1xuICAgICAgfSwgNDAwKVxuICAgIH07XG4gIH07XG5cblxuICB2YXIgbWFwQWRkcmVzcyA9IGZ1bmN0aW9uIChhZGQpIHtcbiAgICB2YXIgZ2VvY29kZXI7XG4gICAgdmFyIG1hcDtcbiAgICB2YXIgbWFya2VyO1xuXG4gICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICB6b29tOiAxOCxcbiAgICAgIG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVBcbiAgICB9O1xuXG4gICAgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmJzLWpzLW1hcFwiKSwgb3B0aW9ucyk7XG4gICAgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcbiAgICBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgIG1hcDogbWFwLFxuICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgZ2VvY29kZXIuZ2VvY29kZSh7ICdhZGRyZXNzJzogYWRkICsgJywgQnJhc2lsJywgJ3JlZ2lvbic6ICdCUicgfSwgZnVuY3Rpb24gKHJlc3VsdHMsIHN0YXR1cykge1xuXG4gICAgICBpZiAoc3RhdHVzID09IGdvb2dsZS5tYXBzLkdlb2NvZGVyU3RhdHVzLk9LKSB7XG4gICAgICAgIGlmIChyZXN1bHRzWzBdKSB7XG4gICAgICAgICAgdmFyIGxhdGl0dWRlID0gcmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKTtcbiAgICAgICAgICB2YXIgbG9uZ2l0dWRlID0gcmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKTtcblxuICAgICAgICAgIHZhciBsb2NhdGlvbiA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobGF0aXR1ZGUsIGxvbmdpdHVkZSk7XG4gICAgICAgICAgbWFya2VyLnNldFBvc2l0aW9uKGxvY2F0aW9uKTtcbiAgICAgICAgICBtYXAuc2V0Q2VudGVyKGxvY2F0aW9uKTtcbiAgICAgICAgICBtYXAuc2V0Wm9vbSgxNSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgTXVsdGlNYXJrZXJNYXAgY29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IE11bHRpTWFya2VyTWFwLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5waS1tYXBzJykubGVuZ3RoKSB7XG4gICAgaW5pdEdvb2dsZU1hcChmdW5jdGlvbiAoKSB7XG4gICAgICBNdWx0aU1hcmtlck1hcC5pbml0KCcuYnMtanMtbWFwJyk7XG4gICAgfSk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBCc01lZGlhU2xpZGVyXG4gKiBAcmV0dXJuIE1vZHVsZSBjb25maWdcbiAqL1xudmFyIEJzTWVkaWFTbGlkZXIgPSAoZnVuY3Rpb24gKCkge1xuXG4gIC8vIENvbmZpZ1xuICB2YXIgY29uZmlnID0ge1xuICAgIGNvbnRhaW5lcnM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1zbGlkZXInKSxcbiAgfVxuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuY29udGFpbmVycywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciBjb250YWluZXIgPSBlO1xuXG4gICAgICB2YXIgaXRlbSA9IGUucXVlcnlTZWxlY3RvckFsbCgnLmJzLWNhcmQtc2xpZGVyX19uYXYtcmVzdWx0IC5icy1tZWRpYV9faXRlbScpO1xuXG4gICAgICB2YXIgcmVkdWNlckhlaWdodCA9IEFycmF5LnByb3RvdHlwZS5yZWR1Y2UuY2FsbChpdGVtLCBmdW5jdGlvbiAoaSwgZWwpIHtcbiAgICAgICAgdmFyIGNoaWxkID0gZWwucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19ib3gnKTtcblxuICAgICAgICBpZiAoY2hpbGQpIHtcbiAgICAgICAgICB2YXIgaSA9IGkgPj0gY2hpbGQub2Zmc2V0SGVpZ2h0ID8gaSA6IGNoaWxkLm9mZnNldEhlaWdodDtcbiAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuXG4gICAgICB9LCAwKTtcblxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGluaXRDYXJvdXNlbENvbnRhaW5lcihjb250YWluZXIsIHJlZHVjZXJIZWlnaHQpO1xuICAgICAgfSwgMjAwMCk7XG4gICAgfSk7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmNvbnRhaW5lcnMsIGZ1bmN0aW9uIChjb250YWluZXIpIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIGNhcm91c2VsID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fbGlzdCcpO1xuICAgICAgICAgIHZhciBmbGt0eSA9IEZsaWNraXR5LmRhdGEoY2Fyb3VzZWwpO1xuICAgICAgICAgIGlmIChmbGt0eSkge1xuICAgICAgICAgICAgZmxrdHkucmVsb2FkQ2VsbHMoKTtcbiAgICAgICAgICAgIGZsa3R5LnJlc2l6ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgMzAwMCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgaW5pdENhcm91c2VsQ29udGFpbmVyID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgcmVkdWNlckhlaWdodCkge1xuXG4gICAgdmFyIGNhcm91c2VsID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fbGlzdCcpO1xuICAgIHZhciBwYW5lbCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX25hdiAuYnMtbWVkaWFfX2xpc3QnKTtcbiAgICB2YXIgbG9hZGluZyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuYnMtbG9hZGluZycpO1xuICAgIHZhciBmbGt0eUE7XG4gICAgdmFyIGZsa3R5ID0gbmV3IEZsaWNraXR5KGNhcm91c2VsLCB7XG4gICAgICBhc05hdkZvcjogcGFuZWwsXG4gICAgICBncm91cENlbGxzOiAndHJ1ZScsXG4gICAgICBjZWxsQWxpZ246ICdsZWZ0JyxcbiAgICAgIGNvbnRhaW46IGZhbHNlLFxuICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgICAgcHJldk5leHRCdXR0b25zOiBmYWxzZSxcbiAgICAgIGZyZWVTY3JvbGw6IGZhbHNlLFxuICAgICAgb246IHtcbiAgICAgICAgcmVhZHk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aGlzLnJlbG9hZENlbGxzKCk7XG4gICAgICAgICAgdGhpcy5yZXNpemUoKTtcbiAgICAgICAgICByZWxvYWRGbGt0eSh0aGlzLCAxMDAwKTtcbiAgICAgICAgICBsb2FkaW5nLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobG9hZGluZyk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gbmF2IGl0ZW1zIGNvbnRlbnRcbiAgICBpZiAocGFuZWwpIHtcbiAgICAgIGZsa3R5QSA9IG5ldyBGbGlja2l0eShwYW5lbCwge1xuICAgICAgICBwYWdlRG90czogZmFsc2UsXG4gICAgICAgIGNlbGxBbGlnbjogJ2xlZnQnLFxuICAgICAgICBwcmV2TmV4dEJ1dHRvbnM6IGZhbHNlLFxuICAgICAgICBhZGFwdGl2ZUhlaWdodDogdHJ1ZSxcbiAgICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgICAgICBmcmVlU2Nyb2xsOiBmYWxzZSxcbiAgICAgICAgb246IHtcbiAgICAgICAgICByZWFkeTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5yZWxvYWRDZWxscygpO1xuICAgICAgICAgICAgdGhpcy5yZXNpemUoKTtcbiAgICAgICAgICAgIHJlbG9hZEZsa3R5KHRoaXMsIDEwMDApO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgdmFyIG5hdkNsb3NlID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fbmF2LS1jbG9zZScpO1xuICAgICAgdmFyIG5hdkNvbnRlbnQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19uYXYnKTtcbiAgICAgIHZhciBuYXZJdGVtID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1tZWRpYV9faXRlbScpO1xuXG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKG5hdkl0ZW0sIGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgICAgZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbmF2Q29udGVudC5jbGFzc0xpc3QuYWRkKCdicy1tZWRpYV9fbmF2LS1hY3RpdmUnKTtcbiAgICAgICAgICAgIHJlbG9hZEZsa3R5KGZsa3R5QSk7XG4gICAgICAgICAgICAvLyBuYXZDb250ZW50LnN0eWxlLm1heEhlaWdodCA9IDYwICsgcmVkdWNlckhlaWdodCArICdweCc7XG4gICAgICAgICAgfSwgNDAwKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuXG4gICAgICBuYXZDbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbmF2Q29udGVudC5jbGFzc0xpc3QucmVtb3ZlKCdicy1tZWRpYV9fbmF2LS1hY3RpdmUnKTtcbiAgICAgICAgLy8gbmF2Q29udGVudC5zdHlsZS5tYXhIZWlnaHQgPSAwICsgJ3B4JztcbiAgICAgIH0pO1xuXG4gICAgfVxuXG4gICAgLy8gYnV0dG9ucyBhY3Rpb25zIG1vdmUgLSBsZWZ0XG4gICAgdmFyIHByZXZpb3VzQnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3ctcHJldicpO1xuICAgIHByZXZpb3VzQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgZmxrdHkucHJldmlvdXMoKTtcbiAgICB9KTtcblxuICAgIC8vIGJ1dHRvbnMgYWN0aW9ucyBtb3ZlIC0gcmlnaHRcbiAgICB2YXIgbmV4dEJ1dHRvbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93LW5leHQnKTtcbiAgICBuZXh0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgZmxrdHkubmV4dCgpO1xuICAgIH0pO1xuXG4gICAgLy8gZmxrdHkub24oICdzY3JvbGwnLCBmdW5jdGlvbigpIHtcbiAgICAvLyAgIGZsa3R5LmRlc3Ryb3koKVxuICAgIC8vICAgZmxrdHkgPSBuZXcgRmxpY2tpdHkocGFuZWwpO1xuICAgIC8vIH0pO1xuXG4gICAgbmV4dEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG4gICAgY2Fyb3VzZWwuY2xhc3NMaXN0LmFkZCgnYnMtbWVkaWFfX2xpc3QtLWxpbmVhci1uZXh0Jyk7XG5cblxuICAgIGZsa3R5Lm9uKCdjZWxsU2VsZWN0JywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAvLyBjbGFzcyBhZGQgb3IgcmVtb3ZlIGVmZmVjdCBvdmVyIGluIHBvc2l0aW9uIGluaXRpYWxcbiAgICAgIGlmICghZmxrdHkuY2VsbHNbZmxrdHkuc2VsZWN0ZWRJbmRleCAtIDFdKSB7XG5cbiAgICAgICAgbmV4dEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG4gICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5hZGQoJ2JzLW1lZGlhX19saXN0LS1saW5lYXItbmV4dCcpO1xuXG4gICAgICAgIHByZXZpb3VzQnV0dG9uLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LnJlbW92ZSgnYnMtbWVkaWFfX2xpc3QtLWxpbmVhci1wcmV2Jyk7XG5cbiAgICAgICAgLy8gY2xhc3MgYWRkIG9yIHJlbW92ZSBlZmZlY3Qgb3ZlciBpbiBwb3NpdGlvbiBmaW5hbFxuICAgICAgfSBlbHNlIGlmICghZmxrdHkuY2VsbHNbZmxrdHkuY2VsbHMubGVuZ3RoXSkge1xuXG4gICAgICAgIHByZXZpb3VzQnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LmFkZCgnYnMtbWVkaWFfX2xpc3QtLWxpbmVhci1wcmV2Jyk7XG5cbiAgICAgICAgLy8gY2xhc3MgYWRkIG9yIHJlbW92ZSBlZmZlY3Qgb3ZlciBpbiBtaWRkbGUgcG9zaXRpb24gdG8gaXRlbXMgYmlnIHRoYW4gc2lkZXNcbiAgICAgICAgaWYgKGZsa3R5LnNlbGVjdGVkSW5kZXggPT09IChmbGt0eS5wYWdlRG90cy5kb3RzLmxlbmd0aCAtIDEpKSB7XG5cbiAgICAgICAgICBuZXh0QnV0dG9uLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QucmVtb3ZlKCdicy1tZWRpYV9fbGlzdC0tbGluZWFyLW5leHQnKTtcbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgIHByZXZpb3VzQnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICBuZXh0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblxuICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5hZGQoJ2JzLW1lZGlhX19saXN0LS1saW5lYXItbmV4dCcpO1xuICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5hZGQoJ2JzLW1lZGlhX19saXN0LS1saW5lYXItcHJldicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvL0Vzc2UgdO+/vSBmdW5jaW9uYW5kbyEhIVxuICAgIHZhciBtZWRpYV9jdXN0b20gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdicy1tZWRpYV9fbGlzdC0tY3VzdG9tJyk7XG4gICAgZm9yIChpID0gMDsgaSA8IG1lZGlhX2N1c3RvbS5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIG1lZGlhX2JveCA9IG1lZGlhX2N1c3RvbVtpXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdmbGlja2l0eS1zbGlkZXInKTtcbiAgICAgIGZvciAoaiA9IDA7IGogPCBtZWRpYV9ib3gubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgdmFyIGNvdW50SXRlbSA9IG1lZGlhX2JveFswXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdicy1tZWRpYV9faXRlbScpO1xuXG4gICAgICAgIGlmIChjb3VudEl0ZW0ubGVuZ3RoIDw9IDIpIHtcblxuICAgICAgICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGhvbmUvaSkgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBhZC9pKSB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9BbmRyb2lkL2kpKSB7XG4gICAgICAgICAgICAvL01vYmlsZVxuXG4gICAgICAgICAgICBpZiAoY291bnRJdGVtLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZHJhZ2dhYmxlJyk7XG4gICAgICAgICAgICAgIC8vY2Fyb3VzZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuZmxpY2tpdHktcGFnZS1kb3RzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY2Fyb3VzZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93cycpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QuYWRkKCdpcy1kcmFnZ2FibGUnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvL0Rlc2t0b3BcbiAgICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZHJhZ2dhYmxlJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY2Fyb3VzZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93cycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZHJhZ2dhYmxlJyk7XG5cbiAgICAgICAgfVxuXG5cbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgbWVkaWFfY3VzdG9tU2xpZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnMtbWVkaWFfX3NsaWRlci0tbmF2Jyk7XG4gICAgZm9yIChpID0gMDsgaSA8IG1lZGlhX2N1c3RvbVNsaWRlci5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIG1lZGlhX2JveCA9IG1lZGlhX2N1c3RvbVNsaWRlcltpXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdmbGlja2l0eS1zbGlkZXInKTtcbiAgICAgIGZvciAoaiA9IDA7IGogPCBtZWRpYV9ib3gubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgdmFyIGNvdW50SXRlbSA9IG1lZGlhX2JveFswXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdicy1tZWRpYV9faXRlbScpO1xuXG4gICAgICAgIGlmIChjb3VudEl0ZW0ubGVuZ3RoIDw9IDIpIHtcblxuICAgICAgICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGhvbmUvaSkgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBhZC9pKSB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9BbmRyb2lkL2kpKSB7XG4gICAgICAgICAgICAvL01vYmlsZVxuXG4gICAgICAgICAgICBpZiAoY291bnRJdGVtLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZHJhZ2dhYmxlJyk7XG4gICAgICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUhaW1wb3J0YW50JztcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY2Fyb3VzZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93cycpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QuYWRkKCdpcy1kcmFnZ2FibGUnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvL0Rlc2t0b3BcbiAgICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZHJhZ2dhYmxlJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY2Fyb3VzZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93cycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZHJhZ2dhYmxlJyk7XG5cbiAgICAgICAgfVxuXG5cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKlxuICAgIHZhciBtZWRpYV9jdXN0b21TbGlkZXJOYXYgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdicy1tZWRpYV9fc2xpZGVyLS1uYXYnKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbWVkaWFfY3VzdG9tU2xpZGVyTmF2Lmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgIGNvbnNvbGUubG9nKCdFU1NFIEFRVUknKVxuXG4gICAgICB2YXIgbWVkaWFfYm94ID0gbWVkaWFfY3VzdG9tU2xpZGVyTmF2W2ldLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2ZsaWNraXR5LXNsaWRlcicpO1xuICAgICAgZm9yIChqID0gMDsgaiA8IG1lZGlhX2JveC5sZW5ndGg7IGorKykge1xuICAgICAgICB2YXIgY291bnRJdGVtID0gbWVkaWFfYm94WzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2JzLW1lZGlhX19pdGVtJyk7XG5cbiAgICAgICAgaWYgKGNvdW50SXRlbS5sZW5ndGggPD0gMykge1xuXG4gICAgICAgICAgaWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQaG9uZS9pKSB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGFkL2kpIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FuZHJvaWQvaSkpIHtcbiAgICAgICAgICAgIC8vTW9iaWxlXG5cbiAgICAgICAgICAgIGlmIChjb3VudEl0ZW0ubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kcmFnZ2FibGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LmFkZCgnaXMtZHJhZ2dhYmxlJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy9EZXNrdG9wXG4gICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuXG4gICAgICAgIH1cblxuXG4gICAgICB9XG4gICAgfVxuICAgICovXG5cblxuICAgIHZhciBtZWRpYV9jdXN0b21TbGlkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpcy1jYXJkLXNsaWRlJyk7XG4gICAgZm9yIChpID0gMDsgaSA8IG1lZGlhX2N1c3RvbVNsaWRlci5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIG1lZGlhX2JveCA9IG1lZGlhX2N1c3RvbVNsaWRlcltpXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdmbGlja2l0eS1zbGlkZXInKTtcbiAgICAgIGZvciAoaiA9IDA7IGogPCBtZWRpYV9ib3gubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgdmFyIGNvdW50SXRlbSA9IG1lZGlhX2JveFswXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdicy1tZWRpYV9faXRlbSAnKTtcbiAgICAgICAgaWYgKGNvdW50SXRlbS5sZW5ndGggPD0gNSkge1xuICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFjYXJvdXNlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLWRyYWdnYWJsZScpKSB7XG4gICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9XG5cbiAgICB2YXIgbWVkaWFfY3VzdG9tQ2FyZFNsaWRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnMtY2FyZC1zbGlkZXInKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbWVkaWFfY3VzdG9tQ2FyZFNsaWRlLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgbWVkaWFfYm94ID0gbWVkaWFfY3VzdG9tQ2FyZFNsaWRlW2ldLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2ZsaWNraXR5LXNsaWRlcicpO1xuICAgICAgZm9yIChqID0gMDsgaiA8IG1lZGlhX2JveC5sZW5ndGg7IGorKykge1xuICAgICAgICB2YXIgY291bnRJdGVtID0gbWVkaWFfYm94WzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2JzLW1lZGlhX19pdGVtICcpO1xuXG4gICAgICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGhvbmUvaSkgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBhZC9pKSB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9BbmRyb2lkL2kpKSB7XG4gICAgICAgICAgaWYgKGNvdW50SXRlbS5sZW5ndGggPD0gNCkge1xuICAgICAgICAgICAgY2Fyb3VzZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93cycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kcmFnZ2FibGUnKTtcbiAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QuYWRkKCdpcy1kcmFnZ2FibGUnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICBpZiAoY291bnRJdGVtLmxlbmd0aCA8PSA1KSB7XG4gICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5hZGQoJ2lzLWRyYWdnYWJsZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFjYXJvdXNlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLWRyYWdnYWJsZScpKSB7XG4gICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9XG5cblxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuXG4vKipcbiAqIEluaXQgTWVudSBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gTWVudS5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX3NsaWRlcicpKSB7XG4gICAgQnNNZWRpYVNsaWRlci5pbml0KCk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBCc01lZGlhU2xpZGVyUmVmXG4gKiBAcmV0dXJuIE1vZHVsZSBjb25maWdcbiAqL1xudmFyIEJzTWVkaWFTbGlkZXJSZWYgPSAoZnVuY3Rpb24gKCkge1xuXG4gIC8vIENvbmZpZ1xuICB2YXIgY29uZmlnID0ge1xuICAgIGNvbnRhaW5lcnM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1jYXJyb3VzZWwtcHJvZCcpLFxuICB9XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5jb250YWluZXJzLCBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIGNvbnRhaW5lciA9IGU7XG5cbiAgICAgIHZhciBpdGVtID0gZS5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtY2FyZC1zbGlkZXJfX25hdi1yZXN1bHQgLmJzLW1lZGlhX19pdGVtJyk7XG5cbiAgICAgIHZhciByZWR1Y2VySGVpZ2h0ID0gQXJyYXkucHJvdG90eXBlLnJlZHVjZS5jYWxsKGl0ZW0sIGZ1bmN0aW9uIChpLCBlbCkge1xuICAgICAgICB2YXIgY2hpbGQgPSBlbC5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2JveCcpO1xuXG4gICAgICAgIGlmIChjaGlsZCkge1xuICAgICAgICAgIHZhciBpID0gaSA+PSBjaGlsZC5vZmZzZXRIZWlnaHQgPyBpIDogY2hpbGQub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9XG5cbiAgICAgIH0sIDApO1xuXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaW5pdENhcm91c2VsQ29udGFpbmVyUmVmKGNvbnRhaW5lciwgcmVkdWNlckhlaWdodCk7XG4gICAgICB9LCAyMDAwKTtcbiAgICB9KTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgZnVuY3Rpb24gKCkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuY29udGFpbmVycywgZnVuY3Rpb24gKGNvbnRhaW5lcikge1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgY2Fyb3VzZWwgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19saXN0Jyk7XG4gICAgICAgICAgdmFyIGZsa3R5ID0gRmxpY2tpdHkuZGF0YShjYXJvdXNlbCk7XG4gICAgICAgICAgaWYgKGZsa3R5KSB7XG4gICAgICAgICAgICBmbGt0eS5yZWxvYWRDZWxscygpO1xuICAgICAgICAgICAgZmxrdHkucmVzaXplKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCAzMDAwKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBpbml0Q2Fyb3VzZWxDb250YWluZXJSZWYgPSBmdW5jdGlvbiAoY29udGFpbmVyLCByZWR1Y2VySGVpZ2h0KSB7XG5cbiAgICB2YXIgY2Fyb3VzZWwgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19saXN0Jyk7XG4gICAgdmFyIHBhbmVsID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fbmF2IC5icy1tZWRpYV9fbGlzdCcpO1xuICAgIHZhciBsb2FkaW5nID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5icy1sb2FkaW5nJyk7XG4gICAgdmFyIGZsa3R5QTtcbiAgICB2YXIgZmxrdHkgPSBuZXcgRmxpY2tpdHkoY2Fyb3VzZWwsIHtcbiAgICAgIHNlbGVjdGVkQXR0cmFjdGlvbjogMC4yLFxuICAgICAgZnJpY3Rpb246IDEuMCxcbiAgICAgIGFzTmF2Rm9yOiBwYW5lbCxcbiAgICAgIGdyb3VwQ2VsbHM6ICd0cnVlJyxcbiAgICAgIGNlbGxBbGlnbjogJ2xlZnQnLFxuICAgICAgY29udGFpbjogZmFsc2UsXG4gICAgICBkcmFnZ2FibGU6IHRydWUsXG4gICAgICBwcmV2TmV4dEJ1dHRvbnM6IGZhbHNlLFxuICAgICAgb246IHtcbiAgICAgICAgcmVhZHk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aGlzLnJlbG9hZENlbGxzKCk7XG4gICAgICAgICAgdGhpcy5yZXNpemUoKTtcbiAgICAgICAgICByZWxvYWRGbGt0eSh0aGlzLCAxMDAwKTtcbiAgICAgICAgICBsb2FkaW5nLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobG9hZGluZyk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gbmF2IGl0ZW1zIGNvbnRlbnRcbiAgICBpZiAocGFuZWwpIHtcbiAgICAgIGZsa3R5QSA9IG5ldyBGbGlja2l0eShwYW5lbCwge1xuICAgICAgICBwYWdlRG90czogZmFsc2UsXG4gICAgICAgIGNlbGxBbGlnbjogJ2xlZnQnLFxuICAgICAgICBwcmV2TmV4dEJ1dHRvbnM6IGZhbHNlLFxuICAgICAgICBhZGFwdGl2ZUhlaWdodDogdHJ1ZSxcbiAgICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgICAgICBvbjoge1xuICAgICAgICAgIHJlYWR5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnJlbG9hZENlbGxzKCk7XG4gICAgICAgICAgICB0aGlzLnJlc2l6ZSgpO1xuICAgICAgICAgICAgcmVsb2FkRmxrdHkodGhpcywgMTAwMCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICB2YXIgbmF2Q2xvc2UgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19uYXYtLWNsb3NlJyk7XG4gICAgICB2YXIgbmF2Q29udGVudCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX25hdicpO1xuICAgICAgdmFyIG5hdkl0ZW0gPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmJzLW1lZGlhX19pdGVtJyk7XG5cbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwobmF2SXRlbSwgZnVuY3Rpb24gKGUpIHtcblxuICAgICAgICBlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBuYXZDb250ZW50LmNsYXNzTGlzdC5hZGQoJ2JzLW1lZGlhX19uYXYtLWFjdGl2ZScpO1xuICAgICAgICAgICAgcmVsb2FkRmxrdHkoZmxrdHlBKTtcbiAgICAgICAgICAgIC8vIG5hdkNvbnRlbnQuc3R5bGUubWF4SGVpZ2h0ID0gNjAgKyByZWR1Y2VySGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICB9LCA0MDApO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG5cbiAgICAgIG5hdkNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBuYXZDb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2JzLW1lZGlhX19uYXYtLWFjdGl2ZScpO1xuICAgICAgICAvLyBuYXZDb250ZW50LnN0eWxlLm1heEhlaWdodCA9IDAgKyAncHgnO1xuICAgICAgfSk7XG5cbiAgICB9XG5cbiAgICAvLyBidXR0b25zIGFjdGlvbnMgbW92ZSAtIGxlZnRcbiAgICB2YXIgcHJldmlvdXNCdXR0b24gPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvdy1wcmV2Jyk7XG4gICAgcHJldmlvdXNCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICBmbGt0eS5wcmV2aW91cygpO1xuICAgIH0pO1xuXG4gICAgLy8gYnV0dG9ucyBhY3Rpb25zIG1vdmUgLSByaWdodFxuICAgIHZhciBuZXh0QnV0dG9uID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3ctbmV4dCcpO1xuICAgIG5leHRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICBmbGt0eS5uZXh0KCk7XG4gICAgfSk7XG5cbiAgICAvLyBmbGt0eS5vbiggJ3Njcm9sbCcsIGZ1bmN0aW9uKCkge1xuICAgIC8vICAgZmxrdHkuZGVzdHJveSgpXG4gICAgLy8gICBmbGt0eSA9IG5ldyBGbGlja2l0eShwYW5lbCk7XG4gICAgLy8gfSk7XG5cbiAgICBuZXh0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICBjYXJvdXNlbC5jbGFzc0xpc3QuYWRkKCdicy1tZWRpYV9fbGlzdC0tbGluZWFyLW5leHQnKTtcblxuXG4gICAgZmxrdHkub24oJ2NlbGxTZWxlY3QnLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgIC8vIGNsYXNzIGFkZCBvciByZW1vdmUgZWZmZWN0IG92ZXIgaW4gcG9zaXRpb24gaW5pdGlhbFxuICAgICAgaWYgKCFmbGt0eS5jZWxsc1tmbGt0eS5zZWxlY3RlZEluZGV4IC0gMV0pIHtcblxuICAgICAgICBuZXh0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LmFkZCgnYnMtbWVkaWFfX2xpc3QtLWxpbmVhci1uZXh0Jyk7XG5cbiAgICAgICAgcHJldmlvdXNCdXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QucmVtb3ZlKCdicy1tZWRpYV9fbGlzdC0tbGluZWFyLXByZXYnKTtcblxuICAgICAgICAvLyBjbGFzcyBhZGQgb3IgcmVtb3ZlIGVmZmVjdCBvdmVyIGluIHBvc2l0aW9uIGZpbmFsXG4gICAgICB9IGVsc2UgaWYgKCFmbGt0eS5jZWxsc1tmbGt0eS5jZWxscy5sZW5ndGhdKSB7XG5cbiAgICAgICAgcHJldmlvdXNCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QuYWRkKCdicy1tZWRpYV9fbGlzdC0tbGluZWFyLXByZXYnKTtcblxuICAgICAgICAvLyBjbGFzcyBhZGQgb3IgcmVtb3ZlIGVmZmVjdCBvdmVyIGluIG1pZGRsZSBwb3NpdGlvbiB0byBpdGVtcyBiaWcgdGhhbiBzaWRlc1xuICAgICAgICBpZiAoZmxrdHkuc2VsZWN0ZWRJbmRleCA9PT0gKGZsa3R5LnBhZ2VEb3RzLmRvdHMubGVuZ3RoIC0gMSkpIHtcblxuICAgICAgICAgIG5leHRCdXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2JzLW1lZGlhX19saXN0LS1saW5lYXItbmV4dCcpO1xuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgcHJldmlvdXNCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgICAgIG5leHRCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuXG4gICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LmFkZCgnYnMtbWVkaWFfX2xpc3QtLWxpbmVhci1uZXh0Jyk7XG4gICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LmFkZCgnYnMtbWVkaWFfX2xpc3QtLWxpbmVhci1wcmV2Jyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuXG4gICAgLy9Fc3NlIHTvv70gZnVuY2lvbmFuZG8hISFcbiAgICB2YXIgbWVkaWFfY3VzdG9tID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnMtbWVkaWFfX2xpc3QtLWN1c3RvbScpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBtZWRpYV9jdXN0b20ubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBtZWRpYV9ib3ggPSBtZWRpYV9jdXN0b21baV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZmxpY2tpdHktc2xpZGVyJyk7XG4gICAgICBmb3IgKGogPSAwOyBqIDwgbWVkaWFfYm94Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgIHZhciBjb3VudEl0ZW0gPSBtZWRpYV9ib3hbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnMtbWVkaWFfX2l0ZW0nKTtcblxuICAgICAgICBpZiAoY291bnRJdGVtLmxlbmd0aCA8PSAyKSB7XG5cbiAgICAgICAgICBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBob25lL2kpIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQYWQvaSkgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQW5kcm9pZC9pKSkge1xuICAgICAgICAgICAgLy9Nb2JpbGVcblxuICAgICAgICAgICAgaWYgKGNvdW50SXRlbS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgY2Fyb3VzZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93cycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuICAgICAgICAgICAgICAvL2Nhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmZsaWNraXR5LXBhZ2UtZG90cycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LmFkZCgnaXMtZHJhZ2dhYmxlJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy9EZXNrdG9wXG4gICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuXG4gICAgICAgIH1cblxuXG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIG1lZGlhX2N1c3RvbVNsaWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2JzLW1lZGlhX19zbGlkZXItLW5hdicpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBtZWRpYV9jdXN0b21TbGlkZXIubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBtZWRpYV9ib3ggPSBtZWRpYV9jdXN0b21TbGlkZXJbaV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZmxpY2tpdHktc2xpZGVyJyk7XG4gICAgICBmb3IgKGogPSAwOyBqIDwgbWVkaWFfYm94Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgIHZhciBjb3VudEl0ZW0gPSBtZWRpYV9ib3hbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnMtbWVkaWFfX2l0ZW0nKTtcblxuICAgICAgICBpZiAoY291bnRJdGVtLmxlbmd0aCA8PSAyKSB7XG5cbiAgICAgICAgICBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBob25lL2kpIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQYWQvaSkgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQW5kcm9pZC9pKSkge1xuICAgICAgICAgICAgLy9Nb2JpbGVcblxuICAgICAgICAgICAgaWYgKGNvdW50SXRlbS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgY2Fyb3VzZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93cycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuICAgICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lIWltcG9ydGFudCc7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LmFkZCgnaXMtZHJhZ2dhYmxlJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy9EZXNrdG9wXG4gICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuXG4gICAgICAgIH1cblxuXG4gICAgICB9XG4gICAgfVxuXG4gICAgLypcbiAgICB2YXIgbWVkaWFfY3VzdG9tU2xpZGVyTmF2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnMtbWVkaWFfX3NsaWRlci0tbmF2Jyk7XG4gICAgZm9yIChpID0gMDsgaSA8IG1lZGlhX2N1c3RvbVNsaWRlck5hdi5sZW5ndGg7IGkrKykge1xuXG4gICAgICBjb25zb2xlLmxvZygnRVNTRSBBUVVJJylcblxuICAgICAgdmFyIG1lZGlhX2JveCA9IG1lZGlhX2N1c3RvbVNsaWRlck5hdltpXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdmbGlja2l0eS1zbGlkZXInKTtcbiAgICAgIGZvciAoaiA9IDA7IGogPCBtZWRpYV9ib3gubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgdmFyIGNvdW50SXRlbSA9IG1lZGlhX2JveFswXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdicy1tZWRpYV9faXRlbScpO1xuXG4gICAgICAgIGlmIChjb3VudEl0ZW0ubGVuZ3RoIDw9IDMpIHtcblxuICAgICAgICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGhvbmUvaSkgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBhZC9pKSB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9BbmRyb2lkL2kpKSB7XG4gICAgICAgICAgICAvL01vYmlsZVxuXG4gICAgICAgICAgICBpZiAoY291bnRJdGVtLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZHJhZ2dhYmxlJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5hZGQoJ2lzLWRyYWdnYWJsZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vRGVza3RvcFxuICAgICAgICAgICAgY2Fyb3VzZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93cycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kcmFnZ2FibGUnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kcmFnZ2FibGUnKTtcblxuICAgICAgICB9XG5cblxuICAgICAgfVxuICAgIH1cbiAgICAqL1xuXG5cbiAgICB2YXIgbWVkaWFfY3VzdG9tU2xpZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnaXMtY2FyZC1zbGlkZScpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBtZWRpYV9jdXN0b21TbGlkZXIubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBtZWRpYV9ib3ggPSBtZWRpYV9jdXN0b21TbGlkZXJbaV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZmxpY2tpdHktc2xpZGVyJyk7XG4gICAgICBmb3IgKGogPSAwOyBqIDwgbWVkaWFfYm94Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgIHZhciBjb3VudEl0ZW0gPSBtZWRpYV9ib3hbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnMtbWVkaWFfX2l0ZW0gJyk7XG4gICAgICAgIGlmIChjb3VudEl0ZW0ubGVuZ3RoIDw9IDUpIHtcbiAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1kcmFnZ2FibGUnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghY2Fyb3VzZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdpcy1kcmFnZ2FibGUnKSkge1xuICAgICAgY2Fyb3VzZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93cycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfVxuXG4gICAgdmFyIG1lZGlhX2N1c3RvbUNhcmRTbGlkZSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2JzLWNhcmQtc2xpZGVyJyk7XG4gICAgZm9yIChpID0gMDsgaSA8IG1lZGlhX2N1c3RvbUNhcmRTbGlkZS5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIG1lZGlhX2JveCA9IG1lZGlhX2N1c3RvbUNhcmRTbGlkZVtpXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdmbGlja2l0eS1zbGlkZXInKTtcbiAgICAgIGZvciAoaiA9IDA7IGogPCBtZWRpYV9ib3gubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgdmFyIGNvdW50SXRlbSA9IG1lZGlhX2JveFswXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdicy1tZWRpYV9faXRlbSAnKTtcblxuICAgICAgICBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvaVBob25lL2kpIHx8IG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL2lQYWQvaSkgfHwgbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQW5kcm9pZC9pKSkge1xuICAgICAgICAgIGlmIChjb3VudEl0ZW0ubGVuZ3RoIDw9IDQpIHtcbiAgICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgY2Fyb3VzZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtZHJhZ2dhYmxlJyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvd3MnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5hZGQoJ2lzLWRyYWdnYWJsZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoY291bnRJdGVtLmxlbmd0aCA8PSA1KSB7XG4gICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIGNhcm91c2VsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWRyYWdnYWJsZScpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYXJvdXNlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3dzJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICBjYXJvdXNlbC5jbGFzc0xpc3QuYWRkKCdpcy1kcmFnZ2FibGUnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghY2Fyb3VzZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdpcy1kcmFnZ2FibGUnKSkge1xuICAgICAgY2Fyb3VzZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93cycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfVxuXG5cbiAgfVxuXG4gIHZhciBkaXNwbGF5QnVsbGV0c0Fycm93cyA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBNT0JJTEVfVyA9IDc2NztcbiAgICBjb25zdCBUQUJMRVRfVyA9IDk5MjtcbiAgICBjb25zdCBXSU5ET1dfV0lEVEggPSB3aW5kb3cuc2NyZWVuLndpZHRoO1xuXG4gICAgbGV0IGNhcnJvdXNlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2JzLWpzLWNhcnJvdXNlbC1wcm9kJyk7XG4gICAgbGV0IG1pbl9zbGlkZTtcblxuICAgIGlmIChXSU5ET1dfV0lEVEggPD0gTU9CSUxFX1cpIHtcbiAgICAgIG1pbl9zbGlkZSA9IDE7XG4gICAgfSBlbHNlIGlmIChXSU5ET1dfV0lEVEggPD0gVEFCTEVUX1cpIHtcbiAgICAgIG1pbl9zbGlkZSA9IDJcbiAgICB9IGVsc2Uge1xuICAgICAgbWluX3NsaWRlID0gM1xuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2Fycm91c2VsLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgc2xpZGVfY291bnQgPSBjYXJyb3VzZWxbaV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW1lZGlhX19pdGVtXCIpLmxlbmd0aDtcblxuICAgICAgaWYgKHNsaWRlX2NvdW50IDw9IG1pbl9zbGlkZSkge1xuICAgICAgICBjYXJyb3VzZWxbaV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImZsaWNraXR5LXBhZ2UtZG90c1wiKVswXS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIGNhcnJvdXNlbFtpXS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnMtbWVkaWFfX2Fycm93c1wiKVswXS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYXJyb3VzZWxbaV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImZsaWNraXR5LXBhZ2UtZG90c1wiKVswXS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgICBjYXJyb3VzZWxbaV0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW1lZGlhX19hcnJvd3NcIilbMF0uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICBkaXNwbGF5QnVsbGV0c0Fycm93czogZGlzcGxheUJ1bGxldHNBcnJvd3NcbiAgfTtcbn0oKSk7XG5cbnZhciBjYXJyb3VzZWxSZXNpemUgPSAoZnVuY3Rpb24gKCkge1xuXG4gIHZhciBpbml0Q2FsYyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY2Fyb3VzZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtY2Fycm91c2VsLXByb2QgLmJzLW1lZGlhX19saXN0LS1saW5lYXInKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgY2Fyb3VzZWwubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBlbF92aWV3cG9ydCA9IGNhcm91c2VsW2ldLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJmbGlja2l0eS12aWV3cG9ydFwiKTtcblxuICAgICAgdmFyIGZsa3R5ID0gRmxpY2tpdHkuZGF0YShjYXJvdXNlbFtpXSk7XG5cbiAgICAgIGZvciAoaiA9IDA7IGogPCBlbF92aWV3cG9ydC5sZW5ndGg7IGorKykge1xuICAgICAgICB2YXIgY2FyZCA9IGVsX3ZpZXdwb3J0W2pdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1tZWRpYV9faXRlbVwiKTtcblxuICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IGNhcmQubGVuZ3RoOyB4KyspIHtcbiAgICAgICAgICB2YXIgY2FyZF9pbWcgPSBjYXJkW3hdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1tZWRpYV9fZmlndXJlXCIpXG4gICAgICAgICAgdmFyIGNhcmRfZGVzYyA9IGNhcmRbeF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW1lZGlhX190ZXh0XCIpXG5cbiAgICAgICAgICBpZiAoeCA9PSAwKSB7XG4gICAgICAgICAgICB2YXIgY2FsYyA9IGNhcmRfaW1nWzBdLmNsaWVudEhlaWdodCArIGNhcmRfZGVzY1swXS5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjYWxjIDwgY2FyZF9pbWdbMF0uY2xpZW50SGVpZ2h0ICsgY2FyZF9kZXNjWzBdLmNsaWVudEhlaWdodCkge1xuICAgICAgICAgICAgICBjYWxjID0gY2FyZF9pbWdbMF0uY2xpZW50SGVpZ2h0ICsgY2FyZF9kZXNjWzBdLmNsaWVudEhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoL1RyaWRlbnQvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcbiAgICAgICAgICBlbF92aWV3cG9ydFtqXS5zdHlsZS5taW5IZWlnaHQgPSAoY2FsYyArIDMwKSArICdweCc7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbF92aWV3cG9ydFtqXS5zdHlsZS5taW5IZWlnaHQgPSBjYWxjICsgKCdweCcpO1xuICAgICAgICB9XG4gICAgICB9XG5cblxuICAgICAgaWYgKGZsa3R5KSB7XG4gICAgICAgIGZsa3R5LnJlbG9hZENlbGxzKCk7XG4gICAgICAgIGZsa3R5LnJlc2l6ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICBpbml0Q2FsYzogaW5pdENhbGNcbiAgfTtcbn0oKSk7XG5cbnZhciBjYXJyb3VzZWxfY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWNhcnJvdXNlbC1wcm9kJyk7XG5cbmZvciAobGV0IGkgPSAwOyBpIDwgY2Fycm91c2VsX2NvbnRhaW5lci5sZW5ndGg7IGkrKykge1xuICBsZXQgbWVkaWFJdGVtID0gY2Fycm91c2VsX2NvbnRhaW5lcltpXS5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtY2Fycm91c2VsLXByb2QgLmJzLW1lZGlhX19pdGVtIC5icy1tZWRpYV9fYm94Jyk7XG5cbiAgZm9yIChsZXQgaiA9IDA7IGogPCBtZWRpYUl0ZW0ubGVuZ3RoOyBqKyspIHtcbiAgICBtZWRpYUl0ZW1bal0uY2xhc3NMaXN0LmFkZChcInNsaWRlLVwiICsgailcblxuICAgIGlmICgoaiArIDEpIC8gMyAlIDEgPT0gMCAmJiBqICsgMSA8IG1lZGlhSXRlbS5sZW5ndGgpIHtcblxuICAgICAgLy8gQXRyaWJ1aSBhIGZ1bmNpbm9hbGlkYWRlIGRlIGNsaWNhciBuYSBzZXRhIGF2YW7Dp2FyIHNlbXByZSBxdWUgbyB0YWIgZm9yIHByZXNzaW9uYWRvIG5vIHRlcmNlaXJvIGNhcmRcbiAgICAgIG1lZGlhSXRlbVtqXS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKChlLmtleSA9PT0gJ1RhYicgfHwgZS5rZXlDb2RlID09PSA5KSAmJiAhZS5zaGlmdEtleSkge1xuICAgICAgICAgIHZhciBjdXJyZW50X3NsaWRlID0gdGhpcztcbiAgICAgICAgICBsZXQgbmV4dF9zbGlkZSA9IHBhcnNlSW50KGN1cnJlbnRfc2xpZGUuY2xhc3NOYW1lLnNwbGl0KFwiIFwiKVsxXS5zcGxpdChcIi1cIilbMV0pICsgMTtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IC8vIE5lY2Vzc8OhcmlvIGZvcsOnYXIgbyBmb2NvIG5vIHByw7N4aW1vIHNsaWRlIGRldmlkbyBhIHByb2JsZW1hcyBubyBJRS5cbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGN1cnJlbnRfc2xpZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGUtXCIgKyBuZXh0X3NsaWRlKS5mb2N1cygpO1xuICAgICAgICAgIH0sIDEwMClcbiAgICAgICAgICAvLyBjYXJyb3VzZWxfY29udGFpbmVyW2ldLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3ctbmV4dCcpLmNsaWNrKCk7XG4gICAgICAgICAgY3VycmVudF9zbGlkZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19hcnJvdy1uZXh0JykuY2xpY2soKTsgLy8gcmVxdWlyZWQgdG8gYmUgbGlrZSB0aGlzIHRvIHdvcmsgb24gSUVcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgaWYgKGogKyAxIDwgbWVkaWFJdGVtLmxlbmd0aCkge1xuXG4gICAgICAgIC8vIEF0cmlidWkgYSBmdW5jaW5vYWxpZGFkZSBkZSBjbGljYXIgbmEgc2V0YSB2b2x0YXIgc2VtcHJlIHF1ZSBvIHRhYiArIHNoaWZ0IGZvcmVtIHByZXNzaW9uYWRvcyBubyBwcmltZWlybyBjYXJkIGRlIGNhZGEgc2xpZGUgc2VxdWVudGVcbiAgICAgICAgbWVkaWFJdGVtW2ogKyAxXS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBpZiAoZS53aGljaCA9PT0gOSAmJiBlLnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAvLyBjYXJyb3VzZWxfY29udGFpbmVyW2ldLnF1ZXJ5U2VsZWN0b3IoJy5icy1tZWRpYV9fYXJyb3ctcHJldicpLmNsaWNrKCk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtbWVkaWFfX2Fycm93LXByZXYnKS5jbGljaygpOyAvLyByZXF1aXJlZCB0byBiZSBsaWtlIHRoaXMgdG8gd29yayBvbiBJRVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBJbml0IE1lbnUgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IE1lbnUuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLW1lZGlhX19zbGlkZXInKSkge1xuICAgIC8vIHZhciBpc01vYmlsZSA9IC9pUGhvbmV8aVBvZHxBbmRyb2lkL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcbiAgICBCc01lZGlhU2xpZGVyUmVmLmluaXQoKTtcblxuICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGNhcnJvdXNlbFJlc2l6ZS5pbml0Q2FsYygpO1xuICAgICAgQnNNZWRpYVNsaWRlclJlZi5kaXNwbGF5QnVsbGV0c0Fycm93cygpO1xuICAgIH0sIDIwMDApO1xuICB9XG59KTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgZnVuY3Rpb24gKCkge1xuICBCc01lZGlhU2xpZGVyUmVmLmRpc3BsYXlCdWxsZXRzQXJyb3dzKCk7XG59KTtcbiIsIi8qKlxuICogTWVudVxuICogQHJldHVybiBNb2R1bGUgY29uZmlnXG4gKi9cbnZhciBNZW51ID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gQ2xhc3MgTW9kaWZpZXJzXG4gIHZhciBtb2RDbGFzcyA9IHtcbiAgICBvdmVyZmxvd0hpZGRlbjogJ2JzLW92ZXJmbG93LS1oaWRkZW4nLFxuICAgIGhhbWJ1cmdlckFjdGl2ZTogJ2JzLWhlYWRlcl9fbmF2LXRvZ2dsZS0tb3BlbicsXG4gICAgbWVudUFjdGl2ZTogJ2JzLW1lbnUtLW9wZW4nLFxuICAgIG1lbnVJdGVtSGFzQ2hpbGQ6ICdicy1tZW51X19pdGVtLS1oYXMtY2hpbGQnLFxuICAgIG1lbnVJdGVtT3BlbjogJ2JzLW1lbnVfX2l0ZW0tLW9wZW4nLFxuICAgIG1lbnVMaXN0T3BlbjogJ2JzLW1lbnVfX3N1Ymxpc3QtLW9wZW4nLFxuICAgIG92ZXJsYXlCZzogJ2JzLW92ZXJsYXktLW5hdicsXG4gICAgdmlzaWJsZTogJ2JzLWlzLXZpc2libGUnLFxuICB9O1xuXG4gIC8vIERPTSBFbGVtZW50c1xuICB2YXIgZWwgPSB7XG4gICAgYm9keTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLFxuICAgIGNsb3NlTWVudTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWNsb3NlLW1lbnUnKSxcbiAgICBjdXJyZW50TWVudTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLW1lbnVfX3N1Ymxpc3QtLWN1cnJlbnQnKSxcbiAgICBzdWJsaXN0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtbWVudV9fc3VibGlzdCcpLFxuICAgIC8vIHRydWUgPSB2b2x0YW5kb1xuICAgIC8vIGZhbHNlID0gcHLDs3hpbW8gbWVudVxuICAgIGRpcmVjdGlvbjogJycsXG4gICAgbmV4dE1lbnU6ICcnLFxuICAgIGhhbWJ1cmdlcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWhlYWRlcl9fbmF2LXRvZ2dsZScpLFxuICAgIG1lbnU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1tZW51JyksXG4gICAgbWVudUJ1dHRvbnM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1tZW51LWl0ZW0nKSxcbiAgICBvdmVybGF5OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtb3ZlcmxheScpLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIFRvZ2dsZSBtZW51XG4gICAgaWYgKGVsLmhhbWJ1cmdlcikge1xuICAgICAgZWwuaGFtYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgX29wZW5NZW51KTtcbiAgICB9XG5cbiAgICAvLyBFeHBhbmQgc3VibGlzdHMgaW5zaWRlIG1haW4gTWVudVxuICAgIGlmIChlbC5tZW51QnV0dG9ucykge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChlbC5tZW51QnV0dG9ucywgZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgIHZhciBjdXJyZW50TWVudSA9IGdldFBhcmVudHMoZWxlbWVudCwgJ2pzLW1lbnUnLCB0cnVlKVswXTtcbiAgICAgICAgICB2YXIgZGlyZWN0aW9uID0gZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2JzLW1lbnVfX2JhY2snKTtcbiAgICAgICAgICB2YXIgcGFyZW50ID0gZWxlbWVudC5jbG9zZXN0KCcuYnMtbWVudV9faXRlbScpO1xuICAgICAgICAgIHZhciBuZXh0TWVudTtcblxuICAgICAgICAgIGlmIChkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIC8vIGdldCBwcmV2aW91cyBtZW51IChwYXJlbnQgbWVudSlcbiAgICAgICAgICAgIG5leHRNZW51ID0gZ2V0UGFyZW50cyhlbGVtZW50LCAnanMtbWVudScpWzFdO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5uZXh0RWxlbWVudFNpYmxpbmcpIHtcbiAgICAgICAgICAgIC8vIG9yIGdldCB0aGUgc3VibWVudVxuICAgICAgICAgICAgbmV4dE1lbnUgPSBlbGVtZW50Lm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZml4IHdoZW4gd2VibGlicmFzIGlzIGFjdGl2ZVxuICAgICAgICAgICAgbmV4dE1lbnUgPSBwYXJlbnQucXVlcnlTZWxlY3RvcignLmpzLW1lbnUnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBjaGVjayBpZiB0aGVyZSdzIGEgc3VibWVudSBmb3IgdGhpcyBpdGVtXG4gICAgICAgICAgaWYgKG5leHRNZW51KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgY3VycmVudE1lbnUuc2Nyb2xsVG9wID0gMDtcblxuICAgICAgICAgICAgLy8gb3BlbiBpdFxuICAgICAgICAgICAgX3VwZGF0ZVBvc2l0aW9ucyhjdXJyZW50TWVudSwgbmV4dE1lbnUsIGRpcmVjdGlvbik7XG4gICAgICAgICAgICBfb3BlblN1Yk1lbnUoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gYWRkIGNsYXNzIGN1cnJlbnRcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2xvc2UgbWVudSBvbiBlc2Mga2V5IHByZXNzXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKGVsLm1lbnUuY2xhc3NMaXN0LmNvbnRhaW5zKG1vZENsYXNzLm1lbnVBY3RpdmUpKSBpZiAoZS5rZXlDb2RlID09PSAyNykgX2Nsb3NlTWVudSgpO1xuICAgIH0pO1xuXG4gICAgLy8gQ2xvc2UgbWVudVxuICAgIGVsLmNsb3NlTWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIF9jbG9zZU1lbnUoKTtcbiAgICB9KTtcblxuICAgIC8vIENsb3NlIG1lbnUgb24gY2xpY2sgb3V0c2lkZVxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYm9keSwgaHRtbCcpLCBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgZWwubWVudS5jbGFzc0xpc3QuY29udGFpbnMobW9kQ2xhc3MubWVudUFjdGl2ZSkgJiZcbiAgICAgICAgICAhZWwubWVudS5jb250YWlucyhldmVudC50YXJnZXQpICYmXG4gICAgICAgICAgIWVsLmhhbWJ1cmdlci5jb250YWlucyhldmVudC50YXJnZXQpKSB7XG4gICAgICAgICAgX2Nsb3NlTWVudSgpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBfc2V0TWVudVdyYXBIZWlnaHQoKTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgX3NldE1lbnVXcmFwSGVpZ2h0KCk7XG4gICAgfSk7XG5cbiAgICB2YXIgYnRuX2luY3Jlc2VfZm9udCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1qcy1pbmNyZWFzZS1mb250XCIpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidG5faW5jcmVzZV9mb250Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBidG5faW5jcmVzZV9mb250W2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgX3NldE1lbnVXcmFwSGVpZ2h0LCBmYWxzZSk7XG4gICAgfSAgIFxuICAgIFxuICAgIHZhciBidG5fZGVjcmVhc2VfZm9udCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1qcy1kZWNyZWFzZS1mb250XCIpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidG5fZGVjcmVhc2VfZm9udC5sZW5ndGg7IGkrKykge1xuICAgICAgYnRuX2RlY3JlYXNlX2ZvbnRbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBfc2V0TWVudVdyYXBIZWlnaHQsIGZhbHNlKTtcbiAgICB9ICBcblxuICB9OyBcblxuICAvLyBTZXQgbWVudSB3cmFwIGhlaWdodCBhY2NvcmRpbmcgdG8gbWVudSB0aXRsZSBoZWlnaHRcbiAgdmFyIF9zZXRNZW51V3JhcEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgd2luZG93X2hlaWdodCA9IE1hdGgubWF4KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQsIHdpbmRvdy5pbm5lckhlaWdodCB8fCAwKSAtIDYwO1xuICAgIHZhciBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJzLW1lbnVcIik7XG4gICAgXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChtZW51LCBmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHtcbiAgICAgIHZhciBtZW51X3RpdGxlID0gaXRlbS5xdWVyeVNlbGVjdG9yKFwiLmJzLW1lbnVfX3RpdGxlXCIpO1xuICAgICAgdmFyIG1lbnVfd3JhcCA9IGl0ZW0ucXVlcnlTZWxlY3RvcihcIi5icy1tZW51X193cmFwXCIpO1xuICAgICAgXG4gICAgICBtZW51X3dyYXAuc3R5bGUuaGVpZ2h0ID0gd2luZG93X2hlaWdodCAtIG1lbnVfdGl0bGUub2Zmc2V0SGVpZ2h0ICsgXCJweFwiO1xuICAgIH0pO1xuICB9XG5cbiAgdmFyIF9vcGVuU3ViTWVudSA9IGZ1bmN0aW9uICgpIHtcbiAgICBfbWVudU91dCgpO1xuICAgIF9tZW51SW4oKTtcbiAgfTtcblxuICB2YXIgX21lbnVPdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgZWwuY3VycmVudE1lbnUuY2xhc3NMaXN0LnJlbW92ZShtb2RDbGFzcy5tZW51TGlzdE9wZW4pO1xuICB9O1xuXG4gIHZhciBfbWVudUluID0gZnVuY3Rpb24gKCkge1xuICAgIGVsLm5leHRNZW51LmNsYXNzTGlzdC5hZGQobW9kQ2xhc3MubWVudUxpc3RPcGVuKTtcblxuICAgIF91cGRhdGVQb3NpdGlvbnMoZWwubmV4dE1lbnUsICcnLCBlbC5kaXJlY3Rpb24pO1xuICB9O1xuXG4gIHZhciBfdXBkYXRlUG9zaXRpb25zID0gZnVuY3Rpb24gKGN1cnJlbnRNZW51LCBuZXh0TWVudSwgZGlyZWN0aW9uKSB7XG4gICAgZWwuY3VycmVudE1lbnUgPSBjdXJyZW50TWVudTtcbiAgICBlbC5uZXh0TWVudSA9IG5leHRNZW51O1xuICAgIGVsLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbiAgfTtcblxuICB2YXIgX29wZW5NZW51ID0gZnVuY3Rpb24gKCkge1xuICAgIGVsLmhhbWJ1cmdlci5jbGFzc0xpc3QuYWRkKG1vZENsYXNzLmhhbWJ1cmdlckFjdGl2ZSk7XG4gICAgZWwubWVudS5jbGFzc0xpc3QuYWRkKG1vZENsYXNzLm1lbnVBY3RpdmUpO1xuICAgIGVsLmJvZHkuY2xhc3NMaXN0LmFkZChtb2RDbGFzcy5vdmVyZmxvd0hpZGRlbik7XG4gICAgZWwub3ZlcmxheS5jbGFzc0xpc3QuYWRkKG1vZENsYXNzLnZpc2libGUpO1xuICAgIGVsLm92ZXJsYXkuY2xhc3NMaXN0LmFkZChtb2RDbGFzcy5vdmVybGF5QmcpO1xuICB9O1xuXG4gIHZhciBfY2xvc2VNZW51ID0gZnVuY3Rpb24gKCkge1xuICAgIGVsLmhhbWJ1cmdlci5jbGFzc0xpc3QucmVtb3ZlKG1vZENsYXNzLmhhbWJ1cmdlckFjdGl2ZSk7XG4gICAgZWwubWVudS5jbGFzc0xpc3QucmVtb3ZlKG1vZENsYXNzLm1lbnVBY3RpdmUpO1xuICAgIGVsLmJvZHkuY2xhc3NMaXN0LnJlbW92ZShtb2RDbGFzcy5vdmVyZmxvd0hpZGRlbik7XG4gICAgZWwub3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKG1vZENsYXNzLnZpc2libGUpO1xuICAgIGVsLm92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZShtb2RDbGFzcy5vdmVybGF5QmcpO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChlbC5zdWJsaXN0LCBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKG1vZENsYXNzLm1lbnVMaXN0T3BlbikpIHtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKG1vZENsYXNzLm1lbnVMaXN0T3Blbik7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IE1lbnUgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IE1lbnUuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLW1lbnUnKSkge1xuICAgIE1lbnUuaW5pdCgpO1xuICB9XG59KTtcbiIsIi8qKlxuICogTWVudSBjb20gRHJvcGRvd25cbiAqL1xudmFyIEJzUXVpY2tNZW51RHJvcCA9IChmdW5jdGlvbiAoKSB7XG4gIC8vIENvbmZpZ1xuICB2YXIgY29uZmlnID0ge1xuICAgIGJ1dHRvbnM6IHtcbiAgICAgIGJhY2s6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1xdWljay1tZW51X19iYWNrJyksXG4gICAgICBpdGVtOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtcXVpY2stbWVudV9fbWVudSAuYnMtcXVpY2stbWVudV9faXRlbScpLFxuICAgICAgdHJpZ2dlck1lbnU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1xdWljay10cmlnZ2VyLW1lbnUnKSxcbiAgICB9LFxuICAgIGNsYXNzZXM6IHtcbiAgICAgIGl0ZW1TdWJtZW51T3BlbjogJ2JzLXF1aWNrLW1lbnVfX2l0ZW0tLXN1Yi1vcGVuJyxcbiAgICAgIG1lbnVPcGVuOiAnYnMtcXVpY2stbWVudV9fbWVudS0tb3BlbicsXG4gICAgICBzb3J0YWJsZTogJ2JzLXF1aWNrLW1lbnVfX21lbnUtLXNvcnRhYmxlJyxcbiAgICAgIHN1YlN1Ym1lbnVPcGVuOiAnYnMtcXVpY2stbWVudV9fbWVudS0tc3ViLW9wZW4nLFxuICAgICAgdHJpZ2dlck1lbnVBY3RpdmU6ICdicy1xdWljay1tZW51X19pdGVtLS1hY3RpdmUnLFxuICAgIH0sXG4gICAgY29udGFpbmVyOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtcXVpY2stbWVudScpLFxuICAgIG1lbnU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1xdWljay1tZW51X19tZW51JyksXG4gICAgd3JhcHBlcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLXF1aWNrLW1lbnVfX2Ryb3Bkb3duJyksXG4gICAgc29ydGFibGU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1xdWljay1tZW51X19tZW51LmJzLXF1aWNrLW1lbnVfX21lbnUtLXNvcnRhYmxlJyksXG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAvLyBSZWNhbGN1bGEgbyBwb3NpY2lvbmFtZW50byBkbyBtZW51XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBfY2FsY1N1Ym1lbnVQb3NpdGlvbigpO1xuICAgIH0sIDUwMCk7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgX2NhbGNTdWJtZW51UG9zaXRpb24oKTtcbiAgICB9KTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBfY2xvc2VBbGxNZW51cygpO1xuICAgIH0pO1xuXG4gICAgY29uZmlnLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBfY2xvc2VBbGxNZW51cygpO1xuICAgIH0pO1xuXG4gICAgX2luaXRTaGFkb3coKTtcblxuICAgIGlmIChjb25maWcuYnV0dG9ucy50cmlnZ2VyTWVudSkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuYnV0dG9ucy50cmlnZ2VyTWVudSwgZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIF9jYWxjU3VibWVudVBvc2l0aW9uKCk7XG5cbiAgICAgICAgICB2YXIgbWVudSA9IGJ1dHRvbi5xdWVyeVNlbGVjdG9yKCcuYnMtcXVpY2stbWVudV9fbWVudScpO1xuICAgICAgICAgIHZhciBpc01lbnVPcGVuID0gKG1lbnUuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5jbGFzc2VzLm1lbnVPcGVuKSkgPT09IHRydWU7XG5cbiAgICAgICAgICBpZiAoaXNNZW51T3BlbiAmJiBtZW51KSB7XG4gICAgICAgICAgICBfY2xvc2VNZW51KG1lbnUpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF9jbG9zZUFsbE1lbnVzKCk7XG4gICAgICAgICAgICBfb3Blbk1lbnUobWVudSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChjb25maWcuYnV0dG9ucy5pdGVtKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5idXR0b25zLml0ZW0sIGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgdmFyIHN1Ym1lbnUgPSBidXR0b24ucXVlcnlTZWxlY3RvcignLmJzLXF1aWNrLW1lbnVfX3N1Ym1lbnUnKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coc3VibWVudSlcblxuICAgICAgICBpZiAoc3VibWVudSkge1xuICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB2YXIgcGFyZW50TWVudSA9IGJ1dHRvbi5wYXJlbnROb2RlO1xuXG4gICAgICAgICAgICBwYXJlbnRNZW51LmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMuc3ViU3VibWVudU9wZW4pO1xuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMuaXRlbVN1Ym1lbnVPcGVuKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5idXR0b25zLmJhY2spIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmJ1dHRvbnMuYmFjaywgZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgdmFyIG1lbnVJdGVtID0gZ2V0UGFyZW50cyhidXR0b24sIGNvbmZpZy5jbGFzc2VzLml0ZW1TdWJtZW51T3BlbiwgdHJ1ZSlbMF07XG4gICAgICAgICAgdmFyIG1lbnUgPSBnZXRQYXJlbnRzKGJ1dHRvbiwgY29uZmlnLmNsYXNzZXMuc3ViU3VibWVudU9wZW4sIHRydWUpWzBdO1xuXG4gICAgICAgICAgaWYgKG1lbnVJdGVtKSB7XG4gICAgICAgICAgICBtZW51SXRlbS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLml0ZW1TdWJtZW51T3Blbik7XG4gICAgICAgICAgICBtZW51LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMuc3ViU3VibWVudU9wZW4pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLnNvcnRhYmxlKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5zb3J0YWJsZSwgZnVuY3Rpb24gKG1lbnUpIHtcbiAgICAgICAgZHJhZ3VsYShbbWVudV0sIHtcbiAgICAgICAgICBtb3ZlczogZnVuY3Rpb24gKGVsLCBzb3VyY2UsIGhhbmRsZSwgc2libGluZykge1xuICAgICAgICAgICAgcmV0dXJuICghZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdicy1xdWljay1tZW51X19mYXZvcml0ZScpKSAmJiB0cnVlO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cblxuICAgIH1cblxuICAgIC8vIEZlY2hhIG8gbWVudSBxdWFuZG8gY2xpY2FyIGZvcmEgZGVsZVxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYm9keSwgaHRtbCcpLCBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB2YXIgcGFyZW50TWVudSA9IGdldFBhcmVudChldmVudC50YXJnZXQsICdicy1xdWljay1tZW51X19kcm9wZG93bicpO1xuICAgICAgICBpZiAoIXBhcmVudE1lbnUpIHtcbiAgICAgICAgICBfY2xvc2VBbGxNZW51cygpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gQ2FsY3VsYSBhIHBvc2nDp8OjbyBlbSBxdWUgbyBzdWJtZW51IGRldmUgYWJyaXJcbiAgdmFyIF9jYWxjU3VibWVudVBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtZW51cyA9IGNvbmZpZy5tZW51O1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChtZW51cywgZnVuY3Rpb24gKG1lbnUpIHtcbiAgICAgIHZhciBsZWZ0ID0gbWVudS5wYXJlbnROb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XG4gICAgICB2YXIgdG9wID0gbWVudS5wYXJlbnROb2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbTtcblxuICAgICAgaWYgKHdpbmRvdy5pbm5lcldpZHRoID49IDU3Nikge1xuICAgICAgICBtZW51LnN0eWxlLmxlZnQgPSBsZWZ0ICsgJ3B4JztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE5vIG1vYmlsZSBvIG1lbnUgw6kgMTAwJSwgZW50w6NvIG7Do28gZGV2ZSBzZXIgc2V0YWRvIGEgcG9zacOnw6NvIGxlZnRcbiAgICAgICAgbWVudS5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnbGVmdCcpO1xuICAgICAgfVxuICAgICAgbWVudS5zdHlsZS50b3AgPSB0b3AgKyAncHgnO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBfb3Blbk1lbnUgPSBmdW5jdGlvbiAobWVudSkge1xuICAgIG1lbnUucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jbGFzc2VzLnRyaWdnZXJNZW51QWN0aXZlKTtcbiAgICBtZW51LmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMubWVudU9wZW4pO1xuICB9O1xuXG4gIHZhciBfY2xvc2VNZW51ID0gZnVuY3Rpb24gKG1lbnUpIHtcbiAgICBtZW51LnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY2xhc3Nlcy50cmlnZ2VyTWVudUFjdGl2ZSk7XG4gICAgbWVudS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLm1lbnVPcGVuKTtcbiAgfTtcblxuICB2YXIgX2Nsb3NlQWxsTWVudXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9wZW5lZE1lbnVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicgKyBjb25maWcuY2xhc3Nlcy5tZW51T3Blbik7XG4gICAgdmFyIG9wZW5lZFN1Ym1lbnVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicgKyBjb25maWcuY2xhc3Nlcy5zdWJTdWJtZW51T3Blbik7XG4gICAgdmFyIG9wZW5lZEl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicgKyBjb25maWcuY2xhc3Nlcy5pdGVtU3VibWVudU9wZW4pO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChvcGVuZWRNZW51cywgZnVuY3Rpb24gKG1lbnUpIHtcbiAgICAgIG1lbnUuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY2xhc3Nlcy5tZW51T3Blbik7XG4gICAgICBtZW51LnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY2xhc3Nlcy50cmlnZ2VyTWVudUFjdGl2ZSk7XG4gICAgfSk7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKG9wZW5lZFN1Ym1lbnVzLCBmdW5jdGlvbiAoc3VibWVudSkge1xuICAgICAgc3VibWVudS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLnN1YlN1Ym1lbnVPcGVuKTtcbiAgICB9KTtcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwob3BlbmVkSXRlbXMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMuaXRlbVN1Ym1lbnVPcGVuKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgX2luaXRTaGFkb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNoYWRvd1N0YXJ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLXF1aWNrLW1lbnVfX3NoYWRvdy0tc3RhcnQnKTtcbiAgICB2YXIgc2hhZG93RW5kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLXF1aWNrLW1lbnVfX3NoYWRvdy0tZW5kJyk7XG5cbiAgICAvKipcbiAgICAgKiBEZWZpbmUgc2UgYXMgc29tYnJhcyBkZXZlbSBlc3RhciB2aXPDrXZlaXNcbiAgICAgKiBodHRwczovL21hcmt1cy5vYmVybGVobmVyLm5ldC9ibG9nL2J1aWxkaW5nLWEtcmVzcG9uc2l2ZS1wcmlvcml0eS1wbHVzLWhvcml6b250YWwtc2Nyb2xsLW5hdmlnYXRpb24vXG4gICAgKi9cbiAgICBmdW5jdGlvbiBoYW5kbGVTaGFkb3dWaXNpYmlsaXR5KCkge1xuICAgICAgdmFyIG1heFNjcm9sbFN0YXJ0UmVhY2hlZCA9IGNvbmZpZy53cmFwcGVyLnNjcm9sbExlZnQgPD0gMDtcbiAgICAgIHZhciBtYXhTY3JvbGxFbmRSZWFjaGVkID1cbiAgICAgICAgY29uZmlnLndyYXBwZXIuc2Nyb2xsTGVmdCA+PSBjb25maWcud3JhcHBlci5zY3JvbGxXaWR0aCAtIGNvbmZpZy53cmFwcGVyLm9mZnNldFdpZHRoIC0gNTtcblxuICAgICAgdG9nZ2xlU2hhZG93KHNoYWRvd1N0YXJ0LCBtYXhTY3JvbGxTdGFydFJlYWNoZWQpO1xuICAgICAgdG9nZ2xlU2hhZG93KHNoYWRvd0VuZCwgbWF4U2Nyb2xsRW5kUmVhY2hlZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhpYmUvb2N1bHRhIGFzIHNvbWJyYXNcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsIHNvbWJyYVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gbWF4U2Nyb2xsUmVhY2hlZCBhdGluZ2l1IG8gbGltaXRlIGRvIHNjcm9sbCAoaW7DrWNpbyBvdSBmaW0pXG4gICAgKi9cbiAgICBmdW5jdGlvbiB0b2dnbGVTaGFkb3coZWwsIG1heFNjcm9sbFJlYWNoZWQpIHtcbiAgICAgIHZhciBzaGFkb3dJc1Zpc2libGUgPSBlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLXZpc2libGUnKTtcbiAgICAgIHZhciBzaG93U2hhZG93ID0gIW1heFNjcm9sbFJlYWNoZWQgJiYgIXNoYWRvd0lzVmlzaWJsZTtcbiAgICAgIHZhciBoaWRlU2hhZG93ID0gbWF4U2Nyb2xsUmVhY2hlZCAmJiBzaGFkb3dJc1Zpc2libGU7XG5cbiAgICAgIC8vIFVzaW5nIHJlcXVlc3RBbmltYXRpb25GcmFtZSBmb3Igb3B0aW1hbCBzY3JvbGwgcGVyZm9ybWFuY2UuXG4gICAgICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNDQ3NzkzMTZcbiAgICAgIGlmIChzaG93U2hhZG93KSB7XG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkgeyBlbC5jbGFzc0xpc3QuYWRkKCdpcy12aXNpYmxlJyk7IH0pO1xuICAgICAgfSBlbHNlIGlmIChoaWRlU2hhZG93KSB7XG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkgeyBlbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy12aXNpYmxlJyk7IH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbmZpZy53cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGhhbmRsZVNoYWRvd1Zpc2liaWxpdHkoKTtcbiAgICB9KTtcblxuICAgIGhhbmRsZVNoYWRvd1Zpc2liaWxpdHkoKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgTWVudSBjb20gRHJvcGRvd25cbiAqIEByZXR1cm4ge3ZvaWR9IEJzTWQuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXF1aWNrLW1lbnVfX2Ryb3Bkb3duJykubGVuZ3RoKSB7XG4gICAgQnNRdWlja01lbnVEcm9wLmluaXQoKTtcbiAgfVxufSk7XG4iLCIvKipcbiAqIEJzIE1vZGFsXG4gKlxuICogUmVmZXJlbmNlOlxuICpcbiAqIFtUT0RPXTogUmVmYXRvcmFyIHBhcmEgcXVlIG9zIGVsZW1lbnRvcyBkbyBjb25maWcgcmVmZXJlbmNpZW1cbiAqIHVtIG1vZGFsIGVzcGVjw61maWNvIGFvIGludsOpcyBkZSBwZWdhciB0b2RvcyBvcyBleGlzdGVudGVzIG5vIGRvY3VtZW50by5cbiAqL1xudmFyIEJzTW9kYWwgPSAoZnVuY3Rpb24gKCkge1xuICAvLyBDb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBhbGxOb2RlczogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnKicpLFxuICAgIGJvZHk6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKSxcbiAgICBhbmNob3JzOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdhJyksXG4gICAgY3VycmVudFpJbmRleDogNDAwLFxuICAgIGxhc3RGb2N1czogW10sXG4gICAgbGFzdE9wZW5lZE1vZGFsczogW10sXG4gICAgbW9kYWw6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1tb2RhbCcpLFxuICAgIG1vZGFsTWFpbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLW1haW4nKSxcbiAgICBtb2RhbEFjdGl2ZUNsYXNzOiAnYnMtbW9kYWwtLW9wZW4nLFxuICAgIG1vZGFsQ2xvc2U6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1jbG9zZS1tb2RhbCcpLFxuICAgIG1vZGFsQ2xvc2VBbGw6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1jbG9zZS1hbGwtbW9kYWxzJyksXG4gICAgbW9kYWxPcGVuOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtb3Blbi1tb2RhbCcpLFxuICAgIG1vZGFsT3BlbkFuZENsb3NlOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtb3Blbi1jbG9zZS1tb2RhbCcpLFxuICAgIG1vZGFsT3BlbmVkUGFnZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLW9wZW5lZCcpLFxuICAgIG92ZXJmbG93SGlkZGVuOiAnYnMtb3ZlcmZsb3ctLWhpZGRlbicsXG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gQ2xvc2UgbW9kYWwgb24gY2xpY2sgb3V0c2lkZVxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYm9keSwgaHRtbCcpLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBtb2RhbEFjdGl2ZSA9IGlzTW9kYWxBY3RpdmUoKTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIG1vZGFsQWN0aXZlICYmXG4gICAgICAgICAgbW9kYWxBY3RpdmUuY29udGFpbnMoZXZlbnQudGFyZ2V0KSAmJlxuICAgICAgICAgICFtb2RhbEFjdGl2ZS5xdWVyeVNlbGVjdG9yKCcuYnMtbW9kYWxfX2NvbnRhaW5lcicpLmNvbnRhaW5zKGV2ZW50LnRhcmdldClcbiAgICAgICAgKSB7XG4gICAgICAgICAgY2xvc2VNb2RhbCgpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBPcGVuIG1vZGFsIG9uIGNsaWNrXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcubW9kYWxPcGVuLCBmdW5jdGlvbiAob3BlbmVyKSB7XG4gICAgICBpZiAob3BlbmVyLnRhZ05hbWUgPT09ICdGT1JNJykge1xuICAgICAgICBvcGVuRXZlbnQgPSBvcGVuZXIuZ2V0QXR0cmlidXRlKCdkYXRhLXZhbGlkYXRlLWNhbGxiYWNrJykgPyAnZm9ybUlzVmFsaWQnIDogJ3N1Ym1pdCc7XG4gICAgICAgIG9wZW5lci5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAgIG9wZW5FdmVudCxcbiAgICAgICAgICBvcGVuTW9kYWwuYmluZChudWxsLCBvcGVuZXIpXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvcGVuZXIuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAnY2xpY2snLFxuICAgICAgICAgIG9wZW5Nb2RhbC5iaW5kKG51bGwsIG9wZW5lcilcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIE9wZW4gbW9kYWwgZnJvbSBhbmNob3IgaHJlZlxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmFuY2hvcnMsIGZ1bmN0aW9uIChhbmNob3IpIHtcbiAgICAgIHZhciBoYXNoID0gZ2V0SGFzaEFzSWRGcm9tVXJsU3RyaW5nKGFuY2hvci5ocmVmKTtcbiAgICAgIGlmIChoYXNoLmxlbmd0aCA+IDEpIGFuY2hvci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5Nb2RhbC5iaW5kKG51bGwsIGhhc2gpKTtcbiAgICB9KTtcblxuICAgIC8vIE9wZW4gbW9kYWwgb24gcGFnZSBsb2FkXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgaGFzaCA9IGdldEhhc2hBc0lkRnJvbVVybFN0cmluZyh3aW5kb3cubG9jYXRpb24uaGFzaCk7XG4gICAgICBpZiAoaGFzaC5sZW5ndGggPiAxKSBvcGVuTW9kYWwoaGFzaCk7XG4gICAgfSk7XG5cbiAgICAvLyBPcGVuIG1vZGFsIG9uIGhhc2hjaGFuZ2VcbiAgICAvLyBEZXByZWNhdGVkOlxuICAgIC8vICAgLSBub3Qgb3BlbiB3aGVuIHBhZ2UgbG9hZHNcbiAgICAvLyAgIC0gbm90IGZpcmVzIHdoZW4gdGhlIGhhc2ggaXMgdGhlIHNhbWVcbiAgICAvLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIG9wZW5Nb2RhbC5iaW5kKG51bGwsIHdpbmRvdy5sb2NhdGlvbi5oYXNoKSk7XG5cbiAgICAvLyBDbG9zZSBtb2RhbCBvbiBjbGlja1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLm1vZGFsQ2xvc2UsIGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBjbG9zZU1vZGFsKGVsZW1lbnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBDbG9zZSB0aGUgY3VycmVudCBtb2RhbCBhbmQgb3BlbnMgYW5vdGhlclxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLm1vZGFsT3BlbkFuZENsb3NlLCBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2xvc2VNb2RhbCgpO1xuICAgICAgICBvcGVuTW9kYWwoZWxlbWVudCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIENsb3NlIGFsbCBtb2RhbHNcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5tb2RhbENsb3NlQWxsLCBmdW5jdGlvbiAoY2xvc2VNb2RhbCkge1xuICAgICAgY2xvc2VNb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2xvc2VBbGxNb2RhbHMoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gUmVzdHJpbmdlIGZvY28gbm8gZWxlbWVudG8gZG8gbW9kYWxcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5hbGxOb2RlcywgZnVuY3Rpb24gKG5vZGVJdGVtKSB7XG4gICAgICBub2RlSXRlbS5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIGZvY3VzUmVzdHJpY3QpO1xuICAgIH0pO1xuXG4gICAgLy8gQ2xvc2UgbW9kYWwgb24gZXNjIGtleSBwcmVzc1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBpZiAoaXNNb2RhbEFjdGl2ZSgpKSBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMjcpIGNsb3NlTW9kYWwoKTtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogT3BlbiBNb2RhbFxuICAgKiBAcGFyYW0gIHtPYmplY3R9IG9wZW5FbGVtZW50ICBtb2RhbCBlbGVtZW50XG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICB2YXIgb3Blbk1vZGFsID0gZnVuY3Rpb24gKG9wZW5FbGVtZW50KSB7XG4gICAgdmFyIG1vZGFsID0gZ2V0TW9kYWwob3BlbkVsZW1lbnQpO1xuXG4gICAgLy8gQXR1YWxpemEgbyDDumx0aW1vIGJvdMOjbyBjb20gZm9jb1xuICAgIGNvbmZpZy5sYXN0Rm9jdXMucHVzaChkb2N1bWVudC5hY3RpdmVFbGVtZW50KTtcblxuICAgIGlmIChtb2RhbCkge1xuXG4gICAgICBpZiAoY29uZmlnLmxhc3RPcGVuZWRNb2RhbHMuaW5jbHVkZXMobW9kYWwpKSByZXR1cm47XG5cbiAgICAgIGNvbmZpZy5sYXN0T3BlbmVkTW9kYWxzLnB1c2gobW9kYWwpO1xuICAgICAgY29uZmlnLmJvZHkuY2xhc3NMaXN0LmFkZChjb25maWcub3ZlcmZsb3dIaWRkZW4pO1xuICAgICAgY29uZmlnLm1vZGFsT3BlbiA9IHRydWU7XG5cbiAgICAgIC8vIEZvY8OhdmVsLCBtYXMgcXVlIG7Do28gZGV2ZSBzZXIgbG9jYWxpemFkbyBwZWxhIG5hdmVnYcOnw6NvIHNlcXVlbmNpYWwgZG8gdGVjbGFkb1xuICAgICAgbW9kYWwuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xuICAgICAgbW9kYWwuY2xhc3NMaXN0LmFkZChjb25maWcubW9kYWxBY3RpdmVDbGFzcyk7XG4gICAgICBtb2RhbC5mb2N1cygpO1xuXG4gICAgICBtb2RhbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbW9kYWwnLCAndHJ1ZScpO1xuICAgICAgaWYgKGNvbmZpZy5tb2RhbE1haW4gIT0gbnVsbCkge1xuICAgICAgICBjb25maWcubW9kYWxNYWluLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xuICAgICAgfVxuXG4gICAgICAvLyBJbmNyZW1lbnRhIG8gei1pbmRleCBkbyBtb2RhbFxuICAgICAgc2V0WkluZGV4KG1vZGFsKTtcblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ2xvc2UgTW9kYWxcbiAgICogQHBhcmFtICB7T2JqZWN0fSBjbG9zZUVsZW1lbnQgIG1vZGFsIGVsZW1lbnRcbiAgICogQHBhcmFtICB7T2JqZWN0fSBvcHRpb25zICAgICAgIGN1c3RvbSBvcHRpb25zXG4gICAqL1xuICB2YXIgY2xvc2VNb2RhbCA9IGZ1bmN0aW9uIChjbG9zZUVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgICB2YXIgbW9kYWwgPSBnZXRNb2RhbChjbG9zZUVsZW1lbnQpO1xuXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zICE9PSAnb2JqZWN0Jykgb3B0aW9ucyA9IHt9O1xuXG4gICAgaWYgKG1vZGFsKSB7XG4gICAgICBpZiAobW9kYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdicy1tb2RhbC0tdW5jbG9zYWJsZScpICYmICFvcHRpb25zLmZvcmNlQ2xvc2UpIHJldHVybjtcblxuICAgICAgY29uZmlnLmxhc3RPcGVuZWRNb2RhbHMucG9wKCk7XG4gICAgICBjb25maWcubW9kYWxPcGVuID0gZmFsc2U7XG5cbiAgICAgIC8vIFBhdXNhIG9zIHbDrWRlb3MgcXVlIGVzdGVqYW0gcm9kYW5kbyBkZW50cm8gZG8gbW9kYWxcbiAgICAgIHN0b3BBbGxNb2RhbFZpZGVvcyhtb2RhbCk7XG5cbiAgICAgIC8vIEZvY8OhdmVsLCBtYXMgcXVlIG7Do28gZGV2ZSBzZXIgbG9jYWxpemFkbyBwZWxhIG5hdmVnYcOnw6NvIHNlcXVlbmNpYWwgZG8gdGVjbGFkb1xuICAgICAgbW9kYWwuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpO1xuICAgICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcubW9kYWxBY3RpdmVDbGFzcyk7XG5cbiAgICAgIG1vZGFsLnNldEF0dHJpYnV0ZSgnYXJpYS1tb2RhbCcsICdmYWxzZScpO1xuICAgICAgaWYgKGNvbmZpZy5tb2RhbE1haW4gIT0gbnVsbCkge1xuICAgICAgICBjb25maWcubW9kYWxNYWluLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAnZmFsc2UnKTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRpY2lvbmFyIG8gZm9jbyBubyBlbGVtZW50byBkbyBib3TDo28gYXNzaW0gcXVlIGVuY2VycmEgbyBtb2RhbFxuICAgICAgaWYgKGNvbmZpZy5sYXN0Rm9jdXNbY29uZmlnLmxhc3RGb2N1cy5sZW5ndGggLSAxXSkge1xuICAgICAgICBjb25maWcubGFzdEZvY3VzW2NvbmZpZy5sYXN0Rm9jdXMubGVuZ3RoIC0gMV0uZm9jdXMoKTtcbiAgICAgIH1cbiAgICAgIGNvbmZpZy5sYXN0Rm9jdXMucG9wKCk7XG5cbiAgICAgIC8vIFNlIG7Do28gaG91dmVyIG1haXMgbW9kYWlzIGF0aXZvcywgcmVtb3ZlIG8gYmxvcXVlaW8gZG8gc2Nyb2xsIGRvIGJvZHlcbiAgICAgIGlmICghaXNNb2RhbEFjdGl2ZSgpKSB7XG4gICAgICAgIGNvbmZpZy5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLm92ZXJmbG93SGlkZGVuKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENsb3NlIEFsbCBBY3RpdmUgTW9kYWxcbiAgICovXG4gIHZhciBjbG9zZUFsbE1vZGFscyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3Blbk1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgY29uZmlnLm1vZGFsQWN0aXZlQ2xhc3MpO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChvcGVuTW9kYWxzLCBmdW5jdGlvbiAobW9kYWwpIHtcbiAgICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLm1vZGFsQWN0aXZlQ2xhc3MpO1xuICAgICAgLy8gRm9jw6F2ZWwsIG1hcyBxdWUgbsOjbyBkZXZlIHNlciBsb2NhbGl6YWRvIHBlbGEgbmF2ZWdhw6fDo28gc2VxdWVuY2lhbCBkbyB0ZWNsYWRvXG4gICAgICBtb2RhbC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgICBtb2RhbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbW9kYWwnLCAnZmFsc2UnKTtcbiAgICB9KTtcblxuICAgIGlmIChjb25maWcubW9kYWxNYWluICE9IG51bGwpIHtcbiAgICAgIGNvbmZpZy5tb2RhbE1haW4uc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICdmYWxzZScpO1xuICAgIH1cblxuICAgIGNvbmZpZy5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLm92ZXJmbG93SGlkZGVuKTtcbiAgICAvLyBBZGljaW9uYXIgbyBmb3RvIG5vIGVsZW1lbnRvIGRvIGJvdMOjbyBhc3NpbSBxdWUgZW5jZXJyYSBvIG1vZGFsXG4gICAgY29uZmlnLmxhc3RGb2N1c1tjb25maWcubGFzdEZvY3VzLmxlbmd0aCAtIDFdLmZvY3VzKCk7XG4gICAgY29uZmlnLmxhc3RGb2N1cyA9IFtdO1xuICAgIGNvbmZpZy5tb2RhbE9wZW4gPSBmYWxzZTtcbiAgfTtcblxuICAvLyBGb2NvIHJlc3RyaXRvIGFvIG1vZGFsXG4gIHZhciBmb2N1c1Jlc3RyaWN0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgLy8gdmFyIGN1cnJlbnRNb2RhbCA9IGdldFBhcmVudHMoZXZlbnQudGFyZ2V0LCBjb25maWcubW9kYWxBY3RpdmVDbGFzcylbMF07XG4gICAgdmFyIGN1cnJlbnRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgY29uZmlnLm1vZGFsQWN0aXZlQ2xhc3MpO1xuXG4gICAgaWYgKGN1cnJlbnRNb2RhbCkge1xuICAgICAgaWYgKGNvbmZpZy5tb2RhbE9wZW4gJiYgIWN1cnJlbnRNb2RhbC5jb250YWlucyhldmVudC50YXJnZXQpKSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBjdXJyZW50TW9kYWwuZm9jdXMoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICBHZXQgTW9kYWxcbiAgICogQHBhcmFtICB7U3RyaW5nfE9iamVjdH0gZWxlbWVudCAgdGhlIGlkIG9mIGEgbW9kYWwgYXMgc3RyaW5nIG9yIGEgSFRNTEVsZW1lbnRcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aCBkYXRhLW1vZGFsLXRhcmdldCBvciBkYXRhLW1vZGFsLWlkXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXNcbiAgICogQHJldHVybiB7T2JqZWN0fSAgICAgICAgICAgICAgICAgdGhlIG1vZGFsIEhUTUxFbGVtZW50XG4gICAqL1xuICB2YXIgZ2V0TW9kYWwgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgIHZhciBtb2RhbDtcbiAgICB2YXIgbW9kYWxJZDtcblxuICAgIC8vIHRoZSBmdW5jdGlvbiBhY2NlcHQgYSBzdHJpbmcgd2l0aCB0aGUgSUQgb3JcbiAgICAvLyB0aGUgSFRNTEVsZW1lbnQgb2JqZWN0IG9mIHRoZSBtb2RhbFxuICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAvLyBpZiBpdCdzIGEgc3RyaW5nLCBnZXQgaXQgYXMgbW9kYWxJZFxuICAgICAgaWYgKHR5cGVvZiBlbGVtZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICBtb2RhbElkID0gZWxlbWVudDtcbiAgICAgIC8vIGlmIGl0J3Mgbm90IGEgc3RyaW5nLCBhc3N1bWUgaXQncyBhbiBlbGVtZW50XG4gICAgICAvLyBpZiB0aGUgZWxlbWVudCBoYXZlIGEgbW9kYWwncyBJRCBpbiBpdHMgZGF0YXNldCwgc2V0IGl0IHRvIG1vZGFsSWRcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1vZGFsSWQgPSAoZWxlbWVudC5kYXRhc2V0Lm1vZGFsVGFyZ2V0KSB8fCBlbGVtZW50LmRhdGFzZXQubW9kYWxJZDtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgYW4gSUQgd2FzIGZvdW5kIGluIHRoZSBwcmV2aW91cyBzdGVwXG4gICAgICBpZiAobW9kYWxJZCkge1xuICAgICAgICAvLyByZW1vdmUgYWxsIFwic3BlY2lhbCBjaGFyYWN0ZXJzXCIgKGluY2x1ZGluZyAjKVxuICAgICAgICBtb2RhbElkID0gbW9kYWxJZC5yZXBsYWNlKC9bXmEtekEtWjAtOS1fXS9nLCAnJyk7XG4gICAgICAgIC8vIHNlYXJjaCBmb3IgYSBtb2RhbCBlbGVtZW50IHdpdGggZGF0YS1tb2RhbC1pZCBvciBpZCBhdHRyaWJ1dGVzXG4gICAgICAgIC8vIHdpdGggdGhhdCBtYXRjaGVzIHRoZSBtb2RhbElkXG4gICAgICAgIG1vZGFsID0gKFxuICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1tb2RhbFtkYXRhLW1vZGFsLWlkPVwiJyArIG1vZGFsSWQgKyAnXCJdJykgfHxcbiAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtbW9kYWwjJyArIG1vZGFsSWQpXG4gICAgICAgICk7XG5cbiAgICAgIC8vIGlmIGFuIElEIHdhcyBub3QgZm91bmQgYW5kIGFzc3VtaW5nIGVsZW1lbnQgaXMgYW4gdmFsaWQgSFRNTEVsZW1lbnQsXG4gICAgICAvLyBjaGVjayBpZiBlbGVtZW50IGlzIGluc2lkZSBhIG1vZGFsIGFuZCwgaWYgdHJ1ZSwgcmV0dXJuIHRoYXQgbW9kYWxcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1vZGFsID0gZ2V0UGFyZW50cyhlbGVtZW50LCAnYnMtbW9kYWwnKVswXTtcbiAgICAgIH1cblxuICAgIC8vIGlmIGVsZW1lbnQgcGFyYW1ldGVyIGlzIG5vdCBwYXNzZWQsIHRyeSB0byBnZXQgdGhlIGxhc3Qgb3BlbmVkIG1vZGFsXG4gICAgfSBlbHNlIHtcbiAgICAgIG1vZGFsID0gY29uZmlnLmxhc3RPcGVuZWRNb2RhbHNbY29uZmlnLmxhc3RPcGVuZWRNb2RhbHMubGVuZ3RoIC0gMV07XG4gICAgfVxuXG4gICAgcmV0dXJuIG1vZGFsO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJcyBNb2RhbCBBY3RpdmVcbiAgICogQ2hlY2sgaWYgdGhlcmUncyBhIG1vZGFsIGFjdGl2ZVxuICAgKiBAcmV0dXJuIHtCb29sZWFufE9iamVjdH0gdHJ1ZSBpZiB0aGVyZSdzIGF0IGxlYXN0IG9uZSBtb2RhbCBhY3RpdmVcbiAgICovXG4gIHZhciBpc01vZGFsQWN0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtb2RhbHMgPSBjb25maWcubGFzdE9wZW5lZE1vZGFscztcbiAgICByZXR1cm4gbW9kYWxzLmxlbmd0aCAmJiBtb2RhbHNbbW9kYWxzLmxlbmd0aCAtIDFdO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTdG9wIGFsbCB2aWRlb3MgaW5zaWRlIG1vZGFsXG4gICAqIFJlbW92ZSB0aGUgdmlkZW8gZWxlbWVudCBmcm9tIG5vZGUgYW5kIGluc2VydCBpdCBhZ2Fpbi4gSXQgc3RvcHMgdGhlIHZpZGVvIVxuICAgKiBAcGFyYW0gIHtPYmplY3R9IG1vZGFsIHRoZSBwYXJlbnQgZWxlbWVudCBvZiB2aWRlbyBlbGVtZW50c1xuICAgKi9cbiAgdmFyIHN0b3BBbGxNb2RhbFZpZGVvcyA9IGZ1bmN0aW9uIChtb2RhbCkge1xuICAgIHZhciB2aWRlb3MgPSBtb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtdmlkZW8nKTtcblxuICAgIGlmICh2aWRlb3MubGVuZ3RoKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHZpZGVvcywgZnVuY3Rpb24gKHZpZGVvKSB7XG4gICAgICAgIHZhciBwbGF5ZXIgPSBCc1lUUGxheWVycy5nZXRQbGF5ZXIodmlkZW8uaWQpO1xuICAgICAgICBpZiAocGxheWVyKSB7XG4gICAgICAgICAgcGxheWVyLnN0b3BWaWRlbygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgLy8gRmF6IGNvbSBxdWUgbyDDumx0aW1vIG1vZGFsIHRlbmhhIG8gei1pbmRleCBtYWlvclxuICB2YXIgc2V0WkluZGV4ID0gZnVuY3Rpb24gKG1vZGFsKSB7XG4gICAgY29uZmlnLmN1cnJlbnRaSW5kZXggPSArK2NvbmZpZy5jdXJyZW50WkluZGV4O1xuICAgIG1vZGFsLnN0eWxlLnpJbmRleCA9IGNvbmZpZy5jdXJyZW50WkluZGV4O1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICBvcGVuOiBvcGVuTW9kYWwsXG4gICAgY2xvc2U6IGNsb3NlTW9kYWwsXG4gICAgcmVzdHJpY3Q6IGZvY3VzUmVzdHJpY3QsXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgTW9kYWwgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtbW9kYWwnKS5sZW5ndGgpIHtcbiAgICBCc01vZGFsLmluaXQoKTtcbiAgfVxuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLW9wZW5lZCcpKSB7XG4gICAgQnNNb2RhbC5vcGVuKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1vcGVuZWQnKSk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBCcyBBbGVydFxuICogQSB2YXJpYXRpb24gb2YgbW9kYWwgZm9yIGFsZXJ0ZGlhbG9nXG4gKlxuICogQHVzZVxuICogICBCc0FsZXJ0KHtcbiAqICAgICBpZDogJ3VuaXF1ZUlEJyxcbiAqICAgICB0eXBlOiAnc3VjY2Vzcy9lcnJvci93YXJuaW5nL2luZm8vcXVlc3Rpb24vbG9hZGluZycsXG4gKiAgICAgdGl0bGU6ICdUaXRsZSBvZiBhbGVydCcsXG4gKiAgICAgY29udGVudDogJ0Rlc2NyaXB0aW9uIG9yIEhUTUwgZm9yIHRoZSBjb250ZW50JyxcbiAqICAgICBidXR0b25MYWJlbDogJ3RleHQgb2YgdGhlIGJ1dHRvbicsXG4gKiAgIH0pXG4gKlxuICovXG52YXIgQnNBbGVydCA9IChmdW5jdGlvbiAoKSB7XG4gIC8qKlxuICAgKiBHZW5lcmFsIGNvbmZpZ1xuICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgKi9cbiAgdmFyIGNvbmZpZyA9IHt9O1xuXG4gIC8qKlxuICAgKiBTZXQgQ29uZmlnXG4gICAqIEBwYXJhbSAge09iamVjdH0gb3B0aW9ucyBDdXN0b20gb3B0aW9uc1xuICAgKiBAcmV0dXJuIHtPYmplY3R9ICAgICAgICAgRGVmYXVsdCBvcHRpb25zIGV4dGVuZCBieSBjdXN0b21cbiAgICovXG4gIHZhciBzZXRDb25maWcgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgIHJldHVybiBleHRlbmQoe1xuICAgICAgaWQ6ICcnLFxuICAgICAgdHlwZTogJycsXG4gICAgICB0aXRsZTogJycsXG4gICAgICBjb250ZW50OiAnJyxcbiAgICAgIGZvb3RlcjogJycsXG4gICAgICBidXR0b25MYWJlbDogJycsXG4gICAgICBzaG93Q2xvc2VCdXR0b246IGZhbHNlLFxuICAgICAgdW5jbG9zYWJsZTogZmFsc2UsXG4gICAgfSwgb3B0aW9ucywge1xuICAgICAgbW9kYWxBY3RpdmU6IGNvbmZpZy5tb2RhbEFjdGl2ZSB8fCB7fSxcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogQ3J5cHRvIFZhbHVlXG4gICAqIEdlcmFkb3IgY3JpcHRvZ3LDoWZpY28gZGUgbsO6bWVyb3MgYWxlYXTDs3Jpb3NcbiAgICpcbiAgICogQGluZm8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvcHQtQlIvZG9jcy9XZWIvQVBJL1dpbmRvdy9jcnlwdG9cbiAgICogQHJldHVybiB7U3RyaW5nfSBhIHJhbmRvbSB2YWx1ZVxuICAgKi9cbiAgdmFyIGNyeXB0b1ZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBjcnlwdG9PYmogPSB3aW5kb3cuY3J5cHRvIHx8IHdpbmRvdy5tc0NyeXB0bzsgLy8gZm9yIElFIDExXG4gICAgcmV0dXJuIChjcnlwdG9PYmouZ2V0UmFuZG9tVmFsdWVzKG5ldyBVaW50MzJBcnJheSgxKSlbMF0pLnRvU3RyaW5nKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNob3cgQWxlcnRcbiAgICogQHBhcmFtICB7T2JqZWN0fSBvcHRpb25zIG9iamVjdCBvZiBvcHRpb25zXG4gICAqL1xuICB2YXIgc2hvdyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgdmFyIG1vZGFsQ29uZmlnID0gc2V0Q29uZmlnKG9wdGlvbnMpO1xuICAgIHZhciBtb2RhbEV4aXN0ID0gbW9kYWxDb25maWcuaWQgPT09IG1vZGFsQ29uZmlnLm1vZGFsQWN0aXZlLmlkO1xuICAgIGNvbmZpZyA9IG1vZGFsQ29uZmlnO1xuXG4gICAgaWYgKG1vZGFsRXhpc3QpIHtcbiAgICAgIHVwZGF0ZU1vZGFsQ29udGVudCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBhcHBlbmQgYWxlcnQgbW9kYWwgdG8gYm9keVxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChidWlsZE1vZGFsKCkpO1xuICAgIH1cblxuICAgIC8vIHRoZSB0aW1lb3V0IGlzIG5lY2Vzc2FyeSB0byBhdm9pZCBwcm9ibGVtcyB3aXRoIG1vZGFsJ3MgZGVmYXVsdFxuICAgIC8vIGFuaW1hdGlvbiB0aGF0IGRvbid0IHJ1biBvbiBmaXJzdCBjYWxsIG9mIEJzQWxlcnQoKSBvbiBjaHJvbWVcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIG9wZW4gYWxlcnQgbW9kYWxcbiAgICAgIEJzTW9kYWwub3Blbihjb25maWcuaWQpO1xuICAgIH0sIDEwMCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEJ1aWxkIE1vZGFsXG4gICAqIENyZWF0ZSB0aGUgbW9kYWwgZWxlbWVudCB3aXRoIGZ1bGwgc3RydWN0dXJlLCBjb25maWcgYW5kIGNvbnRlbnRcbiAgICogQHJldHVybiB7SFRNTEVsZW1lbnR9IHRoZSBtb2RhbCBlbGVtZW50XG4gICAqL1xuICB2YXIgYnVpbGRNb2RhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbW9kYWxSZWFsSWQgPSAoY29uZmlnLmlkIHx8IGNyeXB0b1ZhbHVlKCkpO1xuICAgIHZhciBtb2RhbElkID0gJ2FsZXJ0bW9kYWwtLScgKyBtb2RhbFJlYWxJZDtcbiAgICB2YXIgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB2YXIgbW9kYWxDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB2YXIgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaGVhZGVyJyk7XG4gICAgdmFyIGJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB2YXIgZm9vdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9vdGVyJyk7XG4gICAgdmFyIHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3Ryb25nJyk7XG4gICAgdmFyIGNsb3NlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgdmFyIGFsZXJ0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgdmFyIGNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblxuICAgIC8vIFNldCB0aGUgSUQgb2YgbW9kYWwgb24gY29uZmlnXG4gICAgY29uZmlnLmlkID0gbW9kYWxJZDtcblxuICAgIC8vIFJlbW92ZSBhY3RpdmUgbW9kYWwgYW5kIHNldCBjdXJyZW50IGFzIGFjdGl2ZVxuICAgIGlmIChjb25maWcubW9kYWxBY3RpdmUubW9kYWwpIGNvbmZpZy5tb2RhbEFjdGl2ZS5tb2RhbC5yZW1vdmUoKTtcbiAgICBjb25maWcubW9kYWxBY3RpdmUubW9kYWwgPSBtb2RhbDtcblxuICAgIC8vIFNldCBtb2RhbCBlbGVtZW50IGNvbmZpZ1xuICAgIG1vZGFsLmlkID0gbW9kYWxJZDtcbiAgICBtb2RhbC5yb2xlID0gJ2FsZXJ0ZGlhbG9nJztcbiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKCdicy1tb2RhbCcpO1xuICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ2JzLW1vZGFsLS1vdmVybGF5LWRhcmsnKTtcbiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKCdicy1tb2RhbC0tYWxlcnQnKTtcbiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKCdicy1hbGVydCcpO1xuICAgIG1vZGFsLnNldEF0dHJpYnV0ZSgnZGF0YS1tb2RhbC1pZCcsIG1vZGFsUmVhbElkKTtcbiAgICBtb2RhbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtYWxlcnQtdHlwZScsIGNvbmZpZy50eXBlKTtcbiAgICBtb2RhbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScsICdhbGVydG1vZGFsLWhlYWRpbmctLScgKyBtb2RhbElkKTtcbiAgICBtb2RhbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGVzY3JpYmVkYnknLCAnYWxlcnRtb2RhbC10ZXh0LS0nICsgbW9kYWxJZCk7XG4gICAgY29uZmlnLm1vZGFsQWN0aXZlLm1vZGFsID0gbW9kYWw7XG4gICAgY29uZmlnLm1vZGFsQWN0aXZlLmlkID0gbW9kYWxSZWFsSWQ7XG5cbiAgICAvLyBhZGQgbW9kYWwncyB1bmNsb3NhYmxlIGNsYXNzXG4gICAgaWYgKGNvbmZpZy51bmNsb3NhYmxlKSBtb2RhbC5jbGFzc0xpc3QuYWRkKCdicy1tb2RhbC0tdW5jbG9zYWJsZScpO1xuXG4gICAgLy8gU2V0IG1vZGFsJ3MgY29udGFpbmVyIGNvbmZpZ1xuICAgIG1vZGFsQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2JzLW1vZGFsX19jb250YWluZXInKTtcblxuICAgIC8vIFNldCBtb2RhbCdzIGhlYWRlciBjb25maWdcbiAgICBoZWFkZXIuY2xhc3NMaXN0LmFkZCgnYnMtbW9kYWxfX2hlYWRlcicpO1xuICAgIGhlYWRlci5pbm5lckhUTUwgPSAnPHNwYW4gY2xhc3M9XCJicy1hbGVydF9faWNvblwiPjwvc3Bhbj4nO1xuXG4gICAgLy8gU2V0IG1vZGFsJ3MgZm9vdGVyIGNvbmZpZyBhbmQgY29udGVudFxuICAgIGZvb3Rlci5jbGFzc0xpc3QuYWRkKCdicy1tb2RhbF9fZm9vdGVyJyk7XG4gICAgZm9vdGVyLmlubmVySFRNTCA9IGNvbmZpZy5mb290ZXI7XG4gICAgY29uZmlnLm1vZGFsQWN0aXZlLmZvb3RlciA9IGZvb3RlcjtcblxuICAgIC8vIFNldCBtb2RhbCdzIGJvZHkgY29uZmlnXG4gICAgYm9keS50YWJJbmRleCA9IDA7XG4gICAgYm9keS5jbGFzc0xpc3QuYWRkKCdicy1tb2RhbF9fYm9keScpO1xuXG4gICAgLy8gU2V0IGFsZXJ0J3MgdGl0bGUgY29uZmlnIGFuZCBjb250ZW50XG4gICAgdGl0bGUuaWQgPSAnYWxlcnRtb2RhbC1oZWFkaW5nLS0nICsgbW9kYWxJZDtcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCdicy1hbGVydF9fdGl0bGUnKTtcbiAgICB0aXRsZS5pbm5lckhUTUwgPSBjb25maWcudGl0bGU7XG4gICAgY29uZmlnLm1vZGFsQWN0aXZlLnRpdGxlID0gdGl0bGU7XG5cbiAgICAvLyBTZXQgYWxlcnQncyB0aXRsZSBjb25maWcgYW5kIGNvbnRlbnRcbiAgICBjb250ZW50LmlkID0gJ2FsZXJ0bW9kYWwtdGV4dC0tJyArIG1vZGFsSWQ7XG4gICAgY29udGVudC5jbGFzc0xpc3QuYWRkKCdicy1hbGVydF9fY29udGVudCcpO1xuICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gY29uZmlnLmNvbnRlbnQ7XG4gICAgY29uZmlnLm1vZGFsQWN0aXZlLmNvbnRlbnQgPSBjb250ZW50O1xuXG4gICAgY2xvc2VCdXR0b24udGl0bGUgPSAnRmVjaGFyJztcbiAgICBjbG9zZUJ1dHRvbi50eXBlID0gJ2J1dHRvbic7XG4gICAgY2xvc2VCdXR0b24uY2xhc3NMaXN0LmFkZCgnYnMtbW9kYWxfX2Nsb3NlLWJ0bicpO1xuICAgIGNsb3NlQnV0dG9uLmlubmVySFRNTCA9ICc8aSBjbGFzcz1cImljb24tbmF2LWZlY2hhclwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4nO1xuICAgIGNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgQnNNb2RhbC5jbG9zZShjb25maWcuaWQpKTtcblxuICAgIGFsZXJ0QnV0dG9uLnR5cGUgPSAnYnV0dG9uJztcbiAgICBhbGVydEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdicy1idXR0b24nLCAnYnMtYWxlcnRfX2J1dHRvbicpO1xuICAgIGFsZXJ0QnV0dG9uLmlubmVySFRNTCA9IGNvbmZpZy5idXR0b25MYWJlbDtcbiAgICBhbGVydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIEJzTW9kYWwuY2xvc2UoY29uZmlnLmlkKTtcbiAgICB9KTtcbiAgICBjb25maWcubW9kYWxBY3RpdmUuYnV0dG9uID0gYWxlcnRCdXR0b247XG5cbiAgICAvLyBhcHBlbmQgbW9kYWwgZWxlbWVudHNcbiAgICBtb2RhbC5hcHBlbmRDaGlsZChtb2RhbENvbnRhaW5lcik7XG4gICAgbW9kYWxDb250YWluZXIuYXBwZW5kQ2hpbGQoaGVhZGVyKTtcbiAgICBtb2RhbENvbnRhaW5lci5hcHBlbmRDaGlsZChib2R5KTtcbiAgICBtb2RhbENvbnRhaW5lci5hcHBlbmRDaGlsZChmb290ZXIpO1xuICAgIGlmIChjb25maWcuc2hvd0Nsb3NlQnV0dG9uKSBtb2RhbENvbnRhaW5lci5hcHBlbmRDaGlsZChjbG9zZUJ1dHRvbik7XG5cbiAgICAvLyBhcHBlbmQgYWxlcnQgZWxlbWVudHNcbiAgICBib2R5LmFwcGVuZENoaWxkKHRpdGxlKTtcbiAgICBib2R5LmFwcGVuZENoaWxkKGNvbnRlbnQpO1xuICAgIGJvZHkuYXBwZW5kQ2hpbGQoYWxlcnRCdXR0b24pO1xuXG4gICAgcmV0dXJuIG1vZGFsO1xuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgTW9kYWxcbiAgICogVXBkYXRlIHRoZSBjb250ZW50IG9mIGFuIGV4aXN0ZW50IG1vZGFsXG4gICAqIEByZXR1cm4ge0hUTUxFbGVtZW50fSB0aGUgdXBkYXRlZCBtb2RhbCBlbGVtZW50XG4gICAqL1xuICB2YXIgdXBkYXRlTW9kYWxDb250ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtb2RhbCA9IGNvbmZpZy5tb2RhbEFjdGl2ZS5tb2RhbDtcbiAgICB2YXIgZm9vdGVyID0gY29uZmlnLm1vZGFsQWN0aXZlLmZvb3RlcjtcbiAgICB2YXIgdGl0bGUgPSBjb25maWcubW9kYWxBY3RpdmUudGl0bGU7XG4gICAgdmFyIGNvbnRlbnQgPSBjb25maWcubW9kYWxBY3RpdmUuY29udGVudDtcbiAgICB2YXIgYnV0dG9uID0gY29uZmlnLm1vZGFsQWN0aXZlLmJ1dHRvbjtcblxuICAgIC8vIHJlbW92ZSBtb2RhbCdzIHVuY2xvc2FibGUgY2xhc3NcbiAgICBpZiAoIWNvbmZpZy51bmNsb3NhYmxlKSBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdicy1tb2RhbC0tdW5jbG9zYWJsZScpO1xuXG4gICAgZm9vdGVyLmlubmVySFRNTCA9IGNvbmZpZy5mb290ZXI7XG4gICAgdGl0bGUuaW5uZXJIVE1MID0gY29uZmlnLnRpdGxlO1xuICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gY29uZmlnLmNvbnRlbnQ7XG4gICAgYnV0dG9uLmlubmVySFRNTCA9IGNvbmZpZy5idXR0b25MYWJlbDtcblxuICAgIG1vZGFsLnNldEF0dHJpYnV0ZSgnZGF0YS1hbGVydC10eXBlJywgY29uZmlnLnR5cGUpO1xuXG4gICAgcmV0dXJuIG1vZGFsO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgc2hvdzogc2hvdyxcbiAgfTtcbn0oKSk7XG4iLCIvKipcbiAqIEJzIE1vZGFsIExpc3QgKGFuY2hvcilcbiAqL1xudmFyIEJzTW9kYWxMaXN0ID0gKGZ1bmN0aW9uICgpIHtcblxuICAvLyBjb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBjYXJvdXNlbDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLW1vZGFsLWNhcm91c2VsJyksXG4gICAgcHJldmlvdXNCdXR0b246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1tb2RhbC0tcHJldmlvdXMnKSxcbiAgICBuZXh0QnV0dG9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtbW9kYWwtLW5leHQnKSxcbiAgICBtb2RhbEFjdGl2ZUNsYXNzOiAnYnMtbW9kYWwtLW9wZW4nLFxuICAgIC8vIHNlbGVjdHM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1maWx0ZXIgc2VsZWN0JyksXG4gICAgaXRlbTogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWZpbHRlci0tbW9kYWwnKSxcbiAgICBzbGlkZXI6ICcnLFxuICB9O1xuICB2YXIgZmxrdHkgPSAnJztcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIC8vIC0gUGVyY29ycmUgQ2Fyb3NlbHMgZXhpc3RlbnRlcyBuYSBQYWdpbmEgcGFyIGFtb250YXIgbyBmbGlja2l0eVxuICAgIC8vIC0gQXRpdmEgbW9kYWwgY29ycmV0byBjb25mb3JtZSBvIGluZGV4IGRlIGNhZGEgZWxlbWVudG8gY2xpY2Fkb1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLml0ZW0sIGZ1bmN0aW9uIChlbCkge1xuICAgICAgdmFyIGJ1dHRvbiA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ2EnKTtcbiAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZpbHRlclRlc3RlID0gQnNGaWx0ZXIuZmlsdGVyKCk7XG4gICAgICAgIHZhciBmaWx0ZXJJdGVucyA9IGZpbHRlclRlc3RlLmdldEZpbHRlcmVkSXRlbUVsZW1lbnRzKCk7XG5cbiAgICAgICAgb3Blbk1vZGFsKGZpbHRlckl0ZW5zLmluZGV4T2YoZWwpKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gLSBBcGxpY2EgbXVkYW7Dp2FzIHBhcmEgYWJyaXIgbW9kYWwgbm8gZWxlbWVudG9cbiAgICB2YXIgb3Blbk1vZGFsID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAvLyBpbmRleCA9IFt2YWx1ZV0gc2VsZWN0ZWQsXG4gICAgICAvLyBpc1dyYXBwZWQgPSBbIHRydWUgPT4gw7psdGltbyBzbGlkZSBzZXLDoSBzZWxlY2lvbmFkbyBzZSBubyBwcmltZWlybyBzbGlkZS5dLCBcbiAgICAgIC8vIGlzSW5zdGFudCA9IFt0cnVlICA9PiByZW1vdmUgYW5pbWF0aW9uIG9wZW4gaW5kZXhdIGZnZlxuICAgICAgZmxrdHkuc2VsZWN0KGluZGV4LCBmYWxzZSwgdHJ1ZSk7XG4gICAgICBCc01vZGFsLm9wZW4oJyNuZXdNb2RhbCcpO1xuXG4gICAgICAvLyB2YXJzIG91dCwgZ2V0IG1vbWVudCBoZWlnaHQgYW5kIG1vZGFsIG9wZW5cbiAgICAgIHZhciBoZWlnaHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtbW9kYWwtLW9wZW4nKTtcbiAgICAgIHZhciBpdGVtU2xpZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtbW9kYWxfX2l0ZW0nKTtcbiAgICAgIHZhciBoZWlnaHRXaW5kb3cgPSAxMDA7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGl0ZW1TbGlkZSwgZnVuY3Rpb24gKGVsZW0pIHtcblxuICAgICAgICAvLyBjb25zdHJ1Y3QgYWZ0ZXIgc2xpZGVyIG1vdW50XG4gICAgICAgIHZhciBtb2RhbENsb3NlID0gZWxlbS5xdWVyeVNlbGVjdG9yKCcuYnMtanMtY2xvc2UtbW9kYWwnKTtcbiAgICAgICAgdmFyIG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLW1vZGFsJyk7XG4gICAgICAgIC8vIGNsb3NlIGN1c3RvbSB0byBtb2RhbCArIHNsaWRlclxuICAgICAgICBtb2RhbENsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIG1vZGFsLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcbiAgICAgICAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5tb2RhbEFjdGl2ZUNsYXNzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIG1vZGFsQm9keSA9IGVsZW0ucXVlcnlTZWxlY3RvcignLmJzLW1vZGFsX19ib2R5Jyk7XG4gICAgICAgIG1vZGFsQm9keS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuXG4gICAgICAgIHZhciBoZWlnaHRNb2RhbCA9IGhlaWdodC5jbGllbnRIZWlnaHQgLSBoZWlnaHRXaW5kb3c7XG4gICAgICAgIGVsZW0uc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0TW9kYWwgKyAncHgnO1xuICAgICAgICBlbGVtLnN0eWxlLm92ZXJmbG93ID0gJ2F1dG8nO1xuICAgICAgfSk7XG4gICAgICAvLyByZXNpemUgaGVpZ2h0IHRvIGFwcHBseSByZW5kZXIgaGVpZ2h0IGJveFxuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGhlaWdodElubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLW1vZGFsLS1vcGVuJyk7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaXRlbVNsaWRlLCBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICAgIHZhciBoZWlnaHRNb2RhbCA9IGhlaWdodElubmVyLmNsaWVudEhlaWdodCAtIGhlaWdodFdpbmRvdztcbiAgICAgICAgICBlbGVtLnN0eWxlLmhlaWdodCA9IGhlaWdodE1vZGFsICsgJ3B4JztcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGxvYWRGbGlja2l0eSA9IGZ1bmN0aW9uIChjYXJvdXNlbCwgaXRlbXMpIHtcbiAgICB2YXIgZmxpY2tpdHlPcHRpb25zID0ge1xuICAgICAgYWRhcHRpdmVIZWlnaHQ6IHRydWUsXG4gICAgICB3YXRjaENTUzogZmFsc2UsXG4gICAgfTtcbiAgICB2YXIgY2Fyb3VzZWxJdGVtcztcblxuICAgIC8vIHJlY2ViZXIgaW5kZXggZG9zIGl0ZW5zIGNvbmZvcm1lIG8gZmlsdHJvXG4gICAgaWYgKGl0ZW1zKSB7XG4gICAgICBpZiAoY29uZmlnLnNsaWRlcikgY29uZmlnLnNsaWRlci5yZW1vdmUoKTtcbiAgICAgIGNvbmZpZy5zbGlkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGNhcm91c2VsSXRlbXMgPSBjYXJvdXNlbC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtbW9kYWxfX2l0ZW0nKTtcbiAgICAgIGNhcm91c2VsLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoY29uZmlnLnNsaWRlcik7XG4gICAgfVxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY2Fyb3VzZWxJdGVtcywgZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICB2YXIgY2hpbGRJbmRleCA9IEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoY2Fyb3VzZWxJdGVtcywgY2hpbGQpO1xuICAgICAgaWYgKGl0ZW1zLmluY2x1ZGVzKGNoaWxkSW5kZXgpKSB7XG4gICAgICAgIGNvbmZpZy5zbGlkZXIuYXBwZW5kQ2hpbGQoY2hpbGQuY2xvbmVOb2RlKHRydWUpKTtcbiAgICAgIH1cbiAgICB9KVxuICAgIC8vIGRlYnVnZ2VyO1xuXG4gICAgZmxrdHkgPSBuZXcgRmxpY2tpdHkoY29uZmlnLnNsaWRlciwgZmxpY2tpdHlPcHRpb25zKTtcbiAgICB3aW5kb3cuZmxrdHkgPSBmbGt0eTtcblxuICAgIC8vIFNldCBMaW5rIHRvIHNvY2lhbCBtZWRpYVxuICAgIGZsa3R5Lm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgc2VsZWN0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaXMtc2VsZWN0ZWQnKTtcbiAgICAgIHZhciBpZCA9IHNlbGVjdGVkLmdldEF0dHJpYnV0ZSgnZGF0YS1oYXNoJyk7XG4gICAgICB3aW5kb3cubG9jYXRpb24gPSAnI3ByZXZpZXcnICsgaWQ7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICAgIGxvYWRTbGlkZXI6IGxvYWRGbGlja2l0eSxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBGaWx0ZXIgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtbW9kYWwtLWxpc3QnKS5sZW5ndGgpIHtcbiAgICBCc01vZGFsTGlzdC5pbml0KCk7XG4gIH1cbn0pXG4iLCIvKipcbiAqIEJhbm5lciBUb3BvXG4gKiBAcmV0dXJuIE1vZHVsZSBjb25maWdcbiAqL1xudmFyIEJzTW9zYWljbyA9IChmdW5jdGlvbiAoKSB7XG4gIC8qKlxuICAgKiBJbml0IGZ1bmN0aW9uXG4gICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBNb2R1bGUncyBzY29wZSBmdW5jdGlvbnNcbiAgICovXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1tb3NhaWNvLXJldmVhbCcpO1xuICAgIHZhciBsaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLW1vc2FpY29fX2xpbmsnKTtcblxuICAgIHJldmVhbChlbGVtZW50cywgbGluayk7XG4gIH07XG5cbiAgdmFyIHJldmVhbCA9IGZ1bmN0aW9uIChlbGVtZW50cywgbGluaykge1xuICAgIC8vIGh0dHBzOi8vc2Nyb2xscmV2ZWFsanMub3JnL1xuICAgIHdpbmRvdy5zciA9IFNjcm9sbFJldmVhbCgpO1xuXG4gICAgc3IucmV2ZWFsKFxuICAgICAgZWxlbWVudHMsXG4gICAgICB7XG4gICAgICAgIGR1cmF0aW9uOiAxMzM3LFxuICAgICAgICBvcmlnaW46ICdib3R0b20nLFxuICAgICAgICBzY2FsZTogMSxcbiAgICAgICAgZGlzdGFuY2U6ICc0MHB4JyxcbiAgICAgICAgcmV2ZWFsOiByZXZlYWwsXG4gICAgICB9LFxuICAgICAgMTAwXG4gICAgKTtcbiAgfTtcblxuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBIZWFkZXIgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtbW9zYWljby1yZXZlYWwnKSkge1xuICAgIEJzTW9zYWljby5pbml0KCk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBCcyBNdXJhbCAoaXNvdG9wZS9tYXNvbnJ5KVxuICovXG52YXIgQnNNdXJhbCA9IChmdW5jdGlvbiAoKSB7XG4gIC8vIENvbmZpZ1xuICB2YXIgY29uZmlnID0ge1xuICAgIG11cmFsOiBudWxsLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgZWwgPSB0eXBlb2YgZWwgPT09ICdzdHJpbmcnID8gcXVlcnlTZWxlY3RvcihlbCkgOiBlbDtcbiAgICBmaWx0ZXJNYXNvbnJ5KGVsKTtcbiAgfTtcblxuICB2YXIgZmlsdGVyTWFzb25yeSA9IGZ1bmN0aW9uIChlbCkge1xuICAgIGNvbmZpZy5saXN0ID0gbmV3IElzb3RvcGUoZWwsIHtcbiAgICAgIGxheW91dE1vZGU6ICdwYWNrZXJ5JyxcbiAgICAgIGl0ZW1TZWxlY3RvcjogY29uZmlnLml0ZW1TZWxlY3RvcixcbiAgICAgIGNvbHVtbldpZHRoOiBjb25maWcuaXRlbVNpemVyU2VsZWN0b3IsXG4gICAgICBwZXJjZW50UG9zaXRpb246IHRydWUsXG4gICAgICByb3dIZWlnaHQ6IDMyMCxcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gICAgbGlzdDogZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGNvbmZpZy5saXN0O1xuICAgIH0sXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgTXVyYWwgQ29uc3RydWN0b3JcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgdmFyIG11cmFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1tdXJhbCcpO1xuICBpZiAobXVyYWxzLmxlbmd0aCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwobXVyYWxzLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIEJzTXVyYWwuaW5pdChlbCk7XG4gICAgfSlcbiAgfVxufSk7XG4iLCIvKipcbiAqIEJzIE11cmFsIChpc290b3BlL21hc29ucnkpXG4gKi9cbnZhciBCc011cmFsID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gQ29uZmlnXG4gIHZhciBjb25maWcgPSB7XG4gICAgbXVyYWw6IG51bGwsXG4gIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoZWwpIHtcbiAgICBlbCA9IHR5cGVvZiBlbCA9PT0gJ3N0cmluZycgPyBxdWVyeVNlbGVjdG9yKGVsKSA6IGVsO1xuICAgIGZpbHRlck1hc29ucnkoZWwpO1xuICB9O1xuXG4gIHZhciBmaWx0ZXJNYXNvbnJ5ID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgY29uZmlnLmxpc3QgPSBuZXcgSXNvdG9wZShlbCwge1xuICAgICAgbGF5b3V0TW9kZTogJ3BhY2tlcnknLFxuICAgICAgaXRlbVNlbGVjdG9yOiBjb25maWcuaXRlbVNlbGVjdG9yLFxuICAgICAgY29sdW1uV2lkdGg6IGNvbmZpZy5pdGVtU2l6ZXJTZWxlY3RvcixcbiAgICAgIHBlcmNlbnRQb3NpdGlvbjogdHJ1ZSxcbiAgICAgIHJvd0hlaWdodDogMzIwLFxuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgICBsaXN0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gY29uZmlnLmxpc3Q7XG4gICAgfSxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBNdXJhbCBDb25zdHJ1Y3RvclxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgbXVyYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLW11cmFsJyk7XG4gIGlmIChtdXJhbHMubGVuZ3RoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChtdXJhbHMsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgQnNNdXJhbC5pbml0KGVsKTtcbiAgICB9KVxuICB9XG59KTtcbiIsIi8qKlxuICogQnMgUXVpY2tNZW51IChhbmNob3IpXG4gKlxuICogVE9ETzpcbiAqIDEuIEVzY29uZGVyICh0cmFuc2xhdGU6LTEwMCUpIG1lbnUgZml4byBxdWFuZG8gcGFzc2FyXG4gKiBkYSDDumx0aW1hIHNlw6fDo28gZGEgcMOhZ2luYSAoZ2VyYWxtZW50ZSwgc29icmUgbyBmb290ZXIpIGVcbiAqIHZvbHRhciBhIG1vc3RyYXIgcXVhbmRvIHN1YmlyIGEgcMOhZ2luYSBub3ZhbWVudGU7XG4gKlxuICogMi4gQ2FsY3VsYXIgYSB2ZWxvY2lkYWRlIGRvIHNtb290aCBzY3JvbGwgcmVsYXRpdm8gw6AgcG9zacOnw6NvXG4gKiBkYSBzZcOnw6NvLCBwYXJhIHF1ZSBhIGFuaW1hw6fDo28gZG8gc2Nyb2xsIGxldmUgc2VtcHJlIG9cbiAqIG1lc21vIHRlbXBvLiBFeDogbGV2YXIgbyBtZXNtbyB0ZW1wbyBwYXJhIHNjcm9sbGFyIGRhXG4gKiBzZcOnw6NvIDEgcGFyYSAyIGUgZGEgMSBwYXJhIGEgw7psdGltYS5cbiAqXG4gKiAzLiBRdWFuZG8gbyBzY3JvbGwgdmFpIGRlIGJhaXhvIHBhcmEgY2ltYSwgcG9yIGNvbnRhIGRvIEhlYWRlclxuICogZmljYXIgdmlzw612ZWwsIG8gbWVudSBhY2FiYSBmaWNhbmRvIHNvYnJlIG8gdMOtdHVsby4gUHJlY2lzYVxuICogZGVzY29udGFyIG8gdGFtYW5obyBkbyBoZWFkZXIgZGEgcG9zacOnw6NvIGFsdm8gZGEgw6JuY29yYS5cbiAqL1xudmFyIEJzUXVpY2tNZW51ID0gKGZ1bmN0aW9uKCkge1xuICAgIC8vIEVsZW1lbnRzXG4gICAgdmFyIGVsZW1lbnRzID0ge307XG4gICAgdmFyICQgPSBlbGVtZW50cztcbiAgICAkLmJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG4gICAgJC5xdWlja01lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtcXVpY2stbWVudS1hbmNob3InKTtcblxuICAgIGlmICghJC5xdWlja01lbnUpIHJldHVybjtcblxuICAgICQuZmxvYXRlciA9ICQucXVpY2tNZW51LnF1ZXJ5U2VsZWN0b3IoJy5icy1xdWljay1tZW51X193cmFwcGVyJyk7XG4gICAgJC5saXN0ID0gJC5xdWlja01lbnUucXVlcnlTZWxlY3RvcignLmJzLXF1aWNrLW1lbnVfX2xpc3QnKTtcbiAgICAkLnRvZ2dsZSA9ICQucXVpY2tNZW51LnF1ZXJ5U2VsZWN0b3IoJy5icy1xdWljay1tZW51X190b2dnbGUnKTtcbiAgICAkLml0ZW1zID0gJC5saXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1xdWljay1tZW51X19saW5rJyk7XG5cblxuICAgIC8vIENvbmZpZ1xuICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgIHF1aWNrTWVudUFjdGl2ZTogZmFsc2UsXG4gICAgICAgIHF1aWNrTWVudUFjdGl2ZUNsYXNzOiAnYnMtcXVpY2stbWVudS0tb3BlbicsXG4gICAgICAgIHF1aWNrTWVudVBpbmVkQ2xhc3M6ICdicy1xdWljay1tZW51LS1waW5lZCcsXG4gICAgICAgIGl0ZW1BY3RpdmVDbGFzczogJ2JzLXF1aWNrLW1lbnVfX2xpbmstLWFjdGl2ZScsXG4gICAgICAgIHNjcm9sbFRvcFBvc2l0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICAgICAgfSxcbiAgICAgICAgdG9wUG9zaXRpb25Ub0Zsb2F0OiAwLFxuICAgICAgICBzY3JvbGxEaXJlY3Rpb246IDAsXG4gICAgICAgIGxhc3RTY3JvbGxUb3A6IDAsXG4gICAgICAgIHNtb290aFNjcm9sbFN0ZXBzOiAyNSxcbiAgICAgICAgc2Nyb2xsQW5jaG9yR3V0dGVyOiA4MCxcbiAgICAgICAgYW5jaG9yU2VsZWN0b3I6ICdzZWN0aW9uJyxcbiAgICAgICAgbGFzdFNlbGVjdGVkQW5jaG9yOiBudWxsXG4gICAgfTtcblxuICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFRvZ2dsZSBxdWlja01lbnVcbiAgICAgICAgaWYgKCQudG9nZ2xlKSAkLnRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZVF1aWNrTWVudSk7XG5cbiAgICAgICAgLy8gQ2xvc2UgcXVpY2tNZW51IG9uIGNsaWNrIG91dHNpZGVcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdib2R5LCBodG1sJyksIGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICBxdWlja01lbnVBY3RpdmUoKSAmJlxuICAgICAgICAgICAgICAgICAgICAhJC5xdWlja01lbnUuY29udGFpbnMoZXZlbnQudGFyZ2V0KSAmJlxuICAgICAgICAgICAgICAgICAgICAhJC50b2dnbGUuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgICAgICBjbG9zZVF1aWNrTWVudSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENsb3NlIGhlYWRlciBvbiBjbGljayBvdXRzaWRlXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIC8vIEZpeGEgbyBtZW51IG5vIHRvcG8gZGEgdmlld3BvcnRcbiAgICAgICAgICAgIHNldFBpbmVkKCk7XG5cbiAgICAgICAgICAgIC8vIEV4aWJlIG8gbWVudSBhYmFpeG8gZG8gaGVhZGVyIHF1YW5kbyBlc3RlIGVzdMOhIHZpc8OtdmVsXG4gICAgICAgICAgICBpZiAoIUJzSGVhZGVyLmlzRmxvYXRpbmcoKSB8fCBCc0hlYWRlci5lbC5jbGFzc0xpc3QuY29udGFpbnMoQnNIZWFkZXIuaGVhZGVyUGlubmVkKSkge1xuICAgICAgICAgICAgICAgICQuZmxvYXRlci5zdHlsZS50b3AgPSBCc0hlYWRlci5lbC5vZmZzZXRIZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkLmZsb2F0ZXIuc3R5bGUudG9wID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQXRpdmEgbyBpdGVtIGRlIGFjb3JkbyBjb20gbyBzY3JvbGxcbiAgICAgICAgICAgIHNldEFjdGl2ZUl0ZW0oZ2V0QWN0aXZlSXRlbSgpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2xpY2sgbWVudSBhbmNob3JzXG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoJC5pdGVtcywgZnVuY3Rpb24oZWwpIHtcbiAgICAgICAgICAgIHZhciBoYXNoID0gZWwuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgLy8gUHJldmluZSBvIGNsaXF1ZSBzZSBvIGhhc2ggZm9yIHVtYSDDom5jb3JhIHbDoWxpZGFcbiAgICAgICAgICAgICAgICBpZiAodmFsaWRBbmNob3IoaGFzaCkpIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgLy8gUmV0b3JuYSBzZSBmb3IgaW52w6FsaWRhIChtYW50w6ltIG8gY2xpcXVlIHBhZHLDo28pXG4gICAgICAgICAgICAgICAgZWxzZSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAvLyBSZXRvcm5hIHNlIG7Do28gZXhpc3RlIHVtYSDDom5jb3JhIG5hIHDDoWdpbmEgKElEKSByZWZlcmVudGUgYW8gaGFzaCBkbyBpdGVtXG4gICAgICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGhhc2gpKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAvLyBDaGFtYSBhIGZ1bsOnw6NvIHBhcmEgcm9sYXIgYSBww6FnaW5hIGF0w6kgYSDDom5jb3JhXG4gICAgICAgICAgICAgICAgZ290b0FuY2hvcihlbCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZhciB0b2dnbGVRdWlja01lbnUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCFxdWlja01lbnVBY3RpdmUoKSkgb3BlblF1aWNrTWVudSgpO1xuICAgICAgICBlbHNlIGNsb3NlUXVpY2tNZW51KCk7XG4gICAgfTtcblxuICAgIHZhciBvcGVuUXVpY2tNZW51ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICQucXVpY2tNZW51LmNsYXNzTGlzdC5hZGQoY29uZmlnLnF1aWNrTWVudUFjdGl2ZUNsYXNzKTtcbiAgICB9O1xuXG4gICAgdmFyIGNsb3NlUXVpY2tNZW51ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICQucXVpY2tNZW51LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLnF1aWNrTWVudUFjdGl2ZUNsYXNzKTtcbiAgICB9O1xuXG4gICAgdmFyIHF1aWNrTWVudUFjdGl2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJC5xdWlja01lbnUuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5xdWlja01lbnVBY3RpdmVDbGFzcyk7XG4gICAgfTtcblxuICAgIHZhciBnb3RvQW5jaG9yID0gZnVuY3Rpb24oZWwpIHtcbiAgICAgICAgdmFyIGFuY2hvciA9IGVsLmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuICAgICAgICB2YXIgYW5jaG9yRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYW5jaG9yKTtcbiAgICAgICAgdmFyIGFuY2hvclBvc2l0aW9uID0gYW5jaG9yRWxlbWVudC5vZmZzZXRUb3A7XG4gICAgICAgIHZhciBpbnRlcnZhbCA9IDA7XG4gICAgICAgIHZhciBzY3JvbGxEb3duID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgY29uZmlnLnNjcm9sbFRvcFBvc2l0aW9uKCkgKyBjb25maWcuc21vb3RoU2Nyb2xsU3RlcHMpO1xuICAgICAgICAgICAgaWYgKGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpID4gKGFuY2hvclBvc2l0aW9uIC0gY29uZmlnLnNjcm9sbEFuY2hvckd1dHRlcikpIHtcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHNjcm9sbFVwID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgY29uZmlnLnNjcm9sbFRvcFBvc2l0aW9uKCkgLSBjb25maWcuc21vb3RoU2Nyb2xsU3RlcHMpO1xuICAgICAgICAgICAgaWYgKGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpIDwgKGFuY2hvclBvc2l0aW9uIC0gY29uZmlnLnNjcm9sbEFuY2hvckd1dHRlcikpIHtcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBGZWNoYSBhIGxpc3RhIGRvIG1lbnVcbiAgICAgICAgY2xvc2VRdWlja01lbnUoKTtcblxuICAgICAgICAvLyBTY3JvbGxhIGF0w6kgYSDDom5jb3JhIGRvIGl0ZW0gY2xpY2Fkb1xuICAgICAgICAvLyBTZSBhIMOibmNvcmEgZXN0w6EgYWJhaXhvIGRhIHBvc2nDp8OjbyBhdHVhbCBkYSBww6FnaW5hXG4gICAgICAgIGlmIChjb25maWcuc2Nyb2xsVG9wUG9zaXRpb24oKSA8IGFuY2hvclBvc2l0aW9uKSB7XG4gICAgICAgICAgICBpbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbChzY3JvbGxEb3duLCAyKTtcbiAgICAgICAgICAgIC8vIFNlIGEgw6JuY29yYSBlc3TDoSBhY2ltYSBkYSBwb3Npw6fDo28gYXR1YWwgZGEgcMOhZ2luYVxuICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpID4gYW5jaG9yUG9zaXRpb24pIHtcbiAgICAgICAgICAgIGludGVydmFsID0gd2luZG93LnNldEludGVydmFsKHNjcm9sbFVwLCAyKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgc2V0QWN0aXZlSXRlbSA9IGZ1bmN0aW9uKGFuY2hvcikge1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhhbmNob3IpO1xuXG4gICAgICAgIGlmIChhbmNob3IgPT09IGNvbmZpZy5sYXN0U2VsZWN0ZWRBbmNob3IpIHJldHVybjtcbiAgICAgICAgZWxzZSBjb25maWcubGFzdFNlbGVjdGVkQW5jaG9yID0gYW5jaG9yO1xuXG4gICAgICAgIHZhciBhbmNob3JIYXNoID0gJyMnICsgYW5jaG9yLmdldEF0dHJpYnV0ZSgnaWQnKTtcbiAgICAgICAgdmFyIG1lbnVJdGVtID0gJC5saXN0LnF1ZXJ5U2VsZWN0b3IoJ1tocmVmPVwiJyArIGFuY2hvckhhc2ggKyAnXCJdJyk7XG4gICAgICAgIHZhciB0aXRsZSA9IG1lbnVJdGVtLnRleHRDb250ZW50O1xuXG4gICAgICAgIC8vIGRlYnVnZ2VyO1xuXG5cbiAgICAgICAgLy8gRGVzYXRpdmEgaXRlbSBhdGl2byBhdHVhbG1lbnRlXG4gICAgICAgIGlmICgkLmxpc3QucXVlcnlTZWxlY3RvcignLicgKyBjb25maWcuaXRlbUFjdGl2ZUNsYXNzKSkge1xuICAgICAgICAgICAgJC5saXN0LnF1ZXJ5U2VsZWN0b3IoJy4nICsgY29uZmlnLml0ZW1BY3RpdmVDbGFzcykuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaXRlbUFjdGl2ZUNsYXNzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEF0aXZhIG8gaXRlbSBkZSBhY29yZG8gY29tIGEgcG9zacOnw6NvIGF0dWFsXG4gICAgICAgIG1lbnVJdGVtLmNsYXNzTGlzdC5hZGQoY29uZmlnLml0ZW1BY3RpdmVDbGFzcyk7XG5cbiAgICAgICAgLy8gQWx0ZXJhIG8gdGV4dG8gZG8gYm90w6NvIGRlIHRvZ2dsZSBjb20gbyB0w610dWxvIGRvIGl0ZW0gY2xpY2Fkb1xuICAgICAgICAkLnRvZ2dsZS5pbm5lclRleHQgPSB0aXRsZS50b1N0cmluZygpO1xuXG4gICAgICAgIC8vIEFsdGVyYSBvIGhhc2ggZGEgVVJMIGNvbSBvIGhhc2ggZGEgw6JuY29yYSBjbGljYWRhXG4gICAgICAgIGhpc3RvcnkucmVwbGFjZVN0YXRlKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBhbmNob3JIYXNoKTtcbiAgICB9O1xuXG4gICAgdmFyIGdldEFjdGl2ZUl0ZW0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHBvc2l0aW9ucyA9IGdldEFuY2hvcnNQb3NpdGlvbigpO1xuICAgICAgICB2YXIgc2Nyb2xsID0gY29uZmlnLnNjcm9sbFRvcFBvc2l0aW9uKCk7XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHBvc2l0aW9ucy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXRwdXQgPSAwO1xuXG4gICAgICAgIC8vIFJldHVybiBhY3RpdmUgZWxlbWVudCBieSBvZmZzZXRUb3AgcG9zaXRpb25cbiAgICAgICAgZm9yICg7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgaWYgKHNjcm9sbCA+PSAocG9zaXRpb25zW2ldLnRhcmdldFBvcyAtIGNvbmZpZy5zY3JvbGxBbmNob3JHdXR0ZXIpKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gcG9zaXRpb25zW2ldLnRhcmdldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJldHVybiBmaXJzdCBpdGVtIGlmIGFueSBpcyByZXR1cm5lZCBmcm9tIGxvb3BpbmcgYWJvdmVcbiAgICAgICAgaWYgKCFvdXRwdXQpIG91dHB1dCA9IHBvc2l0aW9uc1swXS50YXJnZXQ7XG5cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9O1xuXG4gICAgdmFyIGdldEFuY2hvcnNQb3NpdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcG9zaXRpb25zID0gW107XG5cbiAgICAgICAgLy8gR2VyYSB1bSBhcnJheSBjb20gYXMgw6JuY29yYXMgZSBzdWFzIHJlc3BlY3RpdmFzIHBvc2nDp8O1ZXNcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCgkLml0ZW1zLCBmdW5jdGlvbihlbCwgaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBhbmNob3IgPSBlbC5nZXRBdHRyaWJ1dGUoJ2hyZWYnKTtcbiAgICAgICAgICAgIHZhciBhbmNob3JFbGVtZW50O1xuICAgICAgICAgICAgdmFyIGFuY2hvclBvc2l0aW9uO1xuXG4gICAgICAgICAgICBpZiAoIXZhbGlkQW5jaG9yKGFuY2hvcikpIHJldHVybjtcblxuICAgICAgICAgICAgYW5jaG9yRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYW5jaG9yKTtcbiAgICAgICAgICAgIGFuY2hvclBvc2l0aW9uID0gYW5jaG9yRWxlbWVudC5vZmZzZXRUb3A7XG5cbiAgICAgICAgICAgIHBvc2l0aW9uc1tpbmRleF0gPSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmNob3JFbGVtZW50LFxuICAgICAgICAgICAgICAgIHRhcmdldFBvczogYW5jaG9yUG9zaXRpb24gLSBjb25maWcuc2Nyb2xsQW5jaG9yR3V0dGVyLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHBvc2l0aW9ucztcbiAgICB9O1xuXG4gICAgdmFyIHNldFBpbmVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbmZpZy50b3BQb3NpdGlvblRvRmxvYXQgPSAkLnF1aWNrTWVudS5vZmZzZXRUb3AgLSBwYXJzZUZsb2F0KCQuZmxvYXRlci5zdHlsZS50b3ApO1xuICAgICAgICBpZiAoY29uZmlnLnNjcm9sbFRvcFBvc2l0aW9uKCkgPiBjb25maWcudG9wUG9zaXRpb25Ub0Zsb2F0KSB7XG4gICAgICAgICAgICAkLnF1aWNrTWVudS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5xdWlja01lbnVQaW5lZENsYXNzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQucXVpY2tNZW51LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLnF1aWNrTWVudVBpbmVkQ2xhc3MpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzM4ODk5Ni9yZWdleC1mb3ItamF2YXNjcmlwdC10by1hbGxvdy1vbmx5LWFscGhhbnVtZXJpYy8zODkwMjIjMzg5MDIyXG4gICAgdmFyIHZhbGlkQW5jaG9yID0gZnVuY3Rpb24oc3RyKSB7XG4gICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoL15bYS16MC05LV9dKy8pO1xuICAgICAgICB2YXIgaWQgPSBzdHIuc3Vic3RyaW5nKDEpO1xuICAgICAgICAvLyAxOiBoYXMgIyBpbiBmaXJzdCBwb3NpdGlvbiAoaXMgYW4gaW50ZXJuYWwgYW5jaG9yKVxuICAgICAgICByZXR1cm4gc3RyLmluZGV4T2YoJyMnKSA9PT0gMCAmJlxuICAgICAgICAgICAgLy8gMjogaGFzIG1vcmUgdGhhbiAyIGNoYXJhY3RlcnMgKGlzIG5vdCBhbiBlbXB0eSAjIGxpbmspXG4gICAgICAgICAgICBzdHIubGVuZ3RoID4gMSAmJlxuICAgICAgICAgICAgLy8gMzogaGFzIGFuIGFscGhhbnVtZXJpYyAod2l0aCBkYXNoZXMgb3IgdW5kZXJzY29yZXMpIGlkXG4gICAgICAgICAgICByZWdleC50ZXN0KGlkKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5pdDogaW5pdCxcbiAgICAgICAgZ2V0QWN0aXZlSXRlbTogZ2V0QWN0aXZlSXRlbSxcbiAgICAgICAgc2V0QWN0aXZlSXRlbTogc2V0QWN0aXZlSXRlbSxcbiAgICAgICAgZ2V0QW5jaG9yc1Bvc2l0aW9uOiBnZXRBbmNob3JzUG9zaXRpb24sXG4gICAgICAgIHZhbGlkQW5jaG9yOiB2YWxpZEFuY2hvcixcbiAgICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IFF1aWNrTWVudSBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtcXVpY2stbWVudS1hbmNob3InKS5sZW5ndGgpIHtcbiAgICAgICAgQnNRdWlja01lbnUuaW5pdCgpO1xuICAgIH1cbn0pO1xuIiwiZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcblxuICAgIHZhciBpc0lFID0gLypAY2Nfb24hQCovZmFsc2UgfHwgISFkb2N1bWVudC5kb2N1bWVudE1vZGU7XG5cbiAgICBpZiAoaXNJRSkge1xuICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLW5ld3NfX21ldGEnKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBuZXdzX2luZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdicy1tZWRpYV9fbWV0YScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKG5ld3NfaW5mbywgZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbS5wYXJlbnROb2RlLm5vZGVOYW1lID09IFwiQVNJREVcIikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50X2VsZW0gPSBlbGVtLnBhcmVudE5vZGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzb2NpYWxfbm9kZSA9IHBhcmVudF9lbGVtLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2JzLXNvY2lhbF9fbGlzdCcpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc29jaWFsX2VsZW07XG4gICAgXG4gICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoc29jaWFsX25vZGUsIGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb2NpYWxfZWxlbSA9IGVsZW1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRfZWxlbS5yZW1vdmVDaGlsZChlbGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudF9lbGVtLnJlbW92ZUNoaWxkKHNvY2lhbF9lbGVtKVxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50X2VsZW0uYXBwZW5kQ2hpbGQoZWxlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRfZWxlbS5hcHBlbmRDaGlsZChzb2NpYWxfZWxlbSk7XG4gICAgICAgICAgICAgICAgICAgIH0sMjAwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KTsiLCIvKipcbiAqIE92ZXJmbG93IE1lbnVcbiAqL1xudmFyIEJzT3ZlcmZsb3dNZW51ID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gQ29uZmlnXG4gIHZhciBjb25maWcgPSB7XG4gICAgYnV0dG9uczoge1xuICAgICAgdHJpZ2dlcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXRyaWdnZXItb3ZlcmZsb3ctbWVudScpLFxuICAgIH0sXG4gICAgY2xhc3Nlczoge1xuICAgICAgb3BlbjogJ2JzLW92ZXJmbG93LW1lbnUtLW9wZW4nLFxuICAgICAgb3ZlcmZsb3dNZW51OiAnYnMtb3ZlcmZsb3ctbWVudScsXG4gICAgfSxcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBBYnJlL2ZlY2hhIG8gT3ZlcmZsb3cgTWVudVxuICAgIGlmIChjb25maWcuYnV0dG9ucy50cmlnZ2VyKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5idXR0b25zLnRyaWdnZXIsIGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIHRvZ2dsZW92ZXJmbG93TWVudShidXR0b24pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICB2YXIgdG9nZ2xlb3ZlcmZsb3dNZW51ID0gZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgIHZhciBpc09wZW4gPSBidXR0b24ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5jbGFzc2VzLm92ZXJmbG93TWVudSkuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5jbGFzc2VzLm9wZW4pO1xuXG4gICAgaWYgKGlzT3BlbiljbG9zZW92ZXJmbG93TWVudShidXR0b24pO1xuICAgIGVsc2Ugb3Blbm92ZXJmbG93TWVudShidXR0b24pO1xuICB9O1xuXG4gIHZhciBvcGVub3ZlcmZsb3dNZW51ID0gZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgIGNsb3NlQWxsb3ZlcmZsb3dNZW51KCk7XG4gICAgYnV0dG9uLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLicgKyBjb25maWcuY2xhc3Nlcy5vdmVyZmxvd01lbnUpLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMub3Blbik7XG4gIH07XG5cbiAgdmFyIGNsb3Nlb3ZlcmZsb3dNZW51ID0gZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgIGJ1dHRvbi5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy4nICsgY29uZmlnLmNsYXNzZXMub3ZlcmZsb3dNZW51KS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLm9wZW4pO1xuICB9O1xuXG4gIHZhciBjbG9zZUFsbG92ZXJmbG93TWVudSA9IGZ1bmN0aW9uICgpIHtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgY29uZmlnLmNsYXNzZXMub3BlbiksIGZ1bmN0aW9uIChvdmVyZmxvd01lbnUpIHtcbiAgICAgIG92ZXJmbG93TWVudS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLm9wZW4pO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIENsb3NlIG1lbnUgb24gY2xpY2sgb3V0c2lkZVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgY2xvc2VBbGxvdmVyZmxvd01lbnUoKTtcbiAgfSk7XG4gIFxuICAvLyBDbG9zZSBtZW51IG9uIHByZXNzIEVTQ1xuICBkb2N1bWVudC5vbmtleWRvd24gPSBmdW5jdGlvbihldnQpIHtcbiAgICBldnQgPSBldnQgfHwgd2luZG93LmV2ZW50O1xuICAgIGlmIChldnQua2V5Q29kZSA9PSAyNykgY2xvc2VBbGxvdmVyZmxvd01lbnUoKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gICAgY2xvc2VBbGxvdmVyZmxvd01lbnU6IGNsb3NlQWxsb3ZlcmZsb3dNZW51LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IEJzT3ZlcmZsb3dNZW51IGNvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBCc092ZXJmbG93TWVudS5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtb3ZlcmZsb3ctbWVudScpLmxlbmd0aCkge1xuICAgIEJzT3ZlcmZsb3dNZW51LmluaXQoKTtcbiAgfVxufSk7XG4iLCJ2YXIgQnNTbmFja1Byb2dyZXNzID0gZnVuY3Rpb24gKCkge1xuICAvLyBDb25maWcgTGlzdCBhbmQgU2VsZWN0XG4gIHZhciBjb25maWcgPSB7XG4gICAgZWw6IHtcbiAgICAgIHNuYWNrOiBudWxsLFxuICAgICAgcHJvZ3Jlc3M6IG51bGwsXG4gICAgICBwcm9ncmVzc1RleHQ6IG51bGwsXG4gICAgICBwcm9ncmVzc0JhcjogbnVsbCxcbiAgICAgIHByb2dyZXNzVmFsdWU6IG51bGwsXG4gICAgICBwcm9ncmVzc0xpbms6IG51bGwsXG4gICAgICBwcm9ncmVzc0NhbmNlbDogbnVsbCxcbiAgICAgIHByb2dyZXNzQnV0dG9uczogbnVsbCxcbiAgICB9LFxuICAgIGNsYXNzZXM6IHtcbiAgICAgIHNuYWNrOiAnYnMtc25hY2tiYXItLXByb2dyZXNzJyxcbiAgICAgIHByb2dyZXNzOiAnYnMtcHJvZ3Jlc3MnLFxuICAgICAgcHJvZ3Jlc3NUZXh0OiAnYnMtcHJvZ3Jlc3NfX3RleHQnLFxuICAgICAgcHJvZ3Jlc3NCYXI6ICdicy1wcm9ncmVzc19fYmFyJyxcbiAgICAgIHByb2dyZXNzVmFsdWU6ICdicy1wcm9ncmVzc19fdmFsdWUnLFxuICAgICAgcHJvZ3Jlc3NMaW5rOiAnYnMtcHJvZ3Jlc3NfX2xpbmsnLFxuICAgICAgcHJvZ3Jlc3NDYW5jZWw6ICdicy1wcm9ncmVzc19fY2FuY2VsJyxcbiAgICAgIHByb2dyZXNzQnV0dG9uczogJ2JzLXByb2dyZXNzX19hY3Rpb25zJyxcbiAgICAgIHZpc2libGU6ICdicy1zbmFja2Jhci0tdmlzaWJsZScsXG4gICAgfSxcbiAgICBzdGF0ZToge1xuICAgICAgcHJvZ3Jlc3M6ICcwJScsXG4gICAgICBtZXNzYWdlOiAnQmFpeGFuZG8nLFxuICAgIH0sXG4gICAgZXZlbnRzOiB7XG4gICAgICBsaW5rOiBmdW5jdGlvbiAoKSB7fSxcbiAgICAgIGNhbmNlbDogZnVuY3Rpb24gKCkge30sXG4gICAgfSxcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBidWlsZFNuYWNrKCk7XG4gICAgYnVpbGRQcm9ncmVzcygpO1xuICAgIGNvbmZpZy5lbC5zbmFjay5hcHBlbmRDaGlsZChjb25maWcuZWwucHJvZ3Jlc3MpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29uZmlnLmVsLnNuYWNrKTtcbiAgfTtcblxuICB2YXIgYnVpbGRQcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb25maWcuZWwucHJvZ3Jlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIGNvbmZpZy5lbC5wcm9ncmVzc0JhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NWYWx1ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NCdXR0b25zID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIGNvbmZpZy5lbC5wcm9ncmVzc0xpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NDYW5jZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcblxuICAgIGNvbmZpZy5lbC5wcm9ncmVzcy5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jbGFzc2VzLnByb2dyZXNzKTtcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NUZXh0LmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMucHJvZ3Jlc3NUZXh0KTtcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NCYXIuY2xhc3NMaXN0LmFkZChjb25maWcuY2xhc3Nlcy5wcm9ncmVzc0Jhcik7XG4gICAgY29uZmlnLmVsLnByb2dyZXNzVmFsdWUuY2xhc3NMaXN0LmFkZChjb25maWcuY2xhc3Nlcy5wcm9ncmVzc1ZhbHVlKTtcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NCdXR0b25zLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMucHJvZ3Jlc3NCdXR0b25zKTtcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NMaW5rLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMucHJvZ3Jlc3NMaW5rKTtcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NDYW5jZWwuY2xhc3NMaXN0LmFkZChjb25maWcuY2xhc3Nlcy5wcm9ncmVzc0NhbmNlbCk7XG5cbiAgICBjb25maWcuZWwucHJvZ3Jlc3NUZXh0LmlubmVySFRNTCA9IGNvbmZpZy5zdGF0ZS5tZXNzYWdlO1xuICAgIGNvbmZpZy5lbC5wcm9ncmVzc1ZhbHVlLmlubmVySFRNTCA9IGNvbmZpZy5zdGF0ZS5wcm9ncmVzcztcblxuICAgIGNvbmZpZy5lbC5wcm9ncmVzc0xpbmsudHlwZSA9ICdidXR0b24nO1xuXG4gICAgY29uZmlnLmVsLnByb2dyZXNzQ2FuY2VsLnR5cGUgPSAnYnV0dG9uJztcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NDYW5jZWwudGl0bGUgPSAnQ2FuY2VsYXInO1xuICAgIGNvbmZpZy5lbC5wcm9ncmVzc0NhbmNlbC5pbm5lckhUTUwgPSAnPGkgY2xhc3M9XCJpY29uLW5hdi1mZWNoYXJcIj48L2k+JztcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NDYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICBzZXRQcm9ncmVzcygpO1xuICAgICAgaGlkZSgwKTtcbiAgICB9KTtcblxuICAgIGNvbmZpZy5lbC5wcm9ncmVzc0J1dHRvbnMuYXBwZW5kQ2hpbGQoY29uZmlnLmVsLnByb2dyZXNzTGluayk7XG4gICAgY29uZmlnLmVsLnByb2dyZXNzQnV0dG9ucy5hcHBlbmRDaGlsZChjb25maWcuZWwucHJvZ3Jlc3NDYW5jZWwpO1xuXG4gICAgY29uZmlnLmVsLnByb2dyZXNzLmFwcGVuZENoaWxkKGNvbmZpZy5lbC5wcm9ncmVzc1RleHQpO1xuICAgIGNvbmZpZy5lbC5wcm9ncmVzcy5hcHBlbmRDaGlsZChjb25maWcuZWwucHJvZ3Jlc3NCYXIpO1xuICAgIGNvbmZpZy5lbC5wcm9ncmVzcy5hcHBlbmRDaGlsZChjb25maWcuZWwucHJvZ3Jlc3NWYWx1ZSk7XG4gICAgY29uZmlnLmVsLnByb2dyZXNzLmFwcGVuZENoaWxkKGNvbmZpZy5lbC5wcm9ncmVzc0J1dHRvbnMpO1xuICB9O1xuXG4gIHZhciBidWlsZFNuYWNrID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbmZpZy5lbC5zbmFjayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbmZpZy5lbC5zbmFjay5jbGFzc05hbWUgPSAnYnMtc25hY2tiYXIgYnMtc25hY2tiYXItLXByb2dyZXNzIGJzLXNuYWNrYmFyLS1hbGlnbi1sZWZ0IGJzLXNuYWNrYmFyLS1hbGVydCc7XG4gICAgY29uZmlnLmVsLnNuYWNrLnNldEF0dHJpYnV0ZSgncm9sZScsICdhbGVydCcpO1xuICAgIGNvbmZpZy5lbC5zbmFjay5zZXRBdHRyaWJ1dGUoJ2RhdGEtc25hY2tiYXItaWQnLCAnYnMtZG93bmxvYWRzLXByb2dyZXNzJyk7XG4gIH07XG5cbiAgdmFyIHNob3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGNvbmZpZy5lbCAmJiBjb25maWcuZWwuc25hY2spIGNvbmZpZy5lbC5zbmFjay5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jbGFzc2VzLnZpc2libGUpO1xuICB9O1xuXG4gIHZhciBoaWRlID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChjb25maWcuZWwgJiYgY29uZmlnLmVsLnNuYWNrKSBjb25maWcuZWwuc25hY2suY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY2xhc3Nlcy52aXNpYmxlKTtcbiAgfTtcblxuICAvKipcbiAgICogU2V0IGEgbmV3IHByb2dyZXNzIHRvIHNuYWNrYmFyXG4gICAqIEBwYXJhbSAge051bWJlcnxTdHJpbmd9IHByb2dyZXNzICBhIG51bWVyaWMgdmFsdWUgZm9yIHByb2dyZXNzIG9yIGEgc3RyaW5nXG4gICAqIEBwYXJhbSAge1N0cmluZ30gICAgICAgIG1lc3NhZ2UgICBhIHRleHQgdG8gZGVzY3JpYmUgdGhlIHN0YXRlIG9mIHByb2dyZXNzXG4gICAqIEByZXR1cm4ge1ZvaWR9XG4gICAqL1xuICB2YXIgc2V0UHJvZ3Jlc3MgPSBmdW5jdGlvbiAocHJvZ3Jlc3MsIG1lc3NhZ2UpIHtcbiAgICAvLyBVcGRhdGUgaWYgcHJvZ3Jlc3MgaXMgYSBkaWZmZXJlbnQgbnVtYmVyIG9mIGN1cnJlbnQgaW4gc3RhdGVcbiAgICBpZiAodHlwZW9mIHByb2dyZXNzID09PSAnbnVtYmVyJyAmJiBjb25maWcuc3RhdGUucHJvZ3Jlc3MgIT09IHByb2dyZXNzKSB7XG4gICAgICBjb25maWcuc3RhdGUucHJvZ3Jlc3MgPSBwcm9ncmVzcyArICclJztcbiAgICAgIGNvbmZpZy5lbC5wcm9ncmVzc1ZhbHVlLmlubmVySFRNTCA9IGNvbmZpZy5zdGF0ZS5wcm9ncmVzcztcbiAgICAgIGNvbmZpZy5lbC5wcm9ncmVzc0Jhci5zdHlsZS53aWR0aCA9IGNvbmZpZy5zdGF0ZS5wcm9ncmVzcztcbiAgICB9IGVsc2UgaWYgKCFwcm9ncmVzcykge1xuICAgICAgY29uZmlnLmVsLnByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gMDtcbiAgICAgIGNvbmZpZy5lbC5wcm9ncmVzc1ZhbHVlLmlubmVySFRNTCA9ICcnO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBpbm5lckhUTUwgb2YgcHJvZ3Jlc3NWYWx1ZSBpZiBwcm9ncmVzcyBpcyBhIHN0cmluZ1xuICAgIC8vIEl0J3MgdXNlZnVsIHRvIGFkZCBhIGxvYWRpbmdzIGNvbXBvbmVudCBvciBjdXN0b20gbGlua3MgaW4gbGlldSBvZiBhXG4gICAgLy8gbnVtZXJpYyB2YWx1ZSBvbiB0aGUgcmlnaHQgb2YgdGhlIHNuYWNrYmFyXG4gICAgaWYgKHByb2dyZXNzIGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgY29uZmlnLmVsLnByb2dyZXNzVmFsdWUuaW5uZXJIVE1MID0gJyc7XG4gICAgICBjb25maWcuZWwucHJvZ3Jlc3NWYWx1ZS5hcHBlbmRDaGlsZChwcm9ncmVzcyk7XG4gICAgICBjb25maWcuZWwucHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSAwO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBpZiBtZXNzYWdlIGlzIGEgZGlmZmVyZW50IHN0cmluZyBvZiBjdXJyZW50IGluIHN0YXRlXG4gICAgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJyAmJiBjb25maWcuc3RhdGUubWVzc2FnZSAhPT0gbWVzc2FnZSkge1xuICAgICAgY29uZmlnLnN0YXRlLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgY29uZmlnLmVsLnByb2dyZXNzVGV4dC5pbm5lckhUTUwgPSBtZXNzYWdlO1xuICAgIH1cbiAgfTtcblxuICB2YXIgYWRkQnV0dG9uID0gZnVuY3Rpb24gKGljb25DbGFzcywgbWVzc2FnZSwgY2IpIHtcbiAgICBpZiAoXG4gICAgICB0eXBlb2YgaWNvbkNsYXNzICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgdHlwZW9mIG1lc3NhZ2UgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICB0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGNvbmZpZy5ldmVudHMubGluayA9IGNiO1xuICAgICAgY29uZmlnLmVsLnByb2dyZXNzTGluay5pbm5lckhUTUwgPSAnPGkgY2xhc3M9XCInICsgaWNvbkNsYXNzICsgJ1wiPjwvaT4nO1xuICAgICAgY29uZmlnLmVsLnByb2dyZXNzTGluay50aXRsZSA9IG1lc3NhZ2U7XG4gICAgICBjb25maWcuZWwucHJvZ3Jlc3NMaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY29uZmlnLmV2ZW50cy5saW5rKTtcbiAgICAgIHJldHVybiBjb25maWcuZWwucHJvZ3Jlc3NMaW5rO1xuICAgIH1cblxuICAgIC8vIHRocm93IG5ldyBFcnJvcignYWxsIGFyZ3VtZW50cyBhcmUgcmVxdWlyZWQuJyk7XG4gIH07XG5cbiAgdmFyIHJlbW92ZUJ1dHRvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoY29uZmlnLmVsICYmIGNvbmZpZy5lbC5wcm9ncmVzc0xpbmspIHtcbiAgICAgIGNvbmZpZy5lbC5wcm9ncmVzc0xpbmsuaW5uZXJIVE1MID0gJyc7XG4gICAgICBjb25maWcuZWwucHJvZ3Jlc3NMaW5rLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY29uZmlnLmV2ZW50cy5saW5rKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uQ2FuY2VsID0gZnVuY3Rpb24gKGNiKSB7XG4gICAgaWYgKHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykgY2IgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICBjb25maWcuZWwucHJvZ3Jlc3NDYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjYik7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICAgIHNob3c6IHNob3csXG4gICAgaGlkZTogaGlkZSxcbiAgICBzZXRQcm9ncmVzczogc2V0UHJvZ3Jlc3MsXG4gICAgYWN0aXZlQnV0dG9uOiBhZGRCdXR0b24sXG4gICAgZGlzYWJsZUJ1dHRvbjogcmVtb3ZlQnV0dG9uLFxuICAgIG9uQ2FuY2VsOiBvbkNhbmNlbCxcbiAgICBlbGVtZW50czogY29uZmlnLmVsLFxuICB9O1xufTtcblxuXG4vKipcbiAqIEluaXQgQnNTbmFja2JhciBjb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gQnNTbmFja2Jhci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIC8vIHdpbmRvdy5wcm9ncmVzcyA9IG5ldyBCc1NuYWNrUHJvZ3Jlc3MoKVxuICAvLyBwcm9ncmVzcy5pbml0KCk7XG4gIC8vIHByb2dyZXNzLnNob3coKTtcbn0pO1xuIiwiLyoqXG4gKiBCcyBDYXJvdXNlbFxuICovXG52YXIgQnNDYXJvdXNlbCA9IChmdW5jdGlvbiAoKSB7XG5cbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBjYXJvdXNlbERlZmF1bHQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1xdWljay1tZW51Om5vdCguYnMtcXVpY2stbWVudS0taWNvbikgLmJzLWpzLWNhcm91c2VsJyksXG4gICAgY2Fyb3VzZWxCb3g6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1xdWljay1tZW51X19ib3gnKSxcbiAgICBwYWRkaW5nQm94OiAyNSxcbiAgICBvdmVyUHJldjogJ2JzLXF1aWNrLW1lbnUtLW92ZXItcHJldicsXG4gICAgb3Zlck5leHQ6ICdicy1xdWljay1tZW51LS1vdmVyLW5leHQnLFxuICAgIHByZXZOZXh0QnV0dG9uczogJ2JzLXF1aWNrLW1lbnUtLWFjdGl2ZS1idXR0b24nLFxuICAgIHByZXZQcmV2OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtcXVpY2stbWVudV9fYWN0aW9ucy0tYnV0dG9uLXByZXYnKSxcbiAgICBwcmV2TmV4dDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLXF1aWNrLW1lbnVfX2FjdGlvbnMtLWJ1dHRvbi1uZXh0JyksXG4gIH1cblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBhZ3VhcmRhIGxvYWQgZG9zIHNjcmlwdHNcbiAgICBkZWJvdW5jZShidWlsZE1lbnUoKSk7XG4gIH07XG5cbiAgdmFyIGJ1aWxkTWVudSA9IGZ1bmN0aW9uICgpIHtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5jYXJvdXNlbERlZmF1bHQsIGZ1bmN0aW9uIChlbCkge1xuXG4gICAgICB2YXIgaXRlbSA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1xdWljay1tZW51X19pdGVtJyk7XG4gICAgICB2YXIgZmxrdHk7XG5cbiAgICAgIC8vICEhLSBTRVQgREUgQ09ORklHVVJBw4fDg08gUEFEUsODT1xuICAgICAgdmFyIGZsaWNraXR5T3B0aW9uc0RlZmF1bHRzID0ge1xuICAgICAgICBjb250YWluOiB0cnVlLFxuICAgICAgICBwcmV2TmV4dEJ1dHRvbnM6IGZhbHNlLFxuICAgICAgICBjZWxsQWxpZ246ICdsZWZ0JyxcbiAgICAgICAgZ3JvdXBDZWxsczogdHJ1ZSxcbiAgICAgICAgcGFnZURvdHM6IHRydWUsXG4gICAgICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICAgICAgcGVyY2VudFBvc2l0aW9uOiBmYWxzZSxcbiAgICAgICAgd2F0Y2hDU1M6IHRydWUsXG4gICAgICAgIGFkYXB0aXZlSGVpZ2h0OiB0cnVlLFxuICAgICAgICBzZWxlY3RlZEF0dHJhY3Rpb246IDAuMDE1LFxuICAgICAgICBmcmljdGlvbjogMC4xNSxcbiAgICAgIH07XG5cbiAgICAgIC8vIC0gZXZpdGEgcXVlIG8gZmxpY2t0eSBhZGljaW9uZSB1bWEgbGFyZ3VyYSBtYWlvciBwYXJhIG9zIHZpc2l2ZWlzXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChpdGVtLCBmdW5jdGlvbiAoZWxJdGVtKSB7XG4gICAgICAgICAgZWxJdGVtLnN0eWxlLm1pbldpZHRoID0gZWxJdGVtLm9mZnNldFdpZHRoICsgJ3B4JzsgLy8gRml4IElFIDExIC0gb25seSB3b3JrXG4gICAgICAgICAgZWxJdGVtLnN0eWxlLndpZHRoID0gZWxJdGVtLm9mZnNldFdpZHRoICsgJ3B4JztcbiAgICAgICAgfSk7XG4gICAgICB9LCAzMDApO1xuXG4gICAgICAvLyByZW1vbnRhIGEgcG9zacOnw6NvIGRvcyBpdGVtcyBlIGV2aXRhIHF1ZWJyYVxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbnRlcnZhbCA9IG51bGxcbiAgICAgICAgXG4gICAgICAgIC8vIC0gRXhlY3V0YSBlIEFwbGljYSBTZXQgZGUgY29uZmlndXJhw6fDtWVzXG4gICAgICAgIGZsa3R5ID0gbmV3IEZsaWNraXR5KGVsLCBmbGlja2l0eU9wdGlvbnNEZWZhdWx0cyk7XG4gICAgICAgIFxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNsZWFyVGltZW91dChpbnRlcnZhbClcbiAgICAgICAgICBpbnRlcnZhbCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChpdGVtLCBmdW5jdGlvbiAoZWxJdGVtKSB7IFxuICAgICAgICAgICAgICByZXNpemVDZWxsKGVsSXRlbSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZmxrdHkucmVsb2FkQ2VsbHMoKTtcbiAgICAgICAgICB9LCAzMDApXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgdmFyIGZsaWNraXR5VmlldyA9IGVsLnF1ZXJ5U2VsZWN0b3IoJy5mbGlja2l0eS12aWV3cG9ydCcpO1xuXG4gICAgICAgIC8vIG9ubHkgYXBwbHkgY2xhc3MgcmVsYXRpdmUgSU5JVCBuYXZpdGdhdGlvblxuICAgICAgICBpZiAoZmxpY2tpdHlWaWV3KSB7XG4gICAgICAgICAgdmFyIGNhcm91c2VsQm94UGFyZW50ID0gZmxpY2tpdHlWaWV3LnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgICBjYXJvdXNlbEJveFBhcmVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5vdmVyTmV4dCk7XG4gIFxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgZmxrdHkucmVsb2FkQ2VsbHMoKTtcblxuICAgICAgfSwgMzAwKTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciByZXNpemVDZWxsID0gZnVuY3Rpb24gKGVsKSB7XG4gICAgZWwuc3R5bGUubWluV2lkdGggPSAnaW5pdGlhbCc7XG4gICAgZWwuc3R5bGUud2lkdGggPSAnaW5pdGlhbCc7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciBjYXJvdXNlbERlZmF1bHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtcXVpY2stbWVudTpub3QoLmJzLXF1aWNrLW1lbnUtLWljb24pIC5icy1qcy1jYXJvdXNlbCcpO1xuICBpZiAoY2Fyb3VzZWxEZWZhdWx0Lmxlbmd0aCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY2Fyb3VzZWxEZWZhdWx0LCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIEJzQ2Fyb3VzZWwuaW5pdChlbCk7XG4gICAgfSlcbiAgfVxufSk7XG4iLCIvKipcbiAqIEJzIENhcm91c2VsIEljb25zXG4gKi9cbnZhciBCc0Nhcm91c2VsSWNvbnMgPSAoZnVuY3Rpb24gKCkge1xuXG4gIHZhciBjb25maWcgPSB7XG4gICAgY2Fyb3VzZWxJY29uczogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXF1aWNrLW1lbnUtLWljb24gLmJzLWpzLWNhcm91c2VsJyksXG4gICAgY2Fyb3VzZWxCb3g6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1xdWljay1tZW51X19ib3gnKSxcbiAgICBvdmVyUHJldjogJ2JzLXF1aWNrLW1lbnUtLW92ZXItcHJldicsXG4gICAgb3Zlck5leHQ6ICdicy1xdWljay1tZW51LS1vdmVyLW5leHQnLFxuICAgIGJveFNsaWRlcjogJycsXG4gICAgYm94Vmlld3BvcnQ6ICcnLFxuICAgIGJveFZpZXdwb3J0SXRlbTogJycsXG4gICAgYm94TmV3OiAnJyxcbiAgICBib3hTbGlkZXJDbG9uZTogJycsXG4gICAgb2ZmU2V0OiAnJyxcbiAgICBib3hJdGVtOiAnJyxcbiAgICB0b3RhbFJlZHVjZTogJycsXG4gICAgYm94U2l6ZTogJycsXG4gICAgdG90YWxJbmRleDogJycsXG4gICAgY2FsY1BlcmM6ICcnLFxuICAgIHBhcmVudDogJycsXG4gICAgdmlld01vZDogJycsXG4gIH07XG5cblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIC8vIGV2aXRhIGJ1ZyBkZSByZW5kZXJpemHDp8Ojb1xuICAgIHNldFRpbWVvdXQgKGZ1bmN0aW9uICgpIHtcblxuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgZnVuY3Rpb24oKSB7XG4gICAgICAgIGdldE1lbnUoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyByZXR1cm4gbWVudSBkZWZhdWx0IGNvbmZpZ3VyYXRpb25cbiAgICAgIGdldE1lbnUoKTtcblxuICAgIH0sIDQwMCk7XG5cblxuICB9O1xuXG4gIHZhciBnZXRNZW51ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuY2Fyb3VzZWxJY29ucywgZnVuY3Rpb24gKGVsZW0pIHtcblxuICAgICAgLy8gISEtIFNFVCBERSBDT05GSUdVUkHDh8ODTyBQQURSw4NPXG4gICAgICB2YXIgZmxpY2tpdHlPcHRpb25zID0ge1xuICAgICAgICBjb250YWluOiB0cnVlLFxuICAgICAgICBwcmV2TmV4dEJ1dHRvbnM6IGZhbHNlLFxuICAgICAgICBjZWxsQWxpZ246ICdsZWZ0JyxcbiAgICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgICAgfTtcbiAgICAgIGZsaWNraXR5T3B0aW9uc0ZhbHNlID0ge1xuICAgICAgICBjb250YWluOiB0cnVlLFxuICAgICAgICBwcmV2TmV4dEJ1dHRvbnM6IGZhbHNlLFxuICAgICAgICBjZWxsQWxpZ246ICdsZWZ0JyxcbiAgICAgICAgZHJhZ2dhYmxlOiBmYWxzZSxcbiAgICAgIH07XG5cbiAgICAgIHZhciBjYXJvdXNlbEJveCA9IGVsZW0ucGFyZW50Tm9kZS5jbG9zZXN0KCcuYnMtcXVpY2stbWVudV9fYm94Jyk7XG5cbiAgICAgIC8vIHRoZSBuZXcgc2VsZWN0b3IgcGFyZW50XG4gICAgICBjb25maWcuYm94TmV3ID0gZWxlbTtcbiAgICAgIGNvbmZpZy5vZmZTZXQgPSBjb25maWcuYm94TmV3Lm9mZnNldFdpZHRoO1xuXG4gICAgICAvLyBwYXJlbnQgaXRlbXNcbiAgICAgIGNvbmZpZy5ib3hJdGVtID0gY29uZmlnLmJveE5ldy5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtcXVpY2stbWVudV9faXRlbScpO1xuXG4gICAgICBjb25maWcudG90YWxSZWR1Y2UgPSBBcnJheS5wcm90b3R5cGUucmVkdWNlLmNhbGwoY29uZmlnLmJveEl0ZW0sIGZ1bmN0aW9uIChpLCBlbCkge1xuICAgICAgICB2YXIgaSA9IGkgKyBlbC5vZmZzZXRXaWR0aDtcbiAgICAgICAgcmV0dXJuIGk7XG4gICAgICB9LCAwKTtcblxuICAgICAgLy8gaW5pdCBmbGlja3R5XG4gICAgICB2YXIgZmxrdHkgPSBuZXcgRmxpY2tpdHkoIGVsZW0sIGZsaWNraXR5T3B0aW9ucyApO1xuXG4gICAgICAvLyBpZiBmbGlja2l0eSBnZXQgYm94IHNsaWRlclxuICAgICAgY29uZmlnLmJveFNsaWRlciA9IGVsZW0ucXVlcnlTZWxlY3RvcignLmZsaWNraXR5LXNsaWRlcicpO1xuXG4gICAgICBjb25maWcuYm94U2l6ZSA9IGNvbmZpZy5vZmZTZXQ7XG5cbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmJveEl0ZW0sIGZ1bmN0aW9uIChlbCkge1xuXG4gICAgICAgIC8vIGlmIHRvdGFsIGl0ZW1zIGxlc3MgbWF4IGJveFxuICAgICAgICBpZiAoY29uZmlnLnRvdGFsUmVkdWNlIDwgY29uZmlnLmJveFNpemUpIHtcbiAgICAgICAgICAvLyBkZWJ1Z2dlclxuICAgICAgICAgIC8vIGNhbGN1bGF0ZSB3aWR0aCByZWFsXG4gICAgICAgICAgZWwuc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgICAgICAgZWwuc3R5bGUucG9zaXRpb24gPSAnaW5pdGlhbCc7XG5cbiAgICAgICAgICAvLyBhcHBseSB0byBwYXJlbnQgbW9kaWZpZXJzXG4gICAgICAgICAgY29uZmlnLnBhcmVudCA9IGVsLnBhcmVudE5vZGU7XG4gICAgICAgICAgY29uZmlnLnBhcmVudC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICAgIGNvbmZpZy5wYXJlbnQuc3R5bGUudHJhbnNmb3JtID0gJyc7XG5cbiAgICAgICAgICAvLyByZWluaXRpYXRlIGZsaWNraXR5LCB0byByZXNpemUgaXRlbXMgd2l0aCBidWdcbiAgICAgICAgICBmbGt0eS5kZXN0cm95KCk7XG4gICAgICAgICAgLy8gZmxrdHkgPSBuZXcgRmxpY2tpdHkoIGNvbmZpZy5jYXJvdXNlbEljb25zLCBmbGlja2l0eU9wdGlvbnNGYWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gZGVidWdnZXJcbiAgICAgICAgICBlbC5zdHlsZS53aWR0aCA9ICcnO1xuICAgICAgICAgIGVsLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgICAvLyBhcHBseSB0byBwYXJlbnQgbW9kaWZpZXJzXG4gICAgICAgICAgY29uZmlnLnBhcmVudCA9IGVsLnBhcmVudE5vZGU7XG4gICAgICAgICAgY29uZmlnLnBhcmVudC5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgICAgICAgLy8gY2xhc3MgYWN0aXZlIG92ZXIgZWZmZWN0IG1vcmUgaXRlbXMgcmlnaHQgc2lkZVxuICAgICAgICAgIGNhcm91c2VsQm94LmNsYXNzTGlzdC5hZGQoY29uZmlnLm92ZXJOZXh0KTtcblxuICAgICAgICAgIC8vIHJlaW5pdGlhdGUgZmxpY2tpdHksIHRvIHJlc2l6ZSBpdGVtcyB3aXRoIGJ1Z1xuICAgICAgICAgIGZsa3R5LmRlc3Ryb3koKTtcbiAgICAgICAgICAvLyBkZWJ1Z2dlclxuICAgICAgICAgIGZsa3R5ID0gbmV3IEZsaWNraXR5KCBlbGVtLCBmbGlja2l0eU9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgZmxrdHkub24oJ3NlbGVjdCcsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvLyBjbGFzcyBhZGQgb3IgcmVtb3ZlIGVmZmVjdCBvdmVyIGluIHBvc2l0aW9uIGluaXRpYWxcbiAgICAgICAgaWYgKCFmbGt0eS5jZWxsc1tmbGt0eS5zZWxlY3RlZEluZGV4IC0gMV0pIHtcblxuICAgICAgICAgIGNhcm91c2VsQm94LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLm92ZXJQcmV2KTtcbiAgICAgICAgICBjYXJvdXNlbEJveC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5vdmVyTmV4dCk7XG5cbiAgICAgICAgICAvLyBjbGFzcyBhZGQgb3IgcmVtb3ZlIGVmZmVjdCBvdmVyIGluIHBvc2l0aW9uIGZpbmFsXG4gICAgICAgIH0gZWxzZSBpZighZmxrdHkuY2VsbHNbZmxrdHkuY2VsbHMubGVuZ3RoXSkge1xuXG4gICAgICAgICAgY2Fyb3VzZWxCb3guY2xhc3NMaXN0LmFkZChjb25maWcub3ZlclByZXYpO1xuXG4gICAgICAgICAgLy8gY2xhc3MgYWRkIG9yIHJlbW92ZSBlZmZlY3Qgb3ZlciBpbiBtaWRkbGUgcG9zaXRpb24gdG8gaXRlbXMgYmlnIHRoYW4gc2lkZXNcbiAgICAgICAgICBpZiAoZmxrdHkuc2VsZWN0ZWRJbmRleCA9PT0gKGZsa3R5LnBhZ2VEb3RzLmRvdHMubGVuZ3RoIC0gMSkpIHtcbiAgICAgICAgICAgIGNhcm91c2VsQm94LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLm92ZXJOZXh0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2Fyb3VzZWxCb3guY2xhc3NMaXN0LmFkZChjb25maWcub3Zlck5leHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IE11cmFsIENvbnN0cnVjdG9yXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciBjYXJvdXNlbEljb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXF1aWNrLW1lbnUtLWljb24gLmJzLWpzLWNhcm91c2VsJyk7XG4gIGlmIChjYXJvdXNlbEljb25zLmxlbmd0aCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY2Fyb3VzZWxJY29ucywgZnVuY3Rpb24gKGVsKSB7XG4gICAgICBCc0Nhcm91c2VsSWNvbnMuaW5pdChlbCk7XG4gICAgfSlcbiAgfVxufSk7XG4iLCIvKipcbiAqIEJzIFF1aWNrTWVudSAoYW5jaG9yKVxuICpcbiAqIFRPRE86XG4gKiAxLiBFc2NvbmRlciAodHJhbnNsYXRlOi0xMDAlKSBtZW51IGZpeG8gcXVhbmRvIHBhc3NhclxuICogZGEgw7psdGltYSBzZcOnw6NvIGRhIHDDoWdpbmEgKGdlcmFsbWVudGUsIHNvYnJlIG8gZm9vdGVyKSBlXG4gKiB2b2x0YXIgYSBtb3N0cmFyIHF1YW5kbyBzdWJpciBhIHDDoWdpbmEgbm92YW1lbnRlO1xuICpcbiAqIDIuIENhbGN1bGFyIGEgdmVsb2NpZGFkZSBkbyBzbW9vdGggc2Nyb2xsIHJlbGF0aXZvIMOgIHBvc2nDp8Ojb1xuICogZGEgc2XDp8OjbywgcGFyYSBxdWUgYSBhbmltYcOnw6NvIGRvIHNjcm9sbCBsZXZlIHNlbXByZSBvXG4gKiBtZXNtbyB0ZW1wby4gRXg6IGxldmFyIG8gbWVzbW8gdGVtcG8gcGFyYSBzY3JvbGxhciBkYVxuICogc2XDp8OjbyAxIHBhcmEgMiBlIGRhIDEgcGFyYSBhIMO6bHRpbWEuXG4gKlxuICogMy4gUXVhbmRvIG8gc2Nyb2xsIHZhaSBkZSBiYWl4byBwYXJhIGNpbWEsIHBvciBjb250YSBkbyBIZWFkZXJcbiAqIGZpY2FyIHZpc8OtdmVsLCBvIG1lbnUgYWNhYmEgZmljYW5kbyBzb2JyZSBvIHTDrXR1bG8uIFByZWNpc2FcbiAqIGRlc2NvbnRhciBvIHRhbWFuaG8gZG8gaGVhZGVyIGRhIHBvc2nDp8OjbyBhbHZvIGRhIMOibmNvcmEuXG4gKi9cbnZhciBCc1F1aWNrTWVudSA9IChmdW5jdGlvbigpIHtcbiAgICAvLyBFbGVtZW50c1xuICAgIHZhciBlbGVtZW50cyA9IHt9O1xuICAgIHZhciAkID0gZWxlbWVudHM7XG4gICAgJC5ib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xuICAgICQucXVpY2tNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLXF1aWNrLW1lbnUtYW5jaG9yJyk7XG5cbiAgICBpZiAoISQucXVpY2tNZW51KSByZXR1cm47XG5cbiAgICAkLmZsb2F0ZXIgPSAkLnF1aWNrTWVudS5xdWVyeVNlbGVjdG9yKCcuYnMtcXVpY2stbWVudV9fd3JhcHBlcicpO1xuICAgICQubGlzdCA9ICQucXVpY2tNZW51LnF1ZXJ5U2VsZWN0b3IoJy5icy1xdWljay1tZW51X19saXN0Jyk7XG4gICAgJC50b2dnbGUgPSAkLnF1aWNrTWVudS5xdWVyeVNlbGVjdG9yKCcuYnMtcXVpY2stbWVudV9fdG9nZ2xlJyk7XG4gICAgJC5pdGVtcyA9ICQubGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtcXVpY2stbWVudV9fbGluaycpO1xuXG5cbiAgICAvLyBDb25maWdcbiAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICBxdWlja01lbnVBY3RpdmU6IGZhbHNlLFxuICAgICAgICBxdWlja01lbnVBY3RpdmVDbGFzczogJ2JzLXF1aWNrLW1lbnUtLW9wZW4nLFxuICAgICAgICBxdWlja01lbnVQaW5lZENsYXNzOiAnYnMtcXVpY2stbWVudS0tcGluZWQnLFxuICAgICAgICBpdGVtQWN0aXZlQ2xhc3M6ICdicy1xdWljay1tZW51X19saW5rLS1hY3RpdmUnLFxuICAgICAgICBzY3JvbGxUb3BQb3NpdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICAgIH0sXG4gICAgICAgIHRvcFBvc2l0aW9uVG9GbG9hdDogMCxcbiAgICAgICAgc2Nyb2xsRGlyZWN0aW9uOiAwLFxuICAgICAgICBsYXN0U2Nyb2xsVG9wOiAwLFxuICAgICAgICBzbW9vdGhTY3JvbGxTdGVwczogMjUsXG4gICAgICAgIHNjcm9sbEFuY2hvckd1dHRlcjogODAsXG4gICAgICAgIGFuY2hvclNlbGVjdG9yOiAnc2VjdGlvbicsXG4gICAgICAgIGxhc3RTZWxlY3RlZEFuY2hvcjogbnVsbFxuICAgIH07XG5cbiAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBUb2dnbGUgcXVpY2tNZW51XG4gICAgICAgIGlmICgkLnRvZ2dsZSkgJC50b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVRdWlja01lbnUpO1xuXG4gICAgICAgIC8vIENsb3NlIHF1aWNrTWVudSBvbiBjbGljayBvdXRzaWRlXG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYm9keSwgaHRtbCcpLCBmdW5jdGlvbihlbCkge1xuICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgcXVpY2tNZW51QWN0aXZlKCkgJiZcbiAgICAgICAgICAgICAgICAgICAgISQucXVpY2tNZW51LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkgJiZcbiAgICAgICAgICAgICAgICAgICAgISQudG9nZ2xlLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VRdWlja01lbnUoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDbG9zZSBoZWFkZXIgb24gY2xpY2sgb3V0c2lkZVxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAvLyBGaXhhIG8gbWVudSBubyB0b3BvIGRhIHZpZXdwb3J0XG4gICAgICAgICAgICBzZXRQaW5lZCgpO1xuXG4gICAgICAgICAgICAvLyBFeGliZSBvIG1lbnUgYWJhaXhvIGRvIGhlYWRlciBxdWFuZG8gZXN0ZSBlc3TDoSB2aXPDrXZlbFxuICAgICAgICAgICAgaWYgKCFCc0hlYWRlci5pc0Zsb2F0aW5nKCkgfHwgQnNIZWFkZXIuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKEJzSGVhZGVyLmhlYWRlclBpbm5lZCkpIHtcbiAgICAgICAgICAgICAgICAkLmZsb2F0ZXIuc3R5bGUudG9wID0gQnNIZWFkZXIuZWwub2Zmc2V0SGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJC5mbG9hdGVyLnN0eWxlLnRvcCA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEF0aXZhIG8gaXRlbSBkZSBhY29yZG8gY29tIG8gc2Nyb2xsXG4gICAgICAgICAgICBzZXRBY3RpdmVJdGVtKGdldEFjdGl2ZUl0ZW0oKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENsaWNrIG1lbnUgYW5jaG9yc1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKCQuaXRlbXMsIGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgICAgICB2YXIgaGFzaCA9IGVsLmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIC8vIFByZXZpbmUgbyBjbGlxdWUgc2UgbyBoYXNoIGZvciB1bWEgw6JuY29yYSB2w6FsaWRhXG4gICAgICAgICAgICAgICAgaWYgKHZhbGlkQW5jaG9yKGhhc2gpKSBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIC8vIFJldG9ybmEgc2UgZm9yIGludsOhbGlkYSAobWFudMOpbSBvIGNsaXF1ZSBwYWRyw6NvKVxuICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgLy8gUmV0b3JuYSBzZSBuw6NvIGV4aXN0ZSB1bWEgw6JuY29yYSBuYSBww6FnaW5hIChJRCkgcmVmZXJlbnRlIGFvIGhhc2ggZG8gaXRlbVxuICAgICAgICAgICAgICAgIGlmICghZG9jdW1lbnQucXVlcnlTZWxlY3RvcihoYXNoKSkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgLy8gQ2hhbWEgYSBmdW7Dp8OjbyBwYXJhIHJvbGFyIGEgcMOhZ2luYSBhdMOpIGEgw6JuY29yYVxuICAgICAgICAgICAgICAgIGdvdG9BbmNob3IoZWwpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgdG9nZ2xlUXVpY2tNZW51ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghcXVpY2tNZW51QWN0aXZlKCkpIG9wZW5RdWlja01lbnUoKTtcbiAgICAgICAgZWxzZSBjbG9zZVF1aWNrTWVudSgpO1xuICAgIH07XG5cbiAgICB2YXIgb3BlblF1aWNrTWVudSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkLnF1aWNrTWVudS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5xdWlja01lbnVBY3RpdmVDbGFzcyk7XG4gICAgfTtcblxuICAgIHZhciBjbG9zZVF1aWNrTWVudSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkLnF1aWNrTWVudS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5xdWlja01lbnVBY3RpdmVDbGFzcyk7XG4gICAgfTtcblxuICAgIHZhciBxdWlja01lbnVBY3RpdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICQucXVpY2tNZW51LmNsYXNzTGlzdC5jb250YWlucyhjb25maWcucXVpY2tNZW51QWN0aXZlQ2xhc3MpO1xuICAgIH07XG5cbiAgICB2YXIgZ290b0FuY2hvciA9IGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgIHZhciBhbmNob3IgPSBlbC5nZXRBdHRyaWJ1dGUoJ2hyZWYnKTtcbiAgICAgICAgdmFyIGFuY2hvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFuY2hvcik7XG4gICAgICAgIHZhciBhbmNob3JQb3NpdGlvbiA9IGFuY2hvckVsZW1lbnQub2Zmc2V0VG9wO1xuICAgICAgICB2YXIgaW50ZXJ2YWwgPSAwO1xuICAgICAgICB2YXIgc2Nyb2xsRG93biA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpICsgY29uZmlnLnNtb290aFNjcm9sbFN0ZXBzKTtcbiAgICAgICAgICAgIGlmIChjb25maWcuc2Nyb2xsVG9wUG9zaXRpb24oKSA+IChhbmNob3JQb3NpdGlvbiAtIGNvbmZpZy5zY3JvbGxBbmNob3JHdXR0ZXIpKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHZhciBzY3JvbGxVcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpIC0gY29uZmlnLnNtb290aFNjcm9sbFN0ZXBzKTtcbiAgICAgICAgICAgIGlmIChjb25maWcuc2Nyb2xsVG9wUG9zaXRpb24oKSA8IChhbmNob3JQb3NpdGlvbiAtIGNvbmZpZy5zY3JvbGxBbmNob3JHdXR0ZXIpKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gRmVjaGEgYSBsaXN0YSBkbyBtZW51XG4gICAgICAgIGNsb3NlUXVpY2tNZW51KCk7XG5cbiAgICAgICAgLy8gU2Nyb2xsYSBhdMOpIGEgw6JuY29yYSBkbyBpdGVtIGNsaWNhZG9cbiAgICAgICAgLy8gU2UgYSDDom5jb3JhIGVzdMOhIGFiYWl4byBkYSBwb3Npw6fDo28gYXR1YWwgZGEgcMOhZ2luYVxuICAgICAgICBpZiAoY29uZmlnLnNjcm9sbFRvcFBvc2l0aW9uKCkgPCBhbmNob3JQb3NpdGlvbikge1xuICAgICAgICAgICAgaW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoc2Nyb2xsRG93biwgMik7XG4gICAgICAgICAgICAvLyBTZSBhIMOibmNvcmEgZXN0w6EgYWNpbWEgZGEgcG9zacOnw6NvIGF0dWFsIGRhIHDDoWdpbmFcbiAgICAgICAgfSBlbHNlIGlmIChjb25maWcuc2Nyb2xsVG9wUG9zaXRpb24oKSA+IGFuY2hvclBvc2l0aW9uKSB7XG4gICAgICAgICAgICBpbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbChzY3JvbGxVcCwgMik7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIHNldEFjdGl2ZUl0ZW0gPSBmdW5jdGlvbihhbmNob3IpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coYW5jaG9yKTtcblxuICAgICAgICBpZiAoYW5jaG9yID09PSBjb25maWcubGFzdFNlbGVjdGVkQW5jaG9yKSByZXR1cm47XG4gICAgICAgIGVsc2UgY29uZmlnLmxhc3RTZWxlY3RlZEFuY2hvciA9IGFuY2hvcjtcblxuICAgICAgICB2YXIgYW5jaG9ySGFzaCA9ICcjJyArIGFuY2hvci5nZXRBdHRyaWJ1dGUoJ2lkJyk7XG4gICAgICAgIHZhciBtZW51SXRlbSA9ICQubGlzdC5xdWVyeVNlbGVjdG9yKCdbaHJlZj1cIicgKyBhbmNob3JIYXNoICsgJ1wiXScpO1xuICAgICAgICB2YXIgdGl0bGUgPSBtZW51SXRlbS50ZXh0Q29udGVudDtcblxuICAgICAgICAvLyBkZWJ1Z2dlcjtcblxuXG4gICAgICAgIC8vIERlc2F0aXZhIGl0ZW0gYXRpdm8gYXR1YWxtZW50ZVxuICAgICAgICBpZiAoJC5saXN0LnF1ZXJ5U2VsZWN0b3IoJy4nICsgY29uZmlnLml0ZW1BY3RpdmVDbGFzcykpIHtcbiAgICAgICAgICAgICQubGlzdC5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5pdGVtQWN0aXZlQ2xhc3MpLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLml0ZW1BY3RpdmVDbGFzcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBdGl2YSBvIGl0ZW0gZGUgYWNvcmRvIGNvbSBhIHBvc2nDp8OjbyBhdHVhbFxuICAgICAgICBtZW51SXRlbS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pdGVtQWN0aXZlQ2xhc3MpO1xuXG4gICAgICAgIC8vIEFsdGVyYSBvIHRleHRvIGRvIGJvdMOjbyBkZSB0b2dnbGUgY29tIG8gdMOtdHVsbyBkbyBpdGVtIGNsaWNhZG9cbiAgICAgICAgJC50b2dnbGUuaW5uZXJUZXh0ID0gdGl0bGUudG9TdHJpbmcoKTtcblxuICAgICAgICAvLyBBbHRlcmEgbyBoYXNoIGRhIFVSTCBjb20gbyBoYXNoIGRhIMOibmNvcmEgY2xpY2FkYVxuICAgICAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZSh1bmRlZmluZWQsIHVuZGVmaW5lZCwgYW5jaG9ySGFzaCk7XG4gICAgfTtcblxuICAgIHZhciBnZXRBY3RpdmVJdGVtID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwb3NpdGlvbnMgPSBnZXRBbmNob3JzUG9zaXRpb24oKTtcbiAgICAgICAgdmFyIHNjcm9sbCA9IGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpO1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIHZhciBsZW5ndGggPSBwb3NpdGlvbnMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0cHV0ID0gMDtcblxuICAgICAgICAvLyBSZXR1cm4gYWN0aXZlIGVsZW1lbnQgYnkgb2Zmc2V0VG9wIHBvc2l0aW9uXG4gICAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGlmIChzY3JvbGwgPj0gKHBvc2l0aW9uc1tpXS50YXJnZXRQb3MgLSBjb25maWcuc2Nyb2xsQW5jaG9yR3V0dGVyKSkge1xuICAgICAgICAgICAgICAgIG91dHB1dCA9IHBvc2l0aW9uc1tpXS50YXJnZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZXR1cm4gZmlyc3QgaXRlbSBpZiBhbnkgaXMgcmV0dXJuZWQgZnJvbSBsb29waW5nIGFib3ZlXG4gICAgICAgIGlmICghb3V0cHV0KSBvdXRwdXQgPSBwb3NpdGlvbnNbMF0udGFyZ2V0O1xuXG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfTtcblxuICAgIHZhciBnZXRBbmNob3JzUG9zaXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHBvc2l0aW9ucyA9IFtdO1xuXG4gICAgICAgIC8vIEdlcmEgdW0gYXJyYXkgY29tIGFzIMOibmNvcmFzIGUgc3VhcyByZXNwZWN0aXZhcyBwb3Npw6fDtWVzXG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoJC5pdGVtcywgZnVuY3Rpb24oZWwsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgYW5jaG9yID0gZWwuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG4gICAgICAgICAgICB2YXIgYW5jaG9yRWxlbWVudDtcbiAgICAgICAgICAgIHZhciBhbmNob3JQb3NpdGlvbjtcblxuICAgICAgICAgICAgaWYgKCF2YWxpZEFuY2hvcihhbmNob3IpKSByZXR1cm47XG5cbiAgICAgICAgICAgIGFuY2hvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFuY2hvcik7XG4gICAgICAgICAgICBhbmNob3JQb3NpdGlvbiA9IGFuY2hvckVsZW1lbnQub2Zmc2V0VG9wO1xuXG4gICAgICAgICAgICBwb3NpdGlvbnNbaW5kZXhdID0ge1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5jaG9yRWxlbWVudCxcbiAgICAgICAgICAgICAgICB0YXJnZXRQb3M6IGFuY2hvclBvc2l0aW9uIC0gY29uZmlnLnNjcm9sbEFuY2hvckd1dHRlcixcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBwb3NpdGlvbnM7XG4gICAgfTtcblxuICAgIHZhciBzZXRQaW5lZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25maWcudG9wUG9zaXRpb25Ub0Zsb2F0ID0gJC5xdWlja01lbnUub2Zmc2V0VG9wIC0gcGFyc2VGbG9hdCgkLmZsb2F0ZXIuc3R5bGUudG9wKTtcbiAgICAgICAgaWYgKGNvbmZpZy5zY3JvbGxUb3BQb3NpdGlvbigpID4gY29uZmlnLnRvcFBvc2l0aW9uVG9GbG9hdCkge1xuICAgICAgICAgICAgJC5xdWlja01lbnUuY2xhc3NMaXN0LmFkZChjb25maWcucXVpY2tNZW51UGluZWRDbGFzcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkLnF1aWNrTWVudS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5xdWlja01lbnVQaW5lZENsYXNzKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8zODg5OTYvcmVnZXgtZm9yLWphdmFzY3JpcHQtdG8tYWxsb3ctb25seS1hbHBoYW51bWVyaWMvMzg5MDIyIzM4OTAyMlxuICAgIHZhciB2YWxpZEFuY2hvciA9IGZ1bmN0aW9uKHN0cikge1xuICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKC9eW2EtejAtOS1fXSsvKTtcbiAgICAgICAgdmFyIGlkID0gc3RyLnN1YnN0cmluZygxKTtcbiAgICAgICAgLy8gMTogaGFzICMgaW4gZmlyc3QgcG9zaXRpb24gKGlzIGFuIGludGVybmFsIGFuY2hvcilcbiAgICAgICAgcmV0dXJuIHN0ci5pbmRleE9mKCcjJykgPT09IDAgJiZcbiAgICAgICAgICAgIC8vIDI6IGhhcyBtb3JlIHRoYW4gMiBjaGFyYWN0ZXJzIChpcyBub3QgYW4gZW1wdHkgIyBsaW5rKVxuICAgICAgICAgICAgc3RyLmxlbmd0aCA+IDEgJiZcbiAgICAgICAgICAgIC8vIDM6IGhhcyBhbiBhbHBoYW51bWVyaWMgKHdpdGggZGFzaGVzIG9yIHVuZGVyc2NvcmVzKSBpZFxuICAgICAgICAgICAgcmVnZXgudGVzdChpZCk7XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGluaXQ6IGluaXQsXG4gICAgICAgIGdldEFjdGl2ZUl0ZW06IGdldEFjdGl2ZUl0ZW0sXG4gICAgICAgIHNldEFjdGl2ZUl0ZW06IHNldEFjdGl2ZUl0ZW0sXG4gICAgICAgIGdldEFuY2hvcnNQb3NpdGlvbjogZ2V0QW5jaG9yc1Bvc2l0aW9uLFxuICAgICAgICB2YWxpZEFuY2hvcjogdmFsaWRBbmNob3IsXG4gICAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBRdWlja01lbnUgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcbiAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXF1aWNrLW1lbnUtYW5jaG9yJykubGVuZ3RoKSB7XG4gICAgICAgIEJzUXVpY2tNZW51LmluaXQoKTtcbiAgICB9XG59KTtcbiIsIi8qKlxuICogTWVudSBjb20gRHJvcGRvd25cbiAqL1xudmFyIEJzTWQgPSAoZnVuY3Rpb24gKCkge1xuICAvLyBDb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBidXR0b25zOiB7XG4gICAgICBiYWNrOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtbWRfX2JhY2snKSxcbiAgICAgIGl0ZW06IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1tZF9fbWVudSAuYnMtbWRfX2l0ZW0nKSxcbiAgICAgIHRyaWdnZXJNZW51OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtbWQtdHJpZ2dlci1tZW51JyksXG4gICAgfSxcbiAgICBjbGFzc2VzOiB7XG4gICAgICBpdGVtU3VibWVudU9wZW46ICdicy1tZF9faXRlbS0tc3ViLW9wZW4nLFxuICAgICAgbWVudU9wZW46ICdicy1tZF9fbWVudS0tb3BlbicsXG4gICAgICBzb3J0YWJsZTogJ2JzLW1kX19tZW51LS1zb3J0YWJsZScsXG4gICAgICBzdWJTdWJtZW51T3BlbjogJ2JzLW1kX19tZW51LS1zdWItb3BlbicsXG4gICAgICB0cmlnZ2VyTWVudUFjdGl2ZTogJ2JzLW1kX19pdGVtLS1hY3RpdmUnLFxuICAgIH0sXG4gICAgY29udGFpbmVyOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtbWQnKSxcbiAgICBtZW51OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtbWRfX21lbnUnKSxcbiAgICB3cmFwcGVyOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtbWRfX3dyYXBwZXInKSxcbiAgICBzb3J0YWJsZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLW1kX19tZW51LmJzLW1kX19tZW51LS1zb3J0YWJsZScpLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIHZhciBmbGlja2l0eU9wdGlvbnNEZWZhdWx0cyA9IHtcbiAgICAvLyAgIGNvbnRhaW46IHRydWUsXG4gICAgLy8gICBwcmV2TmV4dEJ1dHRvbnM6IGZhbHNlLFxuICAgIC8vICAgcGFnZURvdHM6IGZhbHNlLFxuICAgIC8vICAgY2VsbEFsaWduOiAnbGVmdCcsXG4gICAgLy8gICBncm91cENlbGxzOiB0cnVlLFxuICAgIC8vICAgd2F0Y2hDU1M6IGZhbHNlLFxuICAgIC8vIH07XG4gICAgLy8gLy8gLSBFeGVjdXRhIGUgQXBsaWNhIFNldCBkZSBjb25maWd1cmHDp8O1ZXNcbiAgICAvLyB2YXIgZmxrdHkgPSBuZXcgRmxpY2tpdHkoIGNvbmZpZy53cmFwcGVyLCBmbGlja2l0eU9wdGlvbnNEZWZhdWx0cyApO1xuXG4gICAgLy8gUmVjYWxjdWxhIG8gcG9zaWNpb25hbWVudG8gZG8gbWVudVxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgX2NhbGNTdWJtZW51UG9zaXRpb24oKTtcbiAgICB9LCA1MDApO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIF9jYWxjU3VibWVudVBvc2l0aW9uKCk7XG4gICAgfSk7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgZnVuY3Rpb24gKCkge1xuICAgICAgX2Nsb3NlQWxsTWVudXMoKTtcbiAgICB9KTtcblxuICAgIGNvbmZpZy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgZnVuY3Rpb24gKCkge1xuICAgICAgX2Nsb3NlQWxsTWVudXMoKTtcbiAgICB9KTtcblxuICAgIF9pbml0U2hhZG93KCk7XG5cbiAgICBpZiAoY29uZmlnLmJ1dHRvbnMudHJpZ2dlck1lbnUpIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmJ1dHRvbnMudHJpZ2dlck1lbnUsIGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBfY2FsY1N1Ym1lbnVQb3NpdGlvbigpO1xuXG4gICAgICAgICAgdmFyIG1lbnUgPSBidXR0b24ucXVlcnlTZWxlY3RvcignLmJzLW1kX19tZW51Jyk7XG4gICAgICAgICAgdmFyIGlzTWVudU9wZW4gPSAobWVudS5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmNsYXNzZXMubWVudU9wZW4pKSA9PT0gdHJ1ZTtcblxuICAgICAgICAgIGlmIChpc01lbnVPcGVuICYmIG1lbnUpIHtcbiAgICAgICAgICAgIF9jbG9zZU1lbnUobWVudSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF9jbG9zZUFsbE1lbnVzKCk7XG4gICAgICAgICAgICBfb3Blbk1lbnUobWVudSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChjb25maWcuYnV0dG9ucy5pdGVtKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5idXR0b25zLml0ZW0sIGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgdmFyIHN1Ym1lbnUgPSBidXR0b24ucXVlcnlTZWxlY3RvcignLmJzLW1kX19zdWJtZW51Jyk7XG5cbiAgICAgICAgaWYgKHN1Ym1lbnUpIHtcbiAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgdmFyIHBhcmVudE1lbnUgPSBidXR0b24ucGFyZW50Tm9kZTtcblxuICAgICAgICAgICAgcGFyZW50TWVudS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jbGFzc2VzLnN1YlN1Ym1lbnVPcGVuKTtcbiAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jbGFzc2VzLml0ZW1TdWJtZW51T3Blbik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChjb25maWcuYnV0dG9ucy5iYWNrKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5idXR0b25zLmJhY2ssIGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgIHZhciBtZW51SXRlbSA9IGdldFBhcmVudHMoYnV0dG9uLCBjb25maWcuY2xhc3Nlcy5pdGVtU3VibWVudU9wZW4sIHRydWUpWzBdO1xuICAgICAgICAgIHZhciBtZW51ID0gZ2V0UGFyZW50cyhidXR0b24sIGNvbmZpZy5jbGFzc2VzLnN1YlN1Ym1lbnVPcGVuLCB0cnVlKVswXTtcblxuICAgICAgICAgIGlmIChtZW51SXRlbSkge1xuICAgICAgICAgICAgbWVudUl0ZW0uY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY2xhc3Nlcy5pdGVtU3VibWVudU9wZW4pO1xuICAgICAgICAgICAgbWVudS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLnN1YlN1Ym1lbnVPcGVuKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5zb3J0YWJsZSkge1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuc29ydGFibGUsIGZ1bmN0aW9uIChtZW51KSB7XG4gICAgICAgIGRyYWd1bGEoW21lbnVdLCB7XG4gICAgICAgICAgbW92ZXM6IGZ1bmN0aW9uIChlbCwgc291cmNlLCBoYW5kbGUsIHNpYmxpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiAoIWVsLmNsYXNzTGlzdC5jb250YWlucygnYnMtbWRfX2Zhdm9yaXRlJykpICYmIHRydWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuXG4gICAgfVxuXG4gICAgLy8gRmVjaGEgbyBtZW51IHF1YW5kbyBjbGljYXIgZm9yYSBkZWxlXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdib2R5LCBodG1sJyksIGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHZhciBwYXJlbnRNZW51ID0gZ2V0UGFyZW50KGV2ZW50LnRhcmdldCwgJ2JzLW1kX193cmFwcGVyJyk7XG4gICAgICAgIGlmICghcGFyZW50TWVudSkge1xuICAgICAgICAgIF9jbG9zZUFsbE1lbnVzKCk7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBDYWxjdWxhIGEgcG9zacOnw6NvIGVtIHF1ZSBvIHN1Ym1lbnUgZGV2ZSBhYnJpclxuICB2YXIgX2NhbGNTdWJtZW51UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG1lbnVzID0gY29uZmlnLm1lbnU7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKG1lbnVzLCBmdW5jdGlvbiAobWVudSkge1xuICAgICAgdmFyIGxlZnQgPSBtZW51LnBhcmVudE5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcbiAgICAgIHZhciB0b3AgPSBtZW51LnBhcmVudE5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tO1xuXG4gICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPj0gNTc2KSB7XG4gICAgICAgIG1lbnUuc3R5bGUubGVmdCA9IGxlZnQgKyAncHgnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gTm8gbW9iaWxlIG8gbWVudSDDqSAxMDAlLCBlbnTDo28gbsOjbyBkZXZlIHNlciBzZXRhZG8gYSBwb3Npw6fDo28gbGVmdFxuICAgICAgICBtZW51LnN0eWxlLnJlbW92ZVByb3BlcnR5KCdsZWZ0Jyk7XG4gICAgICB9XG4gICAgICBtZW51LnN0eWxlLnRvcCA9IHRvcCArICdweCc7XG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIF9vcGVuTWVudSA9IGZ1bmN0aW9uIChtZW51KSB7XG4gICAgbWVudS5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMudHJpZ2dlck1lbnVBY3RpdmUpO1xuICAgIG1lbnUuY2xhc3NMaXN0LmFkZChjb25maWcuY2xhc3Nlcy5tZW51T3Blbik7XG4gIH07XG5cbiAgdmFyIF9jbG9zZU1lbnUgPSBmdW5jdGlvbiAobWVudSkge1xuICAgIG1lbnUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLnRyaWdnZXJNZW51QWN0aXZlKTtcbiAgICBtZW51LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMubWVudU9wZW4pO1xuICB9O1xuXG4gIHZhciBfY2xvc2VBbGxNZW51cyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3BlbmVkTWVudXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGNvbmZpZy5jbGFzc2VzLm1lbnVPcGVuKTtcbiAgICB2YXIgb3BlbmVkU3VibWVudXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGNvbmZpZy5jbGFzc2VzLnN1YlN1Ym1lbnVPcGVuKTtcbiAgICB2YXIgb3BlbmVkSXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGNvbmZpZy5jbGFzc2VzLml0ZW1TdWJtZW51T3Blbik7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKG9wZW5lZE1lbnVzLCBmdW5jdGlvbiAobWVudSkge1xuICAgICAgbWVudS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLm1lbnVPcGVuKTtcbiAgICAgIG1lbnUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLnRyaWdnZXJNZW51QWN0aXZlKTtcbiAgICB9KTtcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwob3BlbmVkU3VibWVudXMsIGZ1bmN0aW9uIChzdWJtZW51KSB7XG4gICAgICBzdWJtZW51LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMuc3ViU3VibWVudU9wZW4pO1xuICAgIH0pO1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChvcGVuZWRJdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY2xhc3Nlcy5pdGVtU3VibWVudU9wZW4pO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBfaW5pdFNoYWRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2hhZG93U3RhcnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtbWRfX3NoYWRvdy0tc3RhcnQnKTtcbiAgICB2YXIgc2hhZG93RW5kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLW1kX19zaGFkb3ctLWVuZCcpO1xuXG4gICAgLyoqXG4gICAgICogRGVmaW5lIHNlIGFzIHNvbWJyYXMgZGV2ZW0gZXN0YXIgdmlzw612ZWlzXG4gICAgICogaHR0cHM6Ly9tYXJrdXMub2JlcmxlaG5lci5uZXQvYmxvZy9idWlsZGluZy1hLXJlc3BvbnNpdmUtcHJpb3JpdHktcGx1cy1ob3Jpem9udGFsLXNjcm9sbC1uYXZpZ2F0aW9uL1xuICAgICovXG4gICAgZnVuY3Rpb24gaGFuZGxlU2hhZG93VmlzaWJpbGl0eSgpIHtcbiAgICAgIHZhciBtYXhTY3JvbGxTdGFydFJlYWNoZWQgPSBjb25maWcud3JhcHBlci5zY3JvbGxMZWZ0IDw9IDA7XG4gICAgICB2YXIgbWF4U2Nyb2xsRW5kUmVhY2hlZCA9XG4gICAgICAgIGNvbmZpZy53cmFwcGVyLnNjcm9sbExlZnQgPj0gY29uZmlnLndyYXBwZXIuc2Nyb2xsV2lkdGggLSBjb25maWcud3JhcHBlci5vZmZzZXRXaWR0aCAtIDU7XG5cbiAgICAgIHRvZ2dsZVNoYWRvdyhzaGFkb3dTdGFydCwgbWF4U2Nyb2xsU3RhcnRSZWFjaGVkKTtcbiAgICAgIHRvZ2dsZVNoYWRvdyhzaGFkb3dFbmQsIG1heFNjcm9sbEVuZFJlYWNoZWQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4aWJlL29jdWx0YSBhcyBzb21icmFzXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbCBzb21icmFcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IG1heFNjcm9sbFJlYWNoZWQgYXRpbmdpdSBvIGxpbWl0ZSBkbyBzY3JvbGwgKGluw61jaW8gb3UgZmltKVxuICAgICovXG4gICAgZnVuY3Rpb24gdG9nZ2xlU2hhZG93KGVsLCBtYXhTY3JvbGxSZWFjaGVkKSB7XG4gICAgICB2YXIgc2hhZG93SXNWaXNpYmxlID0gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdpcy12aXNpYmxlJyk7XG4gICAgICB2YXIgc2hvd1NoYWRvdyA9ICFtYXhTY3JvbGxSZWFjaGVkICYmICFzaGFkb3dJc1Zpc2libGU7XG4gICAgICB2YXIgaGlkZVNoYWRvdyA9IG1heFNjcm9sbFJlYWNoZWQgJiYgc2hhZG93SXNWaXNpYmxlO1xuXG4gICAgICAvLyBVc2luZyByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgZm9yIG9wdGltYWwgc2Nyb2xsIHBlcmZvcm1hbmNlLlxuICAgICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzQ0Nzc5MzE2XG4gICAgICBpZiAoc2hvd1NoYWRvdykge1xuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHsgZWwuY2xhc3NMaXN0LmFkZCgnaXMtdmlzaWJsZScpOyB9KTtcbiAgICAgIH0gZWxzZSBpZiAoaGlkZVNoYWRvdykge1xuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHsgZWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtdmlzaWJsZScpOyB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25maWcud3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBoYW5kbGVTaGFkb3dWaXNpYmlsaXR5KCk7XG4gICAgfSk7XG5cbiAgICBoYW5kbGVTaGFkb3dWaXNpYmlsaXR5KCk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IE1lbnUgY29tIERyb3Bkb3duXG4gKiBAcmV0dXJuIHt2b2lkfSBCc01kLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1tZCcpLmxlbmd0aCkge1xuICAgIEJzTWQuaW5pdCgpO1xuICB9XG59KTtcblxuIiwiLyoqXG4gKiBSYWRpb1xuICogaHR0cHM6Ly9naXRodWIuY29tL21hdGVyaWFsLWNvbXBvbmVudHMvbWF0ZXJpYWwtY29tcG9uZW50cy13ZWIvdHJlZS9tYXN0ZXIvcGFja2FnZXMvbWRjLXNuYWNrYmFyXG4gKi9cbnZhciBCc1JhZGlvID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gQ29uZmlnXG4gIHZhciBidXR0b25SYWRpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1yYWRpbycpO1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIGJ1dHRvblJhZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlblBvcFVwLmJpbmQodGhpcywgJ3JhZGlvLmh0bWwnKSk7XG4gIH07XG5cbiAgdmFyIG9wZW5Qb3BVcCA9IGZ1bmN0aW9uKHVybCkge1xuICAgIHdpbmRvdy5vcGVuKHVybCwgJ19ibGFuaycsICdoZWlnaHQ9MTQwLGxvY2F0aW9uPXllcyx3aWR0aD00MDAsc2Nyb2xsYmFycz1ubyxzdGF0dXM9eWVzJyk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXRcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBCc1JhZGlvIGNvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBCc1JhZGlvLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1yYWRpbycpLmxlbmd0aCkge1xuICAgIEJzUmFkaW8uaW5pdCgpO1xuICB9XG59KTtcbiIsIi8qKlxuICogQnMgU2VhcmNoIEVtcHR5IDQwNFxuICpcbiAqL1xuXG52YXIgQnNTZWFyY2hFbXB0eSA9IChmdW5jdGlvbiAoKSB7XG4gIC8vIENvbmZpZ1xuICB2YXIgY29uZmlnID0ge1xuICAgIHRhZzogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXNlYXJjaC1lbXB0eV9fdGFnJyksXG4gICAgaXRlbXM6IFtdLFxuICAgIHJhbmRvbUl0ZW06ICcnLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcudGFnLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIGNvbmZpZy5pdGVtcy5wdXNoKGVsLnRleHRDb250ZW50KTtcbiAgICB9KTtcbiAgICByYW5kb20oKTtcbiAgfTtcblxuICB2YXIgcmFuZG9tID0gZnVuY3Rpb24gKCkge1xuICAgIHJhbmRvbUl0ZW0gPSBjb25maWcuaXRlbXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY29uZmlnLml0ZW1zLmxlbmd0aCApXTsgXG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy50YWcsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgdmFyIHRhZ0NvbnRlbnQgPSBlbC50ZXh0Q29udGVudDtcblxuICAgICAgaWYgKHJhbmRvbUl0ZW0gIT09IHRhZ0NvbnRlbnQpIHtcbiAgICAgICAgZWwucmVtb3ZlKCk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IFNlYXJjaCBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1zZWFyY2gtZW1wdHlfX3RhZycpLmxlbmd0aCkge1xuICAgIEJzU2VhcmNoRW1wdHkuaW5pdCgpO1xuICB9XG59KTtcbiIsIi8qKlxuICogQnMgU2VhcmNoXG4gKlxuICogW1RPRE9dOiBSZWZhdG9yYXIgcGFyYSBxdWUgb3MgZWxlbWVudG9zIGRvIGNvbmZpZyByZWZlcmVuY2llbSB1bSBjb21wb25lbnRlXG4gKiBzZWFyY2ggZXNwZWPDrWZpY28gYW8gaW52w6lzIGRlIHBlZ2FyIHRvZG9zIG9zIGV4aXN0ZW50ZXMgbm8gZG9jdW1lbnRvLlxuICovXG52YXIgQnNTZWFyY2hGb3JtID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gQ29uZmlnXG4gIHZhciBjb25maWcgPSB7XG4gICAgaHRtbDogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYm9keSwgaHRtbCcpLFxuICAgIGhlYWRlcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWhlYWRlcicpLFxuICAgIHNlYXJjaDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLXNlYXJjaCcpLFxuICAgIHNlYXJjaElucHV0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtc2VhcmNoLWlucHV0JyksXG4gICAgc2VhcmNoT3BlbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLW9wZW4tc2VhcmNoJyksXG4gICAgc2VhcmNoQ2xvc2U6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1jbG9zZS1zZWFyY2gnKSxcbiAgICBzZWFyY2hUb2dnbGU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy10b2dnbGUtc2VhcmNoJyksXG4gICAgc2VhcmNoSXNPcGVuOiBmYWxzZSxcbiAgICBzZWFyY2hJc09wZW5DbGFzczogJ2JzLXNlYXJjaC0tb3BlbicsXG4gICAgaGVhZGVyU2VhcmNoT3BlbkNsYXNzOiAnYnMtaGVhZGVyLS1zZWFyY2gtaXMtb3BlbicsXG4gIH07XG5cbiAgLy8gdmFyICQgPSBjb25maWc7XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gUmV0dXJuIGlmIG5vdCBleGlzdHMgc2VhcmNoIGNvbXBvbmVudFxuICAgIGlmICghY29uZmlnLnNlYXJjaCkgcmV0dXJuO1xuXG4gICAgLy8gT3BlbiBzdWdnZXN0aW9ucyBvbiBzZWFyY2ggaW5wdXQgZm9jdXNcbiAgICBpZiAoY29uZmlnLnNlYXJjaElucHV0KSB7XG4gICAgICBjb25maWcuc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIEJzU2VhcmNoU3VnZ2VzdGlvbnMub3BlbigpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgbG9hZFNlYXJjaFN1Z2dlc3Rpb25zKCk7XG5cbiAgICAvLyBUb2dnbGUgc2VhcmNoXG4gICAgaWYgKGNvbmZpZy5zZWFyY2hUb2dnbGUpIGNvbmZpZy5zZWFyY2hUb2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVTZWFyY2gpO1xuXG4gICAgLy8gT3BlbiBzZWFyY2hcbiAgICBpZiAoY29uZmlnLnNlYXJjaE9wZW4pIGNvbmZpZy5zZWFyY2hPcGVuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlblNlYXJjaCk7XG5cbiAgICAvLyBDbG9zZSBzZWFyY2hcbiAgICBpZiAoY29uZmlnLnNlYXJjaENsb3NlKSBjb25maWcuc2VhcmNoQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZVNlYXJjaCk7XG5cbiAgICAvLyBDbG9zZSBzZWFyY2ggb24gY2xpY2sgb3V0c2lkZVxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmh0bWwsIGZ1bmN0aW9uIChlbCkge1xuICAgIC8vIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2JvZHksIGh0bWwnKS5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIHNlYXJjaElzT3BlbigpICYmXG4gICAgICAgICAgIWNvbmZpZy5zZWFyY2guY29udGFpbnMoZXZlbnQudGFyZ2V0KSAmJlxuICAgICAgICAgICFjb25maWcuc2VhcmNoVG9nZ2xlLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICBjbG9zZVNlYXJjaCgpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIHRvZ2dsZVNlYXJjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXNlYXJjaElzT3BlbigpKSBvcGVuU2VhcmNoKCk7XG4gICAgZWxzZSBjbG9zZVNlYXJjaCgpO1xuICB9O1xuXG4gIHZhciBvcGVuU2VhcmNoID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChjb25maWcuc2VhcmNoKSB7XG4gICAgICBjb25maWcuc2VhcmNoLmNsYXNzTGlzdC5hZGQoY29uZmlnLnNlYXJjaElzT3BlbkNsYXNzKTtcbiAgICAgIGNvbmZpZy5oZWFkZXIuY2xhc3NMaXN0LmFkZChjb25maWcuaGVhZGVyU2VhcmNoT3BlbkNsYXNzKTtcbiAgICAgIEJzSGVhZGVyLnNldEhlYWRlckZsb2F0aW5nKHRydWUpO1xuICAgICAgdG9nZ2xlQm9keU92ZXJmbG93SGlkZGVuKCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBjbG9zZVNlYXJjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoY29uZmlnLnNlYXJjaCkge1xuICAgICAgY29uZmlnLnNlYXJjaC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5zZWFyY2hJc09wZW5DbGFzcyk7XG4gICAgICBjb25maWcuaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmhlYWRlclNlYXJjaE9wZW5DbGFzcyk7XG4gICAgICB0b2dnbGVCb2R5T3ZlcmZsb3dIaWRkZW4oKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIHNlYXJjaElzT3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIWNvbmZpZy5zZWFyY2gpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gY29uZmlnLnNlYXJjaC5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLnNlYXJjaElzT3BlbkNsYXNzKTtcbiAgfTtcblxuICB2YXIgc2VhcmNoSGFzRm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IGNvbmZpZy5zZWFyY2hJbnB1dDtcbiAgfTtcblxuICB2YXIgbG9hZFNlYXJjaFN1Z2dlc3Rpb25zID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzdWdnZXN0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1zZWFyY2gtc3VnZ2VzdGlvbnMnKTtcbiAgICBjb25maWcuc3VnZ2VzdGlvbnMgPSBbXTtcblxuICAgIGlmIChzdWdnZXN0aW9ucyAmJiBzdWdnZXN0aW9ucy5sZW5ndGgpIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoc3VnZ2VzdGlvbnMsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICB2YXIgc3VnZ2VzdGlvbiA9IG5ldyBCc1NlYXJjaFN1Z2dlc3Rpb25zKGVsLCB7XG4gICAgICAgICAgY29udGVudENsYXNzZXM6IFtcbiAgICAgICAgICAgICdicy1zZWFyY2gtc3VnZ2VzdGlvbnNfX3Rlcm0nLFxuICAgICAgICAgICAgJ2JzLXNlYXJjaC1zdWdnZXN0aW9uc19fbG9jYXRpb24nLFxuICAgICAgICAgIF0sXG4gICAgICAgICAgbWF4SXRlbXM6IDgsXG4gICAgICAgICAgZGVmYXVsdFRpdGxlOiAnTWFpcyBCdXNjYWRvcycsXG4gICAgICAgICAgZGVmYXVsdExpc3Q6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgbGluazogJyMhJyxcbiAgICAgICAgICAgICAgY29udGVudDogW1xuICAgICAgICAgICAgICAgICdMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCcsXG4gICAgICAgICAgICAgICAgJ2lydXJlIGRvbG9yJyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IFtcbiAgICAgICAgICAgICAgICAnY29uc2VjdGV0dXIgYWRpcGlzaWNpbmcgZWxpdCcsXG4gICAgICAgICAgICAgICAgJ2luIHJlcHJlaGVuZGVyaXQnLFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgbGluazogJyMhJyxcbiAgICAgICAgICAgICAgY29udGVudDogW1xuICAgICAgICAgICAgICAgICdzZWQgZG8gZWl1c21vZCB0ZW1wb3IgaW5jaWRpZHVudCcsXG4gICAgICAgICAgICAgICAgJ3ZvbHVwdGF0ZSB2ZWxpdCcsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBsaW5rOiAnIyEnLFxuICAgICAgICAgICAgICBjb250ZW50OiBbXG4gICAgICAgICAgICAgICAgJ3V0IGxhYm9yZSBldCBkb2xvcmUgbWFnbmEgYWxpcXVhJyxcbiAgICAgICAgICAgICAgICAnZXNzZSBjaWxsdW0gZG9sb3JlJyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IFtcbiAgICAgICAgICAgICAgICAnVXQgZW5pbSBhZCBtaW5pbSB2ZW5pYW0nLFxuICAgICAgICAgICAgICAgICdldSBmdWdpYXQgbnVsbGEnLFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgbGluazogJyMhJyxcbiAgICAgICAgICAgICAgY29udGVudDogW1xuICAgICAgICAgICAgICAgICdxdWlzIG5vc3RydWQgZXhlcmNpdGF0aW9uIHVsbGFtY28nLFxuICAgICAgICAgICAgICAgICdleGNlcHRldXIgc2ludCBvY2NhZWNhdCcsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBsaW5rOiAnIyEnLFxuICAgICAgICAgICAgICBjb250ZW50OiBbXG4gICAgICAgICAgICAgICAgJ2xhYm9yaXMgbmlzaSB1dCBhbGlxdWlwIGV4IGVhJyxcbiAgICAgICAgICAgICAgICAnY3VwaWRhdGF0IG5vbiBwcm9pZGVudCcsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBsaW5rOiAnIyEnLFxuICAgICAgICAgICAgICBjb250ZW50OiBbXG4gICAgICAgICAgICAgICAgJ2NvbW1vZG8gY29uc2VxdWF0LiBEdWlzIGF1dGUnLFxuICAgICAgICAgICAgICAgICdxdWkgb2ZmaWNpYSBkZXNlcnVudCcsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF0sXG4gICAgICAgICAgc3VnZ2VzdGlvbnNMaXN0OiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IFtcbiAgICAgICAgICAgICAgICAnTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQnLFxuICAgICAgICAgICAgICAgICdpcnVyZSBkb2xvcicsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBsaW5rOiAnIyEnLFxuICAgICAgICAgICAgICBjb250ZW50OiBbXG4gICAgICAgICAgICAgICAgJ2NvbnNlY3RldHVyIGFkaXBpc2ljaW5nIGVsaXQnLFxuICAgICAgICAgICAgICAgICdpbiByZXByZWhlbmRlcml0JyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IFtcbiAgICAgICAgICAgICAgICAnc2VkIGRvIGVpdXNtb2QgdGVtcG9yIGluY2lkaWR1bnQnLFxuICAgICAgICAgICAgICAgICd2b2x1cHRhdGUgdmVsaXQnLFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgbGluazogJyMhJyxcbiAgICAgICAgICAgICAgY29udGVudDogW1xuICAgICAgICAgICAgICAgICd1dCBsYWJvcmUgZXQgZG9sb3JlIG1hZ25hIGFsaXF1YScsXG4gICAgICAgICAgICAgICAgJ2Vzc2UgY2lsbHVtIGRvbG9yZScsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBsaW5rOiAnIyEnLFxuICAgICAgICAgICAgICBjb250ZW50OiBbXG4gICAgICAgICAgICAgICAgJ1V0IGVuaW0gYWQgbWluaW0gdmVuaWFtJyxcbiAgICAgICAgICAgICAgICAnZXUgZnVnaWF0IG51bGxhJyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IFtcbiAgICAgICAgICAgICAgICAncXVpcyBub3N0cnVkIGV4ZXJjaXRhdGlvbiB1bGxhbWNvJyxcbiAgICAgICAgICAgICAgICAnZXhjZXB0ZXVyIHNpbnQgb2NjYWVjYXQnLFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgbGluazogJyMhJyxcbiAgICAgICAgICAgICAgY29udGVudDogW1xuICAgICAgICAgICAgICAgICdsYWJvcmlzIG5pc2kgdXQgYWxpcXVpcCBleCBlYScsXG4gICAgICAgICAgICAgICAgJ2N1cGlkYXRhdCBub24gcHJvaWRlbnQnLFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgbGluazogJyMhJyxcbiAgICAgICAgICAgICAgY29udGVudDogW1xuICAgICAgICAgICAgICAgICdjb21tb2RvIGNvbnNlcXVhdC4gRHVpcyBhdXRlJyxcbiAgICAgICAgICAgICAgICAncXVpIG9mZmljaWEgZGVzZXJ1bnQnLFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9KTtcbiAgICAgICAgc3VnZ2VzdGlvbi5pbml0KCk7XG4gICAgICAgIGNvbmZpZy5zdWdnZXN0aW9ucy5wdXNoKHN1Z2dlc3Rpb24pO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICAgIHRvZ2dsZTogdG9nZ2xlU2VhcmNoLFxuICAgIG9wZW46IG9wZW5TZWFyY2gsXG4gICAgY2xvc2U6IGNsb3NlU2VhcmNoLFxuICAgIGlzT3Blbjogc2VhcmNoSXNPcGVuLFxuICAgIGhhc0ZvY3VzOiBzZWFyY2hIYXNGb2N1cyxcbiAgICBpc0FjdGl2ZTogc2VhcmNoSXNPcGVuLCAvLyBkZXByZWNhdGVkXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgU2VhcmNoIENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXNlYXJjaCcpLmxlbmd0aCkge1xuICAgIEJzU2VhcmNoRm9ybS5pbml0KCk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBBVElWQVIgbyBTRUFSQ0ggYXBsaWNhciBuYSBzZWN0aW9uIGEgY2xhc3NlXG4gKiAtLS0gYnMtaGVscC1zZWFyY2ggLS0tLS1cbiAqIEFESUNJT05BUiBNRU5TQUdFTSBWQVpJTyBkZW50cm8gZGUgc2VjdGlvblxuICogLS0tLSBicy1oZWxwLXNlYXJjaF9fc2VhcmNoLWVtcHR5IC0tLS1cbiAqIE9SR0FOSVpBUiBDw5NEIGNhc28gdXRpbGl6ZVxuKi9cblxudmFyIEJzU2VyYWNoSGVscCA9IChmdW5jdGlvbigpIHtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIC8qIFNlbGVjdCB0aGUgaW5wdXQgd2hlcmUgdGhlIGtleXdvcmRzIHdpbGwgYmUgcmV0cmlldmVkICovXG4gICAgdmFyIHNlYXJjaGJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2JzLWhlbHAtc2VhcmNoX19pbnB1dCcpWzBdO1xuXG4gICAgLyogVG8gZXZlcnkga2V5IHByZXNzZWQgYW5kIHJlbGVhc2VkICovXG4gICAgc2VhcmNoYm94Lm9ua2V5dXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAvKipcbiAgICAgICogVGhpcyB3aWxsIGZpeCBhIHNpbXBsZSBwcm9ibGVtOiBXaGVuIHRoZSBzZWFyY2ggaW5wdXQgaXMgZW1wdHkgYWZ0ZXJcbiAgICAgICogdHJ5aW5nIHRvIGZpbmQgYSBrZXl3b3JkLCBpdCBzZWxlY3RzIGFsbCB0aGUgZWxlbWVudHMgYW5kIGhpZ2hsaWdodFxuICAgICAgKi9cbiAgICAgIHZhciBrZXl3b3JkcyA9IHNlYXJjaGJveC52YWx1ZS50cmltKCkubGVuZ3RoID4gMCA/IG5ldyBSZWdFeHAoc2VhcmNoYm94LnZhbHVlLnRyaW0oKSwgXCJnaVwiKSA6ICcnO1xuXG4gICAgICAvKiBEZWZpbmUgdGhlIHBvc3RUaXRsZXMgd2hlcmUgdGhlIHNlYXJjaCB3aWxsIHJ1biAqL1xuICAgICAgLy8tIHZhciBwb3N0VGl0bGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncG9zdF9fdGl0bGUnKTtcblxuICAgICAgdmFyIHNlbGVjdExpc3Q9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1tZWRpYV9faXRlbSwuYnMtYWNjb3JkaW9uX19pdGVtLCBicy1tZWRpYV9faXRlbScpO1xuXG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHNlbGVjdExpc3QsIGZ1bmN0aW9uIChlbCkge1xuICAgICAgICB2YXIgdmFsTGlzdCA9IGVsIC8vLSBFYXNpZXIgdG8gcmVhZFxuICAgICAgICB2YXIgYXR0clRleHQgPSB2YWxMaXN0LnRleHRDb250ZW50O1xuICAgICAgICAvLy0gdmFyIGF0dHJUYWcgPSB2YWxMaXN0LmdldEF0dHJpYnV0ZSgnZGF0YS1maWx0ZXItdGFnJyk7XG4gICAgICAgIC8vLSB2YXIga2V5ID0gYXR0clRleHQuY29uY2F0KGF0dHJUYWcpXG4gICAgICAgIFxuICAgICAgICAvLy0gIElmIHZhbCBhdHJpYnV0ZSBkYXRhLWZpbHRlci10YWcgZXF1YWwga2V5IHF1ZXJ5XG4gICAgICAgIGlmICgoYXR0clRleHQubWF0Y2goa2V5d29yZHMpKSAmJiBrZXl3b3JkcyAhPT0gJycpIHtcbiAgICAgICAgICAvLy0gSWYgdGhlIGVsZW1lbnQgZG9uJ3QgaGF2ZSB0aGUgYWN0aXZlIGNsYXNzLCBpdCB3aWxsIGFkZCBvbmVcbiAgICAgICAgICBpZiAoIXZhbExpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdicy1oZWxwLXNlYXJjaF9faGlnaGxpZ2h0JykpIHtcbiAgICAgICAgICAgIHZhbExpc3QuY2xhc3NMaXN0LnJlbW92ZSgnYnMtaGVscC1zZWFyY2hfX3JlbW92ZS1oaWdobGlnaHQnKTtcbiAgICAgICAgICAgIHZhbExpc3QuY2xhc3NMaXN0LmFkZCgnYnMtaGVscC1zZWFyY2hfX2hpZ2hsaWdodCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLy0gUmVtb3ZlIGFjdGl2ZSBhbmQgYWRkIHJlbW92ZSBmcm9tIGxpc3QgXG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHZhbExpc3QuY2xhc3NMaXN0LnJlbW92ZSgnYnMtaGVscC1zZWFyY2hfX2hpZ2hsaWdodCcpO1xuICAgICAgICAgIHZhbExpc3QuY2xhc3NMaXN0LmFkZCgnYnMtaGVscC1zZWFyY2hfX3JlbW92ZS1oaWdobGlnaHQnKTtcblxuICAgICAgICAgIGlmIChrZXl3b3JkcyA9PT0gJycpIHtcbiAgICAgICAgICAgIHZhbExpc3QuY2xhc3NMaXN0LnJlbW92ZSgnYnMtaGVscC1zZWFyY2hfX3JlbW92ZS1oaWdobGlnaHQnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBDYXB0dXJlIGFsbCBzZWN0aW9ucyBvbiB0aGUgcGFnZVxuICAgICAgdmFyIHNlYXJjaExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtaGVscC1zZWFyY2gnKTtcblxuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChzZWFyY2hMaXN0LCBmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgIC8vIGlmIHNlY3Rpb24gYmVsb25ncyBzZWFyY2ggZm9yIGVsZW1lbnRzXG4gICAgICAgIHZhciBhY3RpdmVGYWxzZSA9IGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnMtaGVscC1zZWFyY2hfX2hpZ2hsaWdodCcpO1xuICAgICAgICB2YXIgbWVzc2FnZSA9IGUucXVlcnlTZWxlY3RvcignLmJzLWhlbHAtc2VhcmNoX19zZWFyY2gtZW1wdHknKTtcblxuICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyBhY3RpdmUgcmV0dXJuIHdoaWxlIHNlYXJjaCByZXR1cm5zIGFjdGl2ZVxuICAgICAgICBpZiAoYWN0aXZlRmFsc2UubGVuZ3RoIDwgMSAmJiBrZXl3b3JkcyAhPT0gJycpIHtcbiAgICAgICAgICBtZXNzYWdlLmNsYXNzTGlzdC5hZGQoJ2JzLWFjdGl2ZScpO1xuICAgICAgICAgIC8vLSBkZWJ1Z2dlciBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtZXNzYWdlLmNsYXNzTGlzdC5yZW1vdmUoJ2JzLWFjdGl2ZScpO1xuICAgICAgICB9O1xuXG4gICAgICB9KTtcbiAgICB9O1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdFxuICB9O1xuXG59KSgpO1xuXG4vKipcbiAqIEluaXQgUXVpY2tNZW51IENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtaGVscC1zZWFyY2gnKS5sZW5ndGgpIHtcbiAgICBCc1NlcmFjaEhlbHAuaW5pdCgpO1xuICB9XG59KTsiLCIvKipcbiAqIEJzIFNlYXJjaCBTdWdnZXN0aW9uc1xuICogQSBsaXN0IG9mIHN1Z2dlc3Rpb25zIHRlcm1zIHRvIHNob3cgd2hlbiBzZWFyY2ggaW5wdXQgaGFzIGZvY3VzXG4gKlxuICogQHBhcmFtICB7c3RyaW5nfSBlbGVtZW50IHF1ZXJ5IG9mIGEgRE9NIGVsZW1lbnRcbiAqIEBwYXJhbSAge09iamVjdH0gb3B0aW9ucyBvdmVyd3JpdGUgZGVmYXVsdCBjb25maWdcbiAqIEByZXR1cm4ge0Z1bmN0aW9ufVxuICovXG5cbnZhciBCc1NlYXJjaFN1Z2dlc3Rpb25zID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgLy8gQ29uZmlnXG4gIHZhciBlbGVtID0gZWxlbWVudDtcbiAgdmFyIG9wdCA9ICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ29iamVjdCcpID8gb3B0aW9ucyA6IHt9O1xuICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgLy8gc2VhcmNoIGlucHV0XG4gICAgc2VhcmNoOiAnLmJzLWpzLXNlYXJjaC1pbnB1dCcsXG4gICAgLy8gc3VnZ2VzdGlvbnMgYm94XG4gICAgc3VnZ2VzdGlvbnM6ICcuYnMtanMtc2VhcmNoLXN1Z2dlc3Rpb25zJyxcbiAgICAvLyBzdWdnZXN0aW9ucyBsaXN0XG4gICAgbGlzdDogJy5icy1zZWFyY2gtc3VnZ2VzdGlvbnNfX2xpc3QnLFxuICAgIC8vIGNsYXNzIHRvIHNldCBvcGVuIHN1Z2dlc3Rpb25zXG4gICAgc3VnZ2VzdGlvbnNBY3RpdmVDbGFzczogJ2JzLXNlYXJjaC1zdWdnZXN0aW9ucy0tb3BlbicsXG4gICAgLy8gY2xhc3MgdG8gYWRkIGxvYWRpbmcgZ2lmIGluIGxpc3RcbiAgICBzdWdnZXN0aW9uc0xvYWRpbmdDbGFzczogJ2JzLXNlYXJjaC1zdWdnZXN0aW9ucy0tbG9hZGluZycsXG4gICAgLy8gY2xhc3Mgb2YgaXRlbVxuICAgIGxpc3RUaXRsZUNsYXNzOiAnYnMtc2VhcmNoLXN1Z2dlc3Rpb25zX190aXRsZScsXG4gICAgLy8gY2xhc3Mgb2YgaXRlbVxuICAgIGl0ZW1DbGFzczogJ2JzLXNlYXJjaC1zdWdnZXN0aW9uc19faXRlbScsXG4gICAgLy8gY2xhc3MgdG8gc2V0IGFuIGl0ZW0gYXMgYWN0aXZlLCB3aGVuIHNlbGVjdGVkIGJ5IGtleWJvYXJkIGFycm93cyB1cC9kb3duXG4gICAgaXRlbXNBY3RpdmVDbGFzczogJ2JzLXNlYXJjaC1zdWdnZXN0aW9uc19faXRlbS0tYWN0aXZlJyxcbiAgICAvLyBjbGFzcyBvZiBsaW5rXG4gICAgaXRlbUxpbmtDbGFzczogJ2JzLXNlYXJjaC1zdWdnZXN0aW9uc19fbGluaycsXG4gICAgLy8gY2xhc3Mgb2YgdGVybVxuICAgIGl0ZW1UZXJtQ2xhc3M6ICdicy1zZWFyY2gtc3VnZ2VzdGlvbnNfX3Rlcm0nLFxuICAgIC8vIGNsYXNzIG9mIHRlcm0gdHlwZWRcbiAgICBpdGVtVGVybVR5cGVkQ2xhc3M6ICdicy1zZWFyY2gtc3VnZ2VzdGlvbnNfX3Rlcm0tdHlwZWQnLFxuICAgIC8vIGNsYXNzIG9mIGxvY2F0aW9uXG4gICAgaXRlbUxvY2F0aW9uQ2xhc3M6ICdicy1zZWFyY2gtc3VnZ2VzdGlvbnNfX2xvY2F0aW9uJyxcbiAgICAvLyBjb250ZW50Q2xhc3Nlc1xuICAgIGNvbnRlbnRDbGFzc2VzOiBbXSxcbiAgICAvLyBtYXhpbXVtIGxpbWl0IG9mIGl0ZW1zIGluIHRoZSBsaXN0XG4gICAgbWF4SXRlbXM6IDAsXG4gICAgLy8gc3RvcmVzIHRoZSBjdXJyZW50IGFjdGl2ZSBpdGVtXG4gICAgY3VycmVudEFjdGl2ZUl0ZW06ICcnLFxuICAgIC8vIHN0b3JlcyB0aGUgc2VhcmNoIGlucHV0IHZhbHVlIHR5cGVkXG4gICAgLy8gdGhlIGlucHV0IHZhbHVlJ3MgY2hhbmdlIGR1cmluZyBrZXlib2FyZCBhcnJvd3MgbmF2aWdhdGlvbiwgYnV0IG5lZWQgdG9cbiAgICAvLyBiYWNrIHRvIHRoZSB2YWx1ZSB0eXBlZCBwcmV2aW91c2x5XG4gICAgc2VhcmNoVGVybTogJycsXG4gICAgLy8gc2V0IHRoZSB1cGRhdGUgZnVuY3Rpb24gdGhhdCByZWJ1aWxkIGxpc3Qgb24gdHlwZVxuICAgIC8vIGJ5IGRlZmF1bHQsIHVzZXMgdGhlIHVwZGF0ZUxpc3QoKSBmdW5jdGlvblxuICAgIHVwZGF0ZUxpc3Q6IGZ1bmN0aW9uIChsaXN0KSB7XG4gICAgICByZXR1cm4gdXBkYXRlTGlzdChsaXN0KTtcbiAgICB9LFxuICAgIC8vIGRlZmF1bHQgdGl0bGVcbiAgICAvLyBkaXNwbGF5ZWQgd2hlbiBzZWFyY2ggaW5wdXQgaGFzIGZvY3VzIGJ1dCBubyB2YWx1ZVxuICAgIGRlZmF1bHRUaXRsZTogJycsXG4gICAgLy8gZGVmYXVsdCBsaXN0XG4gICAgLy8gZGlzcGxheWVkIHdoZW4gc2VhcmNoIGlucHV0IGhhcyBmb2N1cyBidXQgbm8gdmFsdWVcbiAgICBkZWZhdWx0TGlzdDogW10sXG4gICAgLy8gdGl0bGUgZGlzcGxheWVkIHdpdGhpbiBkaW5hbWljIHN1Z2dlc3Rpb24gbGlzdFxuICAgIHN1Z2dlc3Rpb25zVGl0bGU6ICcnLFxuICAgIC8vIGxpc3QgZmlsdGVyZWQgYW5kIGRpc3BsYXllZCBkdXJpbmcgdHlwZSBvbiBzZWFyY2ggaW5wdXRcbiAgICBzdWdnZXN0aW9uc0xpc3Q6IFtdLFxuICAgIG9uQnVpbGRMaXN0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBjb25zb2xlLmxvZygnbGlzdCBoYXMgYnVpbGRlZCcpO1xuICAgIH0sXG4gIH07XG4gIHZhciBjb25maWcgPSB7fTtcblxuICB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuXG4gICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7XG4gICAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0YXJnZXQ7XG4gIH07XG5cbiAgLyoqXG4gICAqIEluaXQgdGhlIGNvbXBvbmVudFxuICAgKiBAcGFyYW0gIHtPYmplY3R9IG9wdGlvbnMgb3B0aW9ucyBmb3IgdGhlIGNvbnRlbnRcbiAgICovXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIERlZmluZSBvcHRpb25zXG4gICAgY29uZmlnID0gZXh0ZW5kKHt9LCBkZWZhdWx0cywgb3B0KTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjbG9zZVN1Z2dlc3Rpb25zKCk7XG4gICAgfSk7XG5cbiAgICAvLyBQcmV2aW5lIHF1ZSBhbyByZWNhcnJlZ2FyIGEgcMOhZ2luYSB0cmFnYSBvIHZhbG9yIGRvIGlucHV0IHByZWVuY2hpZG9cbiAgICBpZiAoZGV0ZWN0SUUoKSkge1xuICAgICAgdmFyIHNlYXJjaElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc2VhcmNoKTtcbiAgICAgIGlmIChzZWFyY2hJbnB1dCkgc2VhcmNoSW5wdXQudmFsdWUgPSAnJztcbiAgICB9XG5cbiAgICBjb25maWcuYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2JvZHksIGh0bWwnKTtcbiAgICBjb25maWcuc2VhcmNoID0gKHR5cGVvZiBjb25maWcuc2VhcmNoID09PSAnc3RyaW5nJykgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zZWFyY2gpIDogY29uZmlnLnNlYXJjaDtcbiAgICBjb25maWcuc3VnZ2VzdGlvbnMgPSAodHlwZW9mIGVsZW0gPT09ICdzdHJpbmcnKSA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbSkgOiBlbGVtO1xuICAgIGNvbmZpZy5saXN0ID0gY29uZmlnLnN1Z2dlc3Rpb25zLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLmxpc3QpO1xuXG4gICAgLy8gUmV0dXJuIGlmIG5vdCBleGlzdHMgc2VhcmNoIGNvbXBvbmVudFxuICAgIGlmICghY29uZmlnLnN1Z2dlc3Rpb25zIHx8ICFjb25maWcuc2VhcmNoKSByZXR1cm47XG5cbiAgICAvLyBzZXQgZnVuY3Rpb24gdG8gdXBkYXRlIGxpc3RcbiAgICBzZXRDdXN0b21VcGRhdGUoY29uZmlnLnN1Z2dlc3Rpb25zTGlzdCk7XG5cbiAgICAvLyBPcGVuIHN1Z2dlc3Rpb25zXG4gICAgaWYgKGNvbmZpZy5zZWFyY2gpIGNvbmZpZy5zZWFyY2guYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCBvcGVuU3VnZ2VzdGlvbnMpO1xuXG4gICAgLy8gQ2xvc2Ugc3VnZ2VzdGlvbnNcbiAgICAvLyBTaG91bGQgY2xvc2Ugb25seSBpbiBjbGljayBvdXRzaWRlXG4gICAgLy8gaWYgKGNvbmZpZy5zZWFyY2gpIGNvbmZpZy5zZWFyY2guYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGNsb3NlU3VnZ2VzdGlvbnMpO1xuXG4gICAgLy8gQnVpbGQgZGVmYXVsdCBsaXN0XG4gICAgYnVpbGRMaXN0KCk7XG5cbiAgICAvLyBVbnNlbGVjdCBpdGVtcyBvbiBzZWFyY2ggaW5wdXQgYmx1clxuICAgIGlmIChjb25maWcuc2VhcmNoKSBjb25maWcuc2VhcmNoLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBkaXNhYmxlSXRlbUFjdGl2ZSk7XG5cbiAgICAvLyBDbG9zZSBzZWFyY2ggb24gY2xpY2sgb3V0c2lkZVxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLmJvZHksIGZ1bmN0aW9uIChlbCkge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIHN1Z2dlc3Rpb25zSXNPcGVuKCkgJiZcbiAgICAgICAgICAhY29uZmlnLnN1Z2dlc3Rpb25zLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkgJiZcbiAgICAgICAgICAhY29uZmlnLnNlYXJjaC5jb250YWlucyhldmVudC50YXJnZXQpKSB7XG4gICAgICAgICAgY2xvc2VTdWdnZXN0aW9ucygpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBPbiBzZWFyY2ggaW5wdXQga2V5Ym9hcmQgZXZlbnRzXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgdmFyIGtleVVwID0gZXZlbnQua2V5Q29kZSA9PT0gMzg7XG4gICAgICB2YXIga2V5RG93biA9IGV2ZW50LmtleUNvZGUgPT09IDQwO1xuICAgICAgdmFyIGtleVRhYiA9IGV2ZW50LmtleUNvZGUgPT09IDk7XG4gICAgICAvLyB2YXIga2V5RW50ZXIgPSBldmVudC5rZXlDb2RlID09PSAxMztcbiAgICAgIC8vIHZhciBrZXlFc2MgPSBldmVudC5rZXlDb2RlID09PSAyNztcbiAgICAgIHZhciBpdGVtcyA9IGNvbmZpZy5saXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgY29uZmlnLml0ZW1DbGFzcyk7XG4gICAgICB2YXIgaXRlbUFjdGl2ZSA9IGdldEl0ZW1BY3RpdmUoKTtcbiAgICAgIHZhciBpdGVtQWN0aXZlSW5kZXggPSAoaXRlbUFjdGl2ZSkgP1xuICAgICAgICBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGl0ZW1zLCBpdGVtQWN0aXZlKSA6IC0xO1xuXG4gICAgICAvLyBSdW4gb25seSBpZiBzZWFyY2ggc3VnZ2VzdGlvbnMgaXMgb3BlblxuICAgICAgaWYgKCFzdWdnZXN0aW9uc0lzT3BlbigpIHx8ICFpdGVtcy5sZW5ndGgpIHJldHVybjtcblxuICAgICAgLy8gSWYgdGFiIGlzIHByZXNzZWQsIENsb3NlIHN1Z2dlc3Rpb25zIG9uIHNlYXJjaCBpbnB1dCBibHVyIGlmIGZvY3VzJ3Mgbm90XG4gICAgICAvLyBpbiBzdWdnZXN0aW9ucydzIGxpbmtzXG4gICAgICBpZiAoa2V5VGFiICYmICFzZWFyY2hIYXNGb2N1cygpKSBjbG9zZVN1Z2dlc3Rpb25zKCk7XG5cbiAgICAgIC8vXG4gICAgICAvLyBTZWxlY3QgaXRlbSBvbiBrZXlib2FyZCBhcnJvdyB1cC9kb3duIG1vdmVcbiAgICAgIC8vXG4gICAgICAvLyBJZiBhcnJvdyB1cCBrZXkgaXMgcHJlc3NlZFxuICAgICAgaWYgKGtleVVwKSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIC8vIElmIGhhcyBub3QgYW4gaXRlbSBhY3RpdmVcbiAgICAgICAgaWYgKGl0ZW1BY3RpdmVJbmRleCA8IDApIHtcbiAgICAgICAgICAvLyBzZWxlY3QgdGhlIGxhc3QgaXRlbVxuICAgICAgICAgIGl0ZW1zW2l0ZW1zLmxlbmd0aCAtIDFdLmNsYXNzTGlzdC5hZGQoY29uZmlnLml0ZW1zQWN0aXZlQ2xhc3MpO1xuICAgICAgICAgIGNvbmZpZy5zZWFyY2gudmFsdWUgPSBnZXRJdGVtQ29udGVudChpdGVtc1tpdGVtcy5sZW5ndGggLSAxXSk7XG4gICAgICAgIC8vIElmIGhhcyBhbiBpdGVtIGFjdGl2ZSBhbmQgaXQncyBub3QgdGhlIGZpcnN0IGl0ZW1cbiAgICAgICAgfSBlbHNlIGlmIChpdGVtQWN0aXZlSW5kZXggPiAwKSB7XG4gICAgICAgICAgLy8gc2VsZWN0IHRoZSBwcmV2aW91cyBpdGVtXG4gICAgICAgICAgaXRlbUFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pdGVtc0FjdGl2ZUNsYXNzKTtcbiAgICAgICAgICBpdGVtc1tpdGVtQWN0aXZlSW5kZXggLSAxXS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pdGVtc0FjdGl2ZUNsYXNzKTtcbiAgICAgICAgICBjb25maWcuc2VhcmNoLnZhbHVlID0gZ2V0SXRlbUNvbnRlbnQoaXRlbXNbaXRlbUFjdGl2ZUluZGV4IC0gMV0pO1xuICAgICAgICAvLyBJZiBpdGVtIGFjdGl2ZSBpcyB0aGUgZmlyc3QgaXRlbVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIHVuc2VsZWN0IGl0ZW0gYWN0aXZlXG4gICAgICAgICAgaXRlbUFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pdGVtc0FjdGl2ZUNsYXNzKTtcbiAgICAgICAgICBjb25maWcuc2VhcmNoLnZhbHVlID0gY29uZmlnLnNlYXJjaFRlcm07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNb3ZlIHRoZSBjYXJldCB0byB0aGUgZW5kIG9mIGlucHV0J3MgdmFsdWVcbiAgICAgICAgLy8gQnkgZGVmYXVsdCwgYnJvd3NlcnMgdXN1YWxseSBtb3ZlIHRoZSBjYXJldCB0byBzdGFydCB3aGVuIGFycm93IHVwIGlzXG4gICAgICAgIC8vIHByZXNzZWQgaW4gYSBmb2N1c2VkIGlucHV0XG4gICAgICAgIGNvbmZpZy5zZWFyY2guc2V0U2VsZWN0aW9uUmFuZ2UoY29uZmlnLnNlYXJjaC52YWx1ZS5sZW5ndGgsIGNvbmZpZy5zZWFyY2gudmFsdWUubGVuZ3RoKTtcbiAgICAgIC8vIElmIGFycm93IGRvd24ga2V5IGlzIHByZXNzZWRcbiAgICAgIH0gZWxzZSBpZiAoa2V5RG93bikge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvLyBJZiBoYXMgbm90IGFuIGl0ZW0gYWN0aXZlXG4gICAgICAgIGlmIChpdGVtQWN0aXZlSW5kZXggPCAwKSB7XG4gICAgICAgICAgLy8gc2VsZWN0IHRoZSBmaXJzdCBpdGVtXG4gICAgICAgICAgaXRlbXNbMF0uY2xhc3NMaXN0LmFkZChjb25maWcuaXRlbXNBY3RpdmVDbGFzcyk7XG4gICAgICAgICAgY29uZmlnLnNlYXJjaC52YWx1ZSA9IGdldEl0ZW1Db250ZW50KGl0ZW1zWzBdKTtcbiAgICAgICAgLy8gSWYgaGFzIGFuIGl0ZW0gYWN0aXZlIGFuZCBpdCdzIG5vdCB0aGUgbGFzdCBpdGVtXG4gICAgICAgIH0gZWxzZSBpZiAoaXRlbUFjdGl2ZUluZGV4ID49IDAgJiYgaXRlbUFjdGl2ZUluZGV4IDwgKGl0ZW1zLmxlbmd0aCAtIDEpKSB7XG4gICAgICAgICAgLy8gc2VsZWN0IHRoZSBuZXh0IGl0ZW1cbiAgICAgICAgICBpdGVtQWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLml0ZW1zQWN0aXZlQ2xhc3MpO1xuICAgICAgICAgIGl0ZW1zW2l0ZW1BY3RpdmVJbmRleCArIDFdLmNsYXNzTGlzdC5hZGQoY29uZmlnLml0ZW1zQWN0aXZlQ2xhc3MpO1xuICAgICAgICAgIGNvbmZpZy5zZWFyY2gudmFsdWUgPSBnZXRJdGVtQ29udGVudChpdGVtc1tpdGVtQWN0aXZlSW5kZXggKyAxXSk7XG4gICAgICAgIC8vIElmIGl0ZW0gYWN0aXZlIGlzIHRoZSBsYXN0IGl0ZW1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyB1bnNlbGVjdCBpdGVtIGFjdGl2ZVxuICAgICAgICAgIGl0ZW1BY3RpdmUuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaXRlbXNBY3RpdmVDbGFzcyk7XG4gICAgICAgICAgY29uZmlnLnNlYXJjaC52YWx1ZSA9IGNvbmZpZy5zZWFyY2hUZXJtO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBPbiBzZWFyY2ggaW5wdXQgdHlwZVxuICAgIGNvbmZpZy5zZWFyY2guYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyB1cGRhdGUgc2VhcmNoVGVybVxuICAgICAgY29uZmlnLnNlYXJjaFRlcm0gPSBjb25maWcuc2VhcmNoLnZhbHVlO1xuXG4gICAgICBpZiAoIXN1Z2dlc3Rpb25zSXNPcGVuKCkpIG9wZW5TdWdnZXN0aW9ucygpO1xuXG4gICAgICAvLyBydW4gY3VzdG9tIGZ1bmN0aW9uIHRvIHVwZGF0ZSBsaXN0XG4gICAgICBpZiAoY29uZmlnLnNlYXJjaFRlcm0pIHtcbiAgICAgICAgY29uZmlnLnVwZGF0ZUxpc3QoKTtcbiAgICAgIC8vIHJ1biBjdXN0b20gZnVuY3Rpb24gdG8gdXBkYXRlIGxpc3RcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJ1aWxkTGlzdCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBPcGVuIFN1Z2dlc3Rpb25zIEJveFxuICAgKi9cbiAgdmFyIG9wZW5TdWdnZXN0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBQcmV2aW5lIGJ1ZyBubyBJRSBhbyBjYXJyZWdhciBhIHDDoWdpbmFcbiAgICBpZiAoKGNvbmZpZy5zZWFyY2ggPT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpICYmIChjb25maWcuc3VnZ2VzdGlvbnMpKSB7XG4gICAgICBjb25maWcuc3VnZ2VzdGlvbnMuY2xhc3NMaXN0LmFkZChjb25maWcuc3VnZ2VzdGlvbnNBY3RpdmVDbGFzcyk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBDbG9zZSBTdWdnZXN0aW9ucyBCb3hcbiAgICovXG4gIHZhciBjbG9zZVN1Z2dlc3Rpb25zID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChjb25maWcuc3VnZ2VzdGlvbnMpIGNvbmZpZy5zdWdnZXN0aW9ucy5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5zdWdnZXN0aW9uc0FjdGl2ZUNsYXNzKTtcbiAgfTtcblxuICAvKipcbiAgICogVG9nZ2xlIFN1Z2dlc3Rpb25zIEJveFxuICAgKi9cbiAgdmFyIHRvZ2dsZVN1Z2dlc3Rpb25zID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghc3VnZ2VzdGlvbnNJc09wZW4oKSkgb3BlblN1Z2dlc3Rpb25zKCk7XG4gICAgZWxzZSBjbG9zZVN1Z2dlc3Rpb25zKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIFN1Z2dlc3Rpb25zIEJveCBpcyBvcGVuXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59IHRydWUgaWYgb3BlblxuICAgKi9cbiAgdmFyIHN1Z2dlc3Rpb25zSXNPcGVuID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjb25maWcuc3VnZ2VzdGlvbnMuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5zdWdnZXN0aW9uc0FjdGl2ZUNsYXNzKTtcbiAgfTtcblxuICAvKipcbiAgICogQnVpbGQgTGlzdFxuICAgKiBCdWlsZCB0aGUgbGlzdCAoPHVsPi88bGk+KSBvZiBzdWdnZXN0aW9uc1xuICAgKlxuICAgKiBAcGFyYW0gIHtBcnJheX0gICAgbGlzdCAgbGlzdCBvZiBzdWdnZXN0aW9uc1xuICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgdGl0bGUgdGl0bGUgb2YgdGhlIGxpc3RcbiAgICogQHBhcmFtICB7TnVtYmVyfSAgIGxpbWl0IGxpbWl0IG9mIHN1Z2dlc3Rpb25zXG4gICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYiAgICBjYWxsYmFjayBjYWxsZWQgYWZ0ZXIgbGlzdCdzIGJ1aWxkZWRcbiAgICovXG4gIHZhciBidWlsZExpc3QgPSBmdW5jdGlvbiAobGlzdCwgdGl0bGUsIGxpbWl0LCBjYikge1xuICAgIC8vIENoZWNrIGlmIGxpc3QgZXhpc3RzIGFuZCBpZiBpdCdzIGFuIGFycmF5XG4gICAgaWYgKHR5cGVvZiBsaXN0ID09PSAndW5kZWZpbmVkJyB8fCAhQXJyYXkuaXNBcnJheShsaXN0KSkge1xuICAgICAgLy8gSWYgbm8gbGlzdCBpcyBwYXNzZWQgYW5kIGEgZGVmYXVsdCBsaXN0IGV4aXN0cywgdXNlIGRlZmF1bHQgaW5zdGVhZFxuICAgICAgaWYgKGNvbmZpZy5kZWZhdWx0TGlzdCAmJiBBcnJheS5pc0FycmF5KGNvbmZpZy5kZWZhdWx0TGlzdCkpIGxpc3QgPSBjb25maWcuZGVmYXVsdExpc3Q7XG4gICAgICAvLyBJZiBubyBsaXN0IGlzIHBhc3NlZCBhbmQgdGhlcmUncyBubyBkZWZhdWx0IGxpc3QsIHRocm93IGVycm9yXG4gICAgICBlbHNlIGxpc3QgPSBudWxsO1xuICAgICAgLy8gZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ0FuIGFycmF5IG9mIGl0ZW1zIGlzIHJlcXVpcmVkJyk7XG4gICAgfVxuXG4gICAgLy8gU2V0IGRlZmF1bHQgbGltaXRcbiAgICBpZiAodHlwZW9mIGxpbWl0ID09PSAndW5kZWZpbmVkJykgbGltaXQgPSBjb25maWcubWF4SXRlbXM7XG5cbiAgICAvLyBkZXN0cm95IGN1cnJlbnQgbGlzdCB0byBhdm9pZCBtdWx0aXBsZSBpbnN0YW5jZXNcbiAgICBkZXN0cm95TGlzdCgpO1xuXG4gICAgLy8gQ2hhbmdlIHRpdGxlXG4gICAgc2V0VGl0bGUodGl0bGUpO1xuXG4gICAgLy8gQnVpbGQgbGlzdFxuICAgIGlmIChsaXN0KSB7XG4gICAgICBsaXN0LnNvbWUoZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgIGNvbmZpZy5saXN0LmFwcGVuZENoaWxkKGFkZEl0ZW0oaXRlbSkpO1xuICAgICAgICByZXR1cm4gKytpbmRleCA9PT0gbGltaXQ7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBDYWxsYmFja1xuICAgIGlmICh0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIGNiKCk7XG4gICAgZWxzZSBjb25maWcub25CdWlsZExpc3QoY29uZmlnLnN1Z2dlc3Rpb25zKTtcbiAgfTtcblxuICAvKipcbiAgICogRGVzdHJveSBMaXN0XG4gICAqIFJlbW92ZSBhbGwgY2hpbGQgbm9kZXMgKDxsaT4pIGZyb20gdGhlIGxpc3QgKDx1bD4pXG4gICAqL1xuICB2YXIgZGVzdHJveUxpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgc2V0VGl0bGUoJycpO1xuICAgIGlmIChjb25maWcubGlzdC5maXJzdENoaWxkKSB3aGlsZSAoY29uZmlnLmxpc3QuZmlyc3RDaGlsZCkgY29uZmlnLmxpc3QucmVtb3ZlQ2hpbGQoY29uZmlnLmxpc3QuZmlyc3RDaGlsZCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBMaXN0XG4gICAqIERlc3Ryb3ksIGZpbHRlciBhbmQgcmVidWlsZCB0aGUgc3VnZ2VzdGlvbnMgbGlzdFxuICAgKlxuICAgKiBAcGFyYW0gIHtBcnJheX0gbGlzdCBsaXN0IG9mIHN1Z2dlc3Rpb25zXG4gICAqL1xuICB2YXIgdXBkYXRlTGlzdCA9IGZ1bmN0aW9uIChsaXN0KSB7XG4gICAgLy8gVXBkYXRlIHN1Z2dlc3Rpb25zIGxpc3RcbiAgICBpZiAoQXJyYXkuaXNBcnJheShsaXN0KSkgY29uZmlnLnN1Z2dlc3Rpb25zTGlzdCA9IGxpc3Q7XG5cbiAgICAvLyBkZXN0cm95IGN1cnJlbnQgbGlzdCB0byBhdm9pZCBtdWx0aXBsZSBpbnN0YW5jZXNcbiAgICBkZXN0cm95TGlzdCgpO1xuXG4gICAgLy8gYWRkIGxvYWRpbmdcbiAgICBzZXRMb2FkaW5nU3RhdGUodHJ1ZSk7XG5cbiAgICAvLyBidWlsZFxuICAgIGJ1aWxkTGlzdChmaWx0ZXJMaXN0KGNvbmZpZy5zdWdnZXN0aW9uc0xpc3QsIGNvbmZpZy5zZWFyY2hUZXJtKSwgJycpO1xuXG4gICAgLy8gcmVtb3ZlIGxvYWRpbmdcbiAgICBzZXRMb2FkaW5nU3RhdGUoZmFsc2UpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBGaWx0ZXIgTGlzdFxuICAgKiBGaWx0ZXIgYW4gYXJyYXkgb2Ygb2JqZWN0cyB0byByZXR1cm4gb25seSB0aG9zZSB3aG8gaGF2ZSB0aGUgc2VhcmNoIHRlcm1cbiAgICogaW4gaXRzIGtleSB2YWx1ZS5cbiAgICpcbiAgICogQHBhcmFtICB7QXJyYXl9ICBsaXN0ICAgbGlzdCBvZiBvYmplY3RzXG4gICAqIEBwYXJhbSAge1N0cmluZ30gc2VhcmNoIHRleHQgdG8gc2VhcmNoIGluIGxpc3RcbiAgICogQHJldHVybiB7QXJyYXl9ICAgICAgICAgbGlzdCBvZiBvYmplY3RzIHdobyBoYXZlIHNlYXJjaCBzdHJpbmcgaW5cbiAgICovXG4gIHZhciBmaWx0ZXJMaXN0ID0gZnVuY3Rpb24gKGxpc3QsIHNlYXJjaCkge1xuICAgIHJldHVybiBsaXN0LmZpbHRlcihmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgaWYgKHR5cGVvZiBpdGVtLmNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiBpbmRleE9mU3BlY2lhbChpdGVtLmNvbnRlbnQsIHNlYXJjaCkgPiAtMTtcbiAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShpdGVtLmNvbnRlbnQpKSB7XG4gICAgICAgIHJldHVybiBpdGVtLmNvbnRlbnQuc29tZShmdW5jdGlvbiAoY29udGVudCkge1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycgJiYgaW5kZXhPZlNwZWNpYWwoY29udGVudCwgc2VhcmNoKSA+IC0xO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogU2V0IFRpdGxlXG4gICAqIEBwYXJhbSAge1N0cmluZ30gdGl0bGUgYSB0aXRsZSB0byBzdWdnZXN0aW9ucyBsaXN0XG4gICAqL1xuICB2YXIgc2V0VGl0bGUgPSBmdW5jdGlvbiAodGl0bGUpIHtcbiAgICB2YXIgZWxUaXRsZSA9IGNvbmZpZy5zdWdnZXN0aW9ucy5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5saXN0VGl0bGVDbGFzcyk7XG4gICAgLy8gQ2hlY2sgaWYgdGl0bGUgZXhpc3RzIGFuZCBpZiBpdCdzIGFuIGFycmF5XG4gICAgaWYgKHR5cGVvZiB0aXRsZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIC8vIElmIG5vIHRpdGxlIGlzIHBhc3NlZCBhbmQgYSBkZWZhdWx0IHRpdGxlIGV4aXN0cywgdXNlIGRlZmF1bHQgaW5zdGVhZFxuICAgICAgaWYgKHR5cGVvZiBjb25maWcuZGVmYXVsdFRpdGxlID09PSAnc3RyaW5nJykgdGl0bGUgPSBjb25maWcuZGVmYXVsdFRpdGxlO1xuICAgICAgLy8gSWYgbm8gdGl0bGUgaXMgcGFzc2VkIGFuZCB0aGVyZSdzIG5vIGRlZmF1bHQgdGl0bGUsIHNldCB0aXRsZSBhcyBlbXB0eVxuICAgICAgZWxzZSB0aXRsZSA9ICcnO1xuICAgIH1cbiAgICAvLyBzZXQgdGl0bGUgaW4gSFRNTFxuICAgIGlmIChlbFRpdGxlKSBlbFRpdGxlLmlubmVyVGV4dCA9IHRpdGxlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDdXN0b20gVXBkYXRlXG4gICAqIFNldCBhIGN1c3RvbSBmdW5jdGlvbiB0byBydW4gb24gaW5wdXQgdHlwaW5nXG4gICAqXG4gICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBmbiBjdXN0b20gZnVuY3Rpb25cbiAgICovXG4gIHZhciBzZXRDdXN0b21VcGRhdGUgPSBmdW5jdGlvbiAoZm4pIHtcbiAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAvLyB1cGRhdGUgZnJvbSBkaW5hbWljIGZ1bmN0aW9uXG4gICAgICBjb25maWcudXBkYXRlTGlzdCA9IGZuO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogRGVmYXVsdCBMaXN0XG4gICAqIFNldCBkZWZhdWx0IGxpc3Qgb2Ygc3VnZ2VzdGlvbnMgYW5kIHRpdGxlLCBkZWZpbmVkIGJ5IGNvbmZpZy5kZWZhdWx0TGlzdFxuICAgKiBhbmQgY29uZmlnLmRlZmF1bHRUaXRsZSwgcmVzcGVjdGl2ZWx5LlxuICAgKlxuICAgKiBAcGFyYW0gIHtBcnJheX0gIGxpc3QgIGxpc3Qgb2Ygc3VnZ2VzdGlvbnNcbiAgICogQHBhcmFtICB7U3RyaW5nfSB0aXRsZSBhIHRpdGxlIHRvIHN1Z2dlc3Rpb25zIGxpc3RcbiAgICovXG4gIHZhciBzZXREZWZhdWx0TGlzdCA9IGZ1bmN0aW9uIChsaXN0LCB0aXRsZSkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGxpc3QpKSBjb25maWcuZGVmYXVsdExpc3QgPSBsaXN0O1xuICAgIGlmICh0eXBlb2YgdGl0bGUgPT09ICdzdHJpbmcnKSBjb25maWcuZGVmYXVsdFRpdGxlID0gdGl0bGU7XG4gICAgYnVpbGRMaXN0KGNvbmZpZy5kZWZhdWx0TGlzdCwgY29uZmlnLmRlZmF1bHRUaXRsZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCBJdGVtXG4gICAqIEFkZCBhbiBpdGVtIDxsaT4gdG8gc3VnZ2VzdGlvbnMgbGlzdFxuICAgKlxuICAgKiBPYmplY3Q6XG4gICAqICAgdGVybTogc3RyaW5nIC0gdGhlIHBhcnQgb2YgdGV4dCB0aGF0IGhhcyB0aGUgc2VhcmNoIHRlcm1cbiAgICogICBsaW5rOiBzdHJpbmcgLSB1cmwgdG8gdGhlIHBhZ2Ugb2YgdGhlIGl0ZW1cbiAgICogICBsb2NhdGlvbjogc3RyaW5nIC0gbmFtZSBvZiB0aGUgcGFnZSBvZiB0aGUgaXRlbVxuICAgKlxuICAgKiBAcGFyYW0gIHtPYmplY3R9IGl0ZW0gb2JqZWN0IHdpdGggdGhlIGNvbnRlbnQgb2YgaXRlbVxuICAgKiBAcmV0dXJuIHtTdHJpbmd9IEhUTUwgc3RyaW5nIG9mIHRoZSBpdGVtXG4gICAqL1xuICB2YXIgYWRkSXRlbSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICB2YXIgYW5jaG9yO1xuICAgIHZhciBjb250ZW50cztcblxuICAgIGlmICghaXRlbSB8fCAhaXRlbS5jb250ZW50Lmxlbmd0aCkgcmV0dXJuO1xuXG4gICAgaWYgKHR5cGVvZiBpdGVtLmNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50cyA9IFtpdGVtLmNvbnRlbnRdO1xuICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaXRlbS5jb250ZW50KSkgY29udGVudHMgPSBpdGVtLmNvbnRlbnQ7XG4gICAgZWxzZSBjb25zb2xlLmVycm9yKCdpdGVtIGNvbnRlbnQgc2hvdWxkIGJlIGEgc3RyaW5nIG9yIGFuIGFycmF5IG9mIHN0cmluZ3MnKTtcblxuICAgIGxpLmNsYXNzTGlzdC5hZGQoY29uZmlnLml0ZW1DbGFzcyk7XG5cbiAgICBpZiAoaXRlbS5saW5rKSB7XG4gICAgICBhbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICBhbmNob3IuaHJlZiA9IGl0ZW0ubGluaztcbiAgICB9IGVsc2Uge1xuICAgICAgYW5jaG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICBhbmNob3IudHlwZSA9ICdidXR0b24nO1xuICAgIH1cblxuICAgIGFuY2hvci5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pdGVtTGlua0NsYXNzKTtcbiAgICBsaS5hcHBlbmRDaGlsZChhbmNob3IpO1xuXG4gICAgY29udGVudHMuZm9yRWFjaChmdW5jdGlvbiAoY29udGVudCwgaW5kZXgpIHtcbiAgICAgIHZhciBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgdmFyIGNvbnRlbnRIaWdobGlnaHRlZCA9IHJlcGxhY2VUZXJtcyhjb250ZW50LCBjb25maWcuc2VhcmNoVGVybSkgfHwgJyc7XG4gICAgICBzcGFuLmlubmVySFRNTCA9IGNvbnRlbnRIaWdobGlnaHRlZCB8fCBjb250ZW50O1xuICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnLCBjb250ZW50KTtcbiAgICAgIGlmIChjb25maWcuY29udGVudENsYXNzZXMubGVuZ3RoKSBzcGFuLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNvbnRlbnRDbGFzc2VzW2luZGV4XSk7XG4gICAgICBpZiAoYW5jaG9yKSBhbmNob3IuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgICBlbHNlIGxpLmFwcGVuZENoaWxkKHNwYW4pO1xuICAgIH0pO1xuXG4gICAgaWYgKCFpdGVtLmxpbmspIHtcbiAgICAgIGFuY2hvci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uZmlnLnNlYXJjaC52YWx1ZSA9IGdldEl0ZW1Db250ZW50KGxpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBsaTtcbiAgfTtcblxuICAvKipcbiAgICogR2V0IEFsbCBJdGVtc1xuICAgKiBHZXQgdGhlIG5vZGVsaXN0IHdpdGggYWxsIGxpc3QgaXRlbSBlbGVtZW50c1xuICAgKlxuICAgKiBAcmV0dXJuIHtOb2RlTGlzdH0gYXJyYXkgd2l0aCBhbGwgaXRlbSBlbGVtZW50c1xuICAgKi9cbiAgdmFyIGdldEFsbEl0ZW1zID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjb25maWcubGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGNvbmZpZy5pdGVtQ2xhc3MpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBJdGVtQ29udGVudFxuICAgKiBHZXQgdGhlIHRleHQgY29udGVudCBvZiBhbiBsaXN0IGl0ZW0gZWxlbWVudFxuICAgKlxuICAgKiBAcGFyYW0gIHtPYmplY3R9IGl0ZW0gaXRlbSBlbGVtZW50IHdpdGggdGhlIGNvbnRlbnQgb2YgaXRlbVxuICAgKiBAcmV0dXJuIHtTdHJpbmd9ICAgICAgdGhlIGl0ZW0gdGV4dENvbnRlbnRcbiAgICovXG4gIHZhciBnZXRJdGVtQ29udGVudCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIGl0ZW1UZXJtO1xuICAgIGlmICghaXRlbSkgcmV0dXJuO1xuICAgIGl0ZW1UZXJtID0gaXRlbS5xdWVyeVNlbGVjdG9yQWxsKCdzcGFuJyk7XG4gICAgcmV0dXJuIGl0ZW1UZXJtWzBdLnRleHRDb250ZW50O1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBhY3RpdmUgaXRlbVxuICAgKiBHZXQgdGhlIGN1cnJlbnQgaXRlbSBtYXJrZWQgYXMgYWN0aXZlIGR1cmluZyBrZXlib2FyZCBhcnJvd3MgbmF2aWdhdGlvbi5cbiAgICpcbiAgICogQHJldHVybiB7T2JqZWN0fSBET00gT2JqZWN0IG9mIHRoZSBpdGVtXG4gICAqL1xuICB2YXIgZ2V0SXRlbUFjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY29uZmlnLnN1Z2dlc3Rpb25zLnF1ZXJ5U2VsZWN0b3IoJy4nICsgY29uZmlnLml0ZW1zQWN0aXZlQ2xhc3MpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEaXNhYmxlIGN1cnJlbnQgYWN0aXZlIGl0ZW1cbiAgICogRGlzYWJsZSB0aGUgY3VycmVudCBpdGVtIG1hcmtlZCBhcyBhY3RpdmUgZHVyaW5nIGtleWJvYXJkIGFycm93cyBuYXZpZ2F0aW9uLlxuICAgKi9cbiAgdmFyIGRpc2FibGVJdGVtQWN0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBhY3RpdmUgPSBnZXRJdGVtQWN0aXZlKCk7XG4gICAgLy8gdW5zZWxlY3QgaXRlbSBhY3RpdmVcbiAgICBpZiAoYWN0aXZlKSBhY3RpdmUuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaXRlbXNBY3RpdmVDbGFzcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlcGxhY2UgVGVybXNcbiAgICogUmVwbGFjZSB0aGUgc2VhcmNoVGVybSBpbiB0aGUgdGVybSBzdHJpbmcgd2l0aCBjdXN0b20gSFRNTCB0byBtYWtlIGl0IGJvbGRcbiAgICpcbiAgICogQHBhcmFtICB7U3RyaW5nfSBzdHJXaGVyZVNlYXJjaCBpdGVtIHRlcm1cbiAgICogQHBhcmFtICB7U3RyaW5nfSBzdHJUb0ZpbmQgICAgICBzZWFyY2ggdGVybSB0byByZXBsYWNlIGluIGl0ZW0gdGVybVxuICAgKiBAcmV0dXJuIHtTdHJpbmd9ICAgICAgICAgICAgICAgIGl0ZW0gdGVybSByZXBsYWNlZCB3aXRoIGJvbGQgc2VhcmNoIHRlcm1cbiAgICovXG4gIHZhciByZXBsYWNlVGVybXMgPSBmdW5jdGlvbiAoc3RyV2hlcmVTZWFyY2gsIHN0clRvRmluZCkge1xuICAgIC8vIEFycmF5IHRvIHN0b3JlIHN0cmluZ3MgYmVmb3JlIGpvaW5cbiAgICB2YXIgb2NjdXJyZW5jZXNTdHJpbmcgPSBbXTtcblxuICAgIC8vIENoZWNrIGlmIGJvdGggcGFyYW1ldGVycyB3YXMgcGFzc2VkXG4gICAgaWYgKHR5cGVvZiBzdHJXaGVyZVNlYXJjaCA9PT0gJ3VuZGVmaW5lZCcgfHxcbiAgICAgIHR5cGVvZiBzdHJUb0ZpbmQgPT09ICd1bmRlZmluZWQnKSByZXR1cm47XG5cbiAgICAvKipcbiAgICAgKiBMb29wIHRocm91Z2ggcGFydHMgb2Ygc3RyV2hlcmVTZWFyY2ggdG8gY2hlY2sgaWYgaXQgaGFzIHN0clRvRmluZCBpblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdHJQYXJ0IHNvbWUgc3RyaW5nIHdoZXJlIHRvIGZpbmQgb3V0IHN0clRvRmluZFxuICAgICAqL1xuICAgIHZhciBhbGxJbmRleCA9IGZ1bmN0aW9uIChzdHJQYXJ0KSB7XG4gICAgICB2YXIgcmVhbFN0cmluZyA9ICcnO1xuICAgICAgdmFyIG5ld1N0cmluZyA9ICcnO1xuICAgICAgdmFyIGlkeDtcbiAgICAgIC8vIGNoZWNrIGlmIHN0clBhcnQgaGFzIHN0clRvRmluZCxcbiAgICAgIGlkeCA9IGluZGV4T2ZTcGVjaWFsKHN0clBhcnQsIHN0clRvRmluZCk7XG4gICAgICBpZiAoaWR4ID4gLTEpIHtcbiAgICAgICAgLy8gc3RvcmUgdGhlIHJlYWxTdHJpbmdcbiAgICAgICAgcmVhbFN0cmluZyA9IHN0clBhcnQuc3Vic3RyaW5nKGlkeCwgaWR4ICsgc3RyVG9GaW5kLmxlbmd0aCk7XG4gICAgICAgIG5ld1N0cmluZyA9ICc8YiBjbGFzcz1cIicgKyBjb25maWcuaXRlbVRlcm1UeXBlZENsYXNzICsgJ1wiPicgKyByZWFsU3RyaW5nICsgJzwvYj4nO1xuICAgICAgICAvLyBzdG9yZSB0aGUgcGFydCBvZiB0aGUgc3RyUGFydCBiZWZvcmUgcmVhbFN0cmluZyBhbmQgcmVhbFN0cmluZyByZXBsYWNlZFxuICAgICAgICAvLyB3aXRoIGJvbGQgSFRNTCB0YWdzXG4gICAgICAgIHN0ckJlZm9yZSA9IHN0clBhcnQuc3Vic3RyaW5nKDAsIGlkeCArIHJlYWxTdHJpbmcubGVuZ3RoKS5yZXBsYWNlKHJlYWxTdHJpbmcsIG5ld1N0cmluZyk7XG4gICAgICAgIC8vIHN0b3JlIHRoZSBwYXJ0IG9mIHRoZSBzdHJQYXJ0IGFmdGVyIHJlYWxTdHJpbmdcbiAgICAgICAgc3RyQWZ0ZXIgPSBzdHJQYXJ0LnN1YnN0cmluZyhpZHggKyByZWFsU3RyaW5nLmxlbmd0aCk7XG4gICAgICAgIC8vIHB1c2ggc3RyQmVmb3JlIHRvIHRoZSBvY2N1cnJlbmNlc1N0cmluZ1xuICAgICAgICBvY2N1cnJlbmNlc1N0cmluZy5wdXNoKHN0ckJlZm9yZSk7XG4gICAgICAgIC8vIGlmIHN0ckFmdGVyIG5vdCBlbXB0eSwgcGFzcyBpdCB0byBhbGxJbmRleCBmdW5jdGlvblxuICAgICAgICBpZiAoc3RyQWZ0ZXIpIGFsbEluZGV4KHN0ckFmdGVyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGlmIHN0clBhcnQgaGFzIG5vdCBzdHJUb0ZpbmQgaW4sIHB1c2ggaXQgdG8gdGhlIGVuZCBvZiBvY2N1cnJlbmNlc1N0cmluZ1xuICAgICAgICBvY2N1cnJlbmNlc1N0cmluZy5wdXNoKHN0clBhcnQpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBydW4gYWxsSW5kZXhcbiAgICBhbGxJbmRleChzdHJXaGVyZVNlYXJjaCk7XG5cbiAgICAvLyByZXR1cm4gc3RyV2hlcmVTZWFyY2ggcmVwbGFjZWQgc3RyVG9GaW5kIGJvbGRcbiAgICByZXR1cm4gb2NjdXJyZW5jZXNTdHJpbmcuam9pbignJyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldCBsb2FkaW5nIHN0YXRlXG4gICAqIEBwYXJhbSAge0Jvb2xlYW59IHN0YXRlIHRydWUgdG8gYWRkIGxvYWRpbmcsIGZhbHNlIHRvIHJlbW92ZSBsb2FkaW5nXG4gICAqL1xuICB2YXIgc2V0TG9hZGluZ1N0YXRlID0gZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgLy8gY2hlY2sgcGFyYW1ldGVyc1xuICAgIC8vIGlmIHN0YXRlIGVtcHR5LCB0b29nbGUgbG9hZGluZyBpbnN0ZWFkIHNldFxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBzdGF0ZSA9ICFjb25maWcuc3VnZ2VzdGlvbnMuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5zdWdnZXN0aW9uc0xvYWRpbmdDbGFzcyk7XG4gICAgfVxuXG4gICAgLy8gU2V0IHN0YXRlXG4gICAgaWYgKHN0YXRlID09PSB0cnVlKSB7XG4gICAgICBjb25maWcuc3VnZ2VzdGlvbnMuY2xhc3NMaXN0LmFkZChjb25maWcuc3VnZ2VzdGlvbnNMb2FkaW5nQ2xhc3MpO1xuICAgIH0gZWxzZSBpZiAoc3RhdGUgPT09IGZhbHNlKSB7XG4gICAgICBjb25maWcuc3VnZ2VzdGlvbnMuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuc3VnZ2VzdGlvbnNMb2FkaW5nQ2xhc3MpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2sgaWYgU2VhcmNoIElucHV0IG9yIGFueSBpdGVtIG9mIHN1Z2dlc3Rpb25zIGxpc3QgaGFzIGZvY3VzXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59IHRydWUgaWYgc2VhcmNoIGhhcyBmb2N1c1xuICAgKi9cbiAgdmFyIHNlYXJjaEhhc0ZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIGFsbCBsaW5rcyAoPGE+KSBpbnNpZGUgbGlzdFxuICAgIHZhciBsaW5rcyA9IGNvbmZpZy5saXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKTtcbiAgICAvLyBDaGVjayBpZiBzZWFyY2ggSW5wdXQgaGFzIGZvY3VzXG4gICAgdmFyIHNlYXJjaElucHV0SGFzRm9jdXMgPSBjb25maWcuc2VhcmNoID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgIC8vIENoZWNrIGlmIGFueSBpdGVtIG9mIHN1Z2dlc3Rpb25zIGxpc3QgaGFzIGZvY3VzXG4gICAgdmFyIGFueUxpbmtIYXNGb2N1cyA9IEFycmF5LnByb3RvdHlwZS5zb21lLmNhbGwobGlua3MsIGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICByZXR1cm4gbGluayA9PT0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICB9KTtcbiAgICAvLyByZXR1cm4gaWYgYW55IG9mIHRob3NlIGFyZSB0cnVlXG4gICAgcmV0dXJuIChzZWFyY2hJbnB1dEhhc0ZvY3VzIHx8IGFueUxpbmtIYXNGb2N1cyk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICAgIHRvZ2dsZTogdG9nZ2xlU3VnZ2VzdGlvbnMsXG4gICAgb3Blbjogb3BlblN1Z2dlc3Rpb25zLFxuICAgIGNsb3NlOiBjbG9zZVN1Z2dlc3Rpb25zLFxuICAgIGlzT3Blbjogc3VnZ2VzdGlvbnNJc09wZW4sXG4gICAgZmlsdGVyOiBmaWx0ZXJMaXN0LFxuICAgIGJ1aWxkOiBidWlsZExpc3QsXG4gICAgZGVzdHJveTogZGVzdHJveUxpc3QsXG4gICAgdXBkYXRlOiBjb25maWcudXBkYXRlTGlzdCxcbiAgICBjdXN0b206IHNldEN1c3RvbVVwZGF0ZSxcbiAgICBzZXRMb2FkaW5nOiBzZXRMb2FkaW5nU3RhdGUsXG4gICAgZGVmYXVsdExpc3Q6IGNvbmZpZy5kZWZhdWx0TGlzdCxcbiAgICBzZXREZWZhdWx0TGlzdDogc2V0RGVmYXVsdExpc3QsXG4gICAgZ2V0U2VyY2hUZXJtOiBjb25maWcuc2VhcmNoVGVybSxcbiAgICBjb25maWc6IGNvbmZpZyxcbiAgfTtcbn07XG5cbi8qKlxuICogRXhhbXBsZXNcbiAqL1xuLy9cbi8vIC8vIEluaXQgU2VhcmNoIENvbnN0cnVjdG9yIHdpdGggZGVmYXVsdCBhbmQgc3VnZ2VzdGlvbnMgbGlzdHNcbi8vIHZhciBkZWZhdWx0RXhhbXBsZSA9IGZ1bmN0aW9uICgpIHtcbi8vICAgLy8gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbi8vXG4vLyAgIHZhciBzdWdlc3RvZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtc2VhcmNoLXN1Z2dlc3Rpb25zJyk7XG4vLyAgIHZhciBpbnN0YW5jZXMgPSBbXTtcbi8vICAgaWYgKHN1Z2VzdG9lcyAmJiBzdWdlc3RvZXMubGVuZ3RoKSB7XG4vLyAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChzdWdlc3RvZXMsIGZ1bmN0aW9uIChlbCkge1xuLy8gICAgICAgdmFyIGluc3RhbmNlID0gbmV3IEJzU2VhcmNoU3VnZ2VzdGlvbnMoZWwsIHtcbi8vICAgICAgICAgY29udGVudENsYXNzZXM6IFtcbi8vICAgICAgICAgICAnYnMtc2VhcmNoLXN1Z2dlc3Rpb25zX190ZXJtJyxcbi8vICAgICAgICAgICAnYnMtc2VhcmNoLXN1Z2dlc3Rpb25zX19sb2NhdGlvbicsXG4vLyAgICAgICAgIF0sXG4vLyAgICAgICAgIG1heEl0ZW1zOiA4LFxuLy8gICAgICAgICBkZWZhdWx0VGl0bGU6ICdNYWlzIEJ1c2NhZG9zJyxcbi8vICAgICAgICAgZGVmYXVsdExpc3Q6IFtcbi8vICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICBjb250ZW50OiAnU2VtIGxpbmsgZSBzZW0gbG9jYXRpb24nLFxuLy8gICAgICAgICAgIH0sXG4vLyAgICAgICAgICAge1xuLy8gICAgICAgICAgICAgbGluazogJyMhJyxcbi8vICAgICAgICAgICAgIGNvbnRlbnQ6IFtcbi8vICAgICAgICAgICAgICAgJ0xvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0Jyxcbi8vICAgICAgICAgICAgICAgJ2lydXJlIGRvbG9yJyxcbi8vICAgICAgICAgICAgIF0sXG4vLyAgICAgICAgICAgfSxcbi8vICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICBsaW5rOiAnIyEnLFxuLy8gICAgICAgICAgICAgY29udGVudDogW1xuLy8gICAgICAgICAgICAgICAnTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQnLFxuLy8gICAgICAgICAgICAgICAnaXJ1cmUgZG9sb3InLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICdjb25zZWN0ZXR1ciBhZGlwaXNpY2luZyBlbGl0Jyxcbi8vICAgICAgICAgICAgICAgJ2luIHJlcHJlaGVuZGVyaXQnLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICdzZWQgZG8gZWl1c21vZCB0ZW1wb3IgaW5jaWRpZHVudCcsXG4vLyAgICAgICAgICAgICAgICd2b2x1cHRhdGUgdmVsaXQnLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICd1dCBsYWJvcmUgZXQgZG9sb3JlIG1hZ25hIGFsaXF1YScsXG4vLyAgICAgICAgICAgICAgICdlc3NlIGNpbGx1bSBkb2xvcmUnLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICdVdCBlbmltIGFkIG1pbmltIHZlbmlhbScsXG4vLyAgICAgICAgICAgICAgICdldSBmdWdpYXQgbnVsbGEnLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICdxdWlzIG5vc3RydWQgZXhlcmNpdGF0aW9uIHVsbGFtY28nLFxuLy8gICAgICAgICAgICAgICAnZXhjZXB0ZXVyIHNpbnQgb2NjYWVjYXQnLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICdsYWJvcmlzIG5pc2kgdXQgYWxpcXVpcCBleCBlYScsXG4vLyAgICAgICAgICAgICAgICdjdXBpZGF0YXQgbm9uIHByb2lkZW50Jyxcbi8vICAgICAgICAgICAgIF0sXG4vLyAgICAgICAgICAgfSxcbi8vICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICBsaW5rOiAnIyEnLFxuLy8gICAgICAgICAgICAgY29udGVudDogW1xuLy8gICAgICAgICAgICAgICAnY29tbW9kbyBjb25zZXF1YXQuIER1aXMgYXV0ZScsXG4vLyAgICAgICAgICAgICAgICdxdWkgb2ZmaWNpYSBkZXNlcnVudCcsXG4vLyAgICAgICAgICAgICBdLFxuLy8gICAgICAgICAgIH0sXG4vLyAgICAgICAgIF0sXG4vLyAgICAgICAgIHN1Z2dlc3Rpb25zTGlzdDogW1xuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGNvbnRlbnQ6ICdTZW0gbGluayBlIHNlbSBsb2NhdGlvbicsXG4vLyAgICAgICAgICAgfSxcbi8vICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICBsaW5rOiAnIyEnLFxuLy8gICAgICAgICAgICAgY29udGVudDogW1xuLy8gICAgICAgICAgICAgICAnTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQnLFxuLy8gICAgICAgICAgICAgICAnaXJ1cmUgZG9sb3InLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICdjb25zZWN0ZXR1ciBhZGlwaXNpY2luZyBlbGl0Jyxcbi8vICAgICAgICAgICAgICAgJ2luIHJlcHJlaGVuZGVyaXQnLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICdzZWQgZG8gZWl1c21vZCB0ZW1wb3IgaW5jaWRpZHVudCcsXG4vLyAgICAgICAgICAgICAgICd2b2x1cHRhdGUgdmVsaXQnLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICd1dCBsYWJvcmUgZXQgZG9sb3JlIG1hZ25hIGFsaXF1YScsXG4vLyAgICAgICAgICAgICAgICdlc3NlIGNpbGx1bSBkb2xvcmUnLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICdVdCBlbmltIGFkIG1pbmltIHZlbmlhbScsXG4vLyAgICAgICAgICAgICAgICdldSBmdWdpYXQgbnVsbGEnLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICdxdWlzIG5vc3RydWQgZXhlcmNpdGF0aW9uIHVsbGFtY28nLFxuLy8gICAgICAgICAgICAgICAnZXhjZXB0ZXVyIHNpbnQgb2NjYWVjYXQnLFxuLy8gICAgICAgICAgICAgXSxcbi8vICAgICAgICAgICB9LFxuLy8gICAgICAgICAgIHtcbi8vICAgICAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgICAgICBjb250ZW50OiBbXG4vLyAgICAgICAgICAgICAgICdsYWJvcmlzIG5pc2kgdXQgYWxpcXVpcCBleCBlYScsXG4vLyAgICAgICAgICAgICAgICdjdXBpZGF0YXQgbm9uIHByb2lkZW50Jyxcbi8vICAgICAgICAgICAgIF0sXG4vLyAgICAgICAgICAgfSxcbi8vICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICBsaW5rOiAnIyEnLFxuLy8gICAgICAgICAgICAgY29udGVudDogW1xuLy8gICAgICAgICAgICAgICAnY29tbW9kbyBjb25zZXF1YXQuIER1aXMgYXV0ZScsXG4vLyAgICAgICAgICAgICAgICdxdWkgb2ZmaWNpYSBkZXNlcnVudCcsXG4vLyAgICAgICAgICAgICBdLFxuLy8gICAgICAgICAgIH0sXG4vLyAgICAgICAgIF0sXG4vLyAgICAgICB9KTtcbi8vICAgICAgIGluc3RhbmNlLmluaXQoKTtcbi8vICAgICAgIGluc3RhbmNlcy5wdXNoKGluc3RhbmNlKTtcbi8vICAgICB9KTtcbi8vICAgfVxuLy8gfTtcbi8vIGRlZmF1bHRFeGFtcGxlKCk7XG4vL1xuLy8gaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXNjYScpKSB7XG4vLyAgIHZhciBkaWZmZXJlbnRDbGFzc2VzRXhhbXBsZSA9IG5ldyBCc1NlYXJjaFN1Z2dlc3Rpb25zKCcuYnMtYXV0b2NvbXBsZXRlJywge1xuLy8gICAgIHNlYXJjaDogJy5idXNjYScsXG4vLyAgICAgLy8gc3VnZ2VzdGlvbnM6ICcuYnMtYXV0b2NvbXBsZXRlJyxcbi8vICAgICAvLyBsaXN0OiAnLmJzLXNlYXJjaC1zdWdnZXN0aW9uc19fbGlzdCcsXG4vLyAgICAgbGlzdDogJy5icy1zZWFyY2gtc3VnZ2VzdGlvbnNfX2xpc3QnLFxuLy8gICAgIHN1Z2dlc3Rpb25zQWN0aXZlQ2xhc3M6ICdicy1pcy1vcGVuJyxcbi8vICAgICBzdWdnZXN0aW9uc0xvYWRpbmdDbGFzczogJ2JzLWlzLWxvYWRpbmcnLFxuLy8gICAgIGl0ZW1DbGFzczogJ2xpJyxcbi8vICAgICBpdGVtc0FjdGl2ZUNsYXNzOiAnbGktLWFjdGl2ZScsXG4vLyAgICAgaXRlbUxpbmtDbGFzczogJ2xpbmsnLFxuLy8gICAgIGl0ZW1UZXJtQ2xhc3M6ICd0ZXJtJyxcbi8vICAgICBpdGVtVGVybVR5cGVkQ2xhc3M6ICd0ZXJtLXR5cGVkJyxcbi8vICAgICBpdGVtTG9jYXRpb25DbGFzczogJ2xvY2F0aW9uJyxcbi8vICAgICBkZWZhdWx0VGl0bGU6ICcnLFxuLy8gICAgIGRlZmF1bHRMaXN0OiBbXG4vLyAgICAgICB7XG4vLyAgICAgICAgIHRlcm06ICdMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCcsXG4vLyAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgIGxvY2F0aW9uOiAnaXJ1cmUgZG9sb3InLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ2NvbnNlY3RldHVyIGFkaXBpc2ljaW5nIGVsaXQnLFxuLy8gICAgICAgICBsaW5rOiAnIyEnLFxuLy8gICAgICAgICBsb2NhdGlvbjogJ2luIHJlcHJlaGVuZGVyaXQnLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ3NlZCBkbyBlaXVzbW9kIHRlbXBvciBpbmNpZGlkdW50Jyxcbi8vICAgICAgICAgbGluazogJyMhJyxcbi8vICAgICAgICAgbG9jYXRpb246ICd2b2x1cHRhdGUgdmVsaXQnLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ3V0IGxhYm9yZSBldCBkb2xvcmUgbWFnbmEgYWxpcXVhJyxcbi8vICAgICAgICAgbGluazogJyMhJyxcbi8vICAgICAgICAgbG9jYXRpb246ICdlc3NlIGNpbGx1bSBkb2xvcmUnLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ1V0IGVuaW0gYWQgbWluaW0gdmVuaWFtJyxcbi8vICAgICAgICAgbGluazogJyMhJyxcbi8vICAgICAgICAgbG9jYXRpb246ICdldSBmdWdpYXQgbnVsbGEnLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ3F1aXMgbm9zdHJ1ZCBleGVyY2l0YXRpb24gdWxsYW1jbycsXG4vLyAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgIGxvY2F0aW9uOiAnZXhjZXB0ZXVyIHNpbnQgb2NjYWVjYXQnLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ2xhYm9yaXMgbmlzaSB1dCBhbGlxdWlwIGV4IGVhJyxcbi8vICAgICAgICAgbGluazogJyMhJyxcbi8vICAgICAgICAgbG9jYXRpb246ICdjdXBpZGF0YXQgbm9uIHByb2lkZW50Jyxcbi8vICAgICAgIH0sXG4vLyAgICAgICB7XG4vLyAgICAgICAgIHRlcm06ICdjb21tb2RvIGNvbnNlcXVhdC4gRHVpcyBhdXRlJyxcbi8vICAgICAgICAgbGluazogJyMhJyxcbi8vICAgICAgICAgbG9jYXRpb246ICdxdWkgb2ZmaWNpYSBkZXNlcnVudCcsXG4vLyAgICAgICB9LFxuLy8gICAgIF0sXG4vLyAgICAgc3VnZ2VzdGlvbnNMaXN0OiBbXG4vLyAgICAgICB7XG4vLyAgICAgICAgIHRlcm06ICdMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCcsXG4vLyAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgIGxvY2F0aW9uOiAnaXJ1cmUgZG9sb3InLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ2NvbnNlY3RldHVyIGFkaXBpc2ljaW5nIGVsaXQnLFxuLy8gICAgICAgICBsaW5rOiAnIyEnLFxuLy8gICAgICAgICBsb2NhdGlvbjogJ2luIHJlcHJlaGVuZGVyaXQnLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ3NlZCBkbyBlaXVzbW9kIHRlbXBvciBpbmNpZGlkdW50Jyxcbi8vICAgICAgICAgbGluazogJyMhJyxcbi8vICAgICAgICAgbG9jYXRpb246ICd2b2x1cHRhdGUgdmVsaXQnLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ3V0IGxhYm9yZSBldCBkb2xvcmUgbWFnbmEgYWxpcXVhJyxcbi8vICAgICAgICAgbGluazogJyMhJyxcbi8vICAgICAgICAgbG9jYXRpb246ICdlc3NlIGNpbGx1bSBkb2xvcmUnLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ1V0IGVuaW0gYWQgbWluaW0gdmVuaWFtJyxcbi8vICAgICAgICAgbGluazogJyMhJyxcbi8vICAgICAgICAgbG9jYXRpb246ICdldSBmdWdpYXQgbnVsbGEnLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ3F1aXMgbm9zdHJ1ZCBleGVyY2l0YXRpb24gdWxsYW1jbycsXG4vLyAgICAgICAgIGxpbms6ICcjIScsXG4vLyAgICAgICAgIGxvY2F0aW9uOiAnZXhjZXB0ZXVyIHNpbnQgb2NjYWVjYXQnLFxuLy8gICAgICAgfSxcbi8vICAgICAgIHtcbi8vICAgICAgICAgdGVybTogJ2xhYm9yaXMgbmlzaSB1dCBhbGlxdWlwIGV4IGVhJyxcbi8vICAgICAgICAgbGluazogJyMhJyxcbi8vICAgICAgICAgbG9jYXRpb246ICdjdXBpZGF0YXQgbm9uIHByb2lkZW50Jyxcbi8vICAgICAgIH0sXG4vLyAgICAgICB7XG4vLyAgICAgICAgIHRlcm06ICdjb21tb2RvIGNvbnNlcXVhdC4gRHVpcyBhdXRlJyxcbi8vICAgICAgICAgbGluazogJyMhJyxcbi8vICAgICAgICAgbG9jYXRpb246ICdxdWkgb2ZmaWNpYSBkZXNlcnVudCcsXG4vLyAgICAgICB9LFxuLy8gICAgIF0sXG4vLyAgIH0pO1xuLy8gICBkaWZmZXJlbnRDbGFzc2VzRXhhbXBsZS5pbml0KCk7XG4vLyAgIC8vIGNvbnNvbGUubG9nKGRpZmZlcmVudENsYXNzZXNFeGFtcGxlKTtcbi8vIH1cbi8vXG4vLyAvLyBHZXQgZXh0ZXJuYWwgbGlzdCBhbmQgdXBkYXRlIHRoZSBzdGF0aWMgbGlzdCBvZiBzdWdnZXN0aW9uc1xuLy8gdmFyIGFqYXhTdGF0aWNFeGFtcGxlID0gZnVuY3Rpb24gKCkge1xuLy8gICB2YXIgc3dQZW9wbGUgPSBmdW5jdGlvbiAocGVvcGxlKSB7XG4vLyAgICAgcGVvcGxlID0gSlNPTi5wYXJzZShwZW9wbGUpO1xuLy8gICAgIHZhciBsaXN0ID0gcGVvcGxlLnJlc3VsdHMubWFwKGZ1bmN0aW9uIChwZXJzb24pIHtcbi8vICAgICAgIHJldHVybiB7XG4vLyAgICAgICAgIHRlcm06IHBlcnNvbi5uYW1lLFxuLy8gICAgICAgICB1cmw6IHBlcnNvbi51cmwsXG4vLyAgICAgICAgIGxvY2F0aW9uOiAnJyxcbi8vICAgICAgIH07XG4vLyAgICAgfSk7XG4vL1xuLy8gICAgIC8vIHJlYnVpbGRcbi8vICAgICBCc1NlYXJjaFN1Z2dlc3Rpb25zLnVwZGF0ZShsaXN0KTtcbi8vICAgICBCc1NlYXJjaFN1Z2dlc3Rpb25zLnNldExvYWRpbmcoZmFsc2UpO1xuLy8gICB9O1xuLy9cbi8vICAgLy8gZGVzdHJveVxuLy8gICBCc1NlYXJjaFN1Z2dlc3Rpb25zLmRlc3Ryb3koKTtcbi8vICAgQnNTZWFyY2hTdWdnZXN0aW9ucy5zZXRMb2FkaW5nKHRydWUpO1xuLy9cbi8vICAgaHR0cEdldCgnaHR0cHM6Ly9zd2FwaS5jby9hcGkvcGVvcGxlLz9mb3JtYXQ9anNvbicsIHN3UGVvcGxlLmJpbmQoKSk7XG4vLyB9O1xuLy9cbi8vIC8vIHVwZGF0ZXMgdGhlIGRlZmF1bHQgdXBkYXRlTGlzdCBmdW5jdGlvbiB0byBjYWxsIGFqYXggcmVxdWVzdCBkdXJpbmcgaW5wdXQgdHlwaW5nXG4vLyB2YXIgYWpheE9uVHlwZUV4YW1wbGUgPSBmdW5jdGlvbiAoKSB7XG4vLyAgIEJzU2VhcmNoU3VnZ2VzdGlvbnMuY3VzdG9tKGZ1bmN0aW9uICgpIHtcbi8vICAgICBhamF4U3RhdGljRXhhbXBsZSgpO1xuLy8gICB9KTtcbi8vIH07XG4iLCIvKipcbiAqIFNuYWNrYmFyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbWF0ZXJpYWwtY29tcG9uZW50cy9tYXRlcmlhbC1jb21wb25lbnRzLXdlYi90cmVlL21hc3Rlci9wYWNrYWdlcy9tZGMtc25hY2tiYXJcbiAqL1xudmFyIEJzU25hY2tiYXIgPSAoZnVuY3Rpb24gKCkge1xuICAvLyBDb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBidXR0b25zOiB7XG4gICAgICB0cmlnZ2VyOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtdHJpZ2dlci1zbmFja2JhcicpLFxuICAgICAgY2xvc2U6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1jbG9zZS1zbmFja2JhcicpLFxuICAgIH0sXG4gICAgY2xhc3Nlczoge1xuICAgICAgYWxlcnQ6ICdicy1zbmFja2Jhci0tYWxlcnQnLFxuICAgICAgdmlzaWJsZTogJ2JzLXNuYWNrYmFyLS12aXNpYmxlJyxcbiAgICB9LFxuICAgIHNuYWNrYmFyczogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXNuYWNrYmFyJyksXG4gICAgdGltZW91dEZuOiBudWxsLFxuICAgIHRpbWVvdXRUaW1lOiAyNzUwLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChjb25maWcuYnV0dG9ucy50cmlnZ2VyKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5idXR0b25zLnRyaWdnZXIsIGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBzbmFja2JhcklkID0gYnV0dG9uLmRhdGFzZXQuc25hY2tiYXJJZDtcbiAgICAgICAgICBpZiAoc25hY2tiYXJJZCkgc2hvd1NuYWNrYmFyKHNuYWNrYmFySWQpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChjb25maWcuc25hY2tiYXJzKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5zbmFja2JhcnMsIGZ1bmN0aW9uIChzbmFja2Jhcikge1xuICAgICAgICBzbmFja2Jhci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KGNvbmZpZy50aW1lb3V0Rm4pO1xuICAgICAgICB9KTtcblxuICAgICAgICBzbmFja2Jhci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRpbWVvdXQoc25hY2tiYXIpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICB2YXIgc2hvd1NuYWNrYmFyID0gZnVuY3Rpb24gKHNuYWNrYmFySWQpIHtcbiAgICB2YXIgc25hY2tiYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtc25hY2tiYXJbZGF0YS1zbmFja2Jhci1pZD1cIicgKyBzbmFja2JhcklkICsgJ1wiXScpO1xuICAgIHZhciBpc1Zpc2libGUgPSBzbmFja2Jhci5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmNsYXNzZXMudmlzaWJsZSk7XG5cbiAgICBpZiAoIWlzVmlzaWJsZSAmJiBzbmFja2Jhcikge1xuICAgICAgc25hY2tiYXIuY2xhc3NMaXN0LmFkZChjb25maWcuY2xhc3Nlcy52aXNpYmxlKTtcbiAgICAgIHRpbWVvdXQoc25hY2tiYXIpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgdGltZW91dCA9IGZ1bmN0aW9uIChzbmFja2Jhcikge1xuICAgIGNvbmZpZy50aW1lb3V0Rm4gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGhpZGVTbmFja2JhcihzbmFja2Jhcik7XG4gICAgfSwgY29uZmlnLnRpbWVvdXRUaW1lKTtcbiAgfTtcblxuICB2YXIgaGlkZVNuYWNrYmFyID0gZnVuY3Rpb24gKHNuYWNrYmFyKSB7XG4gICAgc25hY2tiYXIuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY2xhc3Nlcy52aXNpYmxlKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gICAgc2hvdzogc2hvd1NuYWNrYmFyLFxuICAgIGhpZGU6IGhpZGVTbmFja2JhcixcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBCc1NuYWNrYmFyIGNvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBCc1NuYWNrYmFyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1zbmFja2JhcicpLmxlbmd0aCkge1xuICAgIEJzU25hY2tiYXIuaW5pdCgpO1xuICB9XG59KTtcbiIsInZhciBCc1NoYXJlID0gKGZ1bmN0aW9uKCkge1xuXG4gIC8vIENvbmZpZyBMaXN0IGFuZCBTZWxlY3RcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBzaGFyZVNvY2lhbDogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXNvY2lhbC1zaGFyZScpXG4gIH1cblxuICAvLyBTdGFydCBGdW5jdGlvbnMgRG93bmxvYWRcbiAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcblxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY29uZmlnLnNoYXJlU29jaWFsLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIHZhciBidXR0b25Tb2NpYWwgPSBlbC5xdWVyeVNlbGVjdG9yKCcnKTtcbiAgICBcbiAgICAgIGJ1dHRvblNvY2lhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTsgXG4gICAgICAgIFxuICAgICAgICBpZiAoYnV0dG9uU29jaWFsLmNsYXNzTGlzdC5jb250YWlucygnYnMtanMtbGluaycpKSB7XG4gICAgICAgICAgdmFyIGNvcHlMaW5rID0gZG9jdW1lbnQuVVJMO1xuICAgICAgICAgIHZhciBkdW1teSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7XG5cbiAgICAgICAgICAvLyBGaXggdG8gcHJldmVudCBzY3JvbGwgdG8gYm90dG9tLiBDcmVhdGluZyBlbGVtZW50IGluc2lkZSB0aGUgbGluayBidXR0b25cbiAgICAgICAgICBkdW1teS5zdHlsZS5oZWlnaHQgPSBcIjFweFwiO1xuICAgICAgICAgIGR1bW15LnN0eWxlLndpZHRoID0gXCIxcHhcIjtcbiAgICAgICAgICBkdW1teS5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcblxuICAgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQoZHVtbXkpO1xuICAgICAgICAgIGR1bW15LnZhbHVlID0gY29weUxpbms7XG4gICAgICAgICAgZHVtbXkuc2VsZWN0KCk7XG4gICAgICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2NvcHknKTtcbiAgICAgICAgICB0aGlzLnJlbW92ZUNoaWxkKGR1bW15KTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBzb2NpYWxGYWNlYm9vayA9IGJ1dHRvblNvY2lhbC5jbGFzc0xpc3QuY29udGFpbnMoJ2JzLWpzLWZhY2Vib29rJykgPyAnaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3NoYXJlci9zaGFyZXIucGhwP3U9JyA6ICcnO1xuICAgICAgICAgIHZhciBzb2NpYWxUd2l0dGVyID0gYnV0dG9uU29jaWFsLmNsYXNzTGlzdC5jb250YWlucygnYnMtanMtdHdpdHRlcicpID8gJ2h0dHBzOi8vdHdpdHRlci5jb20vaW50ZW50L3R3ZWV0P3VybD0nIDogJyc7XG4gICAgICAgICAgdmFyIHNvY2lhbExpbmtkaW4gPSBidXR0b25Tb2NpYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdicy1qcy1saW5rZGluJykgPyAnaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL3NoYXJlQXJ0aWNsZT9taW5pPXRydWUmdXJsPScgOiAnJztcblxuICAgICAgICAgIHZhciB1cmwgPSBzb2NpYWxGYWNlYm9vay5jb25jYXQoc29jaWFsVHdpdHRlciwgc29jaWFsTGlua2Rpbik7XG4gICAgICAgICAgdmFyIG9wZW5XaW5kb3cgPSB3aW5kb3cub3Blbih1cmwgKyBkb2N1bWVudC5VUkwsICdwb3B1cCcsICdoZWlnaHQ9NDUwLHdpZHRoPTM1MCcpO1xuXG4gICAgICAgICAgaWYgKG9wZW5XaW5kb3cuZm9jdXMpIG9wZW5XaW5kb3cuZm9jdXMoKTtcbiAgICAgICAgICBlbHNlIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0XG4gIH07XG59KCkpO1xuXG4vKipcbiogSW5pdCBNb2RhbCBDb25zdHJ1Y3RvclxuKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1zb2NpYWwtc2hhcmUnKS5sZW5ndGgpIHtcbiAgICBCc1NoYXJlLmluaXQoKTtcbiAgfVxufSk7IiwidmFyIEJzU3RpY2t5ID0gKGZ1bmN0aW9uKCkge1xuXG4gIHZhciByZWZlcmVuY2VOb2RlID0gbnVsbDtcbiAgdmFyIGNmZ05hdiA9IHt9O1xuICB2YXIgY2ZnU2l6ZSA9IHt9O1xuXG4gIC8vIFN0YXJ0IEZ1bmN0aW9ucyBOYXZcbiAgdmFyIGluaXQgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgdmFyIG5ld05vZGVDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB2YXIgbmV3Tm9kZUNoaWxkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdmFyIHBhcmVudE5vZGUgPSBudWxsO1xuXG4gICAgLy8gQ29uZmlnIG5hdiBhbmQgc2l6ZXNcbiAgICBjZmdTaXplID0ge1xuICAgICAgc2V0U2l6ZVdpbmRvdyA6IDk5MixcbiAgICAgIHNldE1hcmdpblRvcCA6IDEzMCxcbiAgICAgIHNldFBhcmVudENsYXNzOiAnYnMtanMtYXNpZGUnLFxuICAgIH1cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdvYmplY3QnKSB7XG4gICAgICBpZiAob3B0aW9ucy5zZXRTaXplV2luZG93KSBjZmdTaXplLnNldFNpemVXaW5kb3cgPSBvcHRpb25zLnNldFNpemVXaW5kb3dcbiAgICAgIGlmIChvcHRpb25zLnNldE1hcmdpblRvcCkgY2ZnU2l6ZS5zZXRNYXJnaW5Ub3AgPSBvcHRpb25zLnNldE1hcmdpblRvcFxuICAgICAgaWYgKG9wdGlvbnMuc2V0UGFyZW50Q2xhc3MpIGNmZ1NpemUuc2V0UGFyZW50Q2xhc3MgPSBvcHRpb25zLnNldFBhcmVudENsYXNzXG4gICAgfVxuXG4gICAgLy8gR2V0IHRoZSBwYXJlbnQgbm9kZVxuICAgIHJlZmVyZW5jZU5vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtc3RpY2t5JylcbiAgICBuZXdOb2RlQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2JzLXN0aWNreScpXG4gICAgaWYgKHJlZmVyZW5jZU5vZGUpIHtcbiAgICAgIHBhcmVudE5vZGUgPSByZWZlcmVuY2VOb2RlLnBhcmVudE5vZGU7XG4gICAgICBpZiAoY2ZnU2l6ZS5zZXRQYXJlbnRDbGFzcyAmJiBnZXRQYXJlbnQocmVmZXJlbmNlTm9kZSwgY2ZnU2l6ZS5zZXRQYXJlbnRDbGFzcykpIHtcbiAgICAgICAgcGFyZW50Tm9kZSA9IGdldFBhcmVudChyZWZlcmVuY2VOb2RlLCBjZmdTaXplLnNldFBhcmVudENsYXNzKTtcbiAgICAgICAgbmV3Tm9kZUNoaWxkID0gcGFyZW50Tm9kZS5jaGlsZHJlblswXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld05vZGVDaGlsZCA9IHJlZmVyZW5jZU5vZGU7XG4gICAgICB9XG4gICAgICBwYXJlbnROb2RlLmluc2VydEJlZm9yZShuZXdOb2RlQ29udGFpbmVyLCBuZXdOb2RlQ2hpbGQpO1xuICAgICAgbmV3Tm9kZUNvbnRhaW5lci5hcHBlbmRDaGlsZChuZXdOb2RlQ2hpbGQpO1xuICAgIH1cblxuICAgIGlmIChyZWZlcmVuY2VOb2RlICYmIG5ld05vZGVDb250YWluZXIpIHtcbiAgICAgIGNmZ05hdiA9IHtcbiAgICAgICAgbmF2Rml4IDogbmV3Tm9kZUNoaWxkLFxuICAgICAgICBuYXZGaXhDb250YWluZXIgOiBuZXdOb2RlQ29udGFpbmVyLFxuICAgICAgfTtcbiAgICAgIGNmZ1NpemUubmF2Rml4U3RpY2t5ID0gY2ZnTmF2Lm5hdkZpeC5vZmZzZXRUb3A7XG4gICAgICBjZmdTaXplLm5hdkZpeFN0aWNreUNvbnRhaW5lciA9IGNmZ05hdi5uYXZGaXhDb250YWluZXIub2Zmc2V0VG9wO1xuICAgICAgY2ZnU2l6ZS5uYXZQYXJlbnQgPSBjZmdOYXYubmF2Rml4LnBhcmVudE5vZGU7XG4gICAgfVxuXG4gICAgcmVzaXplSGVhZGVyT25TY3JvbGwoKTtcblxuICAgIC8vIEV4ZWN1dGEgVmVyaWZpY2HDp8OjbyBkZSB0ZWxhIGUgcmV0b3JuYSBmdW7Dp8OjbyBpbmljaWFsXG4gICAgdmlld3BvcnRXaWR0aCgpO1xuICAgIG5hdlNpemVWaWV3KCk7XG5cbiAgICAvLyBFdmVudG8gcGFyYSByZXNpemUgZGUgdmVyaWZpY2HDp8OjbyBkYSB2aWV3cG9ydCBhdGUgdGFtYW5obyBwcmVjaXNvXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICB2aWV3cG9ydFdpZHRoKCk7XG4gICAgICAgIG5hdlNpemVWaWV3KCk7XG4gICAgICB9LCA1MDApO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciB2aWV3cG9ydFdpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgIGNmZ1NpemUudmlld3BvcnRXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDtcbiAgfVxuXG4gIHZhciBuYXZTaXplVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2aWV3cG9ydFdpZHRoKCk7XG4gICAgaWYgKGNmZ1NpemUudmlld3BvcnRXaWR0aCA8IGNmZ1NpemUuc2V0U2l6ZVdpbmRvdykge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHJlc2l6ZUhlYWRlck9uU2Nyb2xsKTtcbiAgICAgIGNmZ05hdi5uYXZGaXguc3R5bGUuY3NzVGV4dCA9ICcnO1xuICAgIH0gZWxzZSB7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgcmVzaXplSGVhZGVyT25TY3JvbGwpO1xuICAgICAgY2ZnTmF2Lm5hdkZpeC5zdHlsZS53aWR0aCA9IGNmZ1NpemUubmF2UGFyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoICsgJ3B4J1xuICAgICAgcmVzaXplSGVhZGVyT25TY3JvbGwoKTtcbiAgICB9XG4gIH1cblxuICB2YXIgcmVzaXplSGVhZGVyT25TY3JvbGwgPSBmdW5jdGlvbigpIHtcblxuICAgIC8vIENvbmZpZyBuYXYgSW5zaWRlIFdpdGggU2Nyb2xsXG4gICAgdmFyIGNmZ0luc2lkZSA9IHtcbiAgICAgIC8vIENhcHR1cmEgYSBkaXN0YW5jaWEgZG8gdG9wbyBhdMOpIG8gZWxlbWVudG8gaW5jaWFsIGRhIGRpdlxuICAgICAgZGlzdGFuY2VPcmlnaW4gOiAod2luZG93LnBhZ2VZT2Zmc2V0ICksXG4gICAgICAvLyBDYXB0dXJhIGRpc3RhbmNpYXMgc2VsZWNpb25hZGFzIHBlbGEgZnVuw6fDo29cbiAgICAgIHRvcFJlY3RJbnNpZGUgOiBjZmdTaXplLm5hdlBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AsXG4gICAgICBib3R0b21SZWN0SW5zaWRlIDogY2ZnU2l6ZS5uYXZQYXJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tLFxuICAgICAgLy8gIENhcHR1cmEgYWx0dXJhIGRvIGVsZW1lbnRvIGludGVybm8gbm8gc2Nyb2xsXG4gICAgICBuYXZIZWlnaHRJbnNpZGUgOiBjZmdOYXYubmF2Rml4Lm9mZnNldEhlaWdodCxcbiAgICAgIHdpZHRoUmVjdEluc2lkZSA6IGNmZ1NpemUubmF2UGFyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoLFxuICAgICAgLy8gUmVjZWJlIHZhbG9yIGRhIGFsdHVyYSBkYSBuYXZlZ2HDp8OjbyBlIGRpbWludWkgcG9yIFRhbWFuaG8gZGEgbmF2ZWdhw6fDo29cbiAgICAgIHNldEhlYWRlciA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1oZWFkZXInKSxcbiAgICAgIHNldEhlYWRlclBpbiA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1oZWFkZXItLXBpbm5lZCcpXG4gICAgfTtcblxuICAgIC8vIEFsdHVyYSBkbyBzdGljayBwYWlcbiAgICB2YXIgY2ZnUmVjdCA9IHtcbiAgICAgIGhlaWdodFJlY3RPdXQgOiBjZmdTaXplLm5hdlBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHRcbiAgICB9XG5cbiAgICAvLyBDYWxjdWxvcyBwYXJhIGRpbWVuc2lvbmFyIHBvc2nDp8OjbyBkYSBuYXYgZW0gcmVsYcOnw6NvIGEgcGFnaW5hIGUgYW8gbWVudSBmaXhvXG4gICAgdmFyIGNmZ0NhbGMgPSB7XG4gICAgICAvLyBBZGljaW9uYSBtYXJnZW0gYSBwb3Npw6fDo28gcGFyYSBmaWNhciBmaXhhIG5vIHJvZGFww6kgZG8gZWxlbWVudG8gcGFpXG4gICAgICBuYXZIZWlnaHRDb250ZW50IDogY2ZnUmVjdC5oZWlnaHRSZWN0T3V0IC0gY2ZnSW5zaWRlLm5hdkhlaWdodEluc2lkZSxcbiAgICAgIC8vIGRlc2NvbnRhIHRhbWFuaG8gZG8gYm94IHBhcmEgaW5pY2lhciBhY2ltYSBkbyBoZWFkZXIgcGluIHNlIGV4aXN0aXJcbiAgICAgIG5hdkhlaWdodEluc2lkZSA6IGNmZ0luc2lkZS5ib3R0b21SZWN0SW5zaWRlIC0gY2ZnSW5zaWRlLm5hdkhlaWdodEluc2lkZSxcbiAgICAgIGRpc3RhbmNlUmVsYXRpdmVPcmlnaW4gOiAoY2ZnSW5zaWRlLmRpc3RhbmNlT3JpZ2luKVxuICAgIH07XG5cbiAgICB2YXIgZG93blN0YXRpYyA9IGZ1bmN0aW9uKCkge1xuICAgICAgY2ZnTmF2Lm5hdkZpeC5zdHlsZS50cmFuc2l0aW9uID0gJzBzJztcbiAgICAgIGNmZ05hdi5uYXZGaXguc3R5bGUucG9zaXRpb24gPSAnc3RhdGljJztcbiAgICAgIGNmZ05hdi5uYXZGaXguc3R5bGUudG9wID0gJzMwcHgnO1xuICAgIH1cbiAgICB2YXIgZG93bkZpeGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICBjZmdOYXYubmF2Rml4LnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICAgIGNmZ05hdi5uYXZGaXguc3R5bGUudHJhbnNpdGlvbiA9ICcuM3MnO1xuICAgICAgY2ZnTmF2Lm5hdkZpeC5zdHlsZS50b3AgPSBjZmdTaXplLnNldE1hcmdpblRvcCArICdweCc7XG4gICAgfVxuICAgIHZhciBkb3duUmVsYXRpdmUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGNmZ05hdi5uYXZGaXguc3R5bGUudHJhbnNpdGlvbiA9ICcwcyc7XG4gICAgICBjZmdOYXYubmF2Rml4LnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICAgIGNmZ05hdi5uYXZGaXguc3R5bGUudG9wID0gY2ZnQ2FsYy5uYXZIZWlnaHRDb250ZW50ICsgJ3B4JztcbiAgICAgIGNmZ05hdi5uYXZGaXguc3R5bGUudHJhbnNpdGlvbiA9IG51bGw7XG4gICAgfVxuXG4gICAgdmFyIHVwU3RhdGljID0gZnVuY3Rpb24oKSB7XG4gICAgICBjZmdOYXYubmF2Rml4LnN0eWxlLnRyYW5zaXRpb24gPSAnMHMnO1xuICAgICAgY2ZnTmF2Lm5hdkZpeC5zdHlsZS5wb3NpdGlvbiA9ICdzdGF0aWMnO1xuICAgICAgY2ZnTmF2Lm5hdkZpeC5zdHlsZS50b3AgPSAnMzBweCc7XG4gICAgfVxuICAgIHZhciB1cEZpeGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICBjZmdOYXYubmF2Rml4LnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICAgIGNmZ05hdi5uYXZGaXguc3R5bGUudG9wID0gY2ZnU2V0SGVhZGVyLmhlYWRlck9yaWdpbiArIDMwICsncHgnO1xuICAgIH1cbiAgICB2YXIgdXBSZWxhdGl2ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgY2ZnTmF2Lm5hdkZpeC5zdHlsZS50cmFuc2l0aW9uID0gJzBzJztcbiAgICAgIGNmZ05hdi5uYXZGaXguc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xuICAgICAgY2ZnTmF2Lm5hdkZpeC5zdHlsZS50b3AgPSBjZmdDYWxjLm5hdkhlaWdodENvbnRlbnQgKyAncHgnO1xuICAgIH1cblxuXG4gICAgaWYgKGNmZ0luc2lkZS5zZXRIZWFkZXIpIHtcbiAgICAgIC8vIENhbGN1bG9zIHBhcmEgZGltZW5zaW9uYXIgcG9zacOnw6NvIGRhIG5hdiBlbSByZWxhw6fDo28gYSBwYWdpbmEgZSBhbyBtZW51IGZpeG9cbiAgICAgIGNmZ1NldEhlYWRlciA9IHtcbiAgICAgICAgaGVhZGVyT3JpZ2luIDogKGNmZ0luc2lkZS5zZXRIZWFkZXIub2Zmc2V0SGVpZ2h0KVxuICAgICAgfVxuICAgICAgLy8gY2ZnSW5zaWRlLmRpc3RhbmNlT3JpZ2luIC09IGNmZ1NldEhlYWRlci5oZWFkZXJPcmlnaW47XG4gICAgICAvLyBjb25zb2xlLmxvZygnZGlzdGFuY2VPcmlnaW46ICcsIGNmZ0luc2lkZS5kaXN0YW5jZU9yaWdpbik7XG4gICAgfVxuXG4gICAgLy8gcmVjYWxjdWxhIG9mZnNldFRvcCBicy1qcy1zdGlja1xuICAgIGNmZ1NpemUubmF2Rml4U3RpY2t5ID0gY2ZnTmF2Lm5hdkZpeC5vZmZzZXRUb3A7XG4gICAgLy8gcmVjYWxjdWxhIG9mZnNldFRvcCBkbyBmaWxob1xuICAgIGNmZ1NpemUubmF2Rml4U3RpY2t5Q29udGFpbmVyID0gY2ZnTmF2Lm5hdkZpeENvbnRhaW5lci5vZmZzZXRUb3A7XG4gICAgLy8gQWRpY2lvbmEgVGFtYW5obyBPcmlnaW5hbCBkYSBkaXYgUGFpXG4gICAgY2ZnTmF2Lm5hdkZpeC5zdHlsZS53aWR0aCA9IGNmZ0luc2lkZS53aWR0aFJlY3RJbnNpZGUgKyAncHgnXG4gICAgLy8gQXR1YWxpemEgbWFyZ2VtIGEgcG9zacOnw6NvIHBhcmEgZmljYXIgZml4YSBubyByb2RhcMOpIGRvIGVsZW1lbnRvIHBhaVxuXG4gICAgLy8gU2UgdGl2ZXIgaGVhZGVyIGNvbSBwaW5cbiAgICBpZiAoY2ZnSW5zaWRlLnNldEhlYWRlclBpbikge1xuICAgICAgLy8gTmF2ZWdhw6fDo28gU2UgZmluYWwgZG8gZWxlbWVudG8gZml4YSByZWxhdGl2b1xuICAgICAgLy8gRW5xdWFudG8gc29iZSBvIGVzdGF0aWNvIG5vIHRvcG9cbiAgICAgIGlmIChjZmdDYWxjLm5hdkhlaWdodEluc2lkZSAtIDMwIDwgKGNmZ1NldEhlYWRlci5oZWFkZXJPcmlnaW4pKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCd1cFJlbGF0aXZlKCknKTtcbiAgICAgICAgdXBSZWxhdGl2ZSgpXG4gICAgICB9IGVsc2UgaWYoKChjZmdDYWxjLmRpc3RhbmNlUmVsYXRpdmVPcmlnaW4gKyAzMCkgKyBjZmdTZXRIZWFkZXIuaGVhZGVyT3JpZ2luKSA8IChjZmdTaXplLm5hdkZpeFN0aWNreUNvbnRhaW5lciApKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCd1cFN0YXRpYygpJyk7XG4gICAgICAgIHVwU3RhdGljKClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCd1cEZpeGVkKCknKTtcbiAgICAgICAgdXBGaXhlZCgpXG4gICAgICB9XG5cbiAgICAvLyBTZSB0aXZlciBoZWFkZXIgc2VtIHBpblxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBOYXZlZ2HDp8OjbyBTZSBmaW5hbCBkbyBlbGVtZW50byBmaXhhIHJlbGF0aXZvXG4gICAgICAvLyBRdWFuZG8gcGFyYSBubyBib3R0b20gZG8gcGFpXG4gICAgICBpZiAoY2ZnQ2FsYy5uYXZIZWlnaHRJbnNpZGUgPCBjZmdTaXplLnNldE1hcmdpblRvcCkge1xuICAgICAgICBkb3duUmVsYXRpdmUoKVxuICAgICAgfVxuICAgICAgLy8tIEFsdHVyYSBSZWxhdGl2YSBkbyBOYXYgJ3NlJyBNYWlvciBxdWUgJ0FsdHVyYSBkbyBNZW51J1xuICAgICAgLy8gRml4YSBubyB0b3AgYSBuYXZlZ2HDp8Ojb1xuICAgICAgZWxzZSBpZigoKGNmZ0luc2lkZS5kaXN0YW5jZU9yaWdpbiArIDMwKSA+IChjZmdTaXplLm5hdkZpeFN0aWNreUNvbnRhaW5lcikpKSB7XG4gICAgICAgIGRvd25GaXhlZCgpXG4gICAgICB9XG4gICAgICAvLyBEaXN0YW5jaWEgYXRlIGEgYWx0dXJhIGRvIHNjcm9sbCByZWxhdGl2byBhbyBhbHR1cmEgZml4YSBkbyBtYXJnaW4gdG9wXG4gICAgICAvLyAtIEVucXVhbnRvIGVzdGF0aWNvIG5hIHBhZ2luYSBhbnRlcyBkZSBmaXhhciBubyB0b3BvXG4gICAgICBlbHNlIGlmKGNmZ0NhbGMuZGlzdGFuY2VSZWxhdGl2ZU9yaWdpbiA8IGNmZ1NpemUubmF2Rml4U3RpY2t5Q29udGFpbmVyKSB7XG4gICAgICAgIGRvd25TdGF0aWMoKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgICBpbml0OiBpbml0LFxuICAgICAgbG9hZDogcmVzaXplSGVhZGVyT25TY3JvbGwsXG4gIH07XG59KCkpO1xuXG4vKipcbiogSW5pdCBNb2RhbCBDb25zdHJ1Y3RvclxuKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1zdGlja3knKS5sZW5ndGgpIHtcbiAgICBCc1N0aWNreS5pbml0KCk7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgQnNTdGlja3kubG9hZCgpO1xuICAgIH0pO1xuICB9XG59KTtcbiIsIi8qKlxuICogVGFiZWxhIGRlIFJlc3VsdGFkbyBkZSBTb3J0ZWlvc1xuICogUG9kZSBleHBhbmRpciBsaW5oYXMgcGFyYSBleGliaXIgdW0gY29udGXDumRvIG1haW9yXG4gKlxuICovXG52YXIgQnNUYWJsZUNvbGxhcHNpYmxlID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gQ29uZmlnXG4gIHZhciBjb25maWcgPSB7XG4gICAgdGFibGU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy10YWJsZS0tY29sbGFwc2libGUnKSxcbiAgICBidXR0b25zOiB7XG4gICAgICB0cmlnZ2VyOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtdHJpZ2dlci1jb2xsYXBzaWJsZScpLFxuICAgICAgc29ydDogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXNvcnQtY29sbGFwc2libGUnKSxcbiAgICB9LFxuICAgIHRhYmxlRmlsdGVyU2VsZWN0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtZmlsdGVyLXRhYmxlLWNvbGxhcHNpYmxlLWl0ZW1zJyksXG4gICAgdGFibGVSb3dzOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtdGFibGVfX3JvdycpLFxuICAgIHRhYmxlSXRlbXM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy10YWJsZS1jb2xsYXBzaWJsZS1pdGVtJyksXG4gICAgY2xhc3Nlczoge1xuICAgICAgcm93Q29sbGFwc2VkOiAnYnMtdGFibGVfX3Jvdy0tY29sbGFwc2VkJyxcbiAgICAgIHRhYmxlUm93OiAnYnMtdGFibGVfX3JvdycsXG4gICAgICByb3dBY3RpdmU6ICdicy10YWJsZV9fcm93LS1hY3RpdmUnLFxuICAgICAgdGFibGVIYXNGaWx0ZXI6ICdicy1oYXMtZmlsdGVyJyxcbiAgICB9LFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChjb25maWcuYnV0dG9ucy50cmlnZ2VyKSB7XG4gICAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5idXR0b25zLnRyaWdnZXIsIGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRvZ2dsZVJvdyhidXR0b24pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChjb25maWcudGFibGUpIHtcbiAgICAgIEJzVGFibGVTb3J0LmluaXQoY29uZmlnLnRhYmxlLnF1ZXJ5U2VsZWN0b3IoJ3RhYmxlJykpO1xuICAgIH1cblxuICAgIGlmIChjb25maWcudGFibGVGaWx0ZXJTZWxlY3QpIHtcbiAgICAgIGNvbmZpZy50YWJsZUZpbHRlclNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgdmFyIGlkID0gZXYudGFyZ2V0LnZhbHVlO1xuICAgICAgICBmaWx0ZXJJdGVtcyhpZCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGZpbHRlckl0ZW1zID0gZnVuY3Rpb24gKGZpbHRlcklkKSB7XG4gICAgdmFyIGFjdGl2ZUl0ZW07XG4gICAgdmFyIGFjdGl2ZUl0ZW1Sb3cgPSAnJztcbiAgICB2YXIgY3VycmVudEFjdGl2ZVJvdyA9IGNvbmZpZy50YWJsZS5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5jbGFzc2VzLnJvd0FjdGl2ZSk7XG5cbiAgICBpZiAodHlwZW9mIGZpbHRlcklkICE9PSAnc3RyaW5nJykgcmV0dXJuO1xuXG4gICAgYWN0aXZlSXRlbSA9IGNvbmZpZy50YWJsZS5xdWVyeVNlbGVjdG9yKCcuYnMtanMtdGFibGUtY29sbGFwc2libGUtaXRlbVtkYXRhLWl0ZW0taWQ9XCInICsgZmlsdGVySWQgKyAnXCJdJyk7XG4gICAgYWN0aXZlSXRlbVJvdyA9IGdldFBhcmVudChhY3RpdmVJdGVtLCAnYnMtdGFibGVfX3JvdycpO1xuXG4gICAgaWYgKGN1cnJlbnRBY3RpdmVSb3cpIGN1cnJlbnRBY3RpdmVSb3cuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY2xhc3Nlcy5yb3dBY3RpdmUpO1xuXG4gICAgaWYgKGZpbHRlcklkID09PSAnJykge1xuICAgICAgY29uZmlnLnRhYmxlLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMudGFibGVIYXNGaWx0ZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25maWcudGFibGUuY2xhc3NMaXN0LmFkZChjb25maWcuY2xhc3Nlcy50YWJsZUhhc0ZpbHRlcik7XG4gICAgICBhY3RpdmVJdGVtUm93LmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMucm93QWN0aXZlKTtcbiAgICB9XG4gIH07XG5cblxuICB2YXIgdG9nZ2xlUm93ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICB2YXIgcm93ID0gZ2V0Um93KGVsZW1lbnQpO1xuXG4gICAgaWYgKHJvdyAmJiByb3cuY2xhc3NMaXN0LmNvbnRhaW5zKGNvbmZpZy5jbGFzc2VzLnJvd0NvbGxhcHNlZCkpIHtcbiAgICAgIHJvdy5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLnJvd0NvbGxhcHNlZCk7XG4gICAgfSBlbHNlIGlmICghcm93LmNsYXNzTGlzdC5jb250YWlucyhjb25maWcuY2xhc3Nlcy5yb3dDb2xsYXBzZWQpKSB7XG4gICAgICByb3cuY2xhc3NMaXN0LmFkZChjb25maWcuY2xhc3Nlcy5yb3dDb2xsYXBzZWQpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgZ2V0Um93ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gZ2V0UGFyZW50cyhlbGVtZW50LCBjb25maWcuY2xhc3Nlcy50YWJsZVJvdylbMF07XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcblxuLyoqXG4gKiBJbml0IEJzVGFibGVDb2xsYXBzaWJsZSBjb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gQnNUYWJsZUNvbGxhcHNpYmxlLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy10YWJsZS0tY29sbGFwc2libGUnKSkge1xuICAgIEJzVGFibGVDb2xsYXBzaWJsZS5pbml0KCk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBUYWJzLmpzXG4gKiBHdWlhcyAodGFicykgb3JnYW5pemFtIGUgcGVybWl0ZW0gYSBuYXZlZ2HDp8OjbyBlbnRyZSBncnVwb3MgZGUgY29udGXDumRvXG4gKiBxdWUgZXN0w6NvIHJlbGFjaW9uYWRvcyBlIHBvc3N1ZW0gbyBtZXNtbyBuw612ZWwgZGUgaGllcmFycXVpYS5cbiAqXG4gKiBSZWZlcmVuY2VzOlxuICogLSBodHRwczovL3d3dy53My5vcmcvVFIvd2FpLWFyaWEtcHJhY3RpY2VzL2V4YW1wbGVzL3RhYnMvdGFicy0xL3RhYnMuaHRtbFxuICogLSBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9qb25hdGhhbnRuZWFsLzQzNTQ3OGU0MTViZmU0ZjU0ZDA2XG4gKiAtIGh0dHBzOi8vY29keWhvdXNlLmNvL2dlbS9yZXNwb25zaXZlLXRhYmJlZC1uYXZpZ2F0aW9uL1xuICogLSBodHRwczovL3V4cGxhbmV0Lm9yZy90YWJzLWZvci1tb2JpbGUtdXgtZGVzaWduLWQ0Y2M0ZDk0MTBkMVxuICogLSBodHRwczovL3d3dy5ubmdyb3VwLmNvbS9hcnRpY2xlcy90YWJzLXVzZWQtcmlnaHQvXG4gKiAtIGh0dHBzOi8vbWF0ZXJpYWwuaW8vZGVzaWduL2NvbXBvbmVudHMvdGFicy5odG1sI3N0YXRlc1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gdGhlIG1vZHVsZSBtZXRob2RzXG4gKi9cbnZhciBCc1RhYnMgPSBmdW5jdGlvbiAoKSB7XG4gIC8qKlxuICAgKiBDb25maWcgb2JqZWN0XG4gICAqIEB0eXBlIHtPYmplY3R9XG4gICAqL1xuICB2YXIgY29uZmlnID0ge307XG5cbiAgLyoqXG4gICAqIFNldCBDb25maWdcbiAgICogQHBhcmFtICB7T2JqZWN0fSBlbCBhIERPTSBlbGVtZW50XG4gICAqIEByZXR1cm4ge09iamVjdH0gICAgbW9kdWxlJ3MgY29uZmlnIG9iamVjdFxuICAgKi9cbiAgdmFyIHNldENvbmZpZyA9IGZ1bmN0aW9uIChlbCkge1xuICAgIHJldHVybiB7XG4gICAgICB0YWJzOiBlbCxcbiAgICAgIGxpc3Q6IGVsLnF1ZXJ5U2VsZWN0b3IoJy5icy10YWJzX19saXN0JyksXG4gICAgICBpdGVtczogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLXRhYnNfX2xpbmsnKSxcbiAgICAgIHBhbmVsOiBlbC5xdWVyeVNlbGVjdG9yKCcuYnMtdGFic19fcGFuZWwtaXRlbXMnKSxcbiAgICAgIHBhbmVsQ29udGVudDogZWwucXVlcnlTZWxlY3RvckFsbCgnLmJzLXRhYnNfX2NvbnRlbnQnKSxcbiAgICAgIHBhbmVsU2xpZGVyOiBlbC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtcGFuZWwtc2xpZGVyJyksXG4gICAgICBhcnJvd3M6IGVsLnF1ZXJ5U2VsZWN0b3IoJy5icy10YWJzX19hcnJvd3MnKSxcbiAgICAgIGJ1dHRvblByZXY6IGVsLnF1ZXJ5U2VsZWN0b3IoJy5icy10YWJzX19hcnJvdy1wcmV2JyksXG4gICAgICBidXR0b25OZXh0OiBlbC5xdWVyeVNlbGVjdG9yKCcuYnMtdGFic19fYXJyb3ctbmV4dCcpLFxuICAgICAgY2xhc3Nlczoge1xuICAgICAgICBjb250ZW50QWN0aXZlOiAnYnMtdGFic19fY29udGVudC0tYWN0aXZlJyxcbiAgICAgICAgdGFiQWN0aXZlOiAnYnMtaXMtYWN0aXZlJyxcbiAgICAgIH0sXG4gICAgICBmbGt0eVRhYnM6IG51bGwsXG4gICAgICBmbGt0eVBhbmVsOiBudWxsLFxuICAgICAgc2VsZWN0VGFiT25SZWFkeTogdHJ1ZSxcbiAgICB9O1xuICB9O1xuXG4gIC8qKlxuICAgKiBJbml0IG1vZHVsZVxuICAgKiBAcGFyYW0gIHtPYmplY3R9IGVsZW0gYSBET00gZWxlbWVudFxuICAgKi9cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoZWxlbSkge1xuICAgIC8vIHJldHVybiBpZiB0aGVyZSdzIG5vdCBhbiBlbGVtZW50XG4gICAgaWYgKCFlbGVtIHx8IHR5cGVvZiBlbGVtICE9PSAnb2JqZWN0JykgcmV0dXJuO1xuICAgIC8vIHBhc3MgZWxlbSB0byBzZXQgY29uZmlnXG4gICAgY29uZmlnID0gc2V0Q29uZmlnKGVsZW0pO1xuXG4gICAgLy8gUmVtb3ZlIHRhYiBpZiB0aGVyZSdzIG9ubHkgb25lXG4gICAgaWYgKGNvbmZpZy5pdGVtcy5sZW5ndGggPCAyKSB7XG4gICAgICBjb25maWcudGFicy5jbGFzc0xpc3QuYWRkKCdicy10YWJzLS1yZW1vdmUtdGFiJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRlYm91bmNlKGJ1aWxkU2xpZGVyKCkpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQnVpbGQgU2xpZGVyXG4gICAqIFNsaWRlcnMgZm9yIHRhYnMgYW5kIGNvbnRlbnRcbiAgICovXG4gIHZhciBidWlsZFNsaWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBJbml0IGEgdG9nZ2xlQ29udGVudFxuICAgIHZhciBjb250ZW50VG9nZ2xlciA9IG5ldyBCc1RvZ2dsZUNvbnRlbnQoKTtcblxuICAgIC8vIFNldCB0aGUgdGFicyBzbGlkZXJcbiAgICBjb25maWcuZmxrdHlUYWJzID0gbmV3IEZsaWNraXR5KGNvbmZpZy5saXN0LCB7XG4gICAgICAvLyBhZGQgcGFuZWwgYXNOYXZGb3IgaWYgaXQncyBkZWZpbmVkIGFzIHNsaWRlclxuICAgICAgYXNOYXZGb3I6IGNvbmZpZy5wYW5lbFNsaWRlciB8fCBmYWxzZSxcbiAgICAgIGNlbGxBbGlnbjogJ2xlZnQnLFxuICAgICAgYWRhcHRpdmVIZWlnaHQ6IHRydWUsXG4gICAgICBwYWdlRG90czogZmFsc2UsXG4gICAgICBwcmV2TmV4dEJ1dHRvbnM6IGZhbHNlLFxuICAgICAgY29udGFpbjogdHJ1ZSxcbiAgICAgIGdyb3VwQ2VsbHM6IHRydWUsXG4gICAgICBvbjoge1xuICAgICAgICByZWFkeTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJlbG9hZEZsa3R5KHRoaXMsIDEwMDApO1xuICAgICAgICAgIG9uVGFic1JlYWR5KCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gaWYgcGFuZWwncyBkZWZpbmVkIGFzIHNsaWRlclxuICAgIGlmIChjb25maWcucGFuZWxTbGlkZXIpIHtcbiAgICAgIC8vIFNldCB0aGUgcGFuZWwgc2xpZGVyXG4gICAgICBjb25maWcuZmxrdHlQYW5lbCA9IG5ldyBGbGlja2l0eShjb25maWcucGFuZWxTbGlkZXIsIHtcbiAgICAgICAgcGFnZURvdHM6IGZhbHNlLFxuICAgICAgICBjZWxsQWxpZ246ICdsZWZ0JyxcbiAgICAgICAgYWRhcHRpdmVIZWlnaHQ6IHRydWUsXG4gICAgICAgIHByZXZOZXh0QnV0dG9uczogZmFsc2UsXG4gICAgICAgIGFjY2Vzc2liaWxpdHk6IGZhbHNlLFxuICAgICAgICBvbjoge1xuICAgICAgICAgIHJlYWR5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZWxvYWRGbGt0eSh0aGlzLCAxMDAwKTtcbiAgICAgICAgICAgIG9uVGFic1JlYWR5KCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoY29uZmlnLml0ZW1zICYmIGNvbmZpZy5wYW5lbENvbnRlbnQpIHtcbiAgICAgIC8vIHNldCBjb250ZW50IHRvZ2dsZXJcbiAgICAgIG9wdGlvbnMgPSB7XG4gICAgICAgIGJ1dHRvbnM6IGNvbmZpZy5pdGVtcyxcbiAgICAgICAgY29udGFpbmVyczogY29uZmlnLnBhbmVsQ29udGVudCxcbiAgICAgICAgYWN0aXZlQnV0dG9uQ2xhc3M6IGNvbmZpZy5jbGFzc2VzLnRhYkFjdGl2ZSxcbiAgICAgICAgYWN0aXZlQ29udGFpbmVyQ2xhc3M6IGNvbmZpZy5jbGFzc2VzLmNvbnRlbnRBY3RpdmUsXG4gICAgICAgIG1ldGhvZDogJ2NsaWNrJyxcbiAgICAgIH07XG4gICAgICBjb250ZW50VG9nZ2xlci5pbml0KG9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8vIE9uIFRhYnMgc2VsZWN0XG4gICAgY29uZmlnLmZsa3R5VGFicy5vbignc2VsZWN0JywgZnVuY3Rpb24gKCkge1xuICAgICAgLy8gdmlld3BvcnQncyB3aWR0aCBvZiB0aGUgdGFicyBjb250YWluZXJcbiAgICAgIHZhciBvZmZTZXQgPSBjb25maWcudGFicy5vZmZzZXRXaWR0aDtcblxuICAgICAgLy8gc3VtIG9mIHRoZSBlYWNoIHRhYidzIHdpZHRoXG4gICAgICB2YXIgdG90YWxSZWR1Y2UgPSBBcnJheS5wcm90b3R5cGUucmVkdWNlLmNhbGwoY29uZmlnLml0ZW1zLCBmdW5jdGlvbiAod2lkdGgsIGVsKSB7XG4gICAgICAgIHdpZHRoICs9IGVsLm9mZnNldFdpZHRoO1xuICAgICAgICByZXR1cm4gd2lkdGg7XG4gICAgICB9LCAwKTtcblxuICAgICAgdmFyIGNlbGxzID0gY29uZmlnLmZsa3R5VGFicy5jZWxscztcbiAgICAgIHZhciBzZWxlY3RlZEluZGV4ID0gY29uZmlnLmZsa3R5VGFicy5zZWxlY3RlZEluZGV4O1xuXG4gICAgICAvLyBpZiB0aGUgZmlyc3QgZ3JvdXAgb2YgdGFicyBpcyBzZWxlY3RlZFxuICAgICAgaWYgKCFjZWxsc1tzZWxlY3RlZEluZGV4IC0gMV0pIHtcbiAgICAgICAgLy8gZGlzYWJsZSBwcmV2aW91cyBidXR0b24gb24gaG92ZXJcbiAgICAgICAgY29uZmlnLmJ1dHRvblByZXYuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgICBjb25maWcudGFicy5jbGFzc0xpc3QucmVtb3ZlKCdicy10YWJzLS1vdmVyLXByZXYnKTtcblxuICAgICAgICAvLyBpZiB2aWV3cG9ydCBvZmZzZXQgaXMgbGVzcyB0aGFuIHRoZSBzdW0gb2YgZWFjaCB0YWIncyB3aWR0aFxuICAgICAgICBpZiAob2ZmU2V0IDwgdG90YWxSZWR1Y2UpIHtcbiAgICAgICAgICAvLyBzaG93IGFycm93c1xuICAgICAgICAgIGNvbmZpZy5hcnJvd3Muc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgLy8gZW5hYmxlIG5leHQgYnV0dG9uIG9uIGhvdmVyXG4gICAgICAgICAgY29uZmlnLmJ1dHRvbk5leHQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgICAgIGNvbmZpZy50YWJzLmNsYXNzTGlzdC5hZGQoJ2JzLXRhYnMtLW92ZXItbmV4dCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGhpZGUgYXJyb3dzXG4gICAgICAgICAgY29uZmlnLmFycm93cy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9XG5cbiAgICAgIC8vIGlmIHRoZSBncm91cCBvZiB0YWJzIHNlbGVjdGVkIGlzIG5vdCB0aGUgZmlyc3RcbiAgICAgIH0gZWxzZSBpZiAoIWNlbGxzW2NlbGxzLmxlbmd0aF0pIHtcbiAgICAgICAgLy8gc2hvdyBhcnJvd3NcbiAgICAgICAgY29uZmlnLmFycm93cy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgLy8gZW5hYmxlIHByZXZpb3VzIGJ1dHRvblxuICAgICAgICBjb25maWcuYnV0dG9uUHJldi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG4gICAgICAgIGNvbmZpZy50YWJzLmNsYXNzTGlzdC5hZGQoJ2JzLXRhYnMtLW92ZXItcHJldicpO1xuXG4gICAgICAgIC8vIGlmIHRoZSBsYXN0IGdyb3VwIG9mIHRhYnMgaXMgc2VsZWN0ZWRcbiAgICAgICAgaWYgKHNlbGVjdGVkSW5kZXggPT09IChjb25maWcuZmxrdHlUYWJzLnNsaWRlcy5sZW5ndGggLSAxKSkge1xuICAgICAgICAgIC8vIGRpc2FibGUgcHJldmlvdXMgYnV0dG9uXG4gICAgICAgICAgY29uZmlnLmJ1dHRvbk5leHQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgICAgIGNvbmZpZy50YWJzLmNsYXNzTGlzdC5yZW1vdmUoJ2JzLXRhYnMtLW92ZXItbmV4dCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGVuYWJsZSBuZXh0IGJ1dHRvblxuICAgICAgICAgIGNvbmZpZy5idXR0b25OZXh0LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICBjb25maWcudGFicy5jbGFzc0xpc3QuYWRkKCdicy10YWJzLS1vdmVyLW5leHQnKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY29uZmlnLmFycm93cy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uZmlnLmZsa3R5VGFicy5yZXNpemUoKTtcblxuICAgIGNvbmZpZy5idXR0b25QcmV2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uZmlnLmZsa3R5VGFicy5wcmV2aW91cygpO1xuICAgIH0pO1xuICAgIGNvbmZpZy5idXR0b25OZXh0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uZmlnLmZsa3R5VGFicy5uZXh0KCk7XG4gICAgfSk7XG5cbiAgICAvLyByZW1vdmUgcHLDqSBzdHlsZSBkZWZhdWx0XG4gICAgY29uZmlnLmxpc3Quc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gIH07XG5cbiAgLyoqXG4gICAqIE9uIFRhYnMgU2xpZGVyJ3MgUmVhZHlcbiAgICogVG8gcnVuIHdoZW4gdGFiIHNsaWRlciAoZmxpY2tpdHkpIGlzIHJlYWR5XG4gICAqL1xuICB2YXIgb25UYWJzUmVhZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGNvbmZpZy5zZWxlY3RUYWJPblJlYWR5KSBzZXRUaW1lb3V0KHNlbGVjdFRhYk9uUmVhZHksIDEwMCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNlbGVjdCBUYWIgT25SZWFkeVxuICAgKiBDaGVjayBpZiB0aGVyZSdzIGEgaGFzaCBvbiBVUkwgYW5kIGlmIGl0IG1hdGNoIGFuIHRhYiBJRFxuICAgKi9cbiAgdmFyIHNlbGVjdFRhYk9uUmVhZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGluZGV4ID0gLTE7XG4gICAgdmFyIHRhYiA9IG51bGw7XG4gICAgdmFyIGhhc2ggPSBnZXRIYXNoQXNJZEZyb21VcmxTdHJpbmcod2luZG93LmxvY2F0aW9uLmhhc2gpO1xuICAgIC8vIGNoZWNrIGlmIGhhc2ggbWF0Y2ggYW4gZWxlbWVudFxuICAgIGlmIChoYXNoKSB0YWIgPSBjb25maWcudGFicy5xdWVyeVNlbGVjdG9yKGhhc2gpO1xuICAgIC8vIGlmIHRoZXJlJ3MgYW4gZWxlbWVudCwgY2hlY2sgaWYgaXQncyBhIHRhYlxuICAgIGlmICh0YWIpIGluZGV4ID0gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChjb25maWcuaXRlbXMsIHRhYik7XG4gICAgLy8gaWYgaXQncyBhIHRhYiwgc2VsZWN0IGl0XG4gICAgaWYgKGluZGV4ID4gLTEpIHNlbGVjdFRhYihpbmRleCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNlbGVjdCBUYWJcbiAgICogQHBhcmFtICB7TnVtYmVyfSBpbmRleCB0aGUgaW5kZXggb2YgdGhlIHRhYlxuICAgKi9cbiAgdmFyIHNlbGVjdFRhYiA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgIC8vIGlmIHBhbmVsIGlzIGEgc2xpZGVyXG4gICAgaWYgKGNvbmZpZy5mbGt0eVBhbmVsKSB7XG4gICAgICAvLyBzZWxlY3QgdGhlIHNsaWRlIGluZGV4XG4gICAgICBjb25maWcuZmxrdHlQYW5lbC5zZWxlY3QoaW5kZXgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyB0cmlnZ2VyIGEgY2xpY2sgb24gdGhlIGluZGV4IHRhYlxuICAgICAgLy8gdGhlIGNsaWNrIGlzIG5lY2Vzc2FyeSBoZXJlIHRvIHJ1biBvdGhlciBldmVudHMgYXRhY2hlZCB0byB0aGVcbiAgICAgIC8vIGVsZW1lbnQsIHJlbGF0ZWQgdG8gQnNUb2dnbGVDb250ZW50XG4gICAgICBjb25maWcuaXRlbXNbaW5kZXhdLmNsaWNrKCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgdGhlIFRhYiBTbGlkZXIgT2JqZWN0XG4gICAqIEByZXR1cm4ge09iamVjdH0gdGhlIGZsaWNraXR5IG9iamVjdCBvZiB0aGUgdGFic1xuICAgKi9cbiAgdmFyIGdldEZsa3R5VGFicyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY29uZmlnLmZsa3R5VGFicztcbiAgfTtcblxuICAvKipcbiAgICogR2V0IHRoZSBUYWJzIG1vZHVsZVxuICAgKiBAcmV0dXJuIHtPYmplY3R9IHRoZSBtb2R1bGUgaW5zdGFuY2VcbiAgICovXG4gIHZhciBnZXRUYWJzID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBic01vZHVsZTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gICAgZ2V0OiBnZXRUYWJzLFxuICAgIHJlYWR5OiBvblRhYnNSZWFkeSxcbiAgICBzZWxlY3Q6IHNlbGVjdFRhYixcbiAgICBmbGt0eVRhYnM6IGdldEZsa3R5VGFicyxcbiAgfTtcbn07XG5cbi8qKlxuICogSW5pdCBCc1RhYnMgY29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEJzVGFicy5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciB0YWJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXRhYi0tc2xpZGVyJyk7XG4gIGlmICh0YWJzLmxlbmd0aCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwodGFicywgZnVuY3Rpb24gKGVsKSB7XG4gICAgICB2YXIgdGFiID0gbmV3IEJzVGFicygpO1xuICAgICAgdGFiLmluaXQoZWwpO1xuICAgIH0pO1xuICB9XG59KTtcbiIsInZhciBCc1RlbGVjb3JkaW9uID0gKGZ1bmN0aW9uICgpIHtcblxuICB2YXIgY29uZmlnID0ge1xuICAgIGVsczogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXRlbGVjb3JkaW9uJyksXG4gICAgaXRlbTogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXRlbGVjb3JkaW9uX19pdGVtJyksXG4gICAgYm94OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtdGVsZWNvcmRpb25fX2JveCcpLFxuICAgIHRyaWdnZXI6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1vcGVuLXRlbGVjb3JkaW9uJyksXG4gICAgaXRlbUNsYXNzOiAnYnMtdGVsZWNvcmRpb25fX2l0ZW0nLFxuICAgIGJveENsYXNzOiAnYnMtdGVsZWNvcmRpb25fX2JveCcsXG4gICAgaGVhZGVyQ2xhc3M6ICdicy10ZWxlY29yZGlvbl9faGVhZGVyJyxcbiAgICBhY3RpdmVDbGFzczogJ2lzLWV4cGFuZGVkJyxcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgcmVzaXplVGltZXI7XG5cbiAgICAvLyBBZGQgZXhwYW5kL2NvbGxhcHNlIGV2ZW50XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcudHJpZ2dlciwgZnVuY3Rpb24gKHRyaWdnZXIpIHtcbiAgICAgIHZhciBwYXJlbnQgPSB0cmlnZ2VyLmNsb3Nlc3QoJy4nICsgY29uZmlnLml0ZW1DbGFzcyk7XG4gICAgICB0cmlnZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlLmJpbmQobnVsbCwgcGFyZW50KSk7XG4gICAgICBhZGp1c3RIZWlnaHQocGFyZW50KTtcbiAgICB9KTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjbGVhclRpbWVvdXQocmVzaXplVGltZXIpO1xuICAgICAgcmVzaXplVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuaXRlbSwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICBhZGp1c3RIZWlnaHQoaXRlbSk7XG4gICAgICAgIH0pO1xuICAgICAgfSwgMjUwKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgdG9nZ2xlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBpZiAoaXNFeHBhbmRlZChpdGVtKSkgY29sbGFwc2UoaXRlbSk7XG4gICAgZWxzZSBleHBhbmQoaXRlbSk7XG4gIH07XG5cbiAgdmFyIGV4cGFuZCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaXRlbS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5hY3RpdmVDbGFzcyk7XG4gICAgYWRqdXN0SGVpZ2h0KGl0ZW0pO1xuICB9O1xuXG4gIHZhciBjb2xsYXBzZSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5hY3RpdmVDbGFzcyk7XG4gICAgYWRqdXN0SGVpZ2h0KGl0ZW0pO1xuICB9O1xuXG4gIHZhciBpc0V4cGFuZGVkID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICByZXR1cm4gaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmFjdGl2ZUNsYXNzKTtcbiAgfTtcblxuICB2YXIgYWRqdXN0SGVpZ2h0ID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgYm94ID0gaXRlbS5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5ib3hDbGFzcyk7XG4gICAgdmFyIGhlaWdodCA9IGlzRXhwYW5kZWQoaXRlbSkgPyBnZXRJdGVtSGVpZ2h0KGl0ZW0pIDogZ2V0SGVhZGVySGVpZ2h0KGl0ZW0pO1xuICAgIGJveC5zdHlsZS5oZWlnaHQgPSAoaGVpZ2h0ID4gNjAgPyBoZWlnaHQgOiA2MCkgKyAncHgnO1xuICB9O1xuXG4gIHZhciBnZXRJdGVtSGVpZ2h0ID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgYm94ID0gaXRlbS5xdWVyeVNlbGVjdG9yKCcuJyArIGNvbmZpZy5ib3hDbGFzcyk7XG4gICAgcmV0dXJuIGJveC5zY3JvbGxIZWlnaHQ7XG4gIH07XG5cbiAgdmFyIGdldEhlYWRlckhlaWdodCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIGhlYWRlciA9IGl0ZW0ucXVlcnlTZWxlY3RvcignLicgKyBjb25maWcuaGVhZGVyQ2xhc3MpO1xuICAgIHJldHVybiBoZWFkZXIuc2Nyb2xsSGVpZ2h0O1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBNb2RhbCBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gSGVhZGVyLmluaXQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy10ZWxlY29yZGlvbicpLmxlbmd0aCkge1xuICAgIEJzVGVsZWNvcmRpb24uaW5pdCgpO1xuICB9XG59KTtcbiIsIi8qKlxuICogQnNUaW1lTGluZVxuICogQHJldHVybiBNb2R1bGUgY29uZmlnXG4gKi9cbnZhciBCc1RpbWVMaW5lID0gKGZ1bmN0aW9uICgpIHtcblxuICAvLyBDb25maWdcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICB0aW1lTGluZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLXRpbWUtbGluZScpLFxuICAgIG5hdlNlbGVjdDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLXRpbWUtbGluZV9fbmF2JyksXG4gICAgbmF2Q29udGVudDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLXRpbWUtbGluZV9fY29udGVudCcpLFxuICAgIHByZXZpb3VzQnV0dG9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtdGltZS1saW5lLS1wcmV2JyksXG4gICAgbmV4dEJ1dHRvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLXRpbWUtbGluZS0tbmV4dCcpLFxuICB9O1xuXG4gIHZhciBhdHRyID0ge1xuICAgIGluaXRpYWxJbmRleDogY29uZmlnLm5hdlNlbGVjdCAhPT0gbnVsbCAmJiBjb25maWcubmF2U2VsZWN0LmdldEF0dHJpYnV0ZSgnZGF0YS1pbml0aWFsLWluZGV4JyksXG4gIH07XG5cblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgLy8gbmF2IGl0ZW1zIHNlbGVjdCBBTkQgY29udGVudCBpbiBhcyBuYXYgZm9yXG4gICAgICB2YXIgZmxrdHkgPSBuZXcgRmxpY2tpdHkoY29uZmlnLm5hdlNlbGVjdCwge1xuICAgICAgICBhc05hdkZvcjogY29uZmlnLm5hdkNvbnRlbnQsXG4gICAgICAgIGNlbGxBbGlnbjogJ2NlbnRlcicsXG4gICAgICAgIGFkYXB0aXZlSGVpZ2h0OiB0cnVlLFxuICAgICAgICBpbml0aWFsSW5kZXg6IGF0dHIuaW5pdGlhbEluZGV4ID8gYXR0ci5pbml0aWFsSW5kZXggOiAyLFxuICAgICAgICBwcmV2TmV4dEJ1dHRvbnM6IGZhbHNlLFxuICAgICAgICAvLyByZXNpemU6IHRydWUsXG4gICAgICAgIGltYWdlc0xvYWRlZDogdHJ1ZSxcbiAgICAgICAgY29udGFpbjogdHJ1ZVxuICAgICAgfSk7XG5cbiAgICAgIC8vIG5hdiBpdGVtcyBjb250ZW50XG4gICAgICB2YXIgbG9hZGluZyA9IGNvbmZpZy50aW1lTGluZS5xdWVyeVNlbGVjdG9yKCcuYnMtbG9hZGluZycpO1xuICAgICAgZmxrdHkgPSBuZXcgRmxpY2tpdHkoY29uZmlnLm5hdkNvbnRlbnQsIHtcbiAgICAgICAgcGFnZURvdHM6IGZhbHNlLFxuICAgICAgICBjZWxsQWxpZ246ICdjZW50ZXInLFxuICAgICAgICBhZGFwdGl2ZUhlaWdodDogdHJ1ZSxcbiAgICAgICAgcHJldk5leHRCdXR0b25zOiBmYWxzZSxcbiAgICAgICAgaW5pdGlhbEluZGV4OiBhdHRyLmluaXRpYWxJbmRleCA/IGF0dHIuaW5pdGlhbEluZGV4IDogMixcbiAgICAgICAgb246IHtcbiAgICAgICAgICByZWFkeTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbG9hZGluZy5yZW1vdmUoKTtcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGZsa3R5Lm9uKCAnY2VsbFNlbGVjdCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZighZmxrdHkuY2VsbHNbZmxrdHkuc2VsZWN0ZWRJbmRleCAtIDFdKSB7XG4gICAgICAgICAgY29uZmlnLnByZXZpb3VzQnV0dG9uLnNldEF0dHJpYnV0ZSggJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyApO1xuICAgICAgICAgIGNvbmZpZy5uZXh0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKVxuICAgICAgICB9IGVsc2UgaWYoIWZsa3R5LmNlbGxzW2Zsa3R5LnNlbGVjdGVkSW5kZXggKyAxXSkge1xuICAgICAgICAgIGNvbmZpZy5wcmV2aW91c0J1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJylcbiAgICAgICAgICBjb25maWcubmV4dEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25maWcucHJldmlvdXNCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpXG4gICAgICAgICAgY29uZmlnLm5leHRCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBjb25maWcucHJldmlvdXNCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgZmxrdHkucHJldmlvdXMoKTtcbiAgICAgIH0pO1xuICAgICAgY29uZmlnLm5leHRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgZmxrdHkubmV4dCgpO1xuICAgICAgfSk7XG4gICAgfSwgMjAwKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgTWVudSBDb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gTWVudS5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtdGltZS1saW5lJykpIHtcbiAgICBCc1RpbWVMaW5lLmluaXQoKTtcbiAgfVxufSk7XG4iLCIvKipcbiAqIEJzIFRvb2x0aXBcbiAqIEEgY3VzdG9tIGltcGxlbWVudGF0aW9uIG9mIHRpcHB5LmpzXG4gKiBAbGluayBodHRwczovL2F0b21pa3MuZ2l0aHViLmlvL3RpcHB5anMvdGhlbWVzL1xuICpcbiAqIEBwYXJhbSAge0RPTUxpc3R9IGVsZW1lbnRzIGVsZW1lbnRzIHRvIHJlY2VpdmUgdGhlIHRvb2x0aXBcbiAqL1xudmFyIEJzVG9vbHRpcCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgXG4gICAgdmFyIHRpcHB5U2V0dGluZ3MgPSBleHRlbmQoe30sIHtcbiAgICAgIGFycm93OiB0cnVlLFxuICAgICAgdGhlbWU6ICdicycsXG4gICAgICBkaXN0YW5jZTogMjAsXG4gICAgICB0cmlnZ2VyOiBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnYnMtanMtbGluaycpID8gJ2NsaWNrJyA6ICdtb3VzZWVudGVyJyxcbiAgICB9LCBvcHRpb25zKVxuXG4gICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXRpcHB5LWNvbnRlbnQnLCBlbGVtZW50LnRpdGxlKTtcbiAgICAgIGVsZW1lbnQudGl0bGUgPSAnJztcbiAgICAgIHRpcHB5KGVsZW1lbnQsIHRpcHB5U2V0dGluZ3MpO1xuICAgIH0gIFxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn07XG5cbi8qKlxuICogSW5pdCBIZWFkZXIgQ29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IEhlYWRlci5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciB0b29sdGlwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy0tb3Zlci10b29sdGlwLCAuYnMtanMtdG9vbHRpcCwgLmJzLWpzLWxpbmsnKTtcblxuICBpZiAodG9vbHRpcHMubGVuZ3RoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCh0b29sdGlwcywgZnVuY3Rpb24gKGVsKSB7XG4gICAgICB2YXIgdG9vbHRpcCA9IG5ldyBCc1Rvb2x0aXAoKTtcbiAgICAgIHRvb2x0aXAuaW5pdChlbCk7XG4gICAgfSk7XG4gIH1cbn0pO1xuIiwiXG4vKipcbiAqIEJzIFRvcE1lbnVcbiAqXG4gKiBSZWZlcmVuY2U6XG4gKlxuICogW1RPRE9dOiBSZWZhdG9yYXIgcGFyYSBxdWUgb3MgZWxlbWVudG9zIGRvIGNvbmZpZyByZWZlcmVuY2llbVxuICogdW0gdG9wTWVudSBlc3BlY8OtZmljbyBhbyBpbnbDqXMgZGUgcGVnYXIgdG9kb3Mgb3MgZXhpc3RlbnRlcyBubyBkb2N1bWVudG8uXG4gKi9cbnZhciBCc1RvcE1lbnUgPSAoZnVuY3Rpb24gKCkge1xuXG4gIHZhciBjb25maWcgPSB7XG4gICAgZHJvcGRvd246IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy10b3AtbWVudScpLFxuICAgIGRyb3Bkb3duQWN0aXZlQ2xhc3M6ICdicy1qcy1oYXMtZm9jdXMnLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCl7XG4gICAgdmFyIGxpbmtNZW51VG9nZ2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLXRvcC1tZW51IC5icy10b3AtbWVudV9fbGluaycpO1xuICAgIHZhciBsaW5rTWVudVRvZ2dsZVN1Yml0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLXRvcC1tZW51IC5icy10b3AtbWVudV9fZHJvcGRvd24nKTtcbiAgICB2YXIgbGlua01lbnVUb2dnbGVTdWJpdGVtc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtdG9wLW1lbnVfX2Ryb3Bkb3duIC5icy10b3AtbWVudV9fbGluaycpO1xuXG4gICAgLy9BcHJlc2VudGEgbm8gRW50ZXIgb3UgU3BhY2Ugb3Mgc3ViaXRlbnMgZG8gbWVudSBPdXRyb3MgUG9ydGFpc1xuICAgIGxpbmtNZW51VG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZSl7XG4gICAgICBpZihlLmtleSA9PT0gJ0VudGVyJyB8fCBlLmNvZGUgPT09ICdFbnRlcicpIHtcbiAgICAgICAgbGlua01lbnVUb2dnbGUuY2xhc3NMaXN0LnRvZ2dsZSgnYnMtdG9wLW1lbnVfX3JvdGF0ZUl0ZW0nKTtcbiAgICAgICAgbGlua01lbnVUb2dnbGVTdWJpdGVtcy5jbGFzc0xpc3QudG9nZ2xlKFwiYnMtdG9wLW1lbnVfX2Rpc3BsYXktaXRlbXNcIik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvL0FkaWNpb25hIHBhcsOibWV0cm8gQVJJQSBubyBsaW5rXG4gICAgbGlua01lbnVUb2dnbGUuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihlKXtcbiAgICAgICAgdmFyIHBhcmFtZXRlckFyaWFFeHBhbmRlZCA9IHRoaXMuZ2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiKTtcbiAgICAgICAgdmFyIHBhcmFtZXRlckFyaWFFeHBhbmRlZCA9IHBhcmFtZXRlckFyaWFFeHBhbmRlZCA9PSBcImZhbHNlXCIgPyBwYXJhbWV0ZXJBcmlhRXhwYW5kZWQgPSBcInRydWVcIiA6IHBhcmFtZXRlckFyaWFFeHBhbmRlZCA9IFwiZmFsc2VcIjtcbiAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoXCJhcmlhLWV4cGFuZGVkXCIsIHBhcmFtZXRlckFyaWFFeHBhbmRlZCk7XG4gICAgfSk7XG5cbiAgICAvL05hdmVnYSBwZWxvcyBzdWJpdGVucyBlIHVzYW5kbyBFU0MsIHNhaSBkbyBtZW51XG4gICAgZm9yKGk9MDsgaSA8IGxpbmtNZW51VG9nZ2xlU3ViaXRlbXNMaXN0Lmxlbmd0aDsgaSsrKXtcbiAgICAgIGxpbmtNZW51VG9nZ2xlU3ViaXRlbXNMaXN0W2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKXtcbiAgICAgICAgaWYoZS5rZXkgPT09IFwiRXNjYXBlXCIgfHwgZS5rZXkgPT09IFwiRXNjXCIpIHtcbiAgICAgICAgICBsaW5rTWVudVRvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdicy10b3AtbWVudV9fcm90YXRlSXRlbScpO1xuICAgICAgICAgIGxpbmtNZW51VG9nZ2xlU3ViaXRlbXMuY2xhc3NMaXN0LnRvZ2dsZShcImJzLXRvcC1tZW51X19kaXNwbGF5LWl0ZW1zXCIpO1xuICAgICAgICAgIGxpbmtNZW51VG9nZ2xlLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vU2UgZm9yIHVsdGltbyBpdGVtIG5ldmFnYWRvLCBmZWNoYSBtZW51XG4gICAgZm9yKGk9MDsgaSA8IGxpbmtNZW51VG9nZ2xlU3ViaXRlbXNMaXN0Lmxlbmd0aDsgaSsrKXtcbiAgICAgIGxpbmtNZW51VG9nZ2xlU3ViaXRlbXNMaXN0W2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKXtcbiAgICAgICAgaWYoZS5rZXkgPT0gXCJUYWJcIil7XG4gICAgICAgICAgdmFyIGN1cnJlbnRfaXRlbSA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG4gICAgICAgICAgdmFyIGxhc3RfaXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsLmJzLXRvcC1tZW51X19kcm9wZG93bicpO1xuICAgICAgICAgIHZhciBsYXN0VWwgPSBsYXN0X2l0ZW0ubGFzdEVsZW1lbnRDaGlsZDtcbiAgICAgICAgICB2YXIgaXNMYXN0Tm9kZSA9IGxhc3RVbC5xdWVyeVNlbGVjdG9yKCd1bC5icy10b3AtbWVudV9fZ3JvdXAtbGlzdCcpLmxhc3RFbGVtZW50Q2hpbGQ7XG5cbiAgICAgICAgICBpZiAoY3VycmVudF9pdGVtID09PSBpc0xhc3ROb2RlLnF1ZXJ5U2VsZWN0b3IoJ2EnKSkge1xuICAgICAgICAgICAgaWYgKCAhZS5zaGlmdEtleSApIHtcbiAgICAgICAgICAgICAgbGlua01lbnVUb2dnbGUuY2xhc3NMaXN0LnRvZ2dsZSgnYnMtdG9wLW1lbnVfX3JvdGF0ZUl0ZW0nKTtcbiAgICAgICAgICAgICAgbGlua01lbnVUb2dnbGVTdWJpdGVtcy5jbGFzc0xpc3QudG9nZ2xlKFwiYnMtdG9wLW1lbnVfX2Rpc3BsYXktaXRlbXNcIik7XG4gICAgICAgICAgICAgIGxpbmtNZW51VG9nZ2xlLmZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvL0luc2VyaXIgcGFyYW3DqnRybyBhcmlhIG5vIGhvdmVyIGRvIGl0ZW1cbiAgICBsaW5rTWVudVRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgcGFyYW1ldGVyQXJpYUV4cGFuZGVkID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJhcmlhLWV4cGFuZGVkXCIpO1xuICAgICAgdmFyIHBhcmFtZXRlckFyaWFFeHBhbmRlZCA9IHBhcmFtZXRlckFyaWFFeHBhbmRlZCA9PSBcImZhbHNlXCIgPyBwYXJhbWV0ZXJBcmlhRXhwYW5kZWQgPSBcInRydWVcIiA6IHBhcmFtZXRlckFyaWFFeHBhbmRlZCA9IFwiZmFsc2VcIjtcbiAgICAgIHRoaXMuc2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiLCBwYXJhbWV0ZXJBcmlhRXhwYW5kZWQpO1xuICAgIH0pO1xuICAgIGxpbmtNZW51VG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW91dFwiLCBmdW5jdGlvbigpe1xuICAgICAgdmFyIHBhcmFtZXRlckFyaWFFeHBhbmRlZCA9IHRoaXMuZ2V0QXR0cmlidXRlKFwiYXJpYS1leHBhbmRlZFwiKTtcbiAgICAgIHZhciBwYXJhbWV0ZXJBcmlhRXhwYW5kZWQgPSBwYXJhbWV0ZXJBcmlhRXhwYW5kZWQgPT0gXCJmYWxzZVwiID8gcGFyYW1ldGVyQXJpYUV4cGFuZGVkID0gXCJ0cnVlXCIgOiBwYXJhbWV0ZXJBcmlhRXhwYW5kZWQgPSBcImZhbHNlXCI7XG4gICAgICB0aGlzLnNldEF0dHJpYnV0ZShcImFyaWEtZXhwYW5kZWRcIiwgcGFyYW1ldGVyQXJpYUV4cGFuZGVkKTtcbiAgICB9KTtcblxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0LFxuICB9O1xufSgpKTtcbi8qKlxuICogSW5pdCBUb3BNZW51IENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXRvcC1tZW51JykubGVuZ3RoKSB7XG4gICAgQnNUb3BNZW51LmluaXQoKTtcbiAgfVxufSk7XG4iLCIvKipcbiAqIEJzIFZvSVAgQXBwXG4qKi9cbnZhciB2b2lwQXBwID0gKGZ1bmN0aW9uICgpIHtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYnRuX211dGUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiYnRuLW11dGUtdm9pcFwiKVxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBidG5fbXV0ZS5sZW5ndGg7IGkrKykge1xuICAgICAgYnRuX211dGVbaV0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmNsYXNzTGlzdC50b2dnbGUoXCJtdXRlLW9uXCIpO1xuICAgICAgfSlcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0OiBpbml0XG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgVk9JUCBDb25zdHJ1Y3RvclxuKiovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLXZvaXAnKS5sZW5ndGgpIHtcbiAgICB2b2lwQXBwLmluaXQoKTtcbiAgfVxufSk7XG4iLCJkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgZml4ZWRPblNjcm9sbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1zY3JvbGwtZml4ZWQnKTtcbiAgaWYgKCFmaXhlZE9uU2Nyb2xsLmxlbmd0aCkgcmV0dXJuO1xuXG4gIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZml4ZWRPblNjcm9sbCwgZnVuY3Rpb24gKGVsZW0pIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHBhZGRpbmcgPSAxNTtcbiAgICAgIHZhciBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtaGVhZGVyJyk7XG4gICAgICB2YXIgaGVhZGVySGVpZ2h0ID0gaGVhZGVyLm9mZnNldEhlaWdodDtcbiAgICAgIHZhciBoZWFkZXJJc0Zsb2F0aW5nID0gaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucygnYnMtaGVhZGVyLS1mbG9hdGluZycpO1xuICAgICAgdmFyIGhlYWRlcklzUGlubmVkID0gaGVhZGVyLmNsYXNzTGlzdC5jb250YWlucygnYnMtaGVhZGVyLS1waW5uZWQnKTtcbiAgICAgIHZhciBlbFBhcmVudFRvcCA9IGVsZW0ucGFyZW50Tm9kZS5vZmZzZXRUb3A7XG4gICAgICB2YXIgZWxUb3BQb3NpdGlvbiA9IDA7XG4gICAgICB2YXIgc2Nyb2xsVG9wID0gKHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wKTtcbiAgICAgIHZhciBwYXJlbnRTZWN0aW9uID0gZWxlbS5jbG9zZXN0KCcuYnMtc2VjdGlvbicpO1xuXG4gICAgICBpZiAoc2Nyb2xsVG9wID4gZWxQYXJlbnRUb3AgJiYgaGVhZGVySXNQaW5uZWQpIHtcbiAgICAgICAgLy8gc2Nyb2xsVG9wICs9IGhlYWRlckhlaWdodDtcbiAgICAgIH1cblxuICAgICAgaWYgKHNjcm9sbFRvcCA+IGVsUGFyZW50VG9wKSB7XG4gICAgICAgIGlmIChoZWFkZXJJc0Zsb2F0aW5nICYmIGhlYWRlcklzUGlubmVkKSB7XG4gICAgICAgICAgZWxUb3BQb3NpdGlvbiA9IHBhZGRpbmcgKyBoZWFkZXJIZWlnaHQgKyAncHgnO1xuICAgICAgICB9IGVsc2UgaWYgKGhlYWRlcklzRmxvYXRpbmcgJiYgc2Nyb2xsVG9wID4gZWxQYXJlbnRUb3ApIHtcbiAgICAgICAgICBlbFRvcFBvc2l0aW9uID0gcGFkZGluZyArIDAgKyAncHgnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsVG9wUG9zaXRpb24gPSAwO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbFRvcFBvc2l0aW9uID0gMDtcbiAgICAgIH1cblxuICAgICAgaWYgKHNjcm9sbFRvcCA+IGVsUGFyZW50VG9wKSB7XG4gICAgICAgIGVsZW0uc3R5bGUudG9wID0gZWxUb3BQb3NpdGlvbjtcbiAgICAgICAgZWxlbS5zdHlsZS5yaWdodCA9ICh3aW5kb3cuaW5uZXJXaWR0aCAtIGVsZW0ucGFyZW50Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodCkgKyAncHgnO1xuICAgICAgICBlbGVtLmNsYXNzTGlzdC5hZGQoJ2JzLWlzLWZpeGVkJyk7XG5cbiAgICAgICAgaWYgKHNjcm9sbFRvcCA8IHBhcmVudFNlY3Rpb24ub2Zmc2V0SGVpZ2h0KSB7XG4gICAgICAgICAgZWxlbS5jbGFzc0xpc3QuYWRkKCdicy1pcy1mbG9hdGluZycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsZW0uc3R5bGUudG9wID0gMDtcbiAgICAgICAgICBlbGVtLnN0eWxlLnJpZ2h0ID0gMDtcbiAgICAgICAgICBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2JzLWlzLWZsb2F0aW5nJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW0uc3R5bGUudG9wID0gZWxUb3BQb3NpdGlvbjtcbiAgICAgICAgZWxlbS5zdHlsZS5yaWdodCA9ICcnO1xuICAgICAgICBlbGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2JzLWlzLWZsb2F0aW5nJyk7XG4gICAgICAgIGVsZW0uY2xhc3NMaXN0LnJlbW92ZSgnYnMtaXMtZml4ZWQnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59KTsiLCIvLyBGaXJlZm94IDEuMCtcbnZhciBpc0ZpcmVmb3ggPSB0eXBlb2YgSW5zdGFsbFRyaWdnZXIgIT09ICd1bmRlZmluZWQnO1xuXG4vLyBJbnRlcm5ldCBFeHBsb3JlciA2LTExXG52YXIgaXNJRSA9IC8qQGNjX29uIUAqL2ZhbHNlIHx8ICEhZG9jdW1lbnQuZG9jdW1lbnRNb2RlO1xuXG4vLyBFZGdlIDIwK1xudmFyIGlzRWRnZSA9ICFpc0lFICYmICEhd2luZG93LlN0eWxlTWVkaWE7XG5cbi8vIENocm9tZSAxIC0gNzlcbnZhciBpc0Nocm9tZSA9ICEhd2luZG93LmNocm9tZSAmJiAoISF3aW5kb3cuY2hyb21lLndlYnN0b3JlIHx8ICEhd2luZG93LmNocm9tZS5ydW50aW1lKTtcblxuLy8gRWRnZSAoYmFzZWQgb24gY2hyb21pdW0pIGRldGVjdGlvblxudmFyIGlzRWRnZUNocm9taXVtID0gaXNDaHJvbWUgJiYgKG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIkVkZ1wiKSAhPSAtMSk7XG5cbmlmIChpc0lFKSB7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF0uY2xhc3NMaXN0LmFkZCgnaXMtaWUtMTEnKTtcbn1cbiIsIi8vIC8qKlxuLy8gICogU2NyaXB0IGVzcGVjw61maWNvIHBhcmEgYSBww6FnaW5hIGRlIEJ1c2NhIGRlIEVzdGFjaW9uYW1lbnRvXG4vLyAgKi9cbi8vIHZhciBQaU1hcHMgPSAoZnVuY3Rpb24gKCkge1xuLy8gICB2YXIgaW5pdCA9IGZ1bmN0aW9uIChtYXBTZWxlY3Rvcikge1xuLy8gICAgIHZhciBtYXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihtYXBTZWxlY3Rvcik7XG5cbi8vICAgICBpZiAobWFwRWxlbWVudCkge1xuLy8gICAgICAgdmFyIG9wdGlvbnMgPSB7XG4vLyAgICAgICAgIG1hcEhlaWdodDogNTAwLFxuLy8gICAgICAgICBsb2NhdGlvbnM6IFtcbi8vICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICBpZDogMCxcbi8vICAgICAgICAgICAgIGxhdDogLTI1LjQyODE4Myxcbi8vICAgICAgICAgICAgIGxuZzogLTQ5LjI2NzA3Myxcbi8vICAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAoKSB7IHJldHVybiBzY3JvbGxUbygwKTsgfSxcbi8vICAgICAgICAgICAgIGluZm9XaW5kb3c6IHtcbi8vICAgICAgICAgICAgICAgc2hvdzogZmFsc2UsXG4vLyAgICAgICAgICAgICAgIHRpdGxlOiAnVMOtdHVsbyAxJyxcbi8vICAgICAgICAgICAgIH0sXG4vLyAgICAgICAgICAgfSxcbi8vICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICBpZDogMSxcbi8vICAgICAgICAgICAgIGxhdDogLTI1LjQzMDIwOSxcbi8vICAgICAgICAgICAgIGxuZzogLTQ5LjI2NDY0Nixcbi8vICAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAoKSB7IHJldHVybiBzY3JvbGxUbygxKTsgfSxcbi8vICAgICAgICAgICAgIGluZm9XaW5kb3c6IHtcbi8vICAgICAgICAgICAgICAgc2hvdzogZmFsc2UsXG4vLyAgICAgICAgICAgICAgIHRpdGxlOiAnVMOtdHVsbyAyJyxcbi8vICAgICAgICAgICAgIH0sXG4vLyAgICAgICAgICAgfSxcbi8vICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICBpZDogMixcbi8vICAgICAgICAgICAgIGxhdDogLTI1LjQzMTc2Mixcbi8vICAgICAgICAgICAgIGxuZzogLTQ5LjI3MDM4NSxcbi8vICAgICAgICAgICAgIGZuOiBmdW5jdGlvbiAoKSB7IHJldHVybiBzY3JvbGxUbygyKTsgfSxcbi8vICAgICAgICAgICAgIGluZm9XaW5kb3c6IHtcbi8vICAgICAgICAgICAgICAgc2hvdzogZmFsc2UsXG4vLyAgICAgICAgICAgICAgIHRpdGxlOiAnVMOtdHVsbyAzJyxcbi8vICAgICAgICAgICAgIH0sXG4vLyAgICAgICAgICAgfSxcbi8vICAgICAgICAgXSxcbi8vICAgICAgICAgbWFwT3B0aW9uczoge1xuLy8gICAgICAgICAgIHpvb206IDE0LFxuLy8gICAgICAgICAgIGNlbnRlcjogbmV3IGdvb2dsZS5tYXBzLkxhdExuZygtMjUuNDI3NzAyLCAtNDkuMjY1MTU5KSxcbi8vICAgICAgICAgICBtYXBUeXBlSWQ6IGdvb2dsZS5tYXBzLk1hcFR5cGVJZC5ST0FETUFQLFxuLy8gICAgICAgICB9LFxuLy8gICAgICAgfTtcblxuLy8gICAgICAgQnNNYXBzLmluaXQobWFwRWxlbWVudCwgb3B0aW9ucyk7XG4vLyAgICAgfVxuLy8gICB9O1xuXG4vLyAgIHZhciBzY3JvbGxUbyA9IGZ1bmN0aW9uIChlbGVtZW50SWQpIHtcbi8vICAgICB2YXIgdGFyZ2V0QW5jaG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtc2Nyb2xsLWFuY2hvcj1cIicgKyBlbGVtZW50SWQgKyAnXCJdJyk7XG5cbi8vICAgICBpZiAodGFyZ2V0QW5jaG9yKSB7XG4vLyAgICAgICB2YXIgc2Nyb2xsID0gbmV3IFNtb290aFNjcm9sbCgpO1xuLy8gICAgICAgdmFyIGN1cnJlbnRBY3RpdmUgPSB0YXJnZXRBbmNob3IucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtaXMtYWN0aXZlJyk7XG4vLyAgICAgICBpZiAoY3VycmVudEFjdGl2ZSkgY3VycmVudEFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdicy1pcy1hY3RpdmUnKTtcbi8vICAgICAgIHRhcmdldEFuY2hvci5jbGFzc0xpc3QuYWRkKCdicy1pcy1hY3RpdmUnKTtcbi8vICAgICAgIHNjcm9sbC5hbmltYXRlU2Nyb2xsKHRhcmdldEFuY2hvciwgMCwgeyBzcGVlZDogMzAwIH0pO1xuLy8gICAgIH1cbi8vICAgfTtcblxuLy8gICByZXR1cm4ge1xuLy8gICAgIGluaXQ6IGluaXQsXG4vLyAgIH07XG4vLyB9KCkpO1xuXG4vLyAvKipcbi8vICAqIEluaXQgUGlNYXBzIGNvbnN0cnVjdG9yXG4vLyAgKiBAcmV0dXJuIHt2b2lkfSBQaU1hcHMuaW5pdCgpO1xuLy8gICovXG4vLyBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuLy8gICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBpLW1hcHMnKS5sZW5ndGgpIHtcbi8vICAgICBpbml0R29vZ2xlTWFwKGZ1bmN0aW9uICgpIHtcbi8vICAgICAgIFBpTWFwcy5pbml0KCcuYnMtanMtbWFwJyk7XG4vLyAgICAgfSk7XG4vLyAgIH1cbi8vIH0pO1xuIiwiLyoqXG4gKiBAcmV0dXJuIE1vZHVsZSBjb25maWdcbiAqL1xudmFyIEJzQ3JlZGVuY2lhZG8gPSAoZnVuY3Rpb24gKCkge1xuICAvKipcbiAgICogSW5pdCBmdW5jdGlvblxuICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gTW9kdWxlJ3Mgc2NvcGUgZnVuY3Rpb25zXG4gICAqL1xuXG4gICB2YXIgY29uZmlnID0ge1xuICAgIHNldEF0dHI6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy0tdHlwZS11c2VyIGlucHV0JyksXG4gICAgc2V0UGY6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy0tY3JlZC1wZicpLFxuICAgIHNldFBqOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtLWNyZWQtcGonKSxcbiAgICBzZXRJbmRpY2FjYW9BdHRyOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtLXR5cGUtaW5kaWNhY2FvIGlucHV0JyksXG4gICAgc2V0SW5kaWNhY2FvOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtLWNyZWQtaW5kaWNhY2FvJyksXG4gICAgc2V0QWRkcmVzczogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLS1jcmVkLWFkZHJlc3MnKSxcbiAgICBzZXRBZGRyZXNzSXRlbTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLS1jcmVkLWl0ZW0nKSxcbiAgICBzZXRQbHVzOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtLWNyZWQtcGx1cycpLFxuICAgIGNoZWNrYm94SXRlbXMgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtLWNoZWNrJyksXG4gICAgY2hlY2tib3hJbmRpY2FjYW9JdGVtcyA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy0tY2hlY2staW5kaWNhY2FvJyksXG4gICAgY2hlY2sgOiAnJyxcbiAgICBjb3VudGVyOiAwLFxuICAgIGNvdW50ZXJJbmQ6IDAsXG4gICAgbGltaXQgOiAyLFxuICAgfTtcblxuICAgaWYgKGNvbmZpZy5jaGVja2JveEl0ZW1zKSB7XG4gICAgdmFyIHNlbGVjdG9yID0ge1xuICAgICAgY2hlY2tJdGVtIDogY29uZmlnLmNoZWNrYm94SXRlbXMucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJyksXG4gICAgICBjaGVja0luZGljYWNhb0l0ZW0gOiBjb25maWcuY2hlY2tib3hJbmRpY2FjYW9JdGVtcy5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKSxcbiAgICAgfTtcbiAgIH07XG5cbiAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAvLyBjbG9uZSBpdGVtcyBmb3JtLCBpbiBjbGljayBwbHVzXG4gICAgY29uZmlnLnNldFBsdXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICB2YXIgYWRycmVzQ29weSA9IGNvbmZpZy5zZXRBZGRyZXNzSXRlbS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICB2YXIgcmVzZXQgPSBhZHJyZXNDb3B5LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JylcblxuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChyZXNldCwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS52YWx1ZSA9ICcnO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbmZpZy5zZXRBZGRyZXNzLmFwcGVuZENoaWxkKGFkcnJlc0NvcHkpO1xuICAgICAgY29uZmlnLnNldFBsdXMucmVtb3ZlKCk7XG4gICAgfSk7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5zZXRBdHRyLCBmdW5jdGlvbiAoZSkge1xuXG4gICAgICBlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBkYXRhRmlsdGVyID0gZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdHlwZScpO1xuXG4gICAgICAgIGlmIChkYXRhRmlsdGVyID09PSAncGonKSB7XG4gICAgICAgICAgLy8gcmVtb3ZlIGFuZCBhZGQgcmVxdWlyZXMgYmVmb3JlIGZpbHRlclxuICAgICAgICAgIF90aGlzUGooKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyByZW1vdmUgYW5kIGFkZCByZXF1aXJlcyBiZWZvcmUgZmlsdGVyXG4gICAgICAgICAgX3RoaXNQZigpO1xuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5zZXRJbmRpY2FjYW9BdHRyLCBmdW5jdGlvbiAoZSkge1xuXG4gICAgICBlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBkYXRhRmlsdGVyID0gZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdHlwZScpO1xuXG4gICAgICAgIGlmIChkYXRhRmlsdGVyID09PSAneWVzJykge1xuICAgICAgICAgIC8vIHJlbW92ZSBhbmQgYWRkIHJlcXVpcmVzIGJlZm9yZSBmaWx0ZXJcbiAgICAgICAgICBfdGhpc0luZGljYWNhbygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIHJlbW92ZSBhbmQgYWRkIHJlcXVpcmVzIGJlZm9yZSBmaWx0ZXJcbiAgICAgICAgICBfdGhpc1JlbW92ZUluZGljYWNhbygpO1xuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHNlbGVjdG9yLmNoZWNrSXRlbSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGNvbmZpZy5idXR0b25JdGVtID0gZTtcbiAgICAgIGNvbmZpZy5idXR0b25JdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgIGNvbmZpZy5jaGVjayA9IGVsLnRhcmdldDtcbiAgICAgICAgbmV3Q2hlY2tlcihjb25maWcuY2hlY2spO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHNlbGVjdG9yLmNoZWNrSW5kaWNhY2FvSXRlbSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGNvbmZpZy5idXR0b25JdGVtID0gZTtcbiAgICAgIGNvbmZpZy5idXR0b25JdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgIGNvbmZpZy5jaGVjayA9IGVsLnRhcmdldDtcbiAgICAgICAgbmV3SW5kaWNhY2FvQ2hlY2tlcihjb25maWcuY2hlY2spO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgfTtcblxuICB2YXIgX3RoaXNQaiA9IGZ1bmN0aW9uICgpIHtcblxuICAgIGNvbmZpZy5zZXRQai5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgIGNvbmZpZy5zZXRQZi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbiAgICB2YXIgc2V0UmVxdWlyZWRQaiA9IGNvbmZpZy5zZXRQai5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpO1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoc2V0UmVxdWlyZWRQaiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGUucmVxdWlyZWQgPSAncmVxdWlyZWQnO1xuICAgIH0pO1xuICAgIHZhciBzZXRSZXF1aXJlZFBmID0gY29uZmlnLnNldFBmLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Jyk7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChzZXRSZXF1aXJlZFBmLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZS5yZXF1aXJlZCA9IHVuZGVmaW5lZDtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciBfdGhpc1BmID0gZnVuY3Rpb24gKCkge1xuXG4gICAgY29uZmlnLnNldFBmLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgY29uZmlnLnNldFBqLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuICAgIHZhciBzZXRSZXF1aXJlZFBqID0gY29uZmlnLnNldFBqLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Jyk7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChzZXRSZXF1aXJlZFBqLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZS5yZXF1aXJlZCA9IHVuZGVmaW5lZDtcbiAgICB9KTtcbiAgICB2YXIgc2V0UmVxdWlyZWRQZiA9IGNvbmZpZy5zZXRQZi5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpO1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoc2V0UmVxdWlyZWRQZiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGUucmVxdWlyZWQgPSAncmVxdWlyZWQnO1xuICAgIH0pO1xuICB9XG5cbiAgdmFyIF90aGlzSW5kaWNhY2FvID0gZnVuY3Rpb24gKCkge1xuXG4gICAgY29uZmlnLnNldEluZGljYWNhby5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuXG4gICAgdmFyIHNldFJlcXVpcmVkSW5kaWNhY2FvID0gY29uZmlnLnNldEluZGljYWNhby5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpO1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoc2V0UmVxdWlyZWRJbmRpY2FjYW8sIGZ1bmN0aW9uIChlKSB7XG4gICAgICBlLnJlcXVpcmVkID0gJ3JlcXVpcmVkJztcbiAgICB9KTtcbiAgfVxuXG4gIHZhciBfdGhpc1JlbW92ZUluZGljYWNhbyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIGNvbmZpZy5zZXRJbmRpY2FjYW8uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG4gICAgdmFyIHNldFJlcXVpcmVkSW5kaWNhY2FvID0gY29uZmlnLnNldEluZGljYWNhby5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCcpO1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoc2V0UmVxdWlyZWRJbmRpY2FjYW8sIGZ1bmN0aW9uIChlKSB7XG4gICAgICBlLnJlcXVpcmVkID0gdW5kZWZpbmVkO1xuICAgIH0pO1xuICB9XG5cbiAgdmFyIG5ld0NoZWNrZXIgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgaWYgKGUuY2hlY2tlZCkgY29uZmlnLmNvdW50ZXIrKztcbiAgICBlbHNlIGNvbmZpZy5jb3VudGVyLS07XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHNlbGVjdG9yLmNoZWNrSXRlbSwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICBpZiAoY29uZmlnLmNvdW50ZXIgPT09IGNvbmZpZy5saW1pdCkgeyAvLy0gMiBsaW1pdCBkZWZhdWx0XG4gICAgICAgIGlmICghZWwuY2hlY2tlZCkge1xuICAgICAgICAgIGVsLmRpc2FibGVkID0gdHJ1ZTsgLy8gYW5kIGRpc2FibGUgdW5jaGVja2VkIGNoZWNrYm94ZXNcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChjb25maWcuY291bnRlciA9PT0gY29uZmlnLm1pblNpemVMaW1pdCkge1xuICAgICAgICAgIGNvbmZpZy5idXR0b25JdGVtLmRpc2FibGVkID0gZmFsc2U7IC8vIGVuYWJsZSB1bmNoZWNrZWQgY2hlY2tib3hlc1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICghZWwuY2hlY2tlZCkge1xuICAgICAgICAgICAgZWwuZGlzYWJsZWQgPSBmYWxzZTsgLy8gZW5hYmxlIHVuY2hlY2tlZCBjaGVja2JveGVzXG4gICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH07XG5cbiAgdmFyIG5ld0luZGljYWNhb0NoZWNrZXIgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgaWYgKGUuY2hlY2tlZCkgY29uZmlnLmNvdW50ZXJJbmQrKztcbiAgICBlbHNlIGNvbmZpZy5jb3VudGVySW5kLS07XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHNlbGVjdG9yLmNoZWNrSW5kaWNhY2FvSXRlbSwgZnVuY3Rpb24gKGVsKSB7XG5cbiAgICAgIGlmIChjb25maWcuY291bnRlckluZCA9PT0gY29uZmlnLmxpbWl0KSB7IC8vLSAyIGxpbWl0IGRlZmF1bHRcbiAgICAgICAgaWYgKCFlbC5jaGVja2VkKSB7XG4gICAgICAgICAgZWwuZGlzYWJsZWQgPSB0cnVlOyAvLyBhbmQgZGlzYWJsZSB1bmNoZWNrZWQgY2hlY2tib3hlc1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGNvbmZpZy5jb3VudGVySW5kID09PSBjb25maWcubWluU2l6ZUxpbWl0KSB7XG4gICAgICAgICAgY29uZmlnLmJ1dHRvbkl0ZW0uZGlzYWJsZWQgPSBmYWxzZTsgLy8gZW5hYmxlIHVuY2hlY2tlZCBjaGVja2JveGVzXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKCFlbC5jaGVja2VkKSB7XG4gICAgICAgICAgICBlbC5kaXNhYmxlZCA9IGZhbHNlOyAvLyBlbmFibGUgdW5jaGVja2VkIGNoZWNrYm94ZXNcbiAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gIH07XG59KCkpO1xuXG4vKipcbiAqIEluaXQgSGVhZGVyIENvbnN0cnVjdG9yXG4gKiBAcmV0dXJuIHt2b2lkfSBIZWFkZXIuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLXNlamEtY3JlZGVuY2lhZG8nKSkge1xuICAgIEJzQ3JlZGVuY2lhZG8uaW5pdCgpO1xuICB9XG59KTtcbiIsIi8qKlxuICogRm9ybXVsw6FyaW8gRmFsZSBDb25vc2NvIFNhw7pkZVxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuXG4gIHZhciB0b2dnbGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWZvcm0tY29udGFjdC1zYXVkZS10b2dnbGUnKTtcbiAgdmFyIGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1mb3JtLWNvbnRhY3Qtc2F1ZGUtdGFyZ2V0Jyk7XG5cbiAgaWYgKHRvZ2dsZXMubGVuZ3RoICYmIGlucHV0cy5sZW5ndGgpIHtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHRvZ2dsZXMsIGZ1bmN0aW9uICh0b2dnbGUpIHtcbiAgICAgIHRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0YXJnZXRJZCA9IHRvZ2dsZS52YWx1ZTtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChpbnB1dHMsIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICAgIHZhciBpbnB1dElkID0gaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLXRhcmdldCcpO1xuICAgICAgICAgIHZhciBwYXJlbnQgPSBpbnB1dC5jbG9zZXN0KCcuYnMtZm9ybV9fY29udHJvbCcpO1xuICAgICAgICAgIGlmIChpbnB1dElkID09PSB0YXJnZXRJZCkge1xuICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2JzLWlzLWhpZGRlbicpO1xuICAgICAgICAgICAgaW5wdXQucmVxdWlyZWQgPSAncmVxdWlyZWQnO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwYXJlbnQuY2xhc3NMaXN0LmFkZCgnYnMtaXMtaGlkZGVuJyk7XG4gICAgICAgICAgICBpbnB1dC5yZXF1aXJlZCA9ICcnO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb250YWdlbSBkZSBjYXJhY3RlcmVzIG5vcyBmb3JtdWzDoXJpb3M6IE1lbnNhZ2VtKlxuICAgKi9cbiAgdmFyIHRleHRBcmVhRmFsZUNvbm9zY28gPSBbXTtcblxuICB0ZXh0QXJlYUZhbGVDb25vc2NvID0gW1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhdGVuZC1hdXRvLW1lbnNhZ2VtJyksXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2F0ZW5kLXJlc2lkZW5jaWFsLW1lbnNhZ2VtJyksXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2F0ZW5kLXZpZGEtbWVuc2FnZW0nKSxcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYXRlbmQtcHJldmlkZW5jaWEtbWVuc2FnZW0nKSxcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYXRlbmQtc2F1ZGUtbWVuc2FnZW0nKSxcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYXRlbmQtZGVudGFsLW1lbnNhZ2VtJyksXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2F0ZW5kLW91dHJvcy1tZW5zYWdlbScpXG4gIF07XG5cbiAgaWYgKHRleHRBcmVhRmFsZUNvbm9zY29bMF0gIT0gbnVsbCkge1xuICAgIGZvciAoaSA9IDA7IGkgPCB0ZXh0QXJlYUZhbGVDb25vc2NvLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0ZXh0QXJlYUZhbGVDb25vc2NvW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGlucHV0X2dyb3VwID0gdGhpcy5wYXJlbnROb2RlO1xuICAgICAgICB2YXIgc3Bhbl92YWx1ZSA9IGlucHV0X2dyb3VwLnF1ZXJ5U2VsZWN0b3IoJy5icy1mb3JtX19vYnNlcnZhdGlvbicpO1xuICAgICAgICB2YXIgdGV4dFRvdGFsTGVuZ3RoID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ21heGxlbmd0aCcpO1xuICAgICAgICB2YXIgdGV4dE51bWJlckxlbmd0aCA9IHRoaXMudmFsdWUubGVuZ3RoO1xuICAgICAgICB2YXIgc3RyX2NoYXJfcmVtYWluaW5nID0gXCJMaW1pdGFkbyBlbSBcIiArICh0ZXh0VG90YWxMZW5ndGggLSB0ZXh0TnVtYmVyTGVuZ3RoKSArIFwiIGNhcmFjdGVyZXNcIjtcblxuICAgICAgICBzcGFuX3ZhbHVlLmlubmVySFRNTCA9IHN0cl9jaGFyX3JlbWFpbmluZztcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG59KTtcbiIsIi8qKlxuICogRm9ybXVsw6FyaW8gZGUgTGVhZHMgKENvbnRyYXRlKVxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgY29udGFjdFRvZ2dsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1sZWFkcy1jb250YWN0LXRvZ2dsZScpO1xuICB2YXIgY29udGFjdElucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1sZWFkcy1jb250YWN0LXRhcmdldCcpO1xuXG4gIGlmIChjb250YWN0VG9nZ2xlICYmIGNvbnRhY3RJbnB1dHMubGVuZ3RoKSB7XG4gICAgY29udGFjdFRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdGFyZ2V0SWQgPSBjb250YWN0VG9nZ2xlLnZhbHVlO1xuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb250YWN0SW5wdXRzLCBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgaW5wdXRJZCA9IGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKTtcbiAgICAgICAgdmFyIHBhcmVudCA9IGlucHV0LmNsb3Nlc3QoJy5icy1mb3JtX19jb250cm9sJyk7XG4gICAgICAgIGlmIChpbnB1dElkID09PSB0YXJnZXRJZCkge1xuICAgICAgICAgIHBhcmVudC5jbGFzc0xpc3QucmVtb3ZlKCdicy1pcy1oaWRkZW4nKTtcbiAgICAgICAgICBpbnB1dC5yZXF1aXJlZCA9ICdyZXF1aXJlZCc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC5hZGQoJ2JzLWlzLWhpZGRlbicpO1xuICAgICAgICAgIGlucHV0LnJlcXVpcmVkID0gJyc7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59KTsgXG4iLCIvKipcbiAqIEZvcm0gQ2hhbmdlclxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgY2hhbmdlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1jaGFuZ2VyLXRhcmdldF0nKTtcbiAgdmFyIGZvcm1DaGFuZ2VyID0gZnVuY3Rpb24gKGNoYW5nZXIpIHtcbiAgICB2YXIgdGFyZ2V0SWQgPSBjaGFuZ2VyLnZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgdmFyIHRhcmdldEdyb3VwID0gY2hhbmdlci5nZXRBdHRyaWJ1dGUoJ2RhdGEtY2hhbmdlci10YXJnZXQnKTtcbiAgICB2YXIgdGFyZ2V0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWNoYW5nZXItZ3JvdXA9XCInICsgdGFyZ2V0R3JvdXAgKyAnXCJdJyk7XG5cbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHRhcmdldHMsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICB2YXIgaXRlbUlkID0gaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtY2hhbmdlci1pZCcpLnRvTG93ZXJDYXNlKCk7XG4gICAgICB2YXIgcGFyZW50ID0gaXRlbS5jbG9zZXN0KCcuYnMtZm9ybV9fY29udHJvbCcpO1xuICAgICAgdmFyIGNoaWxkRmllbGRzID0gaXRlbS5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYScpO1xuXG4gICAgICBpZiAoIXBhcmVudCkge1xuICAgICAgICAvLyBjdXJyZW50IHZlcnNpb25cbiAgICAgICAgaWYgKGl0ZW1JZCA9PT0gdGFyZ2V0SWQpIHtcbiAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2JzLWlzLWhpZGRlbicpO1xuICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoY2hpbGRGaWVsZHMsIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICAgICAgaW5wdXQucmVxdWlyZWQgPSAncmVxdWlyZWQnO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnYnMtaXMtaGlkZGVuJyk7XG4gICAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjaGlsZEZpZWxkcywgZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgICAgICBpbnB1dC5yZXF1aXJlZCA9ICcnO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAvLyBvbGQgdmVyc2lvblxuICAgICAgfSBlbHNlIGlmIChpdGVtSWQgPT09IHRhcmdldElkKSB7XG4gICAgICAgIHBhcmVudC5jbGFzc0xpc3QucmVtb3ZlKCdicy1pcy1oaWRkZW4nKTtcbiAgICAgICAgaXRlbS5yZXF1aXJlZCA9ICdyZXF1aXJlZCc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYXJlbnQuY2xhc3NMaXN0LmFkZCgnYnMtaXMtaGlkZGVuJyk7XG4gICAgICAgIGl0ZW0ucmVxdWlyZWQgPSAnJztcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBpZiAoY2hhbmdlcnMubGVuZ3RoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjaGFuZ2VycywgZnVuY3Rpb24gKGNoYW5nZXIpIHtcbiAgICAgIC8vIGZvcm1DaGFuZ2VyKGNoYW5nZXIpO1xuICAgICAgY2hhbmdlci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmb3JtQ2hhbmdlci5iaW5kKG51bGwsIGNoYW5nZXIpKTtcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8qKlxuICogRm9ybXVsw6FyaW8gT3V2aWRvcmlhXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciB0b2dnbGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWZvcm0tb3V2aWRvcmlhLXN1Z2VzdGFvLWJhbmNvLXRvZ2dsZScpO1xuICB2YXIgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLWZvcm0tb3V2aWRvcmlhLXN1Z2VzdGFvLWJhbmNvLXRhcmdldCcpO1xuXG4gIGlmICh0b2dnbGVzLmxlbmd0aCAmJiBpbnB1dHMubGVuZ3RoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCh0b2dnbGVzLCBmdW5jdGlvbiAodG9nZ2xlKSB7XG4gICAgICB0b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFyZ2V0SWQgPSB0b2dnbGUudmFsdWU7XG4gICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoaW5wdXRzLCBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgICB2YXIgaW5wdXRJZCA9IGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKTtcbiAgICAgICAgICB2YXIgcGFyZW50ID0gaW5wdXQuY2xvc2VzdCgnLmJzLWZvcm1fX2NvbnRyb2wnKTtcbiAgICAgICAgICBpZiAoaW5wdXRJZCA9PT0gdGFyZ2V0SWQpIHtcbiAgICAgICAgICAgIHBhcmVudC5jbGFzc0xpc3QucmVtb3ZlKCdicy1pcy1oaWRkZW4nKTtcbiAgICAgICAgICAgIGlucHV0LnJlcXVpcmVkID0gJ3JlcXVpcmVkJztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGFyZW50LmNsYXNzTGlzdC5hZGQoJ2JzLWlzLWhpZGRlbicpO1xuICAgICAgICAgICAgaW5wdXQucmVxdWlyZWQgPSAnJztcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBGb3JtdWzDoXJpbyBkZSBDb25zdWx0YSBkZSBQbGFub3MgcG9yIFJlZmVyZW5jaWFkb1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgcGxhbm9zVG9nZ2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXBsYW5vcy1jcmVkZW5jaWFkby10b2dnbGUnKTtcbiAgdmFyIHBsYW5vc0lucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1wbGFub3MtY3JlZGVuY2lhZG8tdGFyZ2V0Jyk7XG5cbiAgaWYgKHBsYW5vc1RvZ2dsZS5sZW5ndGggJiYgcGxhbm9zSW5wdXRzLmxlbmd0aCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwocGxhbm9zVG9nZ2xlLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRhcmdldElkID0gZWwudmFsdWU7XG5cbiAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChwbGFub3NJbnB1dHMsIGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICAgIGlucHV0SWQgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFyZ2V0Jyk7XG4gICAgICAgICAgaWYgKGlucHV0SWQgPT09IHRhcmdldElkKSB7XG4gICAgICAgICAgICBpbnB1dC5kaXNhYmxlZCA9ICcnO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbnB1dC5kaXNhYmxlZCA9ICdkaXNhYmxlZCc7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59KTtcbiIsIi8qKlxuICogRm9ybXVsw6FyaW8gRmFsZSBDb25vc2NvIFNhw7pkZVxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuXG4gIC8qKlxuICAgKiBDb250YWdlbSBkZSBjYXJhY3RlcmVzIG5vcyBmb3JtdWzDoXJpb3M6IE1lbnNhZ2VtKlxuICAgKi9cbiAgdmFyIHRleHRBcmVhRmFsZUNvbm9zY28gPSBbXTtcblxuICB0ZXh0QXJlYUZhbGVDb25vc2NvID0gW1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjYWRhc3Ryby1wYXV0YScpLFxuICBdO1xuXG4gIGlmICh0ZXh0QXJlYUZhbGVDb25vc2NvWzBdICE9IG51bGwpIHtcbiAgICBmb3IgKGkgPSAwOyBpIDwgdGV4dEFyZWFGYWxlQ29ub3Njby5sZW5ndGg7IGkrKykge1xuICAgICAgdGV4dEFyZWFGYWxlQ29ub3Njb1tpXS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBpbnB1dF9ncm91cCA9IHRoaXMucGFyZW50Tm9kZTtcbiAgICAgICAgdmFyIHNwYW5fdmFsdWUgPSBpbnB1dF9ncm91cC5xdWVyeVNlbGVjdG9yKCcuYnMtZm9ybV9fb2JzZXJ2YXRpb24nKTtcbiAgICAgICAgdmFyIHRleHRUb3RhbExlbmd0aCA9IHRoaXMuZ2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnKTtcbiAgICAgICAgdmFyIHRleHROdW1iZXJMZW5ndGggPSB0aGlzLnZhbHVlLmxlbmd0aDtcbiAgICAgICAgdmFyIHN0cl9jaGFyX3JlbWFpbmluZyA9IFwiTGltaXRhZG8gZW0gXCIgKyAodGV4dFRvdGFsTGVuZ3RoIC0gdGV4dE51bWJlckxlbmd0aCkgKyBcIiBjYXJhY3RlcmVzXCI7XG5cbiAgICAgICAgc3Bhbl92YWx1ZS5pbm5lckhUTUwgPSBzdHJfY2hhcl9yZW1haW5pbmc7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxufSk7XG4iLCIvKipcbiAqIEZpbHRybyBMYXRlcmFsIGRvIExvY2FsaXphZG9yXG4gKiBAY29tcG9uZW50IEJzU2VsZWN0RmlsdGVyLmluaXQoKTtcbiAqIEBjb21wb25lbnQgQnNMaXN0QWNjb3JkaW9uLmV4cGFuZCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgYXBwbHlCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtbG9jYXRvci1hcHBseS1maWx0ZXInKTtcbiAgdmFyIHNlbGVjdEZpbHRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtanMtc2VsZWN0LWZpbHRlcicpO1xuICB2YXIgbW9iaWxlT3BlbkZpbHRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1vcGVuLWZpbHRlci1tb2JpbGUnKTtcbiAgdmFyIG1vYmlsZUNsb3NlRmlsdGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLWNsb3NlLWZpbHRlci1tb2JpbGUnKTtcbiAgdmFyIG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtb3ZlcmxheScpO1xuICB2YXIgbW9iaWxlRmlsdGVyQm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLWZpbHRlci1tb2JpbGUnKTtcbiAgdmFyIGxvY2F0b3JGaWx0ZXJzID0gW107IC8vIGZvciBkZWJ1Z1xuICB2YXIgaGFuZGxlRmlsdGVycyA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcbiAgICB2YXIgYWNjb3JkaW9uSXRlbSA9IGdldFBhcmVudChmaWx0ZXIuZWxlbWVudCgpLCAnYnMtbGlzdC1kZXNjcmlwdGlvbl9faXRlbScpO1xuICAgIHZhciBhY2NvcmRpb25CdXR0b24gPSBhY2NvcmRpb25JdGVtLnF1ZXJ5U2VsZWN0b3IoJy5icy1saXN0LWRlc2NyaXB0aW9uX190aXRsZScpO1xuXG4gICAgdmFyIHNldFNlbGVjdGVkSXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgc3BhbiA9IGFjY29yZGlvbkJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XG4gICAgICB2YXIgc3BhblZhbHVlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgdmFyIHNlbGVjdGVkSXRlbXNDb250ZW50ID0gW107XG4gICAgICB2YXIgc2VsZWN0ZWRJdGVtcyA9IGZpbHRlci5zZWxlY3RlZEl0ZW1zKCk7XG5cbiAgICAgIGlmICghYWNjb3JkaW9uSXRlbSkgcmV0dXJuO1xuXG4gICAgICBpZiAoc3Bhbikgc3BhblZhbHVlID0gc3BhbjtcbiAgICAgIGVsc2UgYWNjb3JkaW9uQnV0dG9uLmFwcGVuZENoaWxkKHNwYW5WYWx1ZSk7XG5cbiAgICAgIGlmIChzZWxlY3RlZEl0ZW1zLmxlbmd0aCkge1xuICAgICAgICBzZWxlY3RlZEl0ZW1zQ29udGVudCA9IHNlbGVjdGVkSXRlbXMubWFwKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW0pIHtcbiAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRJdGVtLnRleHRDb250ZW50O1xuICAgICAgICB9KTtcbiAgICAgICAgc3BhblZhbHVlLmlubmVyVGV4dCA9IHNlbGVjdGVkSXRlbXNDb250ZW50LmpvaW4oJywgJyk7XG4gICAgICAgIGFjY29yZGlvbkJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdmaWx0ZXItaXRlbXMtaXMtc2VsZWN0ZWQnKTtcbiAgICAgICAgYWNjb3JkaW9uQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXBwbHlTZWxlY3RlZEl0ZW1zKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNwYW5WYWx1ZS5yZW1vdmUoKTtcbiAgICAgICAgYWNjb3JkaW9uQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpbHRlci1pdGVtcy1pcy1zZWxlY3RlZCcsICdmaWx0ZXItaXRlbXMtaXMtYXBwbGllZCcpO1xuICAgICAgICBhY2NvcmRpb25CdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhcHBseVNlbGVjdGVkSXRlbXMpO1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIGFwcGx5U2VsZWN0ZWRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGFjY29yZGlvbkJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdmaWx0ZXItaXRlbXMtaXMtc2VsZWN0ZWQnKTtcbiAgICAgIGFjY29yZGlvbkJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdmaWx0ZXItaXRlbXMtaXMtYXBwbGllZCcpO1xuICAgICAgQnNMaXN0QWNjb3JkaW9uLmNvbGxhcHNlKGFjY29yZGlvbkl0ZW0pO1xuICAgICAgYWNjb3JkaW9uQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmVtb3ZlQXBwbGllZEl0ZW1zKTtcbiAgICB9O1xuICAgIHZhciByZW1vdmVBcHBsaWVkSXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgc3BhbiA9IGFjY29yZGlvbkJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XG4gICAgICBzcGFuLnJlbW92ZSgpO1xuICAgICAgZmlsdGVyLnVuc2VsZWN0QWxsSXRlbXMoKTtcbiAgICAgIGFjY29yZGlvbkJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdmaWx0ZXItaXRlbXMtaXMtYXBwbGllZCcpO1xuICAgICAgQnNMaXN0QWNjb3JkaW9uLmV4cGFuZChhY2NvcmRpb25JdGVtKTtcbiAgICAgIGFjY29yZGlvbkJ1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHJlbW92ZUFwcGxpZWRJdGVtcyk7XG4gICAgfTtcbiAgICB2YXIgZmlsdGVyTGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBmaWx0ZXJFbCA9IGZpbHRlci5lbGVtZW50KCk7XG4gICAgICB2YXIgbGlzdCA9IGZpbHRlckVsLnF1ZXJ5U2VsZWN0b3IoJ3VsJyk7XG4gICAgICB2YXIgZmlsdGVyZWRJdGVtcyA9IGZpbHRlci5maWx0ZXJlZEl0ZW1zKCk7XG5cbiAgICAgIC8vIGlmIChmaWx0ZXJlZEl0ZW1zLmxlbmd0aCkge1xuICAgICAgLy8gICBmaWx0ZXJFbC5jbGFzc0xpc3QuYWRkKCdoYXMtZmlsdGVyJyk7XG4gICAgICAvLyB9IGVsc2Uge1xuICAgICAgLy8gICBmaWx0ZXJFbC5jbGFzc0xpc3QucmVtb3ZlKCdoYXMtZmlsdGVyJyk7XG4gICAgICAvLyB9XG5cbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwobGlzdC5jaGlsZHJlbiwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgaWYgKCFmaWx0ZXJlZEl0ZW1zLmxlbmd0aCB8fCBmaWx0ZXJlZEl0ZW1zLmluZGV4T2YoaXRlbSkgPiAtMSkge1xuICAgICAgICAgIGl0ZW0uc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGl0ZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIGZpbHRlci5vbignaXRlbVNlbGVjdCcsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICBzZXRTZWxlY3RlZEl0ZW1zKGl0ZW0pO1xuICAgIH0pO1xuXG4gICAgZmlsdGVyLm9uKCdpdGVtVW5zZWxlY3QnLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgc2V0U2VsZWN0ZWRJdGVtcyhpdGVtKTtcbiAgICB9KTtcblxuICAgIGZpbHRlci5vbignaXRlbXNBcHBseScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGFwcGx5U2VsZWN0ZWRJdGVtcygpO1xuICAgIH0pO1xuXG4gICAgZmlsdGVyLm9uKCdsaXN0RmlsdGVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgZmlsdGVyTGlzdCgpXG4gICAgfSk7XG4gIH07XG4gIHZhciBnZXRTZWxlY3RlZEZpbHRlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGxvY2F0b3JGaWx0ZXJzLm1hcChmdW5jdGlvbiAoZmlsdGVyKSB7XG4gICAgICByZXR1cm4gZmlsdGVyLnNlbGVjdGVkSXRlbXMoKTtcbiAgICB9KTtcbiAgfTtcbiAgdmFyIGFwcGx5RmlsdGVyID0gZnVuY3Rpb24gKCkge1xuICAgIC8vIHZhciBzZWxlY3RlZCA9IGdldFNlbGVjdGVkRmlsdGVycygpO1xuICAgIC8vIGNvbnNvbGUubG9nKHNlbGVjdGVkKTtcbiAgfTtcbiAgdmFyIGNsaWNrT3V0c2lkZSA9IGZ1bmN0aW9uIChjbGlja2FibGVFbGVtZW50cywgY2FsbGJhY2spIHtcbiAgICB2YXIgaXNDbGlja2FibGUgPSBmdW5jdGlvbiAoZWxlbWVudHMsIGV2KSB7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkoY2xpY2thYmxlRWxlbWVudHMpKSBlbGVtZW50cyA9IFtlbGVtZW50c107XG4gICAgICByZXR1cm4gZWxlbWVudHMuc29tZShmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgcmV0dXJuIGVsLmNvbnRhaW5zKGV2LnRhcmdldCk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYm9keSwgaHRtbCcpLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgaWYgKCFpc0NsaWNrYWJsZShjbGlja2FibGVFbGVtZW50cywgZXZlbnQpKSB7XG4gICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIGlmIChhcHBseUJ1dHRvbikgYXBwbHlCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhcHBseUZpbHRlcik7XG5cbiAgaWYgKHNlbGVjdEZpbHRlcnMpIHtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKHNlbGVjdEZpbHRlcnMsIGZ1bmN0aW9uIChmaWx0ZXIpIHtcbiAgICAgIHZhciBtdXN0U2VsZWN0TXVsdGlwbGUgPSAoZmlsdGVyLmNsYXNzTGlzdC5jb250YWlucygnYnMtanMtc2VsZWN0LWZpbHRlci0tbXVsdGlwbGUnKSk7XG4gICAgICB2YXIgaW5zdGFuY2U7XG5cbiAgICAgIGluc3RhbmNlID0gbmV3IEJzU2VsZWN0RmlsdGVyKCk7XG4gICAgICBpbnN0YW5jZS5pbml0KGZpbHRlciwge1xuICAgICAgICBpbnB1dDogJy5icy1qcy1zZWxlY3QtZmlsdGVyX19pbnB1dCcsXG4gICAgICAgIGxpc3Q6ICcuYnMtanMtc2VsZWN0LWZpbHRlcl9fbGlzdCcsXG4gICAgICAgIHNlbGVjdE11bHRpcGxlOiBtdXN0U2VsZWN0TXVsdGlwbGUsXG4gICAgICAgIGF1dG9BcHBseTogIW11c3RTZWxlY3RNdWx0aXBsZSxcbiAgICAgICAgYXBwbHlCdXR0b25DbGFzczogJ2JzLWJ1dHRvbiBicy1idXR0b24tLWdob3N0IGJzLWJ1dHRvbi0tcHJpbWFyeSBicy1zZWxlY3QtZmlsdGVyX19hcHBseScsXG4gICAgICB9KTtcblxuICAgICAgaGFuZGxlRmlsdGVycyhpbnN0YW5jZSk7XG5cbiAgICAgIC8vIGZvciBkZWJ1Z1xuICAgICAgbG9jYXRvckZpbHRlcnMucHVzaChpbnN0YW5jZSk7XG4gICAgfSk7XG5cbiAgICAvLyBmb3IgZGVidWdcbiAgICB3aW5kb3cubG9jYXRvckZpbHRlcnMgPSBsb2NhdG9yRmlsdGVycztcbiAgfVxuXG4gIGlmIChtb2JpbGVPcGVuRmlsdGVyICYmIG1vYmlsZUZpbHRlckJveCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoW21vYmlsZU9wZW5GaWx0ZXIsIG1vYmlsZUNsb3NlRmlsdGVyXSwgZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgICAgaWYgKGJ1dHRvbikge1xuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKG1vYmlsZUZpbHRlckJveC5jbGFzc0xpc3QuY29udGFpbnMoJ2JzLWxvY2F0b3JfX2ZpbHRlci1ib3gtLXZpc2libGUnKSkge1xuICAgICAgICAgICAgbW9iaWxlRmlsdGVyQm94LmNsYXNzTGlzdC5yZW1vdmUoJ2JzLWxvY2F0b3JfX2ZpbHRlci1ib3gtLXZpc2libGUnKTtcbiAgICAgICAgICAgIG92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZSgnYnMtb3ZlcmxheS0tdmlzaWJsZScpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtb2JpbGVGaWx0ZXJCb3guY2xhc3NMaXN0LmFkZCgnYnMtbG9jYXRvcl9fZmlsdGVyLWJveC0tdmlzaWJsZScpO1xuICAgICAgICAgICAgb3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdicy1vdmVybGF5LS12aXNpYmxlJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNsaWNrT3V0c2lkZShbbW9iaWxlRmlsdGVyQm94LCBtb2JpbGVPcGVuRmlsdGVyLCBtb2JpbGVDbG9zZUZpbHRlcl0sIGZ1bmN0aW9uICgpIHtcbiAgICAgIG1vYmlsZUZpbHRlckJveC5jbGFzc0xpc3QucmVtb3ZlKCdicy1sb2NhdG9yX19maWx0ZXItYm94LS12aXNpYmxlJyk7XG4gICAgICBvdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2JzLW92ZXJsYXktLXZpc2libGUnKTtcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8qKlxuICogQnVzY2EgZGUgc2VydmnDp29zXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciBsb2NhdG9yU2VhcmNoID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLWxvY2F0b3Itc2VhcmNoJyk7XG4gIHZhciBsb2NhdGlvbjtcbiAgdmFyIHNlcnZpY2VzO1xuICB2YXIgc2VhcmNoO1xuICB2YXIgdXNlckxvY2F0aW9uID0gJyc7XG4gIHZhciBnZXRVc2VyTG9jYXRpb24gPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICBpZiAodXNlckxvY2F0aW9uKSB7XG4gICAgICBjYWxsYmFjayh1c2VyTG9jYXRpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHVzZXJMb2NhdGlvbiA9IGRhdGEuY29vcmRzO1xuICAgICAgICBjYWxsYmFjayh1c2VyTG9jYXRpb24pO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuICB2YXIgZ2V0VXNlckxvY2F0aW9uQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLXVzZXItbG9jYXRpb24nKTtcblxuICAvLyBzZWFyY2ggc2VydmljZXNcbiAgdmFyIHNlYXJjaFN1Z2dlc3Rpb25zO1xuICB2YXIgc2VhcmNoU3VnZ2VzdGlvbnNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWpzLXNlcnZpY2Utc2VhcmNoLXN1Z2dlc3Rpb25zJyk7XG5cbiAgdmFyIHNlYXJjaExpc3RFeGFtcGxlcyA9IFtcbiAgICB7IGNvbnRlbnQ6ICdMb3JlbSBpcHN1bScgfSxcbiAgICB7IGNvbnRlbnQ6ICdDb25zZWN0ZXR1cicgfSxcbiAgICB7IGNvbnRlbnQ6ICdBZGlwaXNpY2luZyBlbGl0JyB9LFxuICAgIHsgY29udGVudDogJ1V0IGxhYm9yZScgfSxcbiAgICB7IGNvbnRlbnQ6ICdNYWduYSBhbGlxdWEnIH0sXG4gIF07XG5cbiAgdmFyIHNlYXJjaExpc3QgPSBbXG4gICAgeyBjb250ZW50OiAnTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQnIH0sXG4gICAgeyBjb250ZW50OiAnY29uc2VjdGV0dXIgYWRpcGlzaWNpbmcgZWxpdCcgfSxcbiAgICB7IGNvbnRlbnQ6ICdzZWQgZG8gZWl1c21vZCB0ZW1wb3IgaW5jaWRpZHVudCcgfSxcbiAgICB7IGNvbnRlbnQ6ICd1dCBsYWJvcmUgZXQgZG9sb3JlIG1hZ25hIGFsaXF1YScgfSxcbiAgICB7IGNvbnRlbnQ6ICdVdCBlbmltIGFkIG1pbmltIHZlbmlhbScgfSxcbiAgXTtcblxuICBpZiAoIWxvY2F0b3JTZWFyY2gpIHJldHVybjtcblxuICBsb2NhdGlvbiA9IGxvY2F0b3JTZWFyY2gucXVlcnlTZWxlY3RvcignI3NlcnZpY2UtbG9jYXRpb24nKTtcbiAgc2VydmljZXMgPSBsb2NhdG9yU2VhcmNoLnF1ZXJ5U2VsZWN0b3IoJyNzZXJ2aWNlLXNlbGVjdCcpO1xuICBzZWFyY2ggPSBsb2NhdG9yU2VhcmNoLnF1ZXJ5U2VsZWN0b3IoJyNzZXJ2aWNlLXNlYXJjaCcpO1xuXG4gIGlmIChzZWFyY2ggJiYgc2VhcmNoU3VnZ2VzdGlvbnNMaXN0KSB7XG4gICAgc2VhcmNoU3VnZ2VzdGlvbnMgPSBuZXcgQnNTZWFyY2hTdWdnZXN0aW9ucyhzZWFyY2hTdWdnZXN0aW9uc0xpc3QsIHtcbiAgICAgIHNlYXJjaDogc2VhcmNoLFxuICAgICAgbWF4SXRlbXM6IDQsXG4gICAgICBkZWZhdWx0VGl0bGU6ICdFeGVtcGxvcycsXG4gICAgICBkZWZhdWx0TGlzdDogc2VhcmNoTGlzdEV4YW1wbGVzLFxuICAgICAgc3VnZ2VzdGlvbnNMaXN0OiBzZWFyY2hMaXN0LFxuICAgIH0pO1xuICAgIHNlYXJjaFN1Z2dlc3Rpb25zLmluaXQoKTtcbiAgfVxuXG4gIGlmIChnZXRVc2VyTG9jYXRpb25CdXR0b24pIHtcbiAgICBnZXRVc2VyTG9jYXRpb25CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICBnZXRVc2VyTG9jYXRpb24oZnVuY3Rpb24gKHVzZXJQb3MpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2codXNlclBvcyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8qKlxuICogTW9zdHJhciBNYXBhXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciBtYXBFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1sb2NhdG9yLW1hcCcpO1xuICB2YXIgbWFwQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJzLWxvY2F0b3ItdG9nZ2xlLW1hcCcpO1xuICB2YXIgbG9hZExvY2F0b3JNYXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gZGVidWdnZXI7XG4gICAgdmFyIGVsZW1lbnQgPSBtYXBFbDtcbiAgICB2YXIgdGFyZ2V0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1tYXAtYW5jaG9yXScpO1xuICAgIHZhciBzY3JvbGxUbyA9IGZ1bmN0aW9uICh0YXJnZXRBbmNob3IpIHtcbiAgICAgIGlmICh0YXJnZXRBbmNob3IpIHtcbiAgICAgICAgdmFyIHNjcm9sbCA9IG5ldyBTbW9vdGhTY3JvbGwoKTtcbiAgICAgICAgdmFyIGN1cnJlbnRBY3RpdmUgPSB0YXJnZXRBbmNob3IucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuYnMtaXMtYWN0aXZlJyk7XG4gICAgICAgIGlmIChjdXJyZW50QWN0aXZlKSBjdXJyZW50QWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2JzLWlzLWFjdGl2ZScpO1xuICAgICAgICB0YXJnZXRBbmNob3IuY2xhc3NMaXN0LmFkZCgnYnMtaXMtYWN0aXZlJyk7XG4gICAgICAgIHNjcm9sbC5hbmltYXRlU2Nyb2xsKHRhcmdldEFuY2hvciwgMCwgeyBzcGVlZDogMzAwLCBvZmZzZXQ6IDgwIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgdmFyIGxvY2F0aW9ucyA9IFtdO1xuICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgbWFwSGVpZ2h0OiA1MDAsXG4gICAgICBtYXBPcHRpb25zOiB7XG4gICAgICAgIHpvb206IDE0LFxuICAgICAgICBjZW50ZXI6IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoLTI1LjQyNzcwMiwgLTQ5LjI2NTE1OSksXG4gICAgICAgIG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVAsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICBpZiAoZWxlbWVudCAmJiB0YXJnZXRFbC5sZW5ndGgpIHtcbiAgICAgIGxvY2F0aW9ucyA9IEFycmF5LnByb3RvdHlwZS5tYXAuY2FsbCh0YXJnZXRFbCwgZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgIHZhciBpZCA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1tYXAtYW5jaG9yJyk7XG4gICAgICAgIHZhciBsYXQgPSBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbWFwLWxhdCcpO1xuICAgICAgICB2YXIgbG5nID0gZWwuZ2V0QXR0cmlidXRlKCdkYXRhLW1hcC1sbmcnKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgbGF0OiBwYXJzZUZsb2F0KGxhdCksXG4gICAgICAgICAgbG5nOiBwYXJzZUZsb2F0KGxuZyksXG4gICAgICAgICAgZm46IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNjcm9sbFRvKGVsKTsgfSxcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgICAgb3B0aW9ucy5sb2NhdGlvbnMgPSBsb2NhdGlvbnM7XG4gICAgICBCc01hcHMuaW5pdChlbGVtZW50LCBvcHRpb25zKTtcbiAgICB9XG4gIH07XG5cbiAgaWYgKCFtYXBFbCkgcmV0dXJuO1xuXG4gIGluaXRHb29nbGVNYXAoZnVuY3Rpb24gKCkge1xuICAgIGxvYWRMb2NhdG9yTWFwKG1hcEVsKTtcbiAgfSk7XG5cbiAgbWFwQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uIChldikge1xuICAgIHZhciBwYXJlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtbG9jYXRvcl9fcmVzdWx0cycpO1xuICAgIGlmIChldi50YXJnZXQuY2hlY2tlZCkgcGFyZW50LmNsYXNzTGlzdC5hZGQoJ2JzLWxvY2F0b3JfX3Jlc3VsdHMtLW1hcC1hY3RpdmUnKTtcbiAgICBlbHNlIHBhcmVudC5jbGFzc0xpc3QucmVtb3ZlKCdicy1sb2NhdG9yX19yZXN1bHRzLS1tYXAtYWN0aXZlJyk7XG4gIH0pO1xufSk7XG4iLCIvKipcbiAqIExvZ2luIE1vZGFsXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciBsb2dpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbnN0LWxvZ2luJyk7XG4gIHZhciBiYWNrVG9Qcm9kdWN0c0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5zdC1qcy1sb2dpbi1iYWNrLXRvLW1haW4nKTtcbiAgdmFyIGdvVG9TdWJsaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmluc3QtanMtbG9naW4tc2hvdy1zdWJsaXN0Jyk7XG4gIHZhciBzdWJsaXN0Qm94Q2xhc3MgPSAnaW5zdC1sb2dpbl9fYm94JztcbiAgdmFyIHN1Ymxpc3RBY3RpdmVDbGFzcyA9ICdpbnN0LWlzLWFjdGl2ZSc7XG4gIHZhciBoYXNTdWJsaXN0QWN0aXZlQ2xhc3MgPSAnaW5zdC1sb2dpbi0tc3ViLWFjdGl2ZSc7XG5cbiAgaWYgKGxvZ2luICYmIGdvVG9TdWJsaXN0Lmxlbmd0aCkge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZ29Ub1N1Ymxpc3QsIGZ1bmN0aW9uIChhbmNob3IpIHtcbiAgICAgIGFuY2hvci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldikge1xuICAgICAgICB2YXIgc3VibGlzdCA9IGFuY2hvci5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy4nICsgc3VibGlzdEJveENsYXNzKTtcbiAgICAgICAgdmFyIGZpcnN0QnV0dG9uID0gc3VibGlzdC5xdWVyeVNlbGVjdG9yKCcuYnMtYm94X19saW5rJyk7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgaWYgKHN1Ymxpc3QpIHtcbiAgICAgICAgICBzdWJsaXN0LmNsYXNzTGlzdC5hZGQoc3VibGlzdEFjdGl2ZUNsYXNzKTtcbiAgICAgICAgICBsb2dpbi5jbGFzc0xpc3QuYWRkKGhhc1N1Ymxpc3RBY3RpdmVDbGFzcyk7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgXHRmaXJzdEJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgIH0sIDMwMCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaWYgKGJhY2tUb1Byb2R1Y3RzTGlzdC5sZW5ndGgpIHtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYmFja1RvUHJvZHVjdHNMaXN0LCBmdW5jdGlvbiAoYW5jaG9yKSB7XG4gICAgICAgIGFuY2hvci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldikge1xuICAgICAgICAgIHZhciBzdWJsaXN0ID0gYW5jaG9yLmNsb3Nlc3QoJy4nICsgc3VibGlzdEJveENsYXNzKTtcbiAgICAgICAgICB2YXIgc3VibGlzdFBhcmVudEl0ZW0gPSBzdWJsaXN0LmNsb3Nlc3QoJy5icy1ib3hfX2l0ZW0nKTtcbiAgICAgICAgICB2YXIgc3VibGlzdFBhcmVudEJ1dHRvbiA9IHN1Ymxpc3RQYXJlbnRJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5icy1ib3hfX2xpbmsnKTtcbiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgc3VibGlzdC5jbGFzc0xpc3QucmVtb3ZlKHN1Ymxpc3RBY3RpdmVDbGFzcyk7XG4gICAgICAgICAgbG9naW4uY2xhc3NMaXN0LnJlbW92ZShoYXNTdWJsaXN0QWN0aXZlQ2xhc3MpO1xuICAgICAgICAgIHN1Ymxpc3RQYXJlbnRCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pO1xuXG4vKipcbiAqIExvZ2luIE1vZGFsIC0gS2V5Ym9hcmQgQWNjZXNzaWJpbGl0eVxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICB2YXIgbG9naW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW5zdC1sb2dpbicpO1xuICB2YXIgaXRlbXM7XG5cbiAgaWYgKGxvZ2luKSB7XG4gICAgaXRlbXMgPSBsb2dpbi5xdWVyeVNlbGVjdG9yQWxsKCcuYnMtYm94X19saW5rJyk7XG4gICAgdmFyIGJ1dHRvbnMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChpdGVtcyk7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChpdGVtcywgZnVuY3Rpb24gKGl0ZW1CdXR0b24pIHtcbiAgICAgIGl0ZW1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChldikge1xuICAgICAgICB2YXIga2V5ID0gZXYua2V5O1xuICAgICAgICB2YXIgY3VycmVudEJ1dHRvbiA9IGl0ZW1CdXR0b247XG4gICAgICAgIHZhciBoYXNTdWJsaXN0ID0gY3VycmVudEJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2luc3QtanMtbG9naW4tc2hvdy1zdWJsaXN0Jyk7XG4gICAgICAgIHZhciBpc1N1Ymxpc3RCYWNrQnV0dG9uID0gY3VycmVudEJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2luc3QtanMtbG9naW4tYmFjay10by1tYWluJyk7XG4gICAgICAgIHZhciBpc1N1Ymxpc3QgPSBmdW5jdGlvbiAoYnRuKSB7XG4gICAgICAgICAgcmV0dXJuIGJ0bi5jbG9zZXN0KCcuaW5zdC1sb2dpbl9fYm94Jyk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBhY3RpdmVCdXR0b25zID0gYnV0dG9ucy5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7XG4gICAgICAgICAgaWYgKGlzU3VibGlzdChjdXJyZW50QnV0dG9uKSkge1xuICAgICAgICAgICAgcmV0dXJuIGlzU3VibGlzdChlbCkgJiYgaXNTdWJsaXN0KGVsKSA9PT0gaXNTdWJsaXN0KGN1cnJlbnRCdXR0b24pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZWwub2Zmc2V0V2lkdGggPiAwICYmIGVsLm9mZnNldEhlaWdodCA+IDA7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgZmlyc3RCdXR0b24gPSBhY3RpdmVCdXR0b25zWzBdO1xuICAgICAgICB2YXIgbGFzdEJ1dHRvbiA9IGFjdGl2ZUJ1dHRvbnNbYWN0aXZlQnV0dG9ucy5sZW5ndGggLSAxXTtcbiAgICAgICAgdmFyIHByZXZCdXR0b24gPSBhY3RpdmVCdXR0b25zLmluZGV4T2YoY3VycmVudEJ1dHRvbilcbiAgICAgICAgICA/IGFjdGl2ZUJ1dHRvbnNbYWN0aXZlQnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pIC0gMV1cbiAgICAgICAgICA6IGxhc3RCdXR0b247XG4gICAgICAgIHZhciBuZXh0QnV0dG9uID0gYWN0aXZlQnV0dG9ucy5pbmRleE9mKGN1cnJlbnRCdXR0b24pIDwgYWN0aXZlQnV0dG9ucy5sZW5ndGggLSAxXG4gICAgICAgICAgPyBhY3RpdmVCdXR0b25zW2FjdGl2ZUJ1dHRvbnMuaW5kZXhPZihjdXJyZW50QnV0dG9uKSArIDFdXG4gICAgICAgICAgOiBmaXJzdEJ1dHRvbjtcblxuICAgICAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOlxuICAgICAgICAgIGNhc2UgJ1JpZ2h0JzogLy8gaWVcbiAgICAgICAgICAgIGlmIChoYXNTdWJsaXN0KSB7XG4gICAgICAgICAgICAgIGN1cnJlbnRCdXR0b24uY2xpY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdBcnJvd0xlZnQnOlxuICAgICAgICAgIGNhc2UgJ0xlZnQnOiAvLyBpZVxuICAgICAgICAgICAgaWYgKGlzU3VibGlzdEJhY2tCdXR0b24pIHtcbiAgICAgICAgICAgICAgY3VycmVudEJ1dHRvbi5jbGljaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ0Fycm93RG93bic6XG4gICAgICAgICAgY2FzZSAnRG93bic6IC8vIGllXG4gICAgICAgICAgICBuZXh0QnV0dG9uLmZvY3VzKCk7XG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgY2FzZSAnVXAnOiAvLyBpZVxuICAgICAgICAgICAgcHJldkJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ0hvbWUnOlxuICAgICAgICAgICAgZmlyc3RCdXR0b24uZm9jdXMoKTtcbiAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdFbmQnOlxuICAgICAgICAgICAgbGFzdEJ1dHRvbi5mb2N1cygpO1xuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59KTtcbiIsInZhciBwYWdlVVJMID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG5cbmlmIChwYWdlVVJMLmluY2x1ZGVzKCdub3RpY2lhcycpKSB7XG4gICAgaWYgKCFwYWdlVVJMLmluY2x1ZGVzKCcvbm90aWNpYS8nKSkge1xuICAgICAgICB3aW5kb3cub251bmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG4gICAgICAgIH1cbiAgICB9XG59IiwidmFyIHBhZ2VVUkwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcblxuaWYgKHBhZ2VVUkwuaW5jbHVkZXMoJ291dmlkb3JpYScpKSB7XG4gIHdpbmRvdy5vbnVubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAvL3dpbmRvdy5zY3JvbGxUbygwLCAwKTtcbiAgICB2YXIgZWxlbVNjcm9sbCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJicy1zZWN0aW9uLWhlYWRlcl9fdGl0bGVcIik7XG4gICAgZWxlbVNjcm9sbFswXS5zY3JvbGxJbnRvVmlldygpO1xuICAgIHdpbmRvdy5zY3JvbGxCeSgwLCAtMTYwKTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZWFkeShjYWxsYmFja0Z1bmMpIHtcbiAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT09ICdsb2FkaW5nJykge1xuICAgIGNhbGxiYWNrRnVuYygpO1xuICB9IGVsc2UgaWYgKGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgY2FsbGJhY2tGdW5jKTtcbiAgfSBlbHNlIHtcbiAgICBkb2N1bWVudC5hdHRhY2hFdmVudCgnb25yZWFkeXN0YXRlY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScpIHtcbiAgICAgICAgY2FsbGJhY2tGdW5jKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cblxucmVhZHkoZnVuY3Rpb24gKCkge1xuICB2YXIgdGV4dEFyZWFPdXZpZG9yaWEgPSBbXTtcbiAgdGV4dEFyZWFPdXZpZG9yaWEgPSBbZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI291dmlkb3JpYS1zdWdlc3Rhby1tZW5zYWdlbScpLFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNvdXZpZG9yaWEtZWxvZ2lvLW1lbnNhZ2VtJyksXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI291dmlkb3JpYS1yZWNsYW1hY2FvLW1lbnNhZ2VtJyksXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI291dmlkb3JpYS1yZWNsYW1hY2FvLXBlZGlkbycpXG4gIF07XG5cbiAgaWYgKHRleHRBcmVhT3V2aWRvcmlhWzBdICE9IG51bGwpIHtcbiAgICBmb3IgKGkgPSAwOyBpIDwgdGV4dEFyZWFPdXZpZG9yaWEubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRleHRBcmVhT3V2aWRvcmlhW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW5wdXRfZ3JvdXAgPSB0aGlzLnBhcmVudE5vZGU7XG4gICAgICAgIHZhciBzcGFuX3ZhbHVlID0gaW5wdXRfZ3JvdXAucXVlcnlTZWxlY3RvcignLmJzLWZvcm1fX29ic2VydmF0aW9uJyk7XG4gICAgICAgIHZhciB0ZXh0VG90YWxMZW5ndGggPSB0aGlzLmdldEF0dHJpYnV0ZSgnbWF4bGVuZ3RoJyk7XG4gICAgICAgIHZhciB0ZXh0TnVtYmVyTGVuZ3RoID0gdGhpcy52YWx1ZS5sZW5ndGg7XG4gICAgICAgIHZhciBzdHJfY2hhcl9yZW1haW5pbmcgPSBcIkxpbWl0YWRvIGVtIFwiICsgKHRleHRUb3RhbExlbmd0aCAtIHRleHROdW1iZXJMZW5ndGgpICsgXCIgY2FyYWN0ZXJlc1wiO1xuXG4gICAgICAgIHNwYW5fdmFsdWUuaW5uZXJIVE1MID0gc3RyX2NoYXJfcmVtYWluaW5nXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBTY3JpcHQgZXNwZWPDrWZpY28gcGFyYSBhIHDDoWdpbmEgZGUgTm9zc29zIEFwbGljYXRpdm9zXG4gKi9cbnZhciBQbk5vc3Nvc0FwcHMgPSAoZnVuY3Rpb24gKCkge1xuICB2YXIgY29uZmlnID0ge1xuICAgIC8vIEltYWdlbSBxdWUgZmljYXLDoSBmbHV0dWFuZG8ganVudG8gY29tIG8gc2Nyb2xsIGRhIHDDoWdpbmFcbiAgICBmbG9hdGluZ0ltYWdlOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGktZmxvYXRpbmctaW1hZ2UnKSxcbiAgICAvLyBXcmFwcGVyIGRvIGZsb2F0aW5nSW1hZ2UsIHNlcnZlIHBhcmEgaW5kaWNhciBhIHBvc2nDp8OjbyBlbSBxdWUgYSBpbWFnZW0gaXLDoVxuICAgIC8vIHBhcmFyIGRlIGZsdXR1YXIgZSB2b2x0YXLDoSBhbyBmbHV4byBuYXR1cmFsIGRvIEhUTUxcbiAgICBmbG9hdGluZ0ltYWdlV3JhcHBlcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBpLWZsb2F0aW5nLWltYWdlLXdyYXBwZXInKSxcbiAgICBjbGFzc2VzOiB7XG4gICAgICByZWxhdGl2ZTogJ3BpLWZsb2F0aW5nLWltYWdlLS1yZWxhdGl2ZScsXG4gICAgICBzY3JvbGxpbmdEb3duOiAncGktZmxvYXRpbmctaW1hZ2UtLXNjcm9sbGluZy1kb3duJyxcbiAgICAgIHNjcm9sbGluZ1VwOiAncGktZmxvYXRpbmctaW1hZ2UtLXNjcm9sbGluZy11cCcsXG4gICAgfSxcbiAgICAvLyBEaXN0w6JuY2lhIGVtIHBpeGVscyBkYSBwcm9wcmllZGFkZSAndG9wJyB1c2FkYSBubyBDU1NcbiAgICB0b3BPZmZzZXQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5waS1mbG9hdGluZy1pbWFnZScpLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChjb25maWcuZmxvYXRpbmdJbWFnZSAmJiBjb25maWcuZmxvYXRpbmdJbWFnZVdyYXBwZXIpIHtcbiAgICAgIGZsb2F0SW1hZ2UoKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGZsb2F0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy8gQXJtYXplbmEgYSDDumx0aW1hIHBvc2nDp8OjbyBkbyBzY3JvbGwgZGEgdGVsYVxuICAgIHZhciBsYXN0U2Nyb2xsVG9wID0gMDtcbiAgICB2YXIgdG9wT2Zmc2V0ID0gKGNvbmZpZy50b3BPZmZzZXQpICYmIHBhcnNlSW50KGNvbmZpZy50b3BPZmZzZXQuZGF0YXNldC50b3BPZmZzZXQsIDEwKTtcblxuICAgIHJlY3RzID0gcmVjdChjb25maWcuZmxvYXRpbmdJbWFnZSwgY29uZmlnLmZsb2F0aW5nSW1hZ2VXcmFwcGVyKTtcbiAgICB2YXIgaW1nVG9wID0gcmVjdHMuaW1hZ2UudG9wO1xuICAgIHZhciB3cmFwcGVyVG9wID0gcmVjdHMud3JhcHBlci50b3A7XG5cbiAgICAvLyB2ZXJpZmljYSBwb3Npw6fDo28gaW5pY2lhbCwgcGFyYSBldml0YXIgZXhpYmnDp8OjbyBkZXNuZWNlc3PDoXJpYSBlbSBvdXRyYSBwb3Npw6fDo28gZGEgdGVsYVxuICAgIGlmIChNYXRoLmFicyhpbWdUb3ApID49IE1hdGguYWJzKHdyYXBwZXJUb3ApKSB7XG4gICAgICBjb25maWcuZmxvYXRpbmdJbWFnZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLnNjcm9sbGluZ0Rvd24pO1xuICAgICAgY29uZmlnLmZsb2F0aW5nSW1hZ2UuY2xhc3NMaXN0LmFkZChjb25maWcuY2xhc3Nlcy5yZWxhdGl2ZSk7XG4gICAgfVxuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIFBvc2nDp8OjbyBhdHVhbCBkbyBzY3JvbGxcbiAgICAgIHZhciBjdXJyZW50U2Nyb2xsVG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICB2YXIgcmVjdHMgPSByZWN0KGNvbmZpZy5mbG9hdGluZ0ltYWdlLCBjb25maWcuZmxvYXRpbmdJbWFnZVdyYXBwZXIpO1xuXG4gICAgICAvLyBTY3JvbGwgZG93blxuICAgICAgaWYgKGN1cnJlbnRTY3JvbGxUb3AgPiBsYXN0U2Nyb2xsVG9wKSB7XG4gICAgICAgIGlmIChjdXJyZW50U2Nyb2xsVG9wID4gdG9wT2Zmc2V0KSB7XG4gICAgICAgICAgY29uZmlnLmZsb2F0aW5nSW1hZ2UuY2xhc3NMaXN0LmFkZChjb25maWcuY2xhc3Nlcy5zY3JvbGxpbmdEb3duKTtcbiAgICAgICAgICAvLyBWZXJpZmljYSBzZSBvIHRvcG8gZGEgaW1hZ2VtIGNvbGlkaXUgY29tIG8gdG9wbyBkbyB3cmFwcGVyXG4gICAgICAgICAgLy8gTmVzdGUgY2FzbywgYSBpbWFnZW0gZXN0w6EgbmEgcG9zacOnw6NvIGVtIHF1ZSBkZXZlIHBlcm1hbmVjZXIgKHBvc2l0aW9uIHJlbGF0aXZlKVxuICAgICAgICAgIGlmIChyZWN0cy5pbWFnZS50b3AgPj0gcmVjdHMud3JhcHBlci50b3ApIHtcbiAgICAgICAgICAgIGNvbmZpZy5mbG9hdGluZ0ltYWdlLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMuc2Nyb2xsaW5nRG93bik7XG4gICAgICAgICAgICBjb25maWcuZmxvYXRpbmdJbWFnZS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5jbGFzc2VzLnJlbGF0aXZlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgIC8vIFNlIG8gc2Nyb2xsIGNoZWdhciBhbyB0b3BvXG4gICAgICAgIChjdXJyZW50U2Nyb2xsVG9wID09PSAwKSB8fFxuICAgICAgICAoXG4gICAgICAgICAgKGN1cnJlbnRTY3JvbGxUb3AgPCB0b3BPZmZzZXQpICYmXG4gICAgICAgICAgKGNvbmZpZy5mbG9hdGluZ0ltYWdlLmNsYXNzTGlzdC5jb250YWlucyhjb25maWcuY2xhc3Nlcy5zY3JvbGxpbmdEb3duKSlcbiAgICAgICAgKVxuICAgICAgKSB7XG4gICAgICAgIGNvbmZpZy5mbG9hdGluZ0ltYWdlLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMuc2Nyb2xsaW5nVXApO1xuICAgICAgICBjb25maWcuZmxvYXRpbmdJbWFnZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLnNjcm9sbGluZ0Rvd24pO1xuICAgICAgICBjb25maWcuZmxvYXRpbmdJbWFnZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLnJlbGF0aXZlKTtcbiAgICAgIH0gZWxzZSBpZiAoKHJlY3RzLmltYWdlLmJvdHRvbSA+PSAoY3VycmVudFNjcm9sbFRvcCArIHRvcE9mZnNldCkpICYmIChjdXJyZW50U2Nyb2xsVG9wID4gdG9wT2Zmc2V0KSAmJiAocmVjdHMuaW1hZ2UudG9wID49IHJlY3RzLndyYXBwZXIudG9wKSkge1xuICAgICAgICAvLyBDYXNvIGNvbnRyw6FyaW8sIG8gdXN1w6FyaW8gZXN0aXZlciBkYW5kbyBTY3JvbGwgVXAgZVxuICAgICAgICAvLyBzZSBvIHRvcG8gZGEgaW1hZ2VtIGZvciBtYWlvciBxdWUgYSBwb3Npw6fDo29cbiAgICAgICAgLy8gYXR1YWwgZG8gKHBvc2nDp8OjbyBhdHVhbCBkbyBzY3JvbGwgLSB0b3Agb2Zmc2V0KVxuICAgICAgICBjb25maWcuZmxvYXRpbmdJbWFnZS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5jbGFzc2VzLnJlbGF0aXZlKTtcbiAgICAgICAgY29uZmlnLmZsb2F0aW5nSW1hZ2UuY2xhc3NMaXN0LmFkZChjb25maWcuY2xhc3Nlcy5zY3JvbGxpbmdVcCk7XG4gICAgICB9XG4gICAgICAvLyBNb2JpbGUgb3Ugc2Nyb2xsaW5nIG5lZ2F0aXZvXG4gICAgICBsYXN0U2Nyb2xsVG9wID0gY3VycmVudFNjcm9sbFRvcCA8PSAwID8gMCA6IGN1cnJlbnRTY3JvbGxUb3A7XG4gICAgfSwgZmFsc2UpO1xuICB9O1xuXG4gIC8vIE9idMOpbSBvcyBsaW1pdGVzIGRvcyBlbGVtZW50b3MgcGFyYSBwb2Rlcm1vcyBpZGVudGlmaWNhciBzZSBhIGltYWdlbSAnY29saWRlJyBjb20gbyB3cmFwcGVyXG4gIHZhciByZWN0ID0gZnVuY3Rpb24gKGltYWdlLCB3cmFwcGVyKSB7XG4gICAgdmFyIGltYWdlUmVjdCA9IGltYWdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIHZhciB3cmFwcGVyUmVjdCA9IHdyYXBwZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICB2YXIgcmVjdEVsZW1lbnRzID0ge1xuICAgICAgaW1hZ2U6IHtcbiAgICAgICAgYm90dG9tOiBpbWFnZVJlY3QuYm90dG9tLFxuICAgICAgICBsZWZ0OiBpbWFnZVJlY3QubGVmdCxcbiAgICAgICAgcmlnaHQ6IGltYWdlUmVjdC5yaWdodCxcbiAgICAgICAgdG9wOiBpbWFnZVJlY3QudG9wLFxuICAgICAgfSxcbiAgICAgIHdyYXBwZXI6IHtcbiAgICAgICAgYm90dG9tOiB3cmFwcGVyUmVjdC5ib3R0b20sXG4gICAgICAgIGxlZnQ6IHdyYXBwZXJSZWN0LmxlZnQsXG4gICAgICAgIHJpZ2h0OiB3cmFwcGVyUmVjdC5yaWdodCxcbiAgICAgICAgdG9wOiB3cmFwcGVyUmVjdC50b3AsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICByZXR1cm4gcmVjdEVsZW1lbnRzO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBQbk5vc3Nvc0FwcHMgY29uc3RydWN0b3JcbiAqIEByZXR1cm4ge3ZvaWR9IFBuTm9zc29zQXBwcy5pbml0KCk7XG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGktbm9zc29zLWFwcHMnKS5sZW5ndGgpIHtcbiAgICBQbk5vc3Nvc0FwcHMuaW5pdCgpO1xuICB9XG59KTtcbiIsIi8qKlxuICogVGFic1xuICogR3VpYXMgKHRhYnMpIG9yZ2FuaXphbSBlIHBlcm1pdGVtIGEgbmF2ZWdhw6fDo28gZW50cmUgZ3J1cG9zIGRlIGNvbnRlw7pkb1xuICogcXVlIGVzdMOjbyByZWxhY2lvbmFkb3MgZSBwb3NzdWVtIG8gbWVzbW8gbsOtdmVsIGRlIGhpZXJhcnF1aWEuXG4gKi9cbnZhciBQaVRlbGVmb25lcyA9IChmdW5jdGlvbiAoKSB7XG4gIC8vIENvbmZpZ1xuICB2YXIgY29uZmlnID0ge1xuICAgIGJ1dHRvbnM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5waS10ZWxlZm9uZXNfX2ZpbHRlciAuYnMtbWVkaWFfX2JveCcpLFxuICAgIGNsYXNzZXM6IHtcbiAgICAgIGNvbnRlbnRBY3RpdmU6ICdwaS10ZWxlZm9uZXNfX2NvbnRlbnQtLWFjdGl2ZScsXG4gICAgICBidXR0b25BY3RpdmU6ICdicy1tZWRpYV9fYm94LS1hY3RpdmUnLFxuICAgIH0sXG4gICAgY29udGVudDogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBpLXRlbGVmb25lc19fY29udGVudCcpLFxuICAgIHNjcm9sbDogbmV3IFNtb290aFNjcm9sbCgpLFxuICB9O1xuXG4gIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChjb25maWcuYnV0dG9ucyAmJiBjb25maWcuY29udGVudCkge1xuICAgICAgdmFyIGNvbnRlbnRUb2dnbGVyID0gbmV3IEJzVG9nZ2xlQ29udGVudCgpO1xuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIGJ1dHRvbnM6IGNvbmZpZy5idXR0b25zLFxuICAgICAgICBidXR0b25GaXJzdDogY29uZmlnLmJ1dHRvbnNbMF0sXG4gICAgICAgIGNvbnRhaW5lcnM6IGNvbmZpZy5jb250ZW50LFxuICAgICAgICBhY3RpdmVCdXR0b25DbGFzczogY29uZmlnLmNsYXNzZXMuYnV0dG9uQWN0aXZlLFxuICAgICAgICBhY3RpdmVDb250YWluZXJDbGFzczogY29uZmlnLmNsYXNzZXMuY29udGVudEFjdGl2ZSxcbiAgICAgICAgbWV0aG9kOiAnY2xpY2snLFxuICAgICAgICBzY3JvbGxUb0NvbnRlbnQ6IHRydWUsXG4gICAgICB9O1xuXG4gICAgICBjb250ZW50VG9nZ2xlci5pbml0KG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGlmIChjb25maWcuYnV0dG9ucykge1xuICAgICAgdmFyIGZpcnN0ID0gb3B0aW9ucy5idXR0b25GaXJzdDtcbiAgICAgIGZpcnN0LmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMuYnV0dG9uQWN0aXZlKTtcblxuICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChjb25maWcuYnV0dG9ucywgZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICBfdG9nZ2xlQWN0aXZlKGJ1dHRvbik7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBfdG9nZ2xlQWN0aXZlID0gZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgIF9yZW1vdmVBY3RpdmVDbGFzcygpO1xuXG4gICAgaWYgKGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmNsYXNzZXMuYnV0dG9uQWN0aXZlKSkge1xuICAgICAgYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmNsYXNzZXMuYnV0dG9uQWN0aXZlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoY29uZmlnLmNsYXNzZXMuYnV0dG9uQWN0aXZlKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIF9yZW1vdmVBY3RpdmVDbGFzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGNvbmZpZy5idXR0b25zLCBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZShjb25maWcuY2xhc3Nlcy5idXR0b25BY3RpdmUpO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdDogaW5pdCxcbiAgfTtcbn0oKSk7XG5cbi8qKlxuICogSW5pdCBQaVRlbGVmb25lcyBjb25zdHJ1Y3RvclxuICogQHJldHVybiB7dm9pZH0gUGlUZWxlZm9uZXMuaW5pdCgpO1xuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBpLXRlbGVmb25lcycpLmxlbmd0aCkge1xuICAgIFBpVGVsZWZvbmVzLmluaXQoKTtcbiAgfVxufSk7XG4iLCIvKipcbiAqIEZvcm11bMOhcmlvIGRlIFJlbGHDp8OjbyBkZSBQbGFub3NcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgdmFyIGZvcm1QbGFub3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnMtanMtZm9ybS1wbGFub3MnKTtcbiAgdmFyIGZvcm1TZWxlY3RzID0gW107XG4gIHZhciByZXNldFNlbGVjdHMgPSBmdW5jdGlvbiAoc2VsZWN0cykge1xuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoc2VsZWN0cywgZnVuY3Rpb24gKHNlbGVjdCkge1xuICAgICAgdmFyIG9wdGlvbnMgPSBzZWxlY3QucXVlcnlTZWxlY3RvckFsbCgnb3B0aW9uJyk7XG4gICAgICBvcHRpb25zWzBdLnNlbGVjdGVkID0gJ3NlbGVjdGVkJztcbiAgICB9KTtcbiAgfTtcblxuICBpZiAoZm9ybVBsYW5vcykge1xuICAgIGZvcm1TZWxlY3RzID0gZm9ybVBsYW5vcy5xdWVyeVNlbGVjdG9yQWxsKCdzZWxlY3QnKTtcbiAgfVxuXG4gIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZm9ybVNlbGVjdHMsIGZ1bmN0aW9uIChzZWxlY3QpIHtcbiAgICBzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHNlbGVjdHNUb1Jlc2V0ID0gQXJyYXkucHJvdG90eXBlLmZpbHRlci5jYWxsKGZvcm1TZWxlY3RzLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgcmV0dXJuIGVsICE9PSBzZWxlY3Q7XG4gICAgICB9KTtcbiAgICAgIHJlc2V0U2VsZWN0cyhzZWxlY3RzVG9SZXNldCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iLCIvKipcbiAqIE1vZGFsL1RhYmVsYSBkZSBzZWxlw6fDo28gZGUgcGxhbm9zXG4gKi9cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gIHZhciBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icy1qcy1zZWxlY2lvbmUtcGxhbm8taW5wdXQnKTtcbiAgdmFyIG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21vZGFsLXNlbGVjaW9uZS1wbGFubycpO1xuICB2YXIgcGxhblNlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJzLWpzLXNlbGVjaW9uZS1wbGFubycpO1xuXG4gIGlmIChwbGFuU2VsZWN0b3IubGVuZ3RoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChwbGFuU2VsZWN0b3IsIGZ1bmN0aW9uIChzZWxlY3Rvcikge1xuICAgICAgc2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZWxlY3Rvck5hbWUgPSBzZWxlY3Rvci5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGxhbm8nKTtcbiAgICAgICAgaW5wdXQudmFsdWUgPSBzZWxlY3Rvck5hbWU7XG4gICAgICAgIEJzTW9kYWwuY2xvc2UobW9kYWwpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn0pO1xuIiwiLyoqXG4gKiBCc1NlbGVjdEZpbHRlclxuICogQHJldHVybiB7T2JqZWN0fSBtZXRob2RzXG4gKi9cbnZhciBCc1NlbGVjdEZpbHRlciA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIGNvbmZpZyA9IHt9O1xuXG4gIHZhciBzZXRDb25maWcgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgIHZhciBkZWZhdWx0cyA9IHtcbiAgICAgIGlucHV0OiAnaW5wdXQnLFxuICAgICAgbGlzdDogJ3VsJyxcbiAgICAgIGFwcGx5OiAnJyxcbiAgICAgIGxpc3RPZlRlcm1zOiBbXSxcbiAgICAgIGl0ZW1zOiBbXSxcbiAgICAgIHNlbGVjdGVkSXRlbXM6IFtdLFxuICAgICAgZmlsdGVyZWRJdGVtczogW10sXG4gICAgICBzZWxlY3RNdWx0aXBsZTogZmFsc2UsXG4gICAgICBhdXRvQXBwbHk6IGZhbHNlLFxuICAgICAgc2hvd0FwcGx5QnV0dG9uOiBmYWxzZSxcbiAgICAgIGFwcGx5QnV0dG9uQ2xhc3M6ICdicy1zZWxlY3QtZmlsdGVyX19hcHBseScsXG4gICAgICBhcHBseUJ1dHRvbkFjdGl2ZUNsYXNzOiAnYnMtc2VsZWN0LWZpbHRlcl9fYXBwbHktLWFjdGl2ZScsXG4gICAgICBpdGVtU2VsZWN0OiBmdW5jdGlvbiAoKSB7fSxcbiAgICAgIGl0ZW1VbnNlbGVjdDogZnVuY3Rpb24gKCkge30sXG4gICAgICBpdGVtc0FwcGx5OiBmdW5jdGlvbiAoKSB7fSxcbiAgICAgIGxpc3RGaWx0ZXI6IGZ1bmN0aW9uICgpIHt9LFxuICAgIH07XG5cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMgIT09ICdvYmplY3QnKSBvcHRpb25zID0ge307XG4gICAgcmV0dXJuIGV4dGVuZCh7fSwgZGVmYXVsdHMsIG9wdGlvbnMpO1xuICB9O1xuXG4gIHZhciBleHRlbmQgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG5cbiAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfTtcblxuICB2YXIgaW5pdCA9IGZ1bmN0aW9uIChlbCwgb3B0aW9ucykge1xuICAgIHZhciBzZWxlY3RGaWx0ZXIgPSBlbDtcblxuICAgIGNvbmZpZyA9IHNldENvbmZpZyhvcHRpb25zKTtcbiAgICBpZiAoIXNlbGVjdEZpbHRlcikgcmV0dXJuO1xuXG4gICAgY29uZmlnLmlucHV0ID0gc2VsZWN0RmlsdGVyLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLmlucHV0KTtcbiAgICBjb25maWcubGlzdCA9IHNlbGVjdEZpbHRlci5xdWVyeVNlbGVjdG9yKGNvbmZpZy5saXN0KTtcbiAgICBjb25maWcubGlzdC5jbGFzc0xpc3QuYWRkKCdicy1zZWxlY3QtZmlsdGVyX19saXN0Jyk7XG4gICAgY29uZmlnLnNlbGVjdEZpbHRlciA9IHNlbGVjdEZpbHRlcjtcblxuICAgIGlmIChjb25maWcuc2hvd0FwcGx5QnV0dG9uKSBjcmVhdGVBcHBseUJ1dHRvbigpO1xuXG4gICAgYnVpbGRJdGVtcyhjb25maWcubGlzdCwge1xuICAgICAgaXRlbUNsYXNzOiAnYnMtc2VsZWN0LWZpbHRlcl9faXRlbScsXG4gICAgICBpdGVtTGlua0NsYXNzOiAnYnMtc2VsZWN0LWZpbHRlcl9fbGluaycsXG4gICAgfSk7XG5cbiAgICBjb25maWcuaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGNvbmZpZy5zZWFyY2hUZXJtID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgICAgZmlsdGVyTGlzdCgpO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBzZXRJdGVtc0V2ZW50ID0gZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChpdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghaXNTZWxlY3RlZEl0ZW0oaXRlbSkpIHtcbiAgICAgICAgICBzZWxlY3RJdGVtKGl0ZW0pO1xuICAgICAgICAgIGlmICghY29uZmlnLnNlbGVjdE11bHRpcGxlICYmIGNvbmZpZy5hdXRvQXBwbHkpIHtcbiAgICAgICAgICAgIGFwcGx5SXRlbXMoW2l0ZW1dKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdG9nZ2xlQXBwbHlCdXR0b24odHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHVuc2VsZWN0SXRlbShpdGVtKTtcbiAgICAgICAgICBpZiAoY29uZmlnLnNlbGVjdE11bHRpcGxlICYmICFjb25maWcuc2VsZWN0ZWRJdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRvZ2dsZUFwcGx5QnV0dG9uKGZhbHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBidWlsZEl0ZW1zID0gZnVuY3Rpb24gKGxpc3RFbGVtZW50LCBvcHRpb25zKSB7XG4gICAgdmFyIGl0ZW1zID0gW1xuICAgICAge1xuICAgICAgICBsaW5rOiAnIyEnLFxuICAgICAgICBjb250ZW50OiAnTG9yZW0gaXBzdW0nLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbGluazogJyMhJyxcbiAgICAgICAgY29udGVudDogJ0xvcmVtIGlwc3VtIGRvbG9yJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgIGNvbnRlbnQ6ICdMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCBjb25zZWN0ZXR1cicsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBsaW5rOiAnIyEnLFxuICAgICAgICBjb250ZW50OiAnQWRpcGlzaWNpbmcgZWxpdCcsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBsaW5rOiAnIyEnLFxuICAgICAgICBjb250ZW50OiAnU2VkIGRvIGVpdXNtb2QgdGVtcG9yJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgIGNvbnRlbnQ6ICdJbmNpZGlkdW50IHV0IGxhYm9yZScsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBsaW5rOiAnIyEnLFxuICAgICAgICBjb250ZW50OiAnVXQgZW5pbSBhZCBtaW5pbSB2ZW5pYW0nLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbGluazogJyMhJyxcbiAgICAgICAgY29udGVudDogJ0FsaXF1aXAgZXggZWEgY29tbW9kbycsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBsaW5rOiAnIyEnLFxuICAgICAgICBjb250ZW50OiAnUXVpcyBub3N0cnVkIGV4ZXJjaXRhdGlvbiB1bGxhbWNvJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgIGNvbnRlbnQ6ICdMYWJvcmlzIG5pc2kgdXQnLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbGluazogJyMhJyxcbiAgICAgICAgY29udGVudDogJ0V0IGRvbG9yZSBtYWduYSBhbGlxdWEnLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbGluazogJyMhJyxcbiAgICAgICAgY29udGVudDogJ0NvbnNlcXVhdCcsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBsaW5rOiAnIyEnLFxuICAgICAgICBjb250ZW50OiAnRHVpcyBhdXRlIGlydXJlIGRvbG9yJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgIGNvbnRlbnQ6ICdJbiByZXByZWhlbmRlcml0JyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgIGNvbnRlbnQ6ICdJbiB2b2x1cHRhdGUgdmVsaXQnLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbGluazogJyMhJyxcbiAgICAgICAgY29udGVudDogJ0Vzc2UgY2lsbHVtJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgIGNvbnRlbnQ6ICdEb2xvcmUgZXUgZnVnaWF0IG51bGxhIHBhcmlhdHVyJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGxpbms6ICcjIScsXG4gICAgICAgIGNvbnRlbnQ6ICdFeGNlcHRldXIgc2ludCcsXG4gICAgICB9LFxuICAgIF07XG4gICAgdmFyIHNldHRpbmdzID0gZXh0ZW5kKHtcbiAgICAgIGl0ZW1DbGFzczogJycsXG4gICAgICBpdGVtTGlua0NsYXNzOiAnJyxcbiAgICB9LCBvcHRpb25zKTtcblxuICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7XG4gICAgICB2YXIgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgICAgdmFyIGNvbnRlbnRFbGVtZW50ID0gbGk7XG4gICAgICB2YXIgYW5jaG9yO1xuXG4gICAgICBsaS5jbGFzc0xpc3QuYWRkKHNldHRpbmdzLml0ZW1DbGFzcyk7XG5cbiAgICAgIGlmIChpdGVtLmxpbmspIHtcbiAgICAgICAgYW5jaG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgICBhbmNob3IuY2xhc3NMaXN0LmFkZChzZXR0aW5ncy5pdGVtTGlua0NsYXNzKTtcbiAgICAgICAgYW5jaG9yLmhyZWYgPSBpdGVtLmxpbms7XG4gICAgICAgIGNvbnRlbnRFbGVtZW50ID0gYW5jaG9yO1xuICAgICAgICBsaS5hcHBlbmRDaGlsZChhbmNob3IpO1xuICAgICAgfVxuXG4gICAgICBjb250ZW50RWxlbWVudC5pbm5lclRleHQgPSBpdGVtLmNvbnRlbnQ7XG4gICAgICBsaXN0RWxlbWVudC5hcHBlbmRDaGlsZChsaSk7XG4gICAgICBpdGVtc1tpbmRleF0uZWxlbWVudCA9IGxpO1xuICAgIH0pO1xuICAgIGNvbmZpZy5saXN0T2ZUZXJtcyA9IGl0ZW1zO1xuICAgIGNvbmZpZy5pdGVtcyA9IGNvbmZpZy5saXN0T2ZUZXJtcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIHJldHVybiBpdGVtLmVsZW1lbnQ7XG4gICAgfSk7XG5cbiAgICBzZXRJdGVtc0V2ZW50KGNvbmZpZy5pdGVtcyk7XG4gIH07XG5cbiAgdmFyIGZpbHRlckxpc3QgPSBmdW5jdGlvbiAobGlzdCkge1xuICAgIHZhciBmaWx0ZXJlZCA9IFtdO1xuICAgIGxpc3QgPSBjb25maWcuaXRlbXM7XG5cbiAgICBjb25maWcuZmlsdGVyZWRJdGVtcyA9IFtdO1xuXG4gICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICB2YXIgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIHZhciBlbGVtZW50O1xuICAgICAgdmFyIGNvbnRlbnQ7XG4gICAgICB2YXIgY29udGVudEhpZ2hsaWdodGVkO1xuXG4gICAgICBpZiAoIShpdGVtIGluc3RhbmNlb2YgRWxlbWVudCkpIHRocm93IEVycm9yKCdpdGVtIG11c3QgYmUgYSB2YWxpZCBET00gZWxlbWVudCcpO1xuXG4gICAgICAvLyBUT0RPOiB0ZXN0IHRvIGdldCBieSBjbGFzcywgbm90IHRhZ1xuICAgICAgLy8gVE9ETzogYWRkIHN0YXRlbWVudCBpZiB0aGVyZSdzIG5vIGFuY2hvciBzb21lIGNoaWxkXG4gICAgICBpZiAoaXRlbS5jaGlsZHJlbi5sZW5ndGggJiYgaXRlbS5jaGlsZHJlblswXS50YWdOYW1lID09PSAnQScpIGVsZW1lbnQgPSBpdGVtLmNoaWxkcmVuWzBdO1xuXG4gICAgICBjb250ZW50ID0gZWxlbWVudC50ZXh0Q29udGVudDtcbiAgICAgIGNvbnRlbnRIaWdobGlnaHRlZCA9IGhpZ2hsaWdodFRlcm1zKGNvbnRlbnQsIGNvbmZpZy5zZWFyY2hUZXJtKSB8fCAnJztcblxuICAgICAgc3Bhbi5pbm5lckhUTUwgPSBjb250ZW50SGlnaGxpZ2h0ZWQ7XG4gICAgICBzcGFuLnNldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScsIGNvbnRlbnQpO1xuICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoc3Bhbik7XG5cbiAgICAgIGlmIChjb250ZW50SGlnaGxpZ2h0ZWQgIT09IGNvbnRlbnQpIHtcbiAgICAgICAgY29uZmlnLmZpbHRlcmVkSXRlbXMucHVzaChpdGVtKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbmZpZy5saXN0RmlsdGVyKGNvbmZpZy5maWx0ZXJlZEl0ZW1zKTtcbiAgfTtcblxuICAvLyBUbyBiZSBleHRlcm5hbFxuICB2YXIgc2V0SGlnaGxpZ2h0ZWRJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcblxuICB9O1xuXG4gIHZhciBzZWxlY3RJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBjb25maWcuc2VsZWN0ZWRJdGVtcy5wdXNoKGl0ZW0pO1xuICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnYnMtc2VsZWN0LWZpbHRlcl9faXRlbS0tc2VsZWN0ZWQnKTtcbiAgICBjb25maWcuaXRlbVNlbGVjdChpdGVtKTtcbiAgfTtcblxuICB2YXIgdW5zZWxlY3RJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgaW5kZXggPSBjb25maWcuc2VsZWN0ZWRJdGVtcy5pbmRleE9mKGl0ZW0pO1xuICAgIGlmIChpbmRleCA+IC0xKSBjb25maWcuc2VsZWN0ZWRJdGVtcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnYnMtc2VsZWN0LWZpbHRlcl9faXRlbS0tc2VsZWN0ZWQnKTtcbiAgICBjb25maWcuaXRlbVVuc2VsZWN0KGl0ZW0pO1xuICB9O1xuXG4gIHZhciB1bnNlbGVjdEFsbEl0ZW1zID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpdGVtcyA9IGNvbmZpZy5zZWxlY3RlZEl0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW07XG4gICAgfSk7XG4gICAgaXRlbXMuZm9yRWFjaCh1bnNlbGVjdEl0ZW0pO1xuICAgIHRvZ2dsZUFwcGx5QnV0dG9uKGZhbHNlKTtcbiAgfTtcblxuICB2YXIgaXNTZWxlY3RlZEl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIHJldHVybiBpdGVtLmNsYXNzTGlzdC5jb250YWlucygnYnMtc2VsZWN0LWZpbHRlcl9faXRlbS0tc2VsZWN0ZWQnKTtcbiAgfTtcblxuICB2YXIgdG9nZ2xlQXBwbHlCdXR0b24gPSBmdW5jdGlvbiAoc2hvdykge1xuICAgIGlmICghY29uZmlnLmFwcGx5KSByZXR1cm47XG4gICAgLy8gc2hvdy9oaWRlXG4gICAgaWYgKHR5cGVvZiBzaG93ID09PSAnYm9vbGVhbicpIHtcbiAgICAgIC8vIHNob3dcbiAgICAgIGlmIChzaG93KSBjb25maWcuYXBwbHkuY2xhc3NMaXN0LmFkZChjb25maWcuYXBwbHlCdXR0b25BY3RpdmVDbGFzcyk7XG4gICAgICAvLyBoaWRlXG4gICAgICBlbHNlIGNvbmZpZy5hcHBseS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5hcHBseUJ1dHRvbkFjdGl2ZUNsYXNzKTtcbiAgICAvLyB0b2dnbGVcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBzaG93ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgLy8gaGlkZVxuICAgICAgaWYgKGNvbmZpZy5hcHBseS5jbGFzc0xpc3QuY29udGFpbnMoY29uZmlnLmFwcGx5QnV0dG9uQWN0aXZlQ2xhc3MpKSB7XG4gICAgICAgIGNvbmZpZy5hcHBseS5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5hcHBseUJ1dHRvbkFjdGl2ZUNsYXNzKTtcbiAgICAgIC8vIHNob3dcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbmZpZy5hcHBseS5jbGFzc0xpc3QuYWRkKGNvbmZpZy5hcHBseUJ1dHRvbkFjdGl2ZUNsYXNzKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgdmFyIGNyZWF0ZUFwcGx5QnV0dG9uID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB2YXIgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdidXR0b24nKTtcbiAgICBidXR0b24uY2xhc3NOYW1lID0gY29uZmlnLmFwcGx5QnV0dG9uQ2xhc3M7XG4gICAgYnV0dG9uLmlubmVyVGV4dCA9ICdBcGxpY2FyJztcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICBhcHBseUl0ZW1zKGNvbmZpZy5zZWxlY3RlZEl0ZW1zKTtcbiAgICB9KTtcbiAgICBjb25maWcuYXBwbHkgPSBidXR0b247XG4gICAgZGl2LmFwcGVuZENoaWxkKGJ1dHRvbik7XG4gICAgY29uZmlnLmxpc3QucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZGl2LCBjb25maWcubGlzdC5uZXh0U2libGluZyk7XG4gIH07XG5cbiAgdmFyIGFwcGx5SXRlbXMgPSBmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICBjb25maWcuaXRlbXNBcHBseShpdGVtcyk7XG4gIH07XG5cbiAgdmFyIGdldEZpbHRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY29uZmlnLnNlbGVjdEZpbHRlcjtcbiAgfTtcblxuICB2YXIgZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGNvbmZpZy5pdGVtcztcbiAgfTtcblxuICB2YXIgZ2V0U2VsZWN0ZWRJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY29uZmlnLnNlbGVjdGVkSXRlbXM7XG4gIH07XG5cbiAgdmFyIGdldEZpbHRlcmVkSXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGNvbmZpZy5maWx0ZXJlZEl0ZW1zO1xuICB9O1xuXG4gIHZhciBvbiA9IGZ1bmN0aW9uIChldiwgY2IpIHtcbiAgICBpZiAodHlwZW9mIGV2ICE9PSAnc3RyaW5nJyB8fCB0eXBlb2YgY2IgIT09ICdmdW5jdGlvbicpIHJldHVybjtcbiAgICBpZiAoY29uZmlnW2V2XSkgY29uZmlnW2V2XSA9IGNiO1xuICB9O1xuXG4gIC8vIHZhciBhZGRJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgLy8gICB2YXIgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAvLyAgIHZhciBhbmNob3I7XG4gIC8vICAgdmFyIGNvbnRlbnRzO1xuICAvL1xuICAvLyAgIGlmICghaXRlbSB8fCAhaXRlbS5jb250ZW50Lmxlbmd0aCkgcmV0dXJuO1xuICAvL1xuICAvLyAgIGlmICh0eXBlb2YgaXRlbS5jb250ZW50ID09PSAnc3RyaW5nJykgY29udGVudHMgPSBbaXRlbS5jb250ZW50XTtcbiAgLy8gICBlbHNlIGlmIChBcnJheS5pc0FycmF5KGl0ZW0uY29udGVudCkpIGNvbnRlbnRzID0gaXRlbS5jb250ZW50O1xuICAvLyAgIGVsc2UgY29uc29sZS5lcnJvcignaXRlbSBjb250ZW50IHNob3VsZCBiZSBhIHN0cmluZyBvciBhbiBhcnJheSBvZiBzdHJpbmdzJyk7XG4gIC8vXG4gIC8vICAgbGkuY2xhc3NMaXN0LmFkZChjb25maWcuaXRlbUNsYXNzKTtcbiAgLy9cbiAgLy8gICBpZiAoaXRlbS5saW5rKSB7XG4gIC8vICAgICBhbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gIC8vICAgICBhbmNob3IuY2xhc3NMaXN0LmFkZChjb25maWcuaXRlbUxpbmtDbGFzcyk7XG4gIC8vICAgICBhbmNob3IuaHJlZiA9IGl0ZW0ubGluaztcbiAgLy8gICAgIGxpLmFwcGVuZENoaWxkKGFuY2hvcik7XG4gIC8vICAgfVxuICAvL1xuICAvLyAgIGNvbnRlbnRzLmZvckVhY2goZnVuY3Rpb24gKGNvbnRlbnQsIGluZGV4KSB7XG4gIC8vICAgICB2YXIgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgLy8gICAgIHZhciBjb250ZW50SGlnaGxpZ2h0ZWQgPSBoaWdobGlnaHRUZXJtKGNvbnRlbnQsIGNvbmZpZy5zZWFyY2hUZXJtKSB8fCAnJztcbiAgLy8gICAgIHNwYW4uaW5uZXJIVE1MID0gY29udGVudEhpZ2hsaWdodGVkIHx8IGNvbnRlbnQ7XG4gIC8vICAgICBzcGFuLnNldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScsIGNvbnRlbnQpO1xuICAvLyAgICAgaWYgKGNvbmZpZy5jb250ZW50Q2xhc3Nlcy5sZW5ndGgpIHNwYW4uY2xhc3NMaXN0LmFkZChjb25maWcuY29udGVudENsYXNzZXNbaW5kZXhdKTtcbiAgLy8gICAgIGlmIChhbmNob3IpIGFuY2hvci5hcHBlbmRDaGlsZChzcGFuKTtcbiAgLy8gICAgIGVsc2UgbGkuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gIC8vICAgfSk7XG4gIC8vXG4gIC8vICAgcmV0dXJuIGxpO1xuICAvLyB9O1xuXG4gIHZhciBoaWdobGlnaHRUZXJtcyA9IGZ1bmN0aW9uIChzdHIsIHRlcm0pIHtcbiAgICAvLyBBcnJheSB0byBzdG9yZSBzdHJpbmdzIGJlZm9yZSBqb2luXG4gICAgdmFyIG9jY3VycmVuY2VzU3RyaW5nID0gW107XG5cbiAgICAvLyBDaGVjayBpZiBib3RoIHBhcmFtZXRlcnMgd2FzIHBhc3NlZFxuICAgIGlmICh0eXBlb2Ygc3RyID09PSAndW5kZWZpbmVkJyB8fFxuICAgICAgdHlwZW9mIHRlcm0gPT09ICd1bmRlZmluZWQnKSByZXR1cm47XG5cbiAgICAvKipcbiAgICAgKiBMb29wIHRocm91Z2ggcGFydHMgb2Ygc3RyIHRvIGNoZWNrIGlmIGl0IGhhcyB0ZXJtIGluXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0clBhcnQgc29tZSBzdHJpbmcgd2hlcmUgdG8gZmluZCBvdXQgdGVybVxuICAgICAqL1xuICAgIHZhciBhbGxJbmRleCA9IGZ1bmN0aW9uIChzdHJQYXJ0KSB7XG4gICAgICB2YXIgcmVhbFN0cmluZyA9ICcnO1xuICAgICAgdmFyIG5ld1N0cmluZyA9ICcnO1xuICAgICAgdmFyIGlkeDtcbiAgICAgIC8vIGNoZWNrIGlmIHN0clBhcnQgaGFzIHRlcm0sXG4gICAgICBpZHggPSBpbmRleE9mU3BlY2lhbChzdHJQYXJ0LCB0ZXJtKTtcbiAgICAgIGlmIChpZHggPiAtMSkge1xuICAgICAgICAvLyBzdG9yZSB0aGUgcmVhbFN0cmluZ1xuICAgICAgICByZWFsU3RyaW5nID0gc3RyUGFydC5zdWJzdHJpbmcoaWR4LCBpZHggKyB0ZXJtLmxlbmd0aCk7XG4gICAgICAgIG5ld1N0cmluZyA9ICc8Yj4nICsgcmVhbFN0cmluZyArICc8L2I+JztcbiAgICAgICAgLy8gc3RvcmUgdGhlIHBhcnQgb2YgdGhlIHN0clBhcnQgYmVmb3JlIHJlYWxTdHJpbmcgYW5kIHJlYWxTdHJpbmcgcmVwbGFjZWRcbiAgICAgICAgLy8gd2l0aCBib2xkIEhUTUwgdGFnc1xuICAgICAgICBzdHJCZWZvcmUgPSBzdHJQYXJ0LnN1YnN0cmluZygwLCBpZHggKyByZWFsU3RyaW5nLmxlbmd0aCkucmVwbGFjZShyZWFsU3RyaW5nLCBuZXdTdHJpbmcpO1xuICAgICAgICAvLyBzdG9yZSB0aGUgcGFydCBvZiB0aGUgc3RyUGFydCBhZnRlciByZWFsU3RyaW5nXG4gICAgICAgIHN0ckFmdGVyID0gc3RyUGFydC5zdWJzdHJpbmcoaWR4ICsgcmVhbFN0cmluZy5sZW5ndGgpO1xuICAgICAgICAvLyBwdXNoIHN0ckJlZm9yZSB0byB0aGUgb2NjdXJyZW5jZXNTdHJpbmdcbiAgICAgICAgb2NjdXJyZW5jZXNTdHJpbmcucHVzaChzdHJCZWZvcmUpO1xuICAgICAgICAvLyBpZiBzdHJBZnRlciBub3QgZW1wdHksIHBhc3MgaXQgdG8gYWxsSW5kZXggZnVuY3Rpb25cbiAgICAgICAgaWYgKHN0ckFmdGVyKSBhbGxJbmRleChzdHJBZnRlcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBpZiBzdHJQYXJ0IGhhcyBub3QgdGVybSBpbiwgcHVzaCBpdCB0byB0aGUgZW5kIG9mIG9jY3VycmVuY2VzU3RyaW5nXG4gICAgICAgIG9jY3VycmVuY2VzU3RyaW5nLnB1c2goc3RyUGFydCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIHJ1biBhbGxJbmRleFxuICAgIGFsbEluZGV4KHN0cik7XG5cbiAgICAvLyByZXR1cm4gc3RyIHJlcGxhY2VkIHRlcm0gYm9sZFxuICAgIHJldHVybiBvY2N1cnJlbmNlc1N0cmluZy5qb2luKCcnKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGluaXQsXG4gICAgZWxlbWVudDogZ2V0RmlsdGVyLFxuICAgIG9uOiBvbixcbiAgICBzZWxlY3RJdGVtOiBzZWxlY3RJdGVtLFxuICAgIHVuc2VsZWN0SXRlbTogdW5zZWxlY3RJdGVtLFxuICAgIHVuc2VsZWN0QWxsSXRlbXM6IHVuc2VsZWN0QWxsSXRlbXMsXG4gICAgYXBwbHlJdGVtczogYXBwbHlJdGVtcyxcbiAgICBmaWx0ZXJMaXN0OiBmaWx0ZXJMaXN0LFxuICAgIC8vIGhpZ2hsaWdodDogc2V0SGlnaGxpZ2h0ZWRJdGVtLFxuICAgIGl0ZW1zOiBnZXRJdGVtcyxcbiAgICBzZWxlY3RlZEl0ZW1zOiBnZXRTZWxlY3RlZEl0ZW1zLFxuICAgIGZpbHRlcmVkSXRlbXM6IGdldEZpbHRlcmVkSXRlbXMsXG4gIH07XG59O1xuIiwiLyoqXG4gKiBGaWx0cm8gTGF0ZXJhbCBkbyBMb2NhbGl6YWRvclxuICogQGNvbXBvbmVudCBCc1NlbGVjdEZpbHRlci5pbml0KCk7XG4gKiBAY29tcG9uZW50IEJzTGlzdEFjY29yZGlvbi5leHBhbmQoKTtcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgdmFyIGV4cGFuZFRhYmxlUm93QnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5icy1qcy1leHBhbmQtdGFibGUtcm93Jyk7XG4gIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZXhwYW5kVGFibGVSb3dCdXR0b25zLCBmdW5jdGlvbiAoYnV0dG9uKSB7XG4gICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2KSB7XG4gICAgICB2YXIgcGFyZW50Um93ID0gYnV0dG9uLmNsb3Nlc3QoJ3RyJyk7XG4gICAgICBpZiAocGFyZW50Um93LmNsYXNzTGlzdC5jb250YWlucygnYnMtaXMtYWN0aXZlJykpIHtcbiAgICAgICAgcGFyZW50Um93LmNsYXNzTGlzdC5yZW1vdmUoJ2JzLWlzLWFjdGl2ZScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFyZW50Um93LmNsYXNzTGlzdC5hZGQoJ2JzLWlzLWFjdGl2ZScpO1xuICAgICAgfVxuICAgIH0pXG4gIH0pXG59KTtcbiJdfQ==
